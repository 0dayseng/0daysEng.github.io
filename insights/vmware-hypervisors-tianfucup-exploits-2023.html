<!DOCTYPE HTML>
<html lang="en">
   <head>
      <!-- Google tag (gtag.js) -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-RBMCFM6G1Z"></script>
      <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());

         gtag('config', 'G-RBMCFM6G1Z');
      </script>
      <!--Meta Tags-->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content=""/>
      <meta name="keywords" content=""/>
      <meta name="author" content=""/>
      <base href="../"> 
      <!--Favicons-->
      <link rel="shortcut icon" href="images/favicon.png">
      <!--Page Title-->
      <title>VMware Critical Security Advisory for ESXi, Workstation, Fusion hypervisors - Zero Day Engineering Insights</title>
      <!-- Stylesheets -->
      <!-- bootstrap -->
      <link rel="stylesheet" href="css/bootstrap.min.css">
      <!-- Animate -->
      <link rel="stylesheet" href="css/animate.min.css">
      <!-- Owl carusel -->
      <link rel="stylesheet" href="css/owl.carousel.min.css">
      <!-- Aos Css-->
      <link rel="stylesheet" href="css/aos.css"/>
      <!-- font awesome -->
      <link rel="stylesheet" href="css/font-awesome.min.css">
      <!-- highlight.js -->
      <link rel="stylesheet" href="css/default-dark.min.css">
      <!-- main css -->
      <link rel="stylesheet" href="css/style_20231213.css">
   </head>
   <body data-spy="scroll" data-target=".site-nav-target" data-offset="200">


      <!-- Nav mobile -->
      <nav class="site-mobile-menu">
         <div class="close-wrap d-flex">
            <a href="#" class="d-flex ml-auto js-menu-toggle">
               <span class="close-label">Close</span>
               <div class="close-times">
                  <span class="bar1"></span>
                  <span class="bar2"></span>
               </div>
            </a>
         </div>
         <div class="site-mobile-inner"></div>
      </nav>
      <!-- Nav mobile end -->

      <!-- Main content wrap -->
      <div class="site-wrap">
         <!-- Main content inner -->
         <div class="site-inner">

            <!-- Main Nav -->
            <nav class="site-nav site-nav-target">
               <div class="container">
                  <div class="row align-items-center justify-content-between text-left">
                     <div class="col-3">
                        <div class="site-logo">
                           <a href="index.html" class="site-logo main-logo"><img src="images/logo.png" class="logo-img light-logo img-fluid" alt=""><span></span></a>
                        </div>
                     </div>
                     <div class="col text-right">
                        <ul class="site-nav-ul js-clone-nav text-left d-none d-lg-inline-block">
                              <li><a href="index.html" class="nav-link cursor-item">Main</a></li>
                              <li class="has-children">
                                 <a href="research/index.html" class="nav-link cursor-item">Research</a>
                                 <ul class="dropdown">
                                    <li><a href="insights/index.html">0-Day Insights</a></li>
                                    <li><a href="research/index.html">Vulnerabilities & Exploits</a></li>
                                    <li><a href="research/index.html">Advanced Reverse Engineering</a></li>
                                    <li><a href="research/index.html">Abstract Modeling</a></li>
                                 </ul>
                              </li>

                              <li class="has-children">
                                 <a href="training/index.html" class="nav-link cursor-item">Training</a>
                                 <ul class="dropdown">
                                    <li><a href="training/index.html">Courses</a></li>
                                    <li><a href="training/index.html#nightly">Masterclasses</a></li>
                                 </ul>
                              </li>

                              <li class="has-children">
                                 <a href="about.html" class="nav-link cursor-item">Company</a>
                                 <ul class="dropdown">
                                    <li><a href="about.html">About us</a></li>
                                    <li><a href="work-with-us.html">Work with us</a></li>
                                    <li><a href="contact.html">Contact</a></li>
                                 </ul>
                              </li>                           </ul>
                           <ul class="site-nav-ul-none-onepage text-right d-inline-block d-lg-none">
                           <li><a href="#" class="js-menu-toggle">Menu</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
            </nav>
            <!-- Main Nav end -->

            <div class="section">
               <div class="blog-single-inner">
                  <div class="container">
                     <div class="row justify-content-center">
                        <div class="col-md-8">
                           <h1>Zero Day Engineering Insights</h1>
                           <h3 class="mb-4">VMware Critical Security Advisory for ESXi, Workstation, Fusion hypervisors</h3>
                           <p class="date">March 06th, 2024 - Alisa Esage</p>
                           <h6>Overview</h6>
                           <p>1. Vmware just released security patches for four critical vulnerabilities that affect their entire core hypervisor stack: CVE-2024-22252, CVE-2024-22253, CVE-2024-22254, CVE-2024-22255.
                              
                              2. The bugs were publicly exploited at Tianfu Cup 2023 hacking contest, which is currently the Chinese (and really the only one, globally) competitor to Pwn2Own competitions. There is no technical disclosures publicly available today.
                              
                              3. Three out of four bugs were found in the code of emulated USB controllers: XHCI & UHCI. The nature of the fourth bug (CVE-2024-22254) is unclear, and it affects ESXi hypervisor only.
                              
                              4. Regarding severity rating: they are just ordinary code execution bugs which allow (when chained together) a full VM escape. There is nothing special about these bugs. The only reason why Critical severity was assigned here is the publicly demonstrated exploit. In fact, dozens of bugs identical to these (though not necessarily in USB emulation) are being found and patched in hypervisors on a regular basis, with a humbler severity rating.
                              
                              5. Vulnerabilities in USB emulated devices are actually quite common, although hard to fuzz. Many Pwn competitions in the past showed hypervisor exploits based on bugs in USB emulated devices.
                              
                              6. All the different USB hardware technologies - OHCI, UHCI, eHCI, xHCI - are based on the same core system, while differing greatly in complexity. xHCI in particular is extremely complex. As hypervisors emulate hardware USB technologies, they implement the entire hardware specification abstraction in code. This is the reason why considerable numbers of security bugs were historically found in USB emulators.
                              
                              7. In terms of hypervisor hardening, USB emulation code is one of the first candidates for elimination as attack surface reduction.
                              
                              8. Most common classes of bugs in USB emulated devices are buffer overflows and use-after-free issues. Concrete examples: unchecked fields in USB data descriptors, dangling pointers due to poorly managed DMA mapping/unpapping operations, and generally lack of sanitization of guest-provided kernel device driver data.
                              
                              9. Exploitation of emulated devices in hypervisors typically requires elevated privileges on the Virtual Machine, and the exploit would go through the guest OS kernel.
                              
                              10. The distribution of affected products here hints upon the fraction of core hypervisor code which is shared in the vendor's base.</p>
                              
                              <h6>Vulnerability research tips</h6>
                              <p>High-level workflow of security patch analysis with reverse-engineering proprietary hypervisor code to reproduce the exploit - device emulation: <a class="underline" target="_blank" href="https://zerodayengineering.com/research/vmware-esxi-vmxnet3-from-patch-to-poc.html">check this blog post</a>.

                              This specific workflow is actually included as a series of practical exercises in our <a class="underline" target="_blank" href="https://zerodayengineering.com/training/hypervisor-vulnerability-research.html">Hypervisor Vulnerability Research</a> training, from reverse engineering the security patch to prototyping the proof-of-concept, plus all the background theory.
                              
                              The same bug pattern was behind one of the USB emulated device exploits in the past - xHCI (Pwn2Own 2017). Which is a common sample of use-after-free bug in *HCI controllers.</p>
                              
                              <h6>References</h6>
                              <p><a class="underline" target="_blank" href="https://vmware.com/security/advisories/VMSA-2024-0006.html">Vmware advisory</a> with product versions and patching instructions
                              </p>

                              <h6>Relevant courses</h6>
                              <p><a class="underline" target="_blank" href="training/masterclass/hypervisor-security-nightly.html">Masterclasses: Hypervisor Security Nightly</a> (4-hour ultra-specialized deep dives, take the 101 class to check if hypervisor VR is your thing)
                              <a class="underline" target="_blank" href="training/universal-vulnerability-research.html">Training course: Zero Day Vulnerability Research</a> (32 hours, systematic universal foundation)
                              <a class="underline" target="_blank" href="training/hypervisor-vulnerability-research.html">Training course: Hypervisor Vulnerability Research</a> (32 hours, vulnerability research specialization)</p>      

                           <div class="pt-5 mb-5 categories_tags ">
                              <h6>Metadata</h6>
                              <p>Discussions: <a target="_blank" class="underline" href="https://x.com/zerodaytraining/">Twitter</a>, <a target="_blank" class="underline" href="https://t.me/zerodaytraining/91">Telegram</a></p>
                              <p class="categories">Categories: 0-Day Insights</p><br>
                              <p class="tags">Tags: Virtualization, Competitions, VMware, USB</p>
                              <div class="social float-right"><p>Share this article:</p>
                                 <a href="https://www.facebook.com/sharer/sharer.php?u=https://zerodayengineering.com/insights/vmware-hypervisors-tianfucup-exploits-2023.html&t=0-Day Insights: VMware Tianfucup 2023 hypervisor exploits" class="mr-3"><i class="fa fa-facebook"></i></a>
                                 <a href="https://twitter.com/intent/tweet?url=https://zerodayengineering.com/insights/vmware-hypervisors-tianfucup-exploits-2023.html&text=0-Day Insights: VMware Tianfucup 2023 hypervisor exploits (via @zerodaytraining)" class="mr-3"><i class="fa fa-twitter"></i></a>
                                 <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://zerodayengineering.com/insights/vmware-hypervisors-tianfucup-exploits-2023.html&title=0-Day Insights: VMware Tianfucup 2023 hypervisor exploits" class="mr-3"><i class="fa fa-linkedin"></i>
                                 <a href="https://t.me/share/url?url=https://zerodayengineering.com/insights/vmware-hypervisors-tianfucup-exploits-2023.html&text=0-Day Insights: VMware Tianfucup 2023 hypervisor exploits (via @zerodaytraining)" class="mr-3"><i class="fa fa-telegram"></i></a>
                              </div>
                           </div>
                           
                           <div class="post-single-navigation d-flex align-items-stretch">
                              <a href="research/index.html" class="mr-auto w-50 pr-4">
                                 <span class="d-block cursor-item"><i class="fa fa-chevron-left mr-2"></i> Research</span></a>
                              <a href="training/index.html" class="ml-auto w-50 text-right pl-4">
                                 <span class="d-block cursor-item">Training <i class="fa fa-chevron-right ml-2"></i></span></a>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

            <!-- Footer -->
            <footer class="footer section">
               <div class="container">
                  <div class="row justify-content-center">
                     <div class="col-md-12">
                        <div class="go-top cursor-item" id="go-to-top"><i class="fa fa-chevron-up"></i></div>
                        <div class="hr-footer"></div>
                        <div class="footer-site-logo"><a href="index.html" class="main-logo"><img src="images/logo.png" class="logo-img light-logo img-fluid" alt=""></a></div>                       
                        <p class="site-copyright">
                           <small>&copy; 2024 Zero Day Engineering LLC. All Rights Reserved. <a href="rss" class="social-icon"><i class="fa fa-rss"></i></a></small>
                           
                        </p>
                     </div>
                  </div>
               </div>
            </footer>
            <!-- Footer end -->
            
         </div>
         <!-- Main content inner end -->
      </div>
      <!-- Main content wrap end -->

      <!-- Back to top button -->
      <a id="back-to-top" href="#" class="cursor-item desktop-only"><i class="fa fa-chevron-up"></i></a>

      <div class="cursor"></div>
      <div class="cursor-follower"></div>

      <!-- jquery -->
      <script src="js/query-3.4.1.min.js"></script>
      <!-- bootstrap -->
      <script src="js/bootstrap.min.js"></script>
      <!-- aos -->
      <script src="js/aos.js"></script>
      <!-- owl.carusel js -->
      <script src="js/owl.carousel.min.js"></script>
      <!-- isotope js -->
      <script src="js/isotope.pkgd.min.js"></script>
      <!-- isotope image loader js -->
      <script src="js/imagesloaded.pkgd.min.js"></script>
      <!-- three -->
      <script src="js/three.min.js"></script>
      <!-- anime -->
      <script src="js/anime.min.js"></script>
      <!-- tweenmax -->
      <script src="js/TweenMax.min.js"></script>
      <!-- jquery.waypoints.min.js -->
      <script src="js/jquery.waypoints.min.js"></script>
      <!-- circletype-->
      <script src="js/circletype.min.js"></script>
      <!-- hover-effect -->
      <script src="js/hover-effect.umd.js"></script>
      <!-- gsap -->
      <script src="js/gsap.min.js"></script>
      <!-- ScrollMagic gsap -->
      <script src="js/ScrollMagic.min.js"></script>
      <script src="js/scrollmagic.animation.gsap.min.js"></script>
      <!-- highlight.js -->
      <script src="js/highlight.min.js"></script>
      <!-- custom -->
      <script src="js/custom.js"></script>
      <script>hljs.highlightAll();</script>
   </body>
</html>