<!DOCTYPE HTML>
<html lang="en">
   <head>
      <!--Meta Tags-->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content=""/>
      <meta name="keywords" content=""/>
      <meta name="author" content=""/>
      <base href="../"> 
      <!--Favicons-->
      <link rel="shortcut icon" href="images/favicon.png">
      <!--Page Title-->
      <title>nginx mp4 module DoS & Infoleak Vulnerability â€“ Zero Day Engineering LLC</title>
      <!-- Stylesheets -->
      <!-- bootstrap -->
      <link rel="stylesheet" href="css/bootstrap.min.css">
      <!-- Animate -->
      <link rel="stylesheet" href="css/animate.min.css">
      <!-- Owl carusel -->
      <link rel="stylesheet" href="css/owl.carousel.min.css">
      <!-- Aos Css-->
      <link rel="stylesheet" href="css/aos.css"/>
      <!-- font awesome -->
      <link rel="stylesheet" href="css/font-awesome.min.css">
      <!-- main css -->
      <link rel="stylesheet" href="css/style.css">
   </head>
   <body data-spy="scroll" data-target=".site-nav-target" data-offset="200">

      <!-- Nav mobile -->
      <nav class="site-mobile-menu">
         <div class="close-wrap d-flex">
            <a href="#" class="d-flex ml-auto js-menu-toggle">
               <span class="close-label">Close</span>
               <div class="close-times">
                  <span class="bar1"></span>
                  <span class="bar2"></span>
               </div>
            </a>
         </div>
         <div class="site-mobile-inner"></div>
      </nav>
      <!-- Nav mobile end -->

      <!-- Main content wrap -->
      <div class="site-wrap">
         <!-- Main content inner -->
         <div class="site-inner">

            <!-- Main Nav -->
            <nav class="site-nav site-nav-target">
               <div class="container">
                  <div class="row align-items-center justify-content-between text-left">
                     <div class="col-3">
                        <div class="site-logo">
                           <a href="index.html" class="site-logo main-logo"><img src="images/logo.png" class="logo-img light-logo img-fluid" alt=""><span></span></a>
                        </div>
                     </div>
                     <div class="col text-right">
                        <ul class="site-nav-ul js-clone-nav text-left d-none d-lg-inline-block">
                              <li><a href="index.html" class="nav-link cursor-item">Home</a></li>
                              <li><a href="research/index.html" class="nav-link cursor-item">Research</a></li>
                              <li><a href="training/index.html" class="nav-link cursor-item">Training</a></li>
                              <li><a href="contact.html" class="nav-link cursor-item">Contact</a></li>
                           </ul>
                           <ul class="site-nav-ul-none-onepage text-right d-inline-block d-lg-none">
                           <li><a href="#" class="js-menu-toggle">Menu</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
            </nav>
            <!-- Main Nav end -->

            <div class="section">
               <div class="blog-single-inner">
                  <div class="container">
                     <div class="row justify-content-center">
                        <div class="col-md-8">
                           <div id="quote"></div>
                           <h3 class="mb-4">nginx mp4 module DoS & Infoleak Vulnerability</h3>

                           <p>This proof-of-concept exploit demonstrates an out of bounds read in nginx v1.15.5 heap. This can be worked up to an information disclosure exploit with a bit of extra work. The bug itself, and potentially the exploit, affects earlier nginx versions to some extent.</p>

                           <p>The bug was reverse-engineered by me from nginx security patches [1], and exploit made public in this release for the first time.</p>

                           <p>CVE ID: CVE-2018-16845
                           Exploit developer: Alisa Esage (Zero Day Engineering)
                           Bug finder: Unknown
                           Technical details: *to be done*</p>


                           <h6>Prerequisites</h6>

                           <p>* nginx v1.15.5
                           * built with the option "--with-http_mp4_module" (non default)</p>


                           <h6>Impact</h6>

                           <p>Possible attack scenarios for this bug range from a denial of service (DoS) of the nginx worker process, to leaking some bytes (infoleak) from the nginx worker process heap, depending on the implementation of the exploit. </p>

                           <p>In case of a DoS attack scenario, the attacker would trigger the bug to crash the nginx worker process. The worker process will be promptly respawned by the parent nginx process after the crash. By repeating the exploit in a loop, the DoS attack can be made persistent in effect, and/or cause a server-global resource exaustion.</p>

                           <p>In case of an Infoleak attack scenario, the attacker would trigger the bug to read some bytes from the nginx worker process heap. This primitive can be leveraged in an RCE exploit chain to break ASLR, or in a stand-alone setting to disclose potentially sensitive data from the nginx worker process, such as some passwords or the backend configuration. </p>

                           <p>In terms of the volume of affected distributions, the impact is not clear. One indicator that the impact may be substantial is that this bug is published in the official nginx security advisory [2], something that nginx team is extremely reluctant to do (note that the list of nginx security issues in the global CVE database is at least four-five times longer than the "official" list of security issues published on the product website).</p>

                           <p>A realistic attack scenario would use a second bug either in nginx or in other remotely accessible server software for an arbitrary file write on the server.</p>


                           <h6>How to test</h6>

                           <p>Trigger the bug remotely:
                           curl http://servername/video/test.mp4?start=2</p>

                           <p>Test environment configuration is left as an exercise for the reader.</p>


                           <h6>Notes</h6>

                           <p>Take a look at the crashing stack trace. ngx_writev is the wrapper API in nginx that writes to client connection socket. It means that, while this is a minimalist crash-PoC, the possibility of an infoleak attack is strongly proven.</p>

                           <p>The impact of the infoleak attack is somewhat limited (hopefully), because nginx spawns one worker process per each connection. So, it should not be possible to read other clients' data, at least in default configuration. </p>

                           <p>Tip on configuration: see the included nginx.conf file /video/ section.</p>


                           <h6>References</h6>

                           <p>1. <a class="underline" href="https://mailman.nginx.org/pipermail/nginx-announce/2018/000221.html?_ga=2.85094233.1343789537.1647791803-1269222961.1647791803">[nginx-announce] nginx security advisory (CVE-2018-16845)</a> 
                           2. <a class="underline" href="http://nginx.org/en/security_advisories.html">nginx security advisories</a>
                           3. <a class="underline" href="http://zerodayengineering.com/research/">Zero Day Engineering research</a></p>


                           <h6>Contacts</h6>

                           <p>Twitter: <a class="underline" href="https://twitter.com/alisaesage">@alisaesage</a> <a class="underline" href="https://twitter.com/zerodaytraining">@zerodaytraining</a>
                           Email: <a class="underline" href="mailto:contact@zerodayengineering.com">contact@zerodayengineering.com</a></p>

                           <p><a class="underline" href="code/nginx-mp4-infoleak-poc.zip">Proof-of-concept code</a>
                           <a class="underline" href="https://github.com/badd1e/Disclosures/tree/master/CVE-2018-16845_nginx_mp4">GitHub mirror</a></p>

                           <div class="post-single-navigation d-flex align-items-stretch">
                              <a href="/index.html" class="mr-auto w-50 pr-4">
                                 <span class="d-block cursor-item"><i class="fa fa-chevron-left mr-2"></i> Home</span></a>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

            <!-- Footer -->
            <footer class="footer section">
               <div class="container">
                  <div class="row justify-content-center">
                     <div class="col-md-12">
                        <div class="go-top cursor-item" id="go-to-top"><i class="fa fa-chevron-up"></i></div>
                        <div class="hr-footer"></div>
                        <div class="footer-site-logo"><a href="index.html" class="main-logo"><img src="images/logo.png" class="logo-img light-logo img-fluid" alt=""></a></div>                       
                        <p class="site-copyright">
                           <small>&copy; 2023 Zero Day Engineering LLC. All Rights Reserved.</small>
                           <small>P.S. This website is optimized for larger screens. If you have any problems, zoom out to 75-80%</small>
                        </p>
                     </div>
                  </div>
               </div>
            </footer>
            <!-- Footer end -->

         </div>
         <!-- Main content inner end -->
      </div>
      <!-- Main content wrap end -->

      <!-- Back to top button -->
      <a id="back-to-top" href="#" class="cursor-item"><i class="fa fa-chevron-up"></i></a>

      <div class="cursor"></div>
      <div class="cursor-follower"></div>

      <!-- jquery -->
      <script src="js/query-3.4.1.min.js"></script>
      <!-- bootstrap -->
      <script src="js/bootstrap.min.js"></script>
      <!-- aos -->
      <script src="js/aos.js"></script>
      <!-- owl.carusel js -->
      <script src="js/owl.carousel.min.js"></script>
      <!-- isotope js -->
      <script src="js/isotope.pkgd.min.js"></script>
      <!-- isotope image loader js -->
      <script src="js/imagesloaded.pkgd.min.js"></script>
      <!-- three -->
      <script src="js/three.min.js"></script>
      <!-- anime -->
      <script src="js/anime.min.js"></script>
      <!-- tweenmax -->
      <script src="js/TweenMax.min.js"></script>
      <!-- jquery.waypoints.min.js -->
      <script src="js/jquery.waypoints.min.js"></script>
      <!-- circletype-->
      <script src="js/circletype.min.js"></script>
      <!-- hover-effect -->
      <script src="js/hover-effect.umd.js"></script>
      <!-- gsap -->
      <script src="js/gsap.min.js"></script>
      <!-- ScrollMagic gsap -->
      <script src="js/ScrollMagic.min.js"></script>
      <script src="js/scrollmagic.animation.gsap.min.js"></script>
      <!-- custom -->
      <script src="js/custom.js"></script>
   </body>
</html>