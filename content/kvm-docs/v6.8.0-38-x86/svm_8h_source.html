<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KVM: arch/x86/kvm/svm/svm.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ea9599923402ca8ab47fc3e495999dea.html">arch</a></li><li class="navelem"><a class="el" href="dir_c21774f8bc9f0de15163573e5f5fa2b5.html">x86</a></li><li class="navelem"><a class="el" href="dir_fde450fd4b58e2560c53a1e73bfa4d6d.html">kvm</a></li><li class="navelem"><a class="el" href="dir_59e270fee840b69a56de99d30906df9d.html">svm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">svm.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="svm_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// SPDX-License-Identifier: GPL-2.0-only</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Kernel-based Virtual Machine driver for Linux</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * AMD SVM support</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * Copyright (C) 2006 Qumranet, Inc.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright 2010 Red Hat, Inc. and/or its affiliates.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * Authors:</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   Yaniv Kamay  &lt;yaniv@qumranet.com&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *   Avi Kivity   &lt;avi@qumranet.com&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#ifndef __SVM_SVM_H</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#define __SVM_SVM_H</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;linux/kvm_types.h&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;linux/kvm_host.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;linux/bits.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;asm/svm.h&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;asm/sev-common.h&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cpuid_8h.html">cpuid.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kvm__cache__regs_8h.html">kvm_cache_regs.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="svm_8h.html#a006ecae20fd705ed2184ec4e6f0f5dd9">   28</a></span>&#160;<span class="preprocessor">#define __sme_page_pa(x) __sme_set(page_to_pfn(x) &lt;&lt; PAGE_SHIFT)</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="svm_8h.html#a3db0df1165fd78ebd0af2184562f090c">   30</a></span>&#160;<span class="preprocessor">#define IOPM_SIZE PAGE_SIZE * 3</span></div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="svm_8h.html#a106125dd7b1447fe5e6cb6f08240137b">   31</a></span>&#160;<span class="preprocessor">#define MSRPM_SIZE PAGE_SIZE * 2</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">   33</a></span>&#160;<span class="preprocessor">#define MAX_DIRECT_ACCESS_MSRS  47</span></div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="svm_8h.html#aecb0b82114f9d516a3ee502c0054e0c0">   34</a></span>&#160;<span class="preprocessor">#define MSRPM_OFFSETS   32</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">extern</span> u32 msrpm_offsets[<a class="code" href="svm_8h.html#aecb0b82114f9d516a3ee502c0054e0c0">MSRPM_OFFSETS</a>] <a class="code" href="svm_8h.html#a036567d678fc3315196c7e4a5fa42cd3">__read_mostly</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="svm_8h.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="svm_8h.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#adc8812d5d875ec9a2bf431790db71cfb">intercept_smi</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#ad4c0ba70ab315cedbb11f259b1d7ae08">x2avic_enabled</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * Clean bits in VMCB.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * VMCB_ALL_CLEAN_MASK might also need to</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> * be updated if this enum is modified.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">enum</span> {</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1">   49</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a>, <span class="comment">/* Intercept vectors, TSC offset,</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">                pause filter count */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a0b96a6cb7dc2eb2f1e2471f9fdfa6972">   51</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a0b96a6cb7dc2eb2f1e2471f9fdfa6972">VMCB_PERM_MAP</a>,   <span class="comment">/* IOPM Base and MSRPM Base */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64">   52</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64">VMCB_ASID</a>,   <span class="comment">/* ASID */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e">   53</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a>,   <span class="comment">/* int_ctl, int_vector */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7c9727e792c945164c49fbd9793c4e97">   54</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7c9727e792c945164c49fbd9793c4e97">VMCB_NPT</a>,        <span class="comment">/* npt_en, nCR3, gPAT */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975">   55</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>,     <span class="comment">/* CR0, CR3, CR4, EFER */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac7c020c96383ecc6a3d358e1fdd99be7">   56</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac7c020c96383ecc6a3d358e1fdd99be7">VMCB_DR</a>,         <span class="comment">/* DR6, DR7 */</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a1c1bbe2afa896e3b5fc2f2d850eb41b3">   57</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a1c1bbe2afa896e3b5fc2f2d850eb41b3">VMCB_DT</a>,         <span class="comment">/* GDT, IDT */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ab13d3c949ef62a4213fe70e2ed836b91">   58</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ab13d3c949ef62a4213fe70e2ed836b91">VMCB_SEG</a>,        <span class="comment">/* CS, DS, SS, ES, CPL */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1">   59</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1">VMCB_CR2</a>,        <span class="comment">/* CR2 only */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a">   60</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a">VMCB_LBR</a>,        <span class="comment">/* DBGCTL, BR_FROM, BR_TO, LAST_EX_FROM, LAST_EX_TO */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f">   61</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f">VMCB_AVIC</a>,       <span class="comment">/* AVIC APIC_BAR, AVIC APIC_BACKING_PAGE,</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">              * AVIC PHYSICAL_TABLE pointer,</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">              * AVIC LOGICAL_TABLE pointer</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">              */</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aadb6ebcdeea82b3c1ad950e8e2433d8c">   65</a></span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aadb6ebcdeea82b3c1ad950e8e2433d8c">VMCB_SW</a> = 31,    <span class="comment">/* Reserved for hypervisor/software use */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;};</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="svm_8h.html#a317277564d2351c6695a358504311483">   68</a></span>&#160;<span class="preprocessor">#define VMCB_ALL_CLEAN_MASK (                   \</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">    (1U &lt;&lt; VMCB_INTERCEPTS) | (1U &lt;&lt; VMCB_PERM_MAP) |   \</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">    (1U &lt;&lt; VMCB_ASID) | (1U &lt;&lt; VMCB_INTR) |         \</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">    (1U &lt;&lt; VMCB_NPT) | (1U &lt;&lt; VMCB_CR) | (1U &lt;&lt; VMCB_DR) |  \</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">    (1U &lt;&lt; VMCB_DT) | (1U &lt;&lt; VMCB_SEG) | (1U &lt;&lt; VMCB_CR2) | \</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">    (1U &lt;&lt; VMCB_LBR) | (1U &lt;&lt; VMCB_AVIC) |          \</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">    (1U &lt;&lt; VMCB_SW))</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">/* TPR and CR2 are always written before VMRUN */</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="svm_8h.html#a987416bb1857b96f97af2391d1008c5a">   77</a></span>&#160;<span class="preprocessor">#define VMCB_ALWAYS_DIRTY_MASK  ((1U &lt;&lt; VMCB_INTR) | (1U &lt;&lt; VMCB_CR2))</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structkvm__sev__info.html">   79</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> {</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structkvm__sev__info.html#a6da81c9e8736479d0edee1c4e8813365">   80</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structkvm__sev__info.html#a6da81c9e8736479d0edee1c4e8813365">active</a>;        <span class="comment">/* SEV enabled guest */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structkvm__sev__info.html#ab1e6fb4b7c55cdd34fdd230a7847d11a">   81</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structkvm__sev__info.html#ab1e6fb4b7c55cdd34fdd230a7847d11a">es_active</a>;     <span class="comment">/* SEV-ES enabled guest */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structkvm__sev__info.html#ae81641c3ab02ddd91e7a094c673e9088">   82</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structkvm__sev__info.html#ae81641c3ab02ddd91e7a094c673e9088">asid</a>;  <span class="comment">/* ASID used for this guest */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structkvm__sev__info.html#ad75defd37a304bbb1e3b0123ea417d95">   83</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structkvm__sev__info.html#ad75defd37a304bbb1e3b0123ea417d95">handle</a>;    <span class="comment">/* SEV firmware handle */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structkvm__sev__info.html#aecf16aee273c40c0f150e82111e3c30d">   84</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structkvm__sev__info.html#aecf16aee273c40c0f150e82111e3c30d">fd</a>;         <span class="comment">/* SEV device fd */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structkvm__sev__info.html#a06c28c2c468a938dfb454dc2dc3808ab">   85</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structkvm__sev__info.html#a06c28c2c468a938dfb454dc2dc3808ab">pages_locked</a>; <span class="comment">/* Number of pages locked */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">struct </span>list_head <a class="code" href="structkvm__sev__info.html#a7901eb8db0b44a6cff20fe30c41d6a3f">regions_list</a>;  <span class="comment">/* List of registered regions */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structkvm__sev__info.html#a786e349e8aa7806f21b4893b0f30d225">   87</a></span>&#160;    u64 <a class="code" href="structkvm__sev__info.html#a786e349e8aa7806f21b4893b0f30d225">ap_jump_table</a>;  <span class="comment">/* SEV-ES AP Jump Table address */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structkvm__sev__info.html#a229b95df6e061397ed598e97dffea3c3">   88</a></span>&#160;    <span class="keyword">struct </span>kvm *<a class="code" href="structkvm__sev__info.html#a229b95df6e061397ed598e97dffea3c3">enc_context_owner</a>; <span class="comment">/* Owner of copied encryption context */</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">struct </span>list_head <a class="code" href="structkvm__sev__info.html#ae3b8494e7fae1c09a80314c72f4806b0">mirror_vms</a>; <span class="comment">/* List of VMs mirroring */</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keyword">struct </span>list_head <a class="code" href="structkvm__sev__info.html#a567d59358620c89779269a808be2b8b7">mirror_entry</a>; <span class="comment">/* Use as a list entry of mirrors */</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="structkvm__sev__info.html#abef33415f75cf8cc6117da1c09136c9e">   91</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html#abef33415f75cf8cc6117da1c09136c9e">misc_cg</a> *<a class="code" href="structkvm__sev__info.html#abef33415f75cf8cc6117da1c09136c9e">misc_cg</a>; <span class="comment">/* For misc cgroup accounting */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">   92</a></span>&#160;    atomic_t <a class="code" href="structkvm__sev__info.html#a26a5ef264d242712a64ff06e8eb2bba7">migration_in_progress</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;};</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structkvm__svm.html">   95</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structkvm__svm.html">kvm_svm</a> {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a> <a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">/* Struct members for AVIC */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="structkvm__svm.html#a06c4479d5aefb8c19b8ead15d599b324">   99</a></span>&#160;    u32 <a class="code" href="structkvm__svm.html#a06c4479d5aefb8c19b8ead15d599b324">avic_vm_id</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="structkvm__svm.html#a837dca12e3d1d7b768feb04c6a3c2e96">  100</a></span>&#160;    <span class="keyword">struct </span>page *<a class="code" href="structkvm__svm.html#a837dca12e3d1d7b768feb04c6a3c2e96">avic_logical_id_table_page</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structkvm__svm.html#aa05522988cc0a3ce6ad59dcec1ed0c46">  101</a></span>&#160;    <span class="keyword">struct </span>page *<a class="code" href="structkvm__svm.html#aa05522988cc0a3ce6ad59dcec1ed0c46">avic_physical_id_table_page</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">struct </span>hlist_node <a class="code" href="structkvm__svm.html#a4f8eab5b98a43c0a7402d15663d4e032">hnode</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> <a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;};</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keyword">struct </span>kvm_vcpu;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structkvm__vmcb__info.html">  109</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structkvm__vmcb__info.html">kvm_vmcb_info</a> {</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">  110</a></span>&#160;    <span class="keyword">struct </span>vmcb *<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structkvm__vmcb__info.html#a91e376066b465faac6f37deac812bee5">  111</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structkvm__vmcb__info.html#a91e376066b465faac6f37deac812bee5">pa</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structkvm__vmcb__info.html#a77727aa5326106aedb6630f4100578ec">  112</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structkvm__vmcb__info.html#a77727aa5326106aedb6630f4100578ec">cpu</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="structkvm__vmcb__info.html#a48661ae4516f12bd14f4cc4121700a90">  113</a></span>&#160;    uint64_t <a class="code" href="structkvm__vmcb__info.html#a48661ae4516f12bd14f4cc4121700a90">asid_generation</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;};</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="structvmcb__save__area__cached.html">  116</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structvmcb__save__area__cached.html">vmcb_save_area_cached</a> {</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="structvmcb__save__area__cached.html#a9c7aeff2108008b72ccb5726dc2da32a">  117</a></span>&#160;    u64 <a class="code" href="structvmcb__save__area__cached.html#a9c7aeff2108008b72ccb5726dc2da32a">efer</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="structvmcb__save__area__cached.html#a64d1beda721567c52a8877f802e3c8f9">  118</a></span>&#160;    u64 <a class="code" href="structvmcb__save__area__cached.html#a64d1beda721567c52a8877f802e3c8f9">cr4</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="structvmcb__save__area__cached.html#a716fbc4b5214710276c00f469d7d1d29">  119</a></span>&#160;    u64 <a class="code" href="structvmcb__save__area__cached.html#a716fbc4b5214710276c00f469d7d1d29">cr3</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="structvmcb__save__area__cached.html#a5e0ec7ce63e98ebada78d20a99e1b892">  120</a></span>&#160;    u64 <a class="code" href="structvmcb__save__area__cached.html#a5e0ec7ce63e98ebada78d20a99e1b892">cr0</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="structvmcb__save__area__cached.html#a7373d64bb3b004ba2a76d92e32e91cbf">  121</a></span>&#160;    u64 <a class="code" href="structvmcb__save__area__cached.html#a7373d64bb3b004ba2a76d92e32e91cbf">dr7</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structvmcb__save__area__cached.html#a76e86a91e5c4a598014b722f071a8748">  122</a></span>&#160;    u64 <a class="code" href="structvmcb__save__area__cached.html#a76e86a91e5c4a598014b722f071a8748">dr6</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;};</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html">  125</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structvmcb__ctrl__area__cached.html">vmcb_ctrl_area_cached</a> {</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a1e877429e7fb02e17e8aec57274abca4">  126</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#a1e877429e7fb02e17e8aec57274abca4">intercepts</a>[MAX_INTERCEPT];</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#aa97f45d198b0f8800ae8d48ee44b56f9">  127</a></span>&#160;    u16 <a class="code" href="structvmcb__ctrl__area__cached.html#aa97f45d198b0f8800ae8d48ee44b56f9">pause_filter_thresh</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a2713403c709e48e21de3a91d3d28bce5">  128</a></span>&#160;    u16 <a class="code" href="structvmcb__ctrl__area__cached.html#a2713403c709e48e21de3a91d3d28bce5">pause_filter_count</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a8813ccbf51388cde7a5727a3f84dd2db">  129</a></span>&#160;    u64 <a class="code" href="structvmcb__ctrl__area__cached.html#a8813ccbf51388cde7a5727a3f84dd2db">iopm_base_pa</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a51c61318f18513673f290f703e421acb">  130</a></span>&#160;    u64 <a class="code" href="structvmcb__ctrl__area__cached.html#a51c61318f18513673f290f703e421acb">msrpm_base_pa</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#aa8133737f749481d1105fbb6cfefa014">  131</a></span>&#160;    u64 <a class="code" href="structvmcb__ctrl__area__cached.html#aa8133737f749481d1105fbb6cfefa014">tsc_offset</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a69f589fcf8d6d59e9f0deed5dd03e1b5">  132</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#a69f589fcf8d6d59e9f0deed5dd03e1b5">asid</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a73eb23f87b74324917ce3831a41f3c3d">  133</a></span>&#160;    u8 <a class="code" href="structvmcb__ctrl__area__cached.html#a73eb23f87b74324917ce3831a41f3c3d">tlb_ctl</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">  134</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#ab068abfea412a5ea88785570f3fab554">  135</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#ab068abfea412a5ea88785570f3fab554">int_vector</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#adfa7dd6ea79467607e5a70e6f8d5d0c1">  136</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#adfa7dd6ea79467607e5a70e6f8d5d0c1">int_state</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a6dbaaab1ff061c474307cd03cdf9e841">  137</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#a6dbaaab1ff061c474307cd03cdf9e841">exit_code</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a14a6506738f4682f13632ae2d1c96752">  138</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#a14a6506738f4682f13632ae2d1c96752">exit_code_hi</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a2f479e79f0c9c5862da98440da9b5fa9">  139</a></span>&#160;    u64 <a class="code" href="structvmcb__ctrl__area__cached.html#a2f479e79f0c9c5862da98440da9b5fa9">exit_info_1</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#ae390ee70e69b06fe97d3ee873889303c">  140</a></span>&#160;    u64 <a class="code" href="structvmcb__ctrl__area__cached.html#ae390ee70e69b06fe97d3ee873889303c">exit_info_2</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#aab04e46c04cd5f85d758e353ef21b691">  141</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#aab04e46c04cd5f85d758e353ef21b691">exit_int_info</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a12b9399ff1b5beaad19b731aedb12011">  142</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#a12b9399ff1b5beaad19b731aedb12011">exit_int_info_err</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a64059f1364084ba55fe82bf69f0704dd">  143</a></span>&#160;    u64 <a class="code" href="structvmcb__ctrl__area__cached.html#a64059f1364084ba55fe82bf69f0704dd">nested_ctl</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a2fba54766e16cab5897765ffdb4ea134">  144</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#a2fba54766e16cab5897765ffdb4ea134">event_inj</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a663499717208b2803e3a33b4d19929b7">  145</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#a663499717208b2803e3a33b4d19929b7">event_inj_err</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a28a03a713594725f8e7fa8090681a1d9">  146</a></span>&#160;    u64 <a class="code" href="structvmcb__ctrl__area__cached.html#a28a03a713594725f8e7fa8090681a1d9">next_rip</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#af43b324bc739858a84ac026b6c5ef15f">  147</a></span>&#160;    u64 <a class="code" href="structvmcb__ctrl__area__cached.html#af43b324bc739858a84ac026b6c5ef15f">nested_cr3</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a7c13a2a3665942eb4cc17fc335c4185f">  148</a></span>&#160;    u64 <a class="code" href="structvmcb__ctrl__area__cached.html#a7c13a2a3665942eb4cc17fc335c4185f">virt_ext</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#a3709474003525bc4510eea401cef37aa">  149</a></span>&#160;    u32 <a class="code" href="structvmcb__ctrl__area__cached.html#a3709474003525bc4510eea401cef37aa">clean</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#if IS_ENABLED(CONFIG_HYPERV) || IS_ENABLED(CONFIG_KVM_HYPERV)</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keyword">struct </span>hv_vmcb_enlightenments hv_enlightenments;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="structvmcb__ctrl__area__cached.html#aaf1d96a2ac5238db2c2eb36f5e389933">  154</a></span>&#160;        u8 <a class="code" href="structvmcb__ctrl__area__cached.html#aaf1d96a2ac5238db2c2eb36f5e389933">reserved_sw</a>[32];</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    };</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;};</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="structsvm__nested__state.html">  158</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structsvm__nested__state.html">svm_nested_state</a> {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__vmcb__info.html">kvm_vmcb_info</a> <a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="structsvm__nested__state.html#abb9c6243e2a90048413ab9d68a450e45">  160</a></span>&#160;    u64 <a class="code" href="structsvm__nested__state.html#abb9c6243e2a90048413ab9d68a450e45">hsave_msr</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="structsvm__nested__state.html#a07d2ebcca90ff4e7e8469a1cf7f720fe">  161</a></span>&#160;    u64 <a class="code" href="structsvm__nested__state.html#a07d2ebcca90ff4e7e8469a1cf7f720fe">vm_cr_msr</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structsvm__nested__state.html#a16894147af263784cff5f93602e97a54">  162</a></span>&#160;    u64 <a class="code" href="structsvm__nested__state.html#a16894147af263784cff5f93602e97a54">vmcb12_gpa</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="structsvm__nested__state.html#a469889e41a4042539ad55c80ed27ec48">  163</a></span>&#160;    u64 <a class="code" href="structsvm__nested__state.html#a469889e41a4042539ad55c80ed27ec48">last_vmcb12_gpa</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">/* These are the merged vectors */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">  166</a></span>&#160;    u32 *<a class="code" href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">msrpm</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">/* A VMRUN has started but has not yet been performed, so</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">     * we cannot inject a nested vmexit yet.  */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">  170</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">nested_run_pending</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">/* cache for control fields of the guest */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvmcb__ctrl__area__cached.html">vmcb_ctrl_area_cached</a> <a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">     * Note: this struct is not kept up-to-date while L2 runs; it is only</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">     * valid within nested_svm_vmrun.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvmcb__save__area__cached.html">vmcb_save_area_cached</a> <a class="code" href="structsvm__nested__state.html#a3ca397932611001996adc12f53f7247c">save</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="structsvm__nested__state.html#a280879c3a0fa081ac14507bec27f0727">  181</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structsvm__nested__state.html#a280879c3a0fa081ac14507bec27f0727">initialized</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">     * Indicates whether MSR bitmap for L2 needs to be rebuilt due to</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">     * changes in MSR bitmap for L1 or switching to a different L2. Note,</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">     * this flag can only be used reliably in conjunction with a paravirt L1</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">     * which informs L0 whether any changes to MSR bitmap for L2 were done</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">     * on its side.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="structsvm__nested__state.html#ab518a0d0e52def0384b5a65321ea2854">  190</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structsvm__nested__state.html#ab518a0d0e52def0384b5a65321ea2854">force_msr_bitmap_recalc</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;};</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="structvcpu__sev__es__state.html">  193</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structvcpu__sev__es__state.html">vcpu_sev_es_state</a> {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">/* SEV-ES support */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="structvcpu__sev__es__state.html#a40070a764eb6f9ab2573d7961a0c6f8e">  195</a></span>&#160;    <span class="keyword">struct </span>sev_es_save_area *<a class="code" href="structvcpu__sev__es__state.html#a40070a764eb6f9ab2573d7961a0c6f8e">vmsa</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">  196</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a> *<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>;</div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="structvcpu__sev__es__state.html#aadd3d1bc5bf29afb297714dcaf151aba">  197</a></span>&#160;    u8 <a class="code" href="structvcpu__sev__es__state.html#ab1e4599fd131a0afb3a9c5bda4901a6e">valid_bitmap</a>[16];</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">struct </span>kvm_host_map <a class="code" href="structvcpu__sev__es__state.html#aadd3d1bc5bf29afb297714dcaf151aba">ghcb_map</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="structvcpu__sev__es__state.html#a62f326875a1cbab9d4673ab3f5a34169">  199</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__sev__es__state.html#a62f326875a1cbab9d4673ab3f5a34169">received_first_sipi</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">/* SEV-ES scratch area support */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="structvcpu__sev__es__state.html#aafb2527aebe81e9eefaa798f5eeca497">  202</a></span>&#160;    u64 <a class="code" href="structvcpu__sev__es__state.html#aafb2527aebe81e9eefaa798f5eeca497">sw_scratch</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">  203</a></span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">ghcb_sa</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="structvcpu__sev__es__state.html#a1288c35c0ce7f08e31b6e56639cfc17c">  204</a></span>&#160;    u32 <a class="code" href="structvcpu__sev__es__state.html#a1288c35c0ce7f08e31b6e56639cfc17c">ghcb_sa_len</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="structvcpu__sev__es__state.html#ae0158f4a111e910e8777324a10286cec">  205</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__sev__es__state.html#ae0158f4a111e910e8777324a10286cec">ghcb_sa_sync</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="structvcpu__sev__es__state.html#acdd2e394133423adbb11b59872ab0121">  206</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__sev__es__state.html#acdd2e394133423adbb11b59872ab0121">ghcb_sa_free</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;};</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="structvcpu__svm.html">  209</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">struct </span>kvm_vcpu <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">/* vmcb always points at current_vmcb-&gt;ptr, it&#39;s purely a shorthand. */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">  212</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a> *<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__vmcb__info.html">kvm_vmcb_info</a> <a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">  214</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__vmcb__info.html">kvm_vmcb_info</a> *<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a7c494fa07f9ddd95637bb1061808402e">  215</a></span>&#160;    u32 <a class="code" href="structvcpu__svm.html#a7c494fa07f9ddd95637bb1061808402e">asid</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a747a3e237abb2217a6a93de9d17de74e">  216</a></span>&#160;    u32 <a class="code" href="structvcpu__svm.html#a747a3e237abb2217a6a93de9d17de74e">sysenter_esp_hi</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a80fa0b4dcbb7f9758bd7c0c29e1ed1a5">  217</a></span>&#160;    u32 <a class="code" href="structvcpu__svm.html#a80fa0b4dcbb7f9758bd7c0c29e1ed1a5">sysenter_eip_hi</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#ae25c348c7b9864253f4db3fb8a3c3e59">  218</a></span>&#160;    uint64_t <a class="code" href="structvcpu__svm.html#ae25c348c7b9864253f4db3fb8a3c3e59">tsc_aux</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#adb9edaf400032eba81ff85b2e419844a">  220</a></span>&#160;    u64 <a class="code" href="structvcpu__svm.html#adb9edaf400032eba81ff85b2e419844a">msr_decfg</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#af9472805586ac10a411dde4a890047ac">  222</a></span>&#160;    u64 <a class="code" href="structvcpu__svm.html#af9472805586ac10a411dde4a890047ac">next_rip</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a9a30016a1a0975a7ce12de950ec2a2cc">  224</a></span>&#160;    u64 <a class="code" href="structvcpu__svm.html#a9a30016a1a0975a7ce12de950ec2a2cc">spec_ctrl</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">  226</a></span>&#160;    u64 <a class="code" href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">tsc_ratio_msr</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">     * Contains guest-controlled bits of VIRT_SPEC_CTRL, which will be</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">     * translated into the appropriate L2_CFG bits on the host to</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">     * perform speculative control.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a78586d5e57b40fdc6d040b900300ef6d">  232</a></span>&#160;    u64 <a class="code" href="structvcpu__svm.html#a78586d5e57b40fdc6d040b900300ef6d">virt_spec_ctrl</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">  234</a></span>&#160;    u32 *<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">  236</a></span>&#160;    ulong <a class="code" href="structvcpu__svm.html#a6fafc7c88cd9fcf600c03b6a74e9124a">nmi_iret_rip</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsvm__nested__state.html">svm_nested_state</a> <a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">/* NMI mask value, used when vNMI is not enabled */</span></div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">  241</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">nmi_masked</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">     * True when NMIs are still masked but guest IRET was just intercepted</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">     * and KVM is waiting for RIP to change, which will signal that the</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">     * intercepted IRET was retired and thus NMI can be unmasked.</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#ae94a883f2e559703aaa7b93d14a3810a">  248</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__svm.html#ae94a883f2e559703aaa7b93d14a3810a">awaiting_iret_completion</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">     * Set when KVM is awaiting IRET completion and needs to inject NMIs as</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">     * soon as the IRET completes (e.g. NMI is pending injection).  KVM</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">     * temporarily steals RFLAGS.TF to single-step the guest in this case</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">     * in order to regain control as soon as the NMI-blocking condition</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">     * goes away.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">  257</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">nmi_singlestep</a>;</div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">  258</a></span>&#160;    u64 <a class="code" href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">nmi_singlestep_guest_rflags</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">  260</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">nmi_l1_to_l2</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a7c4559533cfca9ae99de999b4c26d5fb">  262</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structvcpu__svm.html#a7c4559533cfca9ae99de999b4c26d5fb">soft_int_csbase</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a3a45518dab6750d2180fb4d5de532d76">  263</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structvcpu__svm.html#a3a45518dab6750d2180fb4d5de532d76">soft_int_old_rip</a>;</div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a47c387d2cf9e9df4331860eca2305fe6">  264</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structvcpu__svm.html#a47c387d2cf9e9df4331860eca2305fe6">soft_int_next_rip</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">  265</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">soft_int_injected</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a250d72e13c39c0c6d85a5e6c188554ce">  267</a></span>&#160;    u32 <a class="code" href="structvcpu__svm.html#a250d72e13c39c0c6d85a5e6c188554ce">ldr_reg</a>;</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#ae08ffe38b03c1c44686c57c274553f59">  268</a></span>&#160;    u32 <a class="code" href="structvcpu__svm.html#ae08ffe38b03c1c44686c57c274553f59">dfr_reg</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a2c8b33d5ae9b731a886634cd6c00165f">  269</a></span>&#160;    <span class="keyword">struct </span>page *<a class="code" href="structvcpu__svm.html#a2c8b33d5ae9b731a886634cd6c00165f">avic_backing_page</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#abc377a3a5f1f42e18f8a9044321f3d5b">  270</a></span>&#160;    u64 *<a class="code" href="structvcpu__svm.html#abc377a3a5f1f42e18f8a9044321f3d5b">avic_physical_id_cache</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">     * Per-vcpu list of struct amd_svm_iommu_ir:</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">     * This is used mainly to store interrupt remapping information used</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">     * when update the vcpu affinity. This avoids the need to scan for</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">     * IRTE and try to match ga_tag in the IOMMU driver.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">struct </span>list_head <a class="code" href="structvcpu__svm.html#af217181f505db1b71c48743233032539">ir_list</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#af38f3c63a81a10aae69b308aa175d618">  279</a></span>&#160;    spinlock_t <a class="code" href="structvcpu__svm.html#af38f3c63a81a10aae69b308aa175d618">ir_list_lock</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">/* Save desired MSR intercept (read: pass-through) state */</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="vmx_8c.html#a4a5b71928180de4229b920eec470bcaf">DECLARE_BITMAP</a>(read, <a class="code" href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">MAX_DIRECT_ACCESS_MSRS</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="vmx_8c.html#a4a5b71928180de4229b920eec470bcaf">DECLARE_BITMAP</a>(write, <a class="code" href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">MAX_DIRECT_ACCESS_MSRS</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#aa3288372e9c9edbcd129adb446479dfd">  285</a></span>&#160;    } <a class="code" href="structvcpu__svm.html#aa3288372e9c9edbcd129adb446479dfd">shadow_msr_intercept</a>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__sev__es__state.html">vcpu_sev_es_state</a> <a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a4969041ad5b96825f67160eb1ae9f726">  289</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__svm.html#a4969041ad5b96825f67160eb1ae9f726">guest_state_loaded</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#afbff2f35453153777bd80da134d164e0">  291</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__svm.html#afbff2f35453153777bd80da134d164e0">x2avic_msrs_intercepted</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">/* Guest GIF value, used when vGIF is not enabled */</span></div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="structvcpu__svm.html#a850f432012717e5e5be4064ae8f340ac">  294</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__svm.html#a850f432012717e5e5be4064ae8f340ac">guest_gif</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;};</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="structsvm__cpu__data.html">  297</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a> {</div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="structsvm__cpu__data.html#ab20eb4010776c6fe52661fcf95cdc017">  298</a></span>&#160;    u64 <a class="code" href="structsvm__cpu__data.html#ab20eb4010776c6fe52661fcf95cdc017">asid_generation</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="structsvm__cpu__data.html#a2e5110b54e6436c6a017892e0b4a37db">  299</a></span>&#160;    u32 <a class="code" href="structsvm__cpu__data.html#a2e5110b54e6436c6a017892e0b4a37db">max_asid</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="structsvm__cpu__data.html#a8dec08f7e08061480ab12f9b5426991d">  300</a></span>&#160;    u32 <a class="code" href="structsvm__cpu__data.html#a8dec08f7e08061480ab12f9b5426991d">next_asid</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="structsvm__cpu__data.html#a86b414e2f46215b5b4d4e0d7e207dd7a">  301</a></span>&#160;    u32 <a class="code" href="structsvm__cpu__data.html#a86b414e2f46215b5b4d4e0d7e207dd7a">min_asid</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">  303</a></span>&#160;    <span class="keyword">struct </span>page *<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="structsvm__cpu__data.html#a7b3be8bfedec131eb474be2ec6a8de10">  304</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structsvm__cpu__data.html#a7b3be8bfedec131eb474be2ec6a8de10">save_area_pa</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="structsvm__cpu__data.html#a5316200cc4682a70f7a1ec0cfccd9e55">  306</a></span>&#160;    <span class="keyword">struct </span>vmcb *<a class="code" href="structsvm__cpu__data.html#a5316200cc4682a70f7a1ec0cfccd9e55">current_vmcb</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">/* index = sev_asid, value = vmcb pointer */</span></div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="structsvm__cpu__data.html#af89c94b4ad75ed4396bb2f85415fcf38">  309</a></span>&#160;    <span class="keyword">struct </span>vmcb **<a class="code" href="structsvm__cpu__data.html#af89c94b4ad75ed4396bb2f85415fcf38">sev_vmcbs</a>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;};</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="svm_8h.html#a7c74743aeff41a938e6e8d1018bf871c">  312</a></span>&#160;<a class="code" href="svm_8h.html#a7c74743aeff41a938e6e8d1018bf871c">DECLARE_PER_CPU</a>(<span class="keyword">struct</span> <a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a>, svm_data);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">  316</a></span>&#160;<span class="keyword">static</span> __always_inline <span class="keyword">struct </span><a class="code" href="structkvm__svm.html">kvm_svm</a> *<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(<span class="keyword">struct</span> <a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a> *<a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a>)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;{</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> container_of(<a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a>, <span class="keyword">struct</span> <a class="code" href="structkvm__svm.html">kvm_svm</a>, <a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">  321</a></span>&#160;<span class="keyword">static</span> __always_inline <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(<span class="keyword">struct</span> <a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a> *<a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a>)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#ifdef CONFIG_KVM_AMD_SEV</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> *sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">return</span> sev-&gt;<a class="code" href="structkvm__sev__info.html#a6da81c9e8736479d0edee1c4e8813365">active</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">  332</a></span>&#160;<span class="keyword">static</span> __always_inline <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<span class="keyword">struct</span> kvm *kvm)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;{</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor">#ifdef CONFIG_KVM_AMD_SEV</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> *sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">return</span> sev-&gt;<a class="code" href="structkvm__sev__info.html#ab1e6fb4b7c55cdd34fdd230a7847d11a">es_active</a> &amp;&amp; !WARN_ON_ONCE(!sev-&gt;<a class="code" href="structkvm__sev__info.html#a6da81c9e8736479d0edee1c4e8813365">active</a>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb">  343</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb">vmcb_mark_all_dirty</a>(<span class="keyword">struct</span> vmcb *vmcb)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    vmcb-&gt;control.clean = 0;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="svm_8h.html#a64fd8d98c29189b4f4e47f96958aeeca">  348</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a64fd8d98c29189b4f4e47f96958aeeca">vmcb_mark_all_clean</a>(<span class="keyword">struct</span> vmcb *vmcb)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;{</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    vmcb-&gt;control.clean = <a class="code" href="svm_8h.html#a317277564d2351c6695a358504311483">VMCB_ALL_CLEAN_MASK</a></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                   &amp; ~<a class="code" href="svm_8h.html#a987416bb1857b96f97af2391d1008c5a">VMCB_ALWAYS_DIRTY_MASK</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">  354</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(<span class="keyword">struct</span> vmcb *vmcb, <span class="keywordtype">int</span> bit)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    vmcb-&gt;control.clean &amp;= ~(1 &lt;&lt; bit);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="svm_8h.html#af08dd89f5ee519835337165e9060f526">  359</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#af08dd89f5ee519835337165e9060f526">vmcb_is_dirty</a>(<span class="keyword">struct</span> vmcb *vmcb, <span class="keywordtype">int</span> bit)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">return</span> !test_bit(bit, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;vmcb-&gt;control.clean);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;}</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">  364</a></span>&#160;<span class="keyword">static</span> __always_inline <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<span class="keyword">struct</span> kvm_vcpu *<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;{</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> container_of(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, <span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a>, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"> * Only the PDPTRs are loaded on demand into the shadow MMU.  All other</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"> * fields are synchronized on VM-Exit, because accessing the VMCB is cheap.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"> * CR3 might be out of date in the VMCB but it is not marked dirty; instead,</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"> * KVM_REQ_LOAD_MMU_PGD is always requested when the cached vcpu-&gt;arch.cr3</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"> * is changed.  svm_load_mmu_pgd() then syncs the new CR3 value into the VMCB.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="svm_8h.html#a45c751b4204124bee221bec64ada4d72">  377</a></span>&#160;<span class="preprocessor">#define SVM_REGS_LAZY_LOAD_SET  (1 &lt;&lt; VCPU_EXREG_PDPTR)</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">  379</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(<span class="keyword">struct</span> vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>, u32 bit)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;{</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    WARN_ON_ONCE(bit &gt;= 32 * MAX_INTERCEPT);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    __set_bit(bit, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">  385</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a>(<span class="keyword">struct</span> vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>, u32 bit)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;{</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    WARN_ON_ONCE(bit &gt;= 32 * MAX_INTERCEPT);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    __clear_bit(bit, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79">  391</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79">vmcb_is_intercept</a>(<span class="keyword">struct</span> vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>, u32 bit)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    WARN_ON_ONCE(bit &gt;= 32 * MAX_INTERCEPT);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">return</span> test_bit(bit, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">  397</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a>(<span class="keyword">struct</span> <a class="code" href="structvmcb__ctrl__area__cached.html">vmcb_ctrl_area_cached</a> *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>, u32 bit)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;{</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    WARN_ON_ONCE(bit &gt;= 32 * MAX_INTERCEPT);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">return</span> test_bit(bit, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">  403</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, u32 bit)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    WARN_ON_ONCE(bit &gt;= 32);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_EXCEPTION_OFFSET + bit);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(svm);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">  413</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, u32 bit)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;{</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    WARN_ON_ONCE(bit &gt;= 32);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_EXCEPTION_OFFSET + bit);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(svm);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">  423</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keywordtype">int</span> bit)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;{</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, bit);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(svm);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="svm_8h.html#a4c285d86fd94954273295b317242c500">  432</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keywordtype">int</span> bit)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;{</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a>(&amp;vmcb-&gt;control, bit);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(svm);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">  441</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keywordtype">int</span> bit)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;{</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79">vmcb_is_intercept</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control, bit);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e">  446</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e">nested_vgif_enabled</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;{</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_VGIF) &amp;&amp;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;           (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp; V_GIF_ENABLE_MASK);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">  452</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span>vmcb *<a class="code" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">get_vgif_vmcb</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; !<a class="code" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e">nested_vgif_enabled</a>(svm))</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64">  463</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64">enable_gif</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;{</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = <a class="code" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">get_vgif_vmcb</a>(svm);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">if</span> (vmcb)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        vmcb-&gt;control.int_ctl |= V_GIF_MASK;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a850f432012717e5e5be4064ae8f340ac">guest_gif</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="svm_8h.html#a711d42f525aa791008754514284a556c">  473</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a711d42f525aa791008754514284a556c">disable_gif</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;{</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = <a class="code" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">get_vgif_vmcb</a>(svm);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (vmcb)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        vmcb-&gt;control.int_ctl &amp;= ~V_GIF_MASK;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a850f432012717e5e5be4064ae8f340ac">guest_gif</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">  483</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = <a class="code" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">get_vgif_vmcb</a>(svm);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> (vmcb)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">return</span> !!(vmcb-&gt;control.int_ctl &amp; V_GIF_MASK);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#a850f432012717e5e5be4064ae8f340ac">guest_gif</a>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc">  493</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc">nested_npt_enabled</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;{</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a64059f1364084ba55fe82bf69f0704dd">nested_ctl</a> &amp; SVM_NESTED_CTL_NP_ENABLE;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="svm_8h.html#ab452fafde694bb5dfd7c6dfc5707ae12">  498</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#ab452fafde694bb5dfd7c6dfc5707ae12">nested_vnmi_enabled</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;{</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_VNMI) &amp;&amp;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;           (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp; V_NMI_ENABLE_MASK);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="svm_8h.html#a7787ebf653e664e7dda7c3b0a8dfa84b">  504</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a7787ebf653e664e7dda7c3b0a8dfa84b">is_x2apic_msrpm_offset</a>(u32 offset)</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;{</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">/* 4 msrs per u8, and 4 u8 in u32 */</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    u32 msr = offset * 16;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span> (msr &gt;= APIC_BASE_MSR) &amp;&amp;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;           (msr &lt; (APIC_BASE_MSR + 0x100));</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8">  513</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span>vmcb *<a class="code" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8">get_vnmi_vmcb_l1</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;{</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a>)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">  524</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">is_vnmi_enabled</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = <a class="code" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8">get_vnmi_vmcb_l1</a>(svm);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">if</span> (vmcb)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">return</span> !!(vmcb-&gt;control.int_ctl &amp; V_NMI_ENABLE_MASK);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">/* svm.c */</span></div>
<div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">  535</a></span>&#160;<span class="preprocessor">#define MSR_INVALID             0xffffffffU</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="svm_8h.html#acfd26afe0ecab7e00defb0b34eb0a94a">  537</a></span>&#160;<span class="preprocessor">#define DEBUGCTL_RESERVED_BITS (~(0x3fULL))</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a8be79ef0522e29a602517b51ff51f509">dump_invalid_vmcb</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;u32 <a class="code" href="svm_8h.html#a35438091c40e77c617ce2ec9d521cc1f">svm_msrpm_offset</a>(u32 msr);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;u32 *<a class="code" href="svm_8h.html#aaf821ba71761474726fdfb616796a0c8">svm_vcpu_alloc_msrpm</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#aaee43a83fe8c444128a4d22b2d5d5c21">svm_vcpu_init_msrpm</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u32 *msrpm);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a67937d45023d92583b0bd363c73b6c2b">svm_vcpu_free_msrpm</a>(u32 *msrpm);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a06d8a6a899d49f3235ec1294d1943c84">svm_copy_lbrs</a>(<span class="keyword">struct</span> vmcb *to_vmcb, <span class="keyword">struct</span> vmcb *from_vmcb);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ad5aa214e23ea9ec9418bebbe889d41ef">svm_update_lbrv</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a5df90c8772700a60441f2ba19472f726">svm_set_efer</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u64 efer);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a1a9474f1273be079ac4f3c1320093c3d">svm_set_cr0</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> cr0);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#aec23ca96447aab4ff19f594a297bc109">svm_set_cr4</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> cr4);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a7ff4c846a46f6bb2e429d79bbc18f052">disable_nmi_singlestep</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="svm_8h.html#a88b3351baf8190bdefb4b8a113159deb">  552</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a88b3351baf8190bdefb4b8a113159deb">svm_smi_blocked</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a37477553ea45acae098350e7d572ae2e">svm_nmi_blocked</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a67762809a8b14687a3bffdd5a4cd03aa">svm_interrupt_blocked</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keywordtype">bool</span> value);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a8afafecae406016532810194f187fe2c">svm_invoke_exit_handler</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u64 exit_code);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u32 *msrpm, u32 msr,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;              <span class="keywordtype">int</span> read, <span class="keywordtype">int</span> write);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#addc2bf7bff76340928f122fbde134c2a">svm_set_x2apic_msr_interception</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keywordtype">bool</span> disable);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#affe9512dad96b228e24b8cc7175db04c">svm_complete_interrupt_delivery</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">int</span> delivery_mode,</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                     <span class="keywordtype">int</span> trig_mode, <span class="keywordtype">int</span> vec);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">/* nested.c */</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="svm_8h.html#a5d1cfc3512b22eae96df1b679e87a92e">  565</a></span>&#160;<span class="preprocessor">#define NESTED_EXIT_HOST    0   </span><span class="comment">/* Exit handled on host level */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="svm_8h.html#a9c953f5ab9b400e9a1c5232515ec6293">  566</a></span>&#160;<span class="preprocessor">#define NESTED_EXIT_DONE    1   </span><span class="comment">/* Exit caused nested vmexit  */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="svm_8h.html#ac75660e3dace3bef9ab0d76dedf2034e">  567</a></span>&#160;<span class="preprocessor">#define NESTED_EXIT_CONTINUE    2   </span><span class="comment">/* Further checks needed      */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a">  569</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a">nested_svm_virtualize_tpr</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;{</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp; V_INTR_MASKING_MASK);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno"><a class="line" href="svm_8h.html#a61ac82c942842848fab805e84fc70189">  576</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a61ac82c942842848fab805e84fc70189">nested_exit_on_smi</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;{</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>, INTERCEPT_SMI);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;}</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno"><a class="line" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141">  581</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141">nested_exit_on_intr</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;{</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>, INTERCEPT_INTR);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346">  586</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346">nested_exit_on_nmi</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;{</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>, INTERCEPT_NMI);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#afb7dae2607f5d00a49d6baae5747d57a">enter_svm_guest_mode</a>(<span class="keyword">struct</span> kvm_vcpu *<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>,</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;             u64 vmcb_gpa, <span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a> *vmcb12, <span class="keywordtype">bool</span> from_vmrun);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#afea614d490148481c96faf7c1b5ecb11">svm_leave_nested</a>(<span class="keyword">struct</span> kvm_vcpu *<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a690337312a648d2948b22540da6f031e">svm_free_nested</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#aaeebe6cee9f13a0540cbd9b696648a1d">svm_allocate_nested</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a4ec7e878f6af209e74dd84285ee0198f">nested_svm_vmrun</a>(<span class="keyword">struct</span> kvm_vcpu *<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#aefe90b7232034ee5f45a41f108ffb891">svm_copy_vmrun_state</a>(<span class="keyword">struct</span> vmcb_save_area *to_save,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;              <span class="keyword">struct</span> vmcb_save_area *from_save);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ae2a559173016267c3c1ef55be6571c0c">svm_copy_vmloadsave_state</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a> *to_vmcb, <span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a> *from_vmcb);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a73d1cb9b9fcfa112138681d9080a1c05">nested_svm_vmexit</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b">  602</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b">nested_svm_simple_vmexit</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, u32 exit_code)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;{</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code   = exit_code;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1 = 0;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2 = 0;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a73d1cb9b9fcfa112138681d9080a1c05">nested_svm_vmexit</a>(svm);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a777240cb9ab00451d21a1b204e19c5a6">nested_svm_exit_handled</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a8907fcb136a33618dbbc1c2b7d3872f8">nested_svm_check_permissions</a>(<span class="keyword">struct</span> kvm_vcpu *<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="svm_8h.html#a869cefc2d0dabd5e6c07940e88a4acfe">  612</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a869cefc2d0dabd5e6c07940e88a4acfe">nested_svm_check_exception</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keywordtype">unsigned</span> nr,</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                   <span class="keywordtype">bool</span> has_error_code, u32 error_code);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#abfe06c5436ae4d724c3c4495f8af136d">nested_svm_exit_special</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ae003d7b6aae84aa9b70d64f464e70dfc">nested_svm_update_tsc_ratio_msr</a>(<span class="keyword">struct</span> kvm_vcpu *<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ad9a1b45b05505f9435cc2d1dd1c37943">svm_write_tsc_multiplier</a>(<span class="keyword">struct</span> kvm_vcpu *<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#add5ee1e85234f2457480494694865c21">nested_copy_vmcb_control_to_cache</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm,</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                       <span class="keyword">struct</span> vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ae052404bed168cf69c578a697ce25526">nested_copy_vmcb_save_to_cache</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                    <span class="keyword">struct</span> vmcb_save_area *save);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a232d9e4f1731f0d495e3b4f9d530d0ee">nested_sync_control_from_vmcb02</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a5124cfade7c6ad2a6e136fdd0391f0a2">nested_vmcb02_compute_g_pat</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keyword">struct</span> <a class="code" href="structkvm__vmcb__info.html">kvm_vmcb_info</a> *target_vmcb);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="keyword">extern</span> <span class="keyword">struct </span>kvm_x86_nested_ops <a class="code" href="svm_8h.html#a02e1632739fc6a1f76c81a50cc4a97ac">svm_nested_ops</a>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">/* avic.c */</span></div>
<div class="line"><a name="l00628"></a><span class="lineno"><a class="line" href="svm_8h.html#af3af5258a6c47113ee5b5898437dd7df">  628</a></span>&#160;<span class="preprocessor">#define AVIC_REQUIRED_APICV_INHIBITS            \</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="preprocessor">(                           \</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_DISABLE) |     \</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_ABSENT) |      \</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_HYPERV) |      \</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_NESTED) |      \</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_IRQWIN) |      \</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_PIT_REINJ) |       \</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_BLOCKIRQ) |        \</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_SEV)      |        \</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_PHYSICAL_ID_ALIASED) | \</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_APIC_ID_MODIFIED) |    \</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_APIC_BASE_MODIFIED) |  \</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor">    BIT(APICV_INHIBIT_REASON_LOGICAL_ID_ALIASED)    \</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">)</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="svm_8h.html#ada833d2b35b3e565a6900b25d1cce7c7">avic_hardware_setup</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#af75098185942f8eb5703b2b65bf9257d">avic_ga_log_notifier</a>(u32 ga_tag);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a3bb736e8688ecfaa3696b347764fd37d">avic_vm_destroy</a>(<span class="keyword">struct</span> kvm *kvm);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a0ddedac4b0b428928fae6bc9fe902e2a">avic_vm_init</a>(<span class="keyword">struct</span> kvm *kvm);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a40f16bbe281410ac02865ea25c26bf12">avic_init_vmcb</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keyword">struct</span> vmcb *vmcb);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a4a11c0014568405b90307ef68285e4ff">avic_incomplete_ipi_interception</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a299de3990a5ce5ce873df7afe2b3338f">avic_unaccelerated_access_interception</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a8e0a22138080054f4ac064064402f74a">avic_init_vcpu</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a7decdbafc7d47b2241e68ce3c90a9779">avic_vcpu_load</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">int</span> cpu);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a461f968598a11484e76a07fb87221bf2">avic_vcpu_put</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ae9f162404fdb37bba372d0c9cdc043ee">avic_apicv_post_state_restore</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#affcdeac6765016e970e33d6ecff3eebb">avic_refresh_apicv_exec_ctrl</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a3a8b145ddec7a3dc1367a4e4e0df397e">avic_pi_update_irte</a>(<span class="keyword">struct</span> kvm *kvm, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> host_irq,</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            uint32_t guest_irq, <span class="keywordtype">bool</span> set);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a056e12caaf24f044fce8545a863dbbce">avic_vcpu_blocking</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a7e341d7f17b2f611aca180217cfc6ad3">avic_vcpu_unblocking</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ac8c9ded2546dccf6e4b561e633d22e7e">avic_ring_doorbell</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="svm_8h.html#aed65a2dabdad6a421b487e1e7b106277">avic_vcpu_get_apicv_inhibit_reasons</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a51356c24441683c197e1d4c2555da06d">avic_refresh_virtual_apic_mode</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">/* sev.c */</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="svm_8h.html#af4810b27551dd12e44459d9444873eb0">  667</a></span>&#160;<span class="preprocessor">#define GHCB_VERSION_MAX    1ULL</span></div>
<div class="line"><a name="l00668"></a><span class="lineno"><a class="line" href="svm_8h.html#ab146f6f540f9544ae3b4efaceae107c8">  668</a></span>&#160;<span class="preprocessor">#define GHCB_VERSION_MIN    1ULL</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#af1eb77eac84f085b0a943b87f783e30d">sev_vm_destroy</a>(<span class="keyword">struct</span> kvm *kvm);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a2039644d359270872404c4664a25d951">sev_mem_enc_ioctl</a>(<span class="keyword">struct</span> kvm *kvm, <span class="keywordtype">void</span> __user *argp);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#ab37c3ce91ad0ad98fb7d5676a318cde4">sev_mem_enc_register_region</a>(<span class="keyword">struct</span> kvm *kvm,</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <span class="keyword">struct</span> kvm_enc_region *range);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a8ed6164c0df5d13f87bce2be5a83e0d8">sev_mem_enc_unregister_region</a>(<span class="keyword">struct</span> kvm *kvm,</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                  <span class="keyword">struct</span> kvm_enc_region *range);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a3b1ae3550c1b7c9973532d08d167ce2c">sev_vm_copy_enc_context_from</a>(<span class="keyword">struct</span> kvm *kvm, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> source_fd);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#abe3c569b297da3b78824074b8c08f9a7">sev_vm_move_enc_context_from</a>(<span class="keyword">struct</span> kvm *kvm, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> source_fd);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ad965a231dbcd0eb9eacac28848a143a8">sev_guest_memory_reclaimed</a>(<span class="keyword">struct</span> kvm *kvm);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ad0a040a48a04ab47d0af3385ad214cd4">pre_sev_run</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keywordtype">int</span> cpu);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="keywordtype">void</span> __init <a class="code" href="svm_8h.html#aeaff9c624af59b36fd36d1c25e279a50">sev_set_cpu_caps</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="keywordtype">void</span> __init <a class="code" href="svm_8h.html#a9afc6299b4f92c15a93b02db0318ad79">sev_hardware_setup</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a0bc306a80e6f2622f2c58d1271dcc05b">sev_hardware_unsetup</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a87f63ae4bc207e3d5a5d80e34243cf50">sev_cpu_init</a>(<span class="keyword">struct</span> <a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a> *sd);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#abe289006ed99e36825065ad80cf7480f">sev_init_vmcb</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a00c492279a529b66b80ed039ae6de23b">sev_vcpu_after_set_cpuid</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#af343f7dd067883e0f81017a68e854c09">sev_free_vcpu</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#aac550422551b71c0afe8efe176e0b55d">sev_handle_vmgexit</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keywordtype">int</span> <a class="code" href="svm_8h.html#a8381dc2e2d38fd331490bbb2fd097d0a">sev_es_string_io</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keywordtype">int</span> size, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> port, <span class="keywordtype">int</span> in);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#aa924db70d759d98124ad13172de1f0c5">sev_es_vcpu_reset</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#a9809425cf0d198f1c65811a4716ceecf">sev_vcpu_deliver_sipi_vector</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u8 vector);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#ad4655e18a7969aeb0228ecbbc011f546">sev_es_prepare_switch_to_guest</a>(<span class="keyword">struct</span> sev_es_save_area *hostsa);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#aba11fc99cad465d138aeb5c2cb3508e2">sev_es_unmap_ghcb</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">/* vmenter.S */</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno"><a class="line" href="svm_8h.html#aba6feca2fbeab5686eaf28f921a819f7">  700</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#aba6feca2fbeab5686eaf28f921a819f7">__svm_sev_es_vcpu_run</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keywordtype">bool</span> spec_ctrl_intercepted);</div>
<div class="line"><a name="l00701"></a><span class="lineno"><a class="line" href="svm_8h.html#abedd386d3abba4edb2cf133ab91c57f3">  701</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="svm_8h.html#abedd386d3abba4edb2cf133ab91c57f3">__svm_vcpu_run</a>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keywordtype">bool</span> spec_ctrl_intercepted);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">  703</a></span>&#160;<span class="preprocessor">#define DEFINE_KVM_GHCB_ACCESSORS(field)                        \</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="preprocessor">    static __always_inline bool kvm_ghcb_##field##_is_valid(const struct vcpu_svm *svm) \</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="preprocessor">    {                                   \</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="preprocessor">        return test_bit(GHCB_BITMAP_IDX(field),             \</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="preprocessor">                (unsigned long *)&amp;svm-&gt;sev_es.valid_bitmap);    \</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="preprocessor">    }                                   \</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="preprocessor">                                        \</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="preprocessor">    static __always_inline u64 kvm_ghcb_get_##field##_if_valid(struct vcpu_svm *svm, struct ghcb *ghcb) \</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="preprocessor">    {                                   \</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="preprocessor">        return kvm_ghcb_##field##_is_valid(svm) ? ghcb-&gt;save.field : 0; \</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="preprocessor">    }                                   \</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(cpl)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(rax)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(rcx)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(rdx)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(rbx)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(rsi)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(sw_exit_code)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(sw_exit_info_1)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(sw_exit_info_2)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(sw_scratch)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<a class="code" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(xcr0)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="acpuid_8h_html"><div class="ttname"><a href="cpuid_8h.html">cpuid.h</a></div></div>
<div class="ttc" id="acpuid_8h_html_acf67f5848a2ddd59dc852e37bc330390"><div class="ttname"><a href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a></div><div class="ttdeci">static __always_inline bool guest_can_use(struct kvm_vcpu *vcpu, unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00278">cpuid.h:278</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html"><div class="ttname"><a href="kvm__cache__regs_8h.html">kvm_cache_regs.h</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_afbcfc413ceedb460734eb5fd7c5c4fbc"><div class="ttname"><a href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a></div><div class="ttdeci">static bool is_guest_mode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00226">kvm_cache_regs.h:226</a></div></div>
<div class="ttc" id="aposted__intr_8h_html_ae3d3aff52ed2ae9f00a97cfda9ceca6d"><div class="ttname"><a href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a></div><div class="ttdeci">u64 control</div><div class="ttdef"><b>Definition:</b> <a href="posted__intr_8h_source.html#l00016">posted_intr.h:16</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html"><div class="ttname"><a href="structkvm__sev__info.html">kvm_sev_info</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00079">svm.h:79</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a06c28c2c468a938dfb454dc2dc3808ab"><div class="ttname"><a href="structkvm__sev__info.html#a06c28c2c468a938dfb454dc2dc3808ab">kvm_sev_info::pages_locked</a></div><div class="ttdeci">unsigned long pages_locked</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00085">svm.h:85</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a229b95df6e061397ed598e97dffea3c3"><div class="ttname"><a href="structkvm__sev__info.html#a229b95df6e061397ed598e97dffea3c3">kvm_sev_info::enc_context_owner</a></div><div class="ttdeci">struct kvm * enc_context_owner</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00088">svm.h:88</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a26a5ef264d242712a64ff06e8eb2bba7"><div class="ttname"><a href="structkvm__sev__info.html#a26a5ef264d242712a64ff06e8eb2bba7">kvm_sev_info::migration_in_progress</a></div><div class="ttdeci">atomic_t migration_in_progress</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00092">svm.h:92</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a567d59358620c89779269a808be2b8b7"><div class="ttname"><a href="structkvm__sev__info.html#a567d59358620c89779269a808be2b8b7">kvm_sev_info::mirror_entry</a></div><div class="ttdeci">struct list_head mirror_entry</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00088">svm.h:90</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a6da81c9e8736479d0edee1c4e8813365"><div class="ttname"><a href="structkvm__sev__info.html#a6da81c9e8736479d0edee1c4e8813365">kvm_sev_info::active</a></div><div class="ttdeci">bool active</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00080">svm.h:80</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a786e349e8aa7806f21b4893b0f30d225"><div class="ttname"><a href="structkvm__sev__info.html#a786e349e8aa7806f21b4893b0f30d225">kvm_sev_info::ap_jump_table</a></div><div class="ttdeci">u64 ap_jump_table</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00087">svm.h:87</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a7901eb8db0b44a6cff20fe30c41d6a3f"><div class="ttname"><a href="structkvm__sev__info.html#a7901eb8db0b44a6cff20fe30c41d6a3f">kvm_sev_info::regions_list</a></div><div class="ttdeci">struct list_head regions_list</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00085">svm.h:86</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_ab1e6fb4b7c55cdd34fdd230a7847d11a"><div class="ttname"><a href="structkvm__sev__info.html#ab1e6fb4b7c55cdd34fdd230a7847d11a">kvm_sev_info::es_active</a></div><div class="ttdeci">bool es_active</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00081">svm.h:81</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_abef33415f75cf8cc6117da1c09136c9e"><div class="ttname"><a href="structkvm__sev__info.html#abef33415f75cf8cc6117da1c09136c9e">kvm_sev_info::misc_cg</a></div><div class="ttdeci">struct misc_cg * misc_cg</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00091">svm.h:91</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_ad75defd37a304bbb1e3b0123ea417d95"><div class="ttname"><a href="structkvm__sev__info.html#ad75defd37a304bbb1e3b0123ea417d95">kvm_sev_info::handle</a></div><div class="ttdeci">unsigned int handle</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00083">svm.h:83</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_ae3b8494e7fae1c09a80314c72f4806b0"><div class="ttname"><a href="structkvm__sev__info.html#ae3b8494e7fae1c09a80314c72f4806b0">kvm_sev_info::mirror_vms</a></div><div class="ttdeci">struct list_head mirror_vms</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00088">svm.h:89</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_ae81641c3ab02ddd91e7a094c673e9088"><div class="ttname"><a href="structkvm__sev__info.html#ae81641c3ab02ddd91e7a094c673e9088">kvm_sev_info::asid</a></div><div class="ttdeci">unsigned int asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00082">svm.h:82</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_aecf16aee273c40c0f150e82111e3c30d"><div class="ttname"><a href="structkvm__sev__info.html#aecf16aee273c40c0f150e82111e3c30d">kvm_sev_info::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00084">svm.h:84</a></div></div>
<div class="ttc" id="astructkvm__svm_html"><div class="ttname"><a href="structkvm__svm.html">kvm_svm</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00095">svm.h:95</a></div></div>
<div class="ttc" id="astructkvm__svm_html_a06c4479d5aefb8c19b8ead15d599b324"><div class="ttname"><a href="structkvm__svm.html#a06c4479d5aefb8c19b8ead15d599b324">kvm_svm::avic_vm_id</a></div><div class="ttdeci">u32 avic_vm_id</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00099">svm.h:99</a></div></div>
<div class="ttc" id="astructkvm__svm_html_a4f8eab5b98a43c0a7402d15663d4e032"><div class="ttname"><a href="structkvm__svm.html#a4f8eab5b98a43c0a7402d15663d4e032">kvm_svm::hnode</a></div><div class="ttdeci">struct hlist_node hnode</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00101">svm.h:102</a></div></div>
<div class="ttc" id="astructkvm__svm_html_a743b2106389f26a042ce5ac8166afd73"><div class="ttname"><a href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">kvm_svm::sev_info</a></div><div class="ttdeci">struct kvm_sev_info sev_info</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00101">svm.h:104</a></div></div>
<div class="ttc" id="astructkvm__svm_html_a837dca12e3d1d7b768feb04c6a3c2e96"><div class="ttname"><a href="structkvm__svm.html#a837dca12e3d1d7b768feb04c6a3c2e96">kvm_svm::avic_logical_id_table_page</a></div><div class="ttdeci">struct page * avic_logical_id_table_page</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00100">svm.h:100</a></div></div>
<div class="ttc" id="astructkvm__svm_html_aa05522988cc0a3ce6ad59dcec1ed0c46"><div class="ttname"><a href="structkvm__svm.html#aa05522988cc0a3ce6ad59dcec1ed0c46">kvm_svm::avic_physical_id_table_page</a></div><div class="ttdeci">struct page * avic_physical_id_table_page</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00101">svm.h:101</a></div></div>
<div class="ttc" id="astructkvm__svm_html_ade6c6ec6e820a10719c5d61e161aa8b8"><div class="ttname"><a href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm_svm::kvm</a></div><div class="ttdeci">struct kvm kvm</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00092">svm.h:96</a></div></div>
<div class="ttc" id="astructkvm__vmcb__info_html"><div class="ttname"><a href="structkvm__vmcb__info.html">kvm_vmcb_info</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00109">svm.h:109</a></div></div>
<div class="ttc" id="astructkvm__vmcb__info_html_a48661ae4516f12bd14f4cc4121700a90"><div class="ttname"><a href="structkvm__vmcb__info.html#a48661ae4516f12bd14f4cc4121700a90">kvm_vmcb_info::asid_generation</a></div><div class="ttdeci">uint64_t asid_generation</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00113">svm.h:113</a></div></div>
<div class="ttc" id="astructkvm__vmcb__info_html_a77727aa5326106aedb6630f4100578ec"><div class="ttname"><a href="structkvm__vmcb__info.html#a77727aa5326106aedb6630f4100578ec">kvm_vmcb_info::cpu</a></div><div class="ttdeci">int cpu</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00112">svm.h:112</a></div></div>
<div class="ttc" id="astructkvm__vmcb__info_html_a8076921f239564576af7af19be7f6f04"><div class="ttname"><a href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">kvm_vmcb_info::ptr</a></div><div class="ttdeci">struct vmcb * ptr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00110">svm.h:110</a></div></div>
<div class="ttc" id="astructkvm__vmcb__info_html_a91e376066b465faac6f37deac812bee5"><div class="ttname"><a href="structkvm__vmcb__info.html#a91e376066b465faac6f37deac812bee5">kvm_vmcb_info::pa</a></div><div class="ttdeci">unsigned long pa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00111">svm.h:111</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html"><div class="ttname"><a href="structsvm__cpu__data.html">svm_cpu_data</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00297">svm.h:297</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_a2e5110b54e6436c6a017892e0b4a37db"><div class="ttname"><a href="structsvm__cpu__data.html#a2e5110b54e6436c6a017892e0b4a37db">svm_cpu_data::max_asid</a></div><div class="ttdeci">u32 max_asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00299">svm.h:299</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_a5316200cc4682a70f7a1ec0cfccd9e55"><div class="ttname"><a href="structsvm__cpu__data.html#a5316200cc4682a70f7a1ec0cfccd9e55">svm_cpu_data::current_vmcb</a></div><div class="ttdeci">struct vmcb * current_vmcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00306">svm.h:306</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_a7b3be8bfedec131eb474be2ec6a8de10"><div class="ttname"><a href="structsvm__cpu__data.html#a7b3be8bfedec131eb474be2ec6a8de10">svm_cpu_data::save_area_pa</a></div><div class="ttdeci">unsigned long save_area_pa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00304">svm.h:304</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_a86b414e2f46215b5b4d4e0d7e207dd7a"><div class="ttname"><a href="structsvm__cpu__data.html#a86b414e2f46215b5b4d4e0d7e207dd7a">svm_cpu_data::min_asid</a></div><div class="ttdeci">u32 min_asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00301">svm.h:301</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_a8dec08f7e08061480ab12f9b5426991d"><div class="ttname"><a href="structsvm__cpu__data.html#a8dec08f7e08061480ab12f9b5426991d">svm_cpu_data::next_asid</a></div><div class="ttdeci">u32 next_asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00300">svm.h:300</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_ab20eb4010776c6fe52661fcf95cdc017"><div class="ttname"><a href="structsvm__cpu__data.html#ab20eb4010776c6fe52661fcf95cdc017">svm_cpu_data::asid_generation</a></div><div class="ttdeci">u64 asid_generation</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00298">svm.h:298</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_ac7d670a65f2dda678bc5f58478c5ebbc"><div class="ttname"><a href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">svm_cpu_data::save_area</a></div><div class="ttdeci">struct page * save_area</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00303">svm.h:303</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_af89c94b4ad75ed4396bb2f85415fcf38"><div class="ttname"><a href="structsvm__cpu__data.html#af89c94b4ad75ed4396bb2f85415fcf38">svm_cpu_data::sev_vmcbs</a></div><div class="ttdeci">struct vmcb ** sev_vmcbs</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00309">svm.h:309</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html"><div class="ttname"><a href="structsvm__nested__state.html">svm_nested_state</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00158">svm.h:158</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a07d2ebcca90ff4e7e8469a1cf7f720fe"><div class="ttname"><a href="structsvm__nested__state.html#a07d2ebcca90ff4e7e8469a1cf7f720fe">svm_nested_state::vm_cr_msr</a></div><div class="ttdeci">u64 vm_cr_msr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00161">svm.h:161</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a16894147af263784cff5f93602e97a54"><div class="ttname"><a href="structsvm__nested__state.html#a16894147af263784cff5f93602e97a54">svm_nested_state::vmcb12_gpa</a></div><div class="ttdeci">u64 vmcb12_gpa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00162">svm.h:162</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a280879c3a0fa081ac14507bec27f0727"><div class="ttname"><a href="structsvm__nested__state.html#a280879c3a0fa081ac14507bec27f0727">svm_nested_state::initialized</a></div><div class="ttdeci">bool initialized</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00181">svm.h:181</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a32951ee4dfbf17d414fcdad2d336b25b"><div class="ttname"><a href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">svm_nested_state::nested_run_pending</a></div><div class="ttdeci">bool nested_run_pending</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00170">svm.h:170</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a3b275e369200f402f9d5765babb77629"><div class="ttname"><a href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">svm_nested_state::ctl</a></div><div class="ttdeci">struct vmcb_ctrl_area_cached ctl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00170">svm.h:173</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a3ca397932611001996adc12f53f7247c"><div class="ttname"><a href="structsvm__nested__state.html#a3ca397932611001996adc12f53f7247c">svm_nested_state::save</a></div><div class="ttdeci">struct vmcb_save_area_cached save</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00170">svm.h:179</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a469889e41a4042539ad55c80ed27ec48"><div class="ttname"><a href="structsvm__nested__state.html#a469889e41a4042539ad55c80ed27ec48">svm_nested_state::last_vmcb12_gpa</a></div><div class="ttdeci">u64 last_vmcb12_gpa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00163">svm.h:163</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a53278329495133b9cb2bd06db36a92a0"><div class="ttname"><a href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">svm_nested_state::vmcb02</a></div><div class="ttdeci">struct kvm_vmcb_info vmcb02</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00154">svm.h:159</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_ab518a0d0e52def0384b5a65321ea2854"><div class="ttname"><a href="structsvm__nested__state.html#ab518a0d0e52def0384b5a65321ea2854">svm_nested_state::force_msr_bitmap_recalc</a></div><div class="ttdeci">bool force_msr_bitmap_recalc</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00190">svm.h:190</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_abb9c6243e2a90048413ab9d68a450e45"><div class="ttname"><a href="structsvm__nested__state.html#abb9c6243e2a90048413ab9d68a450e45">svm_nested_state::hsave_msr</a></div><div class="ttdeci">u64 hsave_msr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00160">svm.h:160</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_ac977ad2b258ba3df647e360fa11c7198"><div class="ttname"><a href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">svm_nested_state::msrpm</a></div><div class="ttdeci">u32 * msrpm</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00166">svm.h:166</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html"><div class="ttname"><a href="structvcpu__sev__es__state.html">vcpu_sev_es_state</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00193">svm.h:193</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_a1288c35c0ce7f08e31b6e56639cfc17c"><div class="ttname"><a href="structvcpu__sev__es__state.html#a1288c35c0ce7f08e31b6e56639cfc17c">vcpu_sev_es_state::ghcb_sa_len</a></div><div class="ttdeci">u32 ghcb_sa_len</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00204">svm.h:204</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_a33488936e12f96b72916b86d5217b91b"><div class="ttname"><a href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">vcpu_sev_es_state::ghcb_sa</a></div><div class="ttdeci">void * ghcb_sa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00203">svm.h:203</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_a40070a764eb6f9ab2573d7961a0c6f8e"><div class="ttname"><a href="structvcpu__sev__es__state.html#a40070a764eb6f9ab2573d7961a0c6f8e">vcpu_sev_es_state::vmsa</a></div><div class="ttdeci">struct sev_es_save_area * vmsa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00195">svm.h:195</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_a62f326875a1cbab9d4673ab3f5a34169"><div class="ttname"><a href="structvcpu__sev__es__state.html#a62f326875a1cbab9d4673ab3f5a34169">vcpu_sev_es_state::received_first_sipi</a></div><div class="ttdeci">bool received_first_sipi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00199">svm.h:199</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_aadd3d1bc5bf29afb297714dcaf151aba"><div class="ttname"><a href="structvcpu__sev__es__state.html#aadd3d1bc5bf29afb297714dcaf151aba">vcpu_sev_es_state::ghcb_map</a></div><div class="ttdeci">struct kvm_host_map ghcb_map</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00197">svm.h:198</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_aafb2527aebe81e9eefaa798f5eeca497"><div class="ttname"><a href="structvcpu__sev__es__state.html#aafb2527aebe81e9eefaa798f5eeca497">vcpu_sev_es_state::sw_scratch</a></div><div class="ttdeci">u64 sw_scratch</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00202">svm.h:202</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_ab1e4599fd131a0afb3a9c5bda4901a6e"><div class="ttname"><a href="structvcpu__sev__es__state.html#ab1e4599fd131a0afb3a9c5bda4901a6e">vcpu_sev_es_state::valid_bitmap</a></div><div class="ttdeci">u8 valid_bitmap[16]</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00197">svm.h:197</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_abb6b1331553e74269e36bf08c13b710c"><div class="ttname"><a href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">vcpu_sev_es_state::ghcb</a></div><div class="ttdeci">struct ghcb * ghcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00196">svm.h:196</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_acdd2e394133423adbb11b59872ab0121"><div class="ttname"><a href="structvcpu__sev__es__state.html#acdd2e394133423adbb11b59872ab0121">vcpu_sev_es_state::ghcb_sa_free</a></div><div class="ttdeci">bool ghcb_sa_free</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00206">svm.h:206</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_ae0158f4a111e910e8777324a10286cec"><div class="ttname"><a href="structvcpu__sev__es__state.html#ae0158f4a111e910e8777324a10286cec">vcpu_sev_es_state::ghcb_sa_sync</a></div><div class="ttdeci">bool ghcb_sa_sync</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00205">svm.h:205</a></div></div>
<div class="ttc" id="astructvcpu__svm_html"><div class="ttname"><a href="structvcpu__svm.html">vcpu_svm</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00209">svm.h:209</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a0e952848b035cc09ad04859f6363acbf"><div class="ttname"><a href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">vcpu_svm::nmi_singlestep</a></div><div class="ttdeci">bool nmi_singlestep</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00257">svm.h:257</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a250d72e13c39c0c6d85a5e6c188554ce"><div class="ttname"><a href="structvcpu__svm.html#a250d72e13c39c0c6d85a5e6c188554ce">vcpu_svm::ldr_reg</a></div><div class="ttdeci">u32 ldr_reg</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00267">svm.h:267</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a255650cdd9fc03e4da05d1f0f154452a"><div class="ttname"><a href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">vcpu_svm::current_vmcb</a></div><div class="ttdeci">struct kvm_vmcb_info * current_vmcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00214">svm.h:214</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a2c8b33d5ae9b731a886634cd6c00165f"><div class="ttname"><a href="structvcpu__svm.html#a2c8b33d5ae9b731a886634cd6c00165f">vcpu_svm::avic_backing_page</a></div><div class="ttdeci">struct page * avic_backing_page</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00269">svm.h:269</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a3a2ad123b38c5ee6f81b8a6db56ac5b9"><div class="ttname"><a href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">vcpu_svm::msrpm</a></div><div class="ttdeci">u32 * msrpm</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00234">svm.h:234</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a3a45518dab6750d2180fb4d5de532d76"><div class="ttname"><a href="structvcpu__svm.html#a3a45518dab6750d2180fb4d5de532d76">vcpu_svm::soft_int_old_rip</a></div><div class="ttdeci">unsigned long soft_int_old_rip</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00263">svm.h:263</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a47c387d2cf9e9df4331860eca2305fe6"><div class="ttname"><a href="structvcpu__svm.html#a47c387d2cf9e9df4331860eca2305fe6">vcpu_svm::soft_int_next_rip</a></div><div class="ttdeci">unsigned long soft_int_next_rip</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00264">svm.h:264</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a48b965690a803159d4542489b0e487e8"><div class="ttname"><a href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">vcpu_svm::tsc_ratio_msr</a></div><div class="ttdeci">u64 tsc_ratio_msr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00226">svm.h:226</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a4969041ad5b96825f67160eb1ae9f726"><div class="ttname"><a href="structvcpu__svm.html#a4969041ad5b96825f67160eb1ae9f726">vcpu_svm::guest_state_loaded</a></div><div class="ttdeci">bool guest_state_loaded</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00289">svm.h:289</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a512e38d5dc99356b62e4b2cba0ab6d3d"><div class="ttname"><a href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">vcpu_svm::nmi_masked</a></div><div class="ttdeci">bool nmi_masked</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00241">svm.h:241</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a5b467b57f59ac934189a11051dc5ac6d"><div class="ttname"><a href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">vcpu_svm::nmi_l1_to_l2</a></div><div class="ttdeci">bool nmi_l1_to_l2</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00260">svm.h:260</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a6fafc7c88cd9fcf600c03b6a74e9124a"><div class="ttname"><a href="structvcpu__svm.html#a6fafc7c88cd9fcf600c03b6a74e9124a">vcpu_svm::nmi_iret_rip</a></div><div class="ttdeci">ulong nmi_iret_rip</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00236">svm.h:236</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a747a3e237abb2217a6a93de9d17de74e"><div class="ttname"><a href="structvcpu__svm.html#a747a3e237abb2217a6a93de9d17de74e">vcpu_svm::sysenter_esp_hi</a></div><div class="ttdeci">u32 sysenter_esp_hi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00216">svm.h:216</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a78586d5e57b40fdc6d040b900300ef6d"><div class="ttname"><a href="structvcpu__svm.html#a78586d5e57b40fdc6d040b900300ef6d">vcpu_svm::virt_spec_ctrl</a></div><div class="ttdeci">u64 virt_spec_ctrl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00232">svm.h:232</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a7c4559533cfca9ae99de999b4c26d5fb"><div class="ttname"><a href="structvcpu__svm.html#a7c4559533cfca9ae99de999b4c26d5fb">vcpu_svm::soft_int_csbase</a></div><div class="ttdeci">unsigned long soft_int_csbase</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00262">svm.h:262</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a7c494fa07f9ddd95637bb1061808402e"><div class="ttname"><a href="structvcpu__svm.html#a7c494fa07f9ddd95637bb1061808402e">vcpu_svm::asid</a></div><div class="ttdeci">u32 asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00215">svm.h:215</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a7de61a9710589d6f3c286663fc51506e"><div class="ttname"><a href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">vcpu_svm::soft_int_injected</a></div><div class="ttdeci">bool soft_int_injected</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00265">svm.h:265</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a80fa0b4dcbb7f9758bd7c0c29e1ed1a5"><div class="ttname"><a href="structvcpu__svm.html#a80fa0b4dcbb7f9758bd7c0c29e1ed1a5">vcpu_svm::sysenter_eip_hi</a></div><div class="ttdeci">u32 sysenter_eip_hi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00217">svm.h:217</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a850f432012717e5e5be4064ae8f340ac"><div class="ttname"><a href="structvcpu__svm.html#a850f432012717e5e5be4064ae8f340ac">vcpu_svm::guest_gif</a></div><div class="ttdeci">bool guest_gif</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00294">svm.h:294</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a87127740a2a7ad640bd9bbbdd594d7e9"><div class="ttname"><a href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">vcpu_svm::nmi_singlestep_guest_rflags</a></div><div class="ttdeci">u64 nmi_singlestep_guest_rflags</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00258">svm.h:258</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a9a30016a1a0975a7ce12de950ec2a2cc"><div class="ttname"><a href="structvcpu__svm.html#a9a30016a1a0975a7ce12de950ec2a2cc">vcpu_svm::spec_ctrl</a></div><div class="ttdeci">u64 spec_ctrl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00224">svm.h:224</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_aa2e4d643ef957cd597e82a29f0f0a2c8"><div class="ttname"><a href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">vcpu_svm::nested</a></div><div class="ttdeci">struct svm_nested_state nested</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00236">svm.h:238</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_aa3288372e9c9edbcd129adb446479dfd"><div class="ttname"><a href="structvcpu__svm.html#aa3288372e9c9edbcd129adb446479dfd">vcpu_svm::shadow_msr_intercept</a></div><div class="ttdeci">struct vcpu_svm::@33 shadow_msr_intercept</div></div>
<div class="ttc" id="astructvcpu__svm_html_aaaac2e4809a87c7130fd4d8e146b8cc2"><div class="ttname"><a href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">vcpu_svm::sev_es</a></div><div class="ttdeci">struct vcpu_sev_es_state sev_es</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00279">svm.h:287</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_abc377a3a5f1f42e18f8a9044321f3d5b"><div class="ttname"><a href="structvcpu__svm.html#abc377a3a5f1f42e18f8a9044321f3d5b">vcpu_svm::avic_physical_id_cache</a></div><div class="ttdeci">u64 * avic_physical_id_cache</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00270">svm.h:270</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_adb9edaf400032eba81ff85b2e419844a"><div class="ttname"><a href="structvcpu__svm.html#adb9edaf400032eba81ff85b2e419844a">vcpu_svm::msr_decfg</a></div><div class="ttdeci">u64 msr_decfg</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00220">svm.h:220</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_ae08ffe38b03c1c44686c57c274553f59"><div class="ttname"><a href="structvcpu__svm.html#ae08ffe38b03c1c44686c57c274553f59">vcpu_svm::dfr_reg</a></div><div class="ttdeci">u32 dfr_reg</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00268">svm.h:268</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_ae25c348c7b9864253f4db3fb8a3c3e59"><div class="ttname"><a href="structvcpu__svm.html#ae25c348c7b9864253f4db3fb8a3c3e59">vcpu_svm::tsc_aux</a></div><div class="ttdeci">uint64_t tsc_aux</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00218">svm.h:218</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_ae94a883f2e559703aaa7b93d14a3810a"><div class="ttname"><a href="structvcpu__svm.html#ae94a883f2e559703aaa7b93d14a3810a">vcpu_svm::awaiting_iret_completion</a></div><div class="ttdeci">bool awaiting_iret_completion</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00248">svm.h:248</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af095ed7bcc31c036e28e533582723a60"><div class="ttname"><a href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vcpu_svm::vmcb</a></div><div class="ttdeci">struct vmcb * vmcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00212">svm.h:212</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af0c24755d59a0cfca7ce9ba64f682722"><div class="ttname"><a href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vcpu_svm::vmcb01</a></div><div class="ttdeci">struct kvm_vmcb_info vmcb01</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00212">svm.h:213</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af164d8d741d9ea90dae6a46974d29f9e"><div class="ttname"><a href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu_svm::vcpu</a></div><div class="ttdeci">struct kvm_vcpu vcpu</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00206">svm.h:210</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af217181f505db1b71c48743233032539"><div class="ttname"><a href="structvcpu__svm.html#af217181f505db1b71c48743233032539">vcpu_svm::ir_list</a></div><div class="ttdeci">struct list_head ir_list</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00270">svm.h:278</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af38f3c63a81a10aae69b308aa175d618"><div class="ttname"><a href="structvcpu__svm.html#af38f3c63a81a10aae69b308aa175d618">vcpu_svm::ir_list_lock</a></div><div class="ttdeci">spinlock_t ir_list_lock</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00279">svm.h:279</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af9472805586ac10a411dde4a890047ac"><div class="ttname"><a href="structvcpu__svm.html#af9472805586ac10a411dde4a890047ac">vcpu_svm::next_rip</a></div><div class="ttdeci">u64 next_rip</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00222">svm.h:222</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_afbff2f35453153777bd80da134d164e0"><div class="ttname"><a href="structvcpu__svm.html#afbff2f35453153777bd80da134d164e0">vcpu_svm::x2avic_msrs_intercepted</a></div><div class="ttdeci">bool x2avic_msrs_intercepted</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00291">svm.h:291</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html">vmcb_ctrl_area_cached</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00125">svm.h:125</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a12b9399ff1b5beaad19b731aedb12011"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a12b9399ff1b5beaad19b731aedb12011">vmcb_ctrl_area_cached::exit_int_info_err</a></div><div class="ttdeci">u32 exit_int_info_err</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00142">svm.h:142</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a14a6506738f4682f13632ae2d1c96752"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a14a6506738f4682f13632ae2d1c96752">vmcb_ctrl_area_cached::exit_code_hi</a></div><div class="ttdeci">u32 exit_code_hi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00138">svm.h:138</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a1e877429e7fb02e17e8aec57274abca4"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a1e877429e7fb02e17e8aec57274abca4">vmcb_ctrl_area_cached::intercepts</a></div><div class="ttdeci">u32 intercepts[MAX_INTERCEPT]</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00126">svm.h:126</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a2713403c709e48e21de3a91d3d28bce5"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a2713403c709e48e21de3a91d3d28bce5">vmcb_ctrl_area_cached::pause_filter_count</a></div><div class="ttdeci">u16 pause_filter_count</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00128">svm.h:128</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a28a03a713594725f8e7fa8090681a1d9"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a28a03a713594725f8e7fa8090681a1d9">vmcb_ctrl_area_cached::next_rip</a></div><div class="ttdeci">u64 next_rip</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00146">svm.h:146</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a2c5d9afb37c1ab54586cdcf478b417c2"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">vmcb_ctrl_area_cached::int_ctl</a></div><div class="ttdeci">u32 int_ctl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00134">svm.h:134</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a2f479e79f0c9c5862da98440da9b5fa9"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a2f479e79f0c9c5862da98440da9b5fa9">vmcb_ctrl_area_cached::exit_info_1</a></div><div class="ttdeci">u64 exit_info_1</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00139">svm.h:139</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a2fba54766e16cab5897765ffdb4ea134"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a2fba54766e16cab5897765ffdb4ea134">vmcb_ctrl_area_cached::event_inj</a></div><div class="ttdeci">u32 event_inj</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00144">svm.h:144</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a3709474003525bc4510eea401cef37aa"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a3709474003525bc4510eea401cef37aa">vmcb_ctrl_area_cached::clean</a></div><div class="ttdeci">u32 clean</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00149">svm.h:149</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a51c61318f18513673f290f703e421acb"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a51c61318f18513673f290f703e421acb">vmcb_ctrl_area_cached::msrpm_base_pa</a></div><div class="ttdeci">u64 msrpm_base_pa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00130">svm.h:130</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a64059f1364084ba55fe82bf69f0704dd"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a64059f1364084ba55fe82bf69f0704dd">vmcb_ctrl_area_cached::nested_ctl</a></div><div class="ttdeci">u64 nested_ctl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00143">svm.h:143</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a663499717208b2803e3a33b4d19929b7"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a663499717208b2803e3a33b4d19929b7">vmcb_ctrl_area_cached::event_inj_err</a></div><div class="ttdeci">u32 event_inj_err</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00145">svm.h:145</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a69f589fcf8d6d59e9f0deed5dd03e1b5"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a69f589fcf8d6d59e9f0deed5dd03e1b5">vmcb_ctrl_area_cached::asid</a></div><div class="ttdeci">u32 asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00132">svm.h:132</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a6dbaaab1ff061c474307cd03cdf9e841"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a6dbaaab1ff061c474307cd03cdf9e841">vmcb_ctrl_area_cached::exit_code</a></div><div class="ttdeci">u32 exit_code</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00137">svm.h:137</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a73eb23f87b74324917ce3831a41f3c3d"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a73eb23f87b74324917ce3831a41f3c3d">vmcb_ctrl_area_cached::tlb_ctl</a></div><div class="ttdeci">u8 tlb_ctl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00133">svm.h:133</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a7c13a2a3665942eb4cc17fc335c4185f"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a7c13a2a3665942eb4cc17fc335c4185f">vmcb_ctrl_area_cached::virt_ext</a></div><div class="ttdeci">u64 virt_ext</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00148">svm.h:148</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a8813ccbf51388cde7a5727a3f84dd2db"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a8813ccbf51388cde7a5727a3f84dd2db">vmcb_ctrl_area_cached::iopm_base_pa</a></div><div class="ttdeci">u64 iopm_base_pa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00129">svm.h:129</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_aa8133737f749481d1105fbb6cfefa014"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#aa8133737f749481d1105fbb6cfefa014">vmcb_ctrl_area_cached::tsc_offset</a></div><div class="ttdeci">u64 tsc_offset</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00131">svm.h:131</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_aa97f45d198b0f8800ae8d48ee44b56f9"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#aa97f45d198b0f8800ae8d48ee44b56f9">vmcb_ctrl_area_cached::pause_filter_thresh</a></div><div class="ttdeci">u16 pause_filter_thresh</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00127">svm.h:127</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_aab04e46c04cd5f85d758e353ef21b691"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#aab04e46c04cd5f85d758e353ef21b691">vmcb_ctrl_area_cached::exit_int_info</a></div><div class="ttdeci">u32 exit_int_info</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00141">svm.h:141</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_aaf1d96a2ac5238db2c2eb36f5e389933"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#aaf1d96a2ac5238db2c2eb36f5e389933">vmcb_ctrl_area_cached::reserved_sw</a></div><div class="ttdeci">u8 reserved_sw[32]</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00154">svm.h:154</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_ab068abfea412a5ea88785570f3fab554"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#ab068abfea412a5ea88785570f3fab554">vmcb_ctrl_area_cached::int_vector</a></div><div class="ttdeci">u32 int_vector</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00135">svm.h:135</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_adfa7dd6ea79467607e5a70e6f8d5d0c1"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#adfa7dd6ea79467607e5a70e6f8d5d0c1">vmcb_ctrl_area_cached::int_state</a></div><div class="ttdeci">u32 int_state</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00136">svm.h:136</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_ae390ee70e69b06fe97d3ee873889303c"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#ae390ee70e69b06fe97d3ee873889303c">vmcb_ctrl_area_cached::exit_info_2</a></div><div class="ttdeci">u64 exit_info_2</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00140">svm.h:140</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_af43b324bc739858a84ac026b6c5ef15f"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#af43b324bc739858a84ac026b6c5ef15f">vmcb_ctrl_area_cached::nested_cr3</a></div><div class="ttdeci">u64 nested_cr3</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00147">svm.h:147</a></div></div>
<div class="ttc" id="astructvmcb__save__area__cached_html"><div class="ttname"><a href="structvmcb__save__area__cached.html">vmcb_save_area_cached</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00116">svm.h:116</a></div></div>
<div class="ttc" id="astructvmcb__save__area__cached_html_a5e0ec7ce63e98ebada78d20a99e1b892"><div class="ttname"><a href="structvmcb__save__area__cached.html#a5e0ec7ce63e98ebada78d20a99e1b892">vmcb_save_area_cached::cr0</a></div><div class="ttdeci">u64 cr0</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00120">svm.h:120</a></div></div>
<div class="ttc" id="astructvmcb__save__area__cached_html_a64d1beda721567c52a8877f802e3c8f9"><div class="ttname"><a href="structvmcb__save__area__cached.html#a64d1beda721567c52a8877f802e3c8f9">vmcb_save_area_cached::cr4</a></div><div class="ttdeci">u64 cr4</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00118">svm.h:118</a></div></div>
<div class="ttc" id="astructvmcb__save__area__cached_html_a716fbc4b5214710276c00f469d7d1d29"><div class="ttname"><a href="structvmcb__save__area__cached.html#a716fbc4b5214710276c00f469d7d1d29">vmcb_save_area_cached::cr3</a></div><div class="ttdeci">u64 cr3</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00119">svm.h:119</a></div></div>
<div class="ttc" id="astructvmcb__save__area__cached_html_a7373d64bb3b004ba2a76d92e32e91cbf"><div class="ttname"><a href="structvmcb__save__area__cached.html#a7373d64bb3b004ba2a76d92e32e91cbf">vmcb_save_area_cached::dr7</a></div><div class="ttdeci">u64 dr7</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00121">svm.h:121</a></div></div>
<div class="ttc" id="astructvmcb__save__area__cached_html_a76e86a91e5c4a598014b722f071a8748"><div class="ttname"><a href="structvmcb__save__area__cached.html#a76e86a91e5c4a598014b722f071a8748">vmcb_save_area_cached::dr6</a></div><div class="ttdeci">u64 dr6</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00122">svm.h:122</a></div></div>
<div class="ttc" id="astructvmcb__save__area__cached_html_a9c7aeff2108008b72ccb5726dc2da32a"><div class="ttname"><a href="structvmcb__save__area__cached.html#a9c7aeff2108008b72ccb5726dc2da32a">vmcb_save_area_cached::efer</a></div><div class="ttdeci">u64 efer</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00117">svm.h:117</a></div></div>
<div class="ttc" id="asvm_8h_html_a0040cee9c1580bba0c7d61a63494c04a"><div class="ttname"><a href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a">nested_svm_virtualize_tpr</a></div><div class="ttdeci">static bool nested_svm_virtualize_tpr(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00569">svm.h:569</a></div></div>
<div class="ttc" id="asvm_8h_html_a00c492279a529b66b80ed039ae6de23b"><div class="ttname"><a href="svm_8h.html#a00c492279a529b66b80ed039ae6de23b">sev_vcpu_after_set_cpuid</a></div><div class="ttdeci">void sev_vcpu_after_set_cpuid(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03015">sev.c:3015</a></div></div>
<div class="ttc" id="asvm_8h_html_a02e1632739fc6a1f76c81a50cc4a97ac"><div class="ttname"><a href="svm_8h.html#a02e1632739fc6a1f76c81a50cc4a97ac">svm_nested_ops</a></div><div class="ttdeci">struct kvm_x86_nested_ops svm_nested_ops</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01780">nested.c:1811</a></div></div>
<div class="ttc" id="asvm_8h_html_a036567d678fc3315196c7e4a5fa42cd3"><div class="ttname"><a href="svm_8h.html#a036567d678fc3315196c7e4a5fa42cd3">__read_mostly</a></div><div class="ttdeci">u32 msrpm_offsets[MSRPM_OFFSETS] __read_mostly</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00036">cpuid.c:36</a></div></div>
<div class="ttc" id="asvm_8h_html_a051d09f3fa8790388364ac3f69ed3e53"><div class="ttname"><a href="svm_8h.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a></div><div class="ttdeci">void svm_switch_vmcb(struct vcpu_svm *svm, struct kvm_vmcb_info *target_vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01407">svm.c:1407</a></div></div>
<div class="ttc" id="asvm_8h_html_a056e12caaf24f044fce8545a863dbbce"><div class="ttname"><a href="svm_8h.html#a056e12caaf24f044fce8545a863dbbce">avic_vcpu_blocking</a></div><div class="ttdeci">void avic_vcpu_blocking(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01153">avic.c:1153</a></div></div>
<div class="ttc" id="asvm_8h_html_a06d8a6a899d49f3235ec1294d1943c84"><div class="ttname"><a href="svm_8h.html#a06d8a6a899d49f3235ec1294d1943c84">svm_copy_lbrs</a></div><div class="ttdeci">void svm_copy_lbrs(struct vmcb *to_vmcb, struct vmcb *from_vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00982">svm.c:982</a></div></div>
<div class="ttc" id="asvm_8h_html_a0bc306a80e6f2622f2c58d1271dcc05b"><div class="ttname"><a href="svm_8h.html#a0bc306a80e6f2622f2c58d1271dcc05b">sev_hardware_unsetup</a></div><div class="ttdeci">void sev_hardware_unsetup(void)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02298">sev.c:2298</a></div></div>
<div class="ttc" id="asvm_8h_html_a0ddedac4b0b428928fae6bc9fe902e2a"><div class="ttname"><a href="svm_8h.html#a0ddedac4b0b428928fae6bc9fe902e2a">avic_vm_init</a></div><div class="ttdeci">int avic_vm_init(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00192">avic.c:192</a></div></div>
<div class="ttc" id="asvm_8h_html_a0e9d1e1a7652ad926236f0f44891293c"><div class="ttname"><a href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a></div><div class="ttdeci">static void clr_exception_intercept(struct vcpu_svm *svm, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00413">svm.h:413</a></div></div>
<div class="ttc" id="asvm_8h_html_a13cbed806a9638fcaab4d01cb926d141"><div class="ttname"><a href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141">nested_exit_on_intr</a></div><div class="ttdeci">static bool nested_exit_on_intr(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00581">svm.h:581</a></div></div>
<div class="ttc" id="asvm_8h_html_a14877439e9d41030cb21612eecc8f3f9"><div class="ttname"><a href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a></div><div class="ttdeci">static __always_inline bool sev_es_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00332">svm.h:332</a></div></div>
<div class="ttc" id="asvm_8h_html_a17a219d0651f1db709a3af0fc5527aa0"><div class="ttname"><a href="svm_8h.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a></div><div class="ttdeci">bool npt_enabled</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00198">svm.c:198</a></div></div>
<div class="ttc" id="asvm_8h_html_a1a9474f1273be079ac4f3c1320093c3d"><div class="ttname"><a href="svm_8h.html#a1a9474f1273be079ac4f3c1320093c3d">svm_set_cr0</a></div><div class="ttdeci">void svm_set_cr0(struct kvm_vcpu *vcpu, unsigned long cr0)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01852">svm.c:1852</a></div></div>
<div class="ttc" id="asvm_8h_html_a2039644d359270872404c4664a25d951"><div class="ttname"><a href="svm_8h.html#a2039644d359270872404c4664a25d951">sev_mem_enc_ioctl</a></div><div class="ttdeci">int sev_mem_enc_ioctl(struct kvm *kvm, void __user *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01862">sev.c:1862</a></div></div>
<div class="ttc" id="asvm_8h_html_a232d9e4f1731f0d495e3b4f9d530d0ee"><div class="ttname"><a href="svm_8h.html#a232d9e4f1731f0d495e3b4f9d530d0ee">nested_sync_control_from_vmcb02</a></div><div class="ttdeci">void nested_sync_control_from_vmcb02(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00414">nested.c:414</a></div></div>
<div class="ttc" id="asvm_8h_html_a299de3990a5ce5ce873df7afe2b3338f"><div class="ttname"><a href="svm_8h.html#a299de3990a5ce5ce873df7afe2b3338f">avic_unaccelerated_access_interception</a></div><div class="ttdeci">int avic_unaccelerated_access_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00693">avic.c:693</a></div></div>
<div class="ttc" id="asvm_8h_html_a317277564d2351c6695a358504311483"><div class="ttname"><a href="svm_8h.html#a317277564d2351c6695a358504311483">VMCB_ALL_CLEAN_MASK</a></div><div class="ttdeci">#define VMCB_ALL_CLEAN_MASK</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00068">svm.h:68</a></div></div>
<div class="ttc" id="asvm_8h_html_a35438091c40e77c617ce2ec9d521cc1f"><div class="ttname"><a href="svm_8h.html#a35438091c40e77c617ce2ec9d521cc1f">svm_msrpm_offset</a></div><div class="ttdeci">u32 svm_msrpm_offset(u32 msr)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00264">svm.c:264</a></div></div>
<div class="ttc" id="asvm_8h_html_a371c2a615dd0d893b557b4c0742ab5c6"><div class="ttname"><a href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a></div><div class="ttdeci">static __always_inline bool sev_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00321">svm.h:321</a></div></div>
<div class="ttc" id="asvm_8h_html_a37477553ea45acae098350e7d572ae2e"><div class="ttname"><a href="svm_8h.html#a37477553ea45acae098350e7d572ae2e">svm_nmi_blocked</a></div><div class="ttdeci">bool svm_nmi_blocked(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03735">svm.c:3735</a></div></div>
<div class="ttc" id="asvm_8h_html_a37d57b174f959f39f30e8f0796dc3afb"><div class="ttname"><a href="svm_8h.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a></div><div class="ttdeci">unsigned int max_sev_asid</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00071">sev.c:71</a></div></div>
<div class="ttc" id="asvm_8h_html_a397a88cd5af0b0bb8a9ef4a5e6bc849d"><div class="ttname"><a href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a></div><div class="ttdeci">static bool svm_is_intercept(struct vcpu_svm *svm, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00441">svm.h:441</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a0b96a6cb7dc2eb2f1e2471f9fdfa6972"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a0b96a6cb7dc2eb2f1e2471f9fdfa6972">VMCB_PERM_MAP</a></div><div class="ttdeci">@ VMCB_PERM_MAP</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00051">svm.h:51</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a1c1bbe2afa896e3b5fc2f2d850eb41b3"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a1c1bbe2afa896e3b5fc2f2d850eb41b3">VMCB_DT</a></div><div class="ttdeci">@ VMCB_DT</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00057">svm.h:57</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f">VMCB_AVIC</a></div><div class="ttdeci">@ VMCB_AVIC</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00061">svm.h:61</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a></div><div class="ttdeci">@ VMCB_INTR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00053">svm.h:53</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a></div><div class="ttdeci">@ VMCB_CR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00055">svm.h:55</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a7c9727e792c945164c49fbd9793c4e97"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7c9727e792c945164c49fbd9793c4e97">VMCB_NPT</a></div><div class="ttdeci">@ VMCB_NPT</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00054">svm.h:54</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a">VMCB_LBR</a></div><div class="ttdeci">@ VMCB_LBR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00060">svm.h:60</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a></div><div class="ttdeci">@ VMCB_INTERCEPTS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00049">svm.h:49</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13aadb6ebcdeea82b3c1ad950e8e2433d8c"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aadb6ebcdeea82b3c1ad950e8e2433d8c">VMCB_SW</a></div><div class="ttdeci">@ VMCB_SW</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00065">svm.h:65</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13ab13d3c949ef62a4213fe70e2ed836b91"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ab13d3c949ef62a4213fe70e2ed836b91">VMCB_SEG</a></div><div class="ttdeci">@ VMCB_SEG</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00058">svm.h:58</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1">VMCB_CR2</a></div><div class="ttdeci">@ VMCB_CR2</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00059">svm.h:59</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13ac7c020c96383ecc6a3d358e1fdd99be7"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac7c020c96383ecc6a3d358e1fdd99be7">VMCB_DR</a></div><div class="ttdeci">@ VMCB_DR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00056">svm.h:56</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64">VMCB_ASID</a></div><div class="ttdeci">@ VMCB_ASID</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00052">svm.h:52</a></div></div>
<div class="ttc" id="asvm_8h_html_a3a8b145ddec7a3dc1367a4e4e0df397e"><div class="ttname"><a href="svm_8h.html#a3a8b145ddec7a3dc1367a4e4e0df397e">avic_pi_update_irte</a></div><div class="ttdeci">int avic_pi_update_irte(struct kvm *kvm, unsigned int host_irq, uint32_t guest_irq, bool set)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00894">avic.c:894</a></div></div>
<div class="ttc" id="asvm_8h_html_a3b1ae3550c1b7c9973532d08d167ce2c"><div class="ttname"><a href="svm_8h.html#a3b1ae3550c1b7c9973532d08d167ce2c">sev_vm_copy_enc_context_from</a></div><div class="ttdeci">int sev_vm_copy_enc_context_from(struct kvm *kvm, unsigned int source_fd)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02075">sev.c:2075</a></div></div>
<div class="ttc" id="asvm_8h_html_a3bb736e8688ecfaa3696b347764fd37d"><div class="ttname"><a href="svm_8h.html#a3bb736e8688ecfaa3696b347764fd37d">avic_vm_destroy</a></div><div class="ttdeci">void avic_vm_destroy(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00174">avic.c:174</a></div></div>
<div class="ttc" id="asvm_8h_html_a40f16bbe281410ac02865ea25c26bf12"><div class="ttname"><a href="svm_8h.html#a40f16bbe281410ac02865ea25c26bf12">avic_init_vmcb</a></div><div class="ttdeci">void avic_init_vmcb(struct vcpu_svm *svm, struct vmcb *vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00244">avic.c:244</a></div></div>
<div class="ttc" id="asvm_8h_html_a461f968598a11484e76a07fb87221bf2"><div class="ttname"><a href="svm_8h.html#a461f968598a11484e76a07fb87221bf2">avic_vcpu_put</a></div><div class="ttdeci">void avic_vcpu_put(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01072">avic.c:1072</a></div></div>
<div class="ttc" id="asvm_8h_html_a4a11c0014568405b90307ef68285e4ff"><div class="ttname"><a href="svm_8h.html#a4a11c0014568405b90307ef68285e4ff">avic_incomplete_ipi_interception</a></div><div class="ttdeci">int avic_incomplete_ipi_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00490">avic.c:490</a></div></div>
<div class="ttc" id="asvm_8h_html_a4b60c96a4d7eed837bb38ed5e03153c8"><div class="ttname"><a href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8">get_vnmi_vmcb_l1</a></div><div class="ttdeci">static struct vmcb * get_vnmi_vmcb_l1(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00513">svm.h:513</a></div></div>
<div class="ttc" id="asvm_8h_html_a4c285d86fd94954273295b317242c500"><div class="ttname"><a href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a></div><div class="ttdeci">static void svm_clr_intercept(struct vcpu_svm *svm, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00432">svm.h:432</a></div></div>
<div class="ttc" id="asvm_8h_html_a4ec7e878f6af209e74dd84285ee0198f"><div class="ttname"><a href="svm_8h.html#a4ec7e878f6af209e74dd84285ee0198f">nested_svm_vmrun</a></div><div class="ttdeci">int nested_svm_vmrun(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00837">nested.c:837</a></div></div>
<div class="ttc" id="asvm_8h_html_a5124cfade7c6ad2a6e136fdd0391f0a2"><div class="ttname"><a href="svm_8h.html#a5124cfade7c6ad2a6e136fdd0391f0a2">nested_vmcb02_compute_g_pat</a></div><div class="ttdeci">void nested_vmcb02_compute_g_pat(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00528">nested.c:528</a></div></div>
<div class="ttc" id="asvm_8h_html_a51356c24441683c197e1d4c2555da06d"><div class="ttname"><a href="svm_8h.html#a51356c24441683c197e1d4c2555da06d">avic_refresh_virtual_apic_mode</a></div><div class="ttdeci">void avic_refresh_virtual_apic_mode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01112">avic.c:1112</a></div></div>
<div class="ttc" id="asvm_8h_html_a5980ebd310893869bc4c059f110a13cb"><div class="ttname"><a href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb">vmcb_mark_all_dirty</a></div><div class="ttdeci">static void vmcb_mark_all_dirty(struct vmcb *vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00343">svm.h:343</a></div></div>
<div class="ttc" id="asvm_8h_html_a5c26f1ceaa6cc778d986bd33629dc539"><div class="ttname"><a href="svm_8h.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a></div><div class="ttdeci">void svm_set_gif(struct vcpu_svm *svm, bool value)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02406">svm.c:2406</a></div></div>
<div class="ttc" id="asvm_8h_html_a5da6b86ca5c95c3562c7d03dcbefe138"><div class="ttname"><a href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">MAX_DIRECT_ACCESS_MSRS</a></div><div class="ttdeci">#define MAX_DIRECT_ACCESS_MSRS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00033">svm.h:33</a></div></div>
<div class="ttc" id="asvm_8h_html_a5deff43556f8c807c64def073cd548e4"><div class="ttname"><a href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a></div><div class="ttdeci">static bool vmcb12_is_intercept(struct vmcb_ctrl_area_cached *control, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00397">svm.h:397</a></div></div>
<div class="ttc" id="asvm_8h_html_a5df90c8772700a60441f2ba19472f726"><div class="ttname"><a href="svm_8h.html#a5df90c8772700a60441f2ba19472f726">svm_set_efer</a></div><div class="ttdeci">int svm_set_efer(struct kvm_vcpu *vcpu, u64 efer)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00296">svm.c:296</a></div></div>
<div class="ttc" id="asvm_8h_html_a61ac82c942842848fab805e84fc70189"><div class="ttname"><a href="svm_8h.html#a61ac82c942842848fab805e84fc70189">nested_exit_on_smi</a></div><div class="ttdeci">static bool nested_exit_on_smi(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00576">svm.h:576</a></div></div>
<div class="ttc" id="asvm_8h_html_a64fd8d98c29189b4f4e47f96958aeeca"><div class="ttname"><a href="svm_8h.html#a64fd8d98c29189b4f4e47f96958aeeca">vmcb_mark_all_clean</a></div><div class="ttdeci">static void vmcb_mark_all_clean(struct vmcb *vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00348">svm.h:348</a></div></div>
<div class="ttc" id="asvm_8h_html_a66eedd855edb50a1b78c2ac2c48a4d5d"><div class="ttname"><a href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">is_vnmi_enabled</a></div><div class="ttdeci">static bool is_vnmi_enabled(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00524">svm.h:524</a></div></div>
<div class="ttc" id="asvm_8h_html_a67762809a8b14687a3bffdd5a4cd03aa"><div class="ttname"><a href="svm_8h.html#a67762809a8b14687a3bffdd5a4cd03aa">svm_interrupt_blocked</a></div><div class="ttdeci">bool svm_interrupt_blocked(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03767">svm.c:3767</a></div></div>
<div class="ttc" id="asvm_8h_html_a67937d45023d92583b0bd363c73b6c2b"><div class="ttname"><a href="svm_8h.html#a67937d45023d92583b0bd363c73b6c2b">svm_vcpu_free_msrpm</a></div><div class="ttdeci">void svm_vcpu_free_msrpm(u32 *msrpm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00915">svm.c:915</a></div></div>
<div class="ttc" id="asvm_8h_html_a690337312a648d2948b22540da6f031e"><div class="ttname"><a href="svm_8h.html#a690337312a648d2948b22540da6f031e">svm_free_nested</a></div><div class="ttdeci">void svm_free_nested(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01203">nested.c:1203</a></div></div>
<div class="ttc" id="asvm_8h_html_a69e061ab353251d82ff01f587be58c96"><div class="ttname"><a href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">get_vgif_vmcb</a></div><div class="ttdeci">static struct vmcb * get_vgif_vmcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00452">svm.h:452</a></div></div>
<div class="ttc" id="asvm_8h_html_a6eb37bb9efc32f45f75055de8ba4fc79"><div class="ttname"><a href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79">vmcb_is_intercept</a></div><div class="ttdeci">static bool vmcb_is_intercept(struct vmcb_control_area *control, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00391">svm.h:391</a></div></div>
<div class="ttc" id="asvm_8h_html_a711d42f525aa791008754514284a556c"><div class="ttname"><a href="svm_8h.html#a711d42f525aa791008754514284a556c">disable_gif</a></div><div class="ttdeci">static void disable_gif(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00473">svm.h:473</a></div></div>
<div class="ttc" id="asvm_8h_html_a73d1cb9b9fcfa112138681d9080a1c05"><div class="ttname"><a href="svm_8h.html#a73d1cb9b9fcfa112138681d9080a1c05">nested_svm_vmexit</a></div><div class="ttdeci">int nested_svm_vmexit(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00967">nested.c:967</a></div></div>
<div class="ttc" id="asvm_8h_html_a777240cb9ab00451d21a1b204e19c5a6"><div class="ttname"><a href="svm_8h.html#a777240cb9ab00451d21a1b204e19c5a6">nested_svm_exit_handled</a></div><div class="ttdeci">int nested_svm_exit_handled(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01345">nested.c:1345</a></div></div>
<div class="ttc" id="asvm_8h_html_a7787ebf653e664e7dda7c3b0a8dfa84b"><div class="ttname"><a href="svm_8h.html#a7787ebf653e664e7dda7c3b0a8dfa84b">is_x2apic_msrpm_offset</a></div><div class="ttdeci">static bool is_x2apic_msrpm_offset(u32 offset)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00504">svm.h:504</a></div></div>
<div class="ttc" id="asvm_8h_html_a7b2d87885eea1b11b1bf1045c21c5a8b"><div class="ttname"><a href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b">nested_svm_simple_vmexit</a></div><div class="ttdeci">static int nested_svm_simple_vmexit(struct vcpu_svm *svm, u32 exit_code)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00602">svm.h:602</a></div></div>
<div class="ttc" id="asvm_8h_html_a7c74743aeff41a938e6e8d1018bf871c"><div class="ttname"><a href="svm_8h.html#a7c74743aeff41a938e6e8d1018bf871c">DECLARE_PER_CPU</a></div><div class="ttdeci">DECLARE_PER_CPU(struct svm_cpu_data, svm_data)</div></div>
<div class="ttc" id="asvm_8h_html_a7decdbafc7d47b2241e68ce3c90a9779"><div class="ttname"><a href="svm_8h.html#a7decdbafc7d47b2241e68ce3c90a9779">avic_vcpu_load</a></div><div class="ttdeci">void avic_vcpu_load(struct kvm_vcpu *vcpu, int cpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01028">avic.c:1028</a></div></div>
<div class="ttc" id="asvm_8h_html_a7e341d7f17b2f611aca180217cfc6ad3"><div class="ttname"><a href="svm_8h.html#a7e341d7f17b2f611aca180217cfc6ad3">avic_vcpu_unblocking</a></div><div class="ttdeci">void avic_vcpu_unblocking(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01174">avic.c:1174</a></div></div>
<div class="ttc" id="asvm_8h_html_a7ff4c846a46f6bb2e429d79bbc18f052"><div class="ttname"><a href="svm_8h.html#a7ff4c846a46f6bb2e429d79bbc18f052">disable_nmi_singlestep</a></div><div class="ttdeci">void disable_nmi_singlestep(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01054">svm.c:1054</a></div></div>
<div class="ttc" id="asvm_8h_html_a8381dc2e2d38fd331490bbb2fd097d0a"><div class="ttname"><a href="svm_8h.html#a8381dc2e2d38fd331490bbb2fd097d0a">sev_es_string_io</a></div><div class="ttdeci">int sev_es_string_io(struct vcpu_svm *svm, int size, unsigned int port, int in)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02963">sev.c:2963</a></div></div>
<div class="ttc" id="asvm_8h_html_a83e420c88631faf9613ea3caa72c63b7"><div class="ttname"><a href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a></div><div class="ttdeci">static __always_inline struct vcpu_svm * to_svm(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00364">svm.h:364</a></div></div>
<div class="ttc" id="asvm_8h_html_a83e4cd1b591935133506abf6724051c4"><div class="ttname"><a href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a></div><div class="ttdeci">static void vmcb_clr_intercept(struct vmcb_control_area *control, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00385">svm.h:385</a></div></div>
<div class="ttc" id="asvm_8h_html_a869cefc2d0dabd5e6c07940e88a4acfe"><div class="ttname"><a href="svm_8h.html#a869cefc2d0dabd5e6c07940e88a4acfe">nested_svm_check_exception</a></div><div class="ttdeci">int nested_svm_check_exception(struct vcpu_svm *svm, unsigned nr, bool has_error_code, u32 error_code)</div></div>
<div class="ttc" id="asvm_8h_html_a87f63ae4bc207e3d5a5d80e34243cf50"><div class="ttname"><a href="svm_8h.html#a87f63ae4bc207e3d5a5d80e34243cf50">sev_cpu_init</a></div><div class="ttdeci">int sev_cpu_init(struct svm_cpu_data *sd)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02313">sev.c:2313</a></div></div>
<div class="ttc" id="asvm_8h_html_a88b3351baf8190bdefb4b8a113159deb"><div class="ttname"><a href="svm_8h.html#a88b3351baf8190bdefb4b8a113159deb">svm_smi_blocked</a></div><div class="ttdeci">bool svm_smi_blocked(struct kvm_vcpu *vcpu)</div></div>
<div class="ttc" id="asvm_8h_html_a8907fcb136a33618dbbc1c2b7d3872f8"><div class="ttname"><a href="svm_8h.html#a8907fcb136a33618dbbc1c2b7d3872f8">nested_svm_check_permissions</a></div><div class="ttdeci">int nested_svm_check_permissions(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01357">nested.c:1357</a></div></div>
<div class="ttc" id="asvm_8h_html_a8afafecae406016532810194f187fe2c"><div class="ttname"><a href="svm_8h.html#a8afafecae406016532810194f187fe2c">svm_invoke_exit_handler</a></div><div class="ttdeci">int svm_invoke_exit_handler(struct kvm_vcpu *vcpu, u64 exit_code)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03453">svm.c:3453</a></div></div>
<div class="ttc" id="asvm_8h_html_a8be79ef0522e29a602517b51ff51f509"><div class="ttname"><a href="svm_8h.html#a8be79ef0522e29a602517b51ff51f509">dump_invalid_vmcb</a></div><div class="ttdeci">bool dump_invalid_vmcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00231">svm.c:231</a></div></div>
<div class="ttc" id="asvm_8h_html_a8d0afd60cabe4ff8b40d7099f49a1bb8"><div class="ttname"><a href="svm_8h.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a></div><div class="ttdeci">bool vnmi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00238">svm.c:238</a></div></div>
<div class="ttc" id="asvm_8h_html_a8e0a22138080054f4ac064064402f74a"><div class="ttname"><a href="svm_8h.html#a8e0a22138080054f4ac064064402f74a">avic_init_vcpu</a></div><div class="ttdeci">int avic_init_vcpu(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00719">avic.c:719</a></div></div>
<div class="ttc" id="asvm_8h_html_a8ed6164c0df5d13f87bce2be5a83e0d8"><div class="ttname"><a href="svm_8h.html#a8ed6164c0df5d13f87bce2be5a83e0d8">sev_mem_enc_unregister_region</a></div><div class="ttdeci">int sev_mem_enc_unregister_region(struct kvm *kvm, struct kvm_enc_region *range)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02035">sev.c:2035</a></div></div>
<div class="ttc" id="asvm_8h_html_a96264b6618fa3987f55ba2054a1f12bc"><div class="ttname"><a href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc">nested_npt_enabled</a></div><div class="ttdeci">static bool nested_npt_enabled(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00493">svm.h:493</a></div></div>
<div class="ttc" id="asvm_8h_html_a9809425cf0d198f1c65811a4716ceecf"><div class="ttname"><a href="svm_8h.html#a9809425cf0d198f1c65811a4716ceecf">sev_vcpu_deliver_sipi_vector</a></div><div class="ttdeci">void sev_vcpu_deliver_sipi_vector(struct kvm_vcpu *vcpu, u8 vector)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03159">sev.c:3159</a></div></div>
<div class="ttc" id="asvm_8h_html_a987416bb1857b96f97af2391d1008c5a"><div class="ttname"><a href="svm_8h.html#a987416bb1857b96f97af2391d1008c5a">VMCB_ALWAYS_DIRTY_MASK</a></div><div class="ttdeci">#define VMCB_ALWAYS_DIRTY_MASK</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00077">svm.h:77</a></div></div>
<div class="ttc" id="asvm_8h_html_a9afc6299b4f92c15a93b02db0318ad79"><div class="ttname"><a href="svm_8h.html#a9afc6299b4f92c15a93b02db0318ad79">sev_hardware_setup</a></div><div class="ttdeci">void __init sev_hardware_setup(void)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02193">sev.c:2193</a></div></div>
<div class="ttc" id="asvm_8h_html_aa924db70d759d98124ad13172de1f0c5"><div class="ttname"><a href="svm_8h.html#aa924db70d759d98124ad13172de1f0c5">sev_es_vcpu_reset</a></div><div class="ttdeci">void sev_es_vcpu_reset(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03108">sev.c:3108</a></div></div>
<div class="ttc" id="asvm_8h_html_aac550422551b71c0afe8efe176e0b55d"><div class="ttname"><a href="svm_8h.html#aac550422551b71c0afe8efe176e0b55d">sev_handle_vmgexit</a></div><div class="ttdeci">int sev_handle_vmgexit(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02857">sev.c:2857</a></div></div>
<div class="ttc" id="asvm_8h_html_aaee43a83fe8c444128a4d22b2d5d5c21"><div class="ttname"><a href="svm_8h.html#aaee43a83fe8c444128a4d22b2d5d5c21">svm_vcpu_init_msrpm</a></div><div class="ttdeci">void svm_vcpu_init_msrpm(struct kvm_vcpu *vcpu, u32 *msrpm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00881">svm.c:881</a></div></div>
<div class="ttc" id="asvm_8h_html_aaeebe6cee9f13a0540cbd9b696648a1d"><div class="ttname"><a href="svm_8h.html#aaeebe6cee9f13a0540cbd9b696648a1d">svm_allocate_nested</a></div><div class="ttdeci">int svm_allocate_nested(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01177">nested.c:1177</a></div></div>
<div class="ttc" id="asvm_8h_html_aaf821ba71761474726fdfb616796a0c8"><div class="ttname"><a href="svm_8h.html#aaf821ba71761474726fdfb616796a0c8">svm_vcpu_alloc_msrpm</a></div><div class="ttdeci">u32 * svm_vcpu_alloc_msrpm(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00866">svm.c:866</a></div></div>
<div class="ttc" id="asvm_8h_html_ab0a8ab91829811c7705c6455fb294bbc"><div class="ttname"><a href="svm_8h.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a></div><div class="ttdeci">int vgif</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00214">svm.c:214</a></div></div>
<div class="ttc" id="asvm_8h_html_ab37c3ce91ad0ad98fb7d5676a318cde4"><div class="ttname"><a href="svm_8h.html#ab37c3ce91ad0ad98fb7d5676a318cde4">sev_mem_enc_register_region</a></div><div class="ttdeci">int sev_mem_enc_register_region(struct kvm *kvm, struct kvm_enc_region *range)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01959">sev.c:1959</a></div></div>
<div class="ttc" id="asvm_8h_html_ab452fafde694bb5dfd7c6dfc5707ae12"><div class="ttname"><a href="svm_8h.html#ab452fafde694bb5dfd7c6dfc5707ae12">nested_vnmi_enabled</a></div><div class="ttdeci">static bool nested_vnmi_enabled(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00498">svm.h:498</a></div></div>
<div class="ttc" id="asvm_8h_html_ab83edec724698a20d66a086a1900aa27"><div class="ttname"><a href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a></div><div class="ttdeci">static void vmcb_mark_dirty(struct vmcb *vmcb, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00354">svm.h:354</a></div></div>
<div class="ttc" id="asvm_8h_html_aba11fc99cad465d138aeb5c2cb3508e2"><div class="ttname"><a href="svm_8h.html#aba11fc99cad465d138aeb5c2cb3508e2">sev_es_unmap_ghcb</a></div><div class="ttdeci">void sev_es_unmap_ghcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02614">sev.c:2614</a></div></div>
<div class="ttc" id="asvm_8h_html_aba6feca2fbeab5686eaf28f921a819f7"><div class="ttname"><a href="svm_8h.html#aba6feca2fbeab5686eaf28f921a819f7">__svm_sev_es_vcpu_run</a></div><div class="ttdeci">void __svm_sev_es_vcpu_run(struct vcpu_svm *svm, bool spec_ctrl_intercepted)</div></div>
<div class="ttc" id="asvm_8h_html_abe289006ed99e36825065ad80cf7480f"><div class="ttname"><a href="svm_8h.html#abe289006ed99e36825065ad80cf7480f">sev_init_vmcb</a></div><div class="ttdeci">void sev_init_vmcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03093">sev.c:3093</a></div></div>
<div class="ttc" id="asvm_8h_html_abe3c569b297da3b78824074b8c08f9a7"><div class="ttname"><a href="svm_8h.html#abe3c569b297da3b78824074b8c08f9a7">sev_vm_move_enc_context_from</a></div><div class="ttdeci">int sev_vm_move_enc_context_from(struct kvm *kvm, unsigned int source_fd)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01791">sev.c:1791</a></div></div>
<div class="ttc" id="asvm_8h_html_abedd386d3abba4edb2cf133ab91c57f3"><div class="ttname"><a href="svm_8h.html#abedd386d3abba4edb2cf133ab91c57f3">__svm_vcpu_run</a></div><div class="ttdeci">void __svm_vcpu_run(struct vcpu_svm *svm, bool spec_ctrl_intercepted)</div></div>
<div class="ttc" id="asvm_8h_html_abfe06c5436ae4d724c3c4495f8af136d"><div class="ttname"><a href="svm_8h.html#abfe06c5436ae4d724c3c4495f8af136d">nested_svm_exit_special</a></div><div class="ttdeci">int nested_svm_exit_special(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01496">nested.c:1496</a></div></div>
<div class="ttc" id="asvm_8h_html_ac27f6fe2ff4beeb5ad1b11681d0386fd"><div class="ttname"><a href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a></div><div class="ttdeci">static __always_inline struct kvm_svm * to_kvm_svm(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00316">svm.h:316</a></div></div>
<div class="ttc" id="asvm_8h_html_ac8c9ded2546dccf6e4b561e633d22e7e"><div class="ttname"><a href="svm_8h.html#ac8c9ded2546dccf6e4b561e633d22e7e">avic_ring_doorbell</a></div><div class="ttdeci">void avic_ring_doorbell(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00321">avic.c:321</a></div></div>
<div class="ttc" id="asvm_8h_html_ad0a040a48a04ab47d0af3385ad214cd4"><div class="ttname"><a href="svm_8h.html#ad0a040a48a04ab47d0af3385ad214cd4">pre_sev_run</a></div><div class="ttdeci">void pre_sev_run(struct vcpu_svm *svm, int cpu)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02646">sev.c:2646</a></div></div>
<div class="ttc" id="asvm_8h_html_ad0ea8a68927599c2120f37f4f48b0a64"><div class="ttname"><a href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64">enable_gif</a></div><div class="ttdeci">static void enable_gif(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00463">svm.h:463</a></div></div>
<div class="ttc" id="asvm_8h_html_ad4655e18a7969aeb0228ecbbc011f546"><div class="ttname"><a href="svm_8h.html#ad4655e18a7969aeb0228ecbbc011f546">sev_es_prepare_switch_to_guest</a></div><div class="ttdeci">void sev_es_prepare_switch_to_guest(struct sev_es_save_area *hostsa)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03119">sev.c:3119</a></div></div>
<div class="ttc" id="asvm_8h_html_ad4c0ba70ab315cedbb11f259b1d7ae08"><div class="ttname"><a href="svm_8h.html#ad4c0ba70ab315cedbb11f259b1d7ae08">x2avic_enabled</a></div><div class="ttdeci">bool x2avic_enabled</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00075">avic.c:75</a></div></div>
<div class="ttc" id="asvm_8h_html_ad5aa214e23ea9ec9418bebbe889d41ef"><div class="ttname"><a href="svm_8h.html#ad5aa214e23ea9ec9418bebbe889d41ef">svm_update_lbrv</a></div><div class="ttdeci">void svm_update_lbrv(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01037">svm.c:1037</a></div></div>
<div class="ttc" id="asvm_8h_html_ad6d8c993934e650cf5366b9883c3628e"><div class="ttname"><a href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e">nested_vgif_enabled</a></div><div class="ttdeci">static bool nested_vgif_enabled(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00446">svm.h:446</a></div></div>
<div class="ttc" id="asvm_8h_html_ad919ef3ad8475b1cc85b683ad7b33f95"><div class="ttname"><a href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a></div><div class="ttdeci">#define DEFINE_KVM_GHCB_ACCESSORS(field)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00703">svm.h:703</a></div></div>
<div class="ttc" id="asvm_8h_html_ad965a231dbcd0eb9eacac28848a143a8"><div class="ttname"><a href="svm_8h.html#ad965a231dbcd0eb9eacac28848a143a8">sev_guest_memory_reclaimed</a></div><div class="ttdeci">void sev_guest_memory_reclaimed(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02365">sev.c:2365</a></div></div>
<div class="ttc" id="asvm_8h_html_ad9a1b45b05505f9435cc2d1dd1c37943"><div class="ttname"><a href="svm_8h.html#ad9a1b45b05505f9435cc2d1dd1c37943">svm_write_tsc_multiplier</a></div><div class="ttdeci">void svm_write_tsc_multiplier(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01163">svm.c:1163</a></div></div>
<div class="ttc" id="asvm_8h_html_ada833d2b35b3e565a6900b25d1cce7c7"><div class="ttname"><a href="svm_8h.html#ada833d2b35b3e565a6900b25d1cce7c7">avic_hardware_setup</a></div><div class="ttdeci">bool avic_hardware_setup(void)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01188">avic.c:1188</a></div></div>
<div class="ttc" id="asvm_8h_html_adb2a01596415bf77bd9a3f22ff165a14"><div class="ttname"><a href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a></div><div class="ttdeci">void recalc_intercepts(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00122">nested.c:122</a></div></div>
<div class="ttc" id="asvm_8h_html_adc8812d5d875ec9a2bf431790db71cfb"><div class="ttname"><a href="svm_8h.html#adc8812d5d875ec9a2bf431790db71cfb">intercept_smi</a></div><div class="ttdeci">bool intercept_smi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00235">svm.c:235</a></div></div>
<div class="ttc" id="asvm_8h_html_add5ee1e85234f2457480494694865c21"><div class="ttname"><a href="svm_8h.html#add5ee1e85234f2457480494694865c21">nested_copy_vmcb_control_to_cache</a></div><div class="ttdeci">void nested_copy_vmcb_control_to_cache(struct vcpu_svm *svm, struct vmcb_control_area *control)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00382">nested.c:382</a></div></div>
<div class="ttc" id="asvm_8h_html_addc2bf7bff76340928f122fbde134c2a"><div class="ttname"><a href="svm_8h.html#addc2bf7bff76340928f122fbde134c2a">svm_set_x2apic_msr_interception</a></div><div class="ttdeci">void svm_set_x2apic_msr_interception(struct vcpu_svm *svm, bool disable)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00892">svm.c:892</a></div></div>
<div class="ttc" id="asvm_8h_html_ae003d7b6aae84aa9b70d64f464e70dfc"><div class="ttname"><a href="svm_8h.html#ae003d7b6aae84aa9b70d64f464e70dfc">nested_svm_update_tsc_ratio_msr</a></div><div class="ttdeci">void nested_svm_update_tsc_ratio_msr(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01532">nested.c:1532</a></div></div>
<div class="ttc" id="asvm_8h_html_ae052404bed168cf69c578a697ce25526"><div class="ttname"><a href="svm_8h.html#ae052404bed168cf69c578a697ce25526">nested_copy_vmcb_save_to_cache</a></div><div class="ttdeci">void nested_copy_vmcb_save_to_cache(struct vcpu_svm *svm, struct vmcb_save_area *save)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00404">nested.c:404</a></div></div>
<div class="ttc" id="asvm_8h_html_ae2a559173016267c3c1ef55be6571c0c"><div class="ttname"><a href="svm_8h.html#ae2a559173016267c3c1ef55be6571c0c">svm_copy_vmloadsave_state</a></div><div class="ttdeci">void svm_copy_vmloadsave_state(struct vmcb *to_vmcb, struct vmcb *from_vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00951">nested.c:951</a></div></div>
<div class="ttc" id="asvm_8h_html_ae7cebb5bd1d0e7eadb2b7df90cca0c74"><div class="ttname"><a href="svm_8h.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a></div><div class="ttdeci">void set_msr_interception(struct kvm_vcpu *vcpu, u32 *msrpm, u32 msr, int read, int write)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00859">svm.c:859</a></div></div>
<div class="ttc" id="asvm_8h_html_ae9f162404fdb37bba372d0c9cdc043ee"><div class="ttname"><a href="svm_8h.html#ae9f162404fdb37bba372d0c9cdc043ee">avic_apicv_post_state_restore</a></div><div class="ttdeci">void avic_apicv_post_state_restore(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00738">avic.c:738</a></div></div>
<div class="ttc" id="asvm_8h_html_aea7fbac9a0652dc113c81593522e47ca"><div class="ttname"><a href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a></div><div class="ttdeci">static bool gif_set(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00483">svm.h:483</a></div></div>
<div class="ttc" id="asvm_8h_html_aea86d846f25c8a44402d3bc2d176130b"><div class="ttname"><a href="svm_8h.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a></div><div class="ttdeci">int nrips</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00206">svm.c:206</a></div></div>
<div class="ttc" id="asvm_8h_html_aeaff9c624af59b36fd36d1c25e279a50"><div class="ttname"><a href="svm_8h.html#aeaff9c624af59b36fd36d1c25e279a50">sev_set_cpu_caps</a></div><div class="ttdeci">void __init sev_set_cpu_caps(void)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02185">sev.c:2185</a></div></div>
<div class="ttc" id="asvm_8h_html_aec23ca96447aab4ff19f594a297bc109"><div class="ttname"><a href="svm_8h.html#aec23ca96447aab4ff19f594a297bc109">svm_set_cr4</a></div><div class="ttdeci">void svm_set_cr4(struct kvm_vcpu *vcpu, unsigned long cr4)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01914">svm.c:1914</a></div></div>
<div class="ttc" id="asvm_8h_html_aecb0b82114f9d516a3ee502c0054e0c0"><div class="ttname"><a href="svm_8h.html#aecb0b82114f9d516a3ee502c0054e0c0">MSRPM_OFFSETS</a></div><div class="ttdeci">#define MSRPM_OFFSETS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00034">svm.h:34</a></div></div>
<div class="ttc" id="asvm_8h_html_aed65a2dabdad6a421b487e1e7b106277"><div class="ttname"><a href="svm_8h.html#aed65a2dabdad6a421b487e1e7b106277">avic_vcpu_get_apicv_inhibit_reasons</a></div><div class="ttdeci">unsigned long avic_vcpu_get_apicv_inhibit_reasons(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00542">avic.c:542</a></div></div>
<div class="ttc" id="asvm_8h_html_aefa7c9e670f5a86519f40b06f5277346"><div class="ttname"><a href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346">nested_exit_on_nmi</a></div><div class="ttdeci">static bool nested_exit_on_nmi(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00586">svm.h:586</a></div></div>
<div class="ttc" id="asvm_8h_html_aefe90b7232034ee5f45a41f108ffb891"><div class="ttname"><a href="svm_8h.html#aefe90b7232034ee5f45a41f108ffb891">svm_copy_vmrun_state</a></div><div class="ttdeci">void svm_copy_vmrun_state(struct vmcb_save_area *to_save, struct vmcb_save_area *from_save)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00931">nested.c:931</a></div></div>
<div class="ttc" id="asvm_8h_html_af04356b0b53ece1f631f1cfa12521642"><div class="ttname"><a href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a></div><div class="ttdeci">static void set_exception_intercept(struct vcpu_svm *svm, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00403">svm.h:403</a></div></div>
<div class="ttc" id="asvm_8h_html_af08dd89f5ee519835337165e9060f526"><div class="ttname"><a href="svm_8h.html#af08dd89f5ee519835337165e9060f526">vmcb_is_dirty</a></div><div class="ttdeci">static bool vmcb_is_dirty(struct vmcb *vmcb, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00359">svm.h:359</a></div></div>
<div class="ttc" id="asvm_8h_html_af1eb77eac84f085b0a943b87f783e30d"><div class="ttname"><a href="svm_8h.html#af1eb77eac84f085b0a943b87f783e30d">sev_vm_destroy</a></div><div class="ttdeci">void sev_vm_destroy(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02140">sev.c:2140</a></div></div>
<div class="ttc" id="asvm_8h_html_af343f7dd067883e0f81017a68e854c09"><div class="ttname"><a href="svm_8h.html#af343f7dd067883e0f81017a68e854c09">sev_free_vcpu</a></div><div class="ttdeci">void sev_free_vcpu(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02373">sev.c:2373</a></div></div>
<div class="ttc" id="asvm_8h_html_af6e4bba26808541629dd240a782f1d05"><div class="ttname"><a href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a></div><div class="ttdeci">static void svm_set_intercept(struct vcpu_svm *svm, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00423">svm.h:423</a></div></div>
<div class="ttc" id="asvm_8h_html_af75098185942f8eb5703b2b65bf9257d"><div class="ttname"><a href="svm_8h.html#af75098185942f8eb5703b2b65bf9257d">avic_ga_log_notifier</a></div><div class="ttdeci">int avic_ga_log_notifier(u32 ga_tag)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00143">avic.c:143</a></div></div>
<div class="ttc" id="asvm_8h_html_afb7dae2607f5d00a49d6baae5747d57a"><div class="ttname"><a href="svm_8h.html#afb7dae2607f5d00a49d6baae5747d57a">enter_svm_guest_mode</a></div><div class="ttdeci">int enter_svm_guest_mode(struct kvm_vcpu *vcpu, u64 vmcb_gpa, struct vmcb *vmcb12, bool from_vmrun)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00785">nested.c:785</a></div></div>
<div class="ttc" id="asvm_8h_html_afdbe781b81d2ae90e81d9bb9e9750789"><div class="ttname"><a href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a></div><div class="ttdeci">static void vmcb_set_intercept(struct vmcb_control_area *control, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00379">svm.h:379</a></div></div>
<div class="ttc" id="asvm_8h_html_afea614d490148481c96faf7c1b5ecb11"><div class="ttname"><a href="svm_8h.html#afea614d490148481c96faf7c1b5ecb11">svm_leave_nested</a></div><div class="ttdeci">void svm_leave_nested(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01229">nested.c:1229</a></div></div>
<div class="ttc" id="asvm_8h_html_affcdeac6765016e970e33d6ecff3eebb"><div class="ttname"><a href="svm_8h.html#affcdeac6765016e970e33d6ecff3eebb">avic_refresh_apicv_exec_ctrl</a></div><div class="ttdeci">void avic_refresh_apicv_exec_ctrl(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01136">avic.c:1136</a></div></div>
<div class="ttc" id="asvm_8h_html_affe9512dad96b228e24b8cc7175db04c"><div class="ttname"><a href="svm_8h.html#affe9512dad96b228e24b8cc7175db04c">svm_complete_interrupt_delivery</a></div><div class="ttdeci">void svm_complete_interrupt_delivery(struct kvm_vcpu *vcpu, int delivery_mode, int trig_mode, int vec)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03633">svm.c:3633</a></div></div>
<div class="ttc" id="avmx_8c_html_a4a5b71928180de4229b920eec470bcaf"><div class="ttname"><a href="vmx_8c.html#a4a5b71928180de4229b920eec470bcaf">DECLARE_BITMAP</a></div><div class="ttdeci">static DECLARE_BITMAP(vmx_vpid_bitmap, VMX_NR_VPIDS)</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
