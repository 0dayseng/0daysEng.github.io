<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KVM: arch/x86/kvm/x86.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ea9599923402ca8ab47fc3e495999dea.html">arch</a></li><li class="navelem"><a class="el" href="dir_c21774f8bc9f0de15163573e5f5fa2b5.html">x86</a></li><li class="navelem"><a class="el" href="dir_fde450fd4b58e2560c53a1e73bfa4d6d.html">kvm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">x86.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="x86_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* SPDX-License-Identifier: GPL-2.0 */</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#ifndef ARCH_X86_KVM_X86_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#define ARCH_X86_KVM_X86_H</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;linux/kvm_host.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;asm/fpu/xstate.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;asm/mce.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;asm/pvclock.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kvm__cache__regs_8h.html">kvm_cache_regs.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kvm__emulate_8h.html">kvm_emulate.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="structkvm__caps.html">   12</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structkvm__caps.html">kvm_caps</a> {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="comment">/* control of guest tsc rate supported? */</span></div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="structkvm__caps.html#abcc6bf2008df1844dba6d861c15712a7">   14</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structkvm__caps.html#abcc6bf2008df1844dba6d861c15712a7">has_tsc_control</a>;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">/* maximum supported tsc_khz for guests */</span></div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="structkvm__caps.html#ac04cfdc245ee764ea7976fbcf3714fcf">   16</a></span>&#160;    u32  <a class="code" href="structkvm__caps.html#ac04cfdc245ee764ea7976fbcf3714fcf">max_guest_tsc_khz</a>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">/* number of bits of the fractional part of the TSC scaling ratio */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="structkvm__caps.html#ab5f7d5c3ca8acc0bd672f8a2d0655c9c">   18</a></span>&#160;    u8   <a class="code" href="structkvm__caps.html#ab5f7d5c3ca8acc0bd672f8a2d0655c9c">tsc_scaling_ratio_frac_bits</a>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">/* maximum allowed value of TSC scaling ratio */</span></div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="structkvm__caps.html#a955589a58e0cf935c8c4536ba2712fd4">   20</a></span>&#160;    u64  <a class="code" href="structkvm__caps.html#a955589a58e0cf935c8c4536ba2712fd4">max_tsc_scaling_ratio</a>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">/* 1ull &lt;&lt; kvm_caps.tsc_scaling_ratio_frac_bits */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="structkvm__caps.html#a4f8f01ced32ac7e2bbdea0fcf6406a76">   22</a></span>&#160;    u64  <a class="code" href="structkvm__caps.html#a4f8f01ced32ac7e2bbdea0fcf6406a76">default_tsc_scaling_ratio</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">/* bus lock detection supported? */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="structkvm__caps.html#ace5d85fecd59efba82ea30e5bac43372">   24</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structkvm__caps.html#ace5d85fecd59efba82ea30e5bac43372">has_bus_lock_exit</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">/* notify VM exit supported? */</span></div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="structkvm__caps.html#a61f0c04f5701cd4cfbb0189913fee3de">   26</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structkvm__caps.html#a61f0c04f5701cd4cfbb0189913fee3de">has_notify_vmexit</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="structkvm__caps.html#a5f245ae0f37b2fe88469bfa8d01a9ab5">   28</a></span>&#160;    u64 <a class="code" href="structkvm__caps.html#a5f245ae0f37b2fe88469bfa8d01a9ab5">supported_mce_cap</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structkvm__caps.html#acb835ad2fee6979c5058003aa5cb601a">   29</a></span>&#160;    u64 <a class="code" href="structkvm__caps.html#acb835ad2fee6979c5058003aa5cb601a">supported_xcr0</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structkvm__caps.html#a6f09eefaf33e60131be48a78f993b353">   30</a></span>&#160;    u64 <a class="code" href="structkvm__caps.html#a6f09eefaf33e60131be48a78f993b353">supported_xss</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structkvm__caps.html#a6ebc5215d02fcc2f2d691280cefad7a2">   31</a></span>&#160;    u64 <a class="code" href="structkvm__caps.html#a6ebc5215d02fcc2f2d691280cefad7a2">supported_perf_cap</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;};</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keywordtype">void</span> <a class="code" href="x86_8h.html#aa8592542ba0f8944f9faf6d39f94a64c">kvm_spurious_fault</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="x86_8h.html#a105e7eb25c5a5a08df7a2109b43aaeaa">   36</a></span>&#160;<span class="preprocessor">#define KVM_NESTED_VMENTER_CONSISTENCY_CHECK(consistency_check)     \</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">({                                  \</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">    bool failed = (consistency_check);              \</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">    if (failed)                         \</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">        trace_kvm_nested_vmenter_failed(#consistency_check, 0); \</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">    failed;                             \</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">})</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * The first...last VMX feature MSRs that are emulated by KVM.  This may or may</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> * not cover all known VMX MSRs, as KVM doesn&#39;t emulate an MSR until there&#39;s an</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * associated feature that KVM supports for nested virtualization.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="x86_8h.html#a5d4283aad352f6c530dd3f0cb2d8a22f">   49</a></span>&#160;<span class="preprocessor">#define KVM_FIRST_EMULATED_VMX_MSR  MSR_IA32_VMX_BASIC</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="x86_8h.html#ad1d14b87c7c2d00f9a7433e88c3268e6">   50</a></span>&#160;<span class="preprocessor">#define KVM_LAST_EMULATED_VMX_MSR   MSR_IA32_VMX_VMFUNC</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="x86_8h.html#ac4cf971fee08547c5647367a9393fca2">   52</a></span>&#160;<span class="preprocessor">#define KVM_DEFAULT_PLE_GAP     128</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="x86_8h.html#a2a5c038e69f5a867a8e34ca54d7ca152">   53</a></span>&#160;<span class="preprocessor">#define KVM_VMX_DEFAULT_PLE_WINDOW  4096</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="x86_8h.html#a8dbcf8fedcb1848df9b0915ee77ad3dd">   54</a></span>&#160;<span class="preprocessor">#define KVM_DEFAULT_PLE_WINDOW_GROW 2</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="x86_8h.html#a65245c185743fd9f09cab0ea68087bda">   55</a></span>&#160;<span class="preprocessor">#define KVM_DEFAULT_PLE_WINDOW_SHRINK   0</span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="x86_8h.html#ac087a6f9f66073976a2531559fa2a4fe">   56</a></span>&#160;<span class="preprocessor">#define KVM_VMX_DEFAULT_PLE_WINDOW_MAX  UINT_MAX</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="x86_8h.html#a8d95d1ac359797529714473f95160801">   57</a></span>&#160;<span class="preprocessor">#define KVM_SVM_DEFAULT_PLE_WINDOW_MAX  USHRT_MAX</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="x86_8h.html#a59cb051233b1de170d81a73ed5aeda6d">   58</a></span>&#160;<span class="preprocessor">#define KVM_SVM_DEFAULT_PLE_WINDOW  3000</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="x86_8h.html#a31a89bf42745ce50d984bc0631945622">   60</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a31a89bf42745ce50d984bc0631945622">__grow_ple_window</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> val,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> base, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> modifier, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    u64 ret = val;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (modifier &lt; 1)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">return</span> base;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (modifier &lt; base)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        ret *= modifier;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        ret += modifier;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">return</span> min(ret, (u64)max);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="x86_8h.html#ae123da10adfeadb5ddcdf423f0bba192">   76</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="x86_8h.html#ae123da10adfeadb5ddcdf423f0bba192">__shrink_ple_window</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> val,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> base, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> modifier, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> min)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;{</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (modifier &lt; 1)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">return</span> base;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">if</span> (modifier &lt; base)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        val /= modifier;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        val -= modifier;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">return</span> max(val, min);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="x86_8h.html#aba1ccdce5a2971ec770ca3ed1aa09120">   90</a></span>&#160;<span class="preprocessor">#define MSR_IA32_CR_PAT_DEFAULT  0x0007040600070406ULL</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keywordtype">void</span> <a class="code" href="x86_8h.html#abf28742eaf88f469f322233afeb66b59">kvm_service_local_tlb_flush_requests</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a52623517d65c58a92d84f08015198d20">kvm_check_nested_events</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="x86_8h.html#abf05d82904db21951117acb30ddf9c37">   95</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#abf05d82904db21951117acb30ddf9c37">kvm_vcpu_has_run</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">return</span> vcpu-&gt;arch.last_vmentry_cpu != -1;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b">  100</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b">kvm_is_exception_pending</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">return</span> vcpu-&gt;arch.exception.pending ||</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;           vcpu-&gt;arch.exception_vmexit.pending ||</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;           kvm_test_request(KVM_REQ_TRIPLE_FAULT, vcpu);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4">  107</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4">kvm_clear_exception_queue</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    vcpu-&gt;arch.exception.pending = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    vcpu-&gt;arch.exception.injected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    vcpu-&gt;arch.exception_vmexit.pending = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="x86_8h.html#aaa166361b58ce8e326699e6cfe87e39a">  114</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#aaa166361b58ce8e326699e6cfe87e39a">kvm_queue_interrupt</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u8 vector,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">bool</span> soft)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    vcpu-&gt;arch.interrupt.injected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    vcpu-&gt;arch.interrupt.soft = soft;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    vcpu-&gt;arch.interrupt.nr = vector;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160">  122</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160">kvm_clear_interrupt_queue</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    vcpu-&gt;arch.interrupt.injected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="x86_8h.html#a2a4bd8f3c9a644ab1bc76383672e8d4b">  127</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a2a4bd8f3c9a644ab1bc76383672e8d4b">kvm_event_needs_reinjection</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> vcpu-&gt;arch.exception.injected || vcpu-&gt;arch.interrupt.injected ||</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        vcpu-&gt;arch.nmi_injected;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="x86_8h.html#a441b0296c9e66d1e4f4c554d73a3093e">  133</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a441b0296c9e66d1e4f4c554d73a3093e">kvm_exception_is_soft</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nr)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;{</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">return</span> (nr == BP_VECTOR) || (nr == OF_VECTOR);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="x86_8h.html#a134b4e55e4ea92a3519e9538f05d4e6b">  138</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a134b4e55e4ea92a3519e9538f05d4e6b">is_protmode</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3">kvm_is_cr0_bit_set</a>(vcpu, X86_CR0_PE);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d">  143</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d">is_long_mode</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor">#ifdef CONFIG_X86_64</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span> !!(vcpu-&gt;arch.efer &amp; EFER_LMA);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118">  152</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118">is_64_bit_mode</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">int</span> cs_db, cs_l;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    WARN_ON_ONCE(vcpu-&gt;arch.guest_state_protected);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d">is_long_mode</a>(vcpu))</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    static_call(kvm_x86_get_cs_db_l_bits)(vcpu, &amp;cs_db, &amp;cs_l);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">return</span> cs_l;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="x86_8h.html#af110270e09fabc54923cc5a9fbd6c543">  164</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#af110270e09fabc54923cc5a9fbd6c543">is_64_bit_hypercall</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">     * If running with protected guest state, the CS register is not</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">     * accessible. The hypercall register values will have had to been</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">     * provided in 64-bit mode, so assume the guest is in 64-bit.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> vcpu-&gt;arch.guest_state_protected || <a class="code" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118">is_64_bit_mode</a>(vcpu);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="x86_8h.html#a36093b02c4959027f06b57d11d12ad84">  174</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a36093b02c4959027f06b57d11d12ad84">x86_exception_has_error_code</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vector)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;{</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keyword">static</span> u32 exception_has_error_code = BIT(DF_VECTOR) | BIT(TS_VECTOR) |</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            BIT(NP_VECTOR) | BIT(SS_VECTOR) | BIT(GP_VECTOR) |</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            BIT(PF_VECTOR) | BIT(AC_VECTOR);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> (1U &lt;&lt; vector) &amp; exception_has_error_code;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="x86_8h.html#a661bc84e256a87cbd929ffb7c1f61b2f">  183</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a661bc84e256a87cbd929ffb7c1f61b2f">mmu_is_nested</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">return</span> vcpu-&gt;arch.walk_mmu == &amp;vcpu-&gt;arch.nested_mmu;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="x86_8h.html#abc2ffd79aced13c24f0c4143465d3d51">  188</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#abc2ffd79aced13c24f0c4143465d3d51">is_pae</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;{</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65">kvm_is_cr4_bit_set</a>(vcpu, X86_CR4_PAE);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="x86_8h.html#a46aba02424c106f3cdb462fd774f54f4">  193</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a46aba02424c106f3cdb462fd774f54f4">is_pse</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65">kvm_is_cr4_bit_set</a>(vcpu, X86_CR4_PSE);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">  198</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">return</span> likely(<a class="code" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3">kvm_is_cr0_bit_set</a>(vcpu, X86_CR0_PG));</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="x86_8h.html#aaa36cdb43bbf6ed6af3b10deed46a436">  203</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#aaa36cdb43bbf6ed6af3b10deed46a436">is_pae_paging</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">return</span> !<a class="code" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d">is_long_mode</a>(vcpu) &amp;&amp; <a class="code" href="x86_8h.html#abc2ffd79aced13c24f0c4143465d3d51">is_pae</a>(vcpu) &amp;&amp; <a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(vcpu);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="x86_8h.html#af360aa7bd1f33ab25089b12431f11773">  208</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> u8 <a class="code" href="x86_8h.html#af360aa7bd1f33ab25089b12431f11773">vcpu_virt_addr_bits</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;{</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65">kvm_is_cr4_bit_set</a>(vcpu, X86_CR4_LA57) ? 57 : 48;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="x86_8h.html#af9a5d53e18d888ed043578916e51cc55">  213</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#af9a5d53e18d888ed043578916e51cc55">is_noncanonical_address</a>(u64 la, <span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;{</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">return</span> !__is_canonical_address(la, <a class="code" href="x86_8h.html#af360aa7bd1f33ab25089b12431f11773">vcpu_virt_addr_bits</a>(vcpu));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="x86_8h.html#ab77d498df3e80dc4bdbbd7ef398f9f4e">  218</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#ab77d498df3e80dc4bdbbd7ef398f9f4e">vcpu_cache_mmio_info</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    gva_t gva, gfn_t gfn, <span class="keywordtype">unsigned</span> access)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    u64 gen = kvm_memslots(vcpu-&gt;kvm)-&gt;generation;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (unlikely(gen &amp; KVM_MEMSLOT_GEN_UPDATE_IN_PROGRESS))</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">     * If this is a shadow nested page table, the &quot;GVA&quot; is</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">     * actually a nGPA.</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    vcpu-&gt;arch.mmio_gva = <a class="code" href="x86_8h.html#a661bc84e256a87cbd929ffb7c1f61b2f">mmu_is_nested</a>(vcpu) ? 0 : gva &amp; PAGE_MASK;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    vcpu-&gt;arch.mmio_access = access;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    vcpu-&gt;arch.mmio_gfn = gfn;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    vcpu-&gt;arch.mmio_gen = gen;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="x86_8h.html#a27679e0f68166573b056ce81832b1fd8">  236</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a27679e0f68166573b056ce81832b1fd8">vcpu_match_mmio_gen</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">return</span> vcpu-&gt;arch.mmio_gen == kvm_memslots(vcpu-&gt;kvm)-&gt;generation;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"> * Clear the mmio cache info for the given gva. If gva is MMIO_GVA_ANY, we</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"> * clear all mmio cache info.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="x86_8h.html#ae8fc6afc14ddddfd3c359c6bd495b3ff">  245</a></span>&#160;<span class="preprocessor">#define MMIO_GVA_ANY (~(gva_t)0)</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="x86_8h.html#a0647452067d01e527a8cd1da2fb6b897">  247</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#a0647452067d01e527a8cd1da2fb6b897">vcpu_clear_mmio_info</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, gva_t gva)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;{</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (gva != <a class="code" href="x86_8h.html#ae8fc6afc14ddddfd3c359c6bd495b3ff">MMIO_GVA_ANY</a> &amp;&amp; vcpu-&gt;arch.mmio_gva != (gva &amp; PAGE_MASK))</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    vcpu-&gt;arch.mmio_gva = 0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="x86_8h.html#a2cc991ad82a0546dd38fabaf3c096037">  255</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a2cc991ad82a0546dd38fabaf3c096037">vcpu_match_mmio_gva</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> gva)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#a27679e0f68166573b056ce81832b1fd8">vcpu_match_mmio_gen</a>(vcpu) &amp;&amp; vcpu-&gt;arch.mmio_gva &amp;&amp;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          vcpu-&gt;arch.mmio_gva == (gva &amp; PAGE_MASK))</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="x86_8h.html#adec8392408e5b0e363872e91e83a90af">  264</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#adec8392408e5b0e363872e91e83a90af">vcpu_match_mmio_gpa</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, gpa_t gpa)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#a27679e0f68166573b056ce81832b1fd8">vcpu_match_mmio_gen</a>(vcpu) &amp;&amp; vcpu-&gt;arch.mmio_gfn &amp;&amp;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          vcpu-&gt;arch.mmio_gfn == gpa &gt;&gt; PAGE_SHIFT)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;}</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="x86_8h.html#a9f7e7cd8d352da04de3bf53cbb3b4e57">  273</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="x86_8h.html#a9f7e7cd8d352da04de3bf53cbb3b4e57">kvm_register_read</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">int</span> reg)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;{</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> val = <a class="code" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6">kvm_register_read_raw</a>(vcpu, reg);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118">is_64_bit_mode</a>(vcpu) ? val : (u32)val;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="x86_8h.html#a777bea7283c857dc549e54eaa54fe12e">  280</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#a777bea7283c857dc549e54eaa54fe12e">kvm_register_write</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                       <span class="keywordtype">int</span> reg, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> val)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;{</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118">is_64_bit_mode</a>(vcpu))</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        val = (u32)val;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b">kvm_register_write_raw</a>(vcpu, reg, val);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf">  288</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf">kvm_check_has_quirk</a>(<span class="keyword">struct</span> kvm *kvm, u64 quirk)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span> !(kvm-&gt;arch.disabled_quirks &amp; quirk);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordtype">void</span> <a class="code" href="x86_8h.html#aceb096037b301784d562b0bac7334b70">kvm_inject_realmode_interrupt</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">int</span> irq, <span class="keywordtype">int</span> inc_eip);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;u64 <a class="code" href="x86_8h.html#abd4913c1a5c4c66a089ccadc445cd9a2">get_kvmclock_ns</a>(<span class="keyword">struct</span> kvm *kvm);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;uint64_t <a class="code" href="x86_8h.html#a3a7c3d562176e798101d21bfaaae77a9">kvm_get_wall_clock_epoch</a>(<span class="keyword">struct</span> kvm *kvm);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a7064cd8944dd550352cef83c72612045">kvm_read_guest_virt</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    gva_t addr, <span class="keywordtype">void</span> *val, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bytes,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">struct</span> <a class="code" href="structx86__exception.html">x86_exception</a> *exception);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a32094f678d49270bf06d3c6fd08354b9">kvm_write_guest_virt_system</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    gva_t addr, <span class="keywordtype">void</span> *val, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bytes,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">struct</span> <a class="code" href="structx86__exception.html">x86_exception</a> *exception);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#adc471c9bb1bd010f5c75e803cb312b53">handle_ud</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordtype">void</span> <a class="code" href="x86_8h.html#a92e1a819da31f9776852acd897808e99">kvm_deliver_exception_payload</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                   <span class="keyword">struct</span> kvm_queued_exception *ex);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keywordtype">void</span> <a class="code" href="x86_8h.html#a1f8955b4b4c2ac234228a84811d2b1d8">kvm_vcpu_mtrr_init</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;u8 <a class="code" href="x86_8h.html#a92c398e9dacb06cf11f5f5364f3e1c36">kvm_mtrr_get_guest_memory_type</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, gfn_t gfn);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a2b95f238c68e317e64e57d06f2a698dd">kvm_mtrr_set_msr</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u32 msr, u64 data);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a81a164c2615ef1c0fc231d71e5ba9a53">kvm_mtrr_get_msr</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u32 msr, u64 *pdata);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#ae3f4e197f50db225e34de21d65633fcb">kvm_mtrr_check_gfn_range_consistency</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, gfn_t gfn,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                      <span class="keywordtype">int</span> page_num);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a47d88660a2a5f8ee22df1253604d1ed7">kvm_vector_hashing_enabled</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordtype">void</span> <a class="code" href="x86_8h.html#af666984080b5a37311441557672f29c1">kvm_fixup_and_inject_pf_error</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, gva_t gva, u16 error_code);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a1d439c08a5848010284827827cfcbf76">x86_decode_emulated_instruction</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">int</span> emulation_type,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    <span class="keywordtype">void</span> *insn, <span class="keywordtype">int</span> insn_len);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a3f6bd8b3f0bc1678451fd28682e7c3b1">x86_emulate_instruction</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, gpa_t cr2_or_gpa,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordtype">int</span> emulation_type, <span class="keywordtype">void</span> *insn, <span class="keywordtype">int</span> insn_len);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;fastpath_t <a class="code" href="x86_8h.html#a8a37294ff599bdc5183d75ecdd61412a">handle_fastpath_set_msr_irqoff</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keyword">extern</span> u64 <a class="code" href="x86_8h.html#ae7a4d6c3aa7c382164952fef430d61b8">host_xcr0</a>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keyword">extern</span> u64 <a class="code" href="x86_8h.html#a2a00bb037b56dda33c39f38fbd2f9e24">host_xss</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keyword">extern</span> u64 <a class="code" href="x86_8h.html#a104d55cf37c388958d6d7e603d01f771">host_arch_capabilities</a>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structkvm__caps.html">kvm_caps</a> <a class="code" href="structkvm__caps.html">kvm_caps</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a68fadb354dc1d2785801f6c3d0c26eb7">enable_pmu</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"> * Get a filtered version of KVM&#39;s supported XCR0 that strips out dynamic</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> * features for which the current process doesn&#39;t (yet) have permission to use.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> * This is intended to be used only when enumerating support to userspace,</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"> * e.g. in KVM_GET_SUPPORTED_CPUID and KVM_CAP_XSAVE2, it does NOT need to be</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"> * used to check/restrict guest behavior as KVM rejects KVM_SET_CPUID{2} if</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"> * userspace attempts to enable unpermitted features.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="x86_8h.html#aa3fd405bd522a08e3b5ccffbe8942a3c">  341</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> u64 <a class="code" href="x86_8h.html#aa3fd405bd522a08e3b5ccffbe8942a3c">kvm_get_filtered_xcr0</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;{</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    u64 permitted_xcr0 = <a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#acb835ad2fee6979c5058003aa5cb601a">supported_xcr0</a>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    BUILD_BUG_ON(XFEATURE_MASK_USER_DYNAMIC != XFEATURE_MASK_XTILE_DATA);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (permitted_xcr0 &amp; XFEATURE_MASK_USER_DYNAMIC) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        permitted_xcr0 &amp;= xstate_get_guest_group_perm();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">         * Treat XTILE_CFG as unsupported if the current process isn&#39;t</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">         * allowed to use XTILE_DATA, as attempting to set XTILE_CFG in</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">         * XCR0 without setting XTILE_DATA is architecturally illegal.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">if</span> (!(permitted_xcr0 &amp; XFEATURE_MASK_XTILE_DATA))</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            permitted_xcr0 &amp;= ~XFEATURE_MASK_XTILE_CFG;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span> permitted_xcr0;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="x86_8h.html#a5523aac5838b664e939f6560ae882d9e">  361</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a5523aac5838b664e939f6560ae882d9e">kvm_mpx_supported</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;{</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#acb835ad2fee6979c5058003aa5cb601a">supported_xcr0</a> &amp; (XFEATURE_MASK_BNDREGS | XFEATURE_MASK_BNDCSR))</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        == (XFEATURE_MASK_BNDREGS | XFEATURE_MASK_BNDCSR);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a8f21df7266cc84c2fc3559e1707f3bc9">min_timer_period_us</a>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#af50299f5f7fdc3db1348e9196bbb594c">enable_vmware_backdoor</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="x86_8h.html#ac2151c0af8d70153ba37f2a4b4064c0f">pi_inject_timer</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a0d9fbcc3b584a0f8c685fa1b8def44bb">report_ignored_msrs</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a1f16bc59ea1ddc9aa8a189736008941c">eager_page_split</a>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="x86_8h.html#acc780a5b6599f782ea4d46c4cd5d9d1f">  377</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#acc780a5b6599f782ea4d46c4cd5d9d1f">kvm_pr_unimpl_wrmsr</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u32 msr, u64 data)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#a0d9fbcc3b584a0f8c685fa1b8def44bb">report_ignored_msrs</a>)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        vcpu_unimpl(vcpu, <span class="stringliteral">&quot;Unhandled WRMSR(0x%x) = 0x%llx\n&quot;</span>, msr, data);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="x86_8h.html#ac914d1912e8bdc3ffad1a2c561236a0b">  383</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#ac914d1912e8bdc3ffad1a2c561236a0b">kvm_pr_unimpl_rdmsr</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u32 msr)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;{</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#a0d9fbcc3b584a0f8c685fa1b8def44bb">report_ignored_msrs</a>)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        vcpu_unimpl(vcpu, <span class="stringliteral">&quot;Unhandled RDMSR(0x%x)\n&quot;</span>, msr);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="x86_8h.html#abbd5927434d63bff53c0c1f8185d46df">  389</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> u64 <a class="code" href="x86_8h.html#abbd5927434d63bff53c0c1f8185d46df">nsec_to_cycles</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u64 nsec)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;{</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">return</span> pvclock_scale_delta(nsec, vcpu-&gt;arch.virtual_tsc_mult,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                   vcpu-&gt;arch.virtual_tsc_shift);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">/* Same &quot;calling convention&quot; as do_div:</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"> * - divide (n &lt;&lt; 32) by base</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"> * - put result in n</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"> * - return remainder</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="x86_8h.html#a3b4459820e4a16c0693484c9732565cd">  400</a></span>&#160;<span class="preprocessor">#define do_shl32_div32(n, base)                 \</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">    ({                          \</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">        u32 __quot, __rem;                  \</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor">        asm(&quot;divl %2&quot;</span> : &quot;=a&quot; (__quot), &quot;=d&quot; (__rem)     \</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            : &quot;rm&quot; (base), &quot;0&quot; (0), &quot;1&quot; ((u32) n)); \</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        n = __quot;                     \</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        __rem;                      \</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;     })</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="x86_8h.html#a8a31c0c01a5fe5dc33f7c5675ba4d376">  409</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a8a31c0c01a5fe5dc33f7c5675ba4d376">kvm_mwait_in_guest</a>(<span class="keyword">struct</span> kvm *kvm)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;{</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">return</span> kvm-&gt;arch.mwait_in_guest;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231">  414</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231">kvm_hlt_in_guest</a>(<span class="keyword">struct</span> kvm *kvm)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">return</span> kvm-&gt;arch.hlt_in_guest;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;}</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="x86_8h.html#ab226ac0135835109146350d5db3d4031">  419</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#ab226ac0135835109146350d5db3d4031">kvm_pause_in_guest</a>(<span class="keyword">struct</span> kvm *kvm)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">return</span> kvm-&gt;arch.pause_in_guest;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="x86_8h.html#a2eb72fec495d01dbc2a51f5c1a69b75c">  424</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a2eb72fec495d01dbc2a51f5c1a69b75c">kvm_cstate_in_guest</a>(<span class="keyword">struct</span> kvm *kvm)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;{</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">return</span> kvm-&gt;arch.cstate_in_guest;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="x86_8h.html#ae210f9c6c59c663b1b256450b31ee60c">  429</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#ae210f9c6c59c663b1b256450b31ee60c">kvm_notify_vmexit_enabled</a>(<span class="keyword">struct</span> kvm *kvm)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;{</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">return</span> kvm-&gt;arch.notify_vmexit_flags &amp; KVM_X86_NOTIFY_VMEXIT_ENABLED;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bd">  434</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bd">kvm_intr_type</a> {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">/* Values are arbitrary, but must be non-zero. */</span></div>
<div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bda0d87399b8a92905079d9404cfa46ca93">  436</a></span>&#160;    <a class="code" href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bda0d87399b8a92905079d9404cfa46ca93">KVM_HANDLING_IRQ</a> = 1,</div>
<div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bdaacdf5086536076396283ee0384fe725a">  437</a></span>&#160;    <a class="code" href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bdaacdf5086536076396283ee0384fe725a">KVM_HANDLING_NMI</a>,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;};</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="x86_8h.html#a759070a52abe7fcdf99cc62134289d72">  440</a></span>&#160;<span class="keyword">static</span> __always_inline <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#a759070a52abe7fcdf99cc62134289d72">kvm_before_interrupt</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                         <span class="keyword">enum</span> <a class="code" href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bd">kvm_intr_type</a> intr)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;{</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    WRITE_ONCE(vcpu-&gt;arch.handling_intr_from_guest, (u8)intr);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="x86_8h.html#a3fd078203f842566e7e4250b50fd3691">  446</a></span>&#160;<span class="keyword">static</span> __always_inline <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#a3fd078203f842566e7e4250b50fd3691">kvm_after_interrupt</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;{</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    WRITE_ONCE(vcpu-&gt;arch.handling_intr_from_guest, 0);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;}</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="x86_8h.html#ad7b442570343aab34d0666cf4e6dcc20">  451</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#ad7b442570343aab34d0666cf4e6dcc20">kvm_handling_nmi_from_guest</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;{</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> vcpu-&gt;arch.handling_intr_from_guest == <a class="code" href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bdaacdf5086536076396283ee0384fe725a">KVM_HANDLING_NMI</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="x86_8h.html#a572e16f77096be80cec8ed2137ea74c2">  456</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a572e16f77096be80cec8ed2137ea74c2">kvm_pat_valid</a>(u64 data)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (data &amp; 0xF8F8F8F8F8F8F8F8ull)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">/* 0, 1, 4, 5, 6, 7 are valid values.  */</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">return</span> (data | ((data &amp; 0x0202020202020202ull) &lt;&lt; 1)) == data;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="x86_8h.html#a6d86e9ee10c2cd72b82aef25cabafd82">  464</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a6d86e9ee10c2cd72b82aef25cabafd82">kvm_dr7_valid</a>(u64 data)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;{</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">/* Bits [63:32] are reserved */</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span> !(data &gt;&gt; 32);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div>
<div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="x86_8h.html#a401b9fcb1381d2fbfc488f8520093cee">  469</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#a401b9fcb1381d2fbfc488f8520093cee">kvm_dr6_valid</a>(u64 data)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;{</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">/* Bits [63:32] are reserved */</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">return</span> !(data &gt;&gt; 32);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"> * Trigger machine check on the host. We assume all the MSRs are already set up</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"> * by the CPU and that we still run on the same CPU as the MCE occurred on.</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment"> * We pass a fake environment to the machine check handler because we want</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"> * the guest to be always treated like user space, no matter what context</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"> * it used internally.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="x86_8h.html#aa539ceac11af1b634966fdd3d8c68cc5">  482</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="x86_8h.html#aa539ceac11af1b634966fdd3d8c68cc5">kvm_machine_check</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;{</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#if defined(CONFIG_X86_MCE)</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keyword">struct </span>pt_regs regs = {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        .cs = 3, <span class="comment">/* Fake ring 3 no matter what the guest ran on */</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        .flags = X86_EFLAGS_IF,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    };</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    do_machine_check(&amp;regs);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordtype">void</span> <a class="code" href="x86_8h.html#aed9e7eaa275b4dc9692bbbfea052ca53">kvm_load_guest_xsave_state</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordtype">void</span> <a class="code" href="x86_8h.html#aff7b722decad07b127dc964cb4ba5ebc">kvm_load_host_xsave_state</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a005f66d3c1752a2c76df97c8e160110f">kvm_spec_ctrl_test_value</a>(u64 value);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#af08b5422fd770e61736c80ba64d811f8">__kvm_is_valid_cr4</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> cr4);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a918fccc2a3b0a8c2fe80ed713b144e36">kvm_handle_memory_failure</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">int</span> r,</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                  <span class="keyword">struct</span> <a class="code" href="structx86__exception.html">x86_exception</a> *e);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a97b209e5c87a4c7b5850646ab9a1919c">kvm_handle_invpcid</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> type, gva_t gva);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="x86_8h.html#aea310c0e4f695bd1c6b5d96aa1dbd940">kvm_msr_allowed</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, u32 index, u32 type);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"> * Internal error codes that are used to indicate that MSR emulation encountered</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"> * an error that should result in #GP in the guest, unless userspace</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"> * handles it.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="x86_8h.html#ab6b80774ea2294f5cbe77a62e510e3dd">  508</a></span>&#160;<span class="preprocessor">#define  KVM_MSR_RET_INVALID    2   </span><span class="comment">/* in-kernel MSR emulation #GP condition */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00509"></a><span class="lineno"><a class="line" href="x86_8h.html#a29b1151bc5a2584483f8b20bd7f3231f">  509</a></span>&#160;<span class="preprocessor">#define  KVM_MSR_RET_FILTERED   3   </span><span class="comment">/* #GP due to userspace MSR filter */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="x86_8h.html#a04c1d2c8a6651e35309cd9bd9f129e4d">  511</a></span>&#160;<span class="preprocessor">#define __cr4_reserved_bits(__cpu_has, __c)             \</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">({                                                      \</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">    u64 __reserved_bits = CR4_RESERVED_BITS;        \</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">                                                        \</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor">    if (!__cpu_has(__c, X86_FEATURE_XSAVE))         \</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">        __reserved_bits |= X86_CR4_OSXSAVE;     \</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">    if (!__cpu_has(__c, X86_FEATURE_SMEP))          \</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">        __reserved_bits |= X86_CR4_SMEP;        \</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">    if (!__cpu_has(__c, X86_FEATURE_SMAP))          \</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="preprocessor">        __reserved_bits |= X86_CR4_SMAP;        \</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="preprocessor">    if (!__cpu_has(__c, X86_FEATURE_FSGSBASE))      \</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">        __reserved_bits |= X86_CR4_FSGSBASE;    \</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">    if (!__cpu_has(__c, X86_FEATURE_PKU))           \</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor">        __reserved_bits |= X86_CR4_PKE;         \</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">    if (!__cpu_has(__c, X86_FEATURE_LA57))          \</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor">        __reserved_bits |= X86_CR4_LA57;        \</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor">    if (!__cpu_has(__c, X86_FEATURE_UMIP))          \</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor">        __reserved_bits |= X86_CR4_UMIP;        \</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">    if (!__cpu_has(__c, X86_FEATURE_VMX))           \</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">        __reserved_bits |= X86_CR4_VMXE;        \</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">    if (!__cpu_has(__c, X86_FEATURE_PCID))          \</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">        __reserved_bits |= X86_CR4_PCIDE;       \</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">    if (!__cpu_has(__c, X86_FEATURE_LAM))           \</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor">        __reserved_bits |= X86_CR4_LAM_SUP;     \</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">    __reserved_bits;                                \</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor">})</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#a7ea7da65471d9a799946fa2fa4b35427">kvm_sev_es_mmio_write</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, gpa_t src, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bytes,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;              <span class="keywordtype">void</span> *dst);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#adcdcd13c40eff36a60e0b4c9ef705b57">kvm_sev_es_mmio_read</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, gpa_t src, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bytes,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;             <span class="keywordtype">void</span> *dst);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="keywordtype">int</span> <a class="code" href="x86_8h.html#ac4b95013b15c215fb1fcfd251d2e006d">kvm_sev_es_string_io</a>(<span class="keyword">struct</span> kvm_vcpu *vcpu, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> port, <span class="keywordtype">void</span> *data,  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;             <span class="keywordtype">int</span> in);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="akvm__cache__regs_8h_html"><div class="ttname"><a href="kvm__cache__regs_8h.html">kvm_cache_regs.h</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_a16b29ca8796e3da212a8faf1b2dc7ff3"><div class="ttname"><a href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3">kvm_is_cr0_bit_set</a></div><div class="ttdeci">static __always_inline bool kvm_is_cr0_bit_set(struct kvm_vcpu *vcpu, unsigned long cr0_bit)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00160">kvm_cache_regs.h:160</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_a2b779657b20f7afa44c0172b1478ac65"><div class="ttname"><a href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65">kvm_is_cr4_bit_set</a></div><div class="ttdeci">static __always_inline bool kvm_is_cr4_bit_set(struct kvm_vcpu *vcpu, unsigned long cr4_bit)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00182">kvm_cache_regs.h:182</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_a5117377174dc7ebf722e4976c0ae736b"><div class="ttname"><a href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b">kvm_register_write_raw</a></div><div class="ttdeci">static void kvm_register_write_raw(struct kvm_vcpu *vcpu, int reg, unsigned long val)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00106">kvm_cache_regs.h:106</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_a5d9eb0563cffb1e3ed1cccebabcf2df6"><div class="ttname"><a href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6">kvm_register_read_raw</a></div><div class="ttdeci">static unsigned long kvm_register_read_raw(struct kvm_vcpu *vcpu, int reg)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00095">kvm_cache_regs.h:95</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html"><div class="ttname"><a href="kvm__emulate_8h.html">kvm_emulate.h</a></div></div>
<div class="ttc" id="astructkvm__caps_html"><div class="ttname"><a href="structkvm__caps.html">kvm_caps</a></div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00012">x86.h:12</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a4f8f01ced32ac7e2bbdea0fcf6406a76"><div class="ttname"><a href="structkvm__caps.html#a4f8f01ced32ac7e2bbdea0fcf6406a76">kvm_caps::default_tsc_scaling_ratio</a></div><div class="ttdeci">u64 default_tsc_scaling_ratio</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00022">x86.h:22</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a5f245ae0f37b2fe88469bfa8d01a9ab5"><div class="ttname"><a href="structkvm__caps.html#a5f245ae0f37b2fe88469bfa8d01a9ab5">kvm_caps::supported_mce_cap</a></div><div class="ttdeci">u64 supported_mce_cap</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00028">x86.h:28</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a61f0c04f5701cd4cfbb0189913fee3de"><div class="ttname"><a href="structkvm__caps.html#a61f0c04f5701cd4cfbb0189913fee3de">kvm_caps::has_notify_vmexit</a></div><div class="ttdeci">bool has_notify_vmexit</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00026">x86.h:26</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a6ebc5215d02fcc2f2d691280cefad7a2"><div class="ttname"><a href="structkvm__caps.html#a6ebc5215d02fcc2f2d691280cefad7a2">kvm_caps::supported_perf_cap</a></div><div class="ttdeci">u64 supported_perf_cap</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00031">x86.h:31</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a6f09eefaf33e60131be48a78f993b353"><div class="ttname"><a href="structkvm__caps.html#a6f09eefaf33e60131be48a78f993b353">kvm_caps::supported_xss</a></div><div class="ttdeci">u64 supported_xss</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00030">x86.h:30</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a955589a58e0cf935c8c4536ba2712fd4"><div class="ttname"><a href="structkvm__caps.html#a955589a58e0cf935c8c4536ba2712fd4">kvm_caps::max_tsc_scaling_ratio</a></div><div class="ttdeci">u64 max_tsc_scaling_ratio</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00020">x86.h:20</a></div></div>
<div class="ttc" id="astructkvm__caps_html_ab5f7d5c3ca8acc0bd672f8a2d0655c9c"><div class="ttname"><a href="structkvm__caps.html#ab5f7d5c3ca8acc0bd672f8a2d0655c9c">kvm_caps::tsc_scaling_ratio_frac_bits</a></div><div class="ttdeci">u8 tsc_scaling_ratio_frac_bits</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00018">x86.h:18</a></div></div>
<div class="ttc" id="astructkvm__caps_html_abcc6bf2008df1844dba6d861c15712a7"><div class="ttname"><a href="structkvm__caps.html#abcc6bf2008df1844dba6d861c15712a7">kvm_caps::has_tsc_control</a></div><div class="ttdeci">bool has_tsc_control</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00014">x86.h:14</a></div></div>
<div class="ttc" id="astructkvm__caps_html_ac04cfdc245ee764ea7976fbcf3714fcf"><div class="ttname"><a href="structkvm__caps.html#ac04cfdc245ee764ea7976fbcf3714fcf">kvm_caps::max_guest_tsc_khz</a></div><div class="ttdeci">u32 max_guest_tsc_khz</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00016">x86.h:16</a></div></div>
<div class="ttc" id="astructkvm__caps_html_acb835ad2fee6979c5058003aa5cb601a"><div class="ttname"><a href="structkvm__caps.html#acb835ad2fee6979c5058003aa5cb601a">kvm_caps::supported_xcr0</a></div><div class="ttdeci">u64 supported_xcr0</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00029">x86.h:29</a></div></div>
<div class="ttc" id="astructkvm__caps_html_ace5d85fecd59efba82ea30e5bac43372"><div class="ttname"><a href="structkvm__caps.html#ace5d85fecd59efba82ea30e5bac43372">kvm_caps::has_bus_lock_exit</a></div><div class="ttdeci">bool has_bus_lock_exit</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00024">x86.h:24</a></div></div>
<div class="ttc" id="astructx86__exception_html"><div class="ttname"><a href="structx86__exception.html">x86_exception</a></div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00022">kvm_emulate.h:22</a></div></div>
<div class="ttc" id="ax86_8h_html_a005f66d3c1752a2c76df97c8e160110f"><div class="ttname"><a href="x86_8h.html#a005f66d3c1752a2c76df97c8e160110f">kvm_spec_ctrl_test_value</a></div><div class="ttdeci">int kvm_spec_ctrl_test_value(u64 value)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13532">x86.c:13532</a></div></div>
<div class="ttc" id="ax86_8h_html_a0647452067d01e527a8cd1da2fb6b897"><div class="ttname"><a href="x86_8h.html#a0647452067d01e527a8cd1da2fb6b897">vcpu_clear_mmio_info</a></div><div class="ttdeci">static void vcpu_clear_mmio_info(struct kvm_vcpu *vcpu, gva_t gva)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00247">x86.h:247</a></div></div>
<div class="ttc" id="ax86_8h_html_a0d9fbcc3b584a0f8c685fa1b8def44bb"><div class="ttname"><a href="x86_8h.html#a0d9fbcc3b584a0f8c685fa1b8def44bb">report_ignored_msrs</a></div><div class="ttdeci">bool report_ignored_msrs</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00150">x86.c:150</a></div></div>
<div class="ttc" id="ax86_8h_html_a104d55cf37c388958d6d7e603d01f771"><div class="ttname"><a href="x86_8h.html#a104d55cf37c388958d6d7e603d01f771">host_arch_capabilities</a></div><div class="ttdeci">u64 host_arch_capabilities</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00241">x86.c:241</a></div></div>
<div class="ttc" id="ax86_8h_html_a134b4e55e4ea92a3519e9538f05d4e6b"><div class="ttname"><a href="x86_8h.html#a134b4e55e4ea92a3519e9538f05d4e6b">is_protmode</a></div><div class="ttdeci">static bool is_protmode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00138">x86.h:138</a></div></div>
<div class="ttc" id="ax86_8h_html_a1d439c08a5848010284827827cfcbf76"><div class="ttname"><a href="x86_8h.html#a1d439c08a5848010284827827cfcbf76">x86_decode_emulated_instruction</a></div><div class="ttdeci">int x86_decode_emulated_instruction(struct kvm_vcpu *vcpu, int emulation_type, void *insn, int insn_len)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09057">x86.c:9057</a></div></div>
<div class="ttc" id="ax86_8h_html_a1f16bc59ea1ddc9aa8a189736008941c"><div class="ttname"><a href="x86_8h.html#a1f16bc59ea1ddc9aa8a189736008941c">eager_page_split</a></div><div class="ttdeci">bool eager_page_split</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00196">x86.c:196</a></div></div>
<div class="ttc" id="ax86_8h_html_a1f8955b4b4c2ac234228a84811d2b1d8"><div class="ttname"><a href="x86_8h.html#a1f8955b4b4c2ac234228a84811d2b1d8">kvm_vcpu_mtrr_init</a></div><div class="ttdeci">void kvm_vcpu_mtrr_init(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="mtrr_8c_source.html#l00434">mtrr.c:434</a></div></div>
<div class="ttc" id="ax86_8h_html_a27679e0f68166573b056ce81832b1fd8"><div class="ttname"><a href="x86_8h.html#a27679e0f68166573b056ce81832b1fd8">vcpu_match_mmio_gen</a></div><div class="ttdeci">static bool vcpu_match_mmio_gen(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00236">x86.h:236</a></div></div>
<div class="ttc" id="ax86_8h_html_a2a00bb037b56dda33c39f38fbd2f9e24"><div class="ttname"><a href="x86_8h.html#a2a00bb037b56dda33c39f38fbd2f9e24">host_xss</a></div><div class="ttdeci">u64 host_xss</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00238">x86.c:238</a></div></div>
<div class="ttc" id="ax86_8h_html_a2a4bd8f3c9a644ab1bc76383672e8d4b"><div class="ttname"><a href="x86_8h.html#a2a4bd8f3c9a644ab1bc76383672e8d4b">kvm_event_needs_reinjection</a></div><div class="ttdeci">static bool kvm_event_needs_reinjection(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00127">x86.h:127</a></div></div>
<div class="ttc" id="ax86_8h_html_a2b95f238c68e317e64e57d06f2a698dd"><div class="ttname"><a href="x86_8h.html#a2b95f238c68e317e64e57d06f2a698dd">kvm_mtrr_set_msr</a></div><div class="ttdeci">int kvm_mtrr_set_msr(struct kvm_vcpu *vcpu, u32 msr, u64 data)</div><div class="ttdef"><b>Definition:</b> <a href="mtrr_8c_source.html#l00378">mtrr.c:378</a></div></div>
<div class="ttc" id="ax86_8h_html_a2cc991ad82a0546dd38fabaf3c096037"><div class="ttname"><a href="x86_8h.html#a2cc991ad82a0546dd38fabaf3c096037">vcpu_match_mmio_gva</a></div><div class="ttdeci">static bool vcpu_match_mmio_gva(struct kvm_vcpu *vcpu, unsigned long gva)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00255">x86.h:255</a></div></div>
<div class="ttc" id="ax86_8h_html_a2eb72fec495d01dbc2a51f5c1a69b75c"><div class="ttname"><a href="x86_8h.html#a2eb72fec495d01dbc2a51f5c1a69b75c">kvm_cstate_in_guest</a></div><div class="ttdeci">static bool kvm_cstate_in_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00424">x86.h:424</a></div></div>
<div class="ttc" id="ax86_8h_html_a31a89bf42745ce50d984bc0631945622"><div class="ttname"><a href="x86_8h.html#a31a89bf42745ce50d984bc0631945622">__grow_ple_window</a></div><div class="ttdeci">static unsigned int __grow_ple_window(unsigned int val, unsigned int base, unsigned int modifier, unsigned int max)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00060">x86.h:60</a></div></div>
<div class="ttc" id="ax86_8h_html_a32094f678d49270bf06d3c6fd08354b9"><div class="ttname"><a href="x86_8h.html#a32094f678d49270bf06d3c6fd08354b9">kvm_write_guest_virt_system</a></div><div class="ttdeci">int kvm_write_guest_virt_system(struct kvm_vcpu *vcpu, gva_t addr, void *val, unsigned int bytes, struct x86_exception *exception)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l07651">x86.c:7651</a></div></div>
<div class="ttc" id="ax86_8h_html_a36093b02c4959027f06b57d11d12ad84"><div class="ttname"><a href="x86_8h.html#a36093b02c4959027f06b57d11d12ad84">x86_exception_has_error_code</a></div><div class="ttdeci">static bool x86_exception_has_error_code(unsigned int vector)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00174">x86.h:174</a></div></div>
<div class="ttc" id="ax86_8h_html_a3a7c3d562176e798101d21bfaaae77a9"><div class="ttname"><a href="x86_8h.html#a3a7c3d562176e798101d21bfaaae77a9">kvm_get_wall_clock_epoch</a></div><div class="ttdeci">uint64_t kvm_get_wall_clock_epoch(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l03298">x86.c:3298</a></div></div>
<div class="ttc" id="ax86_8h_html_a3f6bd8b3f0bc1678451fd28682e7c3b1"><div class="ttname"><a href="x86_8h.html#a3f6bd8b3f0bc1678451fd28682e7c3b1">x86_emulate_instruction</a></div><div class="ttdeci">int x86_emulate_instruction(struct kvm_vcpu *vcpu, gpa_t cr2_or_gpa, int emulation_type, void *insn, int insn_len)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09074">x86.c:9074</a></div></div>
<div class="ttc" id="ax86_8h_html_a3fd078203f842566e7e4250b50fd3691"><div class="ttname"><a href="x86_8h.html#a3fd078203f842566e7e4250b50fd3691">kvm_after_interrupt</a></div><div class="ttdeci">static __always_inline void kvm_after_interrupt(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00446">x86.h:446</a></div></div>
<div class="ttc" id="ax86_8h_html_a401b9fcb1381d2fbfc488f8520093cee"><div class="ttname"><a href="x86_8h.html#a401b9fcb1381d2fbfc488f8520093cee">kvm_dr6_valid</a></div><div class="ttdeci">static bool kvm_dr6_valid(u64 data)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00469">x86.h:469</a></div></div>
<div class="ttc" id="ax86_8h_html_a441b0296c9e66d1e4f4c554d73a3093e"><div class="ttname"><a href="x86_8h.html#a441b0296c9e66d1e4f4c554d73a3093e">kvm_exception_is_soft</a></div><div class="ttdeci">static bool kvm_exception_is_soft(unsigned int nr)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00133">x86.h:133</a></div></div>
<div class="ttc" id="ax86_8h_html_a46aba02424c106f3cdb462fd774f54f4"><div class="ttname"><a href="x86_8h.html#a46aba02424c106f3cdb462fd774f54f4">is_pse</a></div><div class="ttdeci">static bool is_pse(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00193">x86.h:193</a></div></div>
<div class="ttc" id="ax86_8h_html_a47d88660a2a5f8ee22df1253604d1ed7"><div class="ttname"><a href="x86_8h.html#a47d88660a2a5f8ee22df1253604d1ed7">kvm_vector_hashing_enabled</a></div><div class="ttdeci">bool kvm_vector_hashing_enabled(void)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13520">x86.c:13520</a></div></div>
<div class="ttc" id="ax86_8h_html_a52623517d65c58a92d84f08015198d20"><div class="ttname"><a href="x86_8h.html#a52623517d65c58a92d84f08015198d20">kvm_check_nested_events</a></div><div class="ttdeci">int kvm_check_nested_events(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l10197">x86.c:10197</a></div></div>
<div class="ttc" id="ax86_8h_html_a5523aac5838b664e939f6560ae882d9e"><div class="ttname"><a href="x86_8h.html#a5523aac5838b664e939f6560ae882d9e">kvm_mpx_supported</a></div><div class="ttdeci">static bool kvm_mpx_supported(void)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00361">x86.h:361</a></div></div>
<div class="ttc" id="ax86_8h_html_a572e16f77096be80cec8ed2137ea74c2"><div class="ttname"><a href="x86_8h.html#a572e16f77096be80cec8ed2137ea74c2">kvm_pat_valid</a></div><div class="ttdeci">static bool kvm_pat_valid(u64 data)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00456">x86.h:456</a></div></div>
<div class="ttc" id="ax86_8h_html_a661bc84e256a87cbd929ffb7c1f61b2f"><div class="ttname"><a href="x86_8h.html#a661bc84e256a87cbd929ffb7c1f61b2f">mmu_is_nested</a></div><div class="ttdeci">static bool mmu_is_nested(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00183">x86.h:183</a></div></div>
<div class="ttc" id="ax86_8h_html_a68fadb354dc1d2785801f6c3d0c26eb7"><div class="ttname"><a href="x86_8h.html#a68fadb354dc1d2785801f6c3d0c26eb7">enable_pmu</a></div><div class="ttdeci">bool enable_pmu</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00192">x86.c:192</a></div></div>
<div class="ttc" id="ax86_8h_html_a6d86e9ee10c2cd72b82aef25cabafd82"><div class="ttname"><a href="x86_8h.html#a6d86e9ee10c2cd72b82aef25cabafd82">kvm_dr7_valid</a></div><div class="ttdeci">static bool kvm_dr7_valid(u64 data)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00464">x86.h:464</a></div></div>
<div class="ttc" id="ax86_8h_html_a7064cd8944dd550352cef83c72612045"><div class="ttname"><a href="x86_8h.html#a7064cd8944dd550352cef83c72612045">kvm_read_guest_virt</a></div><div class="ttdeci">int kvm_read_guest_virt(struct kvm_vcpu *vcpu, gva_t addr, void *val, unsigned int bytes, struct x86_exception *exception)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l07572">x86.c:7572</a></div></div>
<div class="ttc" id="ax86_8h_html_a716c9d1b6fc76fd454097cf39d640878"><div class="ttname"><a href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a></div><div class="ttdeci">static bool is_paging(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00198">x86.h:198</a></div></div>
<div class="ttc" id="ax86_8h_html_a759070a52abe7fcdf99cc62134289d72"><div class="ttname"><a href="x86_8h.html#a759070a52abe7fcdf99cc62134289d72">kvm_before_interrupt</a></div><div class="ttdeci">static __always_inline void kvm_before_interrupt(struct kvm_vcpu *vcpu, enum kvm_intr_type intr)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00440">x86.h:440</a></div></div>
<div class="ttc" id="ax86_8h_html_a777bea7283c857dc549e54eaa54fe12e"><div class="ttname"><a href="x86_8h.html#a777bea7283c857dc549e54eaa54fe12e">kvm_register_write</a></div><div class="ttdeci">static void kvm_register_write(struct kvm_vcpu *vcpu, int reg, unsigned long val)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00280">x86.h:280</a></div></div>
<div class="ttc" id="ax86_8h_html_a7ba75eeb6127223035e9f970dc4513bd"><div class="ttname"><a href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bd">kvm_intr_type</a></div><div class="ttdeci">kvm_intr_type</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00434">x86.h:434</a></div></div>
<div class="ttc" id="ax86_8h_html_a7ba75eeb6127223035e9f970dc4513bda0d87399b8a92905079d9404cfa46ca93"><div class="ttname"><a href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bda0d87399b8a92905079d9404cfa46ca93">KVM_HANDLING_IRQ</a></div><div class="ttdeci">@ KVM_HANDLING_IRQ</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00436">x86.h:436</a></div></div>
<div class="ttc" id="ax86_8h_html_a7ba75eeb6127223035e9f970dc4513bdaacdf5086536076396283ee0384fe725a"><div class="ttname"><a href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bdaacdf5086536076396283ee0384fe725a">KVM_HANDLING_NMI</a></div><div class="ttdeci">@ KVM_HANDLING_NMI</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00437">x86.h:437</a></div></div>
<div class="ttc" id="ax86_8h_html_a7ea7da65471d9a799946fa2fa4b35427"><div class="ttname"><a href="x86_8h.html#a7ea7da65471d9a799946fa2fa4b35427">kvm_sev_es_mmio_write</a></div><div class="ttdeci">int kvm_sev_es_mmio_write(struct kvm_vcpu *vcpu, gpa_t src, unsigned int bytes, void *dst)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13722">x86.c:13722</a></div></div>
<div class="ttc" id="ax86_8h_html_a81a164c2615ef1c0fc231d71e5ba9a53"><div class="ttname"><a href="x86_8h.html#a81a164c2615ef1c0fc231d71e5ba9a53">kvm_mtrr_get_msr</a></div><div class="ttdeci">int kvm_mtrr_get_msr(struct kvm_vcpu *vcpu, u32 msr, u64 *pdata)</div><div class="ttdef"><b>Definition:</b> <a href="mtrr_8c_source.html#l00397">mtrr.c:397</a></div></div>
<div class="ttc" id="ax86_8h_html_a8a31c0c01a5fe5dc33f7c5675ba4d376"><div class="ttname"><a href="x86_8h.html#a8a31c0c01a5fe5dc33f7c5675ba4d376">kvm_mwait_in_guest</a></div><div class="ttdeci">static bool kvm_mwait_in_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00409">x86.h:409</a></div></div>
<div class="ttc" id="ax86_8h_html_a8a37294ff599bdc5183d75ecdd61412a"><div class="ttname"><a href="x86_8h.html#a8a37294ff599bdc5183d75ecdd61412a">handle_fastpath_set_msr_irqoff</a></div><div class="ttdeci">fastpath_t handle_fastpath_set_msr_irqoff(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l02185">x86.c:2185</a></div></div>
<div class="ttc" id="ax86_8h_html_a8f21df7266cc84c2fc3559e1707f3bc9"><div class="ttname"><a href="x86_8h.html#a8f21df7266cc84c2fc3559e1707f3bc9">min_timer_period_us</a></div><div class="ttdeci">unsigned int min_timer_period_us</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00154">x86.c:154</a></div></div>
<div class="ttc" id="ax86_8h_html_a918fccc2a3b0a8c2fe80ed713b144e36"><div class="ttname"><a href="x86_8h.html#a918fccc2a3b0a8c2fe80ed713b144e36">kvm_handle_memory_failure</a></div><div class="ttdeci">int kvm_handle_memory_failure(struct kvm_vcpu *vcpu, int r, struct x86_exception *e)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13588">x86.c:13588</a></div></div>
<div class="ttc" id="ax86_8h_html_a92c398e9dacb06cf11f5f5364f3e1c36"><div class="ttname"><a href="x86_8h.html#a92c398e9dacb06cf11f5f5364f3e1c36">kvm_mtrr_get_guest_memory_type</a></div><div class="ttdeci">u8 kvm_mtrr_get_guest_memory_type(struct kvm_vcpu *vcpu, gfn_t gfn)</div><div class="ttdef"><b>Definition:</b> <a href="mtrr_8c_source.html#l00614">mtrr.c:614</a></div></div>
<div class="ttc" id="ax86_8h_html_a92e1a819da31f9776852acd897808e99"><div class="ttname"><a href="x86_8h.html#a92e1a819da31f9776852acd897808e99">kvm_deliver_exception_payload</a></div><div class="ttdeci">void kvm_deliver_exception_payload(struct kvm_vcpu *vcpu, struct kvm_queued_exception *ex)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00573">x86.c:573</a></div></div>
<div class="ttc" id="ax86_8h_html_a97b209e5c87a4c7b5850646ab9a1919c"><div class="ttname"><a href="x86_8h.html#a97b209e5c87a4c7b5850646ab9a1919c">kvm_handle_invpcid</a></div><div class="ttdeci">int kvm_handle_invpcid(struct kvm_vcpu *vcpu, unsigned long type, gva_t gva)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13612">x86.c:13612</a></div></div>
<div class="ttc" id="ax86_8h_html_a9dbf3d5bc7a0735443e0e21e00802160"><div class="ttname"><a href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160">kvm_clear_interrupt_queue</a></div><div class="ttdeci">static void kvm_clear_interrupt_queue(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00122">x86.h:122</a></div></div>
<div class="ttc" id="ax86_8h_html_a9f7e7cd8d352da04de3bf53cbb3b4e57"><div class="ttname"><a href="x86_8h.html#a9f7e7cd8d352da04de3bf53cbb3b4e57">kvm_register_read</a></div><div class="ttdeci">static unsigned long kvm_register_read(struct kvm_vcpu *vcpu, int reg)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00273">x86.h:273</a></div></div>
<div class="ttc" id="ax86_8h_html_aa3fd405bd522a08e3b5ccffbe8942a3c"><div class="ttname"><a href="x86_8h.html#aa3fd405bd522a08e3b5ccffbe8942a3c">kvm_get_filtered_xcr0</a></div><div class="ttdeci">static u64 kvm_get_filtered_xcr0(void)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00341">x86.h:341</a></div></div>
<div class="ttc" id="ax86_8h_html_aa539ceac11af1b634966fdd3d8c68cc5"><div class="ttname"><a href="x86_8h.html#aa539ceac11af1b634966fdd3d8c68cc5">kvm_machine_check</a></div><div class="ttdeci">static void kvm_machine_check(void)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00482">x86.h:482</a></div></div>
<div class="ttc" id="ax86_8h_html_aa8592542ba0f8944f9faf6d39f94a64c"><div class="ttname"><a href="x86_8h.html#aa8592542ba0f8944f9faf6d39f94a64c">kvm_spurious_fault</a></div><div class="ttdeci">void kvm_spurious_fault(void)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00513">x86.c:513</a></div></div>
<div class="ttc" id="ax86_8h_html_aa9890500a8e1721d97bbeb847c932d2b"><div class="ttname"><a href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b">kvm_is_exception_pending</a></div><div class="ttdeci">static bool kvm_is_exception_pending(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00100">x86.h:100</a></div></div>
<div class="ttc" id="ax86_8h_html_aaa166361b58ce8e326699e6cfe87e39a"><div class="ttname"><a href="x86_8h.html#aaa166361b58ce8e326699e6cfe87e39a">kvm_queue_interrupt</a></div><div class="ttdeci">static void kvm_queue_interrupt(struct kvm_vcpu *vcpu, u8 vector, bool soft)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00114">x86.h:114</a></div></div>
<div class="ttc" id="ax86_8h_html_aaa36cdb43bbf6ed6af3b10deed46a436"><div class="ttname"><a href="x86_8h.html#aaa36cdb43bbf6ed6af3b10deed46a436">is_pae_paging</a></div><div class="ttdeci">static bool is_pae_paging(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00203">x86.h:203</a></div></div>
<div class="ttc" id="ax86_8h_html_aad3ee550e50892e0e340061479bb284d"><div class="ttname"><a href="x86_8h.html#aad3ee550e50892e0e340061479bb284d">is_long_mode</a></div><div class="ttdeci">static bool is_long_mode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00143">x86.h:143</a></div></div>
<div class="ttc" id="ax86_8h_html_ab226ac0135835109146350d5db3d4031"><div class="ttname"><a href="x86_8h.html#ab226ac0135835109146350d5db3d4031">kvm_pause_in_guest</a></div><div class="ttdeci">static bool kvm_pause_in_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00419">x86.h:419</a></div></div>
<div class="ttc" id="ax86_8h_html_ab77d498df3e80dc4bdbbd7ef398f9f4e"><div class="ttname"><a href="x86_8h.html#ab77d498df3e80dc4bdbbd7ef398f9f4e">vcpu_cache_mmio_info</a></div><div class="ttdeci">static void vcpu_cache_mmio_info(struct kvm_vcpu *vcpu, gva_t gva, gfn_t gfn, unsigned access)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00218">x86.h:218</a></div></div>
<div class="ttc" id="ax86_8h_html_abbd5927434d63bff53c0c1f8185d46df"><div class="ttname"><a href="x86_8h.html#abbd5927434d63bff53c0c1f8185d46df">nsec_to_cycles</a></div><div class="ttdeci">static u64 nsec_to_cycles(struct kvm_vcpu *vcpu, u64 nsec)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00389">x86.h:389</a></div></div>
<div class="ttc" id="ax86_8h_html_abc2ffd79aced13c24f0c4143465d3d51"><div class="ttname"><a href="x86_8h.html#abc2ffd79aced13c24f0c4143465d3d51">is_pae</a></div><div class="ttdeci">static bool is_pae(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00188">x86.h:188</a></div></div>
<div class="ttc" id="ax86_8h_html_abd4913c1a5c4c66a089ccadc445cd9a2"><div class="ttname"><a href="x86_8h.html#abd4913c1a5c4c66a089ccadc445cd9a2">get_kvmclock_ns</a></div><div class="ttdeci">u64 get_kvmclock_ns(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l03105">x86.c:3105</a></div></div>
<div class="ttc" id="ax86_8h_html_abf05d82904db21951117acb30ddf9c37"><div class="ttname"><a href="x86_8h.html#abf05d82904db21951117acb30ddf9c37">kvm_vcpu_has_run</a></div><div class="ttdeci">static bool kvm_vcpu_has_run(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00095">x86.h:95</a></div></div>
<div class="ttc" id="ax86_8h_html_abf28742eaf88f469f322233afeb66b59"><div class="ttname"><a href="x86_8h.html#abf28742eaf88f469f322233afeb66b59">kvm_service_local_tlb_flush_requests</a></div><div class="ttdeci">void kvm_service_local_tlb_flush_requests(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l03617">x86.c:3617</a></div></div>
<div class="ttc" id="ax86_8h_html_ac2151c0af8d70153ba37f2a4b4064c0f"><div class="ttname"><a href="x86_8h.html#ac2151c0af8d70153ba37f2a4b4064c0f">pi_inject_timer</a></div><div class="ttdeci">int pi_inject_timer</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00188">x86.c:188</a></div></div>
<div class="ttc" id="ax86_8h_html_ac4b95013b15c215fb1fcfd251d2e006d"><div class="ttname"><a href="x86_8h.html#ac4b95013b15c215fb1fcfd251d2e006d">kvm_sev_es_string_io</a></div><div class="ttdeci">int kvm_sev_es_string_io(struct kvm_vcpu *vcpu, unsigned int size, unsigned int port, void *data, unsigned int count, int in)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13876">x86.c:13876</a></div></div>
<div class="ttc" id="ax86_8h_html_ac914d1912e8bdc3ffad1a2c561236a0b"><div class="ttname"><a href="x86_8h.html#ac914d1912e8bdc3ffad1a2c561236a0b">kvm_pr_unimpl_rdmsr</a></div><div class="ttdeci">static void kvm_pr_unimpl_rdmsr(struct kvm_vcpu *vcpu, u32 msr)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00383">x86.h:383</a></div></div>
<div class="ttc" id="ax86_8h_html_acc780a5b6599f782ea4d46c4cd5d9d1f"><div class="ttname"><a href="x86_8h.html#acc780a5b6599f782ea4d46c4cd5d9d1f">kvm_pr_unimpl_wrmsr</a></div><div class="ttdeci">static void kvm_pr_unimpl_wrmsr(struct kvm_vcpu *vcpu, u32 msr, u64 data)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00377">x86.h:377</a></div></div>
<div class="ttc" id="ax86_8h_html_acdc826b0cd2ce8b958a826c8faa306b4"><div class="ttname"><a href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4">kvm_clear_exception_queue</a></div><div class="ttdeci">static void kvm_clear_exception_queue(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00107">x86.h:107</a></div></div>
<div class="ttc" id="ax86_8h_html_ace4ed625ac4852e54db110fde28d3231"><div class="ttname"><a href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231">kvm_hlt_in_guest</a></div><div class="ttdeci">static bool kvm_hlt_in_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00414">x86.h:414</a></div></div>
<div class="ttc" id="ax86_8h_html_aceb096037b301784d562b0bac7334b70"><div class="ttname"><a href="x86_8h.html#aceb096037b301784d562b0bac7334b70">kvm_inject_realmode_interrupt</a></div><div class="ttdeci">void kvm_inject_realmode_interrupt(struct kvm_vcpu *vcpu, int irq, int inc_eip)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l08639">x86.c:8639</a></div></div>
<div class="ttc" id="ax86_8h_html_ad7b442570343aab34d0666cf4e6dcc20"><div class="ttname"><a href="x86_8h.html#ad7b442570343aab34d0666cf4e6dcc20">kvm_handling_nmi_from_guest</a></div><div class="ttdeci">static bool kvm_handling_nmi_from_guest(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00451">x86.h:451</a></div></div>
<div class="ttc" id="ax86_8h_html_ada9d5e605374059a5e34c42817ed5118"><div class="ttname"><a href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118">is_64_bit_mode</a></div><div class="ttdeci">static bool is_64_bit_mode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00152">x86.h:152</a></div></div>
<div class="ttc" id="ax86_8h_html_adc471c9bb1bd010f5c75e803cb312b53"><div class="ttname"><a href="x86_8h.html#adc471c9bb1bd010f5c75e803cb312b53">handle_ud</a></div><div class="ttdeci">int handle_ud(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l07669">x86.c:7669</a></div></div>
<div class="ttc" id="ax86_8h_html_adcdcd13c40eff36a60e0b4c9ef705b57"><div class="ttname"><a href="x86_8h.html#adcdcd13c40eff36a60e0b4c9ef705b57">kvm_sev_es_mmio_read</a></div><div class="ttdeci">int kvm_sev_es_mmio_read(struct kvm_vcpu *vcpu, gpa_t src, unsigned int bytes, void *dst)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13761">x86.c:13761</a></div></div>
<div class="ttc" id="ax86_8h_html_adec8392408e5b0e363872e91e83a90af"><div class="ttname"><a href="x86_8h.html#adec8392408e5b0e363872e91e83a90af">vcpu_match_mmio_gpa</a></div><div class="ttdeci">static bool vcpu_match_mmio_gpa(struct kvm_vcpu *vcpu, gpa_t gpa)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00264">x86.h:264</a></div></div>
<div class="ttc" id="ax86_8h_html_adf8330176a8805826ed4711a51ce93cf"><div class="ttname"><a href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf">kvm_check_has_quirk</a></div><div class="ttdeci">static bool kvm_check_has_quirk(struct kvm *kvm, u64 quirk)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00288">x86.h:288</a></div></div>
<div class="ttc" id="ax86_8h_html_ae123da10adfeadb5ddcdf423f0bba192"><div class="ttname"><a href="x86_8h.html#ae123da10adfeadb5ddcdf423f0bba192">__shrink_ple_window</a></div><div class="ttdeci">static unsigned int __shrink_ple_window(unsigned int val, unsigned int base, unsigned int modifier, unsigned int min)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00076">x86.h:76</a></div></div>
<div class="ttc" id="ax86_8h_html_ae210f9c6c59c663b1b256450b31ee60c"><div class="ttname"><a href="x86_8h.html#ae210f9c6c59c663b1b256450b31ee60c">kvm_notify_vmexit_enabled</a></div><div class="ttdeci">static bool kvm_notify_vmexit_enabled(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00429">x86.h:429</a></div></div>
<div class="ttc" id="ax86_8h_html_ae3f4e197f50db225e34de21d65633fcb"><div class="ttname"><a href="x86_8h.html#ae3f4e197f50db225e34de21d65633fcb">kvm_mtrr_check_gfn_range_consistency</a></div><div class="ttdeci">bool kvm_mtrr_check_gfn_range_consistency(struct kvm_vcpu *vcpu, gfn_t gfn, int page_num)</div><div class="ttdef"><b>Definition:</b> <a href="mtrr_8c_source.html#l00690">mtrr.c:690</a></div></div>
<div class="ttc" id="ax86_8h_html_ae7a4d6c3aa7c382164952fef430d61b8"><div class="ttname"><a href="x86_8h.html#ae7a4d6c3aa7c382164952fef430d61b8">host_xcr0</a></div><div class="ttdeci">u64 host_xcr0</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00317">x86.c:317</a></div></div>
<div class="ttc" id="ax86_8h_html_ae8fc6afc14ddddfd3c359c6bd495b3ff"><div class="ttname"><a href="x86_8h.html#ae8fc6afc14ddddfd3c359c6bd495b3ff">MMIO_GVA_ANY</a></div><div class="ttdeci">#define MMIO_GVA_ANY</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00245">x86.h:245</a></div></div>
<div class="ttc" id="ax86_8h_html_aea310c0e4f695bd1c6b5d96aa1dbd940"><div class="ttname"><a href="x86_8h.html#aea310c0e4f695bd1c6b5d96aa1dbd940">kvm_msr_allowed</a></div><div class="ttdeci">bool kvm_msr_allowed(struct kvm_vcpu *vcpu, u32 index, u32 type)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01796">x86.c:1796</a></div></div>
<div class="ttc" id="ax86_8h_html_aed9e7eaa275b4dc9692bbbfea052ca53"><div class="ttname"><a href="x86_8h.html#aed9e7eaa275b4dc9692bbbfea052ca53">kvm_load_guest_xsave_state</a></div><div class="ttdeci">void kvm_load_guest_xsave_state(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01018">x86.c:1018</a></div></div>
<div class="ttc" id="ax86_8h_html_af08b5422fd770e61736c80ba64d811f8"><div class="ttname"><a href="x86_8h.html#af08b5422fd770e61736c80ba64d811f8">__kvm_is_valid_cr4</a></div><div class="ttdeci">bool __kvm_is_valid_cr4(struct kvm_vcpu *vcpu, unsigned long cr4)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01132">x86.c:1132</a></div></div>
<div class="ttc" id="ax86_8h_html_af110270e09fabc54923cc5a9fbd6c543"><div class="ttname"><a href="x86_8h.html#af110270e09fabc54923cc5a9fbd6c543">is_64_bit_hypercall</a></div><div class="ttdeci">static bool is_64_bit_hypercall(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00164">x86.h:164</a></div></div>
<div class="ttc" id="ax86_8h_html_af360aa7bd1f33ab25089b12431f11773"><div class="ttname"><a href="x86_8h.html#af360aa7bd1f33ab25089b12431f11773">vcpu_virt_addr_bits</a></div><div class="ttdeci">static u8 vcpu_virt_addr_bits(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00208">x86.h:208</a></div></div>
<div class="ttc" id="ax86_8h_html_af50299f5f7fdc3db1348e9196bbb594c"><div class="ttname"><a href="x86_8h.html#af50299f5f7fdc3db1348e9196bbb594c">enable_vmware_backdoor</a></div><div class="ttdeci">bool enable_vmware_backdoor</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00176">x86.c:176</a></div></div>
<div class="ttc" id="ax86_8h_html_af666984080b5a37311441557672f29c1"><div class="ttname"><a href="x86_8h.html#af666984080b5a37311441557672f29c1">kvm_fixup_and_inject_pf_error</a></div><div class="ttdeci">void kvm_fixup_and_inject_pf_error(struct kvm_vcpu *vcpu, gva_t gva, u16 error_code)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13558">x86.c:13558</a></div></div>
<div class="ttc" id="ax86_8h_html_af9a5d53e18d888ed043578916e51cc55"><div class="ttname"><a href="x86_8h.html#af9a5d53e18d888ed043578916e51cc55">is_noncanonical_address</a></div><div class="ttdeci">static bool is_noncanonical_address(u64 la, struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00213">x86.h:213</a></div></div>
<div class="ttc" id="ax86_8h_html_aff7b722decad07b127dc964cb4ba5ebc"><div class="ttname"><a href="x86_8h.html#aff7b722decad07b127dc964cb4ba5ebc">kvm_load_host_xsave_state</a></div><div class="ttdeci">void kvm_load_host_xsave_state(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01041">x86.c:1041</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
