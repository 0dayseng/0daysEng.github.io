<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KVM: arch/x86/kvm/cpuid.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ea9599923402ca8ab47fc3e495999dea.html">arch</a></li><li class="navelem"><a class="el" href="dir_c21774f8bc9f0de15163573e5f5fa2b5.html">x86</a></li><li class="navelem"><a class="el" href="dir_fde450fd4b58e2560c53a1e73bfa4d6d.html">kvm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">cpuid.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/kvm_host.h&gt;</code><br />
<code>#include &quot;linux/lockdep.h&quot;</code><br />
<code>#include &lt;linux/export.h&gt;</code><br />
<code>#include &lt;linux/vmalloc.h&gt;</code><br />
<code>#include &lt;linux/uaccess.h&gt;</code><br />
<code>#include &lt;linux/sched/stat.h&gt;</code><br />
<code>#include &lt;asm/processor.h&gt;</code><br />
<code>#include &lt;asm/user.h&gt;</code><br />
<code>#include &lt;asm/fpu/xstate.h&gt;</code><br />
<code>#include &lt;asm/sgx.h&gt;</code><br />
<code>#include &lt;asm/cpuid.h&gt;</code><br />
<code>#include &quot;<a class="el" href="cpuid_8h_source.html">cpuid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="lapic_8h_source.html">lapic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mmu_8h_source.html">mmu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="trace_8h_source.html">trace.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pmu_8h_source.html">pmu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="xen_8h_source.html">xen.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for cpuid.c:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c__incl.png" border="0" usemap="#aarch_2x86_2kvm_2cpuid_8c" alt=""/></div>
<map name="aarch_2x86_2kvm_2cpuid_8c" id="aarch_2x86_2kvm_2cpuid_8c">
<area shape="rect" title=" " alt="" coords="1518,5,1680,32"/>
<area shape="rect" title=" " alt="" coords="629,379,764,405"/>
<area shape="rect" title=" " alt="" coords="1256,80,1377,107"/>
<area shape="rect" title=" " alt="" coords="1402,80,1514,107"/>
<area shape="rect" title=" " alt="" coords="1538,80,1660,107"/>
<area shape="rect" title=" " alt="" coords="1684,80,1807,107"/>
<area shape="rect" title=" " alt="" coords="1832,80,1969,107"/>
<area shape="rect" title=" " alt="" coords="730,229,858,256"/>
<area shape="rect" title=" " alt="" coords="1994,80,2087,107"/>
<area shape="rect" title=" " alt="" coords="1100,304,1232,331"/>
<area shape="rect" title=" " alt="" coords="2112,80,2201,107"/>
<area shape="rect" title=" " alt="" coords="2226,80,2327,107"/>
<area shape="rect" href="cpuid_8h.html" title=" " alt="" coords="500,155,570,181"/>
<area shape="rect" href="lapic_8h.html" title=" " alt="" coords="1114,80,1180,107"/>
<area shape="rect" href="mmu_8h.html" title=" " alt="" coords="385,80,453,107"/>
<area shape="rect" href="trace_8h.html" title=" " alt="" coords="2351,80,2418,107"/>
<area shape="rect" href="pmu_8h.html" title=" " alt="" coords="3085,80,3148,107"/>
<area shape="rect" href="xen_8h.html" title=" " alt="" coords="2788,80,2845,107"/>
<area shape="rect" href="x86_8h.html" title=" " alt="" coords="939,229,998,256"/>
<area shape="rect" href="reverse__cpuid_8h.html" title=" " alt="" coords="47,229,172,256"/>
<area shape="rect" title=" " alt="" coords="248,229,337,256"/>
<area shape="rect" title=" " alt="" coords="362,229,524,256"/>
<area shape="rect" href="governed__features_8h.html" title=" " alt="" coords="549,229,705,256"/>
<area shape="rect" title=" " alt="" coords="929,304,1024,331"/>
<area shape="rect" title=" " alt="" coords="789,304,905,331"/>
<area shape="rect" href="kvm__cache__regs_8h.html" title=" " alt="" coords="570,304,713,331"/>
<area shape="rect" href="kvm__emulate_8h.html" title=" " alt="" coords="1308,304,1432,331"/>
<area shape="rect" title=" " alt="" coords="1363,379,1494,405"/>
<area shape="rect" href="fpu_8h.html" title=" " alt="" coords="1284,379,1338,405"/>
<area shape="rect" title=" " alt="" coords="1256,453,1366,480"/>
<area shape="rect" title=" " alt="" coords="368,304,494,331"/>
<area shape="rect" title=" " alt="" coords="40,304,176,331"/>
<area shape="rect" title=" " alt="" coords="201,304,344,331"/>
<area shape="rect" title=" " alt="" coords="933,155,1036,181"/>
<area shape="rect" href="hyperv_8h.html" title=" " alt="" coords="1060,155,1138,181"/>
<area shape="rect" href="smm_8h.html" title=" " alt="" coords="1163,155,1230,181"/>
<area shape="rect" title=" " alt="" coords="1099,229,1232,256"/>
<area shape="rect" title=" " alt="" coords="1830,155,1966,181"/>
<area shape="rect" title=" " alt="" coords="1990,155,2085,181"/>
<area shape="rect" title=" " alt="" coords="2109,155,2204,181"/>
<area shape="rect" title=" " alt="" coords="2228,155,2370,181"/>
<area shape="rect" title=" " alt="" coords="2570,155,2711,181"/>
<area shape="rect" title=" " alt="" coords="2394,155,2545,181"/>
<area shape="rect" title=" " alt="" coords="3276,155,3392,181"/>
<area shape="rect" title=" " alt="" coords="2736,155,2897,181"/>
<area shape="rect" title=" " alt="" coords="2921,155,3072,181"/>
<area shape="rect" title=" " alt="" coords="3096,155,3251,181"/>
</map>
</div>
</div>
<p><a href="cpuid_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1f8c165bf4196327bc3abff648276d92"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a1f8c165bf4196327bc3abff648276d92">pr_fmt</a>(fmt)&#160;&#160;&#160;KBUILD_MODNAME &quot;: &quot; fmt</td></tr>
<tr class="separator:a1f8c165bf4196327bc3abff648276d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42257a545daf5b7933d6e8f96adc74f2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>&#160;&#160;&#160;<a class="el" href="reverse__cpuid_8h.html#a631fce724f1a93c2eb164f640a5d3876">feature_bit</a></td></tr>
<tr class="separator:a42257a545daf5b7933d6e8f96adc74f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a153ac3e954288b474182e1fb0c0f2a03"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a153ac3e954288b474182e1fb0c0f2a03">SF</a>(name)</td></tr>
<tr class="separator:a153ac3e954288b474182e1fb0c0f2a03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee2dec4877cb81413a6fa356c138464d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#aee2dec4877cb81413a6fa356c138464d">KVM_CPUID_INDEX_NOT_SIGNIFICANT</a>&#160;&#160;&#160;-1ull</td></tr>
<tr class="separator:aee2dec4877cb81413a6fa356c138464d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d7a5e68dae710cd6f79a0379588f773"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a4d7a5e68dae710cd6f79a0379588f773">CENTAUR_CPUID_SIGNATURE</a>&#160;&#160;&#160;0xC0000000</td></tr>
<tr class="separator:a4d7a5e68dae710cd6f79a0379588f773"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4f30a46a22584ebc11e3b738e3e5704d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a4f30a46a22584ebc11e3b738e3e5704d">EXPORT_SYMBOL_GPL</a> (kvm_cpu_caps)</td></tr>
<tr class="separator:a4f30a46a22584ebc11e3b738e3e5704d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad06d21707fd0abb109028612ea7514c"><td class="memItemLeft" align="right" valign="top">u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c">xstate_required_size</a> (u64 xstate_bv, bool compacted)</td></tr>
<tr class="separator:aad06d21707fd0abb109028612ea7514c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7220f0f9a6d0047aef7619e272fa9518"><td class="memItemLeft" align="right" valign="top">static struct kvm_cpuid_entry2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a> (struct kvm_cpuid_entry2 *entries, int nent, u32 function, u64 index)</td></tr>
<tr class="separator:a7220f0f9a6d0047aef7619e272fa9518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea420158d1fda2784dd4382763f258c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#afea420158d1fda2784dd4382763f258c">kvm_check_cpuid</a> (struct kvm_vcpu *vcpu, struct kvm_cpuid_entry2 *entries, int nent)</td></tr>
<tr class="separator:afea420158d1fda2784dd4382763f258c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f1b656d74e435fdceffcc2853a1c184"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a8f1b656d74e435fdceffcc2853a1c184">kvm_cpuid_check_equal</a> (struct kvm_vcpu *vcpu, struct kvm_cpuid_entry2 *e2, int nent)</td></tr>
<tr class="separator:a8f1b656d74e435fdceffcc2853a1c184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab855645f0756d3668a7a31696e95c218"><td class="memItemLeft" align="right" valign="top">static struct kvm_hypervisor_cpuid&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ab855645f0756d3668a7a31696e95c218">kvm_get_hypervisor_cpuid</a> (struct kvm_vcpu *vcpu, const char *sig)</td></tr>
<tr class="separator:ab855645f0756d3668a7a31696e95c218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57e37154fafc08d4400cac72d0a0b91d"><td class="memItemLeft" align="right" valign="top">static struct kvm_cpuid_entry2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d">__kvm_find_kvm_cpuid_features</a> (struct kvm_vcpu *vcpu, struct kvm_cpuid_entry2 *entries, int nent)</td></tr>
<tr class="separator:a57e37154fafc08d4400cac72d0a0b91d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d8deb4e45da8c580e5830057541fd8b"><td class="memItemLeft" align="right" valign="top">static struct kvm_cpuid_entry2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a6d8deb4e45da8c580e5830057541fd8b">kvm_find_kvm_cpuid_features</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a6d8deb4e45da8c580e5830057541fd8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30771fd4ef9230ee864f4d7ac9cf0514"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a30771fd4ef9230ee864f4d7ac9cf0514">kvm_update_pv_runtime</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a30771fd4ef9230ee864f4d7ac9cf0514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab09a1700616790a1bd47e46825c5012b"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ab09a1700616790a1bd47e46825c5012b">cpuid_get_supported_xcr0</a> (struct kvm_cpuid_entry2 *entries, int nent)</td></tr>
<tr class="separator:ab09a1700616790a1bd47e46825c5012b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2a2f99dbe3b8848b6ffc19effa6294"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294">__kvm_update_cpuid_runtime</a> (struct kvm_vcpu *vcpu, struct kvm_cpuid_entry2 *entries, int nent)</td></tr>
<tr class="separator:aba2a2f99dbe3b8848b6ffc19effa6294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a537512099e11c7ab0553aeae5e38d9ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea">kvm_update_cpuid_runtime</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a537512099e11c7ab0553aeae5e38d9ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3264fc51c50cf8358e311f181fc2ff2a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a3264fc51c50cf8358e311f181fc2ff2a">EXPORT_SYMBOL_GPL</a> (<a class="el" href="cpuid_8h.html#a537512099e11c7ab0553aeae5e38d9ea">kvm_update_cpuid_runtime</a>)</td></tr>
<tr class="separator:a3264fc51c50cf8358e311f181fc2ff2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb8299488a685437496d827e2ad9fb3"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a7eb8299488a685437496d827e2ad9fb3">kvm_cpuid_has_hyperv</a> (struct kvm_cpuid_entry2 *entries, int nent)</td></tr>
<tr class="separator:a7eb8299488a685437496d827e2ad9fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8f7489a3e05a9bcd5dfdae82c33d618"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618">kvm_vcpu_after_set_cpuid</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ae8f7489a3e05a9bcd5dfdae82c33d618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a881fc10bf62818799a56d9246f58b6cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a881fc10bf62818799a56d9246f58b6cf">cpuid_query_maxphyaddr</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a881fc10bf62818799a56d9246f58b6cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bf272b370f8a27bb68bf5bf9e5ae7d5"><td class="memItemLeft" align="right" valign="top">u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a8bf272b370f8a27bb68bf5bf9e5ae7d5">kvm_vcpu_reserved_gpa_bits_raw</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a8bf272b370f8a27bb68bf5bf9e5ae7d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ff60eac33c1bf95a3889674e34251ad"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad">kvm_set_cpuid</a> (struct kvm_vcpu *vcpu, struct kvm_cpuid_entry2 *e2, int nent)</td></tr>
<tr class="separator:a0ff60eac33c1bf95a3889674e34251ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5066ac0b188677d15925709568a91c9d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d">kvm_vcpu_ioctl_set_cpuid</a> (struct kvm_vcpu *vcpu, struct <a class="el" href="cpuid_8h.html#a91d770d0af7358b6cd24b7cbe2617d73">kvm_cpuid</a> *cpuid, struct kvm_cpuid_entry __user *entries)</td></tr>
<tr class="separator:a5066ac0b188677d15925709568a91c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4dde50a2939106abd2baf99683ac139"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139">kvm_vcpu_ioctl_set_cpuid2</a> (struct kvm_vcpu *vcpu, struct kvm_cpuid2 *cpuid, struct kvm_cpuid_entry2 __user *entries)</td></tr>
<tr class="separator:ad4dde50a2939106abd2baf99683ac139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a115858ba6090dccc1ac1605bc3acc1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a5a115858ba6090dccc1ac1605bc3acc1">kvm_vcpu_ioctl_get_cpuid2</a> (struct kvm_vcpu *vcpu, struct kvm_cpuid2 *cpuid, struct kvm_cpuid_entry2 __user *entries)</td></tr>
<tr class="separator:a5a115858ba6090dccc1ac1605bc3acc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97e11439f61d1a659b33cba3dc32abf"><td class="memItemLeft" align="right" valign="top">static __always_inline void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ac97e11439f61d1a659b33cba3dc32abf">__kvm_cpu_cap_mask</a> (unsigned int leaf)</td></tr>
<tr class="separator:ac97e11439f61d1a659b33cba3dc32abf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a080099f5d91326fd1c8c10429df2d042"><td class="memItemLeft" align="right" valign="top">static __always_inline void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042">kvm_cpu_cap_init_kvm_defined</a> (enum <a class="el" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19">kvm_only_cpuid_leafs</a> leaf, u32 mask)</td></tr>
<tr class="separator:a080099f5d91326fd1c8c10429df2d042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230e01b33626a01b4d37e8441e995938"><td class="memItemLeft" align="right" valign="top">static __always_inline void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a> (enum cpuid_leafs leaf, u32 mask)</td></tr>
<tr class="separator:a230e01b33626a01b4d37e8441e995938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b31e077b5a352bd48a541ad53e3162"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ac4b31e077b5a352bd48a541ad53e3162">kvm_set_cpu_caps</a> (void)</td></tr>
<tr class="separator:ac4b31e077b5a352bd48a541ad53e3162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7d754ebfabec24d8d1018620862aaa5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#af7d754ebfabec24d8d1018620862aaa5">EXPORT_SYMBOL_GPL</a> (<a class="el" href="cpuid_8h.html#ac4b31e077b5a352bd48a541ad53e3162">kvm_set_cpu_caps</a>)</td></tr>
<tr class="separator:af7d754ebfabec24d8d1018620862aaa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10c9a4330804572330fe3b5f7eac9b07"><td class="memItemLeft" align="right" valign="top">static struct kvm_cpuid_entry2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a10c9a4330804572330fe3b5f7eac9b07">get_next_cpuid</a> (struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *array)</td></tr>
<tr class="separator:a10c9a4330804572330fe3b5f7eac9b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8aeecb8bfdee1a641e314a3605e6146"><td class="memItemLeft" align="right" valign="top">static struct kvm_cpuid_entry2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a> (struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *array, u32 function, u32 index)</td></tr>
<tr class="separator:ae8aeecb8bfdee1a641e314a3605e6146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b781aedf96991bb95c97f5cf645a62"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a62b781aedf96991bb95c97f5cf645a62">__do_cpuid_func_emulated</a> (struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *array, u32 func)</td></tr>
<tr class="separator:a62b781aedf96991bb95c97f5cf645a62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac91da0391b283d7527a8b33206fe03dd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ac91da0391b283d7527a8b33206fe03dd">__do_cpuid_func</a> (struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *array, u32 function)</td></tr>
<tr class="separator:ac91da0391b283d7527a8b33206fe03dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a652f54573475d1818402ab58329c340c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a652f54573475d1818402ab58329c340c">do_cpuid_func</a> (struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *array, u32 func, unsigned int type)</td></tr>
<tr class="separator:a652f54573475d1818402ab58329c340c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e952716ba7f46eb64f00d8a59c2be8d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a1e952716ba7f46eb64f00d8a59c2be8d">get_cpuid_func</a> (struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *array, u32 func, unsigned int type)</td></tr>
<tr class="separator:a1e952716ba7f46eb64f00d8a59c2be8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebbe1f9459c214c3640d26457668476a"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#aebbe1f9459c214c3640d26457668476a">sanity_check_entries</a> (struct kvm_cpuid_entry2 __user *entries, __u32 num_entries, unsigned int ioctl_type)</td></tr>
<tr class="separator:aebbe1f9459c214c3640d26457668476a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac74b10a6f6a1e67ef54c48e55473ff07"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ac74b10a6f6a1e67ef54c48e55473ff07">kvm_dev_ioctl_get_cpuid</a> (struct kvm_cpuid2 *cpuid, struct kvm_cpuid_entry2 __user *entries, unsigned int type)</td></tr>
<tr class="separator:ac74b10a6f6a1e67ef54c48e55473ff07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a638557b30255883157acafa55a351d0d"><td class="memItemLeft" align="right" valign="top">struct kvm_cpuid_entry2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a638557b30255883157acafa55a351d0d">kvm_find_cpuid_entry_index</a> (struct kvm_vcpu *vcpu, u32 function, u32 index)</td></tr>
<tr class="separator:a638557b30255883157acafa55a351d0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4625f7100f5a0354515e221a360db31"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ab4625f7100f5a0354515e221a360db31">EXPORT_SYMBOL_GPL</a> (<a class="el" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d">kvm_find_cpuid_entry_index</a>)</td></tr>
<tr class="separator:ab4625f7100f5a0354515e221a360db31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae0475609eefc48bb151ef5a631670c0"><td class="memItemLeft" align="right" valign="top">struct kvm_cpuid_entry2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a> (struct kvm_vcpu *vcpu, u32 function)</td></tr>
<tr class="separator:aae0475609eefc48bb151ef5a631670c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a245fe292acf7a85765f6df4871df0859"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a245fe292acf7a85765f6df4871df0859">EXPORT_SYMBOL_GPL</a> (<a class="el" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>)</td></tr>
<tr class="separator:a245fe292acf7a85765f6df4871df0859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2fc42a3bfaa6a6d13a79e259561eba1"><td class="memItemLeft" align="right" valign="top">static struct kvm_cpuid_entry2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#ac2fc42a3bfaa6a6d13a79e259561eba1">get_out_of_range_cpuid_entry</a> (struct kvm_vcpu *vcpu, u32 *fn_ptr, u32 index)</td></tr>
<tr class="separator:ac2fc42a3bfaa6a6d13a79e259561eba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91d770d0af7358b6cd24b7cbe2617d73"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a91d770d0af7358b6cd24b7cbe2617d73">kvm_cpuid</a> (struct kvm_vcpu *vcpu, u32 *eax, u32 *ebx, u32 *ecx, u32 *edx, bool exact_only)</td></tr>
<tr class="separator:a91d770d0af7358b6cd24b7cbe2617d73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78ed9f073b7862e8d665aa3e27afb469"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a78ed9f073b7862e8d665aa3e27afb469">EXPORT_SYMBOL_GPL</a> (<a class="el" href="cpuid_8h.html#a91d770d0af7358b6cd24b7cbe2617d73">kvm_cpuid</a>)</td></tr>
<tr class="separator:a78ed9f073b7862e8d665aa3e27afb469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3650f2f078b9b3c62d58cd77e47ce3ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a3650f2f078b9b3c62d58cd77e47ce3ab">kvm_emulate_cpuid</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a3650f2f078b9b3c62d58cd77e47ce3ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb7794c6ff2248aea83d680956228fcc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#aeb7794c6ff2248aea83d680956228fcc">EXPORT_SYMBOL_GPL</a> (<a class="el" href="cpuid_8c.html#a3650f2f078b9b3c62d58cd77e47ce3ab">kvm_emulate_cpuid</a>)</td></tr>
<tr class="separator:aeb7794c6ff2248aea83d680956228fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a721f8d5b210e9625587f13b92870ba38"><td class="memItemLeft" align="right" valign="top">u32 kvm_cpu_caps[<a class="el" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a44bab4a663c0c6145b025d34e59c2556">NR_KVM_CPU_CAPS</a>]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cpuid_8c.html#a721f8d5b210e9625587f13b92870ba38">__read_mostly</a> = -1</td></tr>
<tr class="separator:a721f8d5b210e9625587f13b92870ba38"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4d7a5e68dae710cd6f79a0379588f773"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d7a5e68dae710cd6f79a0379588f773">&#9670;&nbsp;</a></span>CENTAUR_CPUID_SIGNATURE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CENTAUR_CPUID_SIGNATURE&#160;&#160;&#160;0xC0000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l01351">1351</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>

</div>
</div>
<a id="a42257a545daf5b7933d6e8f96adc74f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42257a545daf5b7933d6e8f96adc74f2">&#9670;&nbsp;</a></span>F</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define F&#160;&#160;&#160;<a class="el" href="reverse__cpuid_8h.html#a631fce724f1a93c2eb164f640a5d3876">feature_bit</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00064">64</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>

</div>
</div>
<a id="aee2dec4877cb81413a6fa356c138464d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee2dec4877cb81413a6fa356c138464d">&#9670;&nbsp;</a></span>KVM_CPUID_INDEX_NOT_SIGNIFICANT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KVM_CPUID_INDEX_NOT_SIGNIFICANT&#160;&#160;&#160;-1ull</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00080">80</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>

</div>
</div>
<a id="a1f8c165bf4196327bc3abff648276d92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f8c165bf4196327bc3abff648276d92">&#9670;&nbsp;</a></span>pr_fmt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define pr_fmt</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt</td><td>)</td>
          <td>&#160;&#160;&#160;KBUILD_MODNAME &quot;: &quot; fmt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00011">11</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>

</div>
</div>
<a id="a153ac3e954288b474182e1fb0c0f2a03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a153ac3e954288b474182e1fb0c0f2a03">&#9670;&nbsp;</a></span>SF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SF</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">name</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({                              \</div>
<div class="line">    BUILD_BUG_ON(X86_FEATURE_##name &gt;= MAX_CPU_FEATURES);   \</div>
<div class="line">    (boot_cpu_has(X86_FEATURE_##name) ? <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(name) : 0);   \</div>
<div class="line">})</div>
<div class="ttc" id="acpuid_8c_html_a42257a545daf5b7933d6e8f96adc74f2"><div class="ttname"><a href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a></div><div class="ttdeci">#define F</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00064">cpuid.c:64</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00067">67</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac91da0391b283d7527a8b33206fe03dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac91da0391b283d7527a8b33206fe03dd">&#9670;&nbsp;</a></span>__do_cpuid_func()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __do_cpuid_func </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00913">913</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;{</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *entry;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordtype">int</span> r, i, max_idx;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="comment">/* all calls to cpuid_count() should be made on the same cpu */</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    get_cpu();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    r = -E2BIG;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    entry = <a class="code" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a>(array, <span class="keyword">function</span>, 0);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">switch</span> (<span class="keyword">function</span>) {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment">/* Limited to the highest leaf implemented in KVM. */</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        entry-&gt;eax = min(entry-&gt;eax, 0x1fU);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_1_EDX);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_1_ECX);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">         * On ancient CPUs, function 2 entries are STATEFUL.  That is,</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">         * CPUID(function=2, index=0) may return different results each</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">         * time, with the least-significant byte in EAX enumerating the</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">         * number of times software should do CPUID(2, 0).</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">         * Modern CPUs, i.e. every CPU KVM has *ever* run on are less</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">         * idiotic.  Intel&#39;s SDM states that EAX &amp; 0xff &quot;will always</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">         * return 01H. Software should ignore this value and not</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">         * interpret it as an informational descriptor&quot;, while AMD&#39;s</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">         * APM states that CPUID(2) is reserved.</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">         * WARN if a frankenstein CPU that supports virtualization and</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">         * a stateful CPUID.0x2 is encountered.</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        WARN_ON_ONCE((entry-&gt;eax &amp; 0xff) &gt; 1);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">/* functions 4 and 0x8000001d have additional index. */</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">case</span> 0x8000001d:</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">         * Read entries until the cache type in the previous entry is</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">         * zero, i.e. indicates an invalid entry.</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="keywordflow">for</span> (i = 1; entry-&gt;eax &amp; 0x1f; ++i) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            entry = <a class="code" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a>(array, <span class="keyword">function</span>, i);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">case</span> 6: <span class="comment">/* Thermal management */</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        entry-&gt;eax = 0x4; <span class="comment">/* allow ARAT */</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        entry-&gt;ebx = 0;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        entry-&gt;ecx = 0;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        entry-&gt;edx = 0;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">/* function 7 has additional index. */</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordflow">case</span> 7:</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        max_idx = entry-&gt;eax = min(entry-&gt;eax, 2u);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_7_0_EBX);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_7_ECX);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_7_EDX);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="comment">/* KVM only supports up to 0x7.2, capped above via min(). */</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">if</span> (max_idx &gt;= 1) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            entry = <a class="code" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a>(array, <span class="keyword">function</span>, 1);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_7_1_EAX);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, <a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a085e27ce32fc47622c4949f04d40e78f">CPUID_7_1_EDX</a>);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            entry-&gt;ebx = 0;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            entry-&gt;ecx = 0;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordflow">if</span> (max_idx &gt;= 2) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            entry = <a class="code" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a>(array, <span class="keyword">function</span>, 2);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, <a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a0ec53c71d8d1cd446493085c596e5ab3">CPUID_7_2_EDX</a>);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            entry-&gt;ecx = 0;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            entry-&gt;ebx = 0;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            entry-&gt;eax = 0;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">case</span> 0xa: { <span class="comment">/* Architectural Performance Monitoring */</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keyword">union </span>cpuid10_eax eax;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keyword">union </span>cpuid10_edx edx;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a868c360a5f6eb018cc1d24ecd766d971">enable_pmu</a> || !static_cpu_has(X86_FEATURE_ARCH_PERFMON)) {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        eax.split.version_id = <a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.version;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        eax.split.num_counters = <a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.num_counters_gp;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        eax.split.bit_width = <a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.bit_width_gp;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        eax.split.mask_length = <a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.events_mask_len;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        edx.split.num_counters_fixed = <a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.num_counters_fixed;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        edx.split.bit_width_fixed = <a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.bit_width_fixed;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.version)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            edx.split.anythread_deprecated = 1;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        edx.split.reserved1 = 0;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        edx.split.reserved2 = 0;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        entry-&gt;eax = eax.full;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        entry-&gt;ebx = <a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.events_mask;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        entry-&gt;ecx = 0;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        entry-&gt;edx = edx.full;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">case</span> 0x1f:</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">case</span> 0xb:</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">         * No topology; a valid topology is indicated by the presence</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">         * of subleaf 1.</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = 0;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">case</span> 0xd: {</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        u64 permitted_xcr0 = <a class="code" href="x86_8h.html#aa3fd405bd522a08e3b5ccffbe8942a3c">kvm_get_filtered_xcr0</a>();</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        u64 permitted_xss = <a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#a6f09eefaf33e60131be48a78f993b353">supported_xss</a>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        entry-&gt;eax &amp;= permitted_xcr0;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        entry-&gt;ebx = <a class="code" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c">xstate_required_size</a>(permitted_xcr0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        entry-&gt;ecx = entry-&gt;ebx;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        entry-&gt;edx &amp;= permitted_xcr0 &gt;&gt; 32;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="keywordflow">if</span> (!permitted_xcr0)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        entry = <a class="code" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a>(array, <span class="keyword">function</span>, 1);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_D_1_EAX);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordflow">if</span> (entry-&gt;eax &amp; (<a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XSAVES)|<a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XSAVEC)))</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            entry-&gt;ebx = <a class="code" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c">xstate_required_size</a>(permitted_xcr0 | permitted_xss,</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                              <span class="keyword">true</span>);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            WARN_ON_ONCE(permitted_xss != 0);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            entry-&gt;ebx = 0;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        entry-&gt;ecx &amp;= permitted_xss;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        entry-&gt;edx &amp;= permitted_xss &gt;&gt; 32;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="keywordflow">for</span> (i = 2; i &lt; 64; ++i) {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            <span class="keywordtype">bool</span> s_state;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <span class="keywordflow">if</span> (permitted_xcr0 &amp; BIT_ULL(i))</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                s_state = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (permitted_xss &amp; BIT_ULL(i))</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                s_state = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            entry = <a class="code" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a>(array, <span class="keyword">function</span>, i);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">             * The supported check above should have filtered out</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">             * invalid sub-leafs.  Only valid sub-leafs should</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">             * reach this point, and they should have a non-zero</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">             * save state size.  Furthermore, check whether the</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">             * processor agrees with permitted_xcr0/permitted_xss</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">             * on whether this is an XCR0- or IA32_XSS-managed area.</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            <span class="keywordflow">if</span> (WARN_ON_ONCE(!entry-&gt;eax || (entry-&gt;ecx &amp; 0x1) != s_state)) {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                --array-&gt;<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a>;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_XFD))</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                entry-&gt;ecx &amp;= ~BIT_ULL(2);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            entry-&gt;edx = 0;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">case</span> 0x12:</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="comment">/* Intel SGX */</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_SGX)) {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">         * Index 0: Sub-features, MISCSELECT (a.k.a extended features)</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">         * and max enclave sizes.   The SGX sub-features and MISCSELECT</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">         * are restricted by kernel and KVM capabilities (like most</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">         * feature flags), while enclave size is unrestricted.</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, <a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a776cec6b7fe0f8a28d7c6077a06069b8">CPUID_12_EAX</a>);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        entry-&gt;ebx &amp;= SGX_MISC_EXINFO;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        entry = <a class="code" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a>(array, <span class="keyword">function</span>, 1);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">         * Index 1: SECS.ATTRIBUTES.  ATTRIBUTES are restricted a la</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">         * feature flags.  Advertise all supported flags, including</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">         * privileged attributes that require explicit opt-in from</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">         * userspace.  ATTRIBUTES.XFRM is not adjusted as userspace is</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">         * expected to derive it from supported XCR0.</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        entry-&gt;eax &amp;= SGX_ATTR_PRIV_MASK | SGX_ATTR_UNPRIV_MASK;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        entry-&gt;ebx &amp;= 0;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="comment">/* Intel PT */</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordflow">case</span> 0x14:</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_INTEL_PT)) {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keywordflow">for</span> (i = 1, max_idx = entry-&gt;eax; i &lt;= max_idx; ++i) {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a>(array, <span class="keyword">function</span>, i))</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">/* Intel AMX TILE */</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">case</span> 0x1d:</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_AMX_TILE)) {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        }</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <span class="keywordflow">for</span> (i = 1, max_idx = entry-&gt;eax; i &lt;= max_idx; ++i) {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a>(array, <span class="keyword">function</span>, i))</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordflow">case</span> 0x1e: <span class="comment">/* TMUL information */</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_AMX_TILE)) {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordflow">case</span> KVM_CPUID_SIGNATURE: {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keyword">const</span> u32 *sigptr = (<span class="keyword">const</span> u32 *)KVM_SIGNATURE;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        entry-&gt;eax = KVM_CPUID_FEATURES;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        entry-&gt;ebx = sigptr[0];</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        entry-&gt;ecx = sigptr[1];</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        entry-&gt;edx = sigptr[2];</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">case</span> KVM_CPUID_FEATURES:</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        entry-&gt;eax = (1 &lt;&lt; KVM_FEATURE_CLOCKSOURCE) |</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_NOP_IO_DELAY) |</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_CLOCKSOURCE2) |</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_ASYNC_PF) |</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_PV_EOI) |</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_CLOCKSOURCE_STABLE_BIT) |</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_PV_UNHALT) |</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_PV_TLB_FLUSH) |</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_ASYNC_PF_VMEXIT) |</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_PV_SEND_IPI) |</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_POLL_CONTROL) |</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_PV_SCHED_YIELD) |</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                 (1 &lt;&lt; KVM_FEATURE_ASYNC_PF_INT);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="keywordflow">if</span> (sched_info_on())</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            entry-&gt;eax |= (1 &lt;&lt; KVM_FEATURE_STEAL_TIME);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        entry-&gt;ebx = 0;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        entry-&gt;ecx = 0;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        entry-&gt;edx = 0;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">case</span> 0x80000000:</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        entry-&gt;eax = min(entry-&gt;eax, 0x80000022);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">         * Serializing LFENCE is reported in a multitude of ways, and</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">         * NullSegClearsBase is not reported in CPUID on Zen2; help</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">         * userspace by providing the CPUID leaf ourselves.</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">         * However, only do it if the host has CPUID leaf 0x8000001d.</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">         * QEMU thinks that it can query the host blindly for that</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">         * CPUID leaf if KVM reports that it supports 0x8000001d or</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">         * above.  The processor merrily returns values from the</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">         * highest Intel leaf which QEMU tries to use as the guest&#39;s</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">         * 0x8000001d.  Even worse, this can result in an infinite</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">         * loop if said highest leaf has no subleaves indexed by ECX.</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">if</span> (entry-&gt;eax &gt;= 0x8000001d &amp;&amp;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            (static_cpu_has(X86_FEATURE_LFENCE_RDTSC)</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;             || !static_cpu_has_bug(X86_BUG_NULL_SEG)))</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            entry-&gt;eax = max(entry-&gt;eax, 0x80000021);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">case</span> 0x80000001:</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        entry-&gt;ebx &amp;= ~GENMASK(27, 16);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_8000_0001_EDX);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_8000_0001_ECX);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">case</span> 0x80000005:</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <span class="comment">/*  Pass host L1 cache and TLB info. */</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">case</span> 0x80000006:</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="comment">/* Drop reserved bits, pass host L2 cache and TLB info. */</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        entry-&gt;edx &amp;= ~GENMASK(17, 16);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">case</span> 0x80000007: <span class="comment">/* Advanced power management */</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, <a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19aa1a99a294e8e48b11776432dd58965f1">CPUID_8000_0007_EDX</a>);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="comment">/* mask against host */</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        entry-&gt;edx &amp;= boot_cpu_data.x86_power;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = 0;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">case</span> 0x80000008: {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordtype">unsigned</span> g_phys_as = (entry-&gt;eax &gt;&gt; 16) &amp; 0xff;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keywordtype">unsigned</span> virt_as = max((entry-&gt;eax &gt;&gt; 8) &amp; 0xff, 48U);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="keywordtype">unsigned</span> phys_as = entry-&gt;eax &amp; 0xff;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">         * If TDP (NPT) is disabled use the adjusted host MAXPHYADDR as</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">         * the guest operates in the same PA space as the host, i.e.</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">         * reductions in MAXPHYADDR for memory encryption affect shadow</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">         * paging, too.</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">         * If TDP is enabled but an explicit guest MAXPHYADDR is not</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">         * provided, use the raw bare metal MAXPHYADDR as reductions to</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment">         * the HPAs do not affect GPAs.</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="mmu_8c.html#ab96cbfdb088c3659bfd6117823de8e30">tdp_enabled</a>)</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            g_phys_as = boot_cpu_data.x86_phys_bits;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!g_phys_as)</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            g_phys_as = phys_as;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        entry-&gt;eax = g_phys_as | (virt_as &lt;&lt; 8);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        entry-&gt;ecx &amp;= ~(GENMASK(31, 16) | GENMASK(11, 8));</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        entry-&gt;edx = 0;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_8000_0008_EBX);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">case</span> 0x8000000A:</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_SVM)) {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        }</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        entry-&gt;eax = 1; <span class="comment">/* SVM revision 1 */</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        entry-&gt;ebx = 8; <span class="comment">/* Lets support 8 ASIDs in case we add proper</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">                   ASID emulation to nested SVM */</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        entry-&gt;ecx = 0; <span class="comment">/* Reserved */</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_8000_000A_EDX);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="keywordflow">case</span> 0x80000019:</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordflow">case</span> 0x8000001a:</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        entry-&gt;eax &amp;= GENMASK(2, 0);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordflow">case</span> 0x8000001e:</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="comment">/* Do not return host topology information.  */</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = 0;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        entry-&gt;edx = 0; <span class="comment">/* reserved */</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keywordflow">case</span> 0x8000001F:</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_SEV)) {</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_8000_001F_EAX);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <span class="comment">/* Clear NumVMPL since KVM does not support VMPL.  */</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            entry-&gt;ebx &amp;= ~GENMASK(31, 12);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">             * Enumerate &#39;0&#39; for &quot;PA bits reduction&quot;, the adjusted</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">             * MAXPHYADDR is enumerated directly (see 0x80000008).</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            entry-&gt;ebx &amp;= ~GENMASK(11, 6);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordflow">case</span> 0x80000020:</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">case</span> 0x80000021:</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_8000_0021_EAX);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="comment">/* AMD Extended Performance Monitoring and Debug */</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">case</span> 0x80000022: {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <span class="keyword">union </span>cpuid_0x80000022_ebx ebx;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a868c360a5f6eb018cc1d24ecd766d971">enable_pmu</a> || !<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_PERFMON_V2)) {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;            entry-&gt;eax = entry-&gt;ebx;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        }</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, <a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a44639d9f82ec04b6276403d72b2ac0d9">CPUID_8000_0022_EAX</a>);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160; </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_PERFMON_V2))</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            ebx.split.num_core_pmc = <a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.num_counters_gp;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_PERFCTR_CORE))</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            ebx.split.num_core_pmc = AMD64_NUM_COUNTERS_CORE;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            ebx.split.num_core_pmc = AMD64_NUM_COUNTERS;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160; </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        entry-&gt;ebx = ebx.full;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">/*Add support for Centaur&#39;s CPUID instruction*/</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">case</span> 0xC0000000:</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="comment">/*Just support up to 0xC0000004 now*/</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        entry-&gt;eax = min(entry-&gt;eax, 0xC0000004);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordflow">case</span> 0xC0000001:</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <a class="code" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a>(entry, CPUID_C000_0001_EDX);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordflow">case</span> 3: <span class="comment">/* Processor serial number */</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">case</span> 5: <span class="comment">/* MONITOR/MWAIT */</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordflow">case</span> 0xC0000002:</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">case</span> 0xC0000003:</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">case</span> 0xC0000004:</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        entry-&gt;eax = entry-&gt;ebx = entry-&gt;ecx = entry-&gt;edx = 0;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    r = 0;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;out:</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    put_cpu();</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_aad06d21707fd0abb109028612ea7514c"><div class="ttname"><a href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c">xstate_required_size</a></div><div class="ttdeci">u32 xstate_required_size(u64 xstate_bv, bool compacted)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00039">cpuid.c:39</a></div></div>
<div class="ttc" id="acpuid_8c_html_ae8aeecb8bfdee1a641e314a3605e6146"><div class="ttname"><a href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146">do_host_cpuid</a></div><div class="ttdeci">static struct kvm_cpuid_entry2 * do_host_cpuid(struct kvm_cpuid_array *array, u32 function, u32 index)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00835">cpuid.c:835</a></div></div>
<div class="ttc" id="acpuid_8h_html_a4a2881bd1ba1c3c4b2fb5f3b13ac12de"><div class="ttname"><a href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a></div><div class="ttdeci">static __always_inline bool kvm_cpu_cap_has(unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00221">cpuid.h:221</a></div></div>
<div class="ttc" id="acpuid_8h_html_aac49cebef4a1bdd0996486028e64bbbd"><div class="ttname"><a href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd">cpuid_entry_override</a></div><div class="ttdeci">static __always_inline void cpuid_entry_override(struct kvm_cpuid_entry2 *entry, unsigned int leaf)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00061">cpuid.h:61</a></div></div>
<div class="ttc" id="ammu_8c_html_ab96cbfdb088c3659bfd6117823de8e30"><div class="ttname"><a href="mmu_8c.html#ab96cbfdb088c3659bfd6117823de8e30">tdp_enabled</a></div><div class="ttdeci">bool tdp_enabled</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8c_source.html#l00106">mmu.c:106</a></div></div>
<div class="ttc" id="apmu_8c_html_a7cb675dbab35a9d80853027c23e33c1f"><div class="ttname"><a href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a></div><div class="ttdeci">struct x86_pmu_capability __read_mostly kvm_pmu_cap</div><div class="ttdef"><b>Definition:</b> <a href="pmu_8c_source.html#l00001">pmu.c:29</a></div></div>
<div class="ttc" id="areverse__cpuid_8h_html_a33165a02505466212d27a517cc779d19a085e27ce32fc47622c4949f04d40e78f"><div class="ttname"><a href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a085e27ce32fc47622c4949f04d40e78f">CPUID_7_1_EDX</a></div><div class="ttdeci">@ CPUID_7_1_EDX</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00016">reverse_cpuid.h:16</a></div></div>
<div class="ttc" id="areverse__cpuid_8h_html_a33165a02505466212d27a517cc779d19a0ec53c71d8d1cd446493085c596e5ab3"><div class="ttname"><a href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a0ec53c71d8d1cd446493085c596e5ab3">CPUID_7_2_EDX</a></div><div class="ttdeci">@ CPUID_7_2_EDX</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00019">reverse_cpuid.h:19</a></div></div>
<div class="ttc" id="areverse__cpuid_8h_html_a33165a02505466212d27a517cc779d19a44639d9f82ec04b6276403d72b2ac0d9"><div class="ttname"><a href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a44639d9f82ec04b6276403d72b2ac0d9">CPUID_8000_0022_EAX</a></div><div class="ttdeci">@ CPUID_8000_0022_EAX</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00018">reverse_cpuid.h:18</a></div></div>
<div class="ttc" id="areverse__cpuid_8h_html_a33165a02505466212d27a517cc779d19a776cec6b7fe0f8a28d7c6077a06069b8"><div class="ttname"><a href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a776cec6b7fe0f8a28d7c6077a06069b8">CPUID_12_EAX</a></div><div class="ttdeci">@ CPUID_12_EAX</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00015">reverse_cpuid.h:15</a></div></div>
<div class="ttc" id="areverse__cpuid_8h_html_a33165a02505466212d27a517cc779d19aa1a99a294e8e48b11776432dd58965f1"><div class="ttname"><a href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19aa1a99a294e8e48b11776432dd58965f1">CPUID_8000_0007_EDX</a></div><div class="ttdeci">@ CPUID_8000_0007_EDX</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00017">reverse_cpuid.h:17</a></div></div>
<div class="ttc" id="astructkvm__caps_html"><div class="ttname"><a href="structkvm__caps.html">kvm_caps</a></div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00012">x86.h:12</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a6f09eefaf33e60131be48a78f993b353"><div class="ttname"><a href="structkvm__caps.html#a6f09eefaf33e60131be48a78f993b353">kvm_caps::supported_xss</a></div><div class="ttdeci">u64 supported_xss</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00030">x86.h:30</a></div></div>
<div class="ttc" id="astructkvm__cpuid__array_html_aa4a14410d9d895ae5b563366f4ed8450"><div class="ttname"><a href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">kvm_cpuid_array::nent</a></div><div class="ttdeci">int nent</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00824">cpuid.c:824</a></div></div>
<div class="ttc" id="ax86_8c_html_a868c360a5f6eb018cc1d24ecd766d971"><div class="ttname"><a href="x86_8c.html#a868c360a5f6eb018cc1d24ecd766d971">enable_pmu</a></div><div class="ttdeci">bool __read_mostly enable_pmu</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00192">x86.c:192</a></div></div>
<div class="ttc" id="ax86_8h_html_aa3fd405bd522a08e3b5ccffbe8942a3c"><div class="ttname"><a href="x86_8h.html#aa3fd405bd522a08e3b5ccffbe8942a3c">kvm_get_filtered_xcr0</a></div><div class="ttdeci">static u64 kvm_get_filtered_xcr0(void)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00341">x86.h:341</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ac91da0391b283d7527a8b33206fe03dd_cgraph.png" border="0" usemap="#acpuid_8c_ac91da0391b283d7527a8b33206fe03dd_cgraph" alt=""/></div>
<map name="acpuid_8c_ac91da0391b283d7527a8b33206fe03dd_cgraph" id="acpuid_8c_ac91da0391b283d7527a8b33206fe03dd_cgraph">
<area shape="rect" title=" " alt="" coords="5,208,135,235"/>
<area shape="rect" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd" title=" " alt="" coords="187,157,345,184"/>
<area shape="rect" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146" title=" " alt="" coords="209,208,323,235"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="195,95,337,121"/>
<area shape="rect" href="x86_8h.html#aa3fd405bd522a08e3b5ccffbe8942a3c" title=" " alt="" coords="183,259,349,285"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="187,309,345,336"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="397,157,552,184"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="600,208,768,235"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="613,157,755,184"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="838,107,953,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="816,56,975,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1023,56,1171,83"/>
<area shape="rect" href="cpuid_8c.html#a10c9a4330804572330fe3b5f7eac9b07" title=" " alt="" coords="414,208,535,235"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="405,69,544,96"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="631,5,737,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ac91da0391b283d7527a8b33206fe03dd_icgraph.png" border="0" usemap="#acpuid_8c_ac91da0391b283d7527a8b33206fe03dd_icgraph" alt=""/></div>
<map name="acpuid_8c_ac91da0391b283d7527a8b33206fe03dd_icgraph" id="acpuid_8c_ac91da0391b283d7527a8b33206fe03dd_icgraph">
<area shape="rect" title=" " alt="" coords="771,5,900,32"/>
<area shape="rect" href="cpuid_8c.html#a652f54573475d1818402ab58329c340c" title=" " alt="" coords="608,5,723,32"/>
<area shape="rect" href="cpuid_8c.html#a1e952716ba7f46eb64f00d8a59c2be8d" title=" " alt="" coords="440,5,560,32"/>
<area shape="rect" href="cpuid_8c.html#ac74b10a6f6a1e67ef54c48e55473ff07" title=" " alt="" coords="205,5,392,32"/>
<area shape="rect" href="x86_8c.html#a05ad3b4bc56bfbca86cf49699ca69f5f" title=" " alt="" coords="5,5,157,32"/>
</map>
</div>

</div>
</div>
<a id="a62b781aedf96991bb95c97f5cf645a62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62b781aedf96991bb95c97f5cf645a62">&#9670;&nbsp;</a></span>__do_cpuid_func_emulated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __do_cpuid_func_emulated </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00878">878</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;{</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *entry;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">if</span> (array-&gt;<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a> &gt;= array-&gt;<a class="code" href="structkvm__cpuid__array.html#a8f5df87c0238185d71b87449e9a0056a">maxnent</a>)</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">return</span> -E2BIG;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    entry = &amp;array-&gt;<a class="code" href="structkvm__cpuid__array.html#a0f69cb1cf1ca8b9e6dc3d05e9be947f2">entries</a>[array-&gt;<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a>];</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    entry-&gt;function = func;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    entry-&gt;index = 0;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    entry-&gt;flags = 0;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">switch</span> (func) {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        entry-&gt;eax = 7;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        ++array-&gt;<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a>;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        entry-&gt;ecx = <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MOVBE);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        ++array-&gt;<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">case</span> 7:</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        entry-&gt;flags |= KVM_CPUID_FLAG_SIGNIFCANT_INDEX;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        entry-&gt;eax = 0;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_RDTSCP))</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            entry-&gt;ecx = <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(RDPID);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        ++array-&gt;<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;}</div>
<div class="ttc" id="astructkvm__cpuid__array_html_a0f69cb1cf1ca8b9e6dc3d05e9be947f2"><div class="ttname"><a href="structkvm__cpuid__array.html#a0f69cb1cf1ca8b9e6dc3d05e9be947f2">kvm_cpuid_array::entries</a></div><div class="ttdeci">struct kvm_cpuid_entry2 * entries</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00822">cpuid.c:822</a></div></div>
<div class="ttc" id="astructkvm__cpuid__array_html_a8f5df87c0238185d71b87449e9a0056a"><div class="ttname"><a href="structkvm__cpuid__array.html#a8f5df87c0238185d71b87449e9a0056a">kvm_cpuid_array::maxnent</a></div><div class="ttdeci">int maxnent</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00823">cpuid.c:823</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a62b781aedf96991bb95c97f5cf645a62_cgraph.png" border="0" usemap="#acpuid_8c_a62b781aedf96991bb95c97f5cf645a62_cgraph" alt=""/></div>
<map name="acpuid_8c_a62b781aedf96991bb95c97f5cf645a62_cgraph" id="acpuid_8c_a62b781aedf96991bb95c97f5cf645a62_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,204,83"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="252,56,393,83"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="441,56,580,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="632,56,739,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="791,93,949,120"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="628,5,743,32"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="796,31,944,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a62b781aedf96991bb95c97f5cf645a62_icgraph.png" border="0" usemap="#acpuid_8c_a62b781aedf96991bb95c97f5cf645a62_icgraph" alt=""/></div>
<map name="acpuid_8c_a62b781aedf96991bb95c97f5cf645a62_icgraph" id="acpuid_8c_a62b781aedf96991bb95c97f5cf645a62_icgraph">
<area shape="rect" title=" " alt="" coords="771,5,969,32"/>
<area shape="rect" href="cpuid_8c.html#a652f54573475d1818402ab58329c340c" title=" " alt="" coords="608,5,723,32"/>
<area shape="rect" href="cpuid_8c.html#a1e952716ba7f46eb64f00d8a59c2be8d" title=" " alt="" coords="440,5,560,32"/>
<area shape="rect" href="cpuid_8c.html#ac74b10a6f6a1e67ef54c48e55473ff07" title=" " alt="" coords="205,5,392,32"/>
<area shape="rect" href="x86_8c.html#a05ad3b4bc56bfbca86cf49699ca69f5f" title=" " alt="" coords="5,5,157,32"/>
</map>
</div>

</div>
</div>
<a id="ac97e11439f61d1a659b33cba3dc32abf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac97e11439f61d1a659b33cba3dc32abf">&#9670;&nbsp;</a></span>__kvm_cpu_cap_mask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __always_inline void __kvm_cpu_cap_mask </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>leaf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00551">551</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;{</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcpuid__reg.html">cpuid_reg</a> cpuid = <a class="code" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892">x86_feature_cpuid</a>(leaf * 32);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 entry;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700">reverse_cpuid_check</a>(leaf);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    cpuid_count(cpuid.<a class="code" href="structcpuid__reg.html#a51b21a0bcadd2d6062b6690ad07e16bc">function</a>, cpuid.<a class="code" href="structcpuid__reg.html#a045599ded48c2883e6d6766a12f79cd3">index</a>,</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            &amp;entry.eax, &amp;entry.ebx, &amp;entry.ecx, &amp;entry.edx);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    kvm_cpu_caps[leaf] &amp;= *<a class="code" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680">__cpuid_entry_get_reg</a>(&amp;entry, cpuid.<a class="code" href="structcpuid__reg.html#a61bb86739a2392d01411f8a5e6334f96">reg</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div>
<div class="ttc" id="areverse__cpuid_8h_html_a3f7e53c68e5610be44d760fd4854f892"><div class="ttname"><a href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892">x86_feature_cpuid</a></div><div class="ttdeci">static __always_inline struct cpuid_reg x86_feature_cpuid(unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00158">reverse_cpuid.h:158</a></div></div>
<div class="ttc" id="areverse__cpuid_8h_html_adf3299d46978c685ba9b46ebb1536680"><div class="ttname"><a href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680">__cpuid_entry_get_reg</a></div><div class="ttdeci">static __always_inline u32 * __cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry, u32 reg)</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00166">reverse_cpuid.h:166</a></div></div>
<div class="ttc" id="areverse__cpuid_8h_html_ae10c1644e90cb8443e5a32554acfd700"><div class="ttname"><a href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700">reverse_cpuid_check</a></div><div class="ttdeci">static __always_inline void reverse_cpuid_check(unsigned int x86_leaf)</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00103">reverse_cpuid.h:103</a></div></div>
<div class="ttc" id="astructcpuid__reg_html"><div class="ttname"><a href="structcpuid__reg.html">cpuid_reg</a></div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00064">reverse_cpuid.h:64</a></div></div>
<div class="ttc" id="astructcpuid__reg_html_a045599ded48c2883e6d6766a12f79cd3"><div class="ttname"><a href="structcpuid__reg.html#a045599ded48c2883e6d6766a12f79cd3">cpuid_reg::index</a></div><div class="ttdeci">u32 index</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00066">reverse_cpuid.h:66</a></div></div>
<div class="ttc" id="astructcpuid__reg_html_a51b21a0bcadd2d6062b6690ad07e16bc"><div class="ttname"><a href="structcpuid__reg.html#a51b21a0bcadd2d6062b6690ad07e16bc">cpuid_reg::function</a></div><div class="ttdeci">u32 function</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00065">reverse_cpuid.h:65</a></div></div>
<div class="ttc" id="astructcpuid__reg_html_a61bb86739a2392d01411f8a5e6334f96"><div class="ttname"><a href="structcpuid__reg.html#a61bb86739a2392d01411f8a5e6334f96">cpuid_reg::reg</a></div><div class="ttdeci">int reg</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00067">reverse_cpuid.h:67</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ac97e11439f61d1a659b33cba3dc32abf_cgraph.png" border="0" usemap="#acpuid_8c_ac97e11439f61d1a659b33cba3dc32abf_cgraph" alt=""/></div>
<map name="acpuid_8c_ac97e11439f61d1a659b33cba3dc32abf_cgraph" id="acpuid_8c_ac97e11439f61d1a659b33cba3dc32abf_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,173,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="221,5,389,32"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="437,56,596,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="234,107,377,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="459,107,574,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="644,107,792,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ac97e11439f61d1a659b33cba3dc32abf_icgraph.png" border="0" usemap="#acpuid_8c_ac97e11439f61d1a659b33cba3dc32abf_icgraph" alt=""/></div>
<map name="acpuid_8c_ac97e11439f61d1a659b33cba3dc32abf_icgraph" id="acpuid_8c_ac97e11439f61d1a659b33cba3dc32abf_icgraph">
<area shape="rect" title=" " alt="" coords="824,42,992,69"/>
<area shape="rect" href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042" title=" " alt="" coords="601,5,776,47"/>
<area shape="rect" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938" title=" " alt="" coords="611,71,766,98"/>
<area shape="rect" href="cpuid_8c.html#ac4b31e077b5a352bd48a541ad53e3162" title=" " alt="" coords="408,42,553,69"/>
<area shape="rect" href="svm_8c.html#ab2ed2d9e233f1c6a1a3c806826d63401" title=" " alt="" coords="215,17,359,43"/>
<area shape="rect" href="vmx_8c.html#ad6f2c2fa1ea6270fe1b55ad7e770db38" title=" " alt="" coords="215,67,360,94"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,17,167,43"/>
<area shape="rect" href="vmx_8c.html#a7cacd86bbd7f4ae2b8c9e5e8568fa5e4" title=" " alt="" coords="23,67,149,94"/>
</map>
</div>

</div>
</div>
<a id="a57e37154fafc08d4400cac72d0a0b91d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57e37154fafc08d4400cac72d0a0b91d">&#9670;&nbsp;</a></span>__kvm_find_kvm_cpuid_features()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct kvm_cpuid_entry2* __kvm_find_kvm_cpuid_features </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid_entry2 *&#160;</td>
          <td class="paramname"><em>entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00220">220</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    u32 base = vcpu-&gt;arch.kvm_cpuid.base;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">if</span> (!base)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(entries, nent, base | KVM_CPUID_FEATURES,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                 <a class="code" href="cpuid_8c.html#aee2dec4877cb81413a6fa356c138464d">KVM_CPUID_INDEX_NOT_SIGNIFICANT</a>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a7220f0f9a6d0047aef7619e272fa9518"><div class="ttname"><a href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a></div><div class="ttdeci">static struct kvm_cpuid_entry2 * cpuid_entry2_find(struct kvm_cpuid_entry2 *entries, int nent, u32 function, u64 index)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00082">cpuid.c:82</a></div></div>
<div class="ttc" id="acpuid_8c_html_aee2dec4877cb81413a6fa356c138464d"><div class="ttname"><a href="cpuid_8c.html#aee2dec4877cb81413a6fa356c138464d">KVM_CPUID_INDEX_NOT_SIGNIFICANT</a></div><div class="ttdeci">#define KVM_CPUID_INDEX_NOT_SIGNIFICANT</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00080">cpuid.c:80</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a57e37154fafc08d4400cac72d0a0b91d_cgraph.png" border="0" usemap="#acpuid_8c_a57e37154fafc08d4400cac72d0a0b91d_cgraph" alt=""/></div>
<map name="acpuid_8c_a57e37154fafc08d4400cac72d0a0b91d_cgraph" id="acpuid_8c_a57e37154fafc08d4400cac72d0a0b91d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,47"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="228,13,365,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a57e37154fafc08d4400cac72d0a0b91d_icgraph.png" border="0" usemap="#acpuid_8c_a57e37154fafc08d4400cac72d0a0b91d_icgraph" alt=""/></div>
<map name="acpuid_8c_a57e37154fafc08d4400cac72d0a0b91d_icgraph" id="acpuid_8c_a57e37154fafc08d4400cac72d0a0b91d_icgraph">
<area shape="rect" title=" " alt="" coords="1652,244,1827,285"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="1445,211,1603,252"/>
<area shape="rect" href="cpuid_8c.html#a6d8deb4e45da8c580e5830057541fd8b" title=" " alt="" coords="1444,276,1604,317"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="747,85,867,111"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="1193,559,1396,586"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="488,5,639,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="488,71,639,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="219,143,377,170"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="12,143,136,170"/>
<area shape="rect" href="x86_8c.html#a8543429a9ca5c6d3d88560ccd84bbccd" title=" " alt="" coords="747,318,866,345"/>
<area shape="rect" href="smm_8c.html#ae1445727a8459a6cc7d2e49e5a63c0d5" title=" " alt="" coords="995,505,1091,531"/>
<area shape="rect" href="lapic_8c.html#a8d747385873e52f47e85179c21521e73" title=" " alt="" coords="965,437,1120,463"/>
<area shape="rect" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299" title=" " alt="" coords="476,586,651,613"/>
<area shape="rect" href="sev_8c.html#aeb0279b2cc9c76c69ffcca8eb578b33f" title=" " alt="" coords="953,638,1133,665"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="991,739,1095,766"/>
<area shape="rect" href="vmx_8c.html#adda41e5ad7d9839a1fd3e01efc608c37" title=" " alt="" coords="990,942,1095,969"/>
<area shape="rect" href="x86_8c.html#aa5087b536be3ec29dc352f8062f744f5" title=" " alt="" coords="496,267,631,294"/>
<area shape="rect" href="x86_8c.html#ab9b558d7e5dcf9150cf853e009cce971" title=" " alt="" coords="482,318,645,345"/>
<area shape="rect" href="x86_8c.html#a388b875e496f0b87b5c551430b8cf436" title=" " alt="" coords="486,201,641,243"/>
<area shape="rect" href="x86_8c.html#a2694456104c02a7204796d89d13a1e91" title=" " alt="" coords="499,419,628,446"/>
<area shape="rect" href="lapic_8c.html#a27836a2bcd51ebcfe2ca478e9ad7aa04" title=" " alt="" coords="205,330,391,357"/>
<area shape="rect" href="x86_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="212,381,384,407"/>
<area shape="rect" href="svm_8c.html#a2ca2b108d5447ed4093cb0b07092b07d" title=" " alt="" coords="213,431,383,458"/>
<area shape="rect" href="x86_8c.html#a3361a1b517035bb0595ead223a3cb349" title=" " alt="" coords="5,406,143,433"/>
<area shape="rect" href="x86_8c.html#a2b372d06c72b7d8c25e9004bb3a3fd3b" title=" " alt="" coords="721,471,892,512"/>
<area shape="rect" href="lapic_8c.html#a4768d4990380510ec220c3e510d32598" title=" " alt="" coords="731,205,883,231"/>
<area shape="rect" href="lapic_8c.html#a8b8a5d87df5283a20e9aa9b828320552" title=" " alt="" coords="742,419,871,446"/>
<area shape="rect" href="lapic_8h.html#a9d9f2a266299bc56c932735db94816d5" title=" " alt="" coords="731,537,882,563"/>
<area shape="rect" href="x86_8c.html#a4426192bd0d8288db892f9fcbf4577b9" title=" " alt="" coords="488,136,639,177"/>
<area shape="rect" href="x86_8c.html#ad6dd5b8847ecb92fe36f8dabdac40b08" title=" " alt="" coords="482,535,645,562"/>
<area shape="rect" href="svm_8c.html#acb46126747f78036462437a7bcdc2e47" title=" " alt="" coords="257,534,339,561"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="243,585,353,611"/>
<area shape="rect" href="vmx_8c.html#a0fb610ce041405729e4296dfc871c30e" title=" " alt="" coords="243,635,353,662"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="728,638,885,665"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="530,714,597,741"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="486,790,641,817"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="453,841,673,867"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="755,739,859,766"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="202,686,394,713"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="191,737,405,779"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="196,803,400,830"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="195,854,401,881"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="223,905,373,931"/>
<area shape="rect" href="vmx_2nested_8c.html#a06a397c328d1656bb4d3ab073878e6f0" title=" " alt="" coords="472,909,655,935"/>
<area shape="rect" href="vmx_2nested_8c.html#a001f930db9a867e828cf01b48d3e4e25" title=" " alt="" coords="486,964,641,1005"/>
<area shape="rect" href="vmx_2nested_8c.html#a27bdf4f6bbd476189cb0198a634394f5" title=" " alt="" coords="498,1038,629,1065"/>
<area shape="rect" href="vmx_8c.html#acf9f5acdb0b2a5b2778c853846cfa09f" title=" " alt="" coords="754,942,859,969"/>
<area shape="rect" href="cpuid_8c.html#a30771fd4ef9230ee864f4d7ac9cf0514" title=" " alt="" coords="1203,283,1387,310"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="966,191,1119,232"/>
<area shape="rect" href="x86_8c.html#acfafdbc1dfaad0bcc468d4b40e286234" title=" " alt="" coords="940,369,1145,395"/>
</map>
</div>

</div>
</div>
<a id="aba2a2f99dbe3b8848b6ffc19effa6294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba2a2f99dbe3b8848b6ffc19effa6294">&#9670;&nbsp;</a></span>__kvm_update_cpuid_runtime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __kvm_update_cpuid_runtime </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid_entry2 *&#160;</td>
          <td class="paramname"><em>entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00265">265</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *best;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    best = <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(entries, nent, 1, <a class="code" href="cpuid_8c.html#aee2dec4877cb81413a6fa356c138464d">KVM_CPUID_INDEX_NOT_SIGNIFICANT</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (best) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">/* Update OSXSAVE bit */</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_XSAVE))</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <a class="code" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4">cpuid_entry_change</a>(best, X86_FEATURE_OSXSAVE,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                       <a class="code" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65">kvm_is_cr4_bit_set</a>(vcpu, X86_CR4_OSXSAVE));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4">cpuid_entry_change</a>(best, X86_FEATURE_APIC,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;               vcpu-&gt;arch.apic_base &amp; MSR_IA32_APICBASE_ENABLE);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    best = <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(entries, nent, 7, 0);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span> (best &amp;&amp; boot_cpu_has(X86_FEATURE_PKU) &amp;&amp; best-&gt;function == 0x7)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4">cpuid_entry_change</a>(best, X86_FEATURE_OSPKE,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                   <a class="code" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65">kvm_is_cr4_bit_set</a>(vcpu, X86_CR4_PKE));</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    best = <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(entries, nent, 0xD, 0);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (best)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        best-&gt;ebx = <a class="code" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c">xstate_required_size</a>(vcpu-&gt;arch.xcr0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    best = <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(entries, nent, 0xD, 1);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span> (best &amp;&amp; (<a class="code" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826">cpuid_entry_has</a>(best, X86_FEATURE_XSAVES) ||</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;             <a class="code" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826">cpuid_entry_has</a>(best, X86_FEATURE_XSAVEC)))</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        best-&gt;ebx = <a class="code" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c">xstate_required_size</a>(vcpu-&gt;arch.xcr0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    best = <a class="code" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d">__kvm_find_kvm_cpuid_features</a>(vcpu, entries, nent);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231">kvm_hlt_in_guest</a>(vcpu-&gt;kvm) &amp;&amp; best &amp;&amp;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        (best-&gt;eax &amp; (1 &lt;&lt; KVM_FEATURE_PV_UNHALT)))</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        best-&gt;eax &amp;= ~(1 &lt;&lt; KVM_FEATURE_PV_UNHALT);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf">kvm_check_has_quirk</a>(vcpu-&gt;kvm, KVM_X86_QUIRK_MISC_ENABLE_NO_MWAIT)) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        best = <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(entries, nent, 0x1, <a class="code" href="cpuid_8c.html#aee2dec4877cb81413a6fa356c138464d">KVM_CPUID_INDEX_NOT_SIGNIFICANT</a>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">if</span> (best)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <a class="code" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4">cpuid_entry_change</a>(best, X86_FEATURE_MWAIT,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                       vcpu-&gt;arch.ia32_misc_enable_msr &amp;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                       MSR_IA32_MISC_ENABLE_MWAIT);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a57e37154fafc08d4400cac72d0a0b91d"><div class="ttname"><a href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d">__kvm_find_kvm_cpuid_features</a></div><div class="ttdeci">static struct kvm_cpuid_entry2 * __kvm_find_kvm_cpuid_features(struct kvm_vcpu *vcpu, struct kvm_cpuid_entry2 *entries, int nent)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00220">cpuid.c:220</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_a2b779657b20f7afa44c0172b1478ac65"><div class="ttname"><a href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65">kvm_is_cr4_bit_set</a></div><div class="ttdeci">static __always_inline bool kvm_is_cr4_bit_set(struct kvm_vcpu *vcpu, unsigned long cr4_bit)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00182">kvm_cache_regs.h:182</a></div></div>
<div class="ttc" id="areverse__cpuid_8h_html_a748960fccca789bf432536205fdf9826"><div class="ttname"><a href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826">cpuid_entry_has</a></div><div class="ttdeci">static __always_inline bool cpuid_entry_has(struct kvm_cpuid_entry2 *entry, unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00200">reverse_cpuid.h:200</a></div></div>
<div class="ttc" id="areverse__cpuid_8h_html_a9ca8b41f0d18f3dac63b62e545077db4"><div class="ttname"><a href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4">cpuid_entry_change</a></div><div class="ttdeci">static __always_inline void cpuid_entry_change(struct kvm_cpuid_entry2 *entry, unsigned int x86_feature, bool set)</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00222">reverse_cpuid.h:222</a></div></div>
<div class="ttc" id="ax86_8h_html_ace4ed625ac4852e54db110fde28d3231"><div class="ttname"><a href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231">kvm_hlt_in_guest</a></div><div class="ttdeci">static bool kvm_hlt_in_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00414">x86.h:414</a></div></div>
<div class="ttc" id="ax86_8h_html_adf8330176a8805826ed4711a51ce93cf"><div class="ttname"><a href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf">kvm_check_has_quirk</a></div><div class="ttdeci">static bool kvm_check_has_quirk(struct kvm *kvm, u64 quirk)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00288">x86.h:288</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_aba2a2f99dbe3b8848b6ffc19effa6294_cgraph.png" border="0" usemap="#acpuid_8c_aba2a2f99dbe3b8848b6ffc19effa6294_cgraph" alt=""/></div>
<map name="acpuid_8c_aba2a2f99dbe3b8848b6ffc19effa6294_cgraph" id="acpuid_8c_aba2a2f99dbe3b8848b6ffc19effa6294_cgraph">
<area shape="rect" title=" " alt="" coords="5,178,164,219"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="212,43,387,85"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="442,21,579,48"/>
<area shape="rect" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4" title=" " alt="" coords="435,160,587,187"/>
<area shape="rect" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826" title=" " alt="" coords="235,109,363,136"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="216,211,383,237"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="231,261,368,288"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="226,312,373,339"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="221,363,378,389"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="907,160,1013,187"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="654,84,809,111"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1299,109,1447,136"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1092,109,1251,136"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="876,109,1044,136"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="889,59,1031,85"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1114,59,1229,85"/>
<area shape="rect" href="reverse__cpuid_8h.html#a5c0c9322094b13d5fff76b5ab593339a" title=" " alt="" coords="447,109,574,136"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="438,312,583,339"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="635,312,828,339"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_aba2a2f99dbe3b8848b6ffc19effa6294_icgraph.png" border="0" usemap="#acpuid_8c_aba2a2f99dbe3b8848b6ffc19effa6294_icgraph" alt=""/></div>
<map name="acpuid_8c_aba2a2f99dbe3b8848b6ffc19effa6294_icgraph" id="acpuid_8c_aba2a2f99dbe3b8848b6ffc19effa6294_icgraph">
<area shape="rect" title=" " alt="" coords="1640,391,1799,432"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="968,78,1088,105"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="1389,474,1592,501"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="709,5,860,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="709,71,860,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="440,143,599,170"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,209,129,235"/>
<area shape="rect" href="x86_8c.html#a8543429a9ca5c6d3d88560ccd84bbccd" title=" " alt="" coords="969,310,1087,337"/>
<area shape="rect" href="smm_8c.html#ae1445727a8459a6cc7d2e49e5a63c0d5" title=" " alt="" coords="1203,449,1299,475"/>
<area shape="rect" href="lapic_8c.html#a8d747385873e52f47e85179c21521e73" title=" " alt="" coords="1174,379,1329,406"/>
<area shape="rect" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299" title=" " alt="" coords="697,525,872,551"/>
<area shape="rect" href="sev_8c.html#aeb0279b2cc9c76c69ffcca8eb578b33f" title=" " alt="" coords="1161,579,1341,606"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="1199,726,1303,753"/>
<area shape="rect" href="vmx_8c.html#adda41e5ad7d9839a1fd3e01efc608c37" title=" " alt="" coords="1199,966,1304,993"/>
<area shape="rect" href="x86_8c.html#aa5087b536be3ec29dc352f8062f744f5" title=" " alt="" coords="717,267,852,294"/>
<area shape="rect" href="x86_8c.html#ab9b558d7e5dcf9150cf853e009cce971" title=" " alt="" coords="703,318,866,345"/>
<area shape="rect" href="x86_8c.html#a388b875e496f0b87b5c551430b8cf436" title=" " alt="" coords="707,201,862,243"/>
<area shape="rect" href="x86_8c.html#a2694456104c02a7204796d89d13a1e91" title=" " alt="" coords="720,369,849,395"/>
<area shape="rect" href="lapic_8c.html#a27836a2bcd51ebcfe2ca478e9ad7aa04" title=" " alt="" coords="426,267,613,294"/>
<area shape="rect" href="x86_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="433,318,605,345"/>
<area shape="rect" href="svm_8c.html#a2ca2b108d5447ed4093cb0b07092b07d" title=" " alt="" coords="434,369,605,395"/>
<area shape="rect" href="x86_8c.html#a5eac8002ee5a0c08de662d89be4d6a11" title=" " alt="" coords="191,201,350,243"/>
<area shape="rect" href="x86_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,267,364,294"/>
<area shape="rect" href="x86_8c.html#a3361a1b517035bb0595ead223a3cb349" title=" " alt="" coords="202,369,339,395"/>
<area shape="rect" href="x86_8c.html#a2b372d06c72b7d8c25e9004bb3a3fd3b" title=" " alt="" coords="943,412,1113,453"/>
<area shape="rect" href="lapic_8c.html#a4768d4990380510ec220c3e510d32598" title=" " alt="" coords="952,201,1104,227"/>
<area shape="rect" href="lapic_8c.html#a8b8a5d87df5283a20e9aa9b828320552" title=" " alt="" coords="963,361,1093,387"/>
<area shape="rect" href="lapic_8h.html#a9d9f2a266299bc56c932735db94816d5" title=" " alt="" coords="953,478,1103,505"/>
<area shape="rect" href="x86_8c.html#a4426192bd0d8288db892f9fcbf4577b9" title=" " alt="" coords="709,136,860,177"/>
<area shape="rect" href="x86_8c.html#ad6dd5b8847ecb92fe36f8dabdac40b08" title=" " alt="" coords="703,474,866,501"/>
<area shape="rect" href="svm_8c.html#acb46126747f78036462437a7bcdc2e47" title=" " alt="" coords="479,470,560,497"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="465,521,574,547"/>
<area shape="rect" href="vmx_8c.html#a0fb610ce041405729e4296dfc871c30e" title=" " alt="" coords="464,571,575,598"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="949,579,1107,606"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="751,701,818,727"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="707,765,862,791"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="675,827,895,854"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="976,726,1080,753"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="423,622,615,649"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="412,673,627,715"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="417,739,621,766"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="417,790,622,817"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="195,899,346,926"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="428,892,611,933"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="430,958,609,985"/>
<area shape="rect" href="vmx_2nested_8c.html#a06a397c328d1656bb4d3ab073878e6f0" title=" " alt="" coords="693,950,876,977"/>
<area shape="rect" href="vmx_2nested_8c.html#a001f930db9a867e828cf01b48d3e4e25" title=" " alt="" coords="707,1001,862,1043"/>
<area shape="rect" href="vmx_2nested_8c.html#a27bdf4f6bbd476189cb0198a634394f5" title=" " alt="" coords="719,1067,850,1094"/>
<area shape="rect" href="vmx_8c.html#acf9f5acdb0b2a5b2778c853846cfa09f" title=" " alt="" coords="975,966,1081,993"/>
<area shape="rect" href="vmx_2nested_8c.html#ad680a323fa0378a55e97821505ba74b1" title=" " alt="" coords="442,1009,597,1035"/>
</map>
</div>

</div>
</div>
<a id="a7220f0f9a6d0047aef7619e272fa9518"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7220f0f9a6d0047aef7619e272fa9518">&#9670;&nbsp;</a></span>cpuid_entry2_find()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct kvm_cpuid_entry2* cpuid_entry2_find </td>
          <td>(</td>
          <td class="paramtype">struct kvm_cpuid_entry2 *&#160;</td>
          <td class="paramname"><em>entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00082">82</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *e;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">     * KVM has a semi-arbitrary rule that querying the guest&#39;s CPUID model</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">     * with IRQs disabled is disallowed.  The CPUID model can legitimately</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">     * have over one hundred entries, i.e. the lookup is slow, and IRQs are</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">     * typically disabled in KVM only when KVM is in a performance critical</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">     * path, e.g. the core VM-Enter/VM-Exit run loop.  Nothing will break</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">     * if this rule is violated, this assertion is purely to flag potential</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">     * performance issues.  If this fires, consider moving the lookup out</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">     * of the hotpath, e.g. by caching information during CPUID updates.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    lockdep_assert_irqs_enabled();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nent; i++) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        e = &amp;entries[i];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (e-&gt;function != <span class="keyword">function</span>)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">         * If the index isn&#39;t significant, use the first entry with a</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">         * matching function.  It&#39;s userspace&#39;s responsibility to not</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">         * provide &quot;duplicate&quot; entries in all cases.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">if</span> (!(e-&gt;flags &amp; KVM_CPUID_FLAG_SIGNIFCANT_INDEX) || e-&gt;index == index)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">return</span> e;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">         * Similarly, use the first matching entry if KVM is doing a</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">         * lookup (as opposed to emulating CPUID) for a function that&#39;s</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">         * architecturally defined as not having a significant index.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">if</span> (index == <a class="code" href="cpuid_8c.html#aee2dec4877cb81413a6fa356c138464d">KVM_CPUID_INDEX_NOT_SIGNIFICANT</a>) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">             * Direct lookups from KVM should not diverge from what</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">             * KVM defines internally (the architectural behavior).</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            WARN_ON_ONCE(cpuid_function_is_indexed(<span class="keyword">function</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">return</span> e;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a7220f0f9a6d0047aef7619e272fa9518_icgraph.png" border="0" usemap="#acpuid_8c_a7220f0f9a6d0047aef7619e272fa9518_icgraph" alt=""/></div>
<map name="acpuid_8c_a7220f0f9a6d0047aef7619e272fa9518_icgraph" id="acpuid_8c_a7220f0f9a6d0047aef7619e272fa9518_icgraph">
<area shape="rect" title=" " alt="" coords="1375,417,1512,444"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="1143,351,1318,392"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="925,272,1083,314"/>
<area shape="rect" href="cpuid_8c.html#ab09a1700616790a1bd47e46825c5012b" title=" " alt="" coords="1135,468,1327,494"/>
<area shape="rect" href="cpuid_8c.html#afea420158d1fda2784dd4382763f258c" title=" " alt="" coords="1161,417,1300,444"/>
<area shape="rect" href="cpuid_8c.html#a7eb8299488a685437496d827e2ad9fb3" title=" " alt="" coords="685,12,859,38"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="921,886,1087,913"/>
<area shape="rect" href="cpuid_8c.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="921,1400,1087,1442"/>
<area shape="rect" href="cpuid_8c.html#a6d8deb4e45da8c580e5830057541fd8b" title=" " alt="" coords="924,351,1084,392"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="241,350,361,377"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="671,272,873,298"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="16,311,167,352"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="16,376,167,418"/>
<area shape="rect" href="x86_8c.html#a8543429a9ca5c6d3d88560ccd84bbccd" title=" " alt="" coords="465,468,583,494"/>
<area shape="rect" href="smm_8c.html#ae1445727a8459a6cc7d2e49e5a63c0d5" title=" " alt="" coords="476,316,572,342"/>
<area shape="rect" href="lapic_8c.html#a8d747385873e52f47e85179c21521e73" title=" " alt="" coords="447,113,601,140"/>
<area shape="rect" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299" title=" " alt="" coords="437,366,611,393"/>
<area shape="rect" href="sev_8c.html#aeb0279b2cc9c76c69ffcca8eb578b33f" title=" " alt="" coords="434,164,614,190"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="472,214,576,241"/>
<area shape="rect" href="vmx_8c.html#adda41e5ad7d9839a1fd3e01efc608c37" title=" " alt="" coords="471,265,577,292"/>
<area shape="rect" href="x86_8c.html#a2694456104c02a7204796d89d13a1e91" title=" " alt="" coords="237,636,366,662"/>
<area shape="rect" href="x86_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="5,610,177,637"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="247,434,356,461"/>
<area shape="rect" href="cpuid_8c.html#a30771fd4ef9230ee864f4d7ac9cf0514" title=" " alt="" coords="680,362,864,389"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="447,519,601,560"/>
<area shape="rect" href="cpuid_8c.html#a881fc10bf62818799a56d9246f58b6cf" title=" " alt="" coords="677,686,867,713"/>
<area shape="rect" href="cpuid_8c.html#ac2fc42a3bfaa6a6d13a79e259561eba1" title=" " alt="" coords="683,1291,861,1332"/>
<area shape="rect" href="cpuid_8h.html#adaefbcb7a479c2699345d74eb1fe3602" title=" " alt="" coords="697,912,847,938"/>
<area shape="rect" href="cpuid_8h.html#a5a6ba63d82eb4536c34fc156c7021193" title=" " alt="" coords="695,570,849,611"/>
<area shape="rect" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d" title=" " alt="" coords="695,861,849,888"/>
<area shape="rect" href="cpuid_8h.html#a000a8b4d5c33ede65d4a34091f93b934" title=" " alt="" coords="698,1021,846,1048"/>
<area shape="rect" href="pmu__intel_8c.html#aef55e73b4b7ac8d0841b17310fc92297" title=" " alt="" coords="231,1189,371,1216"/>
<area shape="rect" href="cpuid_8h.html#a986d59c8648488abee98cf60c8c3435f" title=" " alt="" coords="691,962,853,989"/>
<area shape="rect" href="hyperv_8c.html#a35fa0d5d0a982e559906372c42713c55" title=" " alt="" coords="701,636,843,662"/>
<area shape="rect" href="vmx_8c.html#a8cdfbbeaa7040fa24ebedf4c01d591ad" title=" " alt="" coords="689,1174,855,1215"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="451,1072,597,1114"/>
<area shape="rect" href="cpuid_8c.html#a91d770d0af7358b6cd24b7cbe2617d73" title=" " alt="" coords="477,1378,571,1405"/>
<area shape="rect" href="svm_8c.html#a091db4f6d8d0fc811fdd6d9b2a775889" title=" " alt="" coords="469,1021,579,1048"/>
<area shape="rect" href="x86_8c.html#ad0df6b04ae08eb6eec89da2d81e465cd" title=" " alt="" coords="462,737,586,764"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="449,788,599,830"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="225,912,377,954"/>
<area shape="rect" href="x86_8c.html#a0a47622bf3c21272e9e0357e1f90540a" title=" " alt="" coords="432,854,616,895"/>
<area shape="rect" href="pmu_8c.html#a60270cb74533fe7721d3ae186abe70cf" title=" " alt="" coords="433,970,615,997"/>
<area shape="rect" href="cpuid_8h.html#ab99dc7d6bb2a01d43e47b5460139730a" title=" " alt="" coords="425,1138,623,1165"/>
<area shape="rect" href="sgx_8c.html#a2feaab00580c798dcee154b1798a674b" title=" " alt="" coords="683,1677,861,1704"/>
<area shape="rect" href="svm_2pmu_8c.html#a3a6878daa6211de21b0ca114119eff4e" title=" " alt="" coords="702,1357,842,1384"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="679,1408,865,1434"/>
<area shape="rect" href="xen_8c.html#adf531b186f63f085d94a6c47ab72f473" title=" " alt="" coords="677,1509,867,1536"/>
<area shape="rect" href="sgx_8c.html#a5f819c934ba32cfa58e874bb340f0142" title=" " alt="" coords="697,1560,847,1602"/>
<area shape="rect" href="vmx_8c.html#ad32f6ad8df8337d94ebb5d6a670853b5" title=" " alt="" coords="697,1626,847,1653"/>
</map>
</div>

</div>
</div>
<a id="ab09a1700616790a1bd47e46825c5012b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab09a1700616790a1bd47e46825c5012b">&#9670;&nbsp;</a></span>cpuid_get_supported_xcr0()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 cpuid_get_supported_xcr0 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_cpuid_entry2 *&#160;</td>
          <td class="paramname"><em>entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00254">254</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *best;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    best = <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(entries, nent, 0xd, 0);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (!best)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">return</span> (best-&gt;eax | ((u64)best-&gt;edx &lt;&lt; 32)) &amp; <a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#acb835ad2fee6979c5058003aa5cb601a">supported_xcr0</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
<div class="ttc" id="astructkvm__caps_html_acb835ad2fee6979c5058003aa5cb601a"><div class="ttname"><a href="structkvm__caps.html#acb835ad2fee6979c5058003aa5cb601a">kvm_caps::supported_xcr0</a></div><div class="ttdeci">u64 supported_xcr0</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00029">x86.h:29</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ab09a1700616790a1bd47e46825c5012b_cgraph.png" border="0" usemap="#acpuid_8c_ab09a1700616790a1bd47e46825c5012b_cgraph" alt=""/></div>
<map name="acpuid_8c_ab09a1700616790a1bd47e46825c5012b_cgraph" id="acpuid_8c_ab09a1700616790a1bd47e46825c5012b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,197,32"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="245,5,383,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ab09a1700616790a1bd47e46825c5012b_icgraph.png" border="0" usemap="#acpuid_8c_ab09a1700616790a1bd47e46825c5012b_icgraph" alt=""/></div>
<map name="acpuid_8c_ab09a1700616790a1bd47e46825c5012b_icgraph" id="acpuid_8c_ab09a1700616790a1bd47e46825c5012b_icgraph">
<area shape="rect" title=" " alt="" coords="952,46,1144,73"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="751,39,904,80"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="583,46,703,73"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="384,71,535,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,46,336,73"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,46,129,73"/>
</map>
</div>

</div>
</div>
<a id="a881fc10bf62818799a56d9246f58b6cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a881fc10bf62818799a56d9246f58b6cf">&#9670;&nbsp;</a></span>cpuid_query_maxphyaddr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cpuid_query_maxphyaddr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00390">390</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;{</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *best;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    best = <a class="code" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>(vcpu, 0x80000000);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (!best || best-&gt;eax &lt; 0x80000008)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">goto</span> not_found;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    best = <a class="code" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>(vcpu, 0x80000008);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">if</span> (best)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">return</span> best-&gt;eax &amp; 0xff;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;not_found:</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span> 36;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_aae0475609eefc48bb151ef5a631670c0"><div class="ttname"><a href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a></div><div class="ttdeci">struct kvm_cpuid_entry2 * kvm_find_cpuid_entry(struct kvm_vcpu *vcpu, u32 function)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l01455">cpuid.c:1455</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a881fc10bf62818799a56d9246f58b6cf_cgraph.png" border="0" usemap="#acpuid_8c_a881fc10bf62818799a56d9246f58b6cf_cgraph" alt=""/></div>
<map name="acpuid_8c_a881fc10bf62818799a56d9246f58b6cf_cgraph" id="acpuid_8c_a881fc10bf62818799a56d9246f58b6cf_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,196,32"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="244,5,409,32"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="457,5,595,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a881fc10bf62818799a56d9246f58b6cf_icgraph.png" border="0" usemap="#acpuid_8c_a881fc10bf62818799a56d9246f58b6cf_icgraph" alt=""/></div>
<map name="acpuid_8c_a881fc10bf62818799a56d9246f58b6cf_icgraph" id="acpuid_8c_a881fc10bf62818799a56d9246f58b6cf_icgraph">
<area shape="rect" title=" " alt="" coords="1051,35,1241,61"/>
<area shape="rect" href="x86_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="831,5,1003,32"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="840,57,993,98"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="583,5,783,32"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="623,64,743,91"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="384,23,535,65"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="384,89,535,130"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,64,336,91"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,64,129,91"/>
</map>
</div>

</div>
</div>
<a id="a652f54573475d1818402ab58329c340c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a652f54573475d1818402ab58329c340c">&#9670;&nbsp;</a></span>do_cpuid_func()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int do_cpuid_func </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l01342">1342</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;{</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">if</span> (type == KVM_GET_EMULATED_CPUID)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cpuid_8c.html#a62b781aedf96991bb95c97f5cf645a62">__do_cpuid_func_emulated</a>(array, func);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpuid_8c.html#ac91da0391b283d7527a8b33206fe03dd">__do_cpuid_func</a>(array, func);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a62b781aedf96991bb95c97f5cf645a62"><div class="ttname"><a href="cpuid_8c.html#a62b781aedf96991bb95c97f5cf645a62">__do_cpuid_func_emulated</a></div><div class="ttdeci">static int __do_cpuid_func_emulated(struct kvm_cpuid_array *array, u32 func)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00878">cpuid.c:878</a></div></div>
<div class="ttc" id="acpuid_8c_html_ac91da0391b283d7527a8b33206fe03dd"><div class="ttname"><a href="cpuid_8c.html#ac91da0391b283d7527a8b33206fe03dd">__do_cpuid_func</a></div><div class="ttdeci">static int __do_cpuid_func(struct kvm_cpuid_array *array, u32 function)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00913">cpuid.c:913</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a652f54573475d1818402ab58329c340c_cgraph.png" border="0" usemap="#acpuid_8c_a652f54573475d1818402ab58329c340c_cgraph" alt=""/></div>
<map name="acpuid_8c_a652f54573475d1818402ab58329c340c_cgraph" id="acpuid_8c_a652f54573475d1818402ab58329c340c_cgraph">
<area shape="rect" title=" " alt="" coords="5,108,120,135"/>
<area shape="rect" href="cpuid_8c.html#ac91da0391b283d7527a8b33206fe03dd" title=" " alt="" coords="203,145,332,172"/>
<area shape="rect" href="cpuid_8c.html#a62b781aedf96991bb95c97f5cf645a62" title=" " alt="" coords="168,69,367,96"/>
<area shape="rect" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd" title=" " alt="" coords="419,208,577,235"/>
<area shape="rect" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146" title=" " alt="" coords="441,107,555,133"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="427,56,569,83"/>
<area shape="rect" href="x86_8h.html#aa3fd405bd522a08e3b5ccffbe8942a3c" title=" " alt="" coords="415,157,581,184"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="419,259,577,285"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="629,208,784,235"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="832,208,1000,235"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="845,157,987,184"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1070,107,1185,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1048,56,1207,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1255,56,1403,83"/>
<area shape="rect" href="cpuid_8c.html#a10c9a4330804572330fe3b5f7eac9b07" title=" " alt="" coords="646,107,767,133"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="637,56,776,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="863,5,969,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a652f54573475d1818402ab58329c340c_icgraph.png" border="0" usemap="#acpuid_8c_a652f54573475d1818402ab58329c340c_icgraph" alt=""/></div>
<map name="acpuid_8c_a652f54573475d1818402ab58329c340c_icgraph" id="acpuid_8c_a652f54573475d1818402ab58329c340c_icgraph">
<area shape="rect" title=" " alt="" coords="608,5,723,32"/>
<area shape="rect" href="cpuid_8c.html#a1e952716ba7f46eb64f00d8a59c2be8d" title=" " alt="" coords="440,5,560,32"/>
<area shape="rect" href="cpuid_8c.html#ac74b10a6f6a1e67ef54c48e55473ff07" title=" " alt="" coords="205,5,392,32"/>
<area shape="rect" href="x86_8c.html#a05ad3b4bc56bfbca86cf49699ca69f5f" title=" " alt="" coords="5,5,157,32"/>
</map>
</div>

</div>
</div>
<a id="ae8aeecb8bfdee1a641e314a3605e6146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8aeecb8bfdee1a641e314a3605e6146">&#9670;&nbsp;</a></span>do_host_cpuid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct kvm_cpuid_entry2* do_host_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00835">835</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;{</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *entry = <a class="code" href="cpuid_8c.html#a10c9a4330804572330fe3b5f7eac9b07">get_next_cpuid</a>(array);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    memset(entry, 0, <span class="keyword">sizeof</span>(*entry));</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    entry-&gt;function = <span class="keyword">function</span>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    entry-&gt;index = index;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">switch</span> (<span class="keyword">function</span> &amp; 0xC0000000) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">case</span> 0x40000000:</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="comment">/* Hypervisor leaves are always synthesized by __do_cpuid_func.  */</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">return</span> entry;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">case</span> 0x80000000:</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">         * 0x80000021 is sometimes synthesized by __do_cpuid_func, which</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">         * would result in out-of-bounds calls to do_host_cpuid.</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <span class="keyword">static</span> <span class="keywordtype">int</span> max_cpuid_80000000;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="keywordflow">if</span> (!READ_ONCE(max_cpuid_80000000))</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                WRITE_ONCE(max_cpuid_80000000, cpuid_eax(0x80000000));</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">function</span> &gt; READ_ONCE(max_cpuid_80000000))</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                <span class="keywordflow">return</span> entry;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    cpuid_count(entry-&gt;function, entry-&gt;index,</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            &amp;entry-&gt;eax, &amp;entry-&gt;ebx, &amp;entry-&gt;ecx, &amp;entry-&gt;edx);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">if</span> (cpuid_function_is_indexed(<span class="keyword">function</span>))</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        entry-&gt;flags |= KVM_CPUID_FLAG_SIGNIFCANT_INDEX;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">return</span> entry;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a10c9a4330804572330fe3b5f7eac9b07"><div class="ttname"><a href="cpuid_8c.html#a10c9a4330804572330fe3b5f7eac9b07">get_next_cpuid</a></div><div class="ttdeci">static struct kvm_cpuid_entry2 * get_next_cpuid(struct kvm_cpuid_array *array)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00827">cpuid.c:827</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ae8aeecb8bfdee1a641e314a3605e6146_cgraph.png" border="0" usemap="#acpuid_8c_ae8aeecb8bfdee1a641e314a3605e6146_cgraph" alt=""/></div>
<map name="acpuid_8c_ae8aeecb8bfdee1a641e314a3605e6146_cgraph" id="acpuid_8c_ae8aeecb8bfdee1a641e314a3605e6146_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,120,32"/>
<area shape="rect" href="cpuid_8c.html#a10c9a4330804572330fe3b5f7eac9b07" title=" " alt="" coords="168,5,289,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ae8aeecb8bfdee1a641e314a3605e6146_icgraph.png" border="0" usemap="#acpuid_8c_ae8aeecb8bfdee1a641e314a3605e6146_icgraph" alt=""/></div>
<map name="acpuid_8c_ae8aeecb8bfdee1a641e314a3605e6146_icgraph" id="acpuid_8c_ae8aeecb8bfdee1a641e314a3605e6146_icgraph">
<area shape="rect" title=" " alt="" coords="948,5,1063,32"/>
<area shape="rect" href="cpuid_8c.html#ac91da0391b283d7527a8b33206fe03dd" title=" " alt="" coords="771,5,900,32"/>
<area shape="rect" href="cpuid_8c.html#a652f54573475d1818402ab58329c340c" title=" " alt="" coords="608,5,723,32"/>
<area shape="rect" href="cpuid_8c.html#a1e952716ba7f46eb64f00d8a59c2be8d" title=" " alt="" coords="440,5,560,32"/>
<area shape="rect" href="cpuid_8c.html#ac74b10a6f6a1e67ef54c48e55473ff07" title=" " alt="" coords="205,5,392,32"/>
<area shape="rect" href="x86_8c.html#a05ad3b4bc56bfbca86cf49699ca69f5f" title=" " alt="" coords="5,5,157,32"/>
</map>
</div>

</div>
</div>
<a id="a4f30a46a22584ebc11e3b738e3e5704d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f30a46a22584ebc11e3b738e3e5704d">&#9670;&nbsp;</a></span>EXPORT_SYMBOL_GPL() <span class="overload">[1/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL_GPL </td>
          <td>(</td>
          <td class="paramtype">kvm_cpu_caps&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a78ed9f073b7862e8d665aa3e27afb469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78ed9f073b7862e8d665aa3e27afb469">&#9670;&nbsp;</a></span>EXPORT_SYMBOL_GPL() <span class="overload">[2/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL_GPL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cpuid_8h.html#a91d770d0af7358b6cd24b7cbe2617d73">kvm_cpuid</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeb7794c6ff2248aea83d680956228fcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb7794c6ff2248aea83d680956228fcc">&#9670;&nbsp;</a></span>EXPORT_SYMBOL_GPL() <span class="overload">[3/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL_GPL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cpuid_8c.html#a3650f2f078b9b3c62d58cd77e47ce3ab">kvm_emulate_cpuid</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a245fe292acf7a85765f6df4871df0859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a245fe292acf7a85765f6df4871df0859">&#9670;&nbsp;</a></span>EXPORT_SYMBOL_GPL() <span class="overload">[4/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL_GPL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab4625f7100f5a0354515e221a360db31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4625f7100f5a0354515e221a360db31">&#9670;&nbsp;</a></span>EXPORT_SYMBOL_GPL() <span class="overload">[5/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL_GPL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d">kvm_find_cpuid_entry_index</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af7d754ebfabec24d8d1018620862aaa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7d754ebfabec24d8d1018620862aaa5">&#9670;&nbsp;</a></span>EXPORT_SYMBOL_GPL() <span class="overload">[6/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL_GPL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cpuid_8h.html#ac4b31e077b5a352bd48a541ad53e3162">kvm_set_cpu_caps</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3264fc51c50cf8358e311f181fc2ff2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3264fc51c50cf8358e311f181fc2ff2a">&#9670;&nbsp;</a></span>EXPORT_SYMBOL_GPL() <span class="overload">[7/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL_GPL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cpuid_8h.html#a537512099e11c7ab0553aeae5e38d9ea">kvm_update_cpuid_runtime</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e952716ba7f46eb64f00d8a59c2be8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e952716ba7f46eb64f00d8a59c2be8d">&#9670;&nbsp;</a></span>get_cpuid_func()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int get_cpuid_func </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l01353">1353</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;{</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    u32 limit;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordflow">if</span> (func == <a class="code" href="cpuid_8c.html#a4d7a5e68dae710cd6f79a0379588f773">CENTAUR_CPUID_SIGNATURE</a> &amp;&amp;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        boot_cpu_data.x86_vendor != X86_VENDOR_CENTAUR)</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    r = <a class="code" href="cpuid_8c.html#a652f54573475d1818402ab58329c340c">do_cpuid_func</a>(array, func, type);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    limit = array-&gt;<a class="code" href="structkvm__cpuid__array.html#a0f69cb1cf1ca8b9e6dc3d05e9be947f2">entries</a>[array-&gt;<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a> - 1].eax;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordflow">for</span> (func = func + 1; func &lt;= limit; ++func) {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        r = <a class="code" href="cpuid_8c.html#a652f54573475d1818402ab58329c340c">do_cpuid_func</a>(array, func, type);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a4d7a5e68dae710cd6f79a0379588f773"><div class="ttname"><a href="cpuid_8c.html#a4d7a5e68dae710cd6f79a0379588f773">CENTAUR_CPUID_SIGNATURE</a></div><div class="ttdeci">#define CENTAUR_CPUID_SIGNATURE</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l01351">cpuid.c:1351</a></div></div>
<div class="ttc" id="acpuid_8c_html_a652f54573475d1818402ab58329c340c"><div class="ttname"><a href="cpuid_8c.html#a652f54573475d1818402ab58329c340c">do_cpuid_func</a></div><div class="ttdeci">static int do_cpuid_func(struct kvm_cpuid_array *array, u32 func, unsigned int type)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l01342">cpuid.c:1342</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a1e952716ba7f46eb64f00d8a59c2be8d_cgraph.png" border="0" usemap="#acpuid_8c_a1e952716ba7f46eb64f00d8a59c2be8d_cgraph" alt=""/></div>
<map name="acpuid_8c_a1e952716ba7f46eb64f00d8a59c2be8d_cgraph" id="acpuid_8c_a1e952716ba7f46eb64f00d8a59c2be8d_cgraph">
<area shape="rect" title=" " alt="" coords="5,108,125,135"/>
<area shape="rect" href="cpuid_8c.html#a652f54573475d1818402ab58329c340c" title=" " alt="" coords="173,108,288,135"/>
<area shape="rect" href="cpuid_8c.html#ac91da0391b283d7527a8b33206fe03dd" title=" " alt="" coords="371,145,500,172"/>
<area shape="rect" href="cpuid_8c.html#a62b781aedf96991bb95c97f5cf645a62" title=" " alt="" coords="336,69,535,96"/>
<area shape="rect" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd" title=" " alt="" coords="587,208,745,235"/>
<area shape="rect" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146" title=" " alt="" coords="609,107,723,133"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="595,56,737,83"/>
<area shape="rect" href="x86_8h.html#aa3fd405bd522a08e3b5ccffbe8942a3c" title=" " alt="" coords="583,157,749,184"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="587,259,745,285"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="797,208,952,235"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1000,208,1168,235"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1013,157,1155,184"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1238,107,1353,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1216,56,1375,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1423,56,1571,83"/>
<area shape="rect" href="cpuid_8c.html#a10c9a4330804572330fe3b5f7eac9b07" title=" " alt="" coords="814,107,935,133"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="805,56,944,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1031,5,1137,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a1e952716ba7f46eb64f00d8a59c2be8d_icgraph.png" border="0" usemap="#acpuid_8c_a1e952716ba7f46eb64f00d8a59c2be8d_icgraph" alt=""/></div>
<map name="acpuid_8c_a1e952716ba7f46eb64f00d8a59c2be8d_icgraph" id="acpuid_8c_a1e952716ba7f46eb64f00d8a59c2be8d_icgraph">
<area shape="rect" title=" " alt="" coords="440,5,560,32"/>
<area shape="rect" href="cpuid_8c.html#ac74b10a6f6a1e67ef54c48e55473ff07" title=" " alt="" coords="205,5,392,32"/>
<area shape="rect" href="x86_8c.html#a05ad3b4bc56bfbca86cf49699ca69f5f" title=" " alt="" coords="5,5,157,32"/>
</map>
</div>

</div>
</div>
<a id="a10c9a4330804572330fe3b5f7eac9b07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10c9a4330804572330fe3b5f7eac9b07">&#9670;&nbsp;</a></span>get_next_cpuid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct kvm_cpuid_entry2* get_next_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> *&#160;</td>
          <td class="paramname"><em>array</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00827">827</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;{</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">if</span> (array-&gt;<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a> &gt;= array-&gt;<a class="code" href="structkvm__cpuid__array.html#a8f5df87c0238185d71b87449e9a0056a">maxnent</a>)</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">return</span> &amp;array-&gt;<a class="code" href="structkvm__cpuid__array.html#a0f69cb1cf1ca8b9e6dc3d05e9be947f2">entries</a>[array-&gt;<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a>++];</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a10c9a4330804572330fe3b5f7eac9b07_icgraph.png" border="0" usemap="#acpuid_8c_a10c9a4330804572330fe3b5f7eac9b07_icgraph" alt=""/></div>
<map name="acpuid_8c_a10c9a4330804572330fe3b5f7eac9b07_icgraph" id="acpuid_8c_a10c9a4330804572330fe3b5f7eac9b07_icgraph">
<area shape="rect" title=" " alt="" coords="1111,5,1232,32"/>
<area shape="rect" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146" title=" " alt="" coords="948,5,1063,32"/>
<area shape="rect" href="cpuid_8c.html#ac91da0391b283d7527a8b33206fe03dd" title=" " alt="" coords="771,5,900,32"/>
<area shape="rect" href="cpuid_8c.html#a652f54573475d1818402ab58329c340c" title=" " alt="" coords="608,5,723,32"/>
<area shape="rect" href="cpuid_8c.html#a1e952716ba7f46eb64f00d8a59c2be8d" title=" " alt="" coords="440,5,560,32"/>
<area shape="rect" href="cpuid_8c.html#ac74b10a6f6a1e67ef54c48e55473ff07" title=" " alt="" coords="205,5,392,32"/>
<area shape="rect" href="x86_8c.html#a05ad3b4bc56bfbca86cf49699ca69f5f" title=" " alt="" coords="5,5,157,32"/>
</map>
</div>

</div>
</div>
<a id="ac2fc42a3bfaa6a6d13a79e259561eba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2fc42a3bfaa6a6d13a79e259561eba1">&#9670;&nbsp;</a></span>get_out_of_range_cpuid_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct kvm_cpuid_entry2* get_out_of_range_cpuid_entry </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>fn_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l01492">1492</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;{</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *basic, *<span class="keyword">class</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    u32 <span class="keyword">function</span> = *fn_ptr;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    basic = <a class="code" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>(vcpu, 0);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">if</span> (!basic)</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__emulate_8h.html#aaeb0a87b097a9164d79418139514f852">is_guest_vendor_amd</a>(basic-&gt;ebx, basic-&gt;ecx, basic-&gt;edx) ||</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <a class="code" href="kvm__emulate_8h.html#a1d708985e548ee4ce6eee808a31d279c">is_guest_vendor_hygon</a>(basic-&gt;ebx, basic-&gt;ecx, basic-&gt;edx))</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">function</span> &gt;= 0x40000000 &amp;&amp; <span class="keyword">function</span> &lt;= 0x4fffffff)</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keyword">class </span>= <a class="code" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>(vcpu, function &amp; 0xffffff00);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">function</span> &gt;= 0xc0000000)</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <span class="keyword">class </span>= <a class="code" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>(vcpu, 0xc0000000);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="keyword">class </span>= <a class="code" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>(vcpu, function &amp; 0x80000000);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">class</span> &amp;&amp; function &lt;= class-&gt;eax)</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160; </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">     * Leaf specific adjustments are also applied when redirecting to the</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">     * max basic entry, e.g. if the max basic leaf is 0xb but there is no</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">     * entry for CPUID.0xb.index (see below), then the output value for EDX</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">     * needs to be pulled from CPUID.0xb.1.</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    *fn_ptr = basic-&gt;eax;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">     * The class does not exist or the requested function is out of range;</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">     * the effective CPUID entry is the max basic leaf.  Note, the index of</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">     * the original requested leaf is observed!</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpuid_8c.html#a638557b30255883157acafa55a351d0d">kvm_find_cpuid_entry_index</a>(vcpu, basic-&gt;eax, index);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a638557b30255883157acafa55a351d0d"><div class="ttname"><a href="cpuid_8c.html#a638557b30255883157acafa55a351d0d">kvm_find_cpuid_entry_index</a></div><div class="ttdeci">struct kvm_cpuid_entry2 * kvm_find_cpuid_entry_index(struct kvm_vcpu *vcpu, u32 function, u32 index)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l01447">cpuid.c:1447</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a1d708985e548ee4ce6eee808a31d279c"><div class="ttname"><a href="kvm__emulate_8h.html#a1d708985e548ee4ce6eee808a31d279c">is_guest_vendor_hygon</a></div><div class="ttdeci">static bool is_guest_vendor_hygon(u32 ebx, u32 ecx, u32 edx)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00428">kvm_emulate.h:428</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_aaeb0a87b097a9164d79418139514f852"><div class="ttname"><a href="kvm__emulate_8h.html#aaeb0a87b097a9164d79418139514f852">is_guest_vendor_amd</a></div><div class="ttdeci">static bool is_guest_vendor_amd(u32 ebx, u32 ecx, u32 edx)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00418">kvm_emulate.h:418</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ac2fc42a3bfaa6a6d13a79e259561eba1_cgraph.png" border="0" usemap="#acpuid_8c_ac2fc42a3bfaa6a6d13a79e259561eba1_cgraph" alt=""/></div>
<map name="acpuid_8c_ac2fc42a3bfaa6a6d13a79e259561eba1_cgraph" id="acpuid_8c_ac2fc42a3bfaa6a6d13a79e259561eba1_cgraph">
<area shape="rect" title=" " alt="" coords="5,74,183,115"/>
<area shape="rect" href="kvm__emulate_8h.html#aaeb0a87b097a9164d79418139514f852" title=" " alt="" coords="236,5,400,32"/>
<area shape="rect" href="kvm__emulate_8h.html#a1d708985e548ee4ce6eee808a31d279c" title=" " alt="" coords="231,56,405,83"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="235,107,401,133"/>
<area shape="rect" href="cpuid_8c.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="235,158,401,199"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="453,136,591,163"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ac2fc42a3bfaa6a6d13a79e259561eba1_icgraph.png" border="0" usemap="#acpuid_8c_ac2fc42a3bfaa6a6d13a79e259561eba1_icgraph" alt=""/></div>
<map name="acpuid_8c_ac2fc42a3bfaa6a6d13a79e259561eba1_icgraph" id="acpuid_8c_ac2fc42a3bfaa6a6d13a79e259561eba1_icgraph">
<area shape="rect" title=" " alt="" coords="525,49,703,90"/>
<area shape="rect" href="cpuid_8c.html#a91d770d0af7358b6cd24b7cbe2617d73" title=" " alt="" coords="384,56,477,83"/>
<area shape="rect" href="x86_8c.html#a1cdade2bddd54648d9f5f61cf17dbf3f" title=" " alt="" coords="181,5,332,32"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,56,336,83"/>
<area shape="rect" href="cpuid_8c.html#a3650f2f078b9b3c62d58cd77e47ce3ab" title=" " alt="" coords="179,107,334,133"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,56,129,83"/>
</map>
</div>

</div>
</div>
<a id="afea420158d1fda2784dd4382763f258c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afea420158d1fda2784dd4382763f258c">&#9670;&nbsp;</a></span>kvm_check_cpuid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int kvm_check_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid_entry2 *&#160;</td>
          <td class="paramname"><em>entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00133">133</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *best;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    u64 xfeatures;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">     * The existing code assumes virtual address is 48-bit or 57-bit in the</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">     * canonical address checks; exit if it is ever changed.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    best = <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(entries, nent, 0x80000008,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                 <a class="code" href="cpuid_8c.html#aee2dec4877cb81413a6fa356c138464d">KVM_CPUID_INDEX_NOT_SIGNIFICANT</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (best) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordtype">int</span> vaddr_bits = (best-&gt;eax &amp; 0xff00) &gt;&gt; 8;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span> (vaddr_bits != 48 &amp;&amp; vaddr_bits != 57 &amp;&amp; vaddr_bits != 0)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">     * Exposing dynamic xfeatures to the guest requires additional</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">     * enabling in the FPU, e.g. to expand the guest XSAVE state size.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    best = <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(entries, nent, 0xd, 0);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (!best)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    xfeatures = best-&gt;eax | ((u64)best-&gt;edx &lt;&lt; 32);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    xfeatures &amp;= XFEATURE_MASK_USER_DYNAMIC;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span> (!xfeatures)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">return</span> fpu_enable_guest_xfd_features(&amp;vcpu-&gt;arch.guest_fpu, xfeatures);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_afea420158d1fda2784dd4382763f258c_cgraph.png" border="0" usemap="#acpuid_8c_afea420158d1fda2784dd4382763f258c_cgraph" alt=""/></div>
<map name="acpuid_8c_afea420158d1fda2784dd4382763f258c_cgraph" id="acpuid_8c_afea420158d1fda2784dd4382763f258c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,144,32"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="192,5,329,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_afea420158d1fda2784dd4382763f258c_icgraph.png" border="0" usemap="#acpuid_8c_afea420158d1fda2784dd4382763f258c_icgraph" alt=""/></div>
<map name="acpuid_8c_afea420158d1fda2784dd4382763f258c_icgraph" id="acpuid_8c_afea420158d1fda2784dd4382763f258c_icgraph">
<area shape="rect" title=" " alt="" coords="751,46,889,73"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="583,46,703,73"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="384,71,535,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,46,336,73"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,46,129,73"/>
</map>
</div>

</div>
</div>
<a id="a080099f5d91326fd1c8c10429df2d042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a080099f5d91326fd1c8c10429df2d042">&#9670;&nbsp;</a></span>kvm_cpu_cap_init_kvm_defined()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __always_inline void kvm_cpu_cap_init_kvm_defined </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19">kvm_only_cpuid_leafs</a>&#160;</td>
          <td class="paramname"><em>leaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00565">565</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;{</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">/* Use kvm_cpu_cap_mask for leafs that aren&#39;t KVM-only. */</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    BUILD_BUG_ON(leaf &lt; NCAPINTS);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    kvm_cpu_caps[leaf] = mask;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="cpuid_8c.html#ac97e11439f61d1a659b33cba3dc32abf">__kvm_cpu_cap_mask</a>(leaf);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_ac97e11439f61d1a659b33cba3dc32abf"><div class="ttname"><a href="cpuid_8c.html#ac97e11439f61d1a659b33cba3dc32abf">__kvm_cpu_cap_mask</a></div><div class="ttdeci">static __always_inline void __kvm_cpu_cap_mask(unsigned int leaf)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00551">cpuid.c:551</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a080099f5d91326fd1c8c10429df2d042_cgraph.png" border="0" usemap="#acpuid_8c_a080099f5d91326fd1c8c10429df2d042_cgraph" alt=""/></div>
<map name="acpuid_8c_a080099f5d91326fd1c8c10429df2d042_cgraph" id="acpuid_8c_a080099f5d91326fd1c8c10429df2d042_cgraph">
<area shape="rect" title=" " alt="" coords="5,49,180,90"/>
<area shape="rect" href="cpuid_8c.html#ac97e11439f61d1a659b33cba3dc32abf" title=" " alt="" coords="228,56,396,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="444,5,612,32"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="660,56,819,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="457,107,599,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="682,107,797,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="867,107,1015,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a080099f5d91326fd1c8c10429df2d042_icgraph.png" border="0" usemap="#acpuid_8c_a080099f5d91326fd1c8c10429df2d042_icgraph" alt=""/></div>
<map name="acpuid_8c_a080099f5d91326fd1c8c10429df2d042_icgraph" id="acpuid_8c_a080099f5d91326fd1c8c10429df2d042_icgraph">
<area shape="rect" title=" " alt="" coords="601,23,776,65"/>
<area shape="rect" href="cpuid_8c.html#ac4b31e077b5a352bd48a541ad53e3162" title=" " alt="" coords="408,31,553,57"/>
<area shape="rect" href="svm_8c.html#ab2ed2d9e233f1c6a1a3c806826d63401" title=" " alt="" coords="215,5,359,32"/>
<area shape="rect" href="vmx_8c.html#ad6f2c2fa1ea6270fe1b55ad7e770db38" title=" " alt="" coords="215,56,360,83"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
<area shape="rect" href="vmx_8c.html#a7cacd86bbd7f4ae2b8c9e5e8568fa5e4" title=" " alt="" coords="23,56,149,83"/>
</map>
</div>

</div>
</div>
<a id="a230e01b33626a01b4d37e8441e995938"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a230e01b33626a01b4d37e8441e995938">&#9670;&nbsp;</a></span>kvm_cpu_cap_mask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __always_inline void kvm_cpu_cap_mask </td>
          <td>(</td>
          <td class="paramtype">enum cpuid_leafs&#160;</td>
          <td class="paramname"><em>leaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00575">575</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;{</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">/* Use kvm_cpu_cap_init_kvm_defined for KVM-only leafs. */</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    BUILD_BUG_ON(leaf &gt;= NCAPINTS);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    kvm_cpu_caps[leaf] &amp;= mask;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="cpuid_8c.html#ac97e11439f61d1a659b33cba3dc32abf">__kvm_cpu_cap_mask</a>(leaf);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a230e01b33626a01b4d37e8441e995938_cgraph.png" border="0" usemap="#acpuid_8c_a230e01b33626a01b4d37e8441e995938_cgraph" alt=""/></div>
<map name="acpuid_8c_a230e01b33626a01b4d37e8441e995938_cgraph" id="acpuid_8c_a230e01b33626a01b4d37e8441e995938_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,160,83"/>
<area shape="rect" href="cpuid_8c.html#ac97e11439f61d1a659b33cba3dc32abf" title=" " alt="" coords="208,56,376,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="424,5,592,32"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="640,56,799,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="437,107,579,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="662,107,777,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="847,107,995,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a230e01b33626a01b4d37e8441e995938_icgraph.png" border="0" usemap="#acpuid_8c_a230e01b33626a01b4d37e8441e995938_icgraph" alt=""/></div>
<map name="acpuid_8c_a230e01b33626a01b4d37e8441e995938_icgraph" id="acpuid_8c_a230e01b33626a01b4d37e8441e995938_icgraph">
<area shape="rect" title=" " alt="" coords="601,31,756,57"/>
<area shape="rect" href="cpuid_8c.html#ac4b31e077b5a352bd48a541ad53e3162" title=" " alt="" coords="408,31,553,57"/>
<area shape="rect" href="svm_8c.html#ab2ed2d9e233f1c6a1a3c806826d63401" title=" " alt="" coords="215,5,359,32"/>
<area shape="rect" href="vmx_8c.html#ad6f2c2fa1ea6270fe1b55ad7e770db38" title=" " alt="" coords="215,56,360,83"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
<area shape="rect" href="vmx_8c.html#a7cacd86bbd7f4ae2b8c9e5e8568fa5e4" title=" " alt="" coords="23,56,149,83"/>
</map>
</div>

</div>
</div>
<a id="a91d770d0af7358b6cd24b7cbe2617d73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91d770d0af7358b6cd24b7cbe2617d73">&#9670;&nbsp;</a></span>kvm_cpuid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kvm_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>eax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>ebx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>ecx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>edx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>exact_only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l01531">1531</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;{</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    u32 orig_function = *eax, <span class="keyword">function</span> = *eax, index = *ecx;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *entry;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="keywordtype">bool</span> exact, used_max_basic = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    entry = <a class="code" href="cpuid_8c.html#a638557b30255883157acafa55a351d0d">kvm_find_cpuid_entry_index</a>(vcpu, <span class="keyword">function</span>, index);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    exact = !!entry;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordflow">if</span> (!entry &amp;&amp; !exact_only) {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        entry = <a class="code" href="cpuid_8c.html#ac2fc42a3bfaa6a6d13a79e259561eba1">get_out_of_range_cpuid_entry</a>(vcpu, &amp;<span class="keyword">function</span>, index);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        used_max_basic = !!entry;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">if</span> (entry) {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        *eax = entry-&gt;eax;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        *ebx = entry-&gt;ebx;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        *ecx = entry-&gt;ecx;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        *edx = entry-&gt;edx;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">function</span> == 7 &amp;&amp; index == 0) {</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            u64 data;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a69cd7a555054c4e390c588fb9da44dc9">__kvm_get_msr</a>(vcpu, MSR_IA32_TSX_CTRL, &amp;data, <span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                (data &amp; TSX_CTRL_CPUID_CLEAR))</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                *ebx &amp;= ~(<a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(RTM) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(HLE));</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">function</span> == 0x80000007) {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="hyperv_8h.html#a1bba1ca522177355266df250c2f7c3ec">kvm_hv_invtsc_suppressed</a>(vcpu))</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                *edx &amp;= ~<a class="code" href="cpuid_8c.html#a153ac3e954288b474182e1fb0c0f2a03">SF</a>(CONSTANT_TSC);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        *eax = *ebx = *ecx = *edx = 0;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">         * When leaf 0BH or 1FH is defined, CL is pass-through</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">         * and EDX is always the x2APIC ID, even for undefined</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">         * subleaves. Index 1 will exist iff the leaf is</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment">         * implemented, so we pass through CL iff leaf 1</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">         * exists. EDX can be copied from any existing index.</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">function</span> == 0xb || <span class="keyword">function</span> == 0x1f) {</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            entry = <a class="code" href="cpuid_8c.html#a638557b30255883157acafa55a351d0d">kvm_find_cpuid_entry_index</a>(vcpu, <span class="keyword">function</span>, 1);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;            <span class="keywordflow">if</span> (entry) {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                *ecx = index &amp; 0xff;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                *edx = entry-&gt;edx;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            }</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        }</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    trace_kvm_cpuid(orig_function, index, *eax, *ebx, *ecx, *edx, exact,</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            used_max_basic);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordflow">return</span> exact;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a153ac3e954288b474182e1fb0c0f2a03"><div class="ttname"><a href="cpuid_8c.html#a153ac3e954288b474182e1fb0c0f2a03">SF</a></div><div class="ttdeci">#define SF(name)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00067">cpuid.c:67</a></div></div>
<div class="ttc" id="acpuid_8c_html_ac2fc42a3bfaa6a6d13a79e259561eba1"><div class="ttname"><a href="cpuid_8c.html#ac2fc42a3bfaa6a6d13a79e259561eba1">get_out_of_range_cpuid_entry</a></div><div class="ttdeci">static struct kvm_cpuid_entry2 * get_out_of_range_cpuid_entry(struct kvm_vcpu *vcpu, u32 *fn_ptr, u32 index)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l01492">cpuid.c:1492</a></div></div>
<div class="ttc" id="ahyperv_8h_html_a1bba1ca522177355266df250c2f7c3ec"><div class="ttname"><a href="hyperv_8h.html#a1bba1ca522177355266df250c2f7c3ec">kvm_hv_invtsc_suppressed</a></div><div class="ttdeci">static bool kvm_hv_invtsc_suppressed(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="hyperv_8h_source.html#l00299">hyperv.h:299</a></div></div>
<div class="ttc" id="ax86_8c_html_a69cd7a555054c4e390c588fb9da44dc9"><div class="ttname"><a href="x86_8c.html#a69cd7a555054c4e390c588fb9da44dc9">__kvm_get_msr</a></div><div class="ttdeci">int __kvm_get_msr(struct kvm_vcpu *vcpu, u32 index, u64 *data, bool host_initiated)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01925">x86.c:1925</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a91d770d0af7358b6cd24b7cbe2617d73_cgraph.png" border="0" usemap="#acpuid_8c_a91d770d0af7358b6cd24b7cbe2617d73_cgraph" alt=""/></div>
<map name="acpuid_8c_a91d770d0af7358b6cd24b7cbe2617d73_cgraph" id="acpuid_8c_a91d770d0af7358b6cd24b7cbe2617d73_cgraph">
<area shape="rect" title=" " alt="" coords="5,228,99,255"/>
<area shape="rect" href="x86_8c.html#a69cd7a555054c4e390c588fb9da44dc9" title=" " alt="" coords="185,93,310,120"/>
<area shape="rect" href="cpuid_8c.html#ac2fc42a3bfaa6a6d13a79e259561eba1" title=" " alt="" coords="159,191,336,233"/>
<area shape="rect" href="cpuid_8c.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="401,273,566,314"/>
<area shape="rect" href="hyperv_8h.html#a1bba1ca522177355266df250c2f7c3ec" title=" " alt="" coords="147,308,348,335"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="418,69,549,96"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="883,5,989,32"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="619,95,804,121"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1275,56,1423,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1068,56,1227,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="852,56,1020,83"/>
<area shape="rect" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="853,158,1019,199"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="865,107,1007,133"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1079,224,1216,251"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1090,107,1205,133"/>
<area shape="rect" href="kvm__emulate_8h.html#aaeb0a87b097a9164d79418139514f852" title=" " alt="" coords="401,120,565,147"/>
<area shape="rect" href="kvm__emulate_8h.html#a1d708985e548ee4ce6eee808a31d279c" title=" " alt="" coords="396,171,571,197"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="629,223,794,249"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a91d770d0af7358b6cd24b7cbe2617d73_icgraph.png" border="0" usemap="#acpuid_8c_a91d770d0af7358b6cd24b7cbe2617d73_icgraph" alt=""/></div>
<map name="acpuid_8c_a91d770d0af7358b6cd24b7cbe2617d73_icgraph" id="acpuid_8c_a91d770d0af7358b6cd24b7cbe2617d73_icgraph">
<area shape="rect" title=" " alt="" coords="384,56,477,83"/>
<area shape="rect" href="x86_8c.html#a1cdade2bddd54648d9f5f61cf17dbf3f" title=" " alt="" coords="181,5,332,32"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,56,336,83"/>
<area shape="rect" href="cpuid_8c.html#a3650f2f078b9b3c62d58cd77e47ce3ab" title=" " alt="" coords="179,107,334,133"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,56,129,83"/>
</map>
</div>

</div>
</div>
<a id="a8f1b656d74e435fdceffcc2853a1c184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f1b656d74e435fdceffcc2853a1c184">&#9670;&nbsp;</a></span>kvm_cpuid_check_equal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int kvm_cpuid_check_equal </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid_entry2 *&#160;</td>
          <td class="paramname"><em>e2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00170">170</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *orig;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> (nent != vcpu-&gt;arch.cpuid_nent)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nent; i++) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        orig = &amp;vcpu-&gt;arch.cpuid_entries[i];</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">if</span> (e2[i].<span class="keyword">function</span> != orig-&gt;function ||</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            e2[i].index != orig-&gt;index ||</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            e2[i].flags != orig-&gt;flags ||</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            e2[i].eax != orig-&gt;eax || e2[i].ebx != orig-&gt;ebx ||</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            e2[i].ecx != orig-&gt;ecx || e2[i].edx != orig-&gt;edx)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a8f1b656d74e435fdceffcc2853a1c184_icgraph.png" border="0" usemap="#acpuid_8c_a8f1b656d74e435fdceffcc2853a1c184_icgraph" alt=""/></div>
<map name="acpuid_8c_a8f1b656d74e435fdceffcc2853a1c184_icgraph" id="acpuid_8c_a8f1b656d74e435fdceffcc2853a1c184_icgraph">
<area shape="rect" title=" " alt="" coords="751,46,932,73"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="583,46,703,73"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="384,71,535,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,46,336,73"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,46,129,73"/>
</map>
</div>

</div>
</div>
<a id="a7eb8299488a685437496d827e2ad9fb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb8299488a685437496d827e2ad9fb3">&#9670;&nbsp;</a></span>kvm_cpuid_has_hyperv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool kvm_cpuid_has_hyperv </td>
          <td>(</td>
          <td class="paramtype">struct kvm_cpuid_entry2 *&#160;</td>
          <td class="paramname"><em>entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00315">315</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">#ifdef CONFIG_KVM_HYPERV</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *entry;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    entry = <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(entries, nent, HYPERV_CPUID_INTERFACE,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                  <a class="code" href="cpuid_8c.html#aee2dec4877cb81413a6fa356c138464d">KVM_CPUID_INDEX_NOT_SIGNIFICANT</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">return</span> entry &amp;&amp; entry-&gt;eax == HYPERV_CPUID_SIGNATURE_EAX;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a7eb8299488a685437496d827e2ad9fb3_cgraph.png" border="0" usemap="#acpuid_8c_a7eb8299488a685437496d827e2ad9fb3_cgraph" alt=""/></div>
<map name="acpuid_8c_a7eb8299488a685437496d827e2ad9fb3_cgraph" id="acpuid_8c_a7eb8299488a685437496d827e2ad9fb3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="228,5,365,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a7eb8299488a685437496d827e2ad9fb3_icgraph.png" border="0" usemap="#acpuid_8c_a7eb8299488a685437496d827e2ad9fb3_icgraph" alt=""/></div>
<map name="acpuid_8c_a7eb8299488a685437496d827e2ad9fb3_icgraph" id="acpuid_8c_a7eb8299488a685437496d827e2ad9fb3_icgraph">
<area shape="rect" title=" " alt="" coords="952,46,1127,73"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="583,46,703,73"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="751,68,904,109"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="384,71,535,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,46,336,73"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,46,129,73"/>
</map>
</div>

</div>
</div>
<a id="ac74b10a6f6a1e67ef54c48e55473ff07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac74b10a6f6a1e67ef54c48e55473ff07">&#9670;&nbsp;</a></span>kvm_dev_ioctl_get_cpuid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_dev_ioctl_get_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_cpuid2 *&#160;</td>
          <td class="paramname"><em>cpuid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid_entry2 __user *&#160;</td>
          <td class="paramname"><em>entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l01404">1404</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;{</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> u32 funcs[] = {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        0, 0x80000000, <a class="code" href="cpuid_8c.html#a4d7a5e68dae710cd6f79a0379588f773">CENTAUR_CPUID_SIGNATURE</a>, KVM_CPUID_SIGNATURE,</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    };</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__cpuid__array.html">kvm_cpuid_array</a> array = {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        .<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a> = 0,</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    };</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordtype">int</span> r, i;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">if</span> (cpuid-&gt;nent &lt; 1)</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="keywordflow">return</span> -E2BIG;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordflow">if</span> (cpuid-&gt;nent &gt; KVM_MAX_CPUID_ENTRIES)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        cpuid-&gt;nent = KVM_MAX_CPUID_ENTRIES;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cpuid_8c.html#aebbe1f9459c214c3640d26457668476a">sanity_check_entries</a>(<a class="code" href="structkvm__cpuid__array.html#a0f69cb1cf1ca8b9e6dc3d05e9be947f2">entries</a>, cpuid-&gt;nent, type))</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    array.<a class="code" href="structkvm__cpuid__array.html#a0f69cb1cf1ca8b9e6dc3d05e9be947f2">entries</a> = kvcalloc(cpuid-&gt;nent, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> kvm_cpuid_entry2), GFP_KERNEL);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="keywordflow">if</span> (!array.<a class="code" href="structkvm__cpuid__array.html#a0f69cb1cf1ca8b9e6dc3d05e9be947f2">entries</a>)</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    array.<a class="code" href="structkvm__cpuid__array.html#a8f5df87c0238185d71b87449e9a0056a">maxnent</a> = cpuid-&gt;nent;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; ARRAY_SIZE(funcs); i++) {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        r = <a class="code" href="cpuid_8c.html#a1e952716ba7f46eb64f00d8a59c2be8d">get_cpuid_func</a>(&amp;array, funcs[i], type);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            <span class="keywordflow">goto</span> out_free;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    cpuid-&gt;nent = array.<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a>;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordflow">if</span> (copy_to_user(<a class="code" href="structkvm__cpuid__array.html#a0f69cb1cf1ca8b9e6dc3d05e9be947f2">entries</a>, array.<a class="code" href="structkvm__cpuid__array.html#a0f69cb1cf1ca8b9e6dc3d05e9be947f2">entries</a>,</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;             array.<a class="code" href="structkvm__cpuid__array.html#aa4a14410d9d895ae5b563366f4ed8450">nent</a> * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> kvm_cpuid_entry2)))</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        r = -EFAULT;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;out_free:</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    kvfree(array.<a class="code" href="structkvm__cpuid__array.html#a0f69cb1cf1ca8b9e6dc3d05e9be947f2">entries</a>);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a1e952716ba7f46eb64f00d8a59c2be8d"><div class="ttname"><a href="cpuid_8c.html#a1e952716ba7f46eb64f00d8a59c2be8d">get_cpuid_func</a></div><div class="ttdeci">static int get_cpuid_func(struct kvm_cpuid_array *array, u32 func, unsigned int type)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l01353">cpuid.c:1353</a></div></div>
<div class="ttc" id="acpuid_8c_html_aebbe1f9459c214c3640d26457668476a"><div class="ttname"><a href="cpuid_8c.html#aebbe1f9459c214c3640d26457668476a">sanity_check_entries</a></div><div class="ttdeci">static bool sanity_check_entries(struct kvm_cpuid_entry2 __user *entries, __u32 num_entries, unsigned int ioctl_type)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l01377">cpuid.c:1377</a></div></div>
<div class="ttc" id="astructkvm__cpuid__array_html"><div class="ttname"><a href="structkvm__cpuid__array.html">kvm_cpuid_array</a></div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00821">cpuid.c:821</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ac74b10a6f6a1e67ef54c48e55473ff07_cgraph.png" border="0" usemap="#acpuid_8c_ac74b10a6f6a1e67ef54c48e55473ff07_cgraph" alt=""/></div>
<map name="acpuid_8c_ac74b10a6f6a1e67ef54c48e55473ff07_cgraph" id="acpuid_8c_ac74b10a6f6a1e67ef54c48e55473ff07_cgraph">
<area shape="rect" title=" " alt="" coords="5,133,192,160"/>
<area shape="rect" href="cpuid_8c.html#a1e952716ba7f46eb64f00d8a59c2be8d" title=" " alt="" coords="259,108,379,135"/>
<area shape="rect" href="cpuid_8c.html#aebbe1f9459c214c3640d26457668476a" title=" " alt="" coords="240,159,399,185"/>
<area shape="rect" href="cpuid_8c.html#a652f54573475d1818402ab58329c340c" title=" " alt="" coords="447,108,561,135"/>
<area shape="rect" href="cpuid_8c.html#ac91da0391b283d7527a8b33206fe03dd" title=" " alt="" coords="644,145,773,172"/>
<area shape="rect" href="cpuid_8c.html#a62b781aedf96991bb95c97f5cf645a62" title=" " alt="" coords="609,69,808,96"/>
<area shape="rect" href="cpuid_8h.html#aac49cebef4a1bdd0996486028e64bbbd" title=" " alt="" coords="860,208,1019,235"/>
<area shape="rect" href="cpuid_8c.html#ae8aeecb8bfdee1a641e314a3605e6146" title=" " alt="" coords="882,107,997,133"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="869,56,1010,83"/>
<area shape="rect" href="x86_8h.html#aa3fd405bd522a08e3b5ccffbe8942a3c" title=" " alt="" coords="856,157,1023,184"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="861,259,1018,285"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="1071,208,1225,235"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1273,208,1441,235"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1286,157,1429,184"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1511,107,1626,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1489,56,1648,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1696,56,1844,83"/>
<area shape="rect" href="cpuid_8c.html#a10c9a4330804572330fe3b5f7eac9b07" title=" " alt="" coords="1087,107,1209,133"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="1079,56,1217,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1304,5,1411,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ac74b10a6f6a1e67ef54c48e55473ff07_icgraph.png" border="0" usemap="#acpuid_8c_ac74b10a6f6a1e67ef54c48e55473ff07_icgraph" alt=""/></div>
<map name="acpuid_8c_ac74b10a6f6a1e67ef54c48e55473ff07_icgraph" id="acpuid_8c_ac74b10a6f6a1e67ef54c48e55473ff07_icgraph">
<area shape="rect" title=" " alt="" coords="205,5,392,32"/>
<area shape="rect" href="x86_8c.html#a05ad3b4bc56bfbca86cf49699ca69f5f" title=" " alt="" coords="5,5,157,32"/>
</map>
</div>

</div>
</div>
<a id="a3650f2f078b9b3c62d58cd77e47ce3ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3650f2f078b9b3c62d58cd77e47ce3ab">&#9670;&nbsp;</a></span>kvm_emulate_cpuid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_emulate_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l01583">1583</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;{</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    u32 eax, ebx, ecx, edx;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#af84298b58b36ef9fc4198f2de91c2771">cpuid_fault_enabled</a>(vcpu) &amp;&amp; !<a class="code" href="x86_8c.html#ae70e1be8c50117c4f275becb32dd4159">kvm_require_cpl</a>(vcpu, 0))</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    eax = kvm_rax_read(vcpu);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    ecx = kvm_rcx_read(vcpu);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <a class="code" href="cpuid_8c.html#a91d770d0af7358b6cd24b7cbe2617d73">kvm_cpuid</a>(vcpu, &amp;eax, &amp;ebx, &amp;ecx, &amp;edx, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    kvm_rax_write(vcpu, eax);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    kvm_rbx_write(vcpu, ebx);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    kvm_rcx_write(vcpu, ecx);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    kvm_rdx_write(vcpu, edx);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a>(vcpu);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a91d770d0af7358b6cd24b7cbe2617d73"><div class="ttname"><a href="cpuid_8c.html#a91d770d0af7358b6cd24b7cbe2617d73">kvm_cpuid</a></div><div class="ttdeci">bool kvm_cpuid(struct kvm_vcpu *vcpu, u32 *eax, u32 *ebx, u32 *ecx, u32 *edx, bool exact_only)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l01531">cpuid.c:1531</a></div></div>
<div class="ttc" id="acpuid_8h_html_af84298b58b36ef9fc4198f2de91c2771"><div class="ttname"><a href="cpuid_8h.html#af84298b58b36ef9fc4198f2de91c2771">cpuid_fault_enabled</a></div><div class="ttdeci">static bool cpuid_fault_enabled(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00191">cpuid.h:191</a></div></div>
<div class="ttc" id="ax86_8c_html_aba69f77338abd9dcd861fd8921d5011a"><div class="ttname"><a href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a></div><div class="ttdeci">int kvm_skip_emulated_instruction(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l08916">x86.c:8916</a></div></div>
<div class="ttc" id="ax86_8c_html_ae70e1be8c50117c4f275becb32dd4159"><div class="ttname"><a href="x86_8c.html#ae70e1be8c50117c4f275becb32dd4159">kvm_require_cpl</a></div><div class="ttdeci">bool kvm_require_cpl(struct kvm_vcpu *vcpu, int required_cpl)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00840">x86.c:840</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a3650f2f078b9b3c62d58cd77e47ce3ab_cgraph.png" border="0" usemap="#acpuid_8c_a3650f2f078b9b3c62d58cd77e47ce3ab_cgraph" alt=""/></div>
<map name="acpuid_8c_a3650f2f078b9b3c62d58cd77e47ce3ab_cgraph" id="acpuid_8c_a3650f2f078b9b3c62d58cd77e47ce3ab_cgraph">
<area shape="rect" title=" " alt="" coords="5,456,160,483"/>
<area shape="rect" href="cpuid_8h.html#af84298b58b36ef9fc4198f2de91c2771" title=" " alt="" coords="247,351,400,377"/>
<area shape="rect" href="cpuid_8c.html#a91d770d0af7358b6cd24b7cbe2617d73" title=" " alt="" coords="277,401,370,428"/>
<area shape="rect" href="x86_8c.html#ae70e1be8c50117c4f275becb32dd4159" title=" " alt="" coords="258,481,389,508"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="208,576,439,603"/>
<area shape="rect" href="x86_8c.html#a69cd7a555054c4e390c588fb9da44dc9" title=" " alt="" coords="525,215,650,241"/>
<area shape="rect" href="cpuid_8c.html#ac2fc42a3bfaa6a6d13a79e259561eba1" title=" " alt="" coords="499,379,676,421"/>
<area shape="rect" href="cpuid_8c.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="745,321,911,362"/>
<area shape="rect" href="hyperv_8h.html#a1bba1ca522177355266df250c2f7c3ec" title=" " alt="" coords="487,445,688,472"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="763,157,893,184"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1014,56,1121,83"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="975,157,1160,184"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1253,5,1401,32"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1488,81,1647,108"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1243,157,1411,184"/>
<area shape="rect" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="1245,209,1410,250"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1256,107,1399,133"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1499,275,1636,301"/>
<area shape="rect" href="kvm__emulate_8h.html#aaeb0a87b097a9164d79418139514f852" title=" " alt="" coords="746,387,910,413"/>
<area shape="rect" href="kvm__emulate_8h.html#a1d708985e548ee4ce6eee808a31d279c" title=" " alt="" coords="741,437,915,464"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="985,273,1150,300"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="736,496,920,523"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="976,496,1159,523"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="1264,376,1391,403"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1267,427,1387,453"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="1240,478,1415,519"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="1228,544,1427,571"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="1243,595,1412,637"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="497,829,678,856"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="494,576,681,603"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="767,768,889,795"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="749,881,907,922"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="741,968,915,995"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="743,829,913,856"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="1282,763,1373,789"/>
<area shape="rect" href="pmu_8h.html#abbf4b99efff2cdd22398e2992085c36f" title=" " alt="" coords="968,966,1167,1007"/>
<area shape="rect" href="pmu_8c.html#af08b63fb7910be3ee65e8036b4e48aad" title=" " alt="" coords="979,813,1156,840"/>
<area shape="rect" href="pmu_8h.html#a156ede05e2f3b40ccf7a68f471f574b2" title=" " alt="" coords="974,864,1161,891"/>
<area shape="rect" href="pmu_8h.html#a276700643eefb3c6911a7ae0dc0e3809" title=" " alt="" coords="977,915,1158,941"/>
<area shape="rect" href="pmu_8c.html#aa6928ea92eba53de872c3bd3e966c3c6" title=" " alt="" coords="1241,813,1414,840"/>
<area shape="rect" href="pmu_8c.html#a6407f24f826977c89137761aae28662a" title=" " alt="" coords="1248,864,1407,891"/>
<area shape="rect" href="pmu_8h.html#ad8246d56b5d561e26e120ebcc9f2c2e7" title=" " alt="" coords="1215,915,1440,941"/>
<area shape="rect" href="pmu_8h.html#a121f90ace23861db2f644f0b36a08be6" title=" " alt="" coords="1274,965,1381,992"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="755,636,901,663"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="736,551,920,577"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="995,611,1140,637"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1005,661,1129,688"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1012,712,1123,739"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="1271,661,1383,688"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1240,712,1415,739"/>
</map>
</div>

</div>
</div>
<a id="aae0475609eefc48bb151ef5a631670c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae0475609eefc48bb151ef5a631670c0">&#9670;&nbsp;</a></span>kvm_find_cpuid_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kvm_cpuid_entry2* kvm_find_cpuid_entry </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l01455">1455</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;{</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(vcpu-&gt;arch.cpuid_entries, vcpu-&gt;arch.cpuid_nent,</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                 <span class="keyword">function</span>, <a class="code" href="cpuid_8c.html#aee2dec4877cb81413a6fa356c138464d">KVM_CPUID_INDEX_NOT_SIGNIFICANT</a>);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_aae0475609eefc48bb151ef5a631670c0_cgraph.png" border="0" usemap="#acpuid_8c_aae0475609eefc48bb151ef5a631670c0_cgraph" alt=""/></div>
<map name="acpuid_8c_aae0475609eefc48bb151ef5a631670c0_cgraph" id="acpuid_8c_aae0475609eefc48bb151ef5a631670c0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,171,32"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="219,5,356,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_aae0475609eefc48bb151ef5a631670c0_icgraph.png" border="0" usemap="#acpuid_8c_aae0475609eefc48bb151ef5a631670c0_icgraph" alt=""/></div>
<map name="acpuid_8c_aae0475609eefc48bb151ef5a631670c0_icgraph" id="acpuid_8c_aae0475609eefc48bb151ef5a631670c0_icgraph">
<area shape="rect" title=" " alt="" coords="1364,341,1529,367"/>
<area shape="rect" href="cpuid_8c.html#a881fc10bf62818799a56d9246f58b6cf" title=" " alt="" coords="1125,173,1316,199"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="902,68,1055,109"/>
<area shape="rect" href="cpuid_8c.html#ac2fc42a3bfaa6a6d13a79e259561eba1" title=" " alt="" coords="1132,224,1309,265"/>
<area shape="rect" href="cpuid_8h.html#adaefbcb7a479c2699345d74eb1fe3602" title=" " alt="" coords="1146,391,1295,418"/>
<area shape="rect" href="cpuid_8h.html#a5a6ba63d82eb4536c34fc156c7021193" title=" " alt="" coords="1143,5,1298,47"/>
<area shape="rect" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d" title=" " alt="" coords="1143,543,1298,570"/>
<area shape="rect" href="x86_8c.html#a2694456104c02a7204796d89d13a1e91" title=" " alt="" coords="681,442,811,469"/>
<area shape="rect" href="cpuid_8h.html#a000a8b4d5c33ede65d4a34091f93b934" title=" " alt="" coords="1147,341,1295,367"/>
<area shape="rect" href="pmu__intel_8c.html#aef55e73b4b7ac8d0841b17310fc92297" title=" " alt="" coords="676,341,816,367"/>
<area shape="rect" href="cpuid_8h.html#a986d59c8648488abee98cf60c8c3435f" title=" " alt="" coords="1139,661,1302,687"/>
<area shape="rect" href="hyperv_8c.html#a35fa0d5d0a982e559906372c42713c55" title=" " alt="" coords="1149,71,1292,98"/>
<area shape="rect" href="vmx_8c.html#a8cdfbbeaa7040fa24ebedf4c01d591ad" title=" " alt="" coords="1137,795,1304,836"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="1147,595,1294,636"/>
<area shape="rect" href="x86_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="433,265,605,291"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="177,265,377,291"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="686,75,806,102"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="443,57,594,99"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="443,123,594,164"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="198,189,357,215"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,358,129,385"/>
<area shape="rect" href="cpuid_8c.html#a91d770d0af7358b6cd24b7cbe2617d73" title=" " alt="" coords="932,235,1025,262"/>
<area shape="rect" href="x86_8c.html#a1cdade2bddd54648d9f5f61cf17dbf3f" title=" " alt="" coords="671,239,821,266"/>
<area shape="rect" href="cpuid_8c.html#a3650f2f078b9b3c62d58cd77e47ce3ab" title=" " alt="" coords="669,290,823,317"/>
<area shape="rect" href="svm_8c.html#a091db4f6d8d0fc811fdd6d9b2a775889" title=" " alt="" coords="923,391,1034,418"/>
<area shape="rect" href="x86_8c.html#ad0df6b04ae08eb6eec89da2d81e465cd" title=" " alt="" coords="917,543,1041,570"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="903,711,1054,752"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="670,769,822,811"/>
<area shape="rect" href="x86_8c.html#a0a47622bf3c21272e9e0357e1f90540a" title=" " alt="" coords="887,645,1071,687"/>
<area shape="rect" href="pmu_8c.html#a60270cb74533fe7721d3ae186abe70cf" title=" " alt="" coords="888,594,1069,621"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="924,493,1033,519"/>
<area shape="rect" href="x86_8c.html#a4a7acb17f522083e1a9edc95e3788295" title=" " alt="" coords="663,511,829,552"/>
<area shape="rect" href="x86_8c.html#aac5cbd832d05c55aa809421e883ea7b4" title=" " alt="" coords="470,391,567,418"/>
<area shape="rect" href="x86_8c.html#af472ca24da6c9cd65800b5fe67e4c506" title=" " alt="" coords="463,543,574,570"/>
<area shape="rect" href="x86_8c.html#a99cf4c7be0b4cac0886649c7da9daa66" title=" " alt="" coords="427,493,610,519"/>
<area shape="rect" href="lapic_8c.html#a27836a2bcd51ebcfe2ca478e9ad7aa04" title=" " alt="" coords="425,442,612,469"/>
<area shape="rect" href="svm_8c.html#a2ca2b108d5447ed4093cb0b07092b07d" title=" " alt="" coords="433,341,604,367"/>
<area shape="rect" href="x86_8c.html#a5eac8002ee5a0c08de662d89be4d6a11" title=" " alt="" coords="198,351,357,392"/>
<area shape="rect" href="x86_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="184,417,371,443"/>
<area shape="rect" href="x86_8c.html#a11b79dde650fe425e9b649e1463869be" title=" " alt="" coords="230,467,325,494"/>
<area shape="rect" href="x86_8c.html#a3361a1b517035bb0595ead223a3cb349" title=" " alt="" coords="209,543,346,570"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="703,718,789,745"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="455,718,583,745"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="660,645,832,687"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="427,653,610,679"/>
<area shape="rect" href="pmu_8c.html#a1569e2542115df7e6f996f60b9d63671" title=" " alt="" coords="673,594,819,621"/>
<area shape="rect" href="pmu_8c.html#a69682fb9bfcfffefbba01992cd24a8d4" title=" " alt="" coords="427,594,610,621"/>
<area shape="rect" href="cpuid_8h.html#ab99dc7d6bb2a01d43e47b5460139730a" title=" " alt="" coords="880,341,1077,367"/>
<area shape="rect" href="vmx_8c.html#a0fb610ce041405729e4296dfc871c30e" title=" " alt="" coords="691,391,801,418"/>
<area shape="rect" href="vmx_8c.html#a8ff77baa2f28fd717210bcac02a13434" title=" " alt="" coords="902,879,1055,920"/>
</map>
</div>

</div>
</div>
<a id="a638557b30255883157acafa55a351d0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a638557b30255883157acafa55a351d0d">&#9670;&nbsp;</a></span>kvm_find_cpuid_entry_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kvm_cpuid_entry2* kvm_find_cpuid_entry_index </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l01447">1447</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;{</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518">cpuid_entry2_find</a>(vcpu-&gt;arch.cpuid_entries, vcpu-&gt;arch.cpuid_nent,</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                 <span class="keyword">function</span>, index);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a638557b30255883157acafa55a351d0d_cgraph.png" border="0" usemap="#acpuid_8c_a638557b30255883157acafa55a351d0d_cgraph" alt=""/></div>
<map name="acpuid_8c_a638557b30255883157acafa55a351d0d_cgraph" id="acpuid_8c_a638557b30255883157acafa55a351d0d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,171,47"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="219,13,356,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a638557b30255883157acafa55a351d0d_icgraph.png" border="0" usemap="#acpuid_8c_a638557b30255883157acafa55a351d0d_icgraph" alt=""/></div>
<map name="acpuid_8c_a638557b30255883157acafa55a351d0d_icgraph" id="acpuid_8c_a638557b30255883157acafa55a351d0d_icgraph">
<area shape="rect" title=" " alt="" coords="1147,989,1312,1030"/>
<area shape="rect" href="sgx_8c.html#a2feaab00580c798dcee154b1798a674b" title=" " alt="" coords="915,652,1092,679"/>
<area shape="rect" href="svm_2pmu_8c.html#a3a6878daa6211de21b0ca114119eff4e" title=" " alt="" coords="462,157,602,184"/>
<area shape="rect" href="cpuid_8c.html#ac2fc42a3bfaa6a6d13a79e259561eba1" title=" " alt="" coords="680,105,857,146"/>
<area shape="rect" href="cpuid_8c.html#a91d770d0af7358b6cd24b7cbe2617d73" title=" " alt="" coords="253,56,346,83"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="911,971,1096,997"/>
<area shape="rect" href="pmu__intel_8c.html#aef55e73b4b7ac8d0841b17310fc92297" title=" " alt="" coords="933,1021,1073,1048"/>
<area shape="rect" href="xen_8c.html#adf531b186f63f085d94a6c47ab72f473" title=" " alt="" coords="908,1072,1099,1099"/>
<area shape="rect" href="vmx_8c.html#a8cdfbbeaa7040fa24ebedf4c01d591ad" title=" " alt="" coords="920,1801,1087,1842"/>
<area shape="rect" href="sgx_8c.html#a5f819c934ba32cfa58e874bb340f0142" title=" " alt="" coords="693,1501,844,1542"/>
<area shape="rect" href="vmx_8c.html#ad32f6ad8df8337d94ebb5d6a670853b5" title=" " alt="" coords="928,1368,1079,1395"/>
<area shape="rect" href="sgx_8c.html#a64209d7a6548174cb6fae30a7a26a194" title=" " alt="" coords="687,267,850,293"/>
<area shape="rect" href="sgx_8c.html#a34e5ee57c3e7c3172f8ae6ed981d703d" title=" " alt="" coords="246,644,353,671"/>
<area shape="rect" href="x86_8c.html#a1cdade2bddd54648d9f5f61cf17dbf3f" title=" " alt="" coords="9,5,160,32"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="5,56,164,83"/>
<area shape="rect" href="cpuid_8c.html#a3650f2f078b9b3c62d58cd77e47ce3ab" title=" " alt="" coords="7,107,162,133"/>
<area shape="rect" href="cpuid_8h.html#a48976a4bdb86fcec67d2563d193d7dcd" title=" " alt="" coords="699,971,838,997"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="703,1021,834,1048"/>
<area shape="rect" href="x86_8c.html#a69cd7a555054c4e390c588fb9da44dc9" title=" " alt="" coords="469,208,595,235"/>
<area shape="rect" href="hyperv_8c.html#a980a88832a98cf2bd5c4f0e3849cd445" title=" " alt="" coords="435,426,629,467"/>
<area shape="rect" href="x86_8c.html#ad0df6b04ae08eb6eec89da2d81e465cd" title=" " alt="" coords="470,492,594,519"/>
<area shape="rect" href="x86_8c.html#acca89d2d63dab117a3a766c7e549cf79" title=" " alt="" coords="463,543,601,569"/>
<area shape="rect" href="svm_2pmu_8c.html#afb9cd2ecbe0e74fc869e44c47a496cb9" title=" " alt="" coords="462,761,602,788"/>
<area shape="rect" href="x86_8c.html#a9e8ebbb82d5f2c8291f45a2426e07950" title=" " alt="" coords="439,812,625,839"/>
<area shape="rect" href="x86_8c.html#a7da5124273b0d08df1fe976ff3731ca9" title=" " alt="" coords="455,863,609,905"/>
<area shape="rect" href="x86_8c.html#af826c71b8cae72946605135bf8851586" title=" " alt="" coords="455,929,609,970"/>
<area shape="rect" href="smm_8c.html#a0943012ff008c7999f582998f0f9167a" title=" " alt="" coords="450,995,614,1021"/>
<area shape="rect" href="sgx_8c.html#ad8776272779cac650bff380210426a60" title=" " alt="" coords="459,695,605,737"/>
<area shape="rect" href="smm_8c.html#ae1445727a8459a6cc7d2e49e5a63c0d5" title=" " alt="" coords="484,1147,580,1173"/>
<area shape="rect" href="svm_2pmu_8c.html#ae983682a42d97c25309190b5aeab179e" title=" " alt="" coords="463,1197,601,1224"/>
<area shape="rect" href="cpuid_8h.html#a7d953eb2c52baf0364a2a26c6748ee94" title=" " alt="" coords="437,1248,627,1275"/>
<area shape="rect" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299" title=" " alt="" coords="212,1096,387,1123"/>
<area shape="rect" href="vmx_8c.html#a8ff77baa2f28fd717210bcac02a13434" title=" " alt="" coords="223,1885,376,1926"/>
<area shape="rect" href="cpuid_8h.html#ad24a5bcf0ff93dc56c64e6867b8a2415" title=" " alt="" coords="439,1299,625,1325"/>
<area shape="rect" href="vmx_8c.html#af3a69581bc36e5dd88f3c37334df214d" title=" " alt="" coords="472,1349,592,1376"/>
<area shape="rect" href="pmu__intel_8c.html#a732847faae93b3f95f904168b42add71" title=" " alt="" coords="462,1400,602,1427"/>
<area shape="rect" href="svm_8c.html#a6875c998376697a8776271bc88521721" title=" " alt="" coords="455,1451,609,1477"/>
<area shape="rect" href="lapic_8c.html#aaa6716cc0b30bec513d223fbfdecfdcf" title=" " alt="" coords="449,259,615,285"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="223,414,376,455"/>
<area shape="rect" href="x86_8c.html#a2aeff0b787a2133f4809c6a94c6458d7" title=" " alt="" coords="473,1501,591,1528"/>
<area shape="rect" href="x86_8c.html#ae479df43797527b1b530789ce8d7a31f" title=" " alt="" coords="447,1553,617,1594"/>
<area shape="rect" href="x86_8c.html#a0e93cb5e88dc8c07d9357181a3a7b2e9" title=" " alt="" coords="445,1619,619,1645"/>
<area shape="rect" href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0" title=" " alt="" coords="445,1801,619,1842"/>
<area shape="rect" href="lapic_8h.html#a9d9f2a266299bc56c932735db94816d5" title=" " alt="" coords="457,1096,607,1123"/>
<area shape="rect" href="vmx_2nested_8c.html#ab3fc0bd0d4a8fd0ee69e1b766c2d20aa" title=" " alt="" coords="435,1670,629,1711"/>
<area shape="rect" href="vmx_8c.html#aff701fc54eaf40f7e51be8ae81de8013" title=" " alt="" coords="451,1735,613,1777"/>
<area shape="rect" href="vmx_2nested_8c.html#ad680a323fa0378a55e97821505ba74b1" title=" " alt="" coords="455,309,609,336"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="447,361,617,402"/>
<area shape="rect" href="sgx_8c.html#a7f5682145e68a3283de02a0ac6a9e617" title=" " alt="" coords="439,1917,625,1944"/>
<area shape="rect" href="x86_8c.html#a6c4cf532744434dffd1685085eedbaff" title=" " alt="" coords="677,1072,860,1099"/>
</map>
</div>

</div>
</div>
<a id="a6d8deb4e45da8c580e5830057541fd8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d8deb4e45da8c580e5830057541fd8b">&#9670;&nbsp;</a></span>kvm_find_kvm_cpuid_features()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct kvm_cpuid_entry2* kvm_find_kvm_cpuid_features </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00232">232</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d">__kvm_find_kvm_cpuid_features</a>(vcpu, vcpu-&gt;arch.cpuid_entries,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                         vcpu-&gt;arch.cpuid_nent);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a6d8deb4e45da8c580e5830057541fd8b_cgraph.png" border="0" usemap="#acpuid_8c_a6d8deb4e45da8c580e5830057541fd8b_cgraph" alt=""/></div>
<map name="acpuid_8c_a6d8deb4e45da8c580e5830057541fd8b_cgraph" id="acpuid_8c_a6d8deb4e45da8c580e5830057541fd8b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,165,47"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="213,5,388,47"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="436,13,573,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a6d8deb4e45da8c580e5830057541fd8b_icgraph.png" border="0" usemap="#acpuid_8c_a6d8deb4e45da8c580e5830057541fd8b_icgraph" alt=""/></div>
<map name="acpuid_8c_a6d8deb4e45da8c580e5830057541fd8b_icgraph" id="acpuid_8c_a6d8deb4e45da8c580e5830057541fd8b_icgraph">
<area shape="rect" title=" " alt="" coords="1269,100,1429,141"/>
<area shape="rect" href="cpuid_8c.html#a30771fd4ef9230ee864f4d7ac9cf0514" title=" " alt="" coords="1037,107,1221,134"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="836,71,989,112"/>
<area shape="rect" href="x86_8c.html#acfafdbc1dfaad0bcc468d4b40e286234" title=" " alt="" coords="583,137,788,163"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="625,78,745,105"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="384,71,535,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,78,336,105"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,78,129,105"/>
</map>
</div>

</div>
</div>
<a id="ab855645f0756d3668a7a31696e95c218"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab855645f0756d3668a7a31696e95c218">&#9670;&nbsp;</a></span>kvm_get_hypervisor_cpuid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct kvm_hypervisor_cpuid kvm_get_hypervisor_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00170">170</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">struct </span>kvm_hypervisor_cpuid cpuid = {};</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *entry;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    u32 base;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    for_each_possible_hypervisor_cpuid_base(base) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        entry = <a class="code" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>(vcpu, base);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">if</span> (entry) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            u32 signature[3];</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            signature[0] = entry-&gt;ebx;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            signature[1] = entry-&gt;ecx;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            signature[2] = entry-&gt;edx;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">if</span> (!memcmp(signature, sig, <span class="keyword">sizeof</span>(signature))) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                cpuid.base = base;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                cpuid.limit = entry-&gt;eax;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">return</span> cpuid;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ab855645f0756d3668a7a31696e95c218_icgraph.png" border="0" usemap="#acpuid_8c_ab855645f0756d3668a7a31696e95c218_icgraph" alt=""/></div>
<map name="acpuid_8c_ab855645f0756d3668a7a31696e95c218_icgraph" id="acpuid_8c_ab855645f0756d3668a7a31696e95c218_icgraph">
<area shape="rect" title=" " alt="" coords="751,39,905,80"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="583,46,703,73"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="384,71,535,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,46,336,73"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,46,129,73"/>
</map>
</div>

</div>
</div>
<a id="ac4b31e077b5a352bd48a541ad53e3162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4b31e077b5a352bd48a541ad53e3162">&#9670;&nbsp;</a></span>kvm_set_cpu_caps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_set_cpu_caps </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00585">585</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;{</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="preprocessor">#ifdef CONFIG_X86_64</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f_gbpages = <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(GBPAGES);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f_lm = <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(LM);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f_xfd = <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XFD);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f_gbpages = 0;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f_lm = 0;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f_xfd = 0;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    memset(kvm_cpu_caps, 0, <span class="keyword">sizeof</span>(kvm_cpu_caps));</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    BUILD_BUG_ON(<span class="keyword">sizeof</span>(kvm_cpu_caps) - (<a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19aa06f8ebfff07ea82a59288cc5b12abb5">NKVMCAPINTS</a> * <span class="keyword">sizeof</span>(*kvm_cpu_caps)) &gt;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;             <span class="keyword">sizeof</span>(boot_cpu_data.x86_capability));</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    memcpy(&amp;kvm_cpu_caps, &amp;boot_cpu_data.x86_capability,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;           <span class="keyword">sizeof</span>(kvm_cpu_caps) - (<a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19aa06f8ebfff07ea82a59288cc5b12abb5">NKVMCAPINTS</a> * <span class="keyword">sizeof</span>(*kvm_cpu_caps)));</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_1_ECX,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">         * NOTE: MONITOR (and MWAIT) are emulated as NOP, but *not*</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">         * advertised to guests via CPUID!</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XMM3) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PCLMULQDQ) | 0 <span class="comment">/* DTES64, MONITOR */</span> |</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        0 <span class="comment">/* DS-CPL, VMX, SMX, EST */</span> |</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        0 <span class="comment">/* TM2 */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SSSE3) | 0 <span class="comment">/* CNXT-ID */</span> | 0 <span class="comment">/* Reserved */</span> |</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FMA) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CX16) | 0 <span class="comment">/* xTPR Update */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PDCM) |</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PCID) | 0 <span class="comment">/* Reserved, DCA */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XMM4_1) |</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XMM4_2) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(X2APIC) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MOVBE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(POPCNT) |</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        0 <span class="comment">/* Reserved*/</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AES) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XSAVE) | 0 <span class="comment">/* OSXSAVE */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX) |</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(F16C) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(RDRAND)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    );</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">/* KVM emulates x2apic in software irrespective of host support. */</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_X2APIC);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_1_EDX,</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FPU) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(VME) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(DE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PSE) |</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(TSC) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MSR) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PAE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MCE) |</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CX8) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(APIC) | 0 <span class="comment">/* Reserved */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SEP) |</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MTRR) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PGE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MCA) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CMOV) |</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PAT) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PSE36) | 0 <span class="comment">/* PSN */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CLFLUSH) |</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        0 <span class="comment">/* Reserved, DS, ACPI */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MMX) |</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FXSR) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XMM) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XMM2) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SELFSNOOP) |</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        0 <span class="comment">/* HTT, TM, Reserved, PBE */</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    );</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_7_0_EBX,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FSGSBASE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SGX) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(BMI1) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(HLE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX2) |</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FDP_EXCPTN_ONLY) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SMEP) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(BMI2) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(ERMS) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(INVPCID) |</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(RTM) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(ZERO_FCS_FDS) | 0 <span class="comment">/*MPX*/</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512F) |</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512DQ) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(RDSEED) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(ADX) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SMAP) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512IFMA) |</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CLFLUSHOPT) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CLWB) | 0 <span class="comment">/*INTEL_PT*/</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512PF) |</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512ER) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512CD) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SHA_NI) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512BW) |</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512VL));</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_7_ECX,</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512VBMI) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(LA57) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PKU) | 0 <span class="comment">/*OSPKE*/</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(RDPID) |</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512_VPOPCNTDQ) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(UMIP) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512_VBMI2) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(GFNI) |</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(VAES) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(VPCLMULQDQ) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512_VNNI) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512_BITALG) |</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CLDEMOTE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MOVDIRI) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MOVDIR64B) | 0 <span class="comment">/*WAITPKG*/</span> |</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SGX_LC) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(BUS_LOCK_DETECT)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    );</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">/* Set LA57 based on hardware capability. */</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span> (cpuid_ecx(7) &amp; <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(LA57))</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_LA57);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">     * PKU not yet implemented for shadow paging and requires OSPKE</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">     * to be set on the host. Clear it if that is not the case</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="mmu_8c.html#ab96cbfdb088c3659bfd6117823de8e30">tdp_enabled</a> || !boot_cpu_has(X86_FEATURE_OSPKE))</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <a class="code" href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198">kvm_cpu_cap_clear</a>(X86_FEATURE_PKU);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_7_EDX,</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512_4VNNIW) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512_4FMAPS) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SPEC_CTRL) |</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SPEC_CTRL_SSBD) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(ARCH_CAPABILITIES) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(INTEL_STIBP) |</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MD_CLEAR) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512_VP2INTERSECT) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FSRM) |</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SERIALIZE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(TSXLDTRK) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512_FP16) |</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMX_TILE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMX_INT8) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMX_BF16) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FLUSH_L1D)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    );</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">/* TSC_ADJUST and ARCH_CAPABILITIES are emulated in software. */</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_TSC_ADJUST);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_ARCH_CAPABILITIES);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_IBPB) &amp;&amp; boot_cpu_has(X86_FEATURE_IBRS))</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_SPEC_CTRL);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_STIBP))</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_INTEL_STIBP);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_AMD_SSBD))</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_SPEC_CTRL_SSBD);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_7_1_EAX,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX_VNNI) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX512_BF16) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CMPCCXADD) |</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FZRM) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FSRS) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FSRC) |</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMX_FP16) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX_IFMA) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(LAM)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    );</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <a class="code" href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042">kvm_cpu_cap_init_kvm_defined</a>(<a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a085e27ce32fc47622c4949f04d40e78f">CPUID_7_1_EDX</a>,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX_VNNI_INT8) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AVX_NE_CONVERT) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PREFETCHITI) |</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMX_COMPLEX)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    );</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042">kvm_cpu_cap_init_kvm_defined</a>(<a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a0ec53c71d8d1cd446493085c596e5ab3">CPUID_7_2_EDX</a>,</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(INTEL_PSFD) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(IPRED_CTRL) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(RRSBA_CTRL) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(DDPD_U) |</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(BHI_CTRL) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MCDT_NO)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    );</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_D_1_EAX,</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XSAVEOPT) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XSAVEC) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XGETBV1) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XSAVES) | f_xfd</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    );</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042">kvm_cpu_cap_init_kvm_defined</a>(<a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a776cec6b7fe0f8a28d7c6077a06069b8">CPUID_12_EAX</a>,</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <a class="code" href="cpuid_8c.html#a153ac3e954288b474182e1fb0c0f2a03">SF</a>(SGX1) | <a class="code" href="cpuid_8c.html#a153ac3e954288b474182e1fb0c0f2a03">SF</a>(SGX2) | <a class="code" href="cpuid_8c.html#a153ac3e954288b474182e1fb0c0f2a03">SF</a>(SGX_EDECCSSA)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    );</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_8000_0001_ECX,</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(LAHF_LM) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CMP_LEGACY) | 0 <span class="comment">/*SVM*/</span> | 0 <span class="comment">/* ExtApicSpace */</span> |</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CR8_LEGACY) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(ABM) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SSE4A) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MISALIGNSSE) |</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(3DNOWPREFETCH) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(OSVW) | 0 <span class="comment">/* IBS */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XOP) |</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        0 <span class="comment">/* SKINIT, WDT, LWP */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FMA4) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(TBM) |</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(TOPOEXT) | 0 <span class="comment">/* PERFCTR_CORE */</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    );</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_8000_0001_EDX,</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FPU) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(VME) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(DE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PSE) |</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(TSC) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MSR) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PAE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MCE) |</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CX8) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(APIC) | 0 <span class="comment">/* Reserved */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SYSCALL) |</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MTRR) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PGE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MCA) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CMOV) |</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PAT) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PSE36) | 0 <span class="comment">/* Reserved */</span> |</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(NX) | 0 <span class="comment">/* Reserved */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MMXEXT) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(MMX) |</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FXSR) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(FXSR_OPT) | f_gbpages | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(RDTSCP) |</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        0 <span class="comment">/* Reserved */</span> | f_lm | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(3DNOWEXT) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(3DNOW)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    );</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="mmu_8c.html#ab96cbfdb088c3659bfd6117823de8e30">tdp_enabled</a> &amp;&amp; IS_ENABLED(CONFIG_X86_64))</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_GBPAGES);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <a class="code" href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042">kvm_cpu_cap_init_kvm_defined</a>(<a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19aa1a99a294e8e48b11776432dd58965f1">CPUID_8000_0007_EDX</a>,</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <a class="code" href="cpuid_8c.html#a153ac3e954288b474182e1fb0c0f2a03">SF</a>(CONSTANT_TSC)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    );</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_8000_0008_EBX,</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(CLZERO) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XSAVEERPTR) |</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(WBNOINVD) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMD_IBPB) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMD_IBRS) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMD_SSBD) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(VIRT_SSBD) |</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMD_SSB_NO) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMD_STIBP) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMD_STIBP_ALWAYS_ON) |</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AMD_PSFD)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    );</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">     * AMD has separate bits for each SPEC_CTRL bit.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">     * arch/x86/kernel/cpu/bugs.c is kind enough to</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">     * record that in cpufeatures so use them.</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_IBPB))</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_AMD_IBPB);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_IBRS))</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_AMD_IBRS);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_STIBP))</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_AMD_STIBP);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_SPEC_CTRL_SSBD))</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_AMD_SSBD);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">if</span> (!boot_cpu_has_bug(X86_BUG_SPEC_STORE_BYPASS))</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_AMD_SSB_NO);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">     * The preference is to use SPEC CTRL MSR instead of the</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">     * VIRT_SPEC MSR.</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_LS_CFG_SSBD) &amp;&amp;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        !boot_cpu_has(X86_FEATURE_AMD_SSBD))</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_VIRT_SSBD);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">     * Hide all SVM features by default, SVM will set the cap bits for</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">     * features it emulates and/or exposes for L1.</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_8000_000A_EDX, 0);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_8000_001F_EAX,</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        0 <span class="comment">/* SME */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SEV) | 0 <span class="comment">/* VM_PAGE_FLUSH */</span> | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SEV_ES) |</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(SME_COHERENT));</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_8000_0021_EAX,</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(NO_NESTED_DATA_BP) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(LFENCE_RDTSC) | 0 <span class="comment">/* SmmPgCfgLock */</span> |</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(NULL_SEL_CLR_BASE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(AUTOIBRS) | 0 <span class="comment">/* PrefetchCtlMsr */</span> |</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(WRMSR_XX_BASE_NS)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    );</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="cpuid_8h.html#a267779506f2b7e74c16d026c5e5648f8">kvm_cpu_cap_check_and_set</a>(X86_FEATURE_SBPB);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="cpuid_8h.html#a267779506f2b7e74c16d026c5e5648f8">kvm_cpu_cap_check_and_set</a>(X86_FEATURE_IBPB_BRTYPE);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="cpuid_8h.html#a267779506f2b7e74c16d026c5e5648f8">kvm_cpu_cap_check_and_set</a>(X86_FEATURE_SRSO_NO);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <a class="code" href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042">kvm_cpu_cap_init_kvm_defined</a>(<a class="code" href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19a44639d9f82ec04b6276403d72b2ac0d9">CPUID_8000_0022_EAX</a>,</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PERFMON_V2)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    );</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">     * Synthesize &quot;LFENCE is serializing&quot; into the AMD-defined entry in</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">     * KVM&#39;s supported CPUID if the feature is reported as supported by the</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">     * kernel.  LFENCE_RDTSC was a Linux-defined synthetic feature long</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">     * before AMD joined the bandwagon, e.g. LFENCE is serializing on most</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">     * CPUs that support SSE2.  On CPUs that don&#39;t support AMD&#39;s leaf,</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">     * kvm_cpu_cap_mask() will unfortunately drop the flag due to ANDing</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">     * the mask with the raw host CPUID, and reporting support in AMD&#39;s</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">     * leaf can make it easier for userspace to detect the feature.</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">if</span> (cpu_feature_enabled(X86_FEATURE_LFENCE_RDTSC))</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_LFENCE_RDTSC);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">if</span> (!static_cpu_has_bug(X86_BUG_NULL_SEG))</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_NULL_SEL_CLR_BASE);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_NO_SMM_CTL_MSR);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <a class="code" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a>(CPUID_C000_0001_EDX,</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XSTORE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XSTORE_EN) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XCRYPT) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(XCRYPT_EN) |</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(ACE2) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(ACE2_EN) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PHE) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PHE_EN) |</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PMM) | <a class="code" href="cpuid_8c.html#a42257a545daf5b7933d6e8f96adc74f2">F</a>(PMM_EN)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    );</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">     * Hide RDTSCP and RDPID if either feature is reported as supported but</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">     * probing MSR_TSC_AUX failed.  This is purely a sanity check and</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">     * should never happen, but the guest will likely crash if RDTSCP or</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">     * RDPID is misreported, and KVM has botched MSR_TSC_AUX emulation in</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">     * the past.  For example, the sanity check may fire if this instance of</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">     * KVM is running as L1 on top of an older, broken KVM.</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">if</span> (WARN_ON((<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_RDTSCP) ||</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;             <a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_RDPID)) &amp;&amp;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;             !kvm_is_supported_user_return_msr(MSR_TSC_AUX))) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <a class="code" href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198">kvm_cpu_cap_clear</a>(X86_FEATURE_RDTSCP);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <a class="code" href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198">kvm_cpu_cap_clear</a>(X86_FEATURE_RDPID);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a080099f5d91326fd1c8c10429df2d042"><div class="ttname"><a href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042">kvm_cpu_cap_init_kvm_defined</a></div><div class="ttdeci">static __always_inline void kvm_cpu_cap_init_kvm_defined(enum kvm_only_cpuid_leafs leaf, u32 mask)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00565">cpuid.c:565</a></div></div>
<div class="ttc" id="acpuid_8c_html_a230e01b33626a01b4d37e8441e995938"><div class="ttname"><a href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938">kvm_cpu_cap_mask</a></div><div class="ttdeci">static __always_inline void kvm_cpu_cap_mask(enum cpuid_leafs leaf, u32 mask)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00575">cpuid.c:575</a></div></div>
<div class="ttc" id="acpuid_8h_html_a267779506f2b7e74c16d026c5e5648f8"><div class="ttname"><a href="cpuid_8h.html#a267779506f2b7e74c16d026c5e5648f8">kvm_cpu_cap_check_and_set</a></div><div class="ttdeci">static __always_inline void kvm_cpu_cap_check_and_set(unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00226">cpuid.h:226</a></div></div>
<div class="ttc" id="acpuid_8h_html_abdc65f0e23a3e84daece0c718bac6198"><div class="ttname"><a href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198">kvm_cpu_cap_clear</a></div><div class="ttdeci">static __always_inline void kvm_cpu_cap_clear(unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00197">cpuid.h:197</a></div></div>
<div class="ttc" id="acpuid_8h_html_aee66583565e70e231c1319604da3a201"><div class="ttname"><a href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a></div><div class="ttdeci">static __always_inline void kvm_cpu_cap_set(unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00205">cpuid.h:205</a></div></div>
<div class="ttc" id="areverse__cpuid_8h_html_a33165a02505466212d27a517cc779d19aa06f8ebfff07ea82a59288cc5b12abb5"><div class="ttname"><a href="reverse__cpuid_8h.html#a33165a02505466212d27a517cc779d19aa06f8ebfff07ea82a59288cc5b12abb5">NKVMCAPINTS</a></div><div class="ttdeci">@ NKVMCAPINTS</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00022">reverse_cpuid.h:22</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ac4b31e077b5a352bd48a541ad53e3162_cgraph.png" border="0" usemap="#acpuid_8c_ac4b31e077b5a352bd48a541ad53e3162_cgraph" alt=""/></div>
<map name="acpuid_8c_ac4b31e077b5a352bd48a541ad53e3162_cgraph" id="acpuid_8c_ac4b31e077b5a352bd48a541ad53e3162_cgraph">
<area shape="rect" title=" " alt="" coords="5,202,151,228"/>
<area shape="rect" href="cpuid_8h.html#a267779506f2b7e74c16d026c5e5648f8" title=" " alt="" coords="199,126,413,152"/>
<area shape="rect" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201" title=" " alt="" coords="476,75,615,102"/>
<area shape="rect" href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198" title=" " alt="" coords="470,151,621,178"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="235,227,377,254"/>
<area shape="rect" href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042" title=" " alt="" coords="219,278,393,320"/>
<area shape="rect" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938" title=" " alt="" coords="229,344,383,371"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="708,126,815,152"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="893,227,1052,254"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="915,75,1030,102"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1100,100,1248,127"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="476,227,615,254"/>
<area shape="rect" href="cpuid_8c.html#ac97e11439f61d1a659b33cba3dc32abf" title=" " alt="" coords="461,344,629,371"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="677,430,845,456"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="690,278,833,304"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ac4b31e077b5a352bd48a541ad53e3162_icgraph.png" border="0" usemap="#acpuid_8c_ac4b31e077b5a352bd48a541ad53e3162_icgraph" alt=""/></div>
<map name="acpuid_8c_ac4b31e077b5a352bd48a541ad53e3162_icgraph" id="acpuid_8c_ac4b31e077b5a352bd48a541ad53e3162_icgraph">
<area shape="rect" title=" " alt="" coords="408,31,553,57"/>
<area shape="rect" href="svm_8c.html#ab2ed2d9e233f1c6a1a3c806826d63401" title=" " alt="" coords="215,5,359,32"/>
<area shape="rect" href="vmx_8c.html#ad6f2c2fa1ea6270fe1b55ad7e770db38" title=" " alt="" coords="215,56,360,83"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
<area shape="rect" href="vmx_8c.html#a7cacd86bbd7f4ae2b8c9e5e8568fa5e4" title=" " alt="" coords="23,56,149,83"/>
</map>
</div>

</div>
</div>
<a id="a0ff60eac33c1bf95a3889674e34251ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ff60eac33c1bf95a3889674e34251ad">&#9670;&nbsp;</a></span>kvm_set_cpuid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int kvm_set_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid_entry2 *&#160;</td>
          <td class="paramname"><em>e2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00414">414</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;{</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294">__kvm_update_cpuid_runtime</a>(vcpu, e2, nent);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">     * KVM does not correctly handle changing guest CPUID after KVM_RUN, as</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">     * MAXPHYADDR, GBPAGES support, AMD reserved bit behavior, etc.. aren&#39;t</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">     * tracked in kvm_mmu_page_role.  As a result, KVM may miss guest page</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">     * faults due to reusing SPs/SPTEs. In practice no sane VMM mucks with</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">     * the core vCPU model on the fly. It would&#39;ve been better to forbid any</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">     * KVM_SET_CPUID{,2} calls after KVM_RUN altogether but unfortunately</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">     * some VMMs (e.g. QEMU) reuse vCPU fds for CPU hotplug/unplug and do</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">     * KVM_SET_CPUID{,2} again. To support this legacy behavior, check</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">     * whether the supplied CPUID data is equal to what&#39;s already set.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#abf05d82904db21951117acb30ddf9c37">kvm_vcpu_has_run</a>(vcpu)) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        r = <a class="code" href="cpuid_8c.html#a8f1b656d74e435fdceffcc2853a1c184">kvm_cpuid_check_equal</a>(vcpu, e2, nent);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        kvfree(e2);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">#ifdef CONFIG_KVM_HYPERV</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cpuid_8c.html#a7eb8299488a685437496d827e2ad9fb3">kvm_cpuid_has_hyperv</a>(e2, nent)) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        r = <a class="code" href="hyperv_8c.html#a6b9b9a8864c87d56aa2c400fa1331b0b">kvm_hv_vcpu_init</a>(vcpu);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    r = <a class="code" href="cpuid_8c.html#afea420158d1fda2784dd4382763f258c">kvm_check_cpuid</a>(vcpu, e2, nent);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    kvfree(vcpu-&gt;arch.cpuid_entries);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    vcpu-&gt;arch.cpuid_entries = e2;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    vcpu-&gt;arch.cpuid_nent = nent;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    vcpu-&gt;arch.kvm_cpuid = <a class="code" href="cpuid_8c.html#ab855645f0756d3668a7a31696e95c218">kvm_get_hypervisor_cpuid</a>(vcpu, KVM_SIGNATURE);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="preprocessor">#ifdef CONFIG_KVM_XEN</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    vcpu-&gt;arch.xen.cpuid = <a class="code" href="cpuid_8c.html#ab855645f0756d3668a7a31696e95c218">kvm_get_hypervisor_cpuid</a>(vcpu, XEN_SIGNATURE);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618">kvm_vcpu_after_set_cpuid</a>(vcpu);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a7eb8299488a685437496d827e2ad9fb3"><div class="ttname"><a href="cpuid_8c.html#a7eb8299488a685437496d827e2ad9fb3">kvm_cpuid_has_hyperv</a></div><div class="ttdeci">static bool kvm_cpuid_has_hyperv(struct kvm_cpuid_entry2 *entries, int nent)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00315">cpuid.c:315</a></div></div>
<div class="ttc" id="acpuid_8c_html_a8f1b656d74e435fdceffcc2853a1c184"><div class="ttname"><a href="cpuid_8c.html#a8f1b656d74e435fdceffcc2853a1c184">kvm_cpuid_check_equal</a></div><div class="ttdeci">static int kvm_cpuid_check_equal(struct kvm_vcpu *vcpu, struct kvm_cpuid_entry2 *e2, int nent)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00170">cpuid.c:170</a></div></div>
<div class="ttc" id="acpuid_8c_html_ab855645f0756d3668a7a31696e95c218"><div class="ttname"><a href="cpuid_8c.html#ab855645f0756d3668a7a31696e95c218">kvm_get_hypervisor_cpuid</a></div><div class="ttdeci">static struct kvm_hypervisor_cpuid kvm_get_hypervisor_cpuid(struct kvm_vcpu *vcpu, const char *sig)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00170">cpuid.c:192</a></div></div>
<div class="ttc" id="acpuid_8c_html_aba2a2f99dbe3b8848b6ffc19effa6294"><div class="ttname"><a href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294">__kvm_update_cpuid_runtime</a></div><div class="ttdeci">static void __kvm_update_cpuid_runtime(struct kvm_vcpu *vcpu, struct kvm_cpuid_entry2 *entries, int nent)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00265">cpuid.c:265</a></div></div>
<div class="ttc" id="acpuid_8c_html_ae8f7489a3e05a9bcd5dfdae82c33d618"><div class="ttname"><a href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618">kvm_vcpu_after_set_cpuid</a></div><div class="ttdeci">static void kvm_vcpu_after_set_cpuid(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00328">cpuid.c:328</a></div></div>
<div class="ttc" id="acpuid_8c_html_afea420158d1fda2784dd4382763f258c"><div class="ttname"><a href="cpuid_8c.html#afea420158d1fda2784dd4382763f258c">kvm_check_cpuid</a></div><div class="ttdeci">static int kvm_check_cpuid(struct kvm_vcpu *vcpu, struct kvm_cpuid_entry2 *entries, int nent)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00133">cpuid.c:133</a></div></div>
<div class="ttc" id="ahyperv_8c_html_a6b9b9a8864c87d56aa2c400fa1331b0b"><div class="ttname"><a href="hyperv_8c.html#a6b9b9a8864c87d56aa2c400fa1331b0b">kvm_hv_vcpu_init</a></div><div class="ttdeci">int kvm_hv_vcpu_init(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="hyperv_8c_source.html#l00960">hyperv.c:960</a></div></div>
<div class="ttc" id="ax86_8h_html_abf05d82904db21951117acb30ddf9c37"><div class="ttname"><a href="x86_8h.html#abf05d82904db21951117acb30ddf9c37">kvm_vcpu_has_run</a></div><div class="ttdeci">static bool kvm_vcpu_has_run(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00095">x86.h:95</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a0ff60eac33c1bf95a3889674e34251ad_cgraph.png" border="0" usemap="#acpuid_8c_a0ff60eac33c1bf95a3889674e34251ad_cgraph" alt=""/></div>
<map name="acpuid_8c_a0ff60eac33c1bf95a3889674e34251ad_cgraph" id="acpuid_8c_a0ff60eac33c1bf95a3889674e34251ad_cgraph">
<area shape="rect" title=" " alt="" coords="5,865,125,892"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="185,201,343,242"/>
<area shape="rect" href="cpuid_8c.html#afea420158d1fda2784dd4382763f258c" title=" " alt="" coords="916,1389,1055,1416"/>
<area shape="rect" href="cpuid_8c.html#a8f1b656d74e435fdceffcc2853a1c184" title=" " alt="" coords="173,773,355,800"/>
<area shape="rect" href="cpuid_8c.html#a7eb8299488a685437496d827e2ad9fb3" title=" " alt="" coords="415,1237,590,1264"/>
<area shape="rect" href="cpuid_8c.html#ab855645f0756d3668a7a31696e95c218" title=" " alt="" coords="187,890,341,931"/>
<area shape="rect" href="hyperv_8c.html#a6b9b9a8864c87d56aa2c400fa1331b0b" title=" " alt="" coords="194,411,334,437"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="187,825,341,866"/>
<area shape="rect" href="x86_8h.html#abf05d82904db21951117acb30ddf9c37" title=" " alt="" coords="673,1288,819,1315"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="898,454,1073,495"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1129,731,1267,757"/>
<area shape="rect" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4" title=" " alt="" coords="670,259,822,285"/>
<area shape="rect" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826" title=" " alt="" coords="439,461,567,488"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="419,107,586,133"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="434,157,571,184"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="429,56,576,83"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="424,5,581,32"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="932,520,1039,547"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="908,331,1063,357"/>
<area shape="rect" href="reverse__cpuid_8h.html#a5c0c9322094b13d5fff76b5ab593339a" title=" " alt="" coords="683,461,809,488"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="673,56,819,83"/>
<area shape="rect" href="hyperv_8c.html#ad212ee2bcf02cad45e2911fdb7d31861" title=" " alt="" coords="457,411,549,437"/>
<area shape="rect" href="hyperv_8c.html#acb0df6ea627c64fe5fe88dc5a52d648e" title=" " alt="" coords="461,360,545,387"/>
<area shape="rect" href="hyperv_8c.html#a053c0a6cdb6becc46a74a7b69fe791eb" title=" " alt="" coords="668,360,824,387"/>
<area shape="rect" href="hyperv_8c.html#affaae94ac35c1a1ea573e2f1014ea259" title=" " alt="" coords="663,411,829,437"/>
<area shape="rect" href="cpuid_8c.html#ab09a1700616790a1bd47e46825c5012b" title=" " alt="" coords="889,731,1081,757"/>
<area shape="rect" href="cpuid_8c.html#a881fc10bf62818799a56d9246f58b6cf" title=" " alt="" coords="407,563,598,589"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="663,512,829,539"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="681,680,811,707"/>
<area shape="rect" href="cpuid_8h.html#a5a6ba63d82eb4536c34fc156c7021193" title=" " alt="" coords="425,883,580,925"/>
<area shape="rect" href="lapic_8c.html#aaa6716cc0b30bec513d223fbfdecfdcf" title=" " alt="" coords="419,949,586,976"/>
<area shape="rect" href="cpuid_8h.html#a898d2d1ac4ac03c41e5bb2ebd1402ac0" title=" " alt="" coords="403,1085,603,1112"/>
<area shape="rect" href="hyperv_8c.html#a35fa0d5d0a982e559906372c42713c55" title=" " alt="" coords="431,512,574,539"/>
<area shape="rect" href="mmu_8c.html#a3b03fb05a1055f336fa61182cf0c760b" title=" " alt="" coords="403,1136,602,1163"/>
<area shape="rect" href="pmu_8c.html#a6d6bf5af13e5325bcfc07034b4d06e6c" title=" " alt="" coords="433,1187,573,1213"/>
<area shape="rect" href="cpuid_8c.html#a30771fd4ef9230ee864f4d7ac9cf0514" title=" " alt="" coords="411,664,595,691"/>
<area shape="rect" href="cpuid_8c.html#a8bf272b370f8a27bb68bf5bf9e5ae7d5" title=" " alt="" coords="411,715,595,757"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="893,680,1078,707"/>
<area shape="rect" href="kvm__emulate_8h.html#aaeb0a87b097a9164d79418139514f852" title=" " alt="" coords="664,832,828,859"/>
<area shape="rect" href="kvm__emulate_8h.html#a1d708985e548ee4ce6eee808a31d279c" title=" " alt="" coords="659,883,833,909"/>
<area shape="rect" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="903,781,1068,808"/>
<area shape="rect" href="ioapic_8h.html#a5efb8a822bd7119cfc8db075f12bf452" title=" " alt="" coords="683,933,809,960"/>
<area shape="rect" href="lapic_8c.html#ab2ee275fa1bc17aa0bfde435723b8f48" title=" " alt="" coords="674,984,818,1011"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="687,1035,805,1061"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="899,1103,1072,1145"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="651,1136,841,1163"/>
<area shape="rect" href="mmu_8c.html#a56f1568115a55fdacc188e9b41159b8f" title=" " alt="" coords="652,1187,840,1213"/>
<area shape="rect" href="pmu_8c.html#af2e9d984d1cd90e3f5d7e484a6bab422" title=" " alt="" coords="683,1237,809,1264"/>
<area shape="rect" href="cpuid_8c.html#a6d8deb4e45da8c580e5830057541fd8b" title=" " alt="" coords="666,563,826,605"/>
<area shape="rect" href="cpuid_8h.html#a1678e00b10264045277c1abfcb6eec3e" title=" " alt="" coords="673,629,819,656"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a0ff60eac33c1bf95a3889674e34251ad_icgraph.png" border="0" usemap="#acpuid_8c_a0ff60eac33c1bf95a3889674e34251ad_icgraph" alt=""/></div>
<map name="acpuid_8c_a0ff60eac33c1bf95a3889674e34251ad_icgraph" id="acpuid_8c_a0ff60eac33c1bf95a3889674e34251ad_icgraph">
<area shape="rect" title=" " alt="" coords="583,46,703,73"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="384,71,535,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,46,336,73"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,46,129,73"/>
</map>
</div>

</div>
</div>
<a id="a537512099e11c7ab0553aeae5e38d9ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a537512099e11c7ab0553aeae5e38d9ea">&#9670;&nbsp;</a></span>kvm_update_cpuid_runtime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_update_cpuid_runtime </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00309">309</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;{</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294">__kvm_update_cpuid_runtime</a>(vcpu, vcpu-&gt;arch.cpuid_entries, vcpu-&gt;arch.cpuid_nent);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a537512099e11c7ab0553aeae5e38d9ea_cgraph.png" border="0" usemap="#acpuid_8c_a537512099e11c7ab0553aeae5e38d9ea_cgraph" alt=""/></div>
<map name="acpuid_8c_a537512099e11c7ab0553aeae5e38d9ea_cgraph" id="acpuid_8c_a537512099e11c7ab0553aeae5e38d9ea_cgraph">
<area shape="rect" title=" " alt="" coords="5,185,208,212"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="256,178,415,219"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="463,43,637,85"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="693,21,830,48"/>
<area shape="rect" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4" title=" " alt="" coords="685,160,837,187"/>
<area shape="rect" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826" title=" " alt="" coords="486,109,614,136"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="467,211,633,237"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="481,261,619,288"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="477,312,623,339"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="471,363,629,389"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1157,160,1264,187"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="905,84,1059,111"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1549,109,1697,136"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1343,109,1501,136"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1127,109,1295,136"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1139,59,1282,85"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1365,59,1479,85"/>
<area shape="rect" href="reverse__cpuid_8h.html#a5c0c9322094b13d5fff76b5ab593339a" title=" " alt="" coords="698,109,825,136"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="689,312,834,339"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="885,312,1079,339"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a537512099e11c7ab0553aeae5e38d9ea_icgraph.png" border="0" usemap="#acpuid_8c_a537512099e11c7ab0553aeae5e38d9ea_icgraph" alt=""/></div>
<map name="acpuid_8c_a537512099e11c7ab0553aeae5e38d9ea_icgraph" id="acpuid_8c_a537512099e11c7ab0553aeae5e38d9ea_icgraph">
<area shape="rect" title=" " alt="" coords="1844,483,2047,509"/>
<area shape="rect" href="x86_8c.html#a8543429a9ca5c6d3d88560ccd84bbccd" title=" " alt="" coords="1423,123,1542,149"/>
<area shape="rect" href="smm_8c.html#ae1445727a8459a6cc7d2e49e5a63c0d5" title=" " alt="" coords="1658,483,1754,509"/>
<area shape="rect" href="lapic_8c.html#a8d747385873e52f47e85179c21521e73" title=" " alt="" coords="1629,265,1783,292"/>
<area shape="rect" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299" title=" " alt="" coords="1152,392,1327,419"/>
<area shape="rect" href="sev_8c.html#aeb0279b2cc9c76c69ffcca8eb578b33f" title=" " alt="" coords="1616,537,1796,564"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="1654,661,1758,688"/>
<area shape="rect" href="vmx_8c.html#adda41e5ad7d9839a1fd3e01efc608c37" title=" " alt="" coords="1653,864,1759,891"/>
<area shape="rect" href="x86_8c.html#aa5087b536be3ec29dc352f8062f744f5" title=" " alt="" coords="1172,123,1307,149"/>
<area shape="rect" href="x86_8c.html#ab9b558d7e5dcf9150cf853e009cce971" title=" " alt="" coords="1158,5,1321,32"/>
<area shape="rect" href="x86_8c.html#a388b875e496f0b87b5c551430b8cf436" title=" " alt="" coords="1162,57,1317,98"/>
<area shape="rect" href="x86_8c.html#a2694456104c02a7204796d89d13a1e91" title=" " alt="" coords="1175,240,1304,267"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="895,88,1053,115"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,181,129,208"/>
<area shape="rect" href="lapic_8c.html#a27836a2bcd51ebcfe2ca478e9ad7aa04" title=" " alt="" coords="881,240,1067,267"/>
<area shape="rect" href="x86_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="888,139,1060,165"/>
<area shape="rect" href="svm_8c.html#a2ca2b108d5447ed4093cb0b07092b07d" title=" " alt="" coords="889,189,1059,216"/>
<area shape="rect" href="x86_8c.html#a5eac8002ee5a0c08de662d89be4d6a11" title=" " alt="" coords="412,174,571,215"/>
<area shape="rect" href="x86_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,240,364,267"/>
<area shape="rect" href="x86_8c.html#a11b79dde650fe425e9b649e1463869be" title=" " alt="" coords="671,291,766,317"/>
<area shape="rect" href="x86_8c.html#a3361a1b517035bb0595ead223a3cb349" title=" " alt="" coords="650,341,787,368"/>
<area shape="rect" href="x86_8c.html#ae90d8433a234fc6ee73cd19322f11ada" title=" " alt="" coords="451,291,532,317"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="619,139,819,165"/>
<area shape="rect" href="x86_8c.html#a2b372d06c72b7d8c25e9004bb3a3fd3b" title=" " alt="" coords="1397,475,1568,517"/>
<area shape="rect" href="lapic_8c.html#a4768d4990380510ec220c3e510d32598" title=" " alt="" coords="1407,185,1559,212"/>
<area shape="rect" href="lapic_8c.html#a8b8a5d87df5283a20e9aa9b828320552" title=" " alt="" coords="1418,240,1547,267"/>
<area shape="rect" href="lapic_8h.html#a9d9f2a266299bc56c932735db94816d5" title=" " alt="" coords="1407,291,1558,317"/>
<area shape="rect" href="x86_8c.html#a4426192bd0d8288db892f9fcbf4577b9" title=" " alt="" coords="1164,174,1315,215"/>
<area shape="rect" href="x86_8c.html#ad6dd5b8847ecb92fe36f8dabdac40b08" title=" " alt="" coords="1158,291,1321,317"/>
<area shape="rect" href="x86_8c.html#ac766943d4a9d3c7a489012c02e25be54" title=" " alt="" coords="925,291,1023,317"/>
<area shape="rect" href="svm_8c.html#acb46126747f78036462437a7bcdc2e47" title=" " alt="" coords="933,443,1015,469"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="919,341,1029,368"/>
<area shape="rect" href="vmx_8c.html#a0fb610ce041405729e4296dfc871c30e" title=" " alt="" coords="919,392,1029,419"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="1404,541,1561,568"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1206,763,1273,789"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1162,661,1317,688"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1129,712,1349,739"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="1431,712,1535,739"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="878,779,1070,805"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="867,545,1081,586"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="872,611,1076,637"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="871,661,1077,688"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="643,855,794,881"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="883,713,1065,754"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="885,880,1063,907"/>
<area shape="rect" href="vmx_2nested_8c.html#a06a397c328d1656bb4d3ab073878e6f0" title=" " alt="" coords="1148,948,1331,975"/>
<area shape="rect" href="vmx_2nested_8c.html#a001f930db9a867e828cf01b48d3e4e25" title=" " alt="" coords="1162,831,1317,873"/>
<area shape="rect" href="vmx_2nested_8c.html#a27bdf4f6bbd476189cb0198a634394f5" title=" " alt="" coords="1174,897,1305,924"/>
<area shape="rect" href="vmx_8c.html#acf9f5acdb0b2a5b2778c853846cfa09f" title=" " alt="" coords="1430,915,1535,941"/>
<area shape="rect" href="vmx_2nested_8c.html#ad680a323fa0378a55e97821505ba74b1" title=" " alt="" coords="897,939,1051,965"/>
</map>
</div>

</div>
</div>
<a id="a30771fd4ef9230ee864f4d7ac9cf0514"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30771fd4ef9230ee864f4d7ac9cf0514">&#9670;&nbsp;</a></span>kvm_update_pv_runtime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_update_pv_runtime </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00238">238</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *best = <a class="code" href="cpuid_8c.html#a6d8deb4e45da8c580e5830057541fd8b">kvm_find_kvm_cpuid_features</a>(vcpu);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">     * save the feature bitmap to avoid cpuid lookup for every PV</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">     * operation</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> (best)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        vcpu-&gt;arch.pv_cpuid.features = best-&gt;eax;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a6d8deb4e45da8c580e5830057541fd8b"><div class="ttname"><a href="cpuid_8c.html#a6d8deb4e45da8c580e5830057541fd8b">kvm_find_kvm_cpuid_features</a></div><div class="ttdeci">static struct kvm_cpuid_entry2 * kvm_find_kvm_cpuid_features(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00232">cpuid.c:232</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a30771fd4ef9230ee864f4d7ac9cf0514_cgraph.png" border="0" usemap="#acpuid_8c_a30771fd4ef9230ee864f4d7ac9cf0514_cgraph" alt=""/></div>
<map name="acpuid_8c_a30771fd4ef9230ee864f4d7ac9cf0514_cgraph" id="acpuid_8c_a30771fd4ef9230ee864f4d7ac9cf0514_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,189,39"/>
<area shape="rect" href="cpuid_8c.html#a6d8deb4e45da8c580e5830057541fd8b" title=" " alt="" coords="237,5,397,47"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="445,5,620,47"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="668,13,805,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a30771fd4ef9230ee864f4d7ac9cf0514_icgraph.png" border="0" usemap="#acpuid_8c_a30771fd4ef9230ee864f4d7ac9cf0514_icgraph" alt=""/></div>
<map name="acpuid_8c_a30771fd4ef9230ee864f4d7ac9cf0514_icgraph" id="acpuid_8c_a30771fd4ef9230ee864f4d7ac9cf0514_icgraph">
<area shape="rect" title=" " alt="" coords="1037,107,1221,134"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="836,71,989,112"/>
<area shape="rect" href="x86_8c.html#acfafdbc1dfaad0bcc468d4b40e286234" title=" " alt="" coords="583,137,788,163"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="625,78,745,105"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="384,71,535,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,78,336,105"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,78,129,105"/>
</map>
</div>

</div>
</div>
<a id="ae8f7489a3e05a9bcd5dfdae82c33d618"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8f7489a3e05a9bcd5dfdae82c33d618">&#9670;&nbsp;</a></span>kvm_vcpu_after_set_cpuid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_vcpu_after_set_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00328">328</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__lapic.html">kvm_lapic</a> *apic = <a class="code" href="structkvm__lapic.html#a54741597d07b2792d2da72ea301ad648">vcpu</a>-&gt;arch.apic;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *best;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">bool</span> allow_gbpages;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    BUILD_BUG_ON(<a class="code" href="cpuid_8h.html#abcfa552db4a30d5828a49a742bc1beebacfb40ff11b95d4e4a67e9429fadf516a">KVM_NR_GOVERNED_FEATURES</a> &gt; KVM_MAX_NR_GOVERNED_FEATURES);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    bitmap_zero(vcpu-&gt;arch.governed_features.enabled,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            KVM_MAX_NR_GOVERNED_FEATURES);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">     * If TDP is enabled, let the guest use GBPAGES if they&#39;re supported in</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">     * hardware.  The hardware page walker doesn&#39;t let KVM disable GBPAGES,</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">     * i.e. won&#39;t treat them as reserved, and KVM doesn&#39;t redo the GVA-&gt;GPA</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">     * walk for performance and complexity reasons.  Not to mention KVM</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">     * _can&#39;t_ solve the problem because GVA-&gt;GPA walks aren&#39;t visible to</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">     * KVM once a TDP translation is installed.  Mimic hardware behavior so</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">     * that KVM&#39;s is at least consistent, i.e. doesn&#39;t randomly inject #PF.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">     * If TDP is disabled, honor *only* guest CPUID as KVM has full control</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">     * and can install smaller shadow pages if the host lacks 1GiB support.</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    allow_gbpages = <a class="code" href="mmu_8c.html#ab96cbfdb088c3659bfd6117823de8e30">tdp_enabled</a> ? boot_cpu_has(X86_FEATURE_GBPAGES) :</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                      <a class="code" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a>(vcpu, X86_FEATURE_GBPAGES);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span> (allow_gbpages)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <a class="code" href="cpuid_8h.html#a898d2d1ac4ac03c41e5bb2ebd1402ac0">kvm_governed_feature_set</a>(vcpu, X86_FEATURE_GBPAGES);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    best = <a class="code" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>(vcpu, 1);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">if</span> (best &amp;&amp; apic) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826">cpuid_entry_has</a>(best, X86_FEATURE_TSC_DEADLINE_TIMER))</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            apic-&gt;<a class="code" href="structkvm__lapic.html#a2e61dc072b6f41497ade5b4a59b2c52a">lapic_timer</a>.<a class="code" href="structkvm__timer.html#a37e444e2ea7fd2b7cd3975909208ddcb">timer_mode_mask</a> = 3 &lt;&lt; 17;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            apic-&gt;<a class="code" href="structkvm__lapic.html#a2e61dc072b6f41497ade5b4a59b2c52a">lapic_timer</a>.<a class="code" href="structkvm__timer.html#a37e444e2ea7fd2b7cd3975909208ddcb">timer_mode_mask</a> = 1 &lt;&lt; 17;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <a class="code" href="lapic_8c.html#aaa6716cc0b30bec513d223fbfdecfdcf">kvm_apic_set_version</a>(vcpu);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    vcpu-&gt;arch.guest_supported_xcr0 =</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="cpuid_8c.html#ab09a1700616790a1bd47e46825c5012b">cpuid_get_supported_xcr0</a>(vcpu-&gt;arch.cpuid_entries, vcpu-&gt;arch.cpuid_nent);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="cpuid_8c.html#a30771fd4ef9230ee864f4d7ac9cf0514">kvm_update_pv_runtime</a>(vcpu);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    vcpu-&gt;arch.is_amd_compatible = <a class="code" href="cpuid_8h.html#a5a6ba63d82eb4536c34fc156c7021193">guest_cpuid_is_amd_or_hygon</a>(vcpu);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    vcpu-&gt;arch.maxphyaddr = <a class="code" href="cpuid_8c.html#a881fc10bf62818799a56d9246f58b6cf">cpuid_query_maxphyaddr</a>(vcpu);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    vcpu-&gt;arch.reserved_gpa_bits = <a class="code" href="cpuid_8c.html#a8bf272b370f8a27bb68bf5bf9e5ae7d5">kvm_vcpu_reserved_gpa_bits_raw</a>(vcpu);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="pmu_8c.html#a6d6bf5af13e5325bcfc07034b4d06e6c">kvm_pmu_refresh</a>(vcpu);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    vcpu-&gt;arch.cr4_guest_rsvd_bits =</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="x86_8h.html#a04c1d2c8a6651e35309cd9bd9f129e4d">__cr4_reserved_bits</a>(<a class="code" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a>, vcpu);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="hyperv_8c.html#a35fa0d5d0a982e559906372c42713c55">kvm_hv_set_cpuid</a>(vcpu, <a class="code" href="cpuid_8c.html#a7eb8299488a685437496d827e2ad9fb3">kvm_cpuid_has_hyperv</a>(vcpu-&gt;arch.cpuid_entries,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                            vcpu-&gt;arch.cpuid_nent));</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">/* Invoke the vendor callback only after the above state is updated. */</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    static_call(kvm_x86_vcpu_after_set_cpuid)(vcpu);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">     * Except for the MMU, which needs to do its thing any vendor specific</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">     * adjustments to the reserved GPA bits.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="mmu_8c.html#a3b03fb05a1055f336fa61182cf0c760b">kvm_mmu_after_set_cpuid</a>(vcpu);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a30771fd4ef9230ee864f4d7ac9cf0514"><div class="ttname"><a href="cpuid_8c.html#a30771fd4ef9230ee864f4d7ac9cf0514">kvm_update_pv_runtime</a></div><div class="ttdeci">void kvm_update_pv_runtime(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00238">cpuid.c:238</a></div></div>
<div class="ttc" id="acpuid_8c_html_a881fc10bf62818799a56d9246f58b6cf"><div class="ttname"><a href="cpuid_8c.html#a881fc10bf62818799a56d9246f58b6cf">cpuid_query_maxphyaddr</a></div><div class="ttdeci">int cpuid_query_maxphyaddr(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00390">cpuid.c:390</a></div></div>
<div class="ttc" id="acpuid_8c_html_a8bf272b370f8a27bb68bf5bf9e5ae7d5"><div class="ttname"><a href="cpuid_8c.html#a8bf272b370f8a27bb68bf5bf9e5ae7d5">kvm_vcpu_reserved_gpa_bits_raw</a></div><div class="ttdeci">u64 kvm_vcpu_reserved_gpa_bits_raw(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00409">cpuid.c:409</a></div></div>
<div class="ttc" id="acpuid_8c_html_ab09a1700616790a1bd47e46825c5012b"><div class="ttname"><a href="cpuid_8c.html#ab09a1700616790a1bd47e46825c5012b">cpuid_get_supported_xcr0</a></div><div class="ttdeci">static u64 cpuid_get_supported_xcr0(struct kvm_cpuid_entry2 *entries, int nent)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00254">cpuid.c:254</a></div></div>
<div class="ttc" id="acpuid_8h_html_a5a6ba63d82eb4536c34fc156c7021193"><div class="ttname"><a href="cpuid_8h.html#a5a6ba63d82eb4536c34fc156c7021193">guest_cpuid_is_amd_or_hygon</a></div><div class="ttdeci">static bool guest_cpuid_is_amd_or_hygon(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00105">cpuid.h:105</a></div></div>
<div class="ttc" id="acpuid_8h_html_a898d2d1ac4ac03c41e5bb2ebd1402ac0"><div class="ttname"><a href="cpuid_8h.html#a898d2d1ac4ac03c41e5bb2ebd1402ac0">kvm_governed_feature_set</a></div><div class="ttdeci">static __always_inline void kvm_governed_feature_set(struct kvm_vcpu *vcpu, unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00262">cpuid.h:262</a></div></div>
<div class="ttc" id="acpuid_8h_html_abcfa552db4a30d5828a49a742bc1beebacfb40ff11b95d4e4a67e9429fadf516a"><div class="ttname"><a href="cpuid_8h.html#abcfa552db4a30d5828a49a742bc1beebacfb40ff11b95d4e4a67e9429fadf516a">KVM_NR_GOVERNED_FEATURES</a></div><div class="ttdeci">@ KVM_NR_GOVERNED_FEATURES</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00245">cpuid.h:244</a></div></div>
<div class="ttc" id="acpuid_8h_html_ad8c2a90f2f099af1d7ca23750d9d2eb9"><div class="ttname"><a href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a></div><div class="ttdeci">static __always_inline bool guest_cpuid_has(struct kvm_vcpu *vcpu, unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00083">cpuid.h:83</a></div></div>
<div class="ttc" id="ahyperv_8c_html_a35fa0d5d0a982e559906372c42713c55"><div class="ttname"><a href="hyperv_8c.html#a35fa0d5d0a982e559906372c42713c55">kvm_hv_set_cpuid</a></div><div class="ttdeci">void kvm_hv_set_cpuid(struct kvm_vcpu *vcpu, bool hyperv_enabled)</div><div class="ttdef"><b>Definition:</b> <a href="hyperv_8c_source.html#l02297">hyperv.c:2297</a></div></div>
<div class="ttc" id="alapic_8c_html_aaa6716cc0b30bec513d223fbfdecfdcf"><div class="ttname"><a href="lapic_8c.html#aaa6716cc0b30bec513d223fbfdecfdcf">kvm_apic_set_version</a></div><div class="ttdeci">void kvm_apic_set_version(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8c_source.html#l00573">lapic.c:573</a></div></div>
<div class="ttc" id="ammu_8c_html_a3b03fb05a1055f336fa61182cf0c760b"><div class="ttname"><a href="mmu_8c.html#a3b03fb05a1055f336fa61182cf0c760b">kvm_mmu_after_set_cpuid</a></div><div class="ttdeci">void kvm_mmu_after_set_cpuid(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8c_source.html#l05552">mmu.c:5552</a></div></div>
<div class="ttc" id="apmu_8c_html_a6d6bf5af13e5325bcfc07034b4d06e6c"><div class="ttname"><a href="pmu_8c.html#a6d6bf5af13e5325bcfc07034b4d06e6c">kvm_pmu_refresh</a></div><div class="ttdeci">void kvm_pmu_refresh(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="pmu_8c_source.html#l00742">pmu.c:742</a></div></div>
<div class="ttc" id="astructkvm__lapic_html"><div class="ttname"><a href="structkvm__lapic.html">kvm_lapic</a></div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00059">lapic.h:59</a></div></div>
<div class="ttc" id="astructkvm__lapic_html_a2e61dc072b6f41497ade5b4a59b2c52a"><div class="ttname"><a href="structkvm__lapic.html#a2e61dc072b6f41497ade5b4a59b2c52a">kvm_lapic::lapic_timer</a></div><div class="ttdeci">struct kvm_timer lapic_timer</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00060">lapic.h:62</a></div></div>
<div class="ttc" id="astructkvm__lapic_html_a54741597d07b2792d2da72ea301ad648"><div class="ttname"><a href="structkvm__lapic.html#a54741597d07b2792d2da72ea301ad648">kvm_lapic::vcpu</a></div><div class="ttdeci">struct kvm_vcpu * vcpu</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00064">lapic.h:64</a></div></div>
<div class="ttc" id="astructkvm__timer_html_a37e444e2ea7fd2b7cd3975909208ddcb"><div class="ttname"><a href="structkvm__timer.html#a37e444e2ea7fd2b7cd3975909208ddcb">kvm_timer::timer_mode_mask</a></div><div class="ttdeci">u32 timer_mode_mask</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00051">lapic.h:51</a></div></div>
<div class="ttc" id="ax86_8h_html_a04c1d2c8a6651e35309cd9bd9f129e4d"><div class="ttname"><a href="x86_8h.html#a04c1d2c8a6651e35309cd9bd9f129e4d">__cr4_reserved_bits</a></div><div class="ttdeci">#define __cr4_reserved_bits(__cpu_has, __c)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00511">x86.h:511</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ae8f7489a3e05a9bcd5dfdae82c33d618_cgraph.png" border="0" usemap="#acpuid_8c_ae8f7489a3e05a9bcd5dfdae82c33d618_cgraph" alt=""/></div>
<map name="acpuid_8c_ae8f7489a3e05a9bcd5dfdae82c33d618_cgraph" id="acpuid_8c_ae8f7489a3e05a9bcd5dfdae82c33d618_cgraph">
<area shape="rect" title=" " alt="" coords="5,343,159,385"/>
<area shape="rect" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826" title=" " alt="" coords="243,21,371,48"/>
<area shape="rect" href="cpuid_8c.html#ab09a1700616790a1bd47e46825c5012b" title=" " alt="" coords="927,325,1119,352"/>
<area shape="rect" href="cpuid_8c.html#a881fc10bf62818799a56d9246f58b6cf" title=" " alt="" coords="211,173,402,200"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="467,135,633,161"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="485,211,615,237"/>
<area shape="rect" href="cpuid_8h.html#a5a6ba63d82eb4536c34fc156c7021193" title=" " alt="" coords="229,546,384,587"/>
<area shape="rect" href="lapic_8c.html#aaa6716cc0b30bec513d223fbfdecfdcf" title=" " alt="" coords="223,376,390,403"/>
<area shape="rect" href="cpuid_8c.html#a7eb8299488a685437496d827e2ad9fb3" title=" " alt="" coords="935,275,1110,301"/>
<area shape="rect" href="cpuid_8h.html#a898d2d1ac4ac03c41e5bb2ebd1402ac0" title=" " alt="" coords="207,747,407,773"/>
<area shape="rect" href="hyperv_8c.html#a35fa0d5d0a982e559906372c42713c55" title=" " alt="" coords="235,72,378,99"/>
<area shape="rect" href="mmu_8c.html#a3b03fb05a1055f336fa61182cf0c760b" title=" " alt="" coords="207,848,406,875"/>
<area shape="rect" href="pmu_8c.html#a6d6bf5af13e5325bcfc07034b4d06e6c" title=" " alt="" coords="237,899,377,925"/>
<area shape="rect" href="cpuid_8c.html#a30771fd4ef9230ee864f4d7ac9cf0514" title=" " alt="" coords="215,651,399,677"/>
<area shape="rect" href="cpuid_8c.html#a8bf272b370f8a27bb68bf5bf9e5ae7d5" title=" " alt="" coords="215,993,399,1034"/>
<area shape="rect" href="reverse__cpuid_8h.html#a5c0c9322094b13d5fff76b5ab593339a" title=" " alt="" coords="487,21,613,48"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="969,5,1076,32"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="709,107,863,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1373,56,1521,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1167,56,1325,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="939,56,1107,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="951,107,1094,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1189,107,1303,133"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1177,300,1315,327"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="693,161,879,188"/>
<area shape="rect" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="940,158,1105,199"/>
<area shape="rect" href="kvm__emulate_8h.html#aaeb0a87b097a9164d79418139514f852" title=" " alt="" coords="468,629,632,656"/>
<area shape="rect" href="kvm__emulate_8h.html#a1d708985e548ee4ce6eee808a31d279c" title=" " alt="" coords="463,579,637,605"/>
<area shape="rect" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="940,416,1105,443"/>
<area shape="rect" href="ioapic_8h.html#a5efb8a822bd7119cfc8db075f12bf452" title=" " alt="" coords="487,427,613,453"/>
<area shape="rect" href="lapic_8c.html#ab2ee275fa1bc17aa0bfde435723b8f48" title=" " alt="" coords="478,477,622,504"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="491,376,609,403"/>
<area shape="rect" href="irq_8h.html#aeedc8b3b9e709414b2db2436224b75e8" title=" " alt="" coords="729,427,843,453"/>
<area shape="rect" href="lapic_8c.html#a5de365e734b929b65e2d75f62cea6f7e" title=" " alt="" coords="707,477,865,504"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="699,745,873,786"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="455,797,645,824"/>
<area shape="rect" href="mmu_8c.html#a56f1568115a55fdacc188e9b41159b8f" title=" " alt="" coords="456,848,644,875"/>
<area shape="rect" href="x86_8h.html#abf05d82904db21951117acb30ddf9c37" title=" " alt="" coords="477,899,623,925"/>
<area shape="rect" href="mmu_8c.html#a88ade1c65bbbb9b25a78e82003a71a7c" title=" " alt="" coords="726,832,846,859"/>
<area shape="rect" href="mmu_8c.html#a7bf770a114656f992dd1c0aff57fe9e5" title=" " alt="" coords="715,883,857,909"/>
<area shape="rect" href="mmu_8c.html#a8a6a76a1ef24ce48ce2378ac59cf5b20" title=" " alt="" coords="937,781,1108,808"/>
<area shape="rect" href="mmu_8c.html#a37d0224d142272ad59fd35b4a22c5937" title=" " alt="" coords="951,832,1095,859"/>
<area shape="rect" href="mmu_8c.html#a2346100ce00fd4d842c51c4be6cbfe35" title=" " alt="" coords="949,883,1097,909"/>
<area shape="rect" href="pmu_8c.html#af2e9d984d1cd90e3f5d7e484a6bab422" title=" " alt="" coords="487,949,613,976"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="741,939,831,965"/>
<area shape="rect" href="pmu_8c.html#ab72e943819d86a9a04fac2a043b58214" title=" " alt="" coords="715,989,857,1016"/>
<area shape="rect" href="cpuid_8c.html#a6d8deb4e45da8c580e5830057541fd8b" title=" " alt="" coords="470,681,630,722"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="699,626,873,667"/>
<area shape="rect" href="cpuid_8h.html#a1678e00b10264045277c1abfcb6eec3e" title=" " alt="" coords="477,1051,623,1077"/>
<area shape="rect" href="mmu_8h.html#a20a41b0166b13eb22b15786964f5de9d" title=" " alt="" coords="509,1000,591,1027"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ae8f7489a3e05a9bcd5dfdae82c33d618_icgraph.png" border="0" usemap="#acpuid_8c_ae8f7489a3e05a9bcd5dfdae82c33d618_icgraph" alt=""/></div>
<map name="acpuid_8c_ae8f7489a3e05a9bcd5dfdae82c33d618_icgraph" id="acpuid_8c_ae8f7489a3e05a9bcd5dfdae82c33d618_icgraph">
<area shape="rect" title=" " alt="" coords="751,39,904,80"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="583,46,703,73"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="384,71,535,112"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,46,336,73"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,46,129,73"/>
</map>
</div>

</div>
</div>
<a id="a5a115858ba6090dccc1ac1605bc3acc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a115858ba6090dccc1ac1605bc3acc1">&#9670;&nbsp;</a></span>kvm_vcpu_ioctl_get_cpuid2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vcpu_ioctl_get_cpuid2 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid2 *&#160;</td>
          <td class="paramname"><em>cpuid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid_entry2 __user *&#160;</td>
          <td class="paramname"><em>entries</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00535">535</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;{</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">if</span> (cpuid-&gt;nent &lt; vcpu-&gt;arch.cpuid_nent)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">return</span> -E2BIG;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">if</span> (copy_to_user(entries, vcpu-&gt;arch.cpuid_entries,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;             vcpu-&gt;arch.cpuid_nent * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> kvm_cpuid_entry2)))</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">return</span> -EFAULT;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    cpuid-&gt;nent = vcpu-&gt;arch.cpuid_nent;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a5a115858ba6090dccc1ac1605bc3acc1_icgraph.png" border="0" usemap="#acpuid_8c_a5a115858ba6090dccc1ac1605bc3acc1_icgraph" alt=""/></div>
<map name="acpuid_8c_a5a115858ba6090dccc1ac1605bc3acc1_icgraph" id="acpuid_8c_a5a115858ba6090dccc1ac1605bc3acc1_icgraph">
<area shape="rect" title=" " alt="" coords="384,5,536,47"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,13,336,39"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,13,129,39"/>
</map>
</div>

</div>
</div>
<a id="a5066ac0b188677d15925709568a91c9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5066ac0b188677d15925709568a91c9d">&#9670;&nbsp;</a></span>kvm_vcpu_ioctl_set_cpuid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vcpu_ioctl_set_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="cpuid_8h.html#a91d770d0af7358b6cd24b7cbe2617d73">kvm_cpuid</a> *&#160;</td>
          <td class="paramname"><em>cpuid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid_entry __user *&#160;</td>
          <td class="paramname"><em>entries</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00467">467</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;{</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordtype">int</span> r, i;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry *e = NULL;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *e2 = NULL;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">if</span> (cpuid-&gt;nent &gt; KVM_MAX_CPUID_ENTRIES)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">return</span> -E2BIG;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span> (cpuid-&gt;nent) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        e = vmemdup_array_user(entries, cpuid-&gt;nent, <span class="keyword">sizeof</span>(*e));</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">if</span> (IS_ERR(e))</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">return</span> PTR_ERR(e);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        e2 = kvmalloc_array(cpuid-&gt;nent, <span class="keyword">sizeof</span>(*e2), GFP_KERNEL_ACCOUNT);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">if</span> (!e2) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            r = -ENOMEM;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordflow">goto</span> out_free_cpuid;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; cpuid-&gt;nent; i++) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        e2[i].function = e[i].function;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        e2[i].eax = e[i].eax;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        e2[i].ebx = e[i].ebx;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        e2[i].ecx = e[i].ecx;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        e2[i].edx = e[i].edx;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        e2[i].index = 0;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        e2[i].flags = 0;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        e2[i].padding[0] = 0;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        e2[i].padding[1] = 0;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        e2[i].padding[2] = 0;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    r = <a class="code" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad">kvm_set_cpuid</a>(vcpu, e2, cpuid-&gt;nent);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        kvfree(e2);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;out_free_cpuid:</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    kvfree(e);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a0ff60eac33c1bf95a3889674e34251ad"><div class="ttname"><a href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad">kvm_set_cpuid</a></div><div class="ttdeci">static int kvm_set_cpuid(struct kvm_vcpu *vcpu, struct kvm_cpuid_entry2 *e2, int nent)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00414">cpuid.c:414</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a5066ac0b188677d15925709568a91c9d_cgraph.png" border="0" usemap="#acpuid_8c_a5066ac0b188677d15925709568a91c9d_cgraph" alt=""/></div>
<map name="acpuid_8c_a5066ac0b188677d15925709568a91c9d_cgraph" id="acpuid_8c_a5066ac0b188677d15925709568a91c9d_cgraph">
<area shape="rect" title=" " alt="" coords="5,898,156,939"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="204,905,324,932"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="383,201,542,242"/>
<area shape="rect" href="cpuid_8c.html#afea420158d1fda2784dd4382763f258c" title=" " alt="" coords="1115,1364,1253,1391"/>
<area shape="rect" href="cpuid_8c.html#a8f1b656d74e435fdceffcc2853a1c184" title=" " alt="" coords="372,813,553,840"/>
<area shape="rect" href="cpuid_8c.html#a7eb8299488a685437496d827e2ad9fb3" title=" " alt="" coords="614,1201,789,1228"/>
<area shape="rect" href="cpuid_8c.html#ab855645f0756d3668a7a31696e95c218" title=" " alt="" coords="385,930,540,971"/>
<area shape="rect" href="hyperv_8c.html#a6b9b9a8864c87d56aa2c400fa1331b0b" title=" " alt="" coords="393,436,533,463"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="386,865,539,906"/>
<area shape="rect" href="x86_8h.html#abf05d82904db21951117acb30ddf9c37" title=" " alt="" coords="871,1212,1018,1239"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="1097,538,1271,579"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1328,655,1465,681"/>
<area shape="rect" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4" title=" " alt="" coords="869,284,1021,311"/>
<area shape="rect" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826" title=" " alt="" coords="637,487,765,513"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="618,157,785,184"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="633,208,770,235"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="628,5,775,32"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="623,107,780,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1131,487,1237,513"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="1107,360,1261,387"/>
<area shape="rect" href="reverse__cpuid_8h.html#a5c0c9322094b13d5fff76b5ab593339a" title=" " alt="" coords="881,487,1008,513"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="872,5,1017,32"/>
<area shape="rect" href="hyperv_8c.html#ad212ee2bcf02cad45e2911fdb7d31861" title=" " alt="" coords="655,436,747,463"/>
<area shape="rect" href="hyperv_8c.html#acb0df6ea627c64fe5fe88dc5a52d648e" title=" " alt="" coords="659,385,743,412"/>
<area shape="rect" href="hyperv_8c.html#a053c0a6cdb6becc46a74a7b69fe791eb" title=" " alt="" coords="867,436,1023,463"/>
<area shape="rect" href="hyperv_8c.html#affaae94ac35c1a1ea573e2f1014ea259" title=" " alt="" coords="861,385,1028,412"/>
<area shape="rect" href="cpuid_8c.html#ab09a1700616790a1bd47e46825c5012b" title=" " alt="" coords="1088,604,1280,631"/>
<area shape="rect" href="cpuid_8c.html#a881fc10bf62818799a56d9246f58b6cf" title=" " alt="" coords="606,755,797,781"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="862,655,1027,681"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="879,857,1010,884"/>
<area shape="rect" href="cpuid_8h.html#a5a6ba63d82eb4536c34fc156c7021193" title=" " alt="" coords="624,806,779,847"/>
<area shape="rect" href="lapic_8c.html#aaa6716cc0b30bec513d223fbfdecfdcf" title=" " alt="" coords="618,989,785,1016"/>
<area shape="rect" href="cpuid_8h.html#a898d2d1ac4ac03c41e5bb2ebd1402ac0" title=" " alt="" coords="601,1049,801,1076"/>
<area shape="rect" href="hyperv_8c.html#a35fa0d5d0a982e559906372c42713c55" title=" " alt="" coords="630,704,773,731"/>
<area shape="rect" href="mmu_8c.html#a3b03fb05a1055f336fa61182cf0c760b" title=" " alt="" coords="602,1151,801,1177"/>
<area shape="rect" href="pmu_8c.html#a6d6bf5af13e5325bcfc07034b4d06e6c" title=" " alt="" coords="631,1100,771,1127"/>
<area shape="rect" href="cpuid_8c.html#a30771fd4ef9230ee864f4d7ac9cf0514" title=" " alt="" coords="609,549,793,576"/>
<area shape="rect" href="cpuid_8c.html#a8bf272b370f8a27bb68bf5bf9e5ae7d5" title=" " alt="" coords="609,923,793,965"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="1091,857,1277,884"/>
<area shape="rect" href="kvm__emulate_8h.html#aaeb0a87b097a9164d79418139514f852" title=" " alt="" coords="863,807,1027,833"/>
<area shape="rect" href="kvm__emulate_8h.html#a1d708985e548ee4ce6eee808a31d279c" title=" " alt="" coords="857,756,1032,783"/>
<area shape="rect" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="1101,705,1267,732"/>
<area shape="rect" href="ioapic_8h.html#a5efb8a822bd7119cfc8db075f12bf452" title=" " alt="" coords="881,959,1008,985"/>
<area shape="rect" href="lapic_8c.html#ab2ee275fa1bc17aa0bfde435723b8f48" title=" " alt="" coords="873,1009,1017,1036"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="885,908,1004,935"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1097,1078,1271,1119"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="849,1060,1040,1087"/>
<area shape="rect" href="mmu_8c.html#a56f1568115a55fdacc188e9b41159b8f" title=" " alt="" coords="851,1263,1039,1289"/>
<area shape="rect" href="pmu_8c.html#af2e9d984d1cd90e3f5d7e484a6bab422" title=" " alt="" coords="881,1161,1008,1188"/>
<area shape="rect" href="cpuid_8c.html#a6d8deb4e45da8c580e5830057541fd8b" title=" " alt="" coords="865,538,1025,579"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a5066ac0b188677d15925709568a91c9d_icgraph.png" border="0" usemap="#acpuid_8c_a5066ac0b188677d15925709568a91c9d_icgraph" alt=""/></div>
<map name="acpuid_8c_a5066ac0b188677d15925709568a91c9d_icgraph" id="acpuid_8c_a5066ac0b188677d15925709568a91c9d_icgraph">
<area shape="rect" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,13,336,39"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,13,129,39"/>
</map>
</div>

</div>
</div>
<a id="ad4dde50a2939106abd2baf99683ac139"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4dde50a2939106abd2baf99683ac139">&#9670;&nbsp;</a></span>kvm_vcpu_ioctl_set_cpuid2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vcpu_ioctl_set_cpuid2 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid2 *&#160;</td>
          <td class="paramname"><em>cpuid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_cpuid_entry2 __user *&#160;</td>
          <td class="paramname"><em>entries</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00512">512</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;{</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *e2 = NULL;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">if</span> (cpuid-&gt;nent &gt; KVM_MAX_CPUID_ENTRIES)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">return</span> -E2BIG;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span> (cpuid-&gt;nent) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        e2 = vmemdup_array_user(entries, cpuid-&gt;nent, <span class="keyword">sizeof</span>(*e2));</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">if</span> (IS_ERR(e2))</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">return</span> PTR_ERR(e2);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    r = <a class="code" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad">kvm_set_cpuid</a>(vcpu, e2, cpuid-&gt;nent);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        kvfree(e2);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ad4dde50a2939106abd2baf99683ac139_cgraph.png" border="0" usemap="#acpuid_8c_ad4dde50a2939106abd2baf99683ac139_cgraph" alt=""/></div>
<map name="acpuid_8c_ad4dde50a2939106abd2baf99683ac139_cgraph" id="acpuid_8c_ad4dde50a2939106abd2baf99683ac139_cgraph">
<area shape="rect" title=" " alt="" coords="5,898,156,939"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="204,905,324,932"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="383,201,542,242"/>
<area shape="rect" href="cpuid_8c.html#afea420158d1fda2784dd4382763f258c" title=" " alt="" coords="1115,1364,1253,1391"/>
<area shape="rect" href="cpuid_8c.html#a8f1b656d74e435fdceffcc2853a1c184" title=" " alt="" coords="372,813,553,840"/>
<area shape="rect" href="cpuid_8c.html#a7eb8299488a685437496d827e2ad9fb3" title=" " alt="" coords="614,1201,789,1228"/>
<area shape="rect" href="cpuid_8c.html#ab855645f0756d3668a7a31696e95c218" title=" " alt="" coords="385,930,540,971"/>
<area shape="rect" href="hyperv_8c.html#a6b9b9a8864c87d56aa2c400fa1331b0b" title=" " alt="" coords="393,436,533,463"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="386,865,539,906"/>
<area shape="rect" href="x86_8h.html#abf05d82904db21951117acb30ddf9c37" title=" " alt="" coords="871,1212,1018,1239"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="1097,538,1271,579"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1328,655,1465,681"/>
<area shape="rect" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4" title=" " alt="" coords="869,284,1021,311"/>
<area shape="rect" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826" title=" " alt="" coords="637,487,765,513"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="618,157,785,184"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="633,208,770,235"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="628,5,775,32"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="623,107,780,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1131,487,1237,513"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="1107,360,1261,387"/>
<area shape="rect" href="reverse__cpuid_8h.html#a5c0c9322094b13d5fff76b5ab593339a" title=" " alt="" coords="881,487,1008,513"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="872,5,1017,32"/>
<area shape="rect" href="hyperv_8c.html#ad212ee2bcf02cad45e2911fdb7d31861" title=" " alt="" coords="655,436,747,463"/>
<area shape="rect" href="hyperv_8c.html#acb0df6ea627c64fe5fe88dc5a52d648e" title=" " alt="" coords="659,385,743,412"/>
<area shape="rect" href="hyperv_8c.html#a053c0a6cdb6becc46a74a7b69fe791eb" title=" " alt="" coords="867,436,1023,463"/>
<area shape="rect" href="hyperv_8c.html#affaae94ac35c1a1ea573e2f1014ea259" title=" " alt="" coords="861,385,1028,412"/>
<area shape="rect" href="cpuid_8c.html#ab09a1700616790a1bd47e46825c5012b" title=" " alt="" coords="1088,604,1280,631"/>
<area shape="rect" href="cpuid_8c.html#a881fc10bf62818799a56d9246f58b6cf" title=" " alt="" coords="606,755,797,781"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="862,655,1027,681"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="879,857,1010,884"/>
<area shape="rect" href="cpuid_8h.html#a5a6ba63d82eb4536c34fc156c7021193" title=" " alt="" coords="624,806,779,847"/>
<area shape="rect" href="lapic_8c.html#aaa6716cc0b30bec513d223fbfdecfdcf" title=" " alt="" coords="618,989,785,1016"/>
<area shape="rect" href="cpuid_8h.html#a898d2d1ac4ac03c41e5bb2ebd1402ac0" title=" " alt="" coords="601,1049,801,1076"/>
<area shape="rect" href="hyperv_8c.html#a35fa0d5d0a982e559906372c42713c55" title=" " alt="" coords="630,704,773,731"/>
<area shape="rect" href="mmu_8c.html#a3b03fb05a1055f336fa61182cf0c760b" title=" " alt="" coords="602,1151,801,1177"/>
<area shape="rect" href="pmu_8c.html#a6d6bf5af13e5325bcfc07034b4d06e6c" title=" " alt="" coords="631,1100,771,1127"/>
<area shape="rect" href="cpuid_8c.html#a30771fd4ef9230ee864f4d7ac9cf0514" title=" " alt="" coords="609,549,793,576"/>
<area shape="rect" href="cpuid_8c.html#a8bf272b370f8a27bb68bf5bf9e5ae7d5" title=" " alt="" coords="609,923,793,965"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="1091,857,1277,884"/>
<area shape="rect" href="kvm__emulate_8h.html#aaeb0a87b097a9164d79418139514f852" title=" " alt="" coords="863,807,1027,833"/>
<area shape="rect" href="kvm__emulate_8h.html#a1d708985e548ee4ce6eee808a31d279c" title=" " alt="" coords="857,756,1032,783"/>
<area shape="rect" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="1101,705,1267,732"/>
<area shape="rect" href="ioapic_8h.html#a5efb8a822bd7119cfc8db075f12bf452" title=" " alt="" coords="881,959,1008,985"/>
<area shape="rect" href="lapic_8c.html#ab2ee275fa1bc17aa0bfde435723b8f48" title=" " alt="" coords="873,1009,1017,1036"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="885,908,1004,935"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1097,1078,1271,1119"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="849,1060,1040,1087"/>
<area shape="rect" href="mmu_8c.html#a56f1568115a55fdacc188e9b41159b8f" title=" " alt="" coords="851,1263,1039,1289"/>
<area shape="rect" href="pmu_8c.html#af2e9d984d1cd90e3f5d7e484a6bab422" title=" " alt="" coords="881,1161,1008,1188"/>
<area shape="rect" href="cpuid_8c.html#a6d8deb4e45da8c580e5830057541fd8b" title=" " alt="" coords="865,538,1025,579"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_ad4dde50a2939106abd2baf99683ac139_icgraph.png" border="0" usemap="#acpuid_8c_ad4dde50a2939106abd2baf99683ac139_icgraph" alt=""/></div>
<map name="acpuid_8c_ad4dde50a2939106abd2baf99683ac139_icgraph" id="acpuid_8c_ad4dde50a2939106abd2baf99683ac139_icgraph">
<area shape="rect" title=" " alt="" coords="384,5,535,47"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,13,336,39"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,13,129,39"/>
</map>
</div>

</div>
</div>
<a id="a8bf272b370f8a27bb68bf5bf9e5ae7d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bf272b370f8a27bb68bf5bf9e5ae7d5">&#9670;&nbsp;</a></span>kvm_vcpu_reserved_gpa_bits_raw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u64 kvm_vcpu_reserved_gpa_bits_raw </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00409">409</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;{</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mmu_8h.html#a20a41b0166b13eb22b15786964f5de9d">rsvd_bits</a>(<a class="code" href="cpuid_8h.html#a1678e00b10264045277c1abfcb6eec3e">cpuid_maxphyaddr</a>(vcpu), 63);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div>
<div class="ttc" id="acpuid_8h_html_a1678e00b10264045277c1abfcb6eec3e"><div class="ttname"><a href="cpuid_8h.html#a1678e00b10264045277c1abfcb6eec3e">cpuid_maxphyaddr</a></div><div class="ttdeci">static int cpuid_maxphyaddr(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00040">cpuid.h:40</a></div></div>
<div class="ttc" id="ammu_8h_html_a20a41b0166b13eb22b15786964f5de9d"><div class="ttname"><a href="mmu_8h.html#a20a41b0166b13eb22b15786964f5de9d">rsvd_bits</a></div><div class="ttdeci">static __always_inline u64 rsvd_bits(int s, int e)</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8h_source.html#l00045">mmu.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a8bf272b370f8a27bb68bf5bf9e5ae7d5_cgraph.png" border="0" usemap="#acpuid_8c_a8bf272b370f8a27bb68bf5bf9e5ae7d5_cgraph" alt=""/></div>
<map name="acpuid_8c_a8bf272b370f8a27bb68bf5bf9e5ae7d5_cgraph" id="acpuid_8c_a8bf272b370f8a27bb68bf5bf9e5ae7d5_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,189,65"/>
<area shape="rect" href="cpuid_8h.html#a1678e00b10264045277c1abfcb6eec3e" title=" " alt="" coords="237,5,384,32"/>
<area shape="rect" href="mmu_8h.html#a20a41b0166b13eb22b15786964f5de9d" title=" " alt="" coords="270,56,351,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_a8bf272b370f8a27bb68bf5bf9e5ae7d5_icgraph.png" border="0" usemap="#acpuid_8c_a8bf272b370f8a27bb68bf5bf9e5ae7d5_icgraph" alt=""/></div>
<map name="acpuid_8c_a8bf272b370f8a27bb68bf5bf9e5ae7d5_icgraph" id="acpuid_8c_a8bf272b370f8a27bb68bf5bf9e5ae7d5_icgraph">
<area shape="rect" title=" " alt="" coords="1309,125,1493,166"/>
<area shape="rect" href="x86_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="1089,5,1261,32"/>
<area shape="rect" href="mtrr_8c.html#a81a164c2615ef1c0fc231d71e5ba9a53" title=" " alt="" coords="1102,56,1249,83"/>
<area shape="rect" href="mtrr_8c.html#a1775807b30fdd1d17a4fb9f1f82a6aab" title=" " alt="" coords="1113,107,1238,133"/>
<area shape="rect" href="lapic_8h.html#a9d9f2a266299bc56c932735db94816d5" title=" " alt="" coords="1100,208,1251,235"/>
<area shape="rect" href="cpuid_8c.html#ae8f7489a3e05a9bcd5dfdae82c33d618" title=" " alt="" coords="1099,285,1252,326"/>
<area shape="rect" href="mtrr_8c.html#ae76247135f576f78a7740ff82f92b10c" title=" " alt="" coords="1107,157,1244,184"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="841,5,1041,32"/>
<area shape="rect" href="x86_8c.html#a0e93cb5e88dc8c07d9357181a3a7b2e9" title=" " alt="" coords="854,56,1029,83"/>
<area shape="rect" href="svm_8c.html#a091db4f6d8d0fc811fdd6d9b2a775889" title=" " alt="" coords="651,5,761,32"/>
<area shape="rect" href="vmx_8c.html#ab6b2c94ee2868acf5be3ac9b3e02e441" title=" " alt="" coords="651,56,761,83"/>
<area shape="rect" href="mtrr_8c.html#a2b95f238c68e317e64e57d06f2a698dd" title=" " alt="" coords="869,107,1014,133"/>
<area shape="rect" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299" title=" " alt="" coords="619,107,793,133"/>
<area shape="rect" href="svm_8c.html#acb46126747f78036462437a7bcdc2e47" title=" " alt="" coords="451,44,532,71"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="437,95,546,121"/>
<area shape="rect" href="vmx_8c.html#a0fb610ce041405729e4296dfc871c30e" title=" " alt="" coords="436,145,547,172"/>
<area shape="rect" href="x86_8c.html#ad6dd5b8847ecb92fe36f8dabdac40b08" title=" " alt="" coords="860,208,1023,235"/>
<area shape="rect" href="x86_8c.html#ac766943d4a9d3c7a489012c02e25be54" title=" " alt="" coords="657,196,755,223"/>
<area shape="rect" href="x86_8c.html#a48bee74c7062ceb8db0b0fa3beebfbbc" title=" " alt="" coords="653,247,759,273"/>
<area shape="rect" href="x86_8c.html#adfaccb9ae903e8b5aee77f8591d51dc9" title=" " alt="" coords="191,189,350,230"/>
<area shape="rect" href="x86_8c.html#ade4b46f56f9ee72375fa967f97e62b56" title=" " alt="" coords="448,251,535,277"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,255,129,281"/>
<area shape="rect" href="x86_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,255,364,281"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="412,305,571,332"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="881,305,1001,332"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="631,298,781,339"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="631,363,781,405"/>
</map>
</div>

</div>
</div>
<a id="aebbe1f9459c214c3640d26457668476a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebbe1f9459c214c3640d26457668476a">&#9670;&nbsp;</a></span>sanity_check_entries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool sanity_check_entries </td>
          <td>(</td>
          <td class="paramtype">struct kvm_cpuid_entry2 __user *&#160;</td>
          <td class="paramname"><em>entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&#160;</td>
          <td class="paramname"><em>num_entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>ioctl_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l01377">1377</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;{</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    __u32 pad[3];</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordflow">if</span> (ioctl_type != KVM_GET_EMULATED_CPUID)</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">     * We want to make sure that -&gt;padding is being passed clean from</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">     * userspace in case we want to use it for something in the future.</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">     * Sadly, this wasn&#39;t enforced for KVM_GET_SUPPORTED_CPUID and so we</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">     * have to give ourselves satisfied only with the emulated side. /me</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">     * sheds a tear.</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; num_entries; i++) {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">if</span> (copy_from_user(pad, entries[i].padding, <span class="keyword">sizeof</span>(pad)))</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="keywordflow">if</span> (pad[0] || pad[1] || pad[2])</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_aebbe1f9459c214c3640d26457668476a_icgraph.png" border="0" usemap="#acpuid_8c_aebbe1f9459c214c3640d26457668476a_icgraph" alt=""/></div>
<map name="acpuid_8c_aebbe1f9459c214c3640d26457668476a_icgraph" id="acpuid_8c_aebbe1f9459c214c3640d26457668476a_icgraph">
<area shape="rect" title=" " alt="" coords="440,5,599,32"/>
<area shape="rect" href="cpuid_8c.html#ac74b10a6f6a1e67ef54c48e55473ff07" title=" " alt="" coords="205,5,392,32"/>
<area shape="rect" href="x86_8c.html#a05ad3b4bc56bfbca86cf49699ca69f5f" title=" " alt="" coords="5,5,157,32"/>
</map>
</div>

</div>
</div>
<a id="aad06d21707fd0abb109028612ea7514c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad06d21707fd0abb109028612ea7514c">&#9670;&nbsp;</a></span>xstate_required_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u32 xstate_required_size </td>
          <td>(</td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>xstate_bv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>compacted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00039">39</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="reverse__cpuid_8h.html#a631fce724f1a93c2eb164f640a5d3876">feature_bit</a> = 0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    u32 ret = XSAVE_HDR_SIZE + XSAVE_HDR_OFFSET;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    xstate_bv &amp;= XFEATURE_MASK_EXTEND;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">while</span> (xstate_bv) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">if</span> (xstate_bv &amp; 0x1) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                u32 eax, ebx, ecx, edx, offset;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                cpuid_count(0xD, <a class="code" href="reverse__cpuid_8h.html#a631fce724f1a93c2eb164f640a5d3876">feature_bit</a>, &amp;eax, &amp;ebx, &amp;ecx, &amp;edx);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="comment">/* ECX[1]: 64B alignment in compacted form */</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="keywordflow">if</span> (compacted)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                offset = (ecx &amp; 0x2) ? ALIGN(ret, 64) : ret;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                offset = ebx;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            ret = max(ret, offset + eax);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        xstate_bv &gt;&gt;= 1;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="reverse__cpuid_8h.html#a631fce724f1a93c2eb164f640a5d3876">feature_bit</a>++;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="ttc" id="areverse__cpuid_8h_html_a631fce724f1a93c2eb164f640a5d3876"><div class="ttname"><a href="reverse__cpuid_8h.html#a631fce724f1a93c2eb164f640a5d3876">feature_bit</a></div><div class="ttdeci">#define feature_bit(name)</div><div class="ttdef"><b>Definition:</b> <a href="reverse__cpuid_8h_source.html#l00156">reverse_cpuid.h:156</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cpuid_8c_aad06d21707fd0abb109028612ea7514c_icgraph.png" border="0" usemap="#acpuid_8c_aad06d21707fd0abb109028612ea7514c_icgraph" alt=""/></div>
<map name="acpuid_8c_aad06d21707fd0abb109028612ea7514c_icgraph" id="acpuid_8c_aad06d21707fd0abb109028612ea7514c_icgraph">
<area shape="rect" title=" " alt="" coords="1619,461,1776,488"/>
<area shape="rect" href="cpuid_8c.html#ac91da0391b283d7527a8b33206fe03dd" title=" " alt="" coords="1427,379,1556,405"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="1412,454,1571,495"/>
<area shape="rect" href="x86_8c.html#a18efe0d4e70bef9cae70344f31f47cff" title=" " alt="" coords="1412,566,1571,607"/>
<area shape="rect" href="cpuid_8c.html#a652f54573475d1818402ab58329c340c" title=" " alt="" coords="1205,207,1320,233"/>
<area shape="rect" href="cpuid_8c.html#a1e952716ba7f46eb64f00d8a59c2be8d" title=" " alt="" coords="963,87,1083,113"/>
<area shape="rect" href="cpuid_8c.html#ac74b10a6f6a1e67ef54c48e55473ff07" title=" " alt="" coords="699,43,885,69"/>
<area shape="rect" href="x86_8c.html#a05ad3b4bc56bfbca86cf49699ca69f5f" title=" " alt="" coords="465,5,617,32"/>
<area shape="rect" href="cpuid_8c.html#a0ff60eac33c1bf95a3889674e34251ad" title=" " alt="" coords="732,129,852,156"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="1161,535,1364,561"/>
<area shape="rect" href="cpuid_8c.html#a5066ac0b188677d15925709568a91c9d" title=" " alt="" coords="465,57,616,98"/>
<area shape="rect" href="cpuid_8c.html#ad4dde50a2939106abd2baf99683ac139" title=" " alt="" coords="465,122,616,163"/>
<area shape="rect" href="x86_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="207,163,366,189"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="12,163,136,189"/>
<area shape="rect" href="x86_8c.html#a8543429a9ca5c6d3d88560ccd84bbccd" title=" " alt="" coords="733,369,851,396"/>
<area shape="rect" href="smm_8c.html#ae1445727a8459a6cc7d2e49e5a63c0d5" title=" " alt="" coords="975,496,1071,523"/>
<area shape="rect" href="lapic_8c.html#a8d747385873e52f47e85179c21521e73" title=" " alt="" coords="946,433,1101,460"/>
<area shape="rect" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299" title=" " alt="" coords="453,572,628,599"/>
<area shape="rect" href="sev_8c.html#aeb0279b2cc9c76c69ffcca8eb578b33f" title=" " alt="" coords="933,623,1113,649"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="971,724,1075,751"/>
<area shape="rect" href="vmx_8c.html#adda41e5ad7d9839a1fd3e01efc608c37" title=" " alt="" coords="971,901,1076,928"/>
<area shape="rect" href="x86_8c.html#aa5087b536be3ec29dc352f8062f744f5" title=" " alt="" coords="473,319,608,345"/>
<area shape="rect" href="x86_8c.html#ab9b558d7e5dcf9150cf853e009cce971" title=" " alt="" coords="459,369,622,396"/>
<area shape="rect" href="x86_8c.html#a388b875e496f0b87b5c551430b8cf436" title=" " alt="" coords="463,253,618,294"/>
<area shape="rect" href="x86_8c.html#a2694456104c02a7204796d89d13a1e91" title=" " alt="" coords="476,420,605,447"/>
<area shape="rect" href="lapic_8c.html#a27836a2bcd51ebcfe2ca478e9ad7aa04" title=" " alt="" coords="193,319,380,345"/>
<area shape="rect" href="x86_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="201,369,373,396"/>
<area shape="rect" href="svm_8c.html#a2ca2b108d5447ed4093cb0b07092b07d" title=" " alt="" coords="201,420,372,447"/>
<area shape="rect" href="x86_8c.html#a3361a1b517035bb0595ead223a3cb349" title=" " alt="" coords="5,399,143,425"/>
<area shape="rect" href="x86_8c.html#a2b372d06c72b7d8c25e9004bb3a3fd3b" title=" " alt="" coords="201,471,372,513"/>
<area shape="rect" href="lapic_8c.html#a4768d4990380510ec220c3e510d32598" title=" " alt="" coords="716,256,868,283"/>
<area shape="rect" href="lapic_8c.html#a8b8a5d87df5283a20e9aa9b828320552" title=" " alt="" coords="727,420,857,447"/>
<area shape="rect" href="lapic_8h.html#a9d9f2a266299bc56c932735db94816d5" title=" " alt="" coords="717,521,867,548"/>
<area shape="rect" href="x86_8c.html#a4426192bd0d8288db892f9fcbf4577b9" title=" " alt="" coords="465,187,616,229"/>
<area shape="rect" href="x86_8c.html#ad6dd5b8847ecb92fe36f8dabdac40b08" title=" " alt="" coords="459,521,622,548"/>
<area shape="rect" href="svm_8c.html#acb46126747f78036462437a7bcdc2e47" title=" " alt="" coords="246,537,327,564"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="232,588,341,615"/>
<area shape="rect" href="vmx_8c.html#a0fb610ce041405729e4296dfc871c30e" title=" " alt="" coords="231,639,342,665"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="713,623,871,649"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="507,699,574,725"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="463,763,618,789"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="431,820,651,847"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="740,724,844,751"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="191,763,383,789"/>
<area shape="rect" href="vmx_2nested_8c.html#a06a397c328d1656bb4d3ab073878e6f0" title=" " alt="" coords="449,880,632,907"/>
<area shape="rect" href="vmx_2nested_8c.html#a001f930db9a867e828cf01b48d3e4e25" title=" " alt="" coords="463,939,618,981"/>
<area shape="rect" href="vmx_2nested_8c.html#a27bdf4f6bbd476189cb0198a634394f5" title=" " alt="" coords="475,1023,606,1049"/>
<area shape="rect" href="vmx_8c.html#acf9f5acdb0b2a5b2778c853846cfa09f" title=" " alt="" coords="739,927,845,953"/>
<area shape="rect" href="kvm__main_8c.html#af05b1274e9e33570d11f7f98bee8b839" title=" " alt="" coords="1183,659,1342,701"/>
<area shape="rect" href="kvm__main_8c.html#aaeec02d207c8ce5ca12b1ef2ac36fae0" title=" " alt="" coords="941,953,1106,994"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a721f8d5b210e9625587f13b92870ba38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a721f8d5b210e9625587f13b92870ba38">&#9670;&nbsp;</a></span>__read_mostly</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kvm_x86_ops kvm_x86_ops __read_mostly = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00036">36</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
