<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KVM: arch/x86/kvm/svm/svm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ea9599923402ca8ab47fc3e495999dea.html">arch</a></li><li class="navelem"><a class="el" href="dir_c21774f8bc9f0de15163573e5f5fa2b5.html">x86</a></li><li class="navelem"><a class="el" href="dir_fde450fd4b58e2560c53a1e73bfa4d6d.html">kvm</a></li><li class="navelem"><a class="el" href="dir_59e270fee840b69a56de99d30906df9d.html">svm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">svm.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/kvm_host.h&gt;</code><br />
<code>#include &quot;<a class="el" href="irq_8h_source.html">irq.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mmu_8h_source.html">mmu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="kvm__cache__regs_8h_source.html">kvm_cache_regs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="x86_8h_source.html">x86.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="smm_8h_source.html">smm.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cpuid_8h_source.html">cpuid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pmu_8h_source.html">pmu.h</a>&quot;</code><br />
<code>#include &lt;linux/module.h&gt;</code><br />
<code>#include &lt;linux/mod_devicetable.h&gt;</code><br />
<code>#include &lt;linux/kernel.h&gt;</code><br />
<code>#include &lt;linux/vmalloc.h&gt;</code><br />
<code>#include &lt;linux/highmem.h&gt;</code><br />
<code>#include &lt;linux/amd-iommu.h&gt;</code><br />
<code>#include &lt;linux/sched.h&gt;</code><br />
<code>#include &lt;linux/trace_events.h&gt;</code><br />
<code>#include &lt;linux/slab.h&gt;</code><br />
<code>#include &lt;linux/hashtable.h&gt;</code><br />
<code>#include &lt;linux/objtool.h&gt;</code><br />
<code>#include &lt;linux/psp-sev.h&gt;</code><br />
<code>#include &lt;linux/file.h&gt;</code><br />
<code>#include &lt;linux/pagemap.h&gt;</code><br />
<code>#include &lt;linux/swap.h&gt;</code><br />
<code>#include &lt;linux/rwsem.h&gt;</code><br />
<code>#include &lt;linux/cc_platform.h&gt;</code><br />
<code>#include &lt;linux/smp.h&gt;</code><br />
<code>#include &lt;asm/apic.h&gt;</code><br />
<code>#include &lt;asm/perf_event.h&gt;</code><br />
<code>#include &lt;asm/tlbflush.h&gt;</code><br />
<code>#include &lt;asm/desc.h&gt;</code><br />
<code>#include &lt;asm/debugreg.h&gt;</code><br />
<code>#include &lt;asm/kvm_para.h&gt;</code><br />
<code>#include &lt;asm/irq_remapping.h&gt;</code><br />
<code>#include &lt;asm/spec-ctrl.h&gt;</code><br />
<code>#include &lt;asm/cpu_device_id.h&gt;</code><br />
<code>#include &lt;asm/traps.h&gt;</code><br />
<code>#include &lt;asm/reboot.h&gt;</code><br />
<code>#include &lt;asm/fpu/api.h&gt;</code><br />
<code>#include &lt;trace/events/ipi.h&gt;</code><br />
<code>#include &quot;<a class="el" href="trace_8h_source.html">trace.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="svm_8h_source.html">svm.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="svm__ops_8h_source.html">svm_ops.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="kvm__onhyperv_8h_source.html">kvm_onhyperv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="svm__onhyperv_8h_source.html">svm_onhyperv.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for svm.c:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c__incl.png" border="0" usemap="#aarch_2x86_2kvm_2svm_2svm_8c" alt=""/></div>
<map name="aarch_2x86_2kvm_2svm_2svm_8c" id="aarch_2x86_2kvm_2svm_2svm_8c">
<area shape="rect" title=" " alt="" coords="2696,5,2882,32"/>
<area shape="rect" title=" " alt="" coords="212,379,347,405"/>
<area shape="rect" href="irq_8h.html" title=" " alt="" coords="758,80,809,107"/>
<area shape="rect" href="smm_8h.html" title=" " alt="" coords="1205,229,1272,256"/>
<area shape="rect" href="mmu_8h.html" title=" " alt="" coords="107,80,175,107"/>
<area shape="rect" href="kvm__cache__regs_8h.html" title=" " alt="" coords="44,304,187,331"/>
<area shape="rect" href="cpuid_8h.html" title=" " alt="" coords="250,155,320,181"/>
<area shape="rect" href="x86_8h.html" title=" " alt="" coords="250,229,309,256"/>
<area shape="rect" href="pmu_8h.html" title=" " alt="" coords="884,80,947,107"/>
<area shape="rect" title=" " alt="" coords="971,80,1090,107"/>
<area shape="rect" title=" " alt="" coords="1114,80,1296,107"/>
<area shape="rect" title=" " alt="" coords="1320,80,1431,107"/>
<area shape="rect" title=" " alt="" coords="1456,80,1578,107"/>
<area shape="rect" title=" " alt="" coords="1603,80,1735,107"/>
<area shape="rect" title=" " alt="" coords="1759,80,1910,107"/>
<area shape="rect" title=" " alt="" coords="1934,80,2042,107"/>
<area shape="rect" title=" " alt="" coords="2066,80,2221,107"/>
<area shape="rect" title=" " alt="" coords="2246,80,2343,107"/>
<area shape="rect" title=" " alt="" coords="2367,80,2502,107"/>
<area shape="rect" title=" " alt="" coords="2526,80,2641,107"/>
<area shape="rect" title=" " alt="" coords="2665,80,2785,107"/>
<area shape="rect" title=" " alt="" coords="2809,80,2900,107"/>
<area shape="rect" title=" " alt="" coords="2924,80,3054,107"/>
<area shape="rect" title=" " alt="" coords="3078,80,3182,107"/>
<area shape="rect" title=" " alt="" coords="3206,80,3321,107"/>
<area shape="rect" title=" " alt="" coords="3345,80,3492,107"/>
<area shape="rect" title=" " alt="" coords="3516,80,3614,107"/>
<area shape="rect" title=" " alt="" coords="3638,80,3732,107"/>
<area shape="rect" title=" " alt="" coords="3756,80,3892,107"/>
<area shape="rect" title=" " alt="" coords="3916,80,4030,107"/>
<area shape="rect" title=" " alt="" coords="4054,80,4150,107"/>
<area shape="rect" title=" " alt="" coords="4175,80,4302,107"/>
<area shape="rect" title=" " alt="" coords="4326,80,4457,107"/>
<area shape="rect" title=" " alt="" coords="4481,80,4641,107"/>
<area shape="rect" title=" " alt="" coords="4665,80,4788,107"/>
<area shape="rect" title=" " alt="" coords="4812,80,4971,107"/>
<area shape="rect" title=" " alt="" coords="4996,80,5094,107"/>
<area shape="rect" title=" " alt="" coords="5119,80,5227,107"/>
<area shape="rect" title=" " alt="" coords="5251,80,5362,107"/>
<area shape="rect" title=" " alt="" coords="5386,80,5520,107"/>
<area shape="rect" href="trace_8h.html" title=" " alt="" coords="5545,80,5612,107"/>
<area shape="rect" href="svm_8h.html" title=" " alt="" coords="468,80,531,107"/>
<area shape="rect" href="svm__ops_8h.html" title=" " alt="" coords="344,155,436,181"/>
<area shape="rect" href="kvm__onhyperv_8h.html" title=" " alt="" coords="5636,80,5766,107"/>
<area shape="rect" href="svm__onhyperv_8h.html" title=" " alt="" coords="5791,80,5920,107"/>
<area shape="rect" title=" " alt="" coords="562,155,701,181"/>
<area shape="rect" title=" " alt="" coords="725,155,842,181"/>
<area shape="rect" title=" " alt="" coords="866,155,990,181"/>
<area shape="rect" href="iodev_8h.html" title=" " alt="" coords="1027,229,1130,256"/>
<area shape="rect" href="lapic_8h.html" title=" " alt="" coords="1116,155,1182,181"/>
</map>
</div>
</div>
<p><a href="svm_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsvm__direct__access__msrs.html">svm_direct_access_msrs</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct____x86__intercept.html">__x86_intercept</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1f8c165bf4196327bc3abff648276d92"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1f8c165bf4196327bc3abff648276d92">pr_fmt</a>(fmt)&#160;&#160;&#160;KBUILD_MODNAME &quot;: &quot; fmt</td></tr>
<tr class="separator:a1f8c165bf4196327bc3abff648276d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1123609025ff8c35fcebbeefc627fe40"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1123609025ff8c35fcebbeefc627fe40">SEG_TYPE_LDT</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a1123609025ff8c35fcebbeefc627fe40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa07431310e9e653530a11e6f39606cc9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aa07431310e9e653530a11e6f39606cc9">SEG_TYPE_BUSY_TSS16</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:aa07431310e9e653530a11e6f39606cc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d7d4f0ffdcfcfdc6d979e434be6e25e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a7d7d4f0ffdcfcfdc6d979e434be6e25e">X2APIC_MSR</a>(x)&#160;&#160;&#160;(APIC_BASE_MSR + (x &gt;&gt; 4))</td></tr>
<tr class="separator:a7d7d4f0ffdcfcfdc6d979e434be6e25e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac84410b6049231218187535376fcbdba"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac84410b6049231218187535376fcbdba">NUM_MSR_MAPS</a>&#160;&#160;&#160;ARRAY_SIZE(<a class="el" href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a>)</td></tr>
<tr class="separator:ac84410b6049231218187535376fcbdba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c8786ad06a6d122f851eee8d43424d9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a0c8786ad06a6d122f851eee8d43424d9">MSRS_RANGE_SIZE</a>&#160;&#160;&#160;2048</td></tr>
<tr class="separator:a0c8786ad06a6d122f851eee8d43424d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c585eaa599f4c72e9f1f6fcc1ea0fb8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a6c585eaa599f4c72e9f1f6fcc1ea0fb8">MSRS_IN_RANGE</a>&#160;&#160;&#160;(<a class="el" href="svm_8c.html#a0c8786ad06a6d122f851eee8d43424d9">MSRS_RANGE_SIZE</a> * 8 / 2)</td></tr>
<tr class="separator:a6c585eaa599f4c72e9f1f6fcc1ea0fb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af489914c8a592f433c39b3372585889e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af489914c8a592f433c39b3372585889e">CR_VALID</a>&#160;&#160;&#160;(1ULL &lt;&lt; 63)</td></tr>
<tr class="separator:af489914c8a592f433c39b3372585889e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6ff7f6576ef59b7a7a0b6f549eb01b7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac6ff7f6576ef59b7a7a0b6f549eb01b7">PRE_EX</a>(exit)</td></tr>
<tr class="separator:ac6ff7f6576ef59b7a7a0b6f549eb01b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79fe7d541a228e862eb4dc87922de3d9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a79fe7d541a228e862eb4dc87922de3d9">POST_EX</a>(exit)</td></tr>
<tr class="separator:a79fe7d541a228e862eb4dc87922de3d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac6de7da0316443b810d97be36e928b4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aac6de7da0316443b810d97be36e928b4">POST_MEM</a>(exit)</td></tr>
<tr class="separator:aac6de7da0316443b810d97be36e928b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aedcf2109f459315e1a7f2af73ec9b603"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603acde1334d18ebb932ec5a98bf93c431ae">NONE_SVM_INSTR</a>
, <a class="el" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a4fc4da3a6a1a9c998f04b7988ba00834">SVM_INSTR_VMRUN</a>
, <a class="el" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603aafab86473fad2281466fe8b1d89b74d9">SVM_INSTR_VMLOAD</a>
, <a class="el" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a5eb1e788833fd7f4e89343327e575e32">SVM_INSTR_VMSAVE</a>
 }</td></tr>
<tr class="separator:aedcf2109f459315e1a7f2af73ec9b603"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8c1fae58a67d6d9280e1d59713163f30"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a8c1fae58a67d6d9280e1d59713163f30">MODULE_AUTHOR</a> (&quot;Qumranet&quot;)</td></tr>
<tr class="separator:a8c1fae58a67d6d9280e1d59713163f30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad94b36675e7eb067ea3ce6ff9e244a44"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad94b36675e7eb067ea3ce6ff9e244a44">MODULE_LICENSE</a> (&quot;GPL&quot;)</td></tr>
<tr class="separator:ad94b36675e7eb067ea3ce6ff9e244a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1454b29e3d306b288f6550700c4118d7"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1454b29e3d306b288f6550700c4118d7">DEFINE_PER_CPU</a> (u64, current_tsc_ratio)</td></tr>
<tr class="separator:a1454b29e3d306b288f6550700c4118d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a928bd7f75de78fe4d01adb8afa79d18e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a928bd7f75de78fe4d01adb8afa79d18e">module_param</a> (<a class="el" href="svm_8c.html#a7844865730b4425faa277774dddb41b6">pause_filter_thresh</a>, ushort, 0444)</td></tr>
<tr class="separator:a928bd7f75de78fe4d01adb8afa79d18e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8efb7aa314a00c488ab8e71be224aff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aa8efb7aa314a00c488ab8e71be224aff">module_param</a> (<a class="el" href="svm_8c.html#a3bc68316af32e407d865d83e00a03316">pause_filter_count</a>, ushort, 0444)</td></tr>
<tr class="separator:aa8efb7aa314a00c488ab8e71be224aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac17375e97535e7313d6d256b6b2b79dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac17375e97535e7313d6d256b6b2b79dc">module_param</a> (<a class="el" href="svm_8c.html#a64b792e4e2d6162271f1704fbabc4884">pause_filter_count_grow</a>, ushort, 0444)</td></tr>
<tr class="separator:ac17375e97535e7313d6d256b6b2b79dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c0b2cd46b026b991bea29d642adf5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a85c0b2cd46b026b991bea29d642adf5d">module_param</a> (<a class="el" href="svm_8c.html#ad71d914e223758efb4dcac69978f4083">pause_filter_count_shrink</a>, ushort, 0444)</td></tr>
<tr class="separator:a85c0b2cd46b026b991bea29d642adf5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43cd839e587ee3d59145ddb298d940f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a43cd839e587ee3d59145ddb298d940f3">module_param</a> (<a class="el" href="svm_8c.html#ac5ab188f15144152c91129b044a371d8">pause_filter_count_max</a>, ushort, 0444)</td></tr>
<tr class="separator:a43cd839e587ee3d59145ddb298d940f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1343c12c0281ab5065e8f8ea8583c1fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1343c12c0281ab5065e8f8ea8583c1fb">module_param_named</a> (npt, <a class="el" href="svm_8h.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>, bool, 0444)</td></tr>
<tr class="separator:a1343c12c0281ab5065e8f8ea8583c1fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9dcfa60f776c7f9b913e6179a0a24f2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad9dcfa60f776c7f9b913e6179a0a24f2">module_param</a> (<a class="el" href="vmx_8c.html#a97d7564e1b5ae8c0173e53f859ac17e1">nested</a>, int, 0444)</td></tr>
<tr class="separator:ad9dcfa60f776c7f9b913e6179a0a24f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ebd318a096c0732cd95462f45be95a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a67ebd318a096c0732cd95462f45be95a">module_param</a> (<a class="el" href="svm_8h.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a>, int, 0444)</td></tr>
<tr class="separator:a67ebd318a096c0732cd95462f45be95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0cae8f94f2805c88ee94cf3e6e6c9fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ae0cae8f94f2805c88ee94cf3e6e6c9fb">module_param</a> (<a class="el" href="svm_8c.html#a3ad937a1fd2ef8fcdd87953c6a5db405">vls</a>, int, 0444)</td></tr>
<tr class="separator:ae0cae8f94f2805c88ee94cf3e6e6c9fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2b1b0852b08378092aff59f695a75ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac2b1b0852b08378092aff59f695a75ae">module_param</a> (<a class="el" href="svm_8h.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>, int, 0444)</td></tr>
<tr class="separator:ac2b1b0852b08378092aff59f695a75ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46be789610abc54d1f25bc1fe575f998"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a46be789610abc54d1f25bc1fe575f998">module_param</a> (<a class="el" href="svm_8c.html#ac6093899c4533e4c669b24862528077d">lbrv</a>, int, 0444)</td></tr>
<tr class="separator:a46be789610abc54d1f25bc1fe575f998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80f38cba78c484e6f5cbdb0938510234"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a80f38cba78c484e6f5cbdb0938510234">module_param</a> (<a class="el" href="svm_8c.html#adacf7fe5bb2bb2fdef07153a859b75ba">tsc_scaling</a>, int, 0444)</td></tr>
<tr class="separator:a80f38cba78c484e6f5cbdb0938510234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5398bb236e9d6dd335ac102f0d8d370"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af5398bb236e9d6dd335ac102f0d8d370">module_param</a> (<a class="el" href="svm_8c.html#a8c4ea69d2d0310307567f305689357f8">avic</a>, bool, 0444)</td></tr>
<tr class="separator:af5398bb236e9d6dd335ac102f0d8d370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea4847c29cd5b5de66a626968b098c43"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aea4847c29cd5b5de66a626968b098c43">module_param</a> (<a class="el" href="svm_8h.html#a8be79ef0522e29a602517b51ff51f509">dump_invalid_vmcb</a>, bool, 0644)</td></tr>
<tr class="separator:aea4847c29cd5b5de66a626968b098c43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f3202c47c01c553241cf53f0b7f28a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a0f3202c47c01c553241cf53f0b7f28a5">module_param</a> (<a class="el" href="svm_8h.html#adc8812d5d875ec9a2bf431790db71cfb">intercept_smi</a>, bool, 0444)</td></tr>
<tr class="separator:a0f3202c47c01c553241cf53f0b7f28a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f63600a5680b997a6fe7b8bb0113da9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a9f63600a5680b997a6fe7b8bb0113da9">module_param</a> (<a class="el" href="svm_8h.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a>, bool, 0444)</td></tr>
<tr class="separator:a9f63600a5680b997a6fe7b8bb0113da9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad78b00702b9a3260f5e32980b3297e2f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad78b00702b9a3260f5e32980b3297e2f">DEFINE_PER_CPU</a> (struct <a class="el" href="structsvm__cpu__data.html">svm_cpu_data</a>, svm_data)</td></tr>
<tr class="separator:ad78b00702b9a3260f5e32980b3297e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35438091c40e77c617ce2ec9d521cc1f"><td class="memItemLeft" align="right" valign="top">u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f">svm_msrpm_offset</a> (u32 msr)</td></tr>
<tr class="separator:a35438091c40e77c617ce2ec9d521cc1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9fb8e1d8461d85400d73c9438073a08"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08">svm_flush_tlb_current</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ac9fb8e1d8461d85400d73c9438073a08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a78719a48d64b80ead6c34e9ab1cccf"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1a78719a48d64b80ead6c34e9ab1cccf">get_npt_level</a> (void)</td></tr>
<tr class="separator:a1a78719a48d64b80ead6c34e9ab1cccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5df90c8772700a60441f2ba19472f726"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726">svm_set_efer</a> (struct kvm_vcpu *vcpu, u64 efer)</td></tr>
<tr class="separator:a5df90c8772700a60441f2ba19472f726"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc8423f336a2a1ed01c6487383d4ba8"><td class="memItemLeft" align="right" valign="top">static u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a8dc8423f336a2a1ed01c6487383d4ba8">svm_get_interrupt_shadow</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a8dc8423f336a2a1ed01c6487383d4ba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88f50f26e46655ddf4e070bcabcc66ad"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a88f50f26e46655ddf4e070bcabcc66ad">svm_set_interrupt_shadow</a> (struct kvm_vcpu *vcpu, int mask)</td></tr>
<tr class="separator:a88f50f26e46655ddf4e070bcabcc66ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f6d0a95558c52f05d9b3b97b2710cfe"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe">__svm_skip_emulated_instruction</a> (struct kvm_vcpu *vcpu, bool commit_side_effects)</td></tr>
<tr class="separator:a1f6d0a95558c52f05d9b3b97b2710cfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a879b6475034eccd7032ffd436966f341"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a879b6475034eccd7032ffd436966f341">svm_skip_emulated_instruction</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a879b6475034eccd7032ffd436966f341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac18fc14fa96cb83668d789973478dbc0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac18fc14fa96cb83668d789973478dbc0">svm_update_soft_interrupt_rip</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ac18fc14fa96cb83668d789973478dbc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13190482bab2b529a02a5cf83309f510"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a13190482bab2b529a02a5cf83309f510">svm_inject_exception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a13190482bab2b529a02a5cf83309f510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a845aceb79827a59a1e6e703aeee0b02a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a845aceb79827a59a1e6e703aeee0b02a">svm_init_erratum_383</a> (void)</td></tr>
<tr class="separator:a845aceb79827a59a1e6e703aeee0b02a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f710210623f08aa3f8ba9efdd0746b1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a7f710210623f08aa3f8ba9efdd0746b1">svm_init_osvw</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a7f710210623f08aa3f8ba9efdd0746b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c5962ecf16b873fd88c7d6664ea7f0c"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a0c5962ecf16b873fd88c7d6664ea7f0c">__kvm_is_svm_supported</a> (void)</td></tr>
<tr class="separator:a0c5962ecf16b873fd88c7d6664ea7f0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1ba53021522940c5c8b84e82d574243"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad1ba53021522940c5c8b84e82d574243">kvm_is_svm_supported</a> (void)</td></tr>
<tr class="separator:ad1ba53021522940c5c8b84e82d574243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad903be303ec3da29f6f41d563d9cef80"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad903be303ec3da29f6f41d563d9cef80">svm_check_processor_compat</a> (void)</td></tr>
<tr class="separator:ad903be303ec3da29f6f41d563d9cef80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66671c85c774356d50d71cbd11633a34"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34">__svm_write_tsc_multiplier</a> (u64 multiplier)</td></tr>
<tr class="separator:a66671c85c774356d50d71cbd11633a34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53176c61179bfcec5f1c122b110cc8c3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a53176c61179bfcec5f1c122b110cc8c3">kvm_cpu_svm_disable</a> (void)</td></tr>
<tr class="separator:a53176c61179bfcec5f1c122b110cc8c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4fa734cd92223a6150551cd5243b4aa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ab4fa734cd92223a6150551cd5243b4aa">svm_emergency_disable</a> (void)</td></tr>
<tr class="separator:ab4fa734cd92223a6150551cd5243b4aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accd19fd9a37bd9d9ed52a1f26a86e7b5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#accd19fd9a37bd9d9ed52a1f26a86e7b5">svm_hardware_disable</a> (void)</td></tr>
<tr class="separator:accd19fd9a37bd9d9ed52a1f26a86e7b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace8f9c582674fc49f475a61c3e9ed257"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ace8f9c582674fc49f475a61c3e9ed257">svm_hardware_enable</a> (void)</td></tr>
<tr class="separator:ace8f9c582674fc49f475a61c3e9ed257"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf31fa601aecc0caef0ec738dee9cd86"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#adf31fa601aecc0caef0ec738dee9cd86">svm_cpu_uninit</a> (int cpu)</td></tr>
<tr class="separator:adf31fa601aecc0caef0ec738dee9cd86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad791a60fcdb50ec0a9aeb753e780ddb6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad791a60fcdb50ec0a9aeb753e780ddb6">svm_cpu_init</a> (int cpu)</td></tr>
<tr class="separator:ad791a60fcdb50ec0a9aeb753e780ddb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f08bf5cf3614629bd95b07ea03b08cf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf">set_dr_intercepts</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a7f08bf5cf3614629bd95b07ea03b08cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02cdc4055c8a1706c884eff72c4caaf7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a02cdc4055c8a1706c884eff72c4caaf7">clr_dr_intercepts</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a02cdc4055c8a1706c884eff72c4caaf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a3d076f98c7c25a44d90f49f0fca2c3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3">direct_access_msr_slot</a> (u32 msr)</td></tr>
<tr class="separator:a6a3d076f98c7c25a44d90f49f0fca2c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ffde811cc7743857dbb3175beda4aa2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2">set_shadow_msr_intercept</a> (struct kvm_vcpu *vcpu, u32 msr, int read, int write)</td></tr>
<tr class="separator:a1ffde811cc7743857dbb3175beda4aa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f427ed9696201e388996df7ceccb9e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e">valid_msr_intercept</a> (u32 index)</td></tr>
<tr class="separator:a48f427ed9696201e388996df7ceccb9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dbf1138872247b45ebbc4880523c0dd"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a9dbf1138872247b45ebbc4880523c0dd">msr_write_intercepted</a> (struct kvm_vcpu *vcpu, u32 msr)</td></tr>
<tr class="separator:a9dbf1138872247b45ebbc4880523c0dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7baa0f9e5f7d38e8ed066a4b8a61c09a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a">set_msr_interception_bitmap</a> (struct kvm_vcpu *vcpu, u32 *msrpm, u32 msr, int read, int write)</td></tr>
<tr class="separator:a7baa0f9e5f7d38e8ed066a4b8a61c09a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7cebb5bd1d0e7eadb2b7df90cca0c74"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a> (struct kvm_vcpu *vcpu, u32 *msrpm, u32 msr, int read, int write)</td></tr>
<tr class="separator:ae7cebb5bd1d0e7eadb2b7df90cca0c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf821ba71761474726fdfb616796a0c8"><td class="memItemLeft" align="right" valign="top">u32 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aaf821ba71761474726fdfb616796a0c8">svm_vcpu_alloc_msrpm</a> (void)</td></tr>
<tr class="separator:aaf821ba71761474726fdfb616796a0c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee43a83fe8c444128a4d22b2d5d5c21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21">svm_vcpu_init_msrpm</a> (struct kvm_vcpu *vcpu, u32 *msrpm)</td></tr>
<tr class="separator:aaee43a83fe8c444128a4d22b2d5d5c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a195738d23c6f6b6bf7269334d3a38721"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721">svm_set_x2apic_msr_interception</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, bool intercept)</td></tr>
<tr class="separator:a195738d23c6f6b6bf7269334d3a38721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67937d45023d92583b0bd363c73b6c2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a67937d45023d92583b0bd363c73b6c2b">svm_vcpu_free_msrpm</a> (u32 *msrpm)</td></tr>
<tr class="separator:a67937d45023d92583b0bd363c73b6c2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4bda9cd8e4f3408d51dff1dd4403a11"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ab4bda9cd8e4f3408d51dff1dd4403a11">svm_msr_filter_changed</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ab4bda9cd8e4f3408d51dff1dd4403a11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82b315b23a07eb3743b2458ccefb729d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a82b315b23a07eb3743b2458ccefb729d">add_msr_offset</a> (u32 offset)</td></tr>
<tr class="separator:a82b315b23a07eb3743b2458ccefb729d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9af31dcd464498479ea7b57cdc106f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a0a9af31dcd464498479ea7b57cdc106f">init_msrpm_offsets</a> (void)</td></tr>
<tr class="separator:a0a9af31dcd464498479ea7b57cdc106f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06d8a6a899d49f3235ec1294d1943c84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84">svm_copy_lbrs</a> (struct vmcb *to_vmcb, struct vmcb *from_vmcb)</td></tr>
<tr class="separator:a06d8a6a899d49f3235ec1294d1943c84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c512591b577cf59656808ac082a47a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af2c512591b577cf59656808ac082a47a">svm_enable_lbrv</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:af2c512591b577cf59656808ac082a47a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa7d57cd8b29b959a08ccd6dc53196c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4">svm_disable_lbrv</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aaa7d57cd8b29b959a08ccd6dc53196c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ba5c45bbaca2c94f46c1a9ba653fcd8"><td class="memItemLeft" align="right" valign="top">static struct vmcb *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a9ba5c45bbaca2c94f46c1a9ba653fcd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5aa214e23ea9ec9418bebbe889d41ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef">svm_update_lbrv</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad5aa214e23ea9ec9418bebbe889d41ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ff4c846a46f6bb2e429d79bbc18f052"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a7ff4c846a46f6bb2e429d79bbc18f052">disable_nmi_singlestep</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a7ff4c846a46f6bb2e429d79bbc18f052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab386821d47e9af4c7a362e43dca751fa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ab386821d47e9af4c7a362e43dca751fa">grow_ple_window</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ab386821d47e9af4c7a362e43dca751fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacde987fd6ae3956ec075251296c37a0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aacde987fd6ae3956ec075251296c37a0">shrink_ple_window</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aacde987fd6ae3956ec075251296c37a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96aba01528b17e2beabf86e9c19ac13a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a96aba01528b17e2beabf86e9c19ac13a">svm_hardware_unsetup</a> (void)</td></tr>
<tr class="separator:a96aba01528b17e2beabf86e9c19ac13a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c67b65be7f511419da6e7d00fa6a544"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a2c67b65be7f511419da6e7d00fa6a544">init_seg</a> (struct vmcb_seg *seg)</td></tr>
<tr class="separator:a2c67b65be7f511419da6e7d00fa6a544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a449783a93b602b1f32967c74581c38cf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a449783a93b602b1f32967c74581c38cf">init_sys_seg</a> (struct vmcb_seg *seg, uint32_t type)</td></tr>
<tr class="separator:a449783a93b602b1f32967c74581c38cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a147c81ec20836268891f32ecd6254f3a"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a147c81ec20836268891f32ecd6254f3a">svm_get_l2_tsc_offset</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a147c81ec20836268891f32ecd6254f3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25d69045754132f8878c2e1a65c2f163"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a25d69045754132f8878c2e1a65c2f163">svm_get_l2_tsc_multiplier</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a25d69045754132f8878c2e1a65c2f163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5779d517a24ab13b687f430474e7b018"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a5779d517a24ab13b687f430474e7b018">svm_write_tsc_offset</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a5779d517a24ab13b687f430474e7b018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a1b45b05505f9435cc2d1dd1c37943"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943">svm_write_tsc_multiplier</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad9a1b45b05505f9435cc2d1dd1c37943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12d4d3a3b5ae14af748037ebf85485c1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1">svm_recalc_instruction_intercepts</a> (struct kvm_vcpu *vcpu, struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a12d4d3a3b5ae14af748037ebf85485c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2704ee64e6fe9975efa29b6759a26139"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139">init_vmcb_after_set_cpuid</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a2704ee64e6fe9975efa29b6759a26139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3d3185c3eece1cf1e99fd5da3ca3181"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181">init_vmcb</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aa3d3185c3eece1cf1e99fd5da3ca3181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bd9f9c3ade9fe75356f04bdf58433cc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc">__svm_vcpu_reset</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a6bd9f9c3ade9fe75356f04bdf58433cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72a80d54451776cc2794da8564a424fa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa">svm_vcpu_reset</a> (struct kvm_vcpu *vcpu, bool init_event)</td></tr>
<tr class="separator:a72a80d54451776cc2794da8564a424fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a051d09f3fa8790388364ac3f69ed3e53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, struct <a class="el" href="structkvm__vmcb__info.html">kvm_vmcb_info</a> *target_vmcb)</td></tr>
<tr class="separator:a051d09f3fa8790388364ac3f69ed3e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2af2f754ca7838a0253d54c33aae7d1e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a2af2f754ca7838a0253d54c33aae7d1e">svm_vcpu_create</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a2af2f754ca7838a0253d54c33aae7d1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c1032c7d7d9373379ac998c0a05805"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a31c1032c7d7d9373379ac998c0a05805">svm_clear_current_vmcb</a> (struct vmcb *vmcb)</td></tr>
<tr class="separator:a31c1032c7d7d9373379ac998c0a05805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a394304ab136d5db4f5dad5b7c05e06e4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4">svm_vcpu_free</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a394304ab136d5db4f5dad5b7c05e06e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6571ab4636ff87fda563be50ab7195ef"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a6571ab4636ff87fda563be50ab7195ef">svm_prepare_switch_to_guest</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a6571ab4636ff87fda563be50ab7195ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72538164da58fe5a35e1753dd52d5b4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad72538164da58fe5a35e1753dd52d5b4">svm_prepare_host_switch</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad72538164da58fe5a35e1753dd52d5b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9e5b464a654de732fe7b0ce81145897"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ab9e5b464a654de732fe7b0ce81145897">svm_vcpu_load</a> (struct kvm_vcpu *vcpu, int cpu)</td></tr>
<tr class="separator:ab9e5b464a654de732fe7b0ce81145897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af102e65fa4a28844d0bd7bbb75bd4565"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af102e65fa4a28844d0bd7bbb75bd4565">svm_vcpu_put</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:af102e65fa4a28844d0bd7bbb75bd4565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebf053055bbd922cecbebdcd0bdecf09"><td class="memItemLeft" align="right" valign="top">static unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aebf053055bbd922cecbebdcd0bdecf09">svm_get_rflags</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aebf053055bbd922cecbebdcd0bdecf09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6289195c8ae7b64acfdb6cbe8e5342f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ae6289195c8ae7b64acfdb6cbe8e5342f">svm_set_rflags</a> (struct kvm_vcpu *vcpu, unsigned long rflags)</td></tr>
<tr class="separator:ae6289195c8ae7b64acfdb6cbe8e5342f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a9065695154691afff42bc585235d64"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a4a9065695154691afff42bc585235d64">svm_get_if_flag</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a4a9065695154691afff42bc585235d64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c03fa2ac66c8db77e6bdc408cf0b7bb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a6c03fa2ac66c8db77e6bdc408cf0b7bb">svm_cache_reg</a> (struct kvm_vcpu *vcpu, enum kvm_reg reg)</td></tr>
<tr class="separator:a6c03fa2ac66c8db77e6bdc408cf0b7bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27df28527cda6f7917355af86817d940"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a27df28527cda6f7917355af86817d940">svm_set_vintr</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a27df28527cda6f7917355af86817d940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea540cc79e685f3a2eebfa4226b63403"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403">svm_clear_vintr</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:aea540cc79e685f3a2eebfa4226b63403"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1743f35bf86caa51b20a010c228520b"><td class="memItemLeft" align="right" valign="top">static struct vmcb_seg *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aa1743f35bf86caa51b20a010c228520b">svm_seg</a> (struct kvm_vcpu *vcpu, int seg)</td></tr>
<tr class="separator:aa1743f35bf86caa51b20a010c228520b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe9828b3134c1b062cee0f740a236605"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#afe9828b3134c1b062cee0f740a236605">svm_get_segment_base</a> (struct kvm_vcpu *vcpu, int seg)</td></tr>
<tr class="separator:afe9828b3134c1b062cee0f740a236605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6daa12edeead3fa3897d8e868a20c63e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a6daa12edeead3fa3897d8e868a20c63e">svm_get_segment</a> (struct kvm_vcpu *vcpu, struct kvm_segment *var, int seg)</td></tr>
<tr class="separator:a6daa12edeead3fa3897d8e868a20c63e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec9fa4b1df8f24cd52b41eb10cfc0b4d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aec9fa4b1df8f24cd52b41eb10cfc0b4d">svm_get_cpl</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aec9fa4b1df8f24cd52b41eb10cfc0b4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa993ddc604d61adf2f6b26668d37cee5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aa993ddc604d61adf2f6b26668d37cee5">svm_get_cs_db_l_bits</a> (struct kvm_vcpu *vcpu, int *db, int *l)</td></tr>
<tr class="separator:aa993ddc604d61adf2f6b26668d37cee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acce4be1ba744049afda22aa447c80228"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#acce4be1ba744049afda22aa447c80228">svm_get_idt</a> (struct kvm_vcpu *vcpu, struct desc_ptr *dt)</td></tr>
<tr class="separator:acce4be1ba744049afda22aa447c80228"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a401dcf35e3ec2d996a00c612126ae78e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a401dcf35e3ec2d996a00c612126ae78e">svm_set_idt</a> (struct kvm_vcpu *vcpu, struct desc_ptr *dt)</td></tr>
<tr class="separator:a401dcf35e3ec2d996a00c612126ae78e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaddc1011ccd3c9fc0acf431a09012569"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aaddc1011ccd3c9fc0acf431a09012569">svm_get_gdt</a> (struct kvm_vcpu *vcpu, struct desc_ptr *dt)</td></tr>
<tr class="separator:aaddc1011ccd3c9fc0acf431a09012569"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90fb234370a757876039727fc833a10d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a90fb234370a757876039727fc833a10d">svm_set_gdt</a> (struct kvm_vcpu *vcpu, struct desc_ptr *dt)</td></tr>
<tr class="separator:a90fb234370a757876039727fc833a10d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a642305873006637d55c46a0f035dff2d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a642305873006637d55c46a0f035dff2d">sev_post_set_cr3</a> (struct kvm_vcpu *vcpu, unsigned long cr3)</td></tr>
<tr class="separator:a642305873006637d55c46a0f035dff2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8f81a22445092aa0952e6a93442586b"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ab8f81a22445092aa0952e6a93442586b">svm_is_valid_cr0</a> (struct kvm_vcpu *vcpu, unsigned long cr0)</td></tr>
<tr class="separator:ab8f81a22445092aa0952e6a93442586b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9474f1273be079ac4f3c1320093c3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d">svm_set_cr0</a> (struct kvm_vcpu *vcpu, unsigned long cr0)</td></tr>
<tr class="separator:a1a9474f1273be079ac4f3c1320093c3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bfd600c22c380630d68725c8af7e709"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a7bfd600c22c380630d68725c8af7e709">svm_is_valid_cr4</a> (struct kvm_vcpu *vcpu, unsigned long cr4)</td></tr>
<tr class="separator:a7bfd600c22c380630d68725c8af7e709"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec23ca96447aab4ff19f594a297bc109"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109">svm_set_cr4</a> (struct kvm_vcpu *vcpu, unsigned long cr4)</td></tr>
<tr class="separator:aec23ca96447aab4ff19f594a297bc109"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c278e923bb07084a7b0f64312968d9e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a7c278e923bb07084a7b0f64312968d9e">svm_set_segment</a> (struct kvm_vcpu *vcpu, struct kvm_segment *var, int seg)</td></tr>
<tr class="separator:a7c278e923bb07084a7b0f64312968d9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb01a3f5d5204374edbbdb185d87ffcd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aeb01a3f5d5204374edbbdb185d87ffcd">svm_update_exception_bitmap</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aeb01a3f5d5204374edbbdb185d87ffcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ec4f210ddd96122d1d787a383483514"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1ec4f210ddd96122d1d787a383483514">new_asid</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, struct <a class="el" href="structsvm__cpu__data.html">svm_cpu_data</a> *sd)</td></tr>
<tr class="separator:a1ec4f210ddd96122d1d787a383483514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4202e53ce31f4e2eb93adf37be9ec5d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af4202e53ce31f4e2eb93adf37be9ec5d">svm_set_dr6</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, unsigned long value)</td></tr>
<tr class="separator:af4202e53ce31f4e2eb93adf37be9ec5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e925350e4b7d486cb0b9bace97fc5f0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a8e925350e4b7d486cb0b9bace97fc5f0">svm_sync_dirty_debug_regs</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a8e925350e4b7d486cb0b9bace97fc5f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a862a657ea41e77d18613b33cd6599b90"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a862a657ea41e77d18613b33cd6599b90">svm_set_dr7</a> (struct kvm_vcpu *vcpu, unsigned long value)</td></tr>
<tr class="separator:a862a657ea41e77d18613b33cd6599b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a589e870c8a06d1ba26f24da299e47b95"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a589e870c8a06d1ba26f24da299e47b95">pf_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a589e870c8a06d1ba26f24da299e47b95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a723646ac5d3234ba8e1845249e6a0935"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a723646ac5d3234ba8e1845249e6a0935">npf_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a723646ac5d3234ba8e1845249e6a0935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae58d4aefe6338d19f8c4c62b4e7e96e8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ae58d4aefe6338d19f8c4c62b4e7e96e8">db_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ae58d4aefe6338d19f8c4c62b4e7e96e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb29e6bc4a1888cb1b8df7b5ab3fd75"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#affb29e6bc4a1888cb1b8df7b5ab3fd75">bp_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:affb29e6bc4a1888cb1b8df7b5ab3fd75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a945e4b7aeb0acfaeed484133937f5b1f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a945e4b7aeb0acfaeed484133937f5b1f">ud_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a945e4b7aeb0acfaeed484133937f5b1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae26554f40628edb2bc8659279f08205a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ae26554f40628edb2bc8659279f08205a">ac_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ae26554f40628edb2bc8659279f08205a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7c5304a8c015386109035f7ab577919"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac7c5304a8c015386109035f7ab577919">is_erratum_383</a> (void)</td></tr>
<tr class="separator:ac7c5304a8c015386109035f7ab577919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1c9d228af74c8b5f794a4babc5d465b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af1c9d228af74c8b5f794a4babc5d465b">svm_handle_mce</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:af1c9d228af74c8b5f794a4babc5d465b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97325a065bd633887526f445883ad1df"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a97325a065bd633887526f445883ad1df">mc_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a97325a065bd633887526f445883ad1df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ca2b108d5447ed4093cb0b07092b07d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a2ca2b108d5447ed4093cb0b07092b07d">shutdown_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a2ca2b108d5447ed4093cb0b07092b07d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73e8f5db4571aa9511e75f30e939fe89"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a73e8f5db4571aa9511e75f30e939fe89">io_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a73e8f5db4571aa9511e75f30e939fe89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53732c8ad918b98c56008b492578c462"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a53732c8ad918b98c56008b492578c462">nmi_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a53732c8ad918b98c56008b492578c462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada885d8d01d76b364afd5791c676bdd5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ada885d8d01d76b364afd5791c676bdd5">smi_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ada885d8d01d76b364afd5791c676bdd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21af2401d39dc5c49a388960ce1196ad"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a21af2401d39dc5c49a388960ce1196ad">intr_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a21af2401d39dc5c49a388960ce1196ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22d5ad8a3cac7e24cb8438a20eb39348"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a22d5ad8a3cac7e24cb8438a20eb39348">vmload_vmsave_interception</a> (struct kvm_vcpu *vcpu, bool vmload)</td></tr>
<tr class="separator:a22d5ad8a3cac7e24cb8438a20eb39348"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c0c414304458bb0fdecde7cc8eeb2d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a21c0c414304458bb0fdecde7cc8eeb2d">vmload_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a21c0c414304458bb0fdecde7cc8eeb2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81c9359522d571596389c15258054845"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a81c9359522d571596389c15258054845">vmsave_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a81c9359522d571596389c15258054845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d52c93beeb85ba5a99283d4eba589e1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1">vmrun_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a5d52c93beeb85ba5a99283d4eba589e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a4c593c8666cfa6b032b7bc7639b81b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a0a4c593c8666cfa6b032b7bc7639b81b">svm_instr_opcode</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a0a4c593c8666cfa6b032b7bc7639b81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eacc7b79f62ed332056217c35fe3be4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4">emulate_svm_instr</a> (struct kvm_vcpu *vcpu, int <a class="el" href="structopcode.html">opcode</a>)</td></tr>
<tr class="separator:a1eacc7b79f62ed332056217c35fe3be4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c2323b13a5022aa9f6a9ae5ebe4d830"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830">gp_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a7c2323b13a5022aa9f6a9ae5ebe4d830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c26f1ceaa6cc778d986bd33629dc539"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, bool value)</td></tr>
<tr class="separator:a5c26f1ceaa6cc778d986bd33629dc539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2c47b46c5f4c14c1ae6a64119bcb60"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60">stgi_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a0a2c47b46c5f4c14c1ae6a64119bcb60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a2beb03d1ef1d9e803c22570b5806d1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1">clgi_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a4a2beb03d1ef1d9e803c22570b5806d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23b9203e454b799b6abf131912cf296c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a23b9203e454b799b6abf131912cf296c">invlpga_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a23b9203e454b799b6abf131912cf296c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0bfadf1447f60e987b7a725eaa8915"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a2a0bfadf1447f60e987b7a725eaa8915">skinit_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a2a0bfadf1447f60e987b7a725eaa8915"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a034d0058215cd4fddf9fbaa460d3faf6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a034d0058215cd4fddf9fbaa460d3faf6">task_switch_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a034d0058215cd4fddf9fbaa460d3faf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff900c45df2faa151d783155ec034f86"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aff900c45df2faa151d783155ec034f86">svm_clr_iret_intercept</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:aff900c45df2faa151d783155ec034f86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4501b19af9ab262bc899adc902a5066"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066">svm_set_iret_intercept</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:af4501b19af9ab262bc899adc902a5066"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa5bf4dc91985f4c533268b7e4ca811d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aaa5bf4dc91985f4c533268b7e4ca811d">iret_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aaa5bf4dc91985f4c533268b7e4ca811d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d8323f0ea03667c1a23178340f6fe9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad9d8323f0ea03667c1a23178340f6fe9">invlpg_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad9d8323f0ea03667c1a23178340f6fe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a07bdc17cad850b357e8312cd17921e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a5a07bdc17cad850b357e8312cd17921e">emulate_on_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a5a07bdc17cad850b357e8312cd17921e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0c3d292847d2488f5e720fcd358771"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a9a0c3d292847d2488f5e720fcd358771">rsm_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a9a0c3d292847d2488f5e720fcd358771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08788d6a633657aa9e7e2f3b09db9b40"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40">check_selective_cr0_intercepted</a> (struct kvm_vcpu *vcpu, unsigned long val)</td></tr>
<tr class="separator:a08788d6a633657aa9e7e2f3b09db9b40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1887c4bb9c78c577fb20a129d73ea41"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41">cr_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad1887c4bb9c78c577fb20a129d73ea41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4590239d3e0b5fbad189a245207dfaa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa">cr_trap</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:af4590239d3e0b5fbad189a245207dfaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84f2d3e5d602af563ab58693bf87db77"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a84f2d3e5d602af563ab58693bf87db77">dr_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a84f2d3e5d602af563ab58693bf87db77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2ee2a03530f5b7a02a127d8b779d2ae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae">cr8_write_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:af2ee2a03530f5b7a02a127d8b779d2ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb46126747f78036462437a7bcdc2e47"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#acb46126747f78036462437a7bcdc2e47">efer_trap</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:acb46126747f78036462437a7bcdc2e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abed03713357a4ac6d8c5a1bf89e9ed10"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#abed03713357a4ac6d8c5a1bf89e9ed10">svm_get_msr_feature</a> (struct kvm_msr_entry *msr)</td></tr>
<tr class="separator:abed03713357a4ac6d8c5a1bf89e9ed10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a091db4f6d8d0fc811fdd6d9b2a775889"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a091db4f6d8d0fc811fdd6d9b2a775889">svm_get_msr</a> (struct kvm_vcpu *vcpu, struct msr_data *msr_info)</td></tr>
<tr class="separator:a091db4f6d8d0fc811fdd6d9b2a775889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90bdbebaa7d7557c12b54b7f969bc777"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a90bdbebaa7d7557c12b54b7f969bc777">svm_complete_emulated_msr</a> (struct kvm_vcpu *vcpu, int err)</td></tr>
<tr class="separator:a90bdbebaa7d7557c12b54b7f969bc777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcf271f3cd8bdb3afc435eb5f0d241bb"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#adcf271f3cd8bdb3afc435eb5f0d241bb">svm_set_vm_cr</a> (struct kvm_vcpu *vcpu, u64 data)</td></tr>
<tr class="separator:adcf271f3cd8bdb3afc435eb5f0d241bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac18b9094154a2c8b8e27c3b08c9e359"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359">svm_set_msr</a> (struct kvm_vcpu *vcpu, struct msr_data *msr)</td></tr>
<tr class="separator:aac18b9094154a2c8b8e27c3b08c9e359"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a173c3f7c02a4287d140cc0f34564a7bd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a173c3f7c02a4287d140cc0f34564a7bd">msr_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a173c3f7c02a4287d140cc0f34564a7bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab07aabd2b78a54e2f9a6bd72ffbfa404"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404">interrupt_window_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ab07aabd2b78a54e2f9a6bd72ffbfa404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad65ceb76375d4e01d2b1e11a9c227b7c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad65ceb76375d4e01d2b1e11a9c227b7c">pause_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad65ceb76375d4e01d2b1e11a9c227b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6875c998376697a8776271bc88521721"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a6875c998376697a8776271bc88521721">invpcid_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a6875c998376697a8776271bc88521721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc30f731ef4ff2d797ec137e5fab0f69"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#adc30f731ef4ff2d797ec137e5fab0f69">dump_vmcb</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:adc30f731ef4ff2d797ec137e5fab0f69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad838ad3f2e1e678e2c13720c679dc8f8"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad838ad3f2e1e678e2c13720c679dc8f8">svm_check_exit_valid</a> (u64 exit_code)</td></tr>
<tr class="separator:ad838ad3f2e1e678e2c13720c679dc8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab46a833ac93ce3fda7973768cadb1929"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ab46a833ac93ce3fda7973768cadb1929">svm_handle_invalid_exit</a> (struct kvm_vcpu *vcpu, u64 exit_code)</td></tr>
<tr class="separator:ab46a833ac93ce3fda7973768cadb1929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8afafecae406016532810194f187fe2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a8afafecae406016532810194f187fe2c">svm_invoke_exit_handler</a> (struct kvm_vcpu *vcpu, u64 exit_code)</td></tr>
<tr class="separator:a8afafecae406016532810194f187fe2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa926f80cf0e6c6d933937170b6991f3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#afa926f80cf0e6c6d933937170b6991f3">svm_get_exit_info</a> (struct kvm_vcpu *vcpu, u32 *reason, u64 *info1, u64 *info2, u32 *intr_info, u32 *error_code)</td></tr>
<tr class="separator:afa926f80cf0e6c6d933937170b6991f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f8983432f4aae138a6f4d167c561132"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132">svm_handle_exit</a> (struct kvm_vcpu *vcpu, fastpath_t exit_fastpath)</td></tr>
<tr class="separator:a3f8983432f4aae138a6f4d167c561132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1337a20b038f182d9e04102e22c45f79"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1337a20b038f182d9e04102e22c45f79">pre_svm_run</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a1337a20b038f182d9e04102e22c45f79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67bccbcbb6b439b80103663fe58cd626"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a67bccbcbb6b439b80103663fe58cd626">svm_inject_nmi</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a67bccbcbb6b439b80103663fe58cd626"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66b89ca49c9571c6ce3532b335aeed2d"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a66b89ca49c9571c6ce3532b335aeed2d">svm_is_vnmi_pending</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a66b89ca49c9571c6ce3532b335aeed2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b5b579e10dbea76b1e9711f1b793975"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1b5b579e10dbea76b1e9711f1b793975">svm_set_vnmi_pending</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a1b5b579e10dbea76b1e9711f1b793975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea4014f3f951e100eb2acc13cef94502"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aea4014f3f951e100eb2acc13cef94502">svm_inject_irq</a> (struct kvm_vcpu *vcpu, bool reinjected)</td></tr>
<tr class="separator:aea4014f3f951e100eb2acc13cef94502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1faf261e116f9d9481e1bd6796e32280"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1faf261e116f9d9481e1bd6796e32280">svm_complete_interrupt_delivery</a> (struct kvm_vcpu *vcpu, int delivery_mode, int trig_mode, int vector)</td></tr>
<tr class="separator:a1faf261e116f9d9481e1bd6796e32280"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a501d86bb28fd272f1ab52b8689b5f948"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a501d86bb28fd272f1ab52b8689b5f948">svm_deliver_interrupt</a> (struct <a class="el" href="structkvm__lapic.html">kvm_lapic</a> *apic, int delivery_mode, int trig_mode, int vector)</td></tr>
<tr class="separator:a501d86bb28fd272f1ab52b8689b5f948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa30e5cb5ad1759988fc349bd703bd4dc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aa30e5cb5ad1759988fc349bd703bd4dc">svm_update_cr8_intercept</a> (struct kvm_vcpu *vcpu, int tpr, int irr)</td></tr>
<tr class="separator:aa30e5cb5ad1759988fc349bd703bd4dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac87074e79786dc9fe0d4f587e5baf8b3"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3">svm_get_nmi_mask</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ac87074e79786dc9fe0d4f587e5baf8b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68ca826a04be38c12e0f0cd877d32029"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029">svm_set_nmi_mask</a> (struct kvm_vcpu *vcpu, bool masked)</td></tr>
<tr class="separator:a68ca826a04be38c12e0f0cd877d32029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37477553ea45acae098350e7d572ae2e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e">svm_nmi_blocked</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a37477553ea45acae098350e7d572ae2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20c1180c4bb6850bae73e3cbda53c695"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695">svm_nmi_allowed</a> (struct kvm_vcpu *vcpu, bool for_injection)</td></tr>
<tr class="separator:a20c1180c4bb6850bae73e3cbda53c695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67762809a8b14687a3bffdd5a4cd03aa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa">svm_interrupt_blocked</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a67762809a8b14687a3bffdd5a4cd03aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a005049e4b080345fc3924233b8e33bce"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a005049e4b080345fc3924233b8e33bce">svm_interrupt_allowed</a> (struct kvm_vcpu *vcpu, bool for_injection)</td></tr>
<tr class="separator:a005049e4b080345fc3924233b8e33bce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ccd7665fc572e5e6782f88c40e82e88"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88">svm_enable_irq_window</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a1ccd7665fc572e5e6782f88c40e82e88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57894275d4e8aa0a3d5a4ad55e2c4d6e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e">svm_enable_nmi_window</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a57894275d4e8aa0a3d5a4ad55e2c4d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba80ec8e0369ea53585b03f6b783e16d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aba80ec8e0369ea53585b03f6b783e16d">svm_flush_tlb_asid</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aba80ec8e0369ea53585b03f6b783e16d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89adfbeb2d2d711fc4dc821ee133248c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a89adfbeb2d2d711fc4dc821ee133248c">svm_flush_tlb_all</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a89adfbeb2d2d711fc4dc821ee133248c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cd895643ff213d3fefeaede1dae0746"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a0cd895643ff213d3fefeaede1dae0746">svm_flush_tlb_gva</a> (struct kvm_vcpu *vcpu, gva_t gva)</td></tr>
<tr class="separator:a0cd895643ff213d3fefeaede1dae0746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a640846de1c48f3e408644fcb85a6004b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a640846de1c48f3e408644fcb85a6004b">sync_cr8_to_lapic</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a640846de1c48f3e408644fcb85a6004b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7f791888ec3548c8fa076367bbc84d9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac7f791888ec3548c8fa076367bbc84d9">sync_lapic_to_cr8</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ac7f791888ec3548c8fa076367bbc84d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf1eccfcab9b8a4c710b30fec219fe14"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#adf1eccfcab9b8a4c710b30fec219fe14">svm_complete_soft_interrupt</a> (struct kvm_vcpu *vcpu, u8 vector, int type)</td></tr>
<tr class="separator:adf1eccfcab9b8a4c710b30fec219fe14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a921858ef8782f6b0eebb284c5db66de8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a921858ef8782f6b0eebb284c5db66de8">svm_complete_interrupts</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a921858ef8782f6b0eebb284c5db66de8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a508824f395cb7a7903a7f5dc7042b082"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a508824f395cb7a7903a7f5dc7042b082">svm_cancel_injection</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a508824f395cb7a7903a7f5dc7042b082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a344cfdb20819ed5fd746bc45ed5d0b55"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a344cfdb20819ed5fd746bc45ed5d0b55">svm_vcpu_pre_run</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a344cfdb20819ed5fd746bc45ed5d0b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c8447e70f06dd52623c696446104b5"><td class="memItemLeft" align="right" valign="top">static fastpath_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a82c8447e70f06dd52623c696446104b5">svm_exit_handlers_fastpath</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a82c8447e70f06dd52623c696446104b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04b96ed53c5aaf42d298205d87cd7762"><td class="memItemLeft" align="right" valign="top">static noinstr void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a04b96ed53c5aaf42d298205d87cd7762">svm_vcpu_enter_exit</a> (struct kvm_vcpu *vcpu, bool spec_ctrl_intercepted)</td></tr>
<tr class="separator:a04b96ed53c5aaf42d298205d87cd7762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d2703bd914c4ae4fcb1eb83c208b085"><td class="memItemLeft" align="right" valign="top">static __no_kcsan fastpath_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085">svm_vcpu_run</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a5d2703bd914c4ae4fcb1eb83c208b085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f28637bd5292dc7bb085750c3e31d94"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a5f28637bd5292dc7bb085750c3e31d94">svm_load_mmu_pgd</a> (struct kvm_vcpu *vcpu, hpa_t root_hpa, int root_level)</td></tr>
<tr class="separator:a5f28637bd5292dc7bb085750c3e31d94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6140ed0efc94e021cb04529340c1dc98"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a6140ed0efc94e021cb04529340c1dc98">svm_patch_hypercall</a> (struct kvm_vcpu *vcpu, unsigned char *hypercall)</td></tr>
<tr class="separator:a6140ed0efc94e021cb04529340c1dc98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40fda471b3faf8734e7467631861c082"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a40fda471b3faf8734e7467631861c082">svm_has_emulated_msr</a> (struct kvm *kvm, u32 index)</td></tr>
<tr class="separator:a40fda471b3faf8734e7467631861c082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a204e4c169e1e8029eff521725a526a57"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57">svm_vcpu_after_set_cpuid</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a204e4c169e1e8029eff521725a526a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a942df5fa6c49bd103275f10b5af1d847"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a942df5fa6c49bd103275f10b5af1d847">svm_has_wbinvd_exit</a> (void)</td></tr>
<tr class="separator:a942df5fa6c49bd103275f10b5af1d847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae135f7d753cde05e6f726fb75e971ddd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd">svm_check_intercept</a> (struct kvm_vcpu *vcpu, struct <a class="el" href="structx86__instruction__info.html">x86_instruction_info</a> *info, enum <a class="el" href="kvm__emulate_8h.html#add7a52f580084c3e63d2d85407ad2611">x86_intercept_stage</a> stage, struct <a class="el" href="structx86__exception.html">x86_exception</a> *exception)</td></tr>
<tr class="separator:ae135f7d753cde05e6f726fb75e971ddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af104b66d9c914ae84dffcd6d99833e56"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af104b66d9c914ae84dffcd6d99833e56">svm_handle_exit_irqoff</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:af104b66d9c914ae84dffcd6d99833e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3f43ee7024c775ce671371e2bb5bf98"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aa3f43ee7024c775ce671371e2bb5bf98">svm_sched_in</a> (struct kvm_vcpu *vcpu, int cpu)</td></tr>
<tr class="separator:aa3f43ee7024c775ce671371e2bb5bf98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a346257464a9f6d1e9ea4f27c4e8fcc61"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a346257464a9f6d1e9ea4f27c4e8fcc61">svm_setup_mce</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a346257464a9f6d1e9ea4f27c4e8fcc61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ea9c19442062c9e284d39852ffab26"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a28ea9c19442062c9e284d39852ffab26">svm_check_emulate_instruction</a> (struct kvm_vcpu *vcpu, int emul_type, void *insn, int insn_len)</td></tr>
<tr class="separator:a28ea9c19442062c9e284d39852ffab26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7bf4b32b7e7a7cfa632783dd5e6fbf"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aca7bf4b32b7e7a7cfa632783dd5e6fbf">svm_apic_init_signal_blocked</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aca7bf4b32b7e7a7cfa632783dd5e6fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8932e9146797ddd1e75d6d8dd4afc23"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac8932e9146797ddd1e75d6d8dd4afc23">svm_vcpu_deliver_sipi_vector</a> (struct kvm_vcpu *vcpu, u8 vector)</td></tr>
<tr class="separator:ac8932e9146797ddd1e75d6d8dd4afc23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e69cefce46e7b11e1e8e056ea5b6561"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a0e69cefce46e7b11e1e8e056ea5b6561">svm_vm_destroy</a> (struct kvm *kvm)</td></tr>
<tr class="separator:a0e69cefce46e7b11e1e8e056ea5b6561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad90f40489ad04f5f81a69a87f36e4eca"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad90f40489ad04f5f81a69a87f36e4eca">svm_vm_init</a> (struct kvm *kvm)</td></tr>
<tr class="separator:ad90f40489ad04f5f81a69a87f36e4eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ce56e3c8875ba1d607bb1be8ed420f"><td class="memItemLeft" align="right" valign="top">static __init void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ae9ce56e3c8875ba1d607bb1be8ed420f">svm_adjust_mmio_mask</a> (void)</td></tr>
<tr class="separator:ae9ce56e3c8875ba1d607bb1be8ed420f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2ed2d9e233f1c6a1a3c806826d63401"><td class="memItemLeft" align="right" valign="top">static __init void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ab2ed2d9e233f1c6a1a3c806826d63401">svm_set_cpu_caps</a> (void)</td></tr>
<tr class="separator:ab2ed2d9e233f1c6a1a3c806826d63401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4cdf4791105d54ebcadfeafdcdf01ac"><td class="memItemLeft" align="right" valign="top">static __init int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac">svm_hardware_setup</a> (void)</td></tr>
<tr class="separator:aa4cdf4791105d54ebcadfeafdcdf01ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b14d1e0632116bdfd341cd3c892a5eb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a5b14d1e0632116bdfd341cd3c892a5eb">__svm_exit</a> (void)</td></tr>
<tr class="separator:a5b14d1e0632116bdfd341cd3c892a5eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa667b0a0f202f83aa1533825aeecb402"><td class="memItemLeft" align="right" valign="top">static int __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aa667b0a0f202f83aa1533825aeecb402">svm_init</a> (void)</td></tr>
<tr class="separator:aa667b0a0f202f83aa1533825aeecb402"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae292292ef2cf8cb0d48cfa27ce94ef88"><td class="memItemLeft" align="right" valign="top">static void __exit&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ae292292ef2cf8cb0d48cfa27ce94ef88">svm_exit</a> (void)</td></tr>
<tr class="separator:ae292292ef2cf8cb0d48cfa27ce94ef88"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a654225ed9cb5ee3717561aed704a8012"><td class="memItemLeft" align="right" valign="top">static bool erratum_383_found&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a654225ed9cb5ee3717561aed704a8012">__read_mostly</a> = -1</td></tr>
<tr class="separator:a654225ed9cb5ee3717561aed704a8012"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cd9c6d58f164e1428e93fac80a1fc34"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a9cd9c6d58f164e1428e93fac80a1fc34">osvw_len</a> = 4</td></tr>
<tr class="separator:a9cd9c6d58f164e1428e93fac80a1fc34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad74f8bf67f324d305a1bde6cebadd841"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad74f8bf67f324d305a1bde6cebadd841">osvw_status</a></td></tr>
<tr class="separator:ad74f8bf67f324d305a1bde6cebadd841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad73a1ea1e074171f7049d11e84aa1814"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="structsvm__direct__access__msrs.html">svm_direct_access_msrs</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a> [<a class="el" href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">MAX_DIRECT_ACCESS_MSRS</a>]</td></tr>
<tr class="separator:ad73a1ea1e074171f7049d11e84aa1814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7844865730b4425faa277774dddb41b6"><td class="memItemLeft" align="right" valign="top">static unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a7844865730b4425faa277774dddb41b6">pause_filter_thresh</a> = <a class="el" href="x86_8h.html#ac4cf971fee08547c5647367a9393fca2">KVM_DEFAULT_PLE_GAP</a></td></tr>
<tr class="separator:a7844865730b4425faa277774dddb41b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bc68316af32e407d865d83e00a03316"><td class="memItemLeft" align="right" valign="top">static unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a3bc68316af32e407d865d83e00a03316">pause_filter_count</a> = <a class="el" href="x86_8h.html#a59cb051233b1de170d81a73ed5aeda6d">KVM_SVM_DEFAULT_PLE_WINDOW</a></td></tr>
<tr class="separator:a3bc68316af32e407d865d83e00a03316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64b792e4e2d6162271f1704fbabc4884"><td class="memItemLeft" align="right" valign="top">static unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a64b792e4e2d6162271f1704fbabc4884">pause_filter_count_grow</a> = <a class="el" href="x86_8h.html#a8dbcf8fedcb1848df9b0915ee77ad3dd">KVM_DEFAULT_PLE_WINDOW_GROW</a></td></tr>
<tr class="separator:a64b792e4e2d6162271f1704fbabc4884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad71d914e223758efb4dcac69978f4083"><td class="memItemLeft" align="right" valign="top">static unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ad71d914e223758efb4dcac69978f4083">pause_filter_count_shrink</a> = <a class="el" href="x86_8h.html#a65245c185743fd9f09cab0ea68087bda">KVM_DEFAULT_PLE_WINDOW_SHRINK</a></td></tr>
<tr class="separator:ad71d914e223758efb4dcac69978f4083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5ab188f15144152c91129b044a371d8"><td class="memItemLeft" align="right" valign="top">static unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac5ab188f15144152c91129b044a371d8">pause_filter_count_max</a> = <a class="el" href="x86_8h.html#a8d95d1ac359797529714473f95160801">KVM_SVM_DEFAULT_PLE_WINDOW_MAX</a></td></tr>
<tr class="separator:ac5ab188f15144152c91129b044a371d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17a219d0651f1db709a3af0fc5527aa0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a> = true</td></tr>
<tr class="separator:a17a219d0651f1db709a3af0fc5527aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe2e85eb9e667809ab7e5dd3ad442b26"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#abe2e85eb9e667809ab7e5dd3ad442b26">nested</a> = true</td></tr>
<tr class="separator:abe2e85eb9e667809ab7e5dd3ad442b26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea86d846f25c8a44402d3bc2d176130b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a> = true</td></tr>
<tr class="separator:aea86d846f25c8a44402d3bc2d176130b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad937a1fd2ef8fcdd87953c6a5db405"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a3ad937a1fd2ef8fcdd87953c6a5db405">vls</a> = true</td></tr>
<tr class="separator:a3ad937a1fd2ef8fcdd87953c6a5db405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0a8ab91829811c7705c6455fb294bbc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a> = true</td></tr>
<tr class="separator:ab0a8ab91829811c7705c6455fb294bbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6093899c4533e4c669b24862528077d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac6093899c4533e4c669b24862528077d">lbrv</a> = true</td></tr>
<tr class="separator:ac6093899c4533e4c669b24862528077d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adacf7fe5bb2bb2fdef07153a859b75ba"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#adacf7fe5bb2bb2fdef07153a859b75ba">tsc_scaling</a> = true</td></tr>
<tr class="separator:adacf7fe5bb2bb2fdef07153a859b75ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c4ea69d2d0310307567f305689357f8"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a8c4ea69d2d0310307567f305689357f8">avic</a></td></tr>
<tr class="separator:a8c4ea69d2d0310307567f305689357f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66f9274e37ab06b0ee941e4480352ba8"><td class="memItemLeft" align="right" valign="top">bool <a class="el" href="x86_8c.html#a721f8d5b210e9625587f13b92870ba38">__read_mostly</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a66f9274e37ab06b0ee941e4480352ba8">dump_invalid_vmcb</a></td></tr>
<tr class="separator:a66f9274e37ab06b0ee941e4480352ba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8812d5d875ec9a2bf431790db71cfb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#adc8812d5d875ec9a2bf431790db71cfb">intercept_smi</a> = true</td></tr>
<tr class="separator:adc8812d5d875ec9a2bf431790db71cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d0afd60cabe4ff8b40d7099f49a1bb8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a> = true</td></tr>
<tr class="separator:a8d0afd60cabe4ff8b40d7099f49a1bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a275c3d046aa0623ea238016c5002acbd"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a275c3d046aa0623ea238016c5002acbd">svm_gp_erratum_intercept</a> = true</td></tr>
<tr class="separator:a275c3d046aa0623ea238016c5002acbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a698bd21413d89411791bef819c6dbbf9"><td class="memItemLeft" align="right" valign="top">static u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a698bd21413d89411791bef819c6dbbf9">rsm_ins_bytes</a> [] = &quot;\x0f\xaa&quot;</td></tr>
<tr class="separator:a698bd21413d89411791bef819c6dbbf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f8324fee7e48032e60893cd7590076"><td class="memItemLeft" align="right" valign="top">static unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a14f8324fee7e48032e60893cd7590076">iopm_base</a></td></tr>
<tr class="separator:a14f8324fee7e48032e60893cd7590076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee88cc07545f234f7f296637887bb17c"><td class="memItemLeft" align="right" valign="top">static const u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a> [] = {0, 0xc0000000, 0xc0010000}</td></tr>
<tr class="separator:aee88cc07545f234f7f296637887bb17c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af73415c5c6c2827a7671c0d2cc5b1c4f"><td class="memItemLeft" align="right" valign="top">static int(*const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#af73415c5c6c2827a7671c0d2cc5b1c4f">svm_exit_handlers</a> [])(struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:af73415c5c6c2827a7671c0d2cc5b1c4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5081d9a75e59287f7ae5e120d6ac4758"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="struct____x86__intercept.html">__x86_intercept</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#a5081d9a75e59287f7ae5e120d6ac4758">x86_intercept_map</a> []</td></tr>
<tr class="separator:a5081d9a75e59287f7ae5e120d6ac4758"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7d9d348c903d8605668fa4a24248bef"><td class="memItemLeft" align="right" valign="top">static struct kvm_x86_ops svm_x86_ops&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8c.html#ac7d9d348c903d8605668fa4a24248bef">__initdata</a></td></tr>
<tr class="separator:ac7d9d348c903d8605668fa4a24248bef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af489914c8a592f433c39b3372585889e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af489914c8a592f433c39b3372585889e">&#9670;&nbsp;</a></span>CR_VALID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CR_VALID&#160;&#160;&#160;(1ULL &lt;&lt; 63)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02623">2623</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a6c585eaa599f4c72e9f1f6fcc1ea0fb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c585eaa599f4c72e9f1f6fcc1ea0fb8">&#9670;&nbsp;</a></span>MSRS_IN_RANGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSRS_IN_RANGE&#160;&#160;&#160;(<a class="el" href="svm_8c.html#a0c8786ad06a6d122f851eee8d43424d9">MSRS_RANGE_SIZE</a> * 8 / 2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00262">262</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a0c8786ad06a6d122f851eee8d43424d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c8786ad06a6d122f851eee8d43424d9">&#9670;&nbsp;</a></span>MSRS_RANGE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSRS_RANGE_SIZE&#160;&#160;&#160;2048</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00261">261</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="ac84410b6049231218187535376fcbdba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac84410b6049231218187535376fcbdba">&#9670;&nbsp;</a></span>NUM_MSR_MAPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_MSR_MAPS&#160;&#160;&#160;ARRAY_SIZE(<a class="el" href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00260">260</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a79fe7d541a228e862eb4dc87922de3d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79fe7d541a228e862eb4dc87922de3d9">&#9670;&nbsp;</a></span>POST_EX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POST_EX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exit</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">            { .exit_code = (exit), \</div>
<div class="line">            .stage = <a class="code" href="kvm__emulate_8h.html#add7a52f580084c3e63d2d85407ad2611ad8abf790288d252b4fdbbc6bd7c0b71f">X86_ICPT_POST_EXCEPT</a>, }</div>
<div class="ttc" id="akvm__emulate_8h_html_add7a52f580084c3e63d2d85407ad2611ad8abf790288d252b4fdbbc6bd7c0b71f"><div class="ttname"><a href="kvm__emulate_8h.html#add7a52f580084c3e63d2d85407ad2611ad8abf790288d252b4fdbbc6bd7c0b71f">X86_ICPT_POST_EXCEPT</a></div><div class="ttdeci">@ X86_ICPT_POST_EXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00438">kvm_emulate.h:438</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04365">4365</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="aac6de7da0316443b810d97be36e928b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac6de7da0316443b810d97be36e928b4">&#9670;&nbsp;</a></span>POST_MEM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POST_MEM</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exit</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">            { .exit_code = (exit), \</div>
<div class="line">            .stage = <a class="code" href="kvm__emulate_8h.html#add7a52f580084c3e63d2d85407ad2611aadc465f46355a790882dd9ffaae12d12">X86_ICPT_POST_MEMACCESS</a>, }</div>
<div class="ttc" id="akvm__emulate_8h_html_add7a52f580084c3e63d2d85407ad2611aadc465f46355a790882dd9ffaae12d12"><div class="ttname"><a href="kvm__emulate_8h.html#add7a52f580084c3e63d2d85407ad2611aadc465f46355a790882dd9ffaae12d12">X86_ICPT_POST_MEMACCESS</a></div><div class="ttdeci">@ X86_ICPT_POST_MEMACCESS</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00439">kvm_emulate.h:439</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04367">4367</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a1f8c165bf4196327bc3abff648276d92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f8c165bf4196327bc3abff648276d92">&#9670;&nbsp;</a></span>pr_fmt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define pr_fmt</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt</td><td>)</td>
          <td>&#160;&#160;&#160;KBUILD_MODNAME &quot;: &quot; fmt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00001">1</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="ac6ff7f6576ef59b7a7a0b6f549eb01b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6ff7f6576ef59b7a7a0b6f549eb01b7">&#9670;&nbsp;</a></span>PRE_EX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRE_EX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exit</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">            { .exit_code = (exit), \</div>
<div class="line">            .stage = <a class="code" href="kvm__emulate_8h.html#add7a52f580084c3e63d2d85407ad2611acefb820412e67aaa16f58d8b08af6027">X86_ICPT_PRE_EXCEPT</a>, }</div>
<div class="ttc" id="akvm__emulate_8h_html_add7a52f580084c3e63d2d85407ad2611acefb820412e67aaa16f58d8b08af6027"><div class="ttname"><a href="kvm__emulate_8h.html#add7a52f580084c3e63d2d85407ad2611acefb820412e67aaa16f58d8b08af6027">X86_ICPT_PRE_EXCEPT</a></div><div class="ttdeci">@ X86_ICPT_PRE_EXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00437">kvm_emulate.h:437</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04363">4363</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="aa07431310e9e653530a11e6f39606cc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa07431310e9e653530a11e6f39606cc9">&#9670;&nbsp;</a></span>SEG_TYPE_BUSY_TSS16</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEG_TYPE_BUSY_TSS16&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00067">67</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a1123609025ff8c35fcebbeefc627fe40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1123609025ff8c35fcebbeefc627fe40">&#9670;&nbsp;</a></span>SEG_TYPE_LDT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEG_TYPE_LDT&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00066">66</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a7d7d4f0ffdcfcfdc6d979e434be6e25e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d7d4f0ffdcfcfdc6d979e434be6e25e">&#9670;&nbsp;</a></span>X2APIC_MSR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X2APIC_MSR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(APIC_BASE_MSR + (x &gt;&gt; 4))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00081">81</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aedcf2109f459315e1a7f2af73ec9b603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedcf2109f459315e1a7f2af73ec9b603">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aedcf2109f459315e1a7f2af73ec9b603acde1334d18ebb932ec5a98bf93c431ae"></a>NONE_SVM_INSTR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aedcf2109f459315e1a7f2af73ec9b603a4fc4da3a6a1a9c998f04b7988ba00834"></a>SVM_INSTR_VMRUN&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aedcf2109f459315e1a7f2af73ec9b603aafab86473fad2281466fe8b1d89b74d9"></a>SVM_INSTR_VMLOAD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aedcf2109f459315e1a7f2af73ec9b603a5eb1e788833fd7f4e89343327e575e32"></a>SVM_INSTR_VMSAVE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02304">2304</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;     {</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603acde1334d18ebb932ec5a98bf93c431ae">NONE_SVM_INSTR</a>,</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a4fc4da3a6a1a9c998f04b7988ba00834">SVM_INSTR_VMRUN</a>,</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603aafab86473fad2281466fe8b1d89b74d9">SVM_INSTR_VMLOAD</a>,</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a5eb1e788833fd7f4e89343327e575e32">SVM_INSTR_VMSAVE</a>,</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;};</div>
<div class="ttc" id="asvm_8c_html_aedcf2109f459315e1a7f2af73ec9b603a4fc4da3a6a1a9c998f04b7988ba00834"><div class="ttname"><a href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a4fc4da3a6a1a9c998f04b7988ba00834">SVM_INSTR_VMRUN</a></div><div class="ttdeci">@ SVM_INSTR_VMRUN</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02306">svm.c:2306</a></div></div>
<div class="ttc" id="asvm_8c_html_aedcf2109f459315e1a7f2af73ec9b603a5eb1e788833fd7f4e89343327e575e32"><div class="ttname"><a href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a5eb1e788833fd7f4e89343327e575e32">SVM_INSTR_VMSAVE</a></div><div class="ttdeci">@ SVM_INSTR_VMSAVE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02308">svm.c:2308</a></div></div>
<div class="ttc" id="asvm_8c_html_aedcf2109f459315e1a7f2af73ec9b603aafab86473fad2281466fe8b1d89b74d9"><div class="ttname"><a href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603aafab86473fad2281466fe8b1d89b74d9">SVM_INSTR_VMLOAD</a></div><div class="ttdeci">@ SVM_INSTR_VMLOAD</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02307">svm.c:2307</a></div></div>
<div class="ttc" id="asvm_8c_html_aedcf2109f459315e1a7f2af73ec9b603acde1334d18ebb932ec5a98bf93c431ae"><div class="ttname"><a href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603acde1334d18ebb932ec5a98bf93c431ae">NONE_SVM_INSTR</a></div><div class="ttdeci">@ NONE_SVM_INSTR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02305">svm.c:2305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0c5962ecf16b873fd88c7d6664ea7f0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c5962ecf16b873fd88c7d6664ea7f0c">&#9670;&nbsp;</a></span>__kvm_is_svm_supported()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool __kvm_is_svm_supported </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00520">520</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;{</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">int</span> cpu = smp_processor_id();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keyword">struct </span>cpuinfo_x86 *c = &amp;cpu_data(cpu);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">if</span> (c-&gt;x86_vendor != X86_VENDOR_AMD &amp;&amp;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        c-&gt;x86_vendor != X86_VENDOR_HYGON) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        pr_err(<span class="stringliteral">&quot;CPU %d isn&#39;t AMD or Hygon\n&quot;</span>, cpu);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span> (!cpu_has(c, X86_FEATURE_SVM)) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        pr_err(<span class="stringliteral">&quot;SVM not supported by CPU %d\n&quot;</span>, cpu);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">if</span> (cc_platform_has(CC_ATTR_GUEST_MEM_ENCRYPT)) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        pr_info(<span class="stringliteral">&quot;KVM is unsupported when running as an SEV guest\n&quot;</span>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a0c5962ecf16b873fd88c7d6664ea7f0c_icgraph.png" border="0" usemap="#asvm_8c_a0c5962ecf16b873fd88c7d6664ea7f0c_icgraph" alt=""/></div>
<map name="asvm_8c_a0c5962ecf16b873fd88c7d6664ea7f0c_icgraph" id="asvm_8c_a0c5962ecf16b873fd88c7d6664ea7f0c_icgraph">
<area shape="rect" title=" " alt="" coords="356,35,547,61"/>
<area shape="rect" href="svm_8c.html#ad1ba53021522940c5c8b84e82d574243" title=" " alt="" coords="132,5,308,32"/>
<area shape="rect" href="svm_8c.html#ad903be303ec3da29f6f41d563d9cef80" title=" " alt="" coords="137,57,303,98"/>
<area shape="rect" href="svm_8c.html#aa667b0a0f202f83aa1533825aeecb402" title=" " alt="" coords="5,5,84,32"/>
</map>
</div>

</div>
</div>
<a id="a5b14d1e0632116bdfd341cd3c892a5eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b14d1e0632116bdfd341cd3c892a5eb">&#9670;&nbsp;</a></span>__svm_exit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __svm_exit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l05335">5335</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;{</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;    <a class="code" href="x86_8c.html#a6b0e9d5b7fc8842b6316f94643af7023">kvm_x86_vendor_exit</a>();</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160; </div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;    cpu_emergency_unregister_virt_callback(<a class="code" href="svm_8c.html#ab4fa734cd92223a6150551cd5243b4aa">svm_emergency_disable</a>);</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_ab4fa734cd92223a6150551cd5243b4aa"><div class="ttname"><a href="svm_8c.html#ab4fa734cd92223a6150551cd5243b4aa">svm_emergency_disable</a></div><div class="ttdeci">static void svm_emergency_disable(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00588">svm.c:588</a></div></div>
<div class="ttc" id="ax86_8c_html_a6b0e9d5b7fc8842b6316f94643af7023"><div class="ttname"><a href="x86_8c.html#a6b0e9d5b7fc8842b6316f94643af7023">kvm_x86_vendor_exit</a></div><div class="ttdeci">void kvm_x86_vendor_exit(void)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09798">x86.c:9798</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5b14d1e0632116bdfd341cd3c892a5eb_cgraph.png" border="0" usemap="#asvm_8c_a5b14d1e0632116bdfd341cd3c892a5eb_cgraph" alt=""/></div>
<map name="asvm_8c_a5b14d1e0632116bdfd341cd3c892a5eb_cgraph" id="asvm_8c_a5b14d1e0632116bdfd341cd3c892a5eb_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,101,108"/>
<area shape="rect" href="x86_8c.html#a6b0e9d5b7fc8842b6316f94643af7023" title=" " alt="" coords="158,56,325,83"/>
<area shape="rect" href="svm_8c.html#ab4fa734cd92223a6150551cd5243b4aa" title=" " alt="" coords="149,107,333,133"/>
<area shape="rect" href="lapic_8c.html#af2d9c133a24e68f345a3fe133bf8bfaf" title=" " alt="" coords="437,5,558,32"/>
<area shape="rect" href="mmu_8c.html#a300e442ad7216d17c3ad006fab006622" title=" " alt="" coords="381,56,613,83"/>
<area shape="rect" href="mmu_8c.html#a7972fb42d26603fda02b76d2ab6e6d8b" title=" " alt="" coords="661,56,825,83"/>
<area shape="rect" href="svm_8c.html#a53176c61179bfcec5f1c122b110cc8c3" title=" " alt="" coords="412,107,583,133"/>
<area shape="rect" href="svm__ops_8h.html#a97407302752e909143951887456521ef" title=" " alt="" coords="720,107,767,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5b14d1e0632116bdfd341cd3c892a5eb_icgraph.png" border="0" usemap="#asvm_8c_a5b14d1e0632116bdfd341cd3c892a5eb_icgraph" alt=""/></div>
<map name="asvm_8c_a5b14d1e0632116bdfd341cd3c892a5eb_icgraph" id="asvm_8c_a5b14d1e0632116bdfd341cd3c892a5eb_icgraph">
<area shape="rect" title=" " alt="" coords="136,31,232,57"/>
<area shape="rect" href="svm_8c.html#ae292292ef2cf8cb0d48cfa27ce94ef88" title=" " alt="" coords="5,5,88,32"/>
<area shape="rect" href="svm_8c.html#aa667b0a0f202f83aa1533825aeecb402" title=" " alt="" coords="7,56,86,83"/>
</map>
</div>

</div>
</div>
<a id="a1f6d0a95558c52f05d9b3b97b2710cfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f6d0a95558c52f05d9b3b97b2710cfe">&#9670;&nbsp;</a></span>__svm_skip_emulated_instruction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __svm_skip_emulated_instruction </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>commit_side_effects</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00369">369</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;{</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> old_rflags;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">     * SEV-ES does not expose the next RIP. The RIP update is controlled by</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">     * the type of exit and the #VC handler in the guest.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">goto</span> done;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a> &amp;&amp; svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.next_rip != 0) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        WARN_ON_ONCE(!static_cpu_has(X86_FEATURE_NRIPS));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af9472805586ac10a411dde4a890047ac">next_rip</a> = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.next_rip;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (!svm-&gt;<a class="code" href="structvcpu__svm.html#af9472805586ac10a411dde4a890047ac">next_rip</a>) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">if</span> (unlikely(!commit_side_effects))</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            old_rflags = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rflags;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646">kvm_emulate_instruction</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, EMULTYPE_SKIP))</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> (unlikely(!commit_side_effects))</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rflags = old_rflags;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f">kvm_rip_write</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#af9472805586ac10a411dde4a890047ac">next_rip</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;done:</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> (likely(commit_side_effects))</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="svm_8c.html#a88f50f26e46655ddf4e070bcabcc66ad">svm_set_interrupt_shadow</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, 0);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div>
<div class="ttc" id="akvm__cache__regs_8h_html_aa70071fd3a98f236b0b57a30cbec124f"><div class="ttname"><a href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f">kvm_rip_write</a></div><div class="ttdeci">static void kvm_rip_write(struct kvm_vcpu *vcpu, unsigned long val)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00121">kvm_cache_regs.h:121</a></div></div>
<div class="ttc" id="astructvcpu__svm_html"><div class="ttname"><a href="structvcpu__svm.html">vcpu_svm</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00209">svm.h:209</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af095ed7bcc31c036e28e533582723a60"><div class="ttname"><a href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vcpu_svm::vmcb</a></div><div class="ttdeci">struct vmcb * vmcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00212">svm.h:212</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af164d8d741d9ea90dae6a46974d29f9e"><div class="ttname"><a href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu_svm::vcpu</a></div><div class="ttdeci">struct kvm_vcpu vcpu</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00206">svm.h:210</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af9472805586ac10a411dde4a890047ac"><div class="ttname"><a href="structvcpu__svm.html#af9472805586ac10a411dde4a890047ac">vcpu_svm::next_rip</a></div><div class="ttdeci">u64 next_rip</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00222">svm.h:222</a></div></div>
<div class="ttc" id="asvm_8c_html_a88f50f26e46655ddf4e070bcabcc66ad"><div class="ttname"><a href="svm_8c.html#a88f50f26e46655ddf4e070bcabcc66ad">svm_set_interrupt_shadow</a></div><div class="ttdeci">static void svm_set_interrupt_shadow(struct kvm_vcpu *vcpu, int mask)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00358">svm.c:358</a></div></div>
<div class="ttc" id="asvm_8c_html_aea86d846f25c8a44402d3bc2d176130b"><div class="ttname"><a href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a></div><div class="ttdeci">int nrips</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00206">svm.c:206</a></div></div>
<div class="ttc" id="asvm_8h_html_a14877439e9d41030cb21612eecc8f3f9"><div class="ttname"><a href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a></div><div class="ttdeci">static __always_inline bool sev_es_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00332">svm.h:332</a></div></div>
<div class="ttc" id="asvm_8h_html_a83e420c88631faf9613ea3caa72c63b7"><div class="ttname"><a href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a></div><div class="ttdeci">static __always_inline struct vcpu_svm * to_svm(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00364">svm.h:364</a></div></div>
<div class="ttc" id="ax86_8c_html_a117738c7e069e71d58ab48a581bfc646"><div class="ttname"><a href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646">kvm_emulate_instruction</a></div><div class="ttdeci">int kvm_emulate_instruction(struct kvm_vcpu *vcpu, int emulation_type)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09262">x86.c:9262</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1f6d0a95558c52f05d9b3b97b2710cfe_cgraph.png" border="0" usemap="#asvm_8c_a1f6d0a95558c52f05d9b3b97b2710cfe_cgraph" alt=""/></div>
<map name="asvm_8c_a1f6d0a95558c52f05d9b3b97b2710cfe_cgraph" id="asvm_8c_a1f6d0a95558c52f05d9b3b97b2710cfe_cgraph">
<area shape="rect" title=" " alt="" coords="5,1497,172,1538"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="225,1403,413,1429"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="738,1453,853,1480"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="263,1504,374,1531"/>
<area shape="rect" href="svm_8c.html#a88f50f26e46655ddf4e070bcabcc66ad" title=" " alt="" coords="220,1605,417,1632"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="521,1580,592,1607"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="465,759,648,785"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="975,275,1110,301"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="697,1184,894,1211"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="706,1235,885,1261"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="719,27,872,69"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="734,1352,857,1379"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="701,835,889,861"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="958,763,1127,789"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1425,729,1609,756"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="696,683,895,709"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="715,121,875,162"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="700,259,891,285"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="715,361,876,402"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="705,187,886,213"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="735,427,856,453"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="709,478,881,519"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="702,544,889,571"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="714,981,877,1008"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="731,1032,860,1059"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="714,733,877,760"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="999,1301,1086,1328"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="711,1286,880,1327"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="725,1083,866,1109"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1215,333,1353,360"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1444,443,1591,469"/>
<area shape="rect" href="x86_8c.html#a2a7f61481aae2e0bfe4baaba68d6d650" title=" " alt="" coords="957,1352,1128,1379"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="967,5,1118,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1457,1032,1577,1059"/>
<area shape="rect" href="x86_8c.html#aea69aad92f3a36aaebec0c2a9e853b61" title=" " alt="" coords="954,865,1131,906"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1193,729,1375,756"/>
<area shape="rect" href="x86_8c.html#a8bbfd08c002f2e09b42bb56cd8f52653" title=" " alt="" coords="961,697,1124,738"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="981,107,1104,133"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="963,158,1122,199"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="955,224,1130,251"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="957,56,1128,83"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="953,1453,1132,1480"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="1191,1453,1377,1480"/>
<area shape="rect" href="x86_8c.html#a0a47622bf3c21272e9e0357e1f90540a" title=" " alt="" coords="951,377,1135,418"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="951,544,1135,571"/>
<area shape="rect" href="x86_8c.html#a2857d8949e4bb5216636d3f7b03edc88" title=" " alt="" coords="951,325,1134,352"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="997,981,1088,1008"/>
<area shape="rect" href="x86_8c.html#a52a62306898287a4475c0b6e78b30bf8" title=" " alt="" coords="955,1134,1130,1175"/>
<area shape="rect" href="mmu_8c.html#a45417375d740e0905773ac641827e0a0" title=" " alt="" coords="943,1083,1143,1109"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="503,1504,610,1531"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1f6d0a95558c52f05d9b3b97b2710cfe_icgraph.png" border="0" usemap="#asvm_8c_a1f6d0a95558c52f05d9b3b97b2710cfe_icgraph" alt=""/></div>
<map name="asvm_8c_a1f6d0a95558c52f05d9b3b97b2710cfe_icgraph" id="asvm_8c_a1f6d0a95558c52f05d9b3b97b2710cfe_icgraph">
<area shape="rect" title=" " alt="" coords="515,23,681,65"/>
<area shape="rect" href="svm_8c.html#a879b6475034eccd7032ffd436966f341" title=" " alt="" coords="237,5,467,32"/>
<area shape="rect" href="svm_8c.html#ac18fc14fa96cb83668d789973478dbc0" title=" " alt="" coords="242,56,462,83"/>
<area shape="rect" href="svm_8c.html#a034d0058215cd4fddf9fbaa460d3faf6" title=" " alt="" coords="5,5,189,32"/>
<area shape="rect" href="svm_8c.html#a13190482bab2b529a02a5cf83309f510" title=" " alt="" coords="15,56,179,83"/>
<area shape="rect" href="svm_8c.html#aea4014f3f951e100eb2acc13cef94502" title=" " alt="" coords="39,107,156,133"/>
</map>
</div>

</div>
</div>
<a id="a6bd9f9c3ade9fe75356f04bdf58433cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bd9f9c3ade9fe75356f04bdf58433cc">&#9670;&nbsp;</a></span>__svm_vcpu_reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __svm_vcpu_reset </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01377">1377</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;{</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <a class="code" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21">svm_vcpu_init_msrpm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <a class="code" href="svm_8c.html#a7f710210623f08aa3f8ba9efdd0746b1">svm_init_osvw</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.microcode_version = 0x01000065;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">tsc_ratio_msr</a> = <a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#a4f8f01ced32ac7e2bbdea0fcf6406a76">default_tsc_scaling_ratio</a>;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">nmi_masked</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#ae94a883f2e559703aaa7b93d14a3810a">awaiting_iret_completion</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        <a class="code" href="sev_8c.html#aa924db70d759d98124ad13172de1f0c5">sev_es_vcpu_reset</a>(svm);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_aa924db70d759d98124ad13172de1f0c5"><div class="ttname"><a href="sev_8c.html#aa924db70d759d98124ad13172de1f0c5">sev_es_vcpu_reset</a></div><div class="ttdeci">void sev_es_vcpu_reset(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03108">sev.c:3108</a></div></div>
<div class="ttc" id="astructkvm__caps_html"><div class="ttname"><a href="structkvm__caps.html">kvm_caps</a></div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00012">x86.h:12</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a4f8f01ced32ac7e2bbdea0fcf6406a76"><div class="ttname"><a href="structkvm__caps.html#a4f8f01ced32ac7e2bbdea0fcf6406a76">kvm_caps::default_tsc_scaling_ratio</a></div><div class="ttdeci">u64 default_tsc_scaling_ratio</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00022">x86.h:22</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a3a2ad123b38c5ee6f81b8a6db56ac5b9"><div class="ttname"><a href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">vcpu_svm::msrpm</a></div><div class="ttdeci">u32 * msrpm</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00234">svm.h:234</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a48b965690a803159d4542489b0e487e8"><div class="ttname"><a href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">vcpu_svm::tsc_ratio_msr</a></div><div class="ttdeci">u64 tsc_ratio_msr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00226">svm.h:226</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a512e38d5dc99356b62e4b2cba0ab6d3d"><div class="ttname"><a href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">vcpu_svm::nmi_masked</a></div><div class="ttdeci">bool nmi_masked</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00241">svm.h:241</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_ae94a883f2e559703aaa7b93d14a3810a"><div class="ttname"><a href="structvcpu__svm.html#ae94a883f2e559703aaa7b93d14a3810a">vcpu_svm::awaiting_iret_completion</a></div><div class="ttdeci">bool awaiting_iret_completion</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00248">svm.h:248</a></div></div>
<div class="ttc" id="asvm_8c_html_a7f710210623f08aa3f8ba9efdd0746b1"><div class="ttname"><a href="svm_8c.html#a7f710210623f08aa3f8ba9efdd0746b1">svm_init_osvw</a></div><div class="ttdeci">static void svm_init_osvw(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00499">svm.c:499</a></div></div>
<div class="ttc" id="asvm_8c_html_aaee43a83fe8c444128a4d22b2d5d5c21"><div class="ttname"><a href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21">svm_vcpu_init_msrpm</a></div><div class="ttdeci">void svm_vcpu_init_msrpm(struct kvm_vcpu *vcpu, u32 *msrpm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00881">svm.c:881</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a6bd9f9c3ade9fe75356f04bdf58433cc_cgraph.png" border="0" usemap="#asvm_8c_a6bd9f9c3ade9fe75356f04bdf58433cc_cgraph" alt=""/></div>
<map name="asvm_8c_a6bd9f9c3ade9fe75356f04bdf58433cc_cgraph" id="asvm_8c_a6bd9f9c3ade9fe75356f04bdf58433cc_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,148,133"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="225,5,336,32"/>
<area shape="rect" href="sev_8c.html#aa924db70d759d98124ad13172de1f0c5" title=" " alt="" coords="208,56,353,83"/>
<area shape="rect" href="svm_8c.html#a7f710210623f08aa3f8ba9efdd0746b1" title=" " alt="" coords="221,107,340,133"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="196,157,365,184"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="931,197,1001,224"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="439,5,546,32"/>
<area shape="rect" href="sev_8c.html#a791cdac9e53d50f78c0943d78462f16e" title=" " alt="" coords="437,56,549,83"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="413,157,572,184"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="639,270,797,311"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="620,157,816,184"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="895,349,1037,376"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="864,401,1068,442"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="893,248,1039,275"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="891,299,1041,325"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="1116,223,1289,249"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a6bd9f9c3ade9fe75356f04bdf58433cc_icgraph.png" border="0" usemap="#asvm_8c_a6bd9f9c3ade9fe75356f04bdf58433cc_icgraph" alt=""/></div>
<map name="asvm_8c_a6bd9f9c3ade9fe75356f04bdf58433cc_icgraph" id="asvm_8c_a6bd9f9c3ade9fe75356f04bdf58433cc_icgraph">
<area shape="rect" title=" " alt="" coords="181,5,324,32"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
</map>
</div>

</div>
</div>
<a id="a66671c85c774356d50d71cbd11633a34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66671c85c774356d50d71cbd11633a34">&#9670;&nbsp;</a></span>__svm_write_tsc_multiplier()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __svm_write_tsc_multiplier </td>
          <td>(</td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>multiplier</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00563">563</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;{</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span> (multiplier == __this_cpu_read(current_tsc_ratio))</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    wrmsrl(MSR_AMD64_TSC_RATIO, multiplier);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    __this_cpu_write(current_tsc_ratio, multiplier);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a66671c85c774356d50d71cbd11633a34_icgraph.png" border="0" usemap="#asvm_8c_a66671c85c774356d50d71cbd11633a34_icgraph" alt=""/></div>
<map name="asvm_8c_a66671c85c774356d50d71cbd11633a34_icgraph" id="asvm_8c_a66671c85c774356d50d71cbd11633a34_icgraph">
<area shape="rect" title=" " alt="" coords="2193,85,2393,112"/>
<area shape="rect" href="svm_8c.html#accd19fd9a37bd9d9ed52a1f26a86e7b5" title=" " alt="" coords="1966,5,2138,32"/>
<area shape="rect" href="svm_8c.html#ace8f9c582674fc49f475a61c3e9ed257" title=" " alt="" coords="1967,56,2137,83"/>
<area shape="rect" href="svm_8c.html#a6571ab4636ff87fda563be50ab7195ef" title=" " alt="" coords="1974,107,2130,149"/>
<area shape="rect" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943" title=" " alt="" coords="1959,173,2145,200"/>
<area shape="rect" href="svm_2nested_8c.html#ae003d7b6aae84aa9b70d64f464e70dfc" title=" " alt="" coords="1732,69,1911,110"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1744,271,1899,297"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,82,1176,123"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1522,76,1631,103"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,76,945,103"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,127,940,153"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,177,719,204"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,177,520,204"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,203,323,229"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,203,128,229"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,388,1673,415"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,322,1684,363"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,127,1679,153"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,271,1679,297"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,439,1668,481"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,381,1399,422"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,447,1403,473"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,497,1389,524"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,388,1144,415"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,388,939,415"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,329,1421,356"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,94,1408,135"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,279,1412,305"/>
</map>
</div>

</div>
</div>
<a id="ae26554f40628edb2bc8659279f08205a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae26554f40628edb2bc8659279f08205a">&#9670;&nbsp;</a></span>ac_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ac_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02114">2114</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;{</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <a class="code" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f">kvm_queue_exception_e</a>(vcpu, AC_VECTOR, 0);</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;}</div>
<div class="ttc" id="ax86_8c_html_aac24bace71b27dc8ae2ee3ecae145d0f"><div class="ttname"><a href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f">kvm_queue_exception_e</a></div><div class="ttdeci">void kvm_queue_exception_e(struct kvm_vcpu *vcpu, unsigned nr, u32 error_code)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00824">x86.c:824</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ae26554f40628edb2bc8659279f08205a_cgraph.png" border="0" usemap="#asvm_8c_ae26554f40628edb2bc8659279f08205a_cgraph" alt=""/></div>
<map name="asvm_8c_ae26554f40628edb2bc8659279f08205a_cgraph" id="asvm_8c_ae26554f40628edb2bc8659279f08205a_cgraph">
<area shape="rect" title=" " alt="" coords="5,115,128,141"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="176,115,360,141"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="408,115,591,141"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="675,5,801,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="678,56,798,83"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="651,107,825,149"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="639,173,837,200"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="653,225,823,266"/>
</map>
</div>

</div>
</div>
<a id="a82b315b23a07eb3743b2458ccefb729d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82b315b23a07eb3743b2458ccefb729d">&#9670;&nbsp;</a></span>add_msr_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_msr_offset </td>
          <td>(</td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>offset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00939">939</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;{</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="svm_8h.html#aecb0b82114f9d516a3ee502c0054e0c0">MSRPM_OFFSETS</a>; ++i) {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="comment">/* Offset already in list? */</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="keywordflow">if</span> (msrpm_offsets[i] == offset)</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <span class="comment">/* Slot used by another offset? */</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <span class="keywordflow">if</span> (msrpm_offsets[i] != <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>)</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="comment">/* Add offset to list */</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        msrpm_offsets[i] = offset;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">     * If this BUG triggers the msrpm_offsets table has an overflow. Just</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">     * increase MSRPM_OFFSETS in this case.</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    BUG();</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_ae9836254c789e1e9f8d62939ff44ff36"><div class="ttname"><a href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a></div><div class="ttdeci">#define MSR_INVALID</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00535">svm.h:535</a></div></div>
<div class="ttc" id="asvm_8h_html_aecb0b82114f9d516a3ee502c0054e0c0"><div class="ttname"><a href="svm_8h.html#aecb0b82114f9d516a3ee502c0054e0c0">MSRPM_OFFSETS</a></div><div class="ttdeci">#define MSRPM_OFFSETS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00034">svm.h:34</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a82b315b23a07eb3743b2458ccefb729d_icgraph.png" border="0" usemap="#asvm_8c_a82b315b23a07eb3743b2458ccefb729d_icgraph" alt=""/></div>
<map name="asvm_8c_a82b315b23a07eb3743b2458ccefb729d_icgraph" id="asvm_8c_a82b315b23a07eb3743b2458ccefb729d_icgraph">
<area shape="rect" title=" " alt="" coords="409,5,532,32"/>
<area shape="rect" href="svm_8c.html#a0a9af31dcd464498479ea7b57cdc106f" title=" " alt="" coords="215,5,361,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="affb29e6bc4a1888cb1b8df7b5ab3fd75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affb29e6bc4a1888cb1b8df7b5ab3fd75">&#9670;&nbsp;</a></span>bp_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int bp_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02098">2098</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;{</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keyword">struct </span>kvm_run *kvm_run = vcpu-&gt;run;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    kvm_run-&gt;exit_reason = KVM_EXIT_DEBUG;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    kvm_run-&gt;debug.arch.pc = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cs.base + svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rip;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    kvm_run-&gt;debug.arch.exception = BP_VECTOR;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_affb29e6bc4a1888cb1b8df7b5ab3fd75_cgraph.png" border="0" usemap="#asvm_8c_affb29e6bc4a1888cb1b8df7b5ab3fd75_cgraph" alt=""/></div>
<map name="asvm_8c_affb29e6bc4a1888cb1b8df7b5ab3fd75_cgraph" id="asvm_8c_affb29e6bc4a1888cb1b8df7b5ab3fd75_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,128,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="176,5,247,32"/>
</map>
</div>

</div>
</div>
<a id="a08788d6a633657aa9e7e2f3b09db9b40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08788d6a633657aa9e7e2f3b09db9b40">&#9670;&nbsp;</a></span>check_selective_cr0_intercepted()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool check_selective_cr0_intercepted </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02601">2601</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;{</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> cr0 = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.cr0;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160; </div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) ||</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        (!(<a class="code" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>, INTERCEPT_SELECTIVE_CR0))))</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160; </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    cr0 &amp;= ~SVM_CR0_SELECTIVE_MASK;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    val &amp;= ~SVM_CR0_SELECTIVE_MASK;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160; </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <span class="keywordflow">if</span> (cr0 ^ val) {</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code = SVM_EXIT_CR0_SEL_WRITE;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        ret = (<a class="code" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6">nested_svm_exit_handled</a>(svm) == <a class="code" href="svm_8h.html#a9c953f5ab9b400e9a1c5232515ec6293">NESTED_EXIT_DONE</a>);</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    }</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; </div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;}</div>
<div class="ttc" id="akvm__cache__regs_8h_html_afbcfc413ceedb460734eb5fd7c5c4fbc"><div class="ttname"><a href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a></div><div class="ttdeci">static bool is_guest_mode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00226">kvm_cache_regs.h:226</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a3b275e369200f402f9d5765babb77629"><div class="ttname"><a href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">svm_nested_state::ctl</a></div><div class="ttdeci">struct vmcb_ctrl_area_cached ctl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00170">svm.h:173</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_aa2e4d643ef957cd597e82a29f0f0a2c8"><div class="ttname"><a href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">vcpu_svm::nested</a></div><div class="ttdeci">struct svm_nested_state nested</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00236">svm.h:238</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a777240cb9ab00451d21a1b204e19c5a6"><div class="ttname"><a href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6">nested_svm_exit_handled</a></div><div class="ttdeci">int nested_svm_exit_handled(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01345">nested.c:1345</a></div></div>
<div class="ttc" id="asvm_8h_html_a5deff43556f8c807c64def073cd548e4"><div class="ttname"><a href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a></div><div class="ttdeci">static bool vmcb12_is_intercept(struct vmcb_ctrl_area_cached *control, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00397">svm.h:397</a></div></div>
<div class="ttc" id="asvm_8h_html_a9c953f5ab9b400e9a1c5232515ec6293"><div class="ttname"><a href="svm_8h.html#a9c953f5ab9b400e9a1c5232515ec6293">NESTED_EXIT_DONE</a></div><div class="ttdeci">#define NESTED_EXIT_DONE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00566">svm.h:566</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a08788d6a633657aa9e7e2f3b09db9b40_cgraph.png" border="0" usemap="#asvm_8c_a08788d6a633657aa9e7e2f3b09db9b40_cgraph" alt=""/></div>
<map name="asvm_8c_a08788d6a633657aa9e7e2f3b09db9b40_cgraph" id="asvm_8c_a08788d6a633657aa9e7e2f3b09db9b40_cgraph">
<area shape="rect" title=" " alt="" coords="5,509,159,550"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="973,70,1093,96"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="207,987,399,1014"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="954,1986,1111,2012"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1231,378,1302,404"/>
<area shape="rect" href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba" title=" " alt="" coords="447,1935,613,1962"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="453,987,607,1014"/>
<area shape="rect" href="svm_2nested_8c.html#a90464b57b273a88a7a1fb3c2cefb257a" title=" " alt="" coords="661,1884,885,1911"/>
<area shape="rect" href="svm_2nested_8c.html#ac11321f5c485c6fd9804b75a6b405f64" title=" " alt="" coords="675,1986,872,2012"/>
<area shape="rect" href="kvm__main_8c.html#ae63a6f386d39aff5ffc5645780018b7a" title=" " alt="" coords="949,1935,1117,1962"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="959,1884,1106,1911"/>
<area shape="rect" href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73" title=" " alt="" coords="675,323,872,350"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="973,171,1092,198"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="693,475,854,502"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="693,526,854,568"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="697,592,850,633"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="712,658,835,684"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="694,708,853,735"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="689,759,858,786"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="716,810,831,836"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="716,860,831,887"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="718,911,829,938"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="716,962,831,988"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a30f9ca7e6fd08d1cf123f57fbfba01c7" title=" " alt="" coords="716,1012,831,1039"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633" title=" " alt="" coords="714,1063,833,1090"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="713,1114,834,1140"/>
<area shape="rect" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a" title=" " alt="" coords="708,1164,839,1191"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="711,1215,836,1242"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="703,1266,844,1292"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="701,1316,846,1343"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="698,1935,849,1962"/>
<area shape="rect" href="svm_2nested_8c.html#a5b731f64682240fd51bd242f194b33f4" title=" " alt="" coords="692,1418,855,1460"/>
<area shape="rect" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f" title=" " alt="" coords="672,1484,875,1525"/>
<area shape="rect" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab" title=" " alt="" coords="692,1550,855,1576"/>
<area shape="rect" href="svm_2nested_8c.html#af381358fd9991ce7d26d81fdb9f763a9" title=" " alt="" coords="688,1601,859,1642"/>
<area shape="rect" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53" title=" " alt="" coords="680,1666,867,1708"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="973,1626,1092,1652"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1199,1418,1335,1444"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="721,1367,825,1394"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="981,1367,1085,1394"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="718,424,829,451"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="982,475,1083,502"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="702,272,845,299"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="706,120,841,147"/>
<area shape="rect" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943" title=" " alt="" coords="939,222,1126,248"/>
<area shape="rect" href="lapic_8c.html#a5468339c2df08ca538b77d4d48915c35" title=" " alt="" coords="943,374,1122,400"/>
<area shape="rect" href="x86_8c.html#a8415cd1d2d30e65d505adb5ba75a0338" title=" " alt="" coords="954,424,1111,451"/>
<area shape="rect" href="x86_8c.html#ade52ab1bf2b3d66def1c4851fab08c45" title=" " alt="" coords="933,272,1132,299"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="973,323,1092,350"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1180,164,1353,205"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a08788d6a633657aa9e7e2f3b09db9b40_icgraph.png" border="0" usemap="#asvm_8c_a08788d6a633657aa9e7e2f3b09db9b40_icgraph" alt=""/></div>
<map name="asvm_8c_a08788d6a633657aa9e7e2f3b09db9b40_icgraph" id="asvm_8c_a08788d6a633657aa9e7e2f3b09db9b40_icgraph">
<area shape="rect" title=" " alt="" coords="387,5,540,47"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="220,13,339,39"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="5,13,172,39"/>
</map>
</div>

</div>
</div>
<a id="a4a2beb03d1ef1d9e803c22570b5806d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a2beb03d1ef1d9e803c22570b5806d1">&#9670;&nbsp;</a></span>clgi_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int clgi_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02451">2451</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;{</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160; </div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8">nested_svm_check_permissions</a>(vcpu))</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    ret = <a class="code" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a>(vcpu);</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <a class="code" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a>(<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu), <span class="keyword">false</span>);</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;}</div>
<div class="ttc" id="asvm_2nested_8c_html_a8907fcb136a33618dbbc1c2b7d3872f8"><div class="ttname"><a href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8">nested_svm_check_permissions</a></div><div class="ttdeci">int nested_svm_check_permissions(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01357">nested.c:1357</a></div></div>
<div class="ttc" id="asvm_8c_html_a5c26f1ceaa6cc778d986bd33629dc539"><div class="ttname"><a href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a></div><div class="ttdeci">void svm_set_gif(struct vcpu_svm *svm, bool value)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02406">svm.c:2406</a></div></div>
<div class="ttc" id="ax86_8c_html_aba69f77338abd9dcd861fd8921d5011a"><div class="ttname"><a href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a></div><div class="ttdeci">int kvm_skip_emulated_instruction(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l08916">x86.c:8916</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a4a2beb03d1ef1d9e803c22570b5806d1_cgraph.png" border="0" usemap="#asvm_8c_a4a2beb03d1ef1d9e803c22570b5806d1_cgraph" alt=""/></div>
<map name="asvm_8c_a4a2beb03d1ef1d9e803c22570b5806d1_cgraph" id="asvm_8c_a4a2beb03d1ef1d9e803c22570b5806d1_cgraph">
<area shape="rect" title=" " alt="" coords="5,502,136,529"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="185,350,415,377"/>
<area shape="rect" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8" title=" " alt="" coords="184,477,416,503"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="534,527,605,554"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="249,806,351,833"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="479,165,660,191"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="476,350,663,377"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="753,89,876,115"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="735,216,894,257"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="727,22,902,49"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="729,165,900,191"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="1255,147,1346,174"/>
<area shape="rect" href="pmu_8h.html#abbf4b99efff2cdd22398e2992085c36f" title=" " alt="" coords="955,5,1153,47"/>
<area shape="rect" href="pmu_8c.html#af08b63fb7910be3ee65e8036b4e48aad" title=" " alt="" coords="965,223,1143,250"/>
<area shape="rect" href="pmu_8h.html#a156ede05e2f3b40ccf7a68f471f574b2" title=" " alt="" coords="961,173,1147,199"/>
<area shape="rect" href="pmu_8h.html#a276700643eefb3c6911a7ae0dc0e3809" title=" " alt="" coords="963,122,1145,149"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="741,325,888,351"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="723,375,907,402"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="981,325,1127,351"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="992,375,1116,402"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="999,274,1109,301"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="963,426,1145,453"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="1237,543,1364,570"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1241,730,1361,757"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="1213,309,1388,351"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="1201,375,1400,402"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1209,426,1393,453"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="1216,477,1385,519"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="527,426,611,453"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="485,477,654,503"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="741,426,888,453"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="981,477,1127,503"/>
<area shape="rect" href="svm_8h.html#a711d42f525aa791008754514284a556c" title=" " alt="" coords="523,781,616,807"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="524,831,615,858"/>
<area shape="rect" href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd" title=" " alt="" coords="482,715,657,756"/>
<area shape="rect" href="irq_8c.html#a82ee83566d2724a298b67f23f481976b" title=" " alt="" coords="464,629,675,655"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="506,882,633,909"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="745,933,884,959"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="503,983,636,1010"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="755,781,874,807"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="975,781,1133,807"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="995,629,1113,655"/>
<area shape="rect" href="lapic_8c.html#aa421165466ac455ff3fff91fb9afe7bf" title=" " alt="" coords="725,527,904,554"/>
<area shape="rect" href="irq_8c.html#a0ba50d6865653a9d307102d8f0b36630" title=" " alt="" coords="737,629,893,655"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="725,578,904,605"/>
<area shape="rect" href="lapic_8c.html#a1bb0a1640f9f291f5c3154c6a2c40986" title=" " alt="" coords="983,527,1125,554"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1233,894,1369,921"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="987,933,1121,959"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="1227,958,1374,985"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="744,983,885,1010"/>
</map>
</div>

</div>
</div>
<a id="a02cdc4055c8a1706c884eff72c4caaf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02cdc4055c8a1706c884eff72c4caaf7">&#9670;&nbsp;</a></span>clr_dr_intercepts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void clr_dr_intercepts </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00748">748</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;{</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    vmcb-&gt;control.intercepts[INTERCEPT_DR] = 0;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <a class="code" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(svm);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;}</div>
<div class="ttc" id="astructkvm__vmcb__info_html_a8076921f239564576af7af19be7f6f04"><div class="ttname"><a href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">kvm_vmcb_info::ptr</a></div><div class="ttdeci">struct vmcb * ptr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00110">svm.h:110</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af0c24755d59a0cfca7ce9ba64f682722"><div class="ttname"><a href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vcpu_svm::vmcb01</a></div><div class="ttdeci">struct kvm_vmcb_info vmcb01</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00212">svm.h:213</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_adb2a01596415bf77bd9a3f22ff165a14"><div class="ttname"><a href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a></div><div class="ttdeci">void recalc_intercepts(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00122">nested.c:122</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a02cdc4055c8a1706c884eff72c4caaf7_cgraph.png" border="0" usemap="#asvm_8c_a02cdc4055c8a1706c884eff72c4caaf7_cgraph" alt=""/></div>
<map name="asvm_8c_a02cdc4055c8a1706c884eff72c4caaf7_cgraph" id="asvm_8c_a02cdc4055c8a1706c884eff72c4caaf7_cgraph">
<area shape="rect" title=" " alt="" coords="5,159,136,185"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="184,159,317,185"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="397,5,517,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="365,57,548,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="366,122,547,163"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="383,188,530,215"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="389,239,525,265"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="381,289,532,316"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="613,104,732,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="596,155,749,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1036,97,1209,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="797,129,988,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a02cdc4055c8a1706c884eff72c4caaf7_icgraph.png" border="0" usemap="#asvm_8c_a02cdc4055c8a1706c884eff72c4caaf7_icgraph" alt=""/></div>
<map name="asvm_8c_a02cdc4055c8a1706c884eff72c4caaf7_icgraph" id="asvm_8c_a02cdc4055c8a1706c884eff72c4caaf7_icgraph">
<area shape="rect" title=" " alt="" coords="173,5,304,32"/>
<area shape="rect" href="svm_8c.html#a84f2d3e5d602af563ab58693bf87db77" title=" " alt="" coords="5,5,125,32"/>
</map>
</div>

</div>
</div>
<a id="af2ee2a03530f5b7a02a127d8b779d2ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2ee2a03530f5b7a02a127d8b779d2ae">&#9670;&nbsp;</a></span>cr8_write_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cr8_write_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02776">2776</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;{</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160; </div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    u8 cr8_prev = <a class="code" href="x86_8c.html#a314ef23ae9439bea8ebd5983055cfad8">kvm_get_cr8</a>(vcpu);</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <span class="comment">/* instruction emulation calls kvm_set_cr8() */</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    r = <a class="code" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41">cr_interception</a>(vcpu);</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4">lapic_in_kernel</a>(vcpu))</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;        <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="keywordflow">if</span> (cr8_prev &lt;= <a class="code" href="x86_8c.html#a314ef23ae9439bea8ebd5983055cfad8">kvm_get_cr8</a>(vcpu))</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    vcpu-&gt;run-&gt;exit_reason = KVM_EXIT_SET_TPR;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;}</div>
<div class="ttc" id="alapic_8h_html_a1d8c9378fcbf62390a89dc3b7f0bdbd4"><div class="ttname"><a href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4">lapic_in_kernel</a></div><div class="ttdeci">static bool lapic_in_kernel(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00186">lapic.h:186</a></div></div>
<div class="ttc" id="asvm_8c_html_ad1887c4bb9c78c577fb20a129d73ea41"><div class="ttname"><a href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41">cr_interception</a></div><div class="ttdeci">static int cr_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02625">svm.c:2625</a></div></div>
<div class="ttc" id="ax86_8c_html_a314ef23ae9439bea8ebd5983055cfad8"><div class="ttname"><a href="x86_8c.html#a314ef23ae9439bea8ebd5983055cfad8">kvm_get_cr8</a></div><div class="ttdeci">unsigned long kvm_get_cr8(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01327">x86.c:1327</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af2ee2a03530f5b7a02a127d8b779d2ae_cgraph.png" border="0" usemap="#asvm_8c_af2ee2a03530f5b7a02a127d8b779d2ae_cgraph" alt=""/></div>
<map name="asvm_8c_af2ee2a03530f5b7a02a127d8b779d2ae_cgraph" id="asvm_8c_af2ee2a03530f5b7a02a127d8b779d2ae_cgraph">
<area shape="rect" title=" " alt="" coords="5,1523,172,1549"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="220,737,339,764"/>
<area shape="rect" href="x86_8c.html#a314ef23ae9439bea8ebd5983055cfad8" title=" " alt="" coords="425,1573,532,1600"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="675,1548,793,1575"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="402,291,555,333"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="1137,117,1306,144"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="1164,484,1279,511"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="1164,624,1279,651"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="699,357,769,384"/>
<area shape="rect" href="svm_8c.html#a5a07bdc17cad850b357e8312cd17921e" title=" " alt="" coords="387,125,571,152"/>
<area shape="rect" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42" title=" " alt="" coords="391,219,567,245"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba" title=" " alt="" coords="931,1016,1046,1043"/>
<area shape="rect" href="x86_8h.html#a9f7e7cd8d352da04de3bf53cbb3b4e57" title=" " alt="" coords="662,1447,806,1473"/>
<area shape="rect" href="x86_8h.html#a777bea7283c857dc549e54eaa54fe12e" title=" " alt="" coords="660,1345,808,1372"/>
<area shape="rect" href="x86_8c.html#aa9556b4ebb06617f66625ff73a3f56b4" title=" " alt="" coords="681,712,787,739"/>
<area shape="rect" href="x86_8c.html#a75f57f1f4494df7f35fcdf0e0e582a31" title=" " alt="" coords="426,915,531,941"/>
<area shape="rect" href="x86_8c.html#a39acca4a1624a86a5d8e547339729536" title=" " alt="" coords="681,1143,787,1169"/>
<area shape="rect" href="x86_8c.html#a120377d5a571d3fb86660cd5f6cd982d" title=" " alt="" coords="426,1472,531,1499"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1630,175,1750,201"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="638,307,830,333"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="1143,281,1300,308"/>
<area shape="rect" href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba" title=" " alt="" coords="905,307,1072,333"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="911,357,1066,384"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1363,143,1545,169"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="1381,597,1527,624"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1593,800,1787,827"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="640,104,828,131"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="897,111,1080,137"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="619,155,849,181"/>
<area shape="rect" href="lapic_8c.html#a3aead5d19fd0505da0197dfc140d6824" title=" " alt="" coords="662,1599,806,1625"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="916,1599,1061,1625"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="1381,839,1527,865"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="927,1371,1051,1397"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1367,1219,1541,1245"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="1165,1168,1277,1195"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="899,1421,1078,1448"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="1128,1421,1315,1448"/>
<area shape="rect" href="x86_8h.html#abc2ffd79aced13c24f0c4143465d3d51" title=" " alt="" coords="957,864,1021,891"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="1148,839,1295,865"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="947,965,1031,992"/>
<area shape="rect" href="x86_8c.html#a482306c58fa14c6da89a052965364037" title=" " alt="" coords="921,661,1056,688"/>
<area shape="rect" href="x86_8c.html#a3df01e8bd995bb72420812ea1d39df4b" title=" " alt="" coords="919,611,1059,637"/>
<area shape="rect" href="x86_8c.html#ae69bdd054a70a95d99b79bae770372cf" title=" " alt="" coords="939,1219,1038,1245"/>
<area shape="rect" href="x86_8h.html#aaa36cdb43bbf6ed6af3b10deed46a436" title=" " alt="" coords="677,1016,791,1043"/>
<area shape="rect" href="x86_8c.html#aa792359250f034a2a29b0c809df64ff3" title=" " alt="" coords="655,864,813,891"/>
<area shape="rect" href="mmu_8c.html#a40fe74f8abc723be216276bf005e4be8" title=" " alt="" coords="655,915,813,941"/>
<area shape="rect" href="cpuid_8h.html#a8f4d8ed96a58f11e51539641257987c2" title=" " alt="" coords="647,965,821,992"/>
<area shape="rect" href="x86_8c.html#ad45419cfec5d4a35d1dd6778689061b7" title=" " alt="" coords="921,1320,1056,1347"/>
<area shape="rect" href="x86_8c.html#afb193fb2b1c3f240d0ad5a5378afc118" title=" " alt="" coords="919,1269,1059,1296"/>
<area shape="rect" href="lapic_8c.html#aee34622e495b500817e0b0905bfd0d4c" title=" " alt="" coords="663,1497,805,1524"/>
</map>
</div>

</div>
</div>
<a id="ad1887c4bb9c78c577fb20a129d73ea41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1887c4bb9c78c577fb20a129d73ea41">&#9670;&nbsp;</a></span>cr_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cr_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02625">2625</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;{</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    <span class="keywordtype">int</span> reg, cr;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> val;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160; </div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <span class="keywordflow">if</span> (!static_cpu_has(X86_FEATURE_DECODEASSISTS))</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a5a07bdc17cad850b357e8312cd17921e">emulate_on_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160; </div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <span class="keywordflow">if</span> (unlikely((svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1 &amp; <a class="code" href="svm_8c.html#af489914c8a592f433c39b3372585889e">CR_VALID</a>) == 0))</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a5a07bdc17cad850b357e8312cd17921e">emulate_on_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160; </div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    reg = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1 &amp; SVM_EXITINFO_REG_MASK;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code == SVM_EXIT_CR0_SEL_WRITE)</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        cr = SVM_EXIT_WRITE_CR0 - SVM_EXIT_READ_CR0;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;        cr = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code - SVM_EXIT_READ_CR0;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    err = 0;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="keywordflow">if</span> (cr &gt;= 16) { <span class="comment">/* mov to cr */</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        cr -= 16;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        val = <a class="code" href="x86_8h.html#a9f7e7cd8d352da04de3bf53cbb3b4e57">kvm_register_read</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, reg);</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        <a class="code" href="trace_8h.html#ae96bbd03ed1ba31320789c75dfe1e400">trace_kvm_cr_write</a>(cr, val);</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        <span class="keywordflow">switch</span> (cr) {</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40">check_selective_cr0_intercepted</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, val))</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                err = <a class="code" href="x86_8c.html#aa9556b4ebb06617f66625ff73a3f56b4">kvm_set_cr0</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, val);</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160; </div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;            err = <a class="code" href="x86_8c.html#a75f57f1f4494df7f35fcdf0e0e582a31">kvm_set_cr3</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, val);</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;            err = <a class="code" href="x86_8c.html#a39acca4a1624a86a5d8e547339729536">kvm_set_cr4</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, val);</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;        <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;            err = <a class="code" href="x86_8c.html#a120377d5a571d3fb86660cd5f6cd982d">kvm_set_cr8</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, val);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            WARN(1, <span class="stringliteral">&quot;unhandled write to CR%d&quot;</span>, cr);</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;            <a class="code" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, UD_VECTOR);</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        }</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">/* mov from cr */</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        <span class="keywordflow">switch</span> (cr) {</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;            val = <a class="code" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff">kvm_read_cr0</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            val = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.cr2;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            val = <a class="code" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378">kvm_read_cr3</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;            val = <a class="code" href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba">kvm_read_cr4</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;            val = <a class="code" href="x86_8c.html#a314ef23ae9439bea8ebd5983055cfad8">kvm_get_cr8</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            WARN(1, <span class="stringliteral">&quot;unhandled read from CR%d&quot;</span>, cr);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            <a class="code" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, UD_VECTOR);</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        }</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        <a class="code" href="x86_8h.html#a777bea7283c857dc549e54eaa54fe12e">kvm_register_write</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, reg, val);</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        <a class="code" href="trace_8h.html#aac44ea81aa5215c5585bf4e9478a6dd8">trace_kvm_cr_read</a>(cr, val);</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    }</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42">kvm_complete_insn_gp</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, err);</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;}</div>
<div class="ttc" id="akvm__cache__regs_8h_html_a66188c5384cbd688acd880f8de16fbff"><div class="ttname"><a href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff">kvm_read_cr0</a></div><div class="ttdeci">static ulong kvm_read_cr0(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00168">kvm_cache_regs.h:168</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_aa80de2ba11d877ef825788b0c9768378"><div class="ttname"><a href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378">kvm_read_cr3</a></div><div class="ttdeci">static ulong kvm_read_cr3(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00190">kvm_cache_regs.h:190</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_ad479d598f0b5de90bd6062237ccb9eba"><div class="ttname"><a href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba">kvm_read_cr4</a></div><div class="ttdeci">static ulong kvm_read_cr4(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00197">kvm_cache_regs.h:197</a></div></div>
<div class="ttc" id="asvm_8c_html_a08788d6a633657aa9e7e2f3b09db9b40"><div class="ttname"><a href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40">check_selective_cr0_intercepted</a></div><div class="ttdeci">static bool check_selective_cr0_intercepted(struct kvm_vcpu *vcpu, unsigned long val)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02601">svm.c:2601</a></div></div>
<div class="ttc" id="asvm_8c_html_a5a07bdc17cad850b357e8312cd17921e"><div class="ttname"><a href="svm_8c.html#a5a07bdc17cad850b357e8312cd17921e">emulate_on_interception</a></div><div class="ttdeci">static int emulate_on_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02591">svm.c:2591</a></div></div>
<div class="ttc" id="asvm_8c_html_af489914c8a592f433c39b3372585889e"><div class="ttname"><a href="svm_8c.html#af489914c8a592f433c39b3372585889e">CR_VALID</a></div><div class="ttdeci">#define CR_VALID</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02623">svm.c:2623</a></div></div>
<div class="ttc" id="atrace_8h_html_aac44ea81aa5215c5585bf4e9478a6dd8"><div class="ttname"><a href="trace_8h.html#aac44ea81aa5215c5585bf4e9478a6dd8">trace_kvm_cr_read</a></div><div class="ttdeci">#define trace_kvm_cr_read(cr, val)</div><div class="ttdef"><b>Definition:</b> <a href="trace_8h_source.html#l00478">trace.h:478</a></div></div>
<div class="ttc" id="atrace_8h_html_ae96bbd03ed1ba31320789c75dfe1e400"><div class="ttname"><a href="trace_8h.html#ae96bbd03ed1ba31320789c75dfe1e400">trace_kvm_cr_write</a></div><div class="ttdeci">#define trace_kvm_cr_write(cr, val)</div><div class="ttdef"><b>Definition:</b> <a href="trace_8h_source.html#l00479">trace.h:479</a></div></div>
<div class="ttc" id="ax86_8c_html_a120377d5a571d3fb86660cd5f6cd982d"><div class="ttname"><a href="x86_8c.html#a120377d5a571d3fb86660cd5f6cd982d">kvm_set_cr8</a></div><div class="ttdeci">int kvm_set_cr8(struct kvm_vcpu *vcpu, unsigned long cr8)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01315">x86.c:1315</a></div></div>
<div class="ttc" id="ax86_8c_html_a39acca4a1624a86a5d8e547339729536"><div class="ttname"><a href="x86_8c.html#a39acca4a1624a86a5d8e547339729536">kvm_set_cr4</a></div><div class="ttdeci">int kvm_set_cr4(struct kvm_vcpu *vcpu, unsigned long cr4)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01192">x86.c:1192</a></div></div>
<div class="ttc" id="ax86_8c_html_a75f57f1f4494df7f35fcdf0e0e582a31"><div class="ttname"><a href="x86_8c.html#a75f57f1f4494df7f35fcdf0e0e582a31">kvm_set_cr3</a></div><div class="ttdeci">int kvm_set_cr3(struct kvm_vcpu *vcpu, unsigned long cr3)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01266">x86.c:1266</a></div></div>
<div class="ttc" id="ax86_8c_html_aa9556b4ebb06617f66625ff73a3f56b4"><div class="ttname"><a href="x86_8c.html#aa9556b4ebb06617f66625ff73a3f56b4">kvm_set_cr0</a></div><div class="ttdeci">int kvm_set_cr0(struct kvm_vcpu *vcpu, unsigned long cr0)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00971">x86.c:971</a></div></div>
<div class="ttc" id="ax86_8c_html_ab726ff4c508ed9b0c2826d532af24e42"><div class="ttname"><a href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42">kvm_complete_insn_gp</a></div><div class="ttdeci">int kvm_complete_insn_gp(struct kvm_vcpu *vcpu, int err)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00757">x86.c:757</a></div></div>
<div class="ttc" id="ax86_8c_html_ac9502ee8f018301047c80e19ab79f7e2"><div class="ttname"><a href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a></div><div class="ttdeci">void kvm_queue_exception(struct kvm_vcpu *vcpu, unsigned nr)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00731">x86.c:731</a></div></div>
<div class="ttc" id="ax86_8h_html_a777bea7283c857dc549e54eaa54fe12e"><div class="ttname"><a href="x86_8h.html#a777bea7283c857dc549e54eaa54fe12e">kvm_register_write</a></div><div class="ttdeci">static void kvm_register_write(struct kvm_vcpu *vcpu, int reg, unsigned long val)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00280">x86.h:280</a></div></div>
<div class="ttc" id="ax86_8h_html_a9f7e7cd8d352da04de3bf53cbb3b4e57"><div class="ttname"><a href="x86_8h.html#a9f7e7cd8d352da04de3bf53cbb3b4e57">kvm_register_read</a></div><div class="ttdeci">static unsigned long kvm_register_read(struct kvm_vcpu *vcpu, int reg)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00273">x86.h:273</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad1887c4bb9c78c577fb20a129d73ea41_cgraph.png" border="0" usemap="#asvm_8c_ad1887c4bb9c78c577fb20a129d73ea41_cgraph" alt=""/></div>
<map name="asvm_8c_ad1887c4bb9c78c577fb20a129d73ea41_cgraph" id="asvm_8c_ad1887c4bb9c78c577fb20a129d73ea41_cgraph">
<area shape="rect" title=" " alt="" coords="5,448,124,475"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="187,78,341,119"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="931,144,1101,171"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="959,384,1073,411"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="959,473,1073,500"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="465,144,535,171"/>
<area shape="rect" href="svm_8c.html#a5a07bdc17cad850b357e8312cd17921e" title=" " alt="" coords="172,245,356,272"/>
<area shape="rect" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42" title=" " alt="" coords="176,296,352,323"/>
<area shape="rect" href="x86_8c.html#a314ef23ae9439bea8ebd5983055cfad8" title=" " alt="" coords="211,448,317,475"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba" title=" " alt="" coords="702,1107,817,1133"/>
<area shape="rect" href="x86_8h.html#a9f7e7cd8d352da04de3bf53cbb3b4e57" title=" " alt="" coords="428,1411,572,1437"/>
<area shape="rect" href="x86_8h.html#a777bea7283c857dc549e54eaa54fe12e" title=" " alt="" coords="426,1360,574,1387"/>
<area shape="rect" href="x86_8c.html#aa9556b4ebb06617f66625ff73a3f56b4" title=" " alt="" coords="447,676,553,703"/>
<area shape="rect" href="x86_8c.html#a75f57f1f4494df7f35fcdf0e0e582a31" title=" " alt="" coords="211,879,317,905"/>
<area shape="rect" href="x86_8c.html#a39acca4a1624a86a5d8e547339729536" title=" " alt="" coords="447,1132,553,1159"/>
<area shape="rect" href="x86_8c.html#a120377d5a571d3fb86660cd5f6cd982d" title=" " alt="" coords="211,499,317,525"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1425,31,1545,57"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="404,93,596,120"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="937,68,1095,95"/>
<area shape="rect" href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba" title=" " alt="" coords="676,93,843,120"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="682,296,837,323"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1157,107,1340,133"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="1176,485,1321,512"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1388,676,1581,703"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="406,245,594,272"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="668,195,851,221"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="925,245,1107,272"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="923,195,1109,221"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="644,245,875,272"/>
<area shape="rect" href="lapic_8c.html#a3aead5d19fd0505da0197dfc140d6824" title=" " alt="" coords="428,448,572,475"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="441,499,559,525"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="1176,803,1321,829"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="697,1360,821,1387"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1161,1183,1336,1209"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="960,1259,1072,1285"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="670,1411,849,1437"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="923,1309,1109,1336"/>
<area shape="rect" href="x86_8h.html#abc2ffd79aced13c24f0c4143465d3d51" title=" " alt="" coords="727,752,791,779"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="943,803,1089,829"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="717,803,801,829"/>
<area shape="rect" href="x86_8c.html#a482306c58fa14c6da89a052965364037" title=" " alt="" coords="692,549,827,576"/>
<area shape="rect" href="x86_8c.html#a3df01e8bd995bb72420812ea1d39df4b" title=" " alt="" coords="689,600,829,627"/>
<area shape="rect" href="x86_8c.html#ae69bdd054a70a95d99b79bae770372cf" title=" " alt="" coords="710,1005,809,1032"/>
<area shape="rect" href="x86_8h.html#aaa36cdb43bbf6ed6af3b10deed46a436" title=" " alt="" coords="443,777,557,804"/>
<area shape="rect" href="x86_8c.html#aa792359250f034a2a29b0c809df64ff3" title=" " alt="" coords="421,929,579,956"/>
<area shape="rect" href="mmu_8c.html#a40fe74f8abc723be216276bf005e4be8" title=" " alt="" coords="421,980,579,1007"/>
<area shape="rect" href="cpuid_8h.html#a8f4d8ed96a58f11e51539641257987c2" title=" " alt="" coords="413,879,587,905"/>
<area shape="rect" href="x86_8c.html#ad45419cfec5d4a35d1dd6778689061b7" title=" " alt="" coords="692,1157,827,1184"/>
<area shape="rect" href="x86_8c.html#afb193fb2b1c3f240d0ad5a5378afc118" title=" " alt="" coords="689,1208,829,1235"/>
<area shape="rect" href="lapic_8c.html#aee34622e495b500817e0b0905bfd0d4c" title=" " alt="" coords="429,549,571,576"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad1887c4bb9c78c577fb20a129d73ea41_icgraph.png" border="0" usemap="#asvm_8c_ad1887c4bb9c78c577fb20a129d73ea41_icgraph" alt=""/></div>
<map name="asvm_8c_ad1887c4bb9c78c577fb20a129d73ea41_icgraph" id="asvm_8c_ad1887c4bb9c78c577fb20a129d73ea41_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,339,32"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="5,5,172,32"/>
</map>
</div>

</div>
</div>
<a id="af4590239d3e0b5fbad189a245207dfaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4590239d3e0b5fbad189a245207dfaa">&#9670;&nbsp;</a></span>cr_trap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cr_trap </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02699">2699</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;{</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> old_value, new_value;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cr;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160; </div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    new_value = (<span class="keywordtype">unsigned</span> long)svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160; </div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    cr = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code - SVM_EXIT_CR0_WRITE_TRAP;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    switch (cr) {</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        old_value = <a class="code" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff">kvm_read_cr0</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        <a class="code" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d">svm_set_cr0</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, new_value);</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160; </div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        <a class="code" href="x86_8c.html#a3df01e8bd995bb72420812ea1d39df4b">kvm_post_set_cr0</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, old_value, new_value);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        old_value = <a class="code" href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba">kvm_read_cr4</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        <a class="code" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109">svm_set_cr4</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, new_value);</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160; </div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        <a class="code" href="x86_8c.html#afb193fb2b1c3f240d0ad5a5378afc118">kvm_post_set_cr4</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, old_value, new_value);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        ret = <a class="code" href="x86_8c.html#a120377d5a571d3fb86660cd5f6cd982d">kvm_set_cr8</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, new_value);</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        WARN(1, <span class="stringliteral">&quot;unhandled CR%d write trap&quot;</span>, cr);</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;        <a class="code" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, UD_VECTOR);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    }</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160; </div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42">kvm_complete_insn_gp</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, ret);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a1a9474f1273be079ac4f3c1320093c3d"><div class="ttname"><a href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d">svm_set_cr0</a></div><div class="ttdeci">void svm_set_cr0(struct kvm_vcpu *vcpu, unsigned long cr0)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01852">svm.c:1852</a></div></div>
<div class="ttc" id="asvm_8c_html_aec23ca96447aab4ff19f594a297bc109"><div class="ttname"><a href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109">svm_set_cr4</a></div><div class="ttdeci">void svm_set_cr4(struct kvm_vcpu *vcpu, unsigned long cr4)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01914">svm.c:1914</a></div></div>
<div class="ttc" id="ax86_8c_html_a3df01e8bd995bb72420812ea1d39df4b"><div class="ttname"><a href="x86_8c.html#a3df01e8bd995bb72420812ea1d39df4b">kvm_post_set_cr0</a></div><div class="ttdeci">void kvm_post_set_cr0(struct kvm_vcpu *vcpu, unsigned long old_cr0, unsigned long cr0)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00929">x86.c:929</a></div></div>
<div class="ttc" id="ax86_8c_html_afb193fb2b1c3f240d0ad5a5378afc118"><div class="ttname"><a href="x86_8c.html#afb193fb2b1c3f240d0ad5a5378afc118">kvm_post_set_cr4</a></div><div class="ttdeci">void kvm_post_set_cr4(struct kvm_vcpu *vcpu, unsigned long old_cr4, unsigned long cr4)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01150">x86.c:1150</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af4590239d3e0b5fbad189a245207dfaa_cgraph.png" border="0" usemap="#asvm_8c_af4590239d3e0b5fbad189a245207dfaa_cgraph" alt=""/></div>
<map name="asvm_8c_af4590239d3e0b5fbad189a245207dfaa_cgraph" id="asvm_8c_af4590239d3e0b5fbad189a245207dfaa_cgraph">
<area shape="rect" title=" " alt="" coords="5,687,72,713"/>
<area shape="rect" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42" title=" " alt="" coords="120,81,296,108"/>
<area shape="rect" href="x86_8c.html#a3df01e8bd995bb72420812ea1d39df4b" title=" " alt="" coords="138,363,278,389"/>
<area shape="rect" href="x86_8c.html#afb193fb2b1c3f240d0ad5a5378afc118" title=" " alt="" coords="138,157,278,184"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="123,895,293,921"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="151,1021,265,1048"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba" title=" " alt="" coords="402,965,517,992"/>
<area shape="rect" href="x86_8c.html#a120377d5a571d3fb86660cd5f6cd982d" title=" " alt="" coords="155,1117,261,1144"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="156,737,260,764"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="407,560,511,587"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="707,763,778,789"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="344,56,575,83"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="652,56,833,83"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="649,5,836,32"/>
<area shape="rect" href="x86_8c.html#ad850a917f349195334a4ef07b53ca379" title=" " alt="" coords="362,443,557,469"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="376,501,543,528"/>
<area shape="rect" href="async__pf_8c.html#ad351bddfe80f107dfc95c6ab2768fe4f" title=" " alt="" coords="382,259,537,301"/>
<area shape="rect" href="mmu_8c.html#a88ade1c65bbbb9b25a78e82003a71a7c" title=" " alt="" coords="683,157,803,184"/>
<area shape="rect" href="mmu_8h.html#a11c275bc8cfad409c0681f0c953ebcae" title=" " alt="" coords="366,326,553,367"/>
<area shape="rect" href="mmu_8c.html#a56f1568115a55fdacc188e9b41159b8f" title=" " alt="" coords="365,157,553,184"/>
<area shape="rect" href="mmu_8c.html#a8b2588158566c9bb798cdb77760e6446" title=" " alt="" coords="383,392,536,419"/>
<area shape="rect" href="async__pf_8c.html#a5b03475159778ff1b6a78dbbfc913a01" title=" " alt="" coords="666,209,819,250"/>
<area shape="rect" href="mmu_8c.html#a8a6a76a1ef24ce48ce2378ac59cf5b20" title=" " alt="" coords="911,435,1081,461"/>
<area shape="rect" href="mmu_8c.html#a37d0224d142272ad59fd35b4a22c5937" title=" " alt="" coords="924,259,1068,285"/>
<area shape="rect" href="mmu_8c.html#a2346100ce00fd4d842c51c4be6cbfe35" title=" " alt="" coords="922,309,1070,336"/>
<area shape="rect" href="mmu_8c.html#a39c690691d8b166be323cb09d89be57d" title=" " alt="" coords="923,107,1069,133"/>
<area shape="rect" href="x86_8h.html#a661bc84e256a87cbd929ffb7c1f61b2f" title=" " alt="" coords="933,157,1059,184"/>
<area shape="rect" href="mmu_8c.html#abef7a85395cc30529b7306fb12566ecd" title=" " alt="" coords="926,208,1066,235"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="1129,560,1213,587"/>
<area shape="rect" href="mmu_8h.html#aaac7b37c7c917c491331020726730c02" title=" " alt="" coords="643,326,843,367"/>
<area shape="rect" href="x86_8c.html#a07ecc086564147d2003e0699cd506aa4" title=" " alt="" coords="623,275,863,301"/>
<area shape="rect" href="mmu_8c.html#a7bf770a114656f992dd1c0aff57fe9e5" title=" " alt="" coords="671,107,814,133"/>
<area shape="rect" href="mmu_8c.html#ab7d4e418cb85a72507e384df5027293e" title=" " alt="" coords="913,5,1079,32"/>
<area shape="rect" href="x86_8h.html#a0647452067d01e527a8cd1da2fb6b897" title=" " alt="" coords="911,56,1081,83"/>
<area shape="rect" href="kvm__main_8c.html#a523d3c698dd532d3fbc1bb046246ea5f" title=" " alt="" coords="655,494,830,535"/>
<area shape="rect" href="mmu_8c.html#aafdb4964a081741c295ad440ae9ff0f4" title=" " alt="" coords="645,392,840,419"/>
<area shape="rect" href="tdp__mmu_8c.html#aa4fb1a66a2bc67f8699e8ddafdd4b1e8" title=" " alt="" coords="648,443,837,469"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="368,1016,551,1043"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="679,1067,806,1093"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="683,1016,803,1043"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="387,1067,532,1093"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="670,965,815,992"/>
<area shape="rect" href="lapic_8c.html#aee34622e495b500817e0b0905bfd0d4c" title=" " alt="" coords="389,1117,530,1144"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="400,1168,519,1195"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="404,712,515,739"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="390,763,529,789"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="675,712,811,739"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="388,813,531,840"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="641,611,844,637"/>
<area shape="rect" href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08" title=" " alt="" coords="660,661,825,688"/>
</map>
</div>

</div>
</div>
<a id="ae58d4aefe6338d19f8c4c62b4e7e96e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae58d4aefe6338d19f8c4c62b4e7e96e8">&#9670;&nbsp;</a></span>db_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int db_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02065">2065</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;{</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keyword">struct </span>kvm_run *kvm_run = vcpu-&gt;run;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;guest_debug &amp;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;          (KVM_GUESTDBG_SINGLESTEP | KVM_GUESTDBG_USE_HW_BP)) &amp;&amp;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        !svm-&gt;<a class="code" href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">nmi_singlestep</a>) {</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        u32 payload = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.dr6 ^ DR6_ACTIVE_LOW;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        <a class="code" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01">kvm_queue_exception_p</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, DB_VECTOR, payload);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    }</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">nmi_singlestep</a>) {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        <a class="code" href="svm_8c.html#a7ff4c846a46f6bb2e429d79bbc18f052">disable_nmi_singlestep</a>(svm);</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        <span class="comment">/* Make sure we check for pending NMIs upon entry */</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        kvm_make_request(KVM_REQ_EVENT, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    }</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; </div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;guest_debug &amp;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        (KVM_GUESTDBG_SINGLESTEP | KVM_GUESTDBG_USE_HW_BP)) {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        kvm_run-&gt;exit_reason = KVM_EXIT_DEBUG;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        kvm_run-&gt;debug.arch.dr6 = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.dr6;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        kvm_run-&gt;debug.arch.dr7 = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.dr7;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        kvm_run-&gt;debug.arch.pc =</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cs.base + svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rip;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        kvm_run-&gt;debug.arch.exception = DB_VECTOR;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    }</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160; </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_a0e952848b035cc09ad04859f6363acbf"><div class="ttname"><a href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">vcpu_svm::nmi_singlestep</a></div><div class="ttdeci">bool nmi_singlestep</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00257">svm.h:257</a></div></div>
<div class="ttc" id="asvm_8c_html_a7ff4c846a46f6bb2e429d79bbc18f052"><div class="ttname"><a href="svm_8c.html#a7ff4c846a46f6bb2e429d79bbc18f052">disable_nmi_singlestep</a></div><div class="ttdeci">void disable_nmi_singlestep(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01054">svm.c:1054</a></div></div>
<div class="ttc" id="ax86_8c_html_ade9d1daa53933c6d5907c8a7b1045f01"><div class="ttname"><a href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01">kvm_queue_exception_p</a></div><div class="ttdeci">void kvm_queue_exception_p(struct kvm_vcpu *vcpu, unsigned nr, unsigned long payload)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00743">x86.c:743</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ae58d4aefe6338d19f8c4c62b4e7e96e8_cgraph.png" border="0" usemap="#asvm_8c_ae58d4aefe6338d19f8c4c62b4e7e96e8_cgraph" alt=""/></div>
<map name="asvm_8c_ae58d4aefe6338d19f8c4c62b4e7e96e8_cgraph" id="asvm_8c_ae58d4aefe6338d19f8c4c62b4e7e96e8_cgraph">
<area shape="rect" title=" " alt="" coords="5,173,128,200"/>
<area shape="rect" href="svm_8c.html#a7ff4c846a46f6bb2e429d79bbc18f052" title=" " alt="" coords="181,123,355,149"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="176,173,360,200"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="233,224,303,251"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="408,173,591,200"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="675,5,801,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="678,56,798,83"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="651,107,825,149"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="639,173,837,200"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="646,224,830,251"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="653,275,823,317"/>
</map>
</div>

</div>
</div>
<a id="ad78b00702b9a3260f5e32980b3297e2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad78b00702b9a3260f5e32980b3297e2f">&#9670;&nbsp;</a></span>DEFINE_PER_CPU() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_PER_CPU </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structsvm__cpu__data.html">svm_cpu_data</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">svm_data&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1454b29e3d306b288f6550700c4118d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1454b29e3d306b288f6550700c4118d7">&#9670;&nbsp;</a></span>DEFINE_PER_CPU() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static DEFINE_PER_CPU </td>
          <td>(</td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">current_tsc_ratio&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6a3d076f98c7c25a44d90f49f0fca2c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a3d076f98c7c25a44d90f49f0fca2c3">&#9670;&nbsp;</a></span>direct_access_msr_slot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int direct_access_msr_slot </td>
          <td>(</td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>msr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00757">757</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;{</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    u32 i;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">for</span> (i = 0; <a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].<a class="code" href="structsvm__direct__access__msrs.html#a392caedc2f625128ed478904dafbe718">index</a> != <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>; i++)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].index == msr)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;}</div>
<div class="ttc" id="astructsvm__direct__access__msrs_html_a392caedc2f625128ed478904dafbe718"><div class="ttname"><a href="structsvm__direct__access__msrs.html#a392caedc2f625128ed478904dafbe718">svm_direct_access_msrs::index</a></div><div class="ttdeci">u32 index</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00084">svm.c:84</a></div></div>
<div class="ttc" id="asvm_8c_html_ad73a1ea1e074171f7049d11e84aa1814"><div class="ttname"><a href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a></div><div class="ttdeci">static const struct svm_direct_access_msrs direct_access_msrs[MAX_DIRECT_ACCESS_MSRS]</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a6a3d076f98c7c25a44d90f49f0fca2c3_icgraph.png" border="0" usemap="#asvm_8c_a6a3d076f98c7c25a44d90f49f0fca2c3_icgraph" alt=""/></div>
<map name="asvm_8c_a6a3d076f98c7c25a44d90f49f0fca2c3_icgraph" id="asvm_8c_a6a3d076f98c7c25a44d90f49f0fca2c3_icgraph">
<area shape="rect" title=" " alt="" coords="3327,335,3500,362"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="2884,306,3080,333"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="3128,361,3279,387"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="2666,310,2825,337"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1809,234,1896,261"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="2230,125,2381,167"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="2021,60,2173,101"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="2453,281,2591,307"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="2437,65,2607,107"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="2454,554,2590,581"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="2043,655,2152,682"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="2455,503,2589,530"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="2443,332,2601,373"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="2437,453,2607,479"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1513,257,1641,283"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="2247,281,2363,307"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="2027,285,2168,311"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1732,285,1973,311"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="2232,60,2379,101"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="2238,554,2373,581"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1775,503,1930,530"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1743,605,1963,631"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,562,1673,589"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,496,1684,537"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,634,1679,661"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,379,719,406"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,329,1679,355"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,431,1668,472"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,583,1399,624"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,481,1403,507"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,531,1389,558"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,590,1144,617"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,430,1421,457"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,648,1408,689"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,648,1176,689"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,655,945,682"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,354,520,381"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,329,323,355"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,329,128,355"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,329,1412,355"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="2229,337,2381,363"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="2221,387,2389,414"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="2037,335,2157,362"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="2022,387,2173,428"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="1781,387,1925,428"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="1781,453,1924,479"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="2225,503,2385,530"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2042,503,2153,530"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="2903,357,3061,399"/>
<area shape="rect" href="svm_8c.html#ab4bda9cd8e4f3408d51dff1dd4403a11" title=" " alt="" coords="2655,365,2836,391"/>
</map>
</div>

</div>
</div>
<a id="a7ff4c846a46f6bb2e429d79bbc18f052"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ff4c846a46f6bb2e429d79bbc18f052">&#9670;&nbsp;</a></span>disable_nmi_singlestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void disable_nmi_singlestep </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01054">1054</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;{</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">nmi_singlestep</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">if</span> (!(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.guest_debug &amp; KVM_GUESTDBG_SINGLESTEP)) {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="comment">/* Clear our flags if they were not set by the guest */</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordflow">if</span> (!(svm-&gt;<a class="code" href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">nmi_singlestep_guest_rflags</a> &amp; X86_EFLAGS_TF))</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rflags &amp;= ~X86_EFLAGS_TF;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">if</span> (!(svm-&gt;<a class="code" href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">nmi_singlestep_guest_rflags</a> &amp; X86_EFLAGS_RF))</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rflags &amp;= ~X86_EFLAGS_RF;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    }</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_a87127740a2a7ad640bd9bbbdd594d7e9"><div class="ttname"><a href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">vcpu_svm::nmi_singlestep_guest_rflags</a></div><div class="ttdeci">u64 nmi_singlestep_guest_rflags</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00258">svm.h:258</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a7ff4c846a46f6bb2e429d79bbc18f052_icgraph.png" border="0" usemap="#asvm_8c_a7ff4c846a46f6bb2e429d79bbc18f052_icgraph" alt=""/></div>
<map name="asvm_8c_a7ff4c846a46f6bb2e429d79bbc18f052_icgraph" id="asvm_8c_a7ff4c846a46f6bb2e429d79bbc18f052_icgraph">
<area shape="rect" title=" " alt="" coords="176,31,351,57"/>
<area shape="rect" href="svm_8c.html#ae58d4aefe6338d19f8c4c62b4e7e96e8" title=" " alt="" coords="5,5,128,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="9,56,125,83"/>
</map>
</div>

</div>
</div>
<a id="a84f2d3e5d602af563ab58693bf87db77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84f2d3e5d602af563ab58693bf87db77">&#9670;&nbsp;</a></span>dr_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int dr_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02734">2734</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;{</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    <span class="keywordtype">int</span> reg, dr;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> val;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160; </div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="comment">     * SEV-ES intercepts DR7 only to disable guest debugging and the guest issues a VMGEXIT</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="comment">     * for DR7 write only. KVM cannot change DR7 (always swapped as type &#39;A&#39;) so return early.</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160; </div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;guest_debug == 0) {</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="comment">         * No more DR vmexits; force a reload of the debug registers</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="comment">         * and reenter on this instruction.  The next vmexit will</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="comment">         * retrieve the full state of the debug registers.</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        <a class="code" href="svm_8c.html#a02cdc4055c8a1706c884eff72c4caaf7">clr_dr_intercepts</a>(svm);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.switch_db_regs |= KVM_DEBUGREG_WONT_EXIT;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    }</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160; </div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_DECODEASSISTS))</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a5a07bdc17cad850b357e8312cd17921e">emulate_on_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; </div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    reg = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1 &amp; SVM_EXITINFO_REG_MASK;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    dr = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code - SVM_EXIT_READ_DR0;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <span class="keywordflow">if</span> (dr &gt;= 16) { <span class="comment">/* mov to DRn  */</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        dr -= 16;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        val = <a class="code" href="x86_8h.html#a9f7e7cd8d352da04de3bf53cbb3b4e57">kvm_register_read</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, reg);</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        err = <a class="code" href="x86_8c.html#a0df3660fa575d077f3dd97de063e5215">kvm_set_dr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, dr, val);</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        <a class="code" href="x86_8c.html#ab7339348823eb8883ba0bd2c98d827d3">kvm_get_dr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, dr, &amp;val);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        <a class="code" href="x86_8h.html#a777bea7283c857dc549e54eaa54fe12e">kvm_register_write</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, reg, val);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    }</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160; </div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42">kvm_complete_insn_gp</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, err);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a02cdc4055c8a1706c884eff72c4caaf7"><div class="ttname"><a href="svm_8c.html#a02cdc4055c8a1706c884eff72c4caaf7">clr_dr_intercepts</a></div><div class="ttdeci">static void clr_dr_intercepts(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00748">svm.c:748</a></div></div>
<div class="ttc" id="ax86_8c_html_a0df3660fa575d077f3dd97de063e5215"><div class="ttname"><a href="x86_8c.html#a0df3660fa575d077f3dd97de063e5215">kvm_set_dr</a></div><div class="ttdeci">int kvm_set_dr(struct kvm_vcpu *vcpu, int dr, unsigned long val)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01373">x86.c:1373</a></div></div>
<div class="ttc" id="ax86_8c_html_ab7339348823eb8883ba0bd2c98d827d3"><div class="ttname"><a href="x86_8c.html#ab7339348823eb8883ba0bd2c98d827d3">kvm_get_dr</a></div><div class="ttdeci">void kvm_get_dr(struct kvm_vcpu *vcpu, int dr, unsigned long *val)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01402">x86.c:1402</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a84f2d3e5d602af563ab58693bf87db77_cgraph.png" border="0" usemap="#asvm_8c_a84f2d3e5d602af563ab58693bf87db77_cgraph" alt=""/></div>
<map name="asvm_8c_a84f2d3e5d602af563ab58693bf87db77_cgraph" id="asvm_8c_a84f2d3e5d602af563ab58693bf87db77_cgraph">
<area shape="rect" title=" " alt="" coords="5,1151,125,1177"/>
<area shape="rect" href="svm_8c.html#a02cdc4055c8a1706c884eff72c4caaf7" title=" " alt="" coords="200,973,331,1000"/>
<area shape="rect" href="svm_8c.html#a5a07bdc17cad850b357e8312cd17921e" title=" " alt="" coords="173,676,357,703"/>
<area shape="rect" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42" title=" " alt="" coords="177,840,353,867"/>
<area shape="rect" href="x86_8c.html#ab7339348823eb8883ba0bd2c98d827d3" title=" " alt="" coords="216,1201,315,1228"/>
<area shape="rect" href="x86_8h.html#a9f7e7cd8d352da04de3bf53cbb3b4e57" title=" " alt="" coords="193,1151,337,1177"/>
<area shape="rect" href="x86_8h.html#a777bea7283c857dc549e54eaa54fe12e" title=" " alt="" coords="191,1100,339,1127"/>
<area shape="rect" href="x86_8c.html#a0df3660fa575d077f3dd97de063e5215" title=" " alt="" coords="216,1265,315,1292"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="210,1316,321,1343"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="230,1367,301,1393"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="433,923,566,949"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1199,639,1319,665"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="665,791,848,833"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="666,857,847,898"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="683,923,830,949"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="689,1024,825,1051"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="681,740,832,767"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="960,864,1079,891"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="943,915,1096,941"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="405,587,593,613"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="665,443,848,469"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="1191,468,1326,495"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="921,595,1118,621"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="930,645,1109,672"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="943,697,1096,738"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="958,5,1081,32"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="925,341,1113,368"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="1174,341,1343,368"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1167,291,1351,317"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="920,291,1119,317"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="939,107,1099,149"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="924,173,1115,200"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="939,225,1100,266"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="929,763,1110,789"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="962,544,1077,571"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="959,493,1080,520"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="926,813,1113,840"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="1169,929,1348,956"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="1399,929,1585,956"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="641,689,872,716"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="437,1125,561,1152"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="412,1176,587,1203"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="701,1125,813,1152"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="660,1176,853,1203"/>
<area shape="rect" href="x86_8c.html#a2aeff0b787a2133f4809c6a94c6458d7" title=" " alt="" coords="441,1379,558,1405"/>
<area shape="rect" href="x86_8h.html#a401b9fcb1381d2fbfc488f8520093cee" title=" " alt="" coords="440,1227,559,1253"/>
<area shape="rect" href="x86_8h.html#a6d86e9ee10c2cd72b82aef25cabafd82" title=" " alt="" coords="440,1277,559,1304"/>
<area shape="rect" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a" title=" " alt="" coords="434,1328,565,1355"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="691,1379,822,1405"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="446,1429,553,1456"/>
</map>
</div>

</div>
</div>
<a id="adc30f731ef4ff2d797ec137e5fab0f69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc30f731ef4ff2d797ec137e5fab0f69">&#9670;&nbsp;</a></span>dump_vmcb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_vmcb </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03312">3312</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;{</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    <span class="keyword">struct </span>vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a> = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control;</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;    <span class="keyword">struct </span>vmcb_save_area *save = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save;</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    <span class="keyword">struct </span>vmcb_save_area *save01 = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save;</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160; </div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a66f9274e37ab06b0ee941e4480352ba8">dump_invalid_vmcb</a>) {</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;        pr_warn_ratelimited(<span class="stringliteral">&quot;set kvm_amd.dump_invalid_vmcb=1 to dump internal KVM state.\n&quot;</span>);</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    }</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160; </div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    pr_err(<span class="stringliteral">&quot;VMCB %p, last attempted VMRUN on CPU %d\n&quot;</span>,</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;           svm-&gt;<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a>-&gt;<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>, vcpu-&gt;arch.last_vmentry_cpu);</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;    pr_err(<span class="stringliteral">&quot;VMCB Control Area:\n&quot;</span>);</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%04x\n&quot;</span>, <span class="stringliteral">&quot;cr_read:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts[INTERCEPT_CR] &amp; 0xffff);</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%04x\n&quot;</span>, <span class="stringliteral">&quot;cr_write:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts[INTERCEPT_CR] &gt;&gt; 16);</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%04x\n&quot;</span>, <span class="stringliteral">&quot;dr_read:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts[INTERCEPT_DR] &amp; 0xffff);</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%04x\n&quot;</span>, <span class="stringliteral">&quot;dr_write:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts[INTERCEPT_DR] &gt;&gt; 16);</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%08x\n&quot;</span>, <span class="stringliteral">&quot;exceptions:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts[INTERCEPT_EXCEPTION]);</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%08x %08x\n&quot;</span>, <span class="stringliteral">&quot;intercepts:&quot;</span>,</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;              <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts[INTERCEPT_WORD3],</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;           <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts[INTERCEPT_WORD4]);</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%d\n&quot;</span>, <span class="stringliteral">&quot;pause filter count:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_count);</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%d\n&quot;</span>, <span class="stringliteral">&quot;pause filter threshold:&quot;</span>,</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;           <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_thresh);</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;iopm_base_pa:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;iopm_base_pa);</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;msrpm_base_pa:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;msrpm_base_pa);</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;tsc_offset:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;tsc_offset);</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%d\n&quot;</span>, <span class="stringliteral">&quot;asid:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;asid);</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%d\n&quot;</span>, <span class="stringliteral">&quot;tlb_ctl:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;tlb_ctl);</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%08x\n&quot;</span>, <span class="stringliteral">&quot;int_ctl:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;int_ctl);</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%08x\n&quot;</span>, <span class="stringliteral">&quot;int_vector:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;int_vector);</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%08x\n&quot;</span>, <span class="stringliteral">&quot;int_state:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;int_state);</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%08x\n&quot;</span>, <span class="stringliteral">&quot;exit_code:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_code);</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;exit_info1:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_1);</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;exit_info2:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_2);</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%08x\n&quot;</span>, <span class="stringliteral">&quot;exit_int_info:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_int_info);</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%08x\n&quot;</span>, <span class="stringliteral">&quot;exit_int_info_err:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_int_info_err);</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%lld\n&quot;</span>, <span class="stringliteral">&quot;nested_ctl:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;nested_ctl);</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;nested_cr3:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;nested_cr3);</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;avic_vapic_bar:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;avic_vapic_bar);</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;ghcb:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;ghcb_gpa);</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%08x\n&quot;</span>, <span class="stringliteral">&quot;event_inj:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;event_inj);</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%08x\n&quot;</span>, <span class="stringliteral">&quot;event_inj_err:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;event_inj_err);</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%lld\n&quot;</span>, <span class="stringliteral">&quot;virt_ext:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;virt_ext);</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;next_rip:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;next_rip);</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;avic_backing_page:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;avic_backing_page);</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;avic_logical_id:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;avic_logical_id);</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;avic_physical_id:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;avic_physical_id);</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;    pr_err(<span class="stringliteral">&quot;%-20s%016llx\n&quot;</span>, <span class="stringliteral">&quot;vmsa_pa:&quot;</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;vmsa_pa);</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    pr_err(<span class="stringliteral">&quot;VMCB State Save Area:\n&quot;</span>);</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;    pr_err(<span class="stringliteral">&quot;%-5s s: %04x a: %04x l: %08x b: %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;           <span class="stringliteral">&quot;es:&quot;</span>,</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;           save-&gt;es.selector, save-&gt;es.attrib,</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;           save-&gt;es.limit, save-&gt;es.base);</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;    pr_err(<span class="stringliteral">&quot;%-5s s: %04x a: %04x l: %08x b: %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;           <span class="stringliteral">&quot;cs:&quot;</span>,</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;           save-&gt;cs.selector, save-&gt;cs.attrib,</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;           save-&gt;cs.limit, save-&gt;cs.base);</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;    pr_err(<span class="stringliteral">&quot;%-5s s: %04x a: %04x l: %08x b: %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;           <span class="stringliteral">&quot;ss:&quot;</span>,</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;           save-&gt;ss.selector, save-&gt;ss.attrib,</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;           save-&gt;ss.limit, save-&gt;ss.base);</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    pr_err(<span class="stringliteral">&quot;%-5s s: %04x a: %04x l: %08x b: %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;           <span class="stringliteral">&quot;ds:&quot;</span>,</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;           save-&gt;ds.selector, save-&gt;ds.attrib,</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;           save-&gt;ds.limit, save-&gt;ds.base);</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;    pr_err(<span class="stringliteral">&quot;%-5s s: %04x a: %04x l: %08x b: %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;           <span class="stringliteral">&quot;fs:&quot;</span>,</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;           save01-&gt;fs.selector, save01-&gt;fs.attrib,</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;           save01-&gt;fs.limit, save01-&gt;fs.base);</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    pr_err(<span class="stringliteral">&quot;%-5s s: %04x a: %04x l: %08x b: %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;           <span class="stringliteral">&quot;gs:&quot;</span>,</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;           save01-&gt;gs.selector, save01-&gt;gs.attrib,</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;           save01-&gt;gs.limit, save01-&gt;gs.base);</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;    pr_err(<span class="stringliteral">&quot;%-5s s: %04x a: %04x l: %08x b: %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;           <span class="stringliteral">&quot;gdtr:&quot;</span>,</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;           save-&gt;gdtr.selector, save-&gt;gdtr.attrib,</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;           save-&gt;gdtr.limit, save-&gt;gdtr.base);</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;    pr_err(<span class="stringliteral">&quot;%-5s s: %04x a: %04x l: %08x b: %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;           <span class="stringliteral">&quot;ldtr:&quot;</span>,</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;           save01-&gt;ldtr.selector, save01-&gt;ldtr.attrib,</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;           save01-&gt;ldtr.limit, save01-&gt;ldtr.base);</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;    pr_err(<span class="stringliteral">&quot;%-5s s: %04x a: %04x l: %08x b: %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;           <span class="stringliteral">&quot;idtr:&quot;</span>,</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;           save-&gt;idtr.selector, save-&gt;idtr.attrib,</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;           save-&gt;idtr.limit, save-&gt;idtr.base);</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    pr_err(<span class="stringliteral">&quot;%-5s s: %04x a: %04x l: %08x b: %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;           <span class="stringliteral">&quot;tr:&quot;</span>,</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;           save01-&gt;tr.selector, save01-&gt;tr.attrib,</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;           save01-&gt;tr.limit, save01-&gt;tr.base);</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    pr_err(<span class="stringliteral">&quot;vmpl: %d   cpl:  %d               efer:          %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;           save-&gt;vmpl, save-&gt;cpl, save-&gt;efer);</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;           <span class="stringliteral">&quot;cr0:&quot;</span>, save-&gt;cr0, <span class="stringliteral">&quot;cr2:&quot;</span>, save-&gt;cr2);</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;           <span class="stringliteral">&quot;cr3:&quot;</span>, save-&gt;cr3, <span class="stringliteral">&quot;cr4:&quot;</span>, save-&gt;cr4);</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;           <span class="stringliteral">&quot;dr6:&quot;</span>, save-&gt;dr6, <span class="stringliteral">&quot;dr7:&quot;</span>, save-&gt;dr7);</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;           <span class="stringliteral">&quot;rip:&quot;</span>, save-&gt;rip, <span class="stringliteral">&quot;rflags:&quot;</span>, save-&gt;rflags);</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;           <span class="stringliteral">&quot;rsp:&quot;</span>, save-&gt;rsp, <span class="stringliteral">&quot;rax:&quot;</span>, save-&gt;rax);</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;           <span class="stringliteral">&quot;star:&quot;</span>, save01-&gt;star, <span class="stringliteral">&quot;lstar:&quot;</span>, save01-&gt;lstar);</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;           <span class="stringliteral">&quot;cstar:&quot;</span>, save01-&gt;cstar, <span class="stringliteral">&quot;sfmask:&quot;</span>, save01-&gt;sfmask);</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;           <span class="stringliteral">&quot;kernel_gs_base:&quot;</span>, save01-&gt;kernel_gs_base,</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;           <span class="stringliteral">&quot;sysenter_cs:&quot;</span>, save01-&gt;sysenter_cs);</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;           <span class="stringliteral">&quot;sysenter_esp:&quot;</span>, save01-&gt;sysenter_esp,</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;           <span class="stringliteral">&quot;sysenter_eip:&quot;</span>, save01-&gt;sysenter_eip);</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;           <span class="stringliteral">&quot;gpat:&quot;</span>, save-&gt;g_pat, <span class="stringliteral">&quot;dbgctl:&quot;</span>, save-&gt;dbgctl);</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;           <span class="stringliteral">&quot;br_from:&quot;</span>, save-&gt;br_from, <span class="stringliteral">&quot;br_to:&quot;</span>, save-&gt;br_to);</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;    pr_err(<span class="stringliteral">&quot;%-15s %016llx %-13s %016llx\n&quot;</span>,</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;           <span class="stringliteral">&quot;excp_from:&quot;</span>, save-&gt;last_excp_from,</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;           <span class="stringliteral">&quot;excp_to:&quot;</span>, save-&gt;last_excp_to);</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;}</div>
<div class="ttc" id="aposted__intr_8h_html_ae3d3aff52ed2ae9f00a97cfda9ceca6d"><div class="ttname"><a href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a></div><div class="ttdeci">u64 control</div><div class="ttdef"><b>Definition:</b> <a href="posted__intr_8h_source.html#l00016">posted_intr.h:16</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a255650cdd9fc03e4da05d1f0f154452a"><div class="ttname"><a href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">vcpu_svm::current_vmcb</a></div><div class="ttdeci">struct kvm_vmcb_info * current_vmcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00214">svm.h:214</a></div></div>
<div class="ttc" id="asvm_8c_html_a66f9274e37ab06b0ee941e4480352ba8"><div class="ttname"><a href="svm_8c.html#a66f9274e37ab06b0ee941e4480352ba8">dump_invalid_vmcb</a></div><div class="ttdeci">bool __read_mostly dump_invalid_vmcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00231">svm.c:231</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_adc30f731ef4ff2d797ec137e5fab0f69_cgraph.png" border="0" usemap="#asvm_8c_adc30f731ef4ff2d797ec137e5fab0f69_cgraph" alt=""/></div>
<map name="asvm_8c_adc30f731ef4ff2d797ec137e5fab0f69_cgraph" id="asvm_8c_adc30f731ef4ff2d797ec137e5fab0f69_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,108,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="156,5,227,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_adc30f731ef4ff2d797ec137e5fab0f69_icgraph.png" border="0" usemap="#asvm_8c_adc30f731ef4ff2d797ec137e5fab0f69_icgraph" alt=""/></div>
<map name="asvm_8c_adc30f731ef4ff2d797ec137e5fab0f69_icgraph" id="asvm_8c_adc30f731ef4ff2d797ec137e5fab0f69_icgraph">
<area shape="rect" title=" " alt="" coords="884,31,987,57"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="223,5,356,32"/>
<area shape="rect" href="svm_8c.html#ab46a833ac93ce3fda7973768cadb1929" title=" " alt="" coords="652,56,836,83"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="416,56,604,83"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="5,85,163,112"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="211,107,368,149"/>
</map>
</div>

</div>
</div>
<a id="acb46126747f78036462437a7bcdc2e47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb46126747f78036462437a7bcdc2e47">&#9670;&nbsp;</a></span>efer_trap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int efer_trap </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02791">2791</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;{</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keyword">struct </span>msr_data msr_info;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="comment">     * Clear the EFER_SVME bit from EFER. The SVM code always sets this</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment">     * bit in svm_set_efer(), but __kvm_valid_efer() checks it against</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="comment">     * whether the guest has X86_FEATURE_SVM - this avoids a failure if</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="comment">     * the guest doesn&#39;t have X86_FEATURE_SVM.</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    msr_info.host_initiated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    msr_info.index = MSR_EFER;</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    msr_info.data = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1 &amp; ~EFER_SVME;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    ret = <a class="code" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299">kvm_set_msr_common</a>(vcpu, &amp;msr_info);</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160; </div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42">kvm_complete_insn_gp</a>(vcpu, ret);</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;}</div>
<div class="ttc" id="ax86_8c_html_aec2b7dd73668f030b4e2f8d8815d7299"><div class="ttname"><a href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299">kvm_set_msr_common</a></div><div class="ttdeci">int kvm_set_msr_common(struct kvm_vcpu *vcpu, struct msr_data *msr_info)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l03737">x86.c:3737</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_acb46126747f78036462437a7bcdc2e47_cgraph.png" border="0" usemap="#asvm_8c_acb46126747f78036462437a7bcdc2e47_cgraph" alt=""/></div>
<map name="asvm_8c_acb46126747f78036462437a7bcdc2e47_cgraph" id="asvm_8c_acb46126747f78036462437a7bcdc2e47_cgraph">
<area shape="rect" title=" " alt="" coords="5,807,87,833"/>
<area shape="rect" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42" title=" " alt="" coords="135,393,311,420"/>
<area shape="rect" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299" title=" " alt="" coords="135,807,310,833"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="187,857,258,884"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="359,31,589,57"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="650,5,831,32"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="647,56,834,83"/>
<area shape="rect" href="x86_8c.html#a630ac093595c64d6afa91d75a62743a3" title=" " alt="" coords="387,183,561,209"/>
<area shape="rect" href="cpuid_8h.html#af84298b58b36ef9fc4198f2de91c2771" title=" " alt="" coords="397,233,551,260"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="675,284,806,311"/>
<area shape="rect" href="cpuid_8h.html#a7d953eb2c52baf0364a2a26c6748ee94" title=" " alt="" coords="379,284,569,311"/>
<area shape="rect" href="cpuid_8h.html#a831ae844ef432e45ec7a88f170a7e1dc" title=" " alt="" coords="685,335,796,361"/>
<area shape="rect" href="async__pf_8c.html#aac6395172fbf7947412604d7e2f33417" title=" " alt="" coords="393,690,555,731"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="391,756,557,783"/>
<area shape="rect" href="x86_8c.html#a37404aa00211466502dd27a08460271b" title=" " alt="" coords="661,1002,821,1043"/>
<area shape="rect" href="hyperv_8c.html#ab6a097fa5ccc00cb31061629a4e3e2f7" title=" " alt="" coords="375,588,573,615"/>
<area shape="rect" href="lapic_8c.html#a9c3f4680631c7f6cb33a6a5c4c001750" title=" " alt="" coords="901,436,1068,463"/>
<area shape="rect" href="x86_8h.html#acc780a5b6599f782ea4d46c4cd5d9d1f" title=" " alt="" coords="899,639,1070,665"/>
<area shape="rect" href="x86_8c.html#a55618c7cba87bb75862507a65d590c17" title=" " alt="" coords="395,908,553,935"/>
<area shape="rect" href="mtrr_8c.html#a2b95f238c68e317e64e57d06f2a698dd" title=" " alt="" coords="401,959,547,985"/>
<area shape="rect" href="x86_8h.html#a572e16f77096be80cec8ed2137ea74c2" title=" " alt="" coords="415,1009,533,1036"/>
<area shape="rect" href="pmu_8c.html#a5051f59b2585f6137d3781a4d2bd0c38" title=" " alt="" coords="386,1060,562,1087"/>
<area shape="rect" href="pmu_8c.html#a6d6bf5af13e5325bcfc07034b4d06e6c" title=" " alt="" coords="404,1111,544,1137"/>
<area shape="rect" href="pmu_8c.html#a57bb9e9b63066a1ad4b7e8096b7e7cf9" title=" " alt="" coords="401,1161,547,1188"/>
<area shape="rect" href="x86_8c.html#a56e13bff56e8184d17fdc89b142a05c3" title=" " alt="" coords="379,487,569,513"/>
<area shape="rect" href="x86_8c.html#ae62d7dbb6a6146b0fa1af42e6099b9ba" title=" " alt="" coords="389,1213,559,1254"/>
<area shape="rect" href="x86_8c.html#a9d9f2a266299bc56c932735db94816d5" title=" " alt="" coords="399,335,549,361"/>
<area shape="rect" href="lapic_8c.html#a44881cc17bdbe632a483e8c7c1dd0dfb" title=" " alt="" coords="359,1279,589,1305"/>
<area shape="rect" href="x86_8c.html#a6665e0ffd62305dcaa5e032291350190" title=" " alt="" coords="393,857,555,884"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="373,1329,575,1356"/>
<area shape="rect" href="x86_8c.html#ac78db676ecdcad5ee88c478439da75a9" title=" " alt="" coords="383,1380,565,1407"/>
<area shape="rect" href="x86_8c.html#addff58fdbcf682ae8665b64238e3adfb" title=" " alt="" coords="391,1431,557,1457"/>
<area shape="rect" href="lapic_8c.html#a7d2f3f34c12c8c724fe739cbbc44ad43" title=" " alt="" coords="387,1481,561,1508"/>
<area shape="rect" href="xen_8c.html#a8ee930b1f9fc4736a86b12bf73d43f74" title=" " alt="" coords="361,1532,587,1559"/>
<area shape="rect" href="x86_8c.html#a420caf80521ab8d6ef7218d5dd26d47f" title=" " alt="" coords="437,1583,511,1609"/>
<area shape="rect" href="x86_8c.html#a54824b736aa4b0e4f3dca0655eb678d2" title=" " alt="" coords="419,81,529,108"/>
<area shape="rect" href="cpuid_8h.html#a0f86e383596ed59413757a8502625f31" title=" " alt="" coords="395,132,553,159"/>
<area shape="rect" href="x86_8c.html#a7c9ec3443e88bcdbc3befa436fdea079" title=" " alt="" coords="663,175,818,217"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="931,259,1038,285"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="892,309,1077,336"/>
<area shape="rect" href="x86_8c.html#a62f68db08e13f0a4f3d158afda4631b1" title=" " alt="" coords="655,871,826,913"/>
<area shape="rect" href="mmu_8c.html#a339656816251af93fbd52aece22a2009" title=" " alt="" coords="655,937,826,978"/>
<area shape="rect" href="x86_8c.html#abe891acb00f8f1c0cd67017dc20b89a6" title=" " alt="" coords="651,741,830,782"/>
<area shape="rect" href="async__pf_8c.html#a5b03475159778ff1b6a78dbbfc913a01" title=" " alt="" coords="664,806,817,847"/>
<area shape="rect" href="x86_8c.html#a82290aaeb3d7ee560af215724efad4c2" title=" " alt="" coords="925,1009,1044,1036"/>
<area shape="rect" href="hyperv_8c.html#aab39439bc7208406fbf9d3e724bafc95" title=" " alt="" coords="637,537,844,564"/>
<area shape="rect" href="hyperv_8c.html#adbfbc91bbdd19f529b4489eb1d8e1ec7" title=" " alt="" coords="674,487,807,513"/>
<area shape="rect" href="hyperv_8c.html#ab932fdee37432b09f988174935dfa876" title=" " alt="" coords="661,639,820,665"/>
<area shape="rect" href="hyperv_8c.html#a6b9b9a8864c87d56aa2c400fa1331b0b" title=" " alt="" coords="671,588,811,615"/>
<area shape="rect" href="kvm__main_8c.html#ac6c49245c7b6995e95ebe7128b7d1c80" title=" " alt="" coords="1125,411,1328,437"/>
</map>
</div>

</div>
</div>
<a id="a5a07bdc17cad850b357e8312cd17921e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a07bdc17cad850b357e8312cd17921e">&#9670;&nbsp;</a></span>emulate_on_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int emulate_on_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02591">2591</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;{</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646">kvm_emulate_instruction</a>(vcpu, 0);</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5a07bdc17cad850b357e8312cd17921e_cgraph.png" border="0" usemap="#asvm_8c_a5a07bdc17cad850b357e8312cd17921e_cgraph" alt=""/></div>
<map name="asvm_8c_a5a07bdc17cad850b357e8312cd17921e_cgraph" id="asvm_8c_a5a07bdc17cad850b357e8312cd17921e_cgraph">
<area shape="rect" title=" " alt="" coords="5,1171,189,1197"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="237,1171,425,1197"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="473,689,656,716"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="989,341,1123,368"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="705,1339,902,1365"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="714,1389,893,1416"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="727,174,880,215"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="742,1440,865,1467"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="709,880,897,907"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="971,829,1141,856"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1440,796,1624,823"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="704,744,903,771"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="723,1491,883,1533"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="708,5,899,32"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="723,57,884,98"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="713,240,894,267"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="746,291,861,317"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="743,459,864,485"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="717,561,889,602"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="710,509,897,536"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="722,1124,885,1151"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="739,1187,868,1213"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="722,123,885,149"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="1013,1469,1099,1496"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="719,342,888,383"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="733,1237,874,1264"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1232,341,1369,368"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1459,392,1605,419"/>
<area shape="rect" href="x86_8c.html#a2a7f61481aae2e0bfe4baaba68d6d650" title=" " alt="" coords="971,1520,1141,1547"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="981,21,1131,48"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1472,1149,1592,1176"/>
<area shape="rect" href="x86_8c.html#aea69aad92f3a36aaebec0c2a9e853b61" title=" " alt="" coords="967,931,1145,973"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1209,796,1392,823"/>
<area shape="rect" href="x86_8c.html#a8bbfd08c002f2e09b42bb56cd8f52653" title=" " alt="" coords="975,763,1137,805"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="995,123,1117,149"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="977,174,1135,215"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="969,240,1143,267"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="971,72,1141,99"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="967,291,1145,317"/>
<area shape="rect" href="x86_8c.html#a0a47622bf3c21272e9e0357e1f90540a" title=" " alt="" coords="964,595,1148,637"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="964,493,1148,520"/>
<area shape="rect" href="x86_8c.html#a2857d8949e4bb5216636d3f7b03edc88" title=" " alt="" coords="965,544,1147,571"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="1011,1048,1101,1075"/>
<area shape="rect" href="x86_8c.html#a52a62306898287a4475c0b6e78b30bf8" title=" " alt="" coords="969,1251,1143,1293"/>
<area shape="rect" href="mmu_8c.html#a45417375d740e0905773ac641827e0a0" title=" " alt="" coords="956,1200,1156,1227"/>
<area shape="rect" href="kvm__main_8c.html#af83e69473e2fe5bf6e452f3fc1f414d2" title=" " alt="" coords="968,1099,1144,1125"/>
<area shape="rect" href="emulate_8c.html#aee81e1534f235fdd985a388efb39983d" title=" " alt="" coords="951,1368,1161,1395"/>
<area shape="rect" href="fpu_8h.html#a8688ee98febd42598a4f6e45d1e9ef0b" title=" " alt="" coords="1221,1571,1381,1597"/>
<area shape="rect" href="fpu_8h.html#aaa61f7bcc588bff69c55d04dd8563583" title=" " alt="" coords="1227,1469,1375,1496"/>
<area shape="rect" href="emulate_8c.html#add9e11c9950d2e663b204801be3aad7f" title=" " alt="" coords="1220,1520,1381,1547"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5a07bdc17cad850b357e8312cd17921e_icgraph.png" border="0" usemap="#asvm_8c_a5a07bdc17cad850b357e8312cd17921e_icgraph" alt=""/></div>
<map name="asvm_8c_a5a07bdc17cad850b357e8312cd17921e_icgraph" id="asvm_8c_a5a07bdc17cad850b357e8312cd17921e_icgraph">
<area shape="rect" title=" " alt="" coords="388,31,572,57"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="221,5,339,32"/>
<area shape="rect" href="svm_8c.html#a84f2d3e5d602af563ab58693bf87db77" title=" " alt="" coords="220,56,340,83"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="5,5,172,32"/>
</map>
</div>

</div>
</div>
<a id="a1eacc7b79f62ed332056217c35fe3be4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1eacc7b79f62ed332056217c35fe3be4">&#9670;&nbsp;</a></span>emulate_svm_instr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int emulate_svm_instr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>opcode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02333">2333</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;{</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> guest_mode_exit_codes[] = {</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        [<a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a4fc4da3a6a1a9c998f04b7988ba00834">SVM_INSTR_VMRUN</a>] = SVM_EXIT_VMRUN,</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        [<a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603aafab86473fad2281466fe8b1d89b74d9">SVM_INSTR_VMLOAD</a>] = SVM_EXIT_VMLOAD,</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        [<a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a5eb1e788833fd7f4e89343327e575e32">SVM_INSTR_VMSAVE</a>] = SVM_EXIT_VMSAVE,</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    };</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    int (*<span class="keyword">const</span> svm_instr_handlers[])(<span class="keyword">struct </span>kvm_vcpu *vcpu) = {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        [<a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a4fc4da3a6a1a9c998f04b7988ba00834">SVM_INSTR_VMRUN</a>] = <a class="code" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1">vmrun_interception</a>,</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        [<a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603aafab86473fad2281466fe8b1d89b74d9">SVM_INSTR_VMLOAD</a>] = <a class="code" href="svm_8c.html#a21c0c414304458bb0fdecde7cc8eeb2d">vmload_interception</a>,</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        [<a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a5eb1e788833fd7f4e89343327e575e32">SVM_INSTR_VMSAVE</a>] = <a class="code" href="svm_8c.html#a81c9359522d571596389c15258054845">vmsave_interception</a>,</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    };</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>)) {</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        <span class="comment">/* Returns &#39;1&#39; or -errno on failure, &#39;0&#39; on success. */</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        ret = <a class="code" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b">nested_svm_simple_vmexit</a>(svm, guest_mode_exit_codes[<a class="code" href="structopcode.html">opcode</a>]);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    }</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    <span class="keywordflow">return</span> svm_instr_handlers[<a class="code" href="structopcode.html">opcode</a>](<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;}</div>
<div class="ttc" id="astructopcode_html"><div class="ttname"><a href="structopcode.html">opcode</a></div><div class="ttdef"><b>Definition:</b> <a href="emulate_8c_source.html#l00193">emulate.c:193</a></div></div>
<div class="ttc" id="asvm_8c_html_a21c0c414304458bb0fdecde7cc8eeb2d"><div class="ttname"><a href="svm_8c.html#a21c0c414304458bb0fdecde7cc8eeb2d">vmload_interception</a></div><div class="ttdeci">static int vmload_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02286">svm.c:2286</a></div></div>
<div class="ttc" id="asvm_8c_html_a5d52c93beeb85ba5a99283d4eba589e1"><div class="ttname"><a href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1">vmrun_interception</a></div><div class="ttdeci">static int vmrun_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02296">svm.c:2296</a></div></div>
<div class="ttc" id="asvm_8c_html_a81c9359522d571596389c15258054845"><div class="ttname"><a href="svm_8c.html#a81c9359522d571596389c15258054845">vmsave_interception</a></div><div class="ttdeci">static int vmsave_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02291">svm.c:2291</a></div></div>
<div class="ttc" id="asvm_8h_html_a7b2d87885eea1b11b1bf1045c21c5a8b"><div class="ttname"><a href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b">nested_svm_simple_vmexit</a></div><div class="ttdeci">static int nested_svm_simple_vmexit(struct vcpu_svm *svm, u32 exit_code)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00602">svm.h:602</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1eacc7b79f62ed332056217c35fe3be4_cgraph.png" border="0" usemap="#asvm_8c_a1eacc7b79f62ed332056217c35fe3be4_cgraph" alt=""/></div>
<map name="asvm_8c_a1eacc7b79f62ed332056217c35fe3be4_cgraph" id="asvm_8c_a1eacc7b79f62ed332056217c35fe3be4_cgraph">
<area shape="rect" title=" " alt="" coords="5,1997,152,2024"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1037,122,1157,149"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="200,1449,405,1476"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1279,1592,1350,1618"/>
<area shape="rect" href="svm_8c.html#a21c0c414304458bb0fdecde7cc8eeb2d" title=" " alt="" coords="225,2022,381,2049"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="228,1972,377,1998"/>
<area shape="rect" href="svm_8c.html#a81c9359522d571596389c15258054845" title=" " alt="" coords="223,2073,382,2100"/>
<area shape="rect" href="svm_8h.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="483,978,638,1005"/>
<area shape="rect" href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73" title=" " alt="" coords="733,978,931,1005"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1038,173,1157,200"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="751,1029,913,1056"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="751,1080,913,1122"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="755,1146,909,1187"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="771,1668,893,1694"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="753,325,911,352"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="1013,1921,1182,1948"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="775,1718,889,1745"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="775,1769,889,1796"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="777,1617,887,1644"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="775,376,889,402"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a30f9ca7e6fd08d1cf123f57fbfba01c7" title=" " alt="" coords="775,426,889,453"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633" title=" " alt="" coords="773,477,891,504"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="771,528,893,554"/>
<area shape="rect" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a" title=" " alt="" coords="767,578,897,605"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="769,1972,895,1998"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="761,1820,903,1846"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="759,629,905,656"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="757,680,907,706"/>
<area shape="rect" href="svm_2nested_8c.html#a5b731f64682240fd51bd242f194b33f4" title=" " alt="" coords="751,731,913,772"/>
<area shape="rect" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f" title=" " alt="" coords="996,1171,1199,1212"/>
<area shape="rect" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab" title=" " alt="" coords="1016,1237,1179,1264"/>
<area shape="rect" href="svm_2nested_8c.html#af381358fd9991ce7d26d81fdb9f763a9" title=" " alt="" coords="747,796,917,838"/>
<area shape="rect" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53" title=" " alt="" coords="739,862,925,903"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="1038,404,1157,430"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1247,1018,1383,1045"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="780,1262,884,1289"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="1045,1069,1149,1096"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="777,1465,887,1492"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="1047,1440,1148,1466"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="1026,1338,1169,1365"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="765,122,899,149"/>
<area shape="rect" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943" title=" " alt="" coords="1004,1642,1191,1669"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="1273,1120,1357,1146"/>
<area shape="rect" href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67" title=" " alt="" coords="1061,1592,1134,1618"/>
<area shape="rect" href="svm_8c.html#a22d5ad8a3cac7e24cb8438a20eb39348" title=" " alt="" coords="453,2073,668,2100"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="717,2073,947,2100"/>
<area shape="rect" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8" title=" " alt="" coords="716,2124,948,2150"/>
<area shape="rect" href="svm_2nested_8c.html#ae2a559173016267c3c1ef55be6571c0c" title=" " alt="" coords="745,2226,919,2267"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="485,1845,636,1872"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="743,1364,921,1390"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1eacc7b79f62ed332056217c35fe3be4_icgraph.png" border="0" usemap="#asvm_8c_a1eacc7b79f62ed332056217c35fe3be4_icgraph" alt=""/></div>
<map name="asvm_8c_a1eacc7b79f62ed332056217c35fe3be4_icgraph" id="asvm_8c_a1eacc7b79f62ed332056217c35fe3be4_icgraph">
<area shape="rect" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="a1a78719a48d64b80ead6c34e9ab1cccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a78719a48d64b80ead6c34e9ab1cccf">&#9670;&nbsp;</a></span>get_npt_level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int get_npt_level </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00287">287</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">#ifdef CONFIG_X86_64</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span> pgtable_l5_enabled() ? <a class="code" href="mmu_8h.html#a19051c7c7463cebcb4d2f335e546499c">PT64_ROOT_5LEVEL</a> : <a class="code" href="mmu_8h.html#ac16f657d0a07511b24afa81de87e2404">PT64_ROOT_4LEVEL</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mmu_8h.html#a922bba5668a44d08bf7c7ba3a5e4fba0">PT32E_ROOT_LEVEL</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="ttc" id="ammu_8h_html_a19051c7c7463cebcb4d2f335e546499c"><div class="ttname"><a href="mmu_8h.html#a19051c7c7463cebcb4d2f335e546499c">PT64_ROOT_5LEVEL</a></div><div class="ttdeci">#define PT64_ROOT_5LEVEL</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8h_source.html#l00034">mmu.h:34</a></div></div>
<div class="ttc" id="ammu_8h_html_a922bba5668a44d08bf7c7ba3a5e4fba0"><div class="ttname"><a href="mmu_8h.html#a922bba5668a44d08bf7c7ba3a5e4fba0">PT32E_ROOT_LEVEL</a></div><div class="ttdeci">#define PT32E_ROOT_LEVEL</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8h_source.html#l00037">mmu.h:37</a></div></div>
<div class="ttc" id="ammu_8h_html_ac16f657d0a07511b24afa81de87e2404"><div class="ttname"><a href="mmu_8h.html#ac16f657d0a07511b24afa81de87e2404">PT64_ROOT_4LEVEL</a></div><div class="ttdeci">#define PT64_ROOT_4LEVEL</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8h_source.html#l00035">mmu.h:35</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1a78719a48d64b80ead6c34e9ab1cccf_icgraph.png" border="0" usemap="#asvm_8c_a1a78719a48d64b80ead6c34e9ab1cccf_icgraph" alt=""/></div>
<map name="asvm_8c_a1a78719a48d64b80ead6c34e9ab1cccf_icgraph" id="asvm_8c_a1a78719a48d64b80ead6c34e9ab1cccf_icgraph">
<area shape="rect" title=" " alt="" coords="215,5,325,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="a7c2323b13a5022aa9f6a9ae5ebe4d830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c2323b13a5022aa9f6a9ae5ebe4d830">&#9670;&nbsp;</a></span>gp_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gp_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02366">2366</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;{</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    u32 error_code = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structopcode.html">opcode</a>;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    <span class="comment">/* Both #GP cases have zero error_code */</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <span class="keywordflow">if</span> (error_code)</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <span class="keywordflow">goto</span> reinject;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    <span class="comment">/* Decode the instruction for usage later */</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76">x86_decode_emulated_instruction</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, 0, NULL, 0) != <a class="code" href="kvm__emulate_8h.html#a76fa88b08b7a85fe5729e86d9b21dfde">EMULATION_OK</a>)</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        <span class="keywordflow">goto</span> reinject;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; </div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <a class="code" href="structopcode.html">opcode</a> = <a class="code" href="svm_8c.html#a0a4c593c8666cfa6b032b7bc7639b81b">svm_instr_opcode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structopcode.html">opcode</a> == <a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603acde1334d18ebb932ec5a98bf93c431ae">NONE_SVM_INSTR</a>) {</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a2ce1016cd5cbf9583cfe1ec0e64e9118">enable_vmware_backdoor</a>)</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;            <span class="keywordflow">goto</span> reinject;</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">         * VMware backdoor emulation on #GP interception only handles</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">         * IN{S}, OUT{S}, and RDPMC.</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646">kvm_emulate_instruction</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>,</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                EMULTYPE_VMWARE_GP | EMULTYPE_NO_DECODE);</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        <span class="comment">/* All SVM instructions expect page aligned RAX */</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rax &amp; ~PAGE_MASK)</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;            <span class="keywordflow">goto</span> reinject;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; </div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4">emulate_svm_instr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, <a class="code" href="structopcode.html">opcode</a>);</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    }</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; </div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;reinject:</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <a class="code" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f">kvm_queue_exception_e</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, GP_VECTOR, error_code);</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;}</div>
<div class="ttc" id="akvm__emulate_8h_html_a76fa88b08b7a85fe5729e86d9b21dfde"><div class="ttname"><a href="kvm__emulate_8h.html#a76fa88b08b7a85fe5729e86d9b21dfde">EMULATION_OK</a></div><div class="ttdeci">#define EMULATION_OK</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00506">kvm_emulate.h:506</a></div></div>
<div class="ttc" id="asvm_8c_html_a0a4c593c8666cfa6b032b7bc7639b81b"><div class="ttname"><a href="svm_8c.html#a0a4c593c8666cfa6b032b7bc7639b81b">svm_instr_opcode</a></div><div class="ttdeci">static int svm_instr_opcode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02312">svm.c:2312</a></div></div>
<div class="ttc" id="asvm_8c_html_a1eacc7b79f62ed332056217c35fe3be4"><div class="ttname"><a href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4">emulate_svm_instr</a></div><div class="ttdeci">static int emulate_svm_instr(struct kvm_vcpu *vcpu, int opcode)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02333">svm.c:2333</a></div></div>
<div class="ttc" id="ax86_8c_html_a1d439c08a5848010284827827cfcbf76"><div class="ttname"><a href="x86_8c.html#a1d439c08a5848010284827827cfcbf76">x86_decode_emulated_instruction</a></div><div class="ttdeci">int x86_decode_emulated_instruction(struct kvm_vcpu *vcpu, int emulation_type, void *insn, int insn_len)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09057">x86.c:9057</a></div></div>
<div class="ttc" id="ax86_8c_html_a2ce1016cd5cbf9583cfe1ec0e64e9118"><div class="ttname"><a href="x86_8c.html#a2ce1016cd5cbf9583cfe1ec0e64e9118">enable_vmware_backdoor</a></div><div class="ttdeci">bool __read_mostly enable_vmware_backdoor</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00176">x86.c:176</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a7c2323b13a5022aa9f6a9ae5ebe4d830_cgraph.png" border="0" usemap="#asvm_8c_a7c2323b13a5022aa9f6a9ae5ebe4d830_cgraph" alt=""/></div>
<map name="asvm_8c_a7c2323b13a5022aa9f6a9ae5ebe4d830_cgraph" id="asvm_8c_a7c2323b13a5022aa9f6a9ae5ebe4d830_cgraph">
<area shape="rect" title=" " alt="" coords="5,1104,128,1131"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="197,245,343,272"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1695,1424,1815,1451"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1663,553,1847,580"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1257,93,1328,120"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="176,1104,364,1131"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="959,1729,1129,1770"/>
<area shape="rect" href="svm_8c.html#a0a4c593c8666cfa6b032b7bc7639b81b" title=" " alt="" coords="200,1779,340,1805"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="412,296,617,323"/>
<area shape="rect" href="svm_8c.html#a21c0c414304458bb0fdecde7cc8eeb2d" title=" " alt="" coords="437,144,593,171"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="698,195,847,221"/>
<area shape="rect" href="svm_8c.html#a81c9359522d571596389c15258054845" title=" " alt="" coords="435,195,594,221"/>
<area shape="rect" href="svm_8h.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="695,347,850,373"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="963,449,1125,490"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="1455,245,1578,272"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="1208,360,1377,387"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1461,296,1572,323"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="987,515,1101,541"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="983,768,1105,795"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1425,360,1608,387"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="1692,389,1819,416"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="1668,441,1843,482"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="1656,272,1855,299"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="1671,323,1840,365"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="1225,1135,1360,1161"/>
<area shape="rect" href="svm_8c.html#a22d5ad8a3cac7e24cb8438a20eb39348" title=" " alt="" coords="665,144,880,171"/>
<area shape="rect" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8" title=" " alt="" coords="928,144,1160,171"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="969,195,1119,221"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="681,1104,864,1131"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="945,1627,1143,1653"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="955,869,1133,896"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="967,921,1121,962"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="983,987,1105,1013"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="950,667,1138,693"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="945,616,1143,643"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="964,1038,1124,1079"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="949,1104,1139,1131"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="953,1155,1135,1181"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="958,1206,1130,1247"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="951,1272,1137,1299"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="1211,1424,1374,1451"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="1452,1576,1581,1603"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="963,1323,1125,1349"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="1249,1475,1336,1501"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="973,1525,1115,1552"/>
<area shape="rect" href="x86_8c.html#a1ea3de1eeac2d51a6580bf4335b544a3" title=" " alt="" coords="1225,1779,1361,1805"/>
<area shape="rect" href="emulate_8c.html#af07231b68f174bcd068413eda29afedd" title=" " alt="" coords="1225,1728,1360,1755"/>
<area shape="rect" href="emulate_8c.html#a98958741961401f4fc2eefc28ba3bdd7" title=" " alt="" coords="1445,1728,1588,1755"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="1461,1779,1573,1805"/>
<area shape="rect" href="x86_8h.html#a134b4e55e4ea92a3519e9538f05d4e6b" title=" " alt="" coords="1465,1829,1568,1856"/>
</map>
</div>

</div>
</div>
<a id="ab386821d47e9af4c7a362e43dca751fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab386821d47e9af4c7a362e43dca751fa">&#9670;&nbsp;</a></span>grow_ple_window()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void grow_ple_window </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01067">1067</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;{</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keyword">struct </span>vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a> = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordtype">int</span> old = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_count;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#ab226ac0135835109146350d5db3d4031">kvm_pause_in_guest</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_count = <a class="code" href="x86_8h.html#a31a89bf42745ce50d984bc0631945622">__grow_ple_window</a>(old,</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                            <a class="code" href="svm_8c.html#a3bc68316af32e407d865d83e00a03316">pause_filter_count</a>,</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                            <a class="code" href="svm_8c.html#a64b792e4e2d6162271f1704fbabc4884">pause_filter_count_grow</a>,</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                            <a class="code" href="svm_8c.html#ac5ab188f15144152c91129b044a371d8">pause_filter_count_max</a>);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_count != old) {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a>);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        trace_kvm_ple_window_update(vcpu-&gt;vcpu_id,</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                        <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_count, old);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a3bc68316af32e407d865d83e00a03316"><div class="ttname"><a href="svm_8c.html#a3bc68316af32e407d865d83e00a03316">pause_filter_count</a></div><div class="ttdeci">static unsigned short pause_filter_count</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00179">svm.c:179</a></div></div>
<div class="ttc" id="asvm_8c_html_a64b792e4e2d6162271f1704fbabc4884"><div class="ttname"><a href="svm_8c.html#a64b792e4e2d6162271f1704fbabc4884">pause_filter_count_grow</a></div><div class="ttdeci">static unsigned short pause_filter_count_grow</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00183">svm.c:183</a></div></div>
<div class="ttc" id="asvm_8c_html_ac5ab188f15144152c91129b044a371d8"><div class="ttname"><a href="svm_8c.html#ac5ab188f15144152c91129b044a371d8">pause_filter_count_max</a></div><div class="ttdeci">static unsigned short pause_filter_count_max</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00191">svm.c:191</a></div></div>
<div class="ttc" id="asvm_8h_html_aaf8fd5f0e57d456151c951e0f3715fc4aa5c3bcc8811c26fdc5e7cda9a9b213e1"><div class="ttname"><a href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a></div><div class="ttdeci">@ VMCB_INTERCEPTS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00049">svm.h:49</a></div></div>
<div class="ttc" id="asvm_8h_html_ab83edec724698a20d66a086a1900aa27"><div class="ttname"><a href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a></div><div class="ttdeci">static void vmcb_mark_dirty(struct vmcb *vmcb, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00354">svm.h:354</a></div></div>
<div class="ttc" id="ax86_8h_html_a31a89bf42745ce50d984bc0631945622"><div class="ttname"><a href="x86_8h.html#a31a89bf42745ce50d984bc0631945622">__grow_ple_window</a></div><div class="ttdeci">static unsigned int __grow_ple_window(unsigned int val, unsigned int base, unsigned int modifier, unsigned int max)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00060">x86.h:60</a></div></div>
<div class="ttc" id="ax86_8h_html_ab226ac0135835109146350d5db3d4031"><div class="ttname"><a href="x86_8h.html#ab226ac0135835109146350d5db3d4031">kvm_pause_in_guest</a></div><div class="ttdeci">static bool kvm_pause_in_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00419">x86.h:419</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab386821d47e9af4c7a362e43dca751fa_cgraph.png" border="0" usemap="#asvm_8c_ab386821d47e9af4c7a362e43dca751fa_cgraph" alt=""/></div>
<map name="asvm_8c_ab386821d47e9af4c7a362e43dca751fa_cgraph" id="asvm_8c_ab386821d47e9af4c7a362e43dca751fa_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,144,108"/>
<area shape="rect" href="x86_8h.html#a31a89bf42745ce50d984bc0631945622" title=" " alt="" coords="195,5,347,32"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="192,56,351,83"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="236,107,307,133"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="203,157,339,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab386821d47e9af4c7a362e43dca751fa_icgraph.png" border="0" usemap="#asvm_8c_ab386821d47e9af4c7a362e43dca751fa_icgraph" alt=""/></div>
<map name="asvm_8c_ab386821d47e9af4c7a362e43dca751fa_icgraph" id="asvm_8c_ab386821d47e9af4c7a362e43dca751fa_icgraph">
<area shape="rect" title=" " alt="" coords="200,5,339,32"/>
<area shape="rect" href="svm_8c.html#ad65ceb76375d4e01d2b1e11a9c227b7c" title=" " alt="" coords="5,5,152,32"/>
</map>
</div>

</div>
</div>
<a id="a0a9af31dcd464498479ea7b57cdc106f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a9af31dcd464498479ea7b57cdc106f">&#9670;&nbsp;</a></span>init_msrpm_offsets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void init_msrpm_offsets </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00966">966</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;{</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    memset(msrpm_offsets, 0xff, <span class="keyword">sizeof</span>(msrpm_offsets));</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">for</span> (i = 0; <a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].<a class="code" href="structsvm__direct__access__msrs.html#a392caedc2f625128ed478904dafbe718">index</a> != <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>; i++) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        u32 offset;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        offset = <a class="code" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f">svm_msrpm_offset</a>(<a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].index);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        BUG_ON(offset == <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <a class="code" href="svm_8c.html#a82b315b23a07eb3743b2458ccefb729d">add_msr_offset</a>(offset);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a35438091c40e77c617ce2ec9d521cc1f"><div class="ttname"><a href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f">svm_msrpm_offset</a></div><div class="ttdeci">u32 svm_msrpm_offset(u32 msr)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00264">svm.c:264</a></div></div>
<div class="ttc" id="asvm_8c_html_a82b315b23a07eb3743b2458ccefb729d"><div class="ttname"><a href="svm_8c.html#a82b315b23a07eb3743b2458ccefb729d">add_msr_offset</a></div><div class="ttdeci">static void add_msr_offset(u32 offset)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00939">svm.c:939</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a0a9af31dcd464498479ea7b57cdc106f_cgraph.png" border="0" usemap="#asvm_8c_a0a9af31dcd464498479ea7b57cdc106f_cgraph" alt=""/></div>
<map name="asvm_8c_a0a9af31dcd464498479ea7b57cdc106f_cgraph" id="asvm_8c_a0a9af31dcd464498479ea7b57cdc106f_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,152,57"/>
<area shape="rect" href="svm_8c.html#a82b315b23a07eb3743b2458ccefb729d" title=" " alt="" coords="212,5,335,32"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="200,56,347,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a0a9af31dcd464498479ea7b57cdc106f_icgraph.png" border="0" usemap="#asvm_8c_a0a9af31dcd464498479ea7b57cdc106f_icgraph" alt=""/></div>
<map name="asvm_8c_a0a9af31dcd464498479ea7b57cdc106f_icgraph" id="asvm_8c_a0a9af31dcd464498479ea7b57cdc106f_icgraph">
<area shape="rect" title=" " alt="" coords="215,5,361,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="a2c67b65be7f511419da6e7d00fa6a544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c67b65be7f511419da6e7d00fa6a544">&#9670;&nbsp;</a></span>init_seg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void init_seg </td>
          <td>(</td>
          <td class="paramtype">struct vmcb_seg *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01123">1123</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;{</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    seg-&gt;selector = 0;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    seg-&gt;attrib = SVM_SELECTOR_P_MASK | SVM_SELECTOR_S_MASK |</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;              SVM_SELECTOR_WRITE_MASK; <span class="comment">/* Read/Write Data Segment */</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    seg-&gt;limit = 0xffff;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    seg-&gt;base = 0;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a2c67b65be7f511419da6e7d00fa6a544_icgraph.png" border="0" usemap="#asvm_8c_a2c67b65be7f511419da6e7d00fa6a544_icgraph" alt=""/></div>
<map name="asvm_8c_a2c67b65be7f511419da6e7d00fa6a544_icgraph" id="asvm_8c_a2c67b65be7f511419da6e7d00fa6a544_icgraph">
<area shape="rect" title=" " alt="" coords="316,5,389,32"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="181,5,268,32"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
</map>
</div>

</div>
</div>
<a id="a449783a93b602b1f32967c74581c38cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a449783a93b602b1f32967c74581c38cf">&#9670;&nbsp;</a></span>init_sys_seg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void init_sys_seg </td>
          <td>(</td>
          <td class="paramtype">struct vmcb_seg *&#160;</td>
          <td class="paramname"><em>seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01132">1132</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;{</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    seg-&gt;selector = 0;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    seg-&gt;attrib = SVM_SELECTOR_P_MASK | type;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    seg-&gt;limit = 0xffff;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    seg-&gt;base = 0;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a449783a93b602b1f32967c74581c38cf_icgraph.png" border="0" usemap="#asvm_8c_a449783a93b602b1f32967c74581c38cf_icgraph" alt=""/></div>
<map name="asvm_8c_a449783a93b602b1f32967c74581c38cf_icgraph" id="asvm_8c_a449783a93b602b1f32967c74581c38cf_icgraph">
<area shape="rect" title=" " alt="" coords="316,5,419,32"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="181,5,268,32"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
</map>
</div>

</div>
</div>
<a id="aa3d3185c3eece1cf1e99fd5da3ca3181"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3d3185c3eece1cf1e99fd5da3ca3181">&#9670;&nbsp;</a></span>init_vmcb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void init_vmcb </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01227">1227</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;{</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keyword">struct </span>vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a> = &amp;vmcb-&gt;control;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keyword">struct </span>vmcb_save_area *save = &amp;vmcb-&gt;save;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR0_READ);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR3_READ);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR4_READ);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR0_WRITE);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR3_WRITE);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR4_WRITE);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(vcpu))</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR8_WRITE);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <a class="code" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf">set_dr_intercepts</a>(svm);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a>(svm, PF_VECTOR);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <a class="code" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a>(svm, UD_VECTOR);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <a class="code" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a>(svm, MC_VECTOR);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <a class="code" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a>(svm, AC_VECTOR);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <a class="code" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a>(svm, DB_VECTOR);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">     * Guest access to VMware backdoor ports could legitimately</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">     * trigger #GP because of TSS I/O permission bitmap.</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">     * We intercept those #GP and allow access to them anyway</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">     * as VMware does.</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8c.html#a2ce1016cd5cbf9583cfe1ec0e64e9118">enable_vmware_backdoor</a>)</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <a class="code" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a>(svm, GP_VECTOR);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_INTR);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_NMI);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#adc8812d5d875ec9a2bf431790db71cfb">intercept_smi</a>)</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_SMI);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_SELECTIVE_CR0);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_RDPMC);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CPUID);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_INVD);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_INVLPG);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_INVLPGA);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_IOIO_PROT);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_MSR_PROT);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_TASK_SWITCH);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_SHUTDOWN);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_VMRUN);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_VMMCALL);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_VMLOAD);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_VMSAVE);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_STGI);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CLGI);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_SKINIT);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_WBINVD);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_XSETBV);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_RDPRU);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_RSM);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#a8a31c0c01a5fe5dc33f7c5675ba4d376">kvm_mwait_in_guest</a>(vcpu-&gt;kvm)) {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_MONITOR);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_MWAIT);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231">kvm_hlt_in_guest</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_HLT);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;iopm_base_pa = __sme_set(<a class="code" href="svm_8c.html#a14f8324fee7e48032e60893cd7590076">iopm_base</a>);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;msrpm_base_pa = __sme_set(__pa(svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>));</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;int_ctl = V_INTR_MASKING_MASK;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <a class="code" href="svm_8c.html#a2c67b65be7f511419da6e7d00fa6a544">init_seg</a>(&amp;save-&gt;es);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <a class="code" href="svm_8c.html#a2c67b65be7f511419da6e7d00fa6a544">init_seg</a>(&amp;save-&gt;ss);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <a class="code" href="svm_8c.html#a2c67b65be7f511419da6e7d00fa6a544">init_seg</a>(&amp;save-&gt;ds);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <a class="code" href="svm_8c.html#a2c67b65be7f511419da6e7d00fa6a544">init_seg</a>(&amp;save-&gt;fs);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <a class="code" href="svm_8c.html#a2c67b65be7f511419da6e7d00fa6a544">init_seg</a>(&amp;save-&gt;gs);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    save-&gt;cs.selector = 0xf000;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    save-&gt;cs.base = 0xffff0000;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">/* Executable/Readable Code Segment */</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    save-&gt;cs.attrib = SVM_SELECTOR_READ_MASK | SVM_SELECTOR_P_MASK |</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        SVM_SELECTOR_S_MASK | SVM_SELECTOR_CODE_MASK;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    save-&gt;cs.limit = 0xffff;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    save-&gt;gdtr.base = 0;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    save-&gt;gdtr.limit = 0xffff;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    save-&gt;idtr.base = 0;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    save-&gt;idtr.limit = 0xffff;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160; </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <a class="code" href="svm_8c.html#a449783a93b602b1f32967c74581c38cf">init_sys_seg</a>(&amp;save-&gt;ldtr, <a class="code" href="svm_8c.html#a1123609025ff8c35fcebbeefc627fe40">SEG_TYPE_LDT</a>);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <a class="code" href="svm_8c.html#a449783a93b602b1f32967c74581c38cf">init_sys_seg</a>(&amp;save-&gt;tr, <a class="code" href="svm_8c.html#aa07431310e9e653530a11e6f39606cc9">SEG_TYPE_BUSY_TSS16</a>);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>) {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="comment">/* Setup VMCB for Nested Paging */</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;nested_ctl |= SVM_NESTED_CTL_NP_ENABLE;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_INVLPG);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <a class="code" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a>(svm, PF_VECTOR);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_CR3_READ);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_CR3_WRITE);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        save-&gt;g_pat = vcpu-&gt;arch.pat;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        save-&gt;cr3 = 0;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a>-&gt;<a class="code" href="structkvm__vmcb__info.html#a48661ae4516f12bd14f4cc4121700a90">asid_generation</a> = 0;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a7c494fa07f9ddd95637bb1061808402e">asid</a> = 0;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a16894147af263784cff5f93602e97a54">vmcb12_gpa</a> = INVALID_GPA;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a469889e41a4042539ad55c80ed27ec48">last_vmcb12_gpa</a> = INVALID_GPA;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#ab226ac0135835109146350d5db3d4031">kvm_pause_in_guest</a>(vcpu-&gt;kvm)) {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_count = <a class="code" href="svm_8c.html#a3bc68316af32e407d865d83e00a03316">pause_filter_count</a>;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a7844865730b4425faa277774dddb41b6">pause_filter_thresh</a>)</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_thresh = <a class="code" href="svm_8c.html#a7844865730b4425faa277774dddb41b6">pause_filter_thresh</a>;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_PAUSE);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_PAUSE);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    }</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <a class="code" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1">svm_recalc_instruction_intercepts</a>(vcpu, svm);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">     * If the host supports V_SPEC_CTRL then disable the interception</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">     * of MSR_IA32_SPEC_CTRL.</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_V_SPEC_CTRL))</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(vcpu, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_SPEC_CTRL, 1, 1);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(vcpu))</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        <a class="code" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12">avic_init_vmcb</a>(svm, vmcb);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160; </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a>)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl |= V_NMI_ENABLE_MASK;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>) {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_STGI);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_CLGI);</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl |= V_GIF_ENABLE_MASK;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <a class="code" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f">sev_init_vmcb</a>(svm);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <a class="code" href="svm__onhyperv_8h.html#a5d03a25e2e39d0a1d3b4420ebdf8bb37">svm_hv_init_vmcb</a>(vmcb);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <a class="code" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139">init_vmcb_after_set_cpuid</a>(vcpu);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <a class="code" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb">vmcb_mark_all_dirty</a>(vmcb);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <a class="code" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64">enable_gif</a>(svm);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a40f16bbe281410ac02865ea25c26bf12"><div class="ttname"><a href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12">avic_init_vmcb</a></div><div class="ttdeci">void avic_init_vmcb(struct vcpu_svm *svm, struct vmcb *vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00244">avic.c:244</a></div></div>
<div class="ttc" id="alapic_8h_html_a3af346d02eebff16886d49d3810b5358"><div class="ttname"><a href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a></div><div class="ttdeci">static bool kvm_vcpu_apicv_active(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00226">lapic.h:226</a></div></div>
<div class="ttc" id="asev_8c_html_abe289006ed99e36825065ad80cf7480f"><div class="ttname"><a href="sev_8c.html#abe289006ed99e36825065ad80cf7480f">sev_init_vmcb</a></div><div class="ttdeci">void sev_init_vmcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03093">sev.c:3093</a></div></div>
<div class="ttc" id="astructkvm__vmcb__info_html_a48661ae4516f12bd14f4cc4121700a90"><div class="ttname"><a href="structkvm__vmcb__info.html#a48661ae4516f12bd14f4cc4121700a90">kvm_vmcb_info::asid_generation</a></div><div class="ttdeci">uint64_t asid_generation</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00113">svm.h:113</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a16894147af263784cff5f93602e97a54"><div class="ttname"><a href="structsvm__nested__state.html#a16894147af263784cff5f93602e97a54">svm_nested_state::vmcb12_gpa</a></div><div class="ttdeci">u64 vmcb12_gpa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00162">svm.h:162</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a469889e41a4042539ad55c80ed27ec48"><div class="ttname"><a href="structsvm__nested__state.html#a469889e41a4042539ad55c80ed27ec48">svm_nested_state::last_vmcb12_gpa</a></div><div class="ttdeci">u64 last_vmcb12_gpa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00163">svm.h:163</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a7c494fa07f9ddd95637bb1061808402e"><div class="ttname"><a href="structvcpu__svm.html#a7c494fa07f9ddd95637bb1061808402e">vcpu_svm::asid</a></div><div class="ttdeci">u32 asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00215">svm.h:215</a></div></div>
<div class="ttc" id="asvm_8c_html_a1123609025ff8c35fcebbeefc627fe40"><div class="ttname"><a href="svm_8c.html#a1123609025ff8c35fcebbeefc627fe40">SEG_TYPE_LDT</a></div><div class="ttdeci">#define SEG_TYPE_LDT</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00066">svm.c:66</a></div></div>
<div class="ttc" id="asvm_8c_html_a12d4d3a3b5ae14af748037ebf85485c1"><div class="ttname"><a href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1">svm_recalc_instruction_intercepts</a></div><div class="ttdeci">static void svm_recalc_instruction_intercepts(struct kvm_vcpu *vcpu, struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01172">svm.c:1172</a></div></div>
<div class="ttc" id="asvm_8c_html_a14f8324fee7e48032e60893cd7590076"><div class="ttname"><a href="svm_8c.html#a14f8324fee7e48032e60893cd7590076">iopm_base</a></div><div class="ttdeci">static unsigned long iopm_base</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00245">svm.c:245</a></div></div>
<div class="ttc" id="asvm_8c_html_a17a219d0651f1db709a3af0fc5527aa0"><div class="ttname"><a href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a></div><div class="ttdeci">bool npt_enabled</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00198">svm.c:198</a></div></div>
<div class="ttc" id="asvm_8c_html_a2704ee64e6fe9975efa29b6759a26139"><div class="ttname"><a href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139">init_vmcb_after_set_cpuid</a></div><div class="ttdeci">static void init_vmcb_after_set_cpuid(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01195">svm.c:1195</a></div></div>
<div class="ttc" id="asvm_8c_html_a2c67b65be7f511419da6e7d00fa6a544"><div class="ttname"><a href="svm_8c.html#a2c67b65be7f511419da6e7d00fa6a544">init_seg</a></div><div class="ttdeci">static void init_seg(struct vmcb_seg *seg)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01123">svm.c:1123</a></div></div>
<div class="ttc" id="asvm_8c_html_a449783a93b602b1f32967c74581c38cf"><div class="ttname"><a href="svm_8c.html#a449783a93b602b1f32967c74581c38cf">init_sys_seg</a></div><div class="ttdeci">static void init_sys_seg(struct vmcb_seg *seg, uint32_t type)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01132">svm.c:1132</a></div></div>
<div class="ttc" id="asvm_8c_html_a7844865730b4425faa277774dddb41b6"><div class="ttname"><a href="svm_8c.html#a7844865730b4425faa277774dddb41b6">pause_filter_thresh</a></div><div class="ttdeci">static unsigned short pause_filter_thresh</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00176">svm.c:176</a></div></div>
<div class="ttc" id="asvm_8c_html_a7f08bf5cf3614629bd95b07ea03b08cf"><div class="ttname"><a href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf">set_dr_intercepts</a></div><div class="ttdeci">static void set_dr_intercepts(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00724">svm.c:724</a></div></div>
<div class="ttc" id="asvm_8c_html_a8d0afd60cabe4ff8b40d7099f49a1bb8"><div class="ttname"><a href="svm_8c.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a></div><div class="ttdeci">bool vnmi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00238">svm.c:238</a></div></div>
<div class="ttc" id="asvm_8c_html_aa07431310e9e653530a11e6f39606cc9"><div class="ttname"><a href="svm_8c.html#aa07431310e9e653530a11e6f39606cc9">SEG_TYPE_BUSY_TSS16</a></div><div class="ttdeci">#define SEG_TYPE_BUSY_TSS16</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00067">svm.c:67</a></div></div>
<div class="ttc" id="asvm_8c_html_ab0a8ab91829811c7705c6455fb294bbc"><div class="ttname"><a href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a></div><div class="ttdeci">int vgif</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00214">svm.c:214</a></div></div>
<div class="ttc" id="asvm_8c_html_adc8812d5d875ec9a2bf431790db71cfb"><div class="ttname"><a href="svm_8c.html#adc8812d5d875ec9a2bf431790db71cfb">intercept_smi</a></div><div class="ttdeci">bool intercept_smi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00235">svm.c:235</a></div></div>
<div class="ttc" id="asvm_8c_html_ae7cebb5bd1d0e7eadb2b7df90cca0c74"><div class="ttname"><a href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a></div><div class="ttdeci">void set_msr_interception(struct kvm_vcpu *vcpu, u32 *msrpm, u32 msr, int read, int write)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00859">svm.c:859</a></div></div>
<div class="ttc" id="asvm_8h_html_a0e9d1e1a7652ad926236f0f44891293c"><div class="ttname"><a href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a></div><div class="ttdeci">static void clr_exception_intercept(struct vcpu_svm *svm, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00413">svm.h:413</a></div></div>
<div class="ttc" id="asvm_8h_html_a371c2a615dd0d893b557b4c0742ab5c6"><div class="ttname"><a href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a></div><div class="ttdeci">static __always_inline bool sev_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00321">svm.h:321</a></div></div>
<div class="ttc" id="asvm_8h_html_a4c285d86fd94954273295b317242c500"><div class="ttname"><a href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a></div><div class="ttdeci">static void svm_clr_intercept(struct vcpu_svm *svm, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00432">svm.h:432</a></div></div>
<div class="ttc" id="asvm_8h_html_a5980ebd310893869bc4c059f110a13cb"><div class="ttname"><a href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb">vmcb_mark_all_dirty</a></div><div class="ttdeci">static void vmcb_mark_all_dirty(struct vmcb *vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00343">svm.h:343</a></div></div>
<div class="ttc" id="asvm_8h_html_ad0ea8a68927599c2120f37f4f48b0a64"><div class="ttname"><a href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64">enable_gif</a></div><div class="ttdeci">static void enable_gif(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00463">svm.h:463</a></div></div>
<div class="ttc" id="asvm_8h_html_af04356b0b53ece1f631f1cfa12521642"><div class="ttname"><a href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a></div><div class="ttdeci">static void set_exception_intercept(struct vcpu_svm *svm, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00403">svm.h:403</a></div></div>
<div class="ttc" id="asvm_8h_html_af6e4bba26808541629dd240a782f1d05"><div class="ttname"><a href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a></div><div class="ttdeci">static void svm_set_intercept(struct vcpu_svm *svm, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00423">svm.h:423</a></div></div>
<div class="ttc" id="asvm__onhyperv_8h_html_a5d03a25e2e39d0a1d3b4420ebdf8bb37"><div class="ttname"><a href="svm__onhyperv_8h.html#a5d03a25e2e39d0a1d3b4420ebdf8bb37">svm_hv_init_vmcb</a></div><div class="ttdeci">static void svm_hv_init_vmcb(struct vmcb *vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm__onhyperv_8h_source.html#l00097">svm_onhyperv.h:97</a></div></div>
<div class="ttc" id="ax86_8h_html_a8a31c0c01a5fe5dc33f7c5675ba4d376"><div class="ttname"><a href="x86_8h.html#a8a31c0c01a5fe5dc33f7c5675ba4d376">kvm_mwait_in_guest</a></div><div class="ttdeci">static bool kvm_mwait_in_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00409">x86.h:409</a></div></div>
<div class="ttc" id="ax86_8h_html_ace4ed625ac4852e54db110fde28d3231"><div class="ttname"><a href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231">kvm_hlt_in_guest</a></div><div class="ttdeci">static bool kvm_hlt_in_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00414">x86.h:414</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aa3d3185c3eece1cf1e99fd5da3ca3181_cgraph.png" border="0" usemap="#asvm_8c_aa3d3185c3eece1cf1e99fd5da3ca3181_cgraph" alt=""/></div>
<map name="asvm_8c_aa3d3185c3eece1cf1e99fd5da3ca3181_cgraph" id="asvm_8c_aa3d3185c3eece1cf1e99fd5da3ca3181_cgraph">
<area shape="rect" title=" " alt="" coords="5,877,92,904"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="169,211,289,237"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="817,261,975,288"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1306,287,1377,313"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="589,565,763,592"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="184,979,275,1005"/>
<area shape="rect" href="svm_8c.html#a2c67b65be7f511419da6e7d00fa6a544" title=" " alt="" coords="193,1029,266,1056"/>
<area shape="rect" href="svm_8c.html#a449783a93b602b1f32967c74581c38cf" title=" " alt="" coords="178,1080,281,1107"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="377,355,528,397"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="607,515,745,541"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="605,717,747,744"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="161,1131,298,1157"/>
<area shape="rect" href="x86_8h.html#a8a31c0c01a5fe5dc33f7c5675ba4d376" title=" " alt="" coords="149,1181,310,1208"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="150,1232,309,1259"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="140,1283,319,1309"/>
<area shape="rect" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf" title=" " alt="" coords="609,819,743,845"/>
<area shape="rect" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642" title=" " alt="" coords="587,869,765,896"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="409,776,497,803"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="171,573,287,600"/>
<area shape="rect" href="svm__onhyperv_8h.html#a5d03a25e2e39d0a1d3b4420ebdf8bb37" title=" " alt="" coords="157,1333,301,1360"/>
<area shape="rect" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1" title=" " alt="" coords="367,929,539,970"/>
<area shape="rect" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb" title=" " alt="" coords="150,1384,309,1411"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="377,156,529,183"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="369,211,537,237"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="372,105,533,132"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="623,768,729,795"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="605,93,747,120"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="597,145,755,186"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="1045,363,1204,405"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="1027,261,1223,288"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="1271,371,1412,397"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1065,719,1185,745"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="597,211,755,237"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="829,565,963,592"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="1051,485,1198,512"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="1033,587,1216,629"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="1034,653,1215,694"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1057,536,1193,563"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="1049,783,1200,809"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="393,1021,512,1048"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="597,1072,755,1099"/>
<area shape="rect" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d" title=" " alt="" coords="599,413,753,440"/>
<area shape="rect" href="kvm__emulate_8h.html#a61f034a07a99eee07bf2588db4d89494" title=" " alt="" coords="814,363,978,389"/>
<area shape="rect" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="813,413,979,440"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="393,1283,512,1309"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="829,616,963,643"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="397,725,508,752"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="383,573,522,600"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="611,971,741,997"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="605,920,747,947"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aa3d3185c3eece1cf1e99fd5da3ca3181_icgraph.png" border="0" usemap="#asvm_8c_aa3d3185c3eece1cf1e99fd5da3ca3181_icgraph" alt=""/></div>
<map name="asvm_8c_aa3d3185c3eece1cf1e99fd5da3ca3181_icgraph" id="asvm_8c_aa3d3185c3eece1cf1e99fd5da3ca3181_icgraph">
<area shape="rect" title=" " alt="" coords="181,5,268,32"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
</map>
</div>

</div>
</div>
<a id="a2704ee64e6fe9975efa29b6759a26139"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2704ee64e6fe9975efa29b6759a26139">&#9670;&nbsp;</a></span>init_vmcb_after_set_cpuid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void init_vmcb_after_set_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01195">1195</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;{</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d">guest_cpuid_is_intel</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>)) {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">         * We must intercept SYSENTER_EIP and SYSENTER_ESP</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">         * accesses because the processor only stores 32 bits.</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">         * For the same reason we cannot use virtual VMLOAD/VMSAVE.</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_VMLOAD);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_VMSAVE);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.virt_ext &amp;= ~VIRTUAL_VMLOAD_VMSAVE_ENABLE_MASK;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_SYSENTER_EIP, 0, 0);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_SYSENTER_ESP, 0, 0);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">         * If hardware supports Virtual VMLOAD VMSAVE then enable it</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">         * in VMCB and clear intercepts to avoid #VMEXIT.</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a3ad937a1fd2ef8fcdd87953c6a5db405">vls</a>) {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_VMLOAD);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_VMSAVE);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.virt_ext |= VIRTUAL_VMLOAD_VMSAVE_ENABLE_MASK;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="comment">/* No need to intercept these MSRs */</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_SYSENTER_EIP, 1, 1);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_SYSENTER_ESP, 1, 1);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;}</div>
<div class="ttc" id="acpuid_8h_html_aa35dee13971a1366be933e974552a02d"><div class="ttname"><a href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d">guest_cpuid_is_intel</a></div><div class="ttdeci">static bool guest_cpuid_is_intel(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00115">cpuid.h:115</a></div></div>
<div class="ttc" id="asvm_8c_html_a3ad937a1fd2ef8fcdd87953c6a5db405"><div class="ttname"><a href="svm_8c.html#a3ad937a1fd2ef8fcdd87953c6a5db405">vls</a></div><div class="ttdeci">static int vls</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00210">svm.c:210</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a2704ee64e6fe9975efa29b6759a26139_cgraph.png" border="0" usemap="#asvm_8c_a2704ee64e6fe9975efa29b6759a26139_cgraph" alt=""/></div>
<map name="asvm_8c_a2704ee64e6fe9975efa29b6759a26139_cgraph" id="asvm_8c_a2704ee64e6fe9975efa29b6759a26139_cgraph">
<area shape="rect" title=" " alt="" coords="5,318,156,359"/>
<area shape="rect" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d" title=" " alt="" coords="206,69,361,96"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="204,275,363,301"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="721,275,792,301"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="214,376,353,403"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="212,493,355,520"/>
<area shape="rect" href="kvm__emulate_8h.html#a61f034a07a99eee07bf2588db4d89494" title=" " alt="" coords="427,19,591,45"/>
<area shape="rect" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="426,69,591,96"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="688,5,825,32"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="429,183,588,225"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="411,275,607,301"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="686,107,827,133"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="655,158,859,199"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="683,224,830,251"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="681,56,832,83"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="907,191,1080,217"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="442,493,575,520"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="683,376,830,403"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="697,544,817,571"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="665,595,848,637"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="666,427,847,469"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="689,493,825,520"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="681,661,832,688"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="934,460,1053,487"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="917,409,1070,436"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1367,453,1540,494"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1128,485,1319,512"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a2704ee64e6fe9975efa29b6759a26139_icgraph.png" border="0" usemap="#asvm_8c_a2704ee64e6fe9975efa29b6759a26139_icgraph" alt=""/></div>
<map name="asvm_8c_a2704ee64e6fe9975efa29b6759a26139_icgraph" id="asvm_8c_a2704ee64e6fe9975efa29b6759a26139_icgraph">
<area shape="rect" title=" " alt="" coords="381,27,532,69"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="214,5,301,32"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="181,57,333,98"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
</map>
</div>

</div>
</div>
<a id="ab07aabd2b78a54e2f9a6bd72ffbfa404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab07aabd2b78a54e2f9a6bd72ffbfa404">&#9670;&nbsp;</a></span>interrupt_window_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int interrupt_window_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03177">3177</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;{</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    kvm_make_request(KVM_REQ_EVENT, vcpu);</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    <a class="code" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403">svm_clear_vintr</a>(<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu));</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160; </div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="comment">     * If not running nested, for AVIC, the only reason to end up here is ExtINTs.</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;<span class="comment">     * In this case AVIC was temporarily disabled for</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="comment">     * requesting the IRQ window and we have to re-enable it.</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;<span class="comment">     * If running nested, still remove the VM wide AVIC inhibit to</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;<span class="comment">     * support case in which the interrupt window was requested when the</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="comment">     * vCPU was not running nested.</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="comment">     * All vCPUs which run still run nested, will remain to have their</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment">     * AVIC still inhibited due to per-cpu AVIC inhibition.</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    kvm_clear_apicv_inhibit(vcpu-&gt;kvm, APICV_INHIBIT_REASON_IRQWIN);</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160; </div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    ++vcpu-&gt;stat.irq_window_exits;</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_aea540cc79e685f3a2eebfa4226b63403"><div class="ttname"><a href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403">svm_clear_vintr</a></div><div class="ttdeci">static void svm_clear_vintr(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01663">svm.c:1663</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab07aabd2b78a54e2f9a6bd72ffbfa404_cgraph.png" border="0" usemap="#asvm_8c_ab07aabd2b78a54e2f9a6bd72ffbfa404_cgraph" alt=""/></div>
<map name="asvm_8c_ab07aabd2b78a54e2f9a6bd72ffbfa404_cgraph" id="asvm_8c_ab07aabd2b78a54e2f9a6bd72ffbfa404_cgraph">
<area shape="rect" title=" " alt="" coords="5,227,225,253"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="273,201,400,228"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="301,252,372,279"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="847,5,967,32"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="448,201,587,228"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="839,289,975,316"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="635,188,768,215"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="834,239,981,265"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="816,57,999,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="817,122,998,163"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="832,188,983,215"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1064,104,1183,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1047,155,1200,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1487,97,1660,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1248,129,1439,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab07aabd2b78a54e2f9a6bd72ffbfa404_icgraph.png" border="0" usemap="#asvm_8c_ab07aabd2b78a54e2f9a6bd72ffbfa404_icgraph" alt=""/></div>
<map name="asvm_8c_ab07aabd2b78a54e2f9a6bd72ffbfa404_icgraph" id="asvm_8c_ab07aabd2b78a54e2f9a6bd72ffbfa404_icgraph">
<area shape="rect" title=" " alt="" coords="652,35,872,61"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="416,35,604,61"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="5,5,163,32"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="211,27,368,69"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="223,93,356,120"/>
</map>
</div>

</div>
</div>
<a id="a21af2401d39dc5c49a388960ce1196ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21af2401d39dc5c49a388960ce1196ad">&#9670;&nbsp;</a></span>intr_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int intr_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02246">2246</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;{</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    ++vcpu-&gt;stat.irq_exits;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a21af2401d39dc5c49a388960ce1196ad_icgraph.png" border="0" usemap="#asvm_8c_a21af2401d39dc5c49a388960ce1196ad_icgraph" alt=""/></div>
<map name="asvm_8c_a21af2401d39dc5c49a388960ce1196ad_icgraph" id="asvm_8c_a21af2401d39dc5c49a388960ce1196ad_icgraph">
<area shape="rect" title=" " alt="" coords="652,35,781,61"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="416,35,604,61"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="5,5,163,32"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="211,27,368,69"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="223,93,356,120"/>
</map>
</div>

</div>
</div>
<a id="ad9d8323f0ea03667c1a23178340f6fe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d8323f0ea03667c1a23178340f6fe9">&#9670;&nbsp;</a></span>invlpg_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int invlpg_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02582">2582</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;{</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="keywordflow">if</span> (!static_cpu_has(X86_FEATURE_DECODEASSISTS))</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646">kvm_emulate_instruction</a>(vcpu, 0);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160; </div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <a class="code" href="mmu_8c.html#a3d158ec2a822d6af200cd30ed59b4ef6">kvm_mmu_invlpg</a>(vcpu, <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;vmcb-&gt;control.exit_info_1);</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a>(vcpu);</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;}</div>
<div class="ttc" id="ammu_8c_html_a3d158ec2a822d6af200cd30ed59b4ef6"><div class="ttname"><a href="mmu_8c.html#a3d158ec2a822d6af200cd30ed59b4ef6">kvm_mmu_invlpg</a></div><div class="ttdeci">void kvm_mmu_invlpg(struct kvm_vcpu *vcpu, gva_t gva)</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8c_source.html#l05968">mmu.c:5968</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad9d8323f0ea03667c1a23178340f6fe9_cgraph.png" border="0" usemap="#asvm_8c_ad9d8323f0ea03667c1a23178340f6fe9_cgraph" alt=""/></div>
<map name="asvm_8c_ad9d8323f0ea03667c1a23178340f6fe9_cgraph" id="asvm_8c_ad9d8323f0ea03667c1a23178340f6fe9_cgraph">
<area shape="rect" title=" " alt="" coords="5,1111,152,1137"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="200,1085,388,1112"/>
<area shape="rect" href="mmu_8c.html#a3d158ec2a822d6af200cd30ed59b4ef6" title=" " alt="" coords="482,1425,621,1452"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="436,165,667,192"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="259,1187,329,1213"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="460,760,643,787"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="986,348,1121,375"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="715,1273,913,1300"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="725,1324,903,1351"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="737,217,891,258"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="753,283,875,309"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="720,836,908,863"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="969,887,1138,913"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1457,787,1641,813"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="715,937,913,964"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="734,334,894,375"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="719,400,909,427"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="733,603,895,645"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="723,115,905,141"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="757,552,871,579"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="753,501,875,528"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="728,669,900,710"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="721,165,907,192"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="733,996,895,1023"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="749,1055,879,1081"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="733,735,895,761"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="1010,1324,1097,1351"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="729,1157,899,1198"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="743,1105,885,1132"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1225,348,1362,375"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1475,348,1622,375"/>
<area shape="rect" href="x86_8c.html#a2a7f61481aae2e0bfe4baaba68d6d650" title=" " alt="" coords="968,1375,1139,1401"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="978,275,1129,301"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1489,988,1609,1015"/>
<area shape="rect" href="x86_8c.html#aea69aad92f3a36aaebec0c2a9e853b61" title=" " alt="" coords="965,770,1142,811"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1202,787,1385,813"/>
<area shape="rect" href="x86_8c.html#a8bbfd08c002f2e09b42bb56cd8f52653" title=" " alt="" coords="972,1039,1135,1081"/>
<area shape="rect" href="mmu_8c.html#a728d88795e69d91605885d769ebc7959" title=" " alt="" coords="1193,1375,1393,1401"/>
<area shape="rect" href="mmu_8c.html#a182d50b0d6d7be3301d249ba97a8152f" title=" " alt="" coords="1441,1349,1656,1376"/>
<area shape="rect" href="x86_8h.html#af9a5d53e18d888ed043578916e51cc55" title=" " alt="" coords="1457,1400,1641,1427"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="992,56,1115,83"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="974,107,1133,149"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="966,173,1141,200"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="968,5,1139,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="964,399,1143,425"/>
<area shape="rect" href="x86_8c.html#a0a47622bf3c21272e9e0357e1f90540a" title=" " alt="" coords="961,551,1145,593"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="961,500,1145,527"/>
<area shape="rect" href="x86_8c.html#a2857d8949e4bb5216636d3f7b03edc88" title=" " alt="" coords="962,617,1145,644"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="1008,1105,1099,1132"/>
<area shape="rect" href="x86_8c.html#a52a62306898287a4475c0b6e78b30bf8" title=" " alt="" coords="966,1157,1141,1198"/>
</map>
</div>

</div>
</div>
<a id="a23b9203e454b799b6abf131912cf296c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23b9203e454b799b6abf131912cf296c">&#9670;&nbsp;</a></span>invlpga_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int invlpga_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02463">2463</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;{</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    gva_t gva = kvm_rax_read(vcpu);</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    u32 asid = kvm_rcx_read(vcpu);</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160; </div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="comment">/* FIXME: Handle an address size prefix. */</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d">is_long_mode</a>(vcpu))</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        gva = (u32)gva;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160; </div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    trace_kvm_invlpga(<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;vmcb-&gt;save.rip, asid, gva);</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">/* Let&#39;s treat INVLPGA the same as INVLPG (can be optimized!) */</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <a class="code" href="mmu_8c.html#a3d158ec2a822d6af200cd30ed59b4ef6">kvm_mmu_invlpg</a>(vcpu, gva);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a>(vcpu);</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;}</div>
<div class="ttc" id="ax86_8h_html_aad3ee550e50892e0e340061479bb284d"><div class="ttname"><a href="x86_8h.html#aad3ee550e50892e0e340061479bb284d">is_long_mode</a></div><div class="ttdeci">static bool is_long_mode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00143">x86.h:143</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a23b9203e454b799b6abf131912cf296c_cgraph.png" border="0" usemap="#asvm_8c_a23b9203e454b799b6abf131912cf296c_cgraph" alt=""/></div>
<map name="asvm_8c_a23b9203e454b799b6abf131912cf296c_cgraph" id="asvm_8c_a23b9203e454b799b6abf131912cf296c_cgraph">
<area shape="rect" title=" " alt="" coords="5,292,160,319"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="1301,17,1413,44"/>
<area shape="rect" href="mmu_8c.html#a3d158ec2a822d6af200cd30ed59b4ef6" title=" " alt="" coords="254,317,393,344"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="208,267,439,293"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="288,368,359,395"/>
<area shape="rect" href="mmu_8c.html#a728d88795e69d91605885d769ebc7959" title=" " alt="" coords="487,828,687,855"/>
<area shape="rect" href="mmu_8c.html#a182d50b0d6d7be3301d249ba97a8152f" title=" " alt="" coords="735,828,949,855"/>
<area shape="rect" href="x86_8h.html#af9a5d53e18d888ed043578916e51cc55" title=" " alt="" coords="750,929,934,956"/>
<area shape="rect" href="mmu_8c.html#a67c0ad9273ae2d50d1dde3ace9bbd647" title=" " alt="" coords="1009,593,1184,634"/>
<area shape="rect" href="spte_8h.html#a501c74fbb95a5dd015922c57a163ca13" title=" " alt="" coords="1307,651,1407,677"/>
<area shape="rect" href="mmu_8c.html#af5a315f8e6c3430789204ab72fdfac5d" title=" " alt="" coords="1035,879,1158,905"/>
<area shape="rect" href="mmu_8c.html#a5d549ae5b6c13e9b87ccc13127ddf86a" title=" " alt="" coords="1020,828,1173,855"/>
<area shape="rect" href="x86_8h.html#a0647452067d01e527a8cd1da2fb6b897" title=" " alt="" coords="1012,929,1181,956"/>
<area shape="rect" href="mmu__internal_8h.html#ae152dfa402f5fe629bd4b1f4f931de1e" title=" " alt="" coords="1255,499,1458,525"/>
<area shape="rect" href="mmu_8c.html#a69a9545d1380d3c51ec6fa0f9ff36555" title=" " alt="" coords="1263,549,1450,576"/>
<area shape="rect" href="spte_8h.html#afa67b29261e5d58fdf1f7f694e99a053" title=" " alt="" coords="1310,600,1403,627"/>
<area shape="rect" href="spte_8h.html#a6e93c3ba68ed8b0ab050918d92cf4c6b" title=" " alt="" coords="1549,676,1679,703"/>
<area shape="rect" href="mmu_8c.html#afa9309dada333ba442f20329ecd94033" title=" " alt="" coords="1293,803,1421,829"/>
<area shape="rect" href="mmu_8c.html#a85a8d231f0b692ff61afb66570575734" title=" " alt="" coords="1517,791,1711,817"/>
<area shape="rect" href="mmu_8c.html#a3ee167c290bf125621f455ec5af142a2" title=" " alt="" coords="1313,904,1400,931"/>
<area shape="rect" href="spte_8h.html#a7d73c1cb0114320b9dab8ba78033c686" title=" " alt="" coords="1527,867,1701,893"/>
<area shape="rect" href="spte_8h.html#a785ce7507ac8cabfb2a667ed0c57b1f5" title=" " alt="" coords="1307,955,1406,981"/>
<area shape="rect" href="spte_8h.html#a2927d719923cb2ed2b5b83d739a275f7" title=" " alt="" coords="1300,1005,1413,1032"/>
<area shape="rect" href="mmu_8c.html#aa915f695d4c341eca7d1f5b5a0a26a03" title=" " alt="" coords="1247,1056,1466,1083"/>
<area shape="rect" href="spte_8h.html#af8791b1ec453ef3bce3c87ea28744692" title=" " alt="" coords="1291,701,1422,728"/>
<area shape="rect" href="x86_8h.html#af360aa7bd1f33ab25089b12431f11773" title=" " alt="" coords="1022,1056,1171,1083"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="1283,1107,1430,1133"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="496,317,677,344"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="493,195,680,221"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="781,245,903,272"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="763,369,921,410"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="755,445,929,472"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="757,317,927,344"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="1311,245,1402,272"/>
<area shape="rect" href="pmu_8h.html#abbf4b99efff2cdd22398e2992085c36f" title=" " alt="" coords="997,449,1196,490"/>
<area shape="rect" href="pmu_8c.html#af08b63fb7910be3ee65e8036b4e48aad" title=" " alt="" coords="1008,296,1185,323"/>
<area shape="rect" href="pmu_8h.html#a156ede05e2f3b40ccf7a68f471f574b2" title=" " alt="" coords="1003,347,1190,373"/>
<area shape="rect" href="pmu_8h.html#a276700643eefb3c6911a7ae0dc0e3809" title=" " alt="" coords="1006,397,1187,424"/>
<area shape="rect" href="pmu_8c.html#aa6928ea92eba53de872c3bd3e966c3c6" title=" " alt="" coords="1270,296,1443,323"/>
<area shape="rect" href="pmu_8c.html#a6407f24f826977c89137761aae28662a" title=" " alt="" coords="1277,347,1436,373"/>
<area shape="rect" href="pmu_8h.html#ad8246d56b5d561e26e120ebcc9f2c2e7" title=" " alt="" coords="1244,397,1469,424"/>
<area shape="rect" href="pmu_8h.html#a121f90ace23861db2f644f0b36a08be6" title=" " alt="" coords="1303,448,1410,475"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="769,119,915,145"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="750,195,934,221"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="1024,93,1169,120"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1035,43,1159,69"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1041,144,1152,171"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1269,144,1444,171"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1005,195,1188,221"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="1293,195,1420,221"/>
</map>
</div>

</div>
</div>
<a id="a6875c998376697a8776271bc88521721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6875c998376697a8776271bc88521721">&#9670;&nbsp;</a></span>invpcid_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int invpcid_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03216">3216</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;{</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> type;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    gva_t gva;</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160; </div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_INVPCID)) {</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;        <a class="code" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, UD_VECTOR);</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    }</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160; </div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="comment">     * For an INVPCID intercept:</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="comment">     * EXITINFO1 provides the linear address of the memory operand.</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;<span class="comment">     * EXITINFO2 provides the contents of the register operand.</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;    type = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2;</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;    gva = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160; </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a97b209e5c87a4c7b5850646ab9a1919c">kvm_handle_invpcid</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, type, gva);</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;}</div>
<div class="ttc" id="acpuid_8h_html_ad8c2a90f2f099af1d7ca23750d9d2eb9"><div class="ttname"><a href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a></div><div class="ttdeci">static __always_inline bool guest_cpuid_has(struct kvm_vcpu *vcpu, unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00083">cpuid.h:83</a></div></div>
<div class="ttc" id="ax86_8c_html_a97b209e5c87a4c7b5850646ab9a1919c"><div class="ttname"><a href="x86_8c.html#a97b209e5c87a4c7b5850646ab9a1919c">kvm_handle_invpcid</a></div><div class="ttdeci">int kvm_handle_invpcid(struct kvm_vcpu *vcpu, unsigned long type, gva_t gva)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13612">x86.c:13612</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a6875c998376697a8776271bc88521721_cgraph.png" border="0" usemap="#asvm_8c_a6875c998376697a8776271bc88521721_cgraph" alt=""/></div>
<map name="asvm_8c_a6875c998376697a8776271bc88521721_cgraph" id="asvm_8c_a6875c998376697a8776271bc88521721_cgraph">
<area shape="rect" title=" " alt="" coords="5,641,160,668"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="227,107,358,133"/>
<area shape="rect" href="x86_8c.html#a97b209e5c87a4c7b5850646ab9a1919c" title=" " alt="" coords="215,616,371,643"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="208,667,377,693"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="257,717,328,744"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="750,5,857,32"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="448,107,633,133"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1241,7,1389,33"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="975,56,1133,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="719,56,887,83"/>
<area shape="rect" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="721,158,886,199"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="732,107,875,133"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="985,163,1123,189"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="997,107,1111,133"/>
<area shape="rect" href="x86_8h.html#af9a5d53e18d888ed043578916e51cc55" title=" " alt="" coords="1223,556,1407,583"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="1696,467,1843,493"/>
<area shape="rect" href="x86_8c.html#a918fccc2a3b0a8c2fe80ed713b144e36" title=" " alt="" coords="434,532,647,559"/>
<area shape="rect" href="x86_8c.html#aa792359250f034a2a29b0c809df64ff3" title=" " alt="" coords="725,357,882,384"/>
<area shape="rect" href="mmu_8c.html#a3b8a9cd97346da0584f14387a0f7828e" title=" " alt="" coords="715,408,892,435"/>
<area shape="rect" href="x86_8c.html#a7064cd8944dd550352cef83c72612045" title=" " alt="" coords="461,797,620,824"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="425,616,656,643"/>
<area shape="rect" href="x86_8h.html#af360aa7bd1f33ab25089b12431f11773" title=" " alt="" coords="1472,531,1621,557"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="1917,453,2063,480"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="2111,428,2304,455"/>
<area shape="rect" href="x86_8c.html#a8bbfd08c002f2e09b42bb56cd8f52653" title=" " alt="" coords="722,459,885,501"/>
<area shape="rect" href="x86_8c.html#ac70e801650bf3c39ffc10685dda54648" title=" " alt="" coords="713,525,894,566"/>
<area shape="rect" href="mmu_8c.html#a728d88795e69d91605885d769ebc7959" title=" " alt="" coords="954,517,1154,544"/>
<area shape="rect" href="mmu_8c.html#a182d50b0d6d7be3301d249ba97a8152f" title=" " alt="" coords="1207,505,1422,532"/>
<area shape="rect" href="x86_8c.html#aabe915a653339fece966fc3ab721a6e1" title=" " alt="" coords="957,569,1151,610"/>
<area shape="rect" href="mmu_8h.html#ad1aee9e6e5e9d85568a734930c8a084a" title=" " alt="" coords="974,365,1134,392"/>
<area shape="rect" href="mmu_8h.html#a573994365668ea7cc32c0858f96d8e64" title=" " alt="" coords="1258,441,1371,468"/>
<area shape="rect" href="mmu_8c.html#ab7d4e418cb85a72507e384df5027293e" title=" " alt="" coords="971,213,1137,240"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="1933,377,2047,404"/>
<area shape="rect" href="mmu_8c.html#ab8e14476297a48107341bc44a29b6af9" title=" " alt="" coords="1205,264,1424,291"/>
<area shape="rect" href="mmu__internal_8h.html#a6491934fd3538f608b4b91245943b6fc" title=" " alt="" coords="1669,137,1869,164"/>
<area shape="rect" href="kvm__main_8c.html#aa8688eb80c9acaf8b0aa783b6ac68c16" title=" " alt="" coords="1268,213,1361,240"/>
<area shape="rect" href="mmu_8c.html#a5b648a843c7267d204fe81facbc9f84f" title=" " alt="" coords="1234,112,1395,139"/>
<area shape="rect" href="spte_8h.html#ab169c1872e98b9731a05121e0439f244" title=" " alt="" coords="1501,112,1592,139"/>
<area shape="rect" href="x86_8c.html#ab9c276fafa298a76b0f6a9f001db989b" title=" " alt="" coords="724,794,883,835"/>
<area shape="rect" href="kvm__main_8c.html#adfef9b2c2d6359fd443d98f51be19605" title=" " alt="" coords="951,801,1157,828"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="713,641,894,668"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="710,591,897,617"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="993,641,1115,668"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="449,940,632,967"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="740,1028,867,1055"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="743,1079,863,1105"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="716,1130,891,1171"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="704,860,903,887"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="711,911,895,937"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="719,962,888,1003"/>
</map>
</div>

</div>
</div>
<a id="a73e8f5db4571aa9511e75f30e939fe89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73e8f5db4571aa9511e75f30e939fe89">&#9670;&nbsp;</a></span>io_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int io_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02211">2211</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;{</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    u32 io_info = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1; <span class="comment">/* address size bug? */</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="keywordtype">int</span> size, in, string;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="keywordtype">unsigned</span> port;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    ++<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;stat.io_exits;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="keywordtype">string</span> = (io_info &amp; SVM_IOIO_STR_MASK) != 0;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    in = (io_info &amp; SVM_IOIO_TYPE_MASK) != 0;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    port = io_info &gt;&gt; 16;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    size = (io_info &amp; SVM_IOIO_SIZE_MASK) &gt;&gt; SVM_IOIO_SIZE_SHIFT;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">string</span>) {</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="sev_8c.html#a8381dc2e2d38fd331490bbb2fd097d0a">sev_es_string_io</a>(svm, size, port, in);</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646">kvm_emulate_instruction</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, 0);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    }</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160; </div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af9472805586ac10a411dde4a890047ac">next_rip</a> = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a111cda267d4f974b03b6bb159c136c80">kvm_fast_pio</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, size, port, in);</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a8381dc2e2d38fd331490bbb2fd097d0a"><div class="ttname"><a href="sev_8c.html#a8381dc2e2d38fd331490bbb2fd097d0a">sev_es_string_io</a></div><div class="ttdeci">int sev_es_string_io(struct vcpu_svm *svm, int size, unsigned int port, int in)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02963">sev.c:2963</a></div></div>
<div class="ttc" id="ax86_8c_html_a111cda267d4f974b03b6bb159c136c80"><div class="ttname"><a href="x86_8c.html#a111cda267d4f974b03b6bb159c136c80">kvm_fast_pio</a></div><div class="ttdeci">int kvm_fast_pio(struct kvm_vcpu *vcpu, int size, unsigned short port, int in)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09358">x86.c:9358</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a73e8f5db4571aa9511e75f30e939fe89_cgraph.png" border="0" usemap="#asvm_8c_a73e8f5db4571aa9511e75f30e939fe89_cgraph" alt=""/></div>
<map name="asvm_8c_a73e8f5db4571aa9511e75f30e939fe89_cgraph" id="asvm_8c_a73e8f5db4571aa9511e75f30e939fe89_cgraph">
<area shape="rect" title=" " alt="" coords="5,1237,124,1264"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="172,1237,360,1264"/>
<area shape="rect" href="x86_8c.html#a111cda267d4f974b03b6bb159c136c80" title=" " alt="" coords="211,553,321,580"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="211,1288,321,1315"/>
<area shape="rect" href="sev_8c.html#a8381dc2e2d38fd331490bbb2fd097d0a" title=" " alt="" coords="201,107,331,133"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="231,1339,301,1365"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="408,1237,591,1264"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="933,680,1068,707"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="639,1741,837,1768"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="649,1691,827,1717"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="661,1843,815,1885"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="677,1792,799,1819"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="644,1136,832,1163"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="916,1136,1085,1163"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="909,1187,1093,1213"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="639,1187,837,1213"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="658,1339,818,1381"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="643,1405,833,1432"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="657,1457,819,1498"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="1167,731,1348,757"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="681,1523,795,1549"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="677,731,799,757"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="1171,1082,1343,1123"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="1164,579,1351,605"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="657,883,819,909"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="673,933,803,960"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="657,1573,819,1600"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="957,1023,1044,1049"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="653,1625,823,1666"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="667,984,809,1011"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1189,528,1326,555"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1399,528,1545,555"/>
<area shape="rect" href="x86_8c.html#a2a7f61481aae2e0bfe4baaba68d6d650" title=" " alt="" coords="915,1741,1086,1768"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="925,1851,1076,1877"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="941,947,1061,973"/>
<area shape="rect" href="x86_8c.html#a2f1d4ffd4a4c779d93b2d1bdd9a2f668" title=" " alt="" coords="435,259,564,285"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="885,579,1116,605"/>
<area shape="rect" href="x86_8c.html#a3d88acf42615b7782dd74f3ff02a5bc9" title=" " alt="" coords="430,477,569,504"/>
<area shape="rect" href="x86_8c.html#a7e11770f4eea66deb409c13eb5599564" title=" " alt="" coords="657,309,819,336"/>
<area shape="rect" href="x86_8c.html#a43503f268738cc53b4acd43b0f5ea8cb" title=" " alt="" coords="937,81,1064,108"/>
<area shape="rect" href="x86_8c.html#a1207a262cb906fee1003ce8f1bb2ac15" title=" " alt="" coords="653,528,823,555"/>
<area shape="rect" href="x86_8c.html#a6d396caa1ec360d33e7d3999a71a1951" title=" " alt="" coords="653,361,823,402"/>
<area shape="rect" href="x86_8c.html#a0d15cd39b8133363394c2b55a06d52b8" title=" " alt="" coords="933,411,1069,437"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="655,477,821,504"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="446,1960,553,1987"/>
<area shape="rect" href="x86_8c.html#ac4b95013b15c215fb1fcfd251d2e006d" title=" " alt="" coords="416,56,583,83"/>
<area shape="rect" href="sev_8c.html#a0ed13e39856158b838d1f124dc65ad42" title=" " alt="" coords="413,107,586,133"/>
<area shape="rect" href="x86_8c.html#a4bb05cc4f2b01054d01e1947197a74c9" title=" " alt="" coords="673,5,803,32"/>
<area shape="rect" href="x86_8c.html#a3e2127cd416ed691ddc9be7200f8e3e3" title=" " alt="" coords="669,56,807,83"/>
<area shape="rect" href="kvm__main_8c.html#a3cc887a9ecfdd6e9f5ab90dc2ce8de4a" title=" " alt="" coords="673,107,803,133"/>
</map>
</div>

</div>
</div>
<a id="aaa5bf4dc91985f4c533268b7e4ca811d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa5bf4dc91985f4c533268b7e4ca811d">&#9670;&nbsp;</a></span>iret_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int iret_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02566">2566</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;{</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160; </div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    WARN_ON_ONCE(<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm));</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160; </div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    ++<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;stat.nmi_window_exits;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#ae94a883f2e559703aaa7b93d14a3810a">awaiting_iret_completion</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160; </div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    <a class="code" href="svm_8c.html#aff900c45df2faa151d783155ec034f86">svm_clr_iret_intercept</a>(svm);</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a6fafc7c88cd9fcf600c03b6a74e9124a">nmi_iret_rip</a> = <a class="code" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446">kvm_rip_read</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160; </div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    kvm_make_request(KVM_REQ_EVENT, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;}</div>
<div class="ttc" id="akvm__cache__regs_8h_html_ad97ff6b975b461b815e6749d29c65446"><div class="ttname"><a href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446">kvm_rip_read</a></div><div class="ttdeci">static unsigned long kvm_rip_read(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00116">kvm_cache_regs.h:116</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a6fafc7c88cd9fcf600c03b6a74e9124a"><div class="ttname"><a href="structvcpu__svm.html#a6fafc7c88cd9fcf600c03b6a74e9124a">vcpu_svm::nmi_iret_rip</a></div><div class="ttdeci">ulong nmi_iret_rip</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00236">svm.h:236</a></div></div>
<div class="ttc" id="asvm_8c_html_aff900c45df2faa151d783155ec034f86"><div class="ttname"><a href="svm_8c.html#aff900c45df2faa151d783155ec034f86">svm_clr_iret_intercept</a></div><div class="ttdeci">static void svm_clr_iret_intercept(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02554">svm.c:2554</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aaa5bf4dc91985f4c533268b7e4ca811d_cgraph.png" border="0" usemap="#asvm_8c_aaa5bf4dc91985f4c533268b7e4ca811d_cgraph" alt=""/></div>
<map name="asvm_8c_aaa5bf4dc91985f4c533268b7e4ca811d_cgraph" id="asvm_8c_aaa5bf4dc91985f4c533268b7e4ca811d_cgraph">
<area shape="rect" title=" " alt="" coords="5,163,135,189"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="211,87,321,113"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="429,137,540,164"/>
<area shape="rect" href="svm_8c.html#aff900c45df2faa151d783155ec034f86" title=" " alt="" coords="183,188,349,215"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="231,239,301,265"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="397,87,572,113"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="620,87,813,113"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="663,137,770,164"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="415,188,554,215"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="650,188,783,215"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="879,289,1026,316"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="893,5,1013,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="861,57,1044,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="862,122,1043,163"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="885,188,1021,215"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="877,239,1028,265"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1109,104,1228,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1092,155,1245,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1532,97,1705,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1293,129,1484,156"/>
</map>
</div>

</div>
</div>
<a id="ac7c5304a8c015386109035f7ab577919"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7c5304a8c015386109035f7ab577919">&#9670;&nbsp;</a></span>is_erratum_383()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool is_erratum_383 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02120">2120</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;{</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="keywordtype">int</span> err, i;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    u64 value;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160; </div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="keywordflow">if</span> (!erratum_383_found)</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    value = native_read_msr_safe(MSR_IA32_MC0_STATUS, &amp;err);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keywordflow">if</span> (err)</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160; </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="comment">/* Bit 62 may or may not be set for this mce */</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    value &amp;= ~(1ULL &lt;&lt; 62);</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160; </div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="keywordflow">if</span> (value != 0xb600000000010015ULL)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="comment">/* Clear MCi_STATUS registers */</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; 6; ++i)</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        native_write_msr_safe(MSR_IA32_MCx_STATUS(i), 0, 0);</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160; </div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    value = native_read_msr_safe(MSR_IA32_MCG_STATUS, &amp;err);</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;        u32 low, high;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        value &amp;= ~(1ULL &lt;&lt; 2);</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        low    = lower_32_bits(value);</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        high   = upper_32_bits(value);</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160; </div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        native_write_msr_safe(MSR_IA32_MCG_STATUS, low, high);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    }</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160; </div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="comment">/* Flush tlb to evict multi-match entries */</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    __flush_tlb_all();</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160; </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ac7c5304a8c015386109035f7ab577919_icgraph.png" border="0" usemap="#asvm_8c_ac7c5304a8c015386109035f7ab577919_icgraph" alt=""/></div>
<map name="asvm_8c_ac7c5304a8c015386109035f7ab577919_icgraph" id="asvm_8c_ac7c5304a8c015386109035f7ab577919_icgraph">
<area shape="rect" title=" " alt="" coords="353,5,476,32"/>
<area shape="rect" href="svm_8c.html#af1c9d228af74c8b5f794a4babc5d465b" title=" " alt="" coords="169,5,305,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="a53176c61179bfcec5f1c122b110cc8c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53176c61179bfcec5f1c122b110cc8c3">&#9670;&nbsp;</a></span>kvm_cpu_svm_disable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_cpu_svm_disable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00572">572</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;{</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    uint64_t efer;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    wrmsrl(MSR_VM_HSAVE_PA, 0);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    rdmsrl(MSR_EFER, efer);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span> (efer &amp; EFER_SVME) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">         * Force GIF=1 prior to disabling SVM, e.g. to ensure INIT and</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">         * NMI aren&#39;t blocked.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="svm__ops_8h.html#a97407302752e909143951887456521ef">stgi</a>();</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        wrmsrl(MSR_EFER, efer &amp; ~EFER_SVME);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;}</div>
<div class="ttc" id="asvm__ops_8h_html_a97407302752e909143951887456521ef"><div class="ttname"><a href="svm__ops_8h.html#a97407302752e909143951887456521ef">stgi</a></div><div class="ttdeci">static void stgi(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm__ops_8h_source.html#l00044">svm_ops.h:44</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a53176c61179bfcec5f1c122b110cc8c3_cgraph.png" border="0" usemap="#asvm_8c_a53176c61179bfcec5f1c122b110cc8c3_cgraph" alt=""/></div>
<map name="asvm_8c_a53176c61179bfcec5f1c122b110cc8c3_cgraph" id="asvm_8c_a53176c61179bfcec5f1c122b110cc8c3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,176,32"/>
<area shape="rect" href="svm__ops_8h.html#a97407302752e909143951887456521ef" title=" " alt="" coords="224,5,271,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a53176c61179bfcec5f1c122b110cc8c3_icgraph.png" border="0" usemap="#asvm_8c_a53176c61179bfcec5f1c122b110cc8c3_icgraph" alt=""/></div>
<map name="asvm_8c_a53176c61179bfcec5f1c122b110cc8c3_icgraph" id="asvm_8c_a53176c61179bfcec5f1c122b110cc8c3_icgraph">
<area shape="rect" title=" " alt="" coords="512,56,683,83"/>
<area shape="rect" href="svm_8c.html#ab4fa734cd92223a6150551cd5243b4aa" title=" " alt="" coords="280,31,464,57"/>
<area shape="rect" href="svm_8c.html#accd19fd9a37bd9d9ed52a1f26a86e7b5" title=" " alt="" coords="286,81,458,108"/>
<area shape="rect" href="svm_8c.html#a5b14d1e0632116bdfd341cd3c892a5eb" title=" " alt="" coords="136,5,232,32"/>
<area shape="rect" href="svm_8c.html#aa667b0a0f202f83aa1533825aeecb402" title=" " alt="" coords="7,56,86,83"/>
<area shape="rect" href="svm_8c.html#ae292292ef2cf8cb0d48cfa27ce94ef88" title=" " alt="" coords="5,5,88,32"/>
</map>
</div>

</div>
</div>
<a id="ad1ba53021522940c5c8b84e82d574243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1ba53021522940c5c8b84e82d574243">&#9670;&nbsp;</a></span>kvm_is_svm_supported()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool kvm_is_svm_supported </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00544">544</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordtype">bool</span> supported;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    migrate_disable();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    supported = <a class="code" href="svm_8c.html#a0c5962ecf16b873fd88c7d6664ea7f0c">__kvm_is_svm_supported</a>();</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    migrate_enable();</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">return</span> supported;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a0c5962ecf16b873fd88c7d6664ea7f0c"><div class="ttname"><a href="svm_8c.html#a0c5962ecf16b873fd88c7d6664ea7f0c">__kvm_is_svm_supported</a></div><div class="ttdeci">static bool __kvm_is_svm_supported(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00520">svm.c:520</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad1ba53021522940c5c8b84e82d574243_cgraph.png" border="0" usemap="#asvm_8c_ad1ba53021522940c5c8b84e82d574243_cgraph" alt=""/></div>
<map name="asvm_8c_ad1ba53021522940c5c8b84e82d574243_cgraph" id="asvm_8c_ad1ba53021522940c5c8b84e82d574243_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,181,32"/>
<area shape="rect" href="svm_8c.html#a0c5962ecf16b873fd88c7d6664ea7f0c" title=" " alt="" coords="229,5,420,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad1ba53021522940c5c8b84e82d574243_icgraph.png" border="0" usemap="#asvm_8c_ad1ba53021522940c5c8b84e82d574243_icgraph" alt=""/></div>
<map name="asvm_8c_ad1ba53021522940c5c8b84e82d574243_icgraph" id="asvm_8c_ad1ba53021522940c5c8b84e82d574243_icgraph">
<area shape="rect" title=" " alt="" coords="132,5,308,32"/>
<area shape="rect" href="svm_8c.html#aa667b0a0f202f83aa1533825aeecb402" title=" " alt="" coords="5,5,84,32"/>
</map>
</div>

</div>
</div>
<a id="a97325a065bd633887526f445883ad1df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97325a065bd633887526f445883ad1df">&#9670;&nbsp;</a></span>mc_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int mc_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02180">2180</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;{</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c1fae58a67d6d9280e1d59713163f30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c1fae58a67d6d9280e1d59713163f30">&#9670;&nbsp;</a></span>MODULE_AUTHOR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MODULE_AUTHOR </td>
          <td>(</td>
          <td class="paramtype">&quot;Qumranet&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad94b36675e7eb067ea3ce6ff9e244a44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad94b36675e7eb067ea3ce6ff9e244a44">&#9670;&nbsp;</a></span>MODULE_LICENSE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MODULE_LICENSE </td>
          <td>(</td>
          <td class="paramtype">&quot;GPL&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af5398bb236e9d6dd335ac102f0d8d370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5398bb236e9d6dd335ac102f0d8d370">&#9670;&nbsp;</a></span>module_param() <span class="overload">[1/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8c.html#a8c4ea69d2d0310307567f305689357f8">avic</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aea4847c29cd5b5de66a626968b098c43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea4847c29cd5b5de66a626968b098c43">&#9670;&nbsp;</a></span>module_param() <span class="overload">[2/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8h.html#a8be79ef0522e29a602517b51ff51f509">dump_invalid_vmcb</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0644&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0f3202c47c01c553241cf53f0b7f28a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f3202c47c01c553241cf53f0b7f28a5">&#9670;&nbsp;</a></span>module_param() <span class="overload">[3/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8h.html#adc8812d5d875ec9a2bf431790db71cfb">intercept_smi</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a46be789610abc54d1f25bc1fe575f998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46be789610abc54d1f25bc1fe575f998">&#9670;&nbsp;</a></span>module_param() <span class="overload">[4/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8c.html#ac6093899c4533e4c669b24862528077d">lbrv</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad9dcfa60f776c7f9b913e6179a0a24f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9dcfa60f776c7f9b913e6179a0a24f2">&#9670;&nbsp;</a></span>module_param() <span class="overload">[5/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vmx_8c.html#a97d7564e1b5ae8c0173e53f859ac17e1">nested</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a67ebd318a096c0732cd95462f45be95a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67ebd318a096c0732cd95462f45be95a">&#9670;&nbsp;</a></span>module_param() <span class="overload">[6/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8h.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa8efb7aa314a00c488ab8e71be224aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8efb7aa314a00c488ab8e71be224aff">&#9670;&nbsp;</a></span>module_param() <span class="overload">[7/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8c.html#a3bc68316af32e407d865d83e00a03316">pause_filter_count</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ushort&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac17375e97535e7313d6d256b6b2b79dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac17375e97535e7313d6d256b6b2b79dc">&#9670;&nbsp;</a></span>module_param() <span class="overload">[8/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8c.html#a64b792e4e2d6162271f1704fbabc4884">pause_filter_count_grow</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ushort&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a43cd839e587ee3d59145ddb298d940f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43cd839e587ee3d59145ddb298d940f3">&#9670;&nbsp;</a></span>module_param() <span class="overload">[9/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8c.html#ac5ab188f15144152c91129b044a371d8">pause_filter_count_max</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ushort&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a85c0b2cd46b026b991bea29d642adf5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85c0b2cd46b026b991bea29d642adf5d">&#9670;&nbsp;</a></span>module_param() <span class="overload">[10/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8c.html#ad71d914e223758efb4dcac69978f4083">pause_filter_count_shrink</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ushort&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a928bd7f75de78fe4d01adb8afa79d18e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a928bd7f75de78fe4d01adb8afa79d18e">&#9670;&nbsp;</a></span>module_param() <span class="overload">[11/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8c.html#a7844865730b4425faa277774dddb41b6">pause_filter_thresh</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ushort&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a80f38cba78c484e6f5cbdb0938510234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80f38cba78c484e6f5cbdb0938510234">&#9670;&nbsp;</a></span>module_param() <span class="overload">[12/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8c.html#adacf7fe5bb2bb2fdef07153a859b75ba">tsc_scaling</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac2b1b0852b08378092aff59f695a75ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2b1b0852b08378092aff59f695a75ae">&#9670;&nbsp;</a></span>module_param() <span class="overload">[13/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8h.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae0cae8f94f2805c88ee94cf3e6e6c9fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0cae8f94f2805c88ee94cf3e6e6c9fb">&#9670;&nbsp;</a></span>module_param() <span class="overload">[14/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8c.html#a3ad937a1fd2ef8fcdd87953c6a5db405">vls</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9f63600a5680b997a6fe7b8bb0113da9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f63600a5680b997a6fe7b8bb0113da9">&#9670;&nbsp;</a></span>module_param() <span class="overload">[15/15]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="svm_8h.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1343c12c0281ab5065e8f8ea8583c1fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1343c12c0281ab5065e8f8ea8583c1fb">&#9670;&nbsp;</a></span>module_param_named()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_param_named </td>
          <td>(</td>
          <td class="paramtype">npt&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="svm_8h.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0444&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a173c3f7c02a4287d140cc0f34564a7bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a173c3f7c02a4287d140cc0f34564a7bd">&#9670;&nbsp;</a></span>msr_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int msr_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03169">3169</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;{</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;vmcb-&gt;control.exit_info_1)</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a1550ae1115ac5be61ab770f6f3c5f513">kvm_emulate_wrmsr</a>(vcpu);</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a955a40f66041d085593b16a75075a1ae">kvm_emulate_rdmsr</a>(vcpu);</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;}</div>
<div class="ttc" id="ax86_8c_html_a1550ae1115ac5be61ab770f6f3c5f513"><div class="ttname"><a href="x86_8c.html#a1550ae1115ac5be61ab770f6f3c5f513">kvm_emulate_wrmsr</a></div><div class="ttdeci">int kvm_emulate_wrmsr(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l02082">x86.c:2082</a></div></div>
<div class="ttc" id="ax86_8c_html_a955a40f66041d085593b16a75075a1ae"><div class="ttname"><a href="x86_8c.html#a955a40f66041d085593b16a75075a1ae">kvm_emulate_rdmsr</a></div><div class="ttdeci">int kvm_emulate_rdmsr(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l02057">x86.c:2057</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a173c3f7c02a4287d140cc0f34564a7bd_cgraph.png" border="0" usemap="#asvm_8c_a173c3f7c02a4287d140cc0f34564a7bd_cgraph" alt=""/></div>
<map name="asvm_8c_a173c3f7c02a4287d140cc0f34564a7bd_cgraph" id="asvm_8c_a173c3f7c02a4287d140cc0f34564a7bd_cgraph">
<area shape="rect" title=" " alt="" coords="5,189,137,215"/>
<area shape="rect" href="x86_8c.html#a955a40f66041d085593b16a75075a1ae" title=" " alt="" coords="187,138,344,165"/>
<area shape="rect" href="x86_8c.html#a1550ae1115ac5be61ab770f6f3c5f513" title=" " alt="" coords="185,189,345,215"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="230,239,301,266"/>
<area shape="rect" href="x86_8c.html#aeeb1ecca8bf1a2b4cda190c5426b80c9" title=" " alt="" coords="405,37,565,63"/>
<area shape="rect" href="x86_8c.html#a3eb5a7800dd3bcd13dbc74632fbf22a1" title=" " alt="" coords="393,138,576,165"/>
<area shape="rect" href="x86_8c.html#accdc879b22f280aa9ba41e58a6c1658e" title=" " alt="" coords="403,189,566,215"/>
<area shape="rect" href="x86_8c.html#a0f0d8061749acba7b8f4d1b9b0884079" title=" " alt="" coords="624,71,823,98"/>
<area shape="rect" href="x86_8c.html#a5492b645ed1b58ebf45bd68cad0b5092" title=" " alt="" coords="645,5,801,47"/>
<area shape="rect" href="x86_8c.html#a6b64ebea5fdc7d1f0434fb509942a56f" title=" " alt="" coords="640,123,807,164"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="653,239,794,266"/>
<area shape="rect" href="x86_8c.html#a69cd7a555054c4e390c588fb9da44dc9" title=" " alt="" coords="900,131,1025,158"/>
<area shape="rect" href="x86_8c.html#a856d7cf0513728bd9603c044d5644230" title=" " alt="" coords="871,199,1055,226"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="1129,134,1260,161"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1599,35,1705,62"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="1335,135,1520,162"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="2013,86,2161,113"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1784,86,1943,113"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1568,86,1736,113"/>
<area shape="rect" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="1569,188,1735,229"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1581,137,1723,163"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1795,225,1932,251"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1806,137,1921,163"/>
<area shape="rect" href="x86_8c.html#a493307a40b51eeb761e91a1910876721" title=" " alt="" coords="656,189,791,215"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a7284219cd6cc4787f8e1eba2d4cf2c19" title=" " alt="" coords="410,290,559,317"/>
<area shape="rect" href="x86_8c.html#a99cf4c7be0b4cac0886649c7da9daa66" title=" " alt="" coords="393,239,576,266"/>
<area shape="rect" href="x86_8c.html#a4a7acb17f522083e1a9edc95e3788295" title=" " alt="" coords="640,291,807,332"/>
<area shape="rect" href="x86_8c.html#ad0df6b04ae08eb6eec89da2d81e465cd" title=" " alt="" coords="901,273,1025,299"/>
<area shape="rect" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d" title=" " alt="" coords="1117,222,1272,249"/>
<area shape="rect" href="x86_8h.html#af9a5d53e18d888ed043578916e51cc55" title=" " alt="" coords="1103,323,1287,350"/>
<area shape="rect" href="x86_8h.html#af360aa7bd1f33ab25089b12431f11773" title=" " alt="" coords="1353,311,1502,338"/>
<area shape="rect" href="kvm__emulate_8h.html#a61f034a07a99eee07bf2588db4d89494" title=" " alt="" coords="1345,203,1509,230"/>
<area shape="rect" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="1345,254,1510,281"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="1579,311,1725,338"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="1791,311,1936,338"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1991,311,2184,338"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a173c3f7c02a4287d140cc0f34564a7bd_icgraph.png" border="0" usemap="#asvm_8c_a173c3f7c02a4287d140cc0f34564a7bd_icgraph" alt=""/></div>
<map name="asvm_8c_a173c3f7c02a4287d140cc0f34564a7bd_icgraph" id="asvm_8c_a173c3f7c02a4287d140cc0f34564a7bd_icgraph">
<area shape="rect" title=" " alt="" coords="652,35,784,61"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="416,35,604,61"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="5,5,163,32"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="211,27,368,69"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="223,93,356,120"/>
</map>
</div>

</div>
</div>
<a id="a9dbf1138872247b45ebbc4880523c0dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dbf1138872247b45ebbc4880523c0dd">&#9670;&nbsp;</a></span>msr_write_intercepted()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool msr_write_intercepted </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>msr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00794">794</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;{</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    u8 bit_write;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> tmp;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    u32 offset;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    u32 *msrpm;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">     * For non-nested case:</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">     * If the L01 MSR bitmap does not intercept the MSR, then we need to</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">     * save it.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">     * For nested case:</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">     * If the L02 MSR bitmap does not intercept the MSR, then we need to</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">     * save it.</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    msrpm = <a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(vcpu) ? <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">msrpm</a>:</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                      <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    offset    = <a class="code" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f">svm_msrpm_offset</a>(msr);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    bit_write = 2 * (msr &amp; 0x0f) + 1;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    tmp       = msrpm[offset];</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    BUG_ON(offset == <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">return</span> test_bit(bit_write, &amp;tmp);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;}</div>
<div class="ttc" id="astructsvm__nested__state_html_ac977ad2b258ba3df647e360fa11c7198"><div class="ttname"><a href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">svm_nested_state::msrpm</a></div><div class="ttdeci">u32 * msrpm</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00166">svm.h:166</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a9dbf1138872247b45ebbc4880523c0dd_cgraph.png" border="0" usemap="#asvm_8c_a9dbf1138872247b45ebbc4880523c0dd_cgraph" alt=""/></div>
<map name="asvm_8c_a9dbf1138872247b45ebbc4880523c0dd_cgraph" id="asvm_8c_a9dbf1138872247b45ebbc4880523c0dd_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,173,83"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="235,5,355,32"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="221,56,368,83"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="259,107,330,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a9dbf1138872247b45ebbc4880523c0dd_icgraph.png" border="0" usemap="#asvm_8c_a9dbf1138872247b45ebbc4880523c0dd_icgraph" alt=""/></div>
<map name="asvm_8c_a9dbf1138872247b45ebbc4880523c0dd_icgraph" id="asvm_8c_a9dbf1138872247b45ebbc4880523c0dd_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,337,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="a1ec4f210ddd96122d1d787a383483514"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ec4f210ddd96122d1d787a383483514">&#9670;&nbsp;</a></span>new_asid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void new_asid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsvm__cpu__data.html">svm_cpu_data</a> *&#160;</td>
          <td class="paramname"><em>sd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01980">1980</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;{</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="structsvm__cpu__data.html#a8dec08f7e08061480ab12f9b5426991d">next_asid</a> &gt; sd-&gt;<a class="code" href="structsvm__cpu__data.html#a2e5110b54e6436c6a017892e0b4a37db">max_asid</a>) {</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        ++sd-&gt;<a class="code" href="structsvm__cpu__data.html#ab20eb4010776c6fe52661fcf95cdc017">asid_generation</a>;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        sd-&gt;<a class="code" href="structsvm__cpu__data.html#a8dec08f7e08061480ab12f9b5426991d">next_asid</a> = sd-&gt;<a class="code" href="structsvm__cpu__data.html#a86b414e2f46215b5b4d4e0d7e207dd7a">min_asid</a>;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.tlb_ctl = TLB_CONTROL_FLUSH_ALL_ASID;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4ace538c75028034c3e121fd96a0bdaf64">VMCB_ASID</a>);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a>-&gt;<a class="code" href="structkvm__vmcb__info.html#a48661ae4516f12bd14f4cc4121700a90">asid_generation</a> = sd-&gt;<a class="code" href="structsvm__cpu__data.html#ab20eb4010776c6fe52661fcf95cdc017">asid_generation</a>;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a7c494fa07f9ddd95637bb1061808402e">asid</a> = sd-&gt;<a class="code" href="structsvm__cpu__data.html#a8dec08f7e08061480ab12f9b5426991d">next_asid</a>++;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;}</div>
<div class="ttc" id="astructsvm__cpu__data_html_a2e5110b54e6436c6a017892e0b4a37db"><div class="ttname"><a href="structsvm__cpu__data.html#a2e5110b54e6436c6a017892e0b4a37db">svm_cpu_data::max_asid</a></div><div class="ttdeci">u32 max_asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00299">svm.h:299</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_a86b414e2f46215b5b4d4e0d7e207dd7a"><div class="ttname"><a href="structsvm__cpu__data.html#a86b414e2f46215b5b4d4e0d7e207dd7a">svm_cpu_data::min_asid</a></div><div class="ttdeci">u32 min_asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00301">svm.h:301</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_a8dec08f7e08061480ab12f9b5426991d"><div class="ttname"><a href="structsvm__cpu__data.html#a8dec08f7e08061480ab12f9b5426991d">svm_cpu_data::next_asid</a></div><div class="ttdeci">u32 next_asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00300">svm.h:300</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_ab20eb4010776c6fe52661fcf95cdc017"><div class="ttname"><a href="structsvm__cpu__data.html#ab20eb4010776c6fe52661fcf95cdc017">svm_cpu_data::asid_generation</a></div><div class="ttdeci">u64 asid_generation</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00298">svm.h:298</a></div></div>
<div class="ttc" id="asvm_8h_html_aaf8fd5f0e57d456151c951e0f3715fc4ace538c75028034c3e121fd96a0bdaf64"><div class="ttname"><a href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4ace538c75028034c3e121fd96a0bdaf64">VMCB_ASID</a></div><div class="ttdeci">@ VMCB_ASID</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00052">svm.h:52</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1ec4f210ddd96122d1d787a383483514_cgraph.png" border="0" usemap="#asvm_8c_a1ec4f210ddd96122d1d787a383483514_cgraph" alt=""/></div>
<map name="asvm_8c_a1ec4f210ddd96122d1d787a383483514_cgraph" id="asvm_8c_a1ec4f210ddd96122d1d787a383483514_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,88,32"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="136,5,272,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1ec4f210ddd96122d1d787a383483514_icgraph.png" border="0" usemap="#asvm_8c_a1ec4f210ddd96122d1d787a383483514_icgraph" alt=""/></div>
<map name="asvm_8c_a1ec4f210ddd96122d1d787a383483514_icgraph" id="asvm_8c_a1ec4f210ddd96122d1d787a383483514_icgraph">
<area shape="rect" title=" " alt="" coords="324,5,407,32"/>
<area shape="rect" href="svm_8c.html#a1337a20b038f182d9e04102e22c45f79" title=" " alt="" coords="169,5,276,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="a53732c8ad918b98c56008b492578c462"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53732c8ad918b98c56008b492578c462">&#9670;&nbsp;</a></span>nmi_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int nmi_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02236">2236</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;{</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a723646ac5d3234ba8e1845249e6a0935"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a723646ac5d3234ba8e1845249e6a0935">&#9670;&nbsp;</a></span>npf_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int npf_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02051">2051</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;{</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    u64 fault_address = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    u64 error_code = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    trace_kvm_page_fault(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, fault_address, error_code);</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mmu_8c.html#a3d0bd209d792a4316f3b40681fdc10f9">kvm_mmu_page_fault</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, fault_address, error_code,</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;            static_cpu_has(X86_FEATURE_DECODEASSISTS) ?</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.insn_bytes : NULL,</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.insn_len);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;}</div>
<div class="ttc" id="ammu_8c_html_a3d0bd209d792a4316f3b40681fdc10f9"><div class="ttname"><a href="mmu_8c.html#a3d0bd209d792a4316f3b40681fdc10f9">kvm_mmu_page_fault</a></div><div class="ttdeci">int noinline kvm_mmu_page_fault(struct kvm_vcpu *vcpu, gpa_t cr2_or_gpa, u64 error_code, void *insn, int insn_len)</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8c_source.html#l05830">mmu.c:5830</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a723646ac5d3234ba8e1845249e6a0935_cgraph.png" border="0" usemap="#asvm_8c_a723646ac5d3234ba8e1845249e6a0935_cgraph" alt=""/></div>
<map name="asvm_8c_a723646ac5d3234ba8e1845249e6a0935_cgraph" id="asvm_8c_a723646ac5d3234ba8e1845249e6a0935_cgraph">
<area shape="rect" title=" " alt="" coords="5,769,133,796"/>
<area shape="rect" href="mmu_8c.html#a3d0bd209d792a4316f3b40681fdc10f9" title=" " alt="" coords="181,744,349,771"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="230,795,301,821"/>
<area shape="rect" href="mmu_8c.html#a899cf46c0ee6df6305c7fe167421e2b7" title=" " alt="" coords="399,183,586,209"/>
<area shape="rect" href="mmu_8c.html#abaee26e516b75f579b063a76c376b045" title=" " alt="" coords="659,309,815,336"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="927,1295,1047,1321"/>
<area shape="rect" href="mmu__internal_8h.html#ae3c71be306692107b4d90bfb8d24d7f5" title=" " alt="" coords="397,436,588,463"/>
<area shape="rect" href="mmu_8c.html#a45417375d740e0905773ac641827e0a0" title=" " alt="" coords="887,1396,1087,1423"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="401,1076,584,1103"/>
<area shape="rect" href="mmu_8c.html#aa6dadc0bd20da0d41281abe089941491" title=" " alt="" coords="667,107,807,133"/>
<area shape="rect" href="mmu_8c.html#a24c91b8ae0a349c76c95f6266f62d6e1" title=" " alt="" coords="676,157,799,184"/>
<area shape="rect" href="mmu_8c.html#a82303f01ba06fead33e8a67eac44807e" title=" " alt="" coords="650,259,825,285"/>
<area shape="rect" href="mmu_8c.html#a1217d6225ddd3e8a27699bb59fc91211" title=" " alt="" coords="662,5,813,32"/>
<area shape="rect" href="spte_8h.html#a2927d719923cb2ed2b5b83d739a275f7" title=" " alt="" coords="681,56,794,83"/>
<area shape="rect" href="x86_8h.html#ab77d498df3e80dc4bdbbd7ef398f9f4e" title=" " alt="" coords="650,208,825,235"/>
<area shape="rect" href="spte_8h.html#a1afff676d846020d0ea1a0ae8f1ae26a" title=" " alt="" coords="887,107,1087,133"/>
<area shape="rect" href="spte_8h.html#aca7067bb9ce45d32003771bcdb7f902b" title=" " alt="" coords="932,208,1041,235"/>
<area shape="rect" href="mmu_8c.html#a4ec630b17cee965d4cbcec0f78d298f7" title=" " alt="" coords="946,157,1027,184"/>
<area shape="rect" href="x86_8h.html#a661bc84e256a87cbd929ffb7c1f61b2f" title=" " alt="" coords="924,259,1049,285"/>
<area shape="rect" href="x86_8h.html#adec8392408e5b0e363872e91e83a90af" title=" " alt="" coords="898,309,1075,336"/>
<area shape="rect" href="x86_8h.html#a2cc991ad82a0546dd38fabaf3c096037" title=" " alt="" coords="898,360,1075,387"/>
<area shape="rect" href="mmu__internal_8h.html#a8a367cbfff40c5c72d6f19049da9fc51" title=" " alt="" coords="641,360,834,387"/>
<area shape="rect" href="mmu__internal_8h.html#a4bd7a8fd81e65c4e06e025d92c5787d9" title=" " alt="" coords="660,411,815,437"/>
<area shape="rect" href="kvm__main_8c.html#ac4b56de4919be80c9cd4289f20437c64" title=" " alt="" coords="636,461,839,488"/>
<area shape="rect" href="mmu_8c.html#ab8e14476297a48107341bc44a29b6af9" title=" " alt="" coords="1135,1345,1353,1372"/>
<area shape="rect" href="mmu_8c.html#aa915f695d4c341eca7d1f5b5a0a26a03" title=" " alt="" coords="1135,1396,1353,1423"/>
<area shape="rect" href="kvm__main_8c.html#aa8688eb80c9acaf8b0aa783b6ac68c16" title=" " alt="" coords="1197,1447,1291,1473"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="919,537,1054,564"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="639,1421,836,1448"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="648,1472,827,1499"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="661,1523,814,1565"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="676,1589,799,1616"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="643,1152,831,1179"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="902,1000,1071,1027"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="895,1101,1079,1128"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="638,1000,837,1027"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="657,1691,817,1733"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="642,664,833,691"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="657,715,818,757"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="647,781,828,808"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="680,832,795,859"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="677,563,798,589"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="651,883,823,925"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="644,949,831,976"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="656,1320,819,1347"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="673,1371,802,1397"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="656,1051,819,1077"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="943,1345,1030,1372"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="653,1254,822,1295"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="667,1203,808,1229"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a723646ac5d3234ba8e1845249e6a0935_icgraph.png" border="0" usemap="#asvm_8c_a723646ac5d3234ba8e1845249e6a0935_icgraph" alt=""/></div>
<map name="asvm_8c_a723646ac5d3234ba8e1845249e6a0935_icgraph" id="asvm_8c_a723646ac5d3234ba8e1845249e6a0935_icgraph">
<area shape="rect" title=" " alt="" coords="652,35,780,61"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="416,35,604,61"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="5,5,163,32"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="211,27,368,69"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="223,93,356,120"/>
</map>
</div>

</div>
</div>
<a id="ad65ceb76375d4e01d2b1e11a9c227b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad65ceb76375d4e01d2b1e11a9c227b7c">&#9670;&nbsp;</a></span>pause_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int pause_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03200">3200</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;{</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="keywordtype">bool</span> in_kernel;</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;<span class="comment">     * CPL is not made available for an SEV-ES guest, therefore</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;<span class="comment">     * vcpu-&gt;arch.preempted_in_kernel can never be true.  Just</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;<span class="comment">     * set in_kernel to false as well.</span></div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    in_kernel = !<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(vcpu-&gt;kvm) &amp;&amp; <a class="code" href="svm_8c.html#aec9fa4b1df8f24cd52b41eb10cfc0b4d">svm_get_cpl</a>(vcpu) == 0;</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160; </div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    <a class="code" href="svm_8c.html#ab386821d47e9af4c7a362e43dca751fa">grow_ple_window</a>(vcpu);</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160; </div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    <a class="code" href="kvm__main_8c.html#a7373edb7b1c787b14e657cd691e64d20">kvm_vcpu_on_spin</a>(vcpu, in_kernel);</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a>(vcpu);</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;}</div>
<div class="ttc" id="akvm__main_8c_html_a7373edb7b1c787b14e657cd691e64d20"><div class="ttname"><a href="kvm__main_8c.html#a7373edb7b1c787b14e657cd691e64d20">kvm_vcpu_on_spin</a></div><div class="ttdeci">void kvm_vcpu_on_spin(struct kvm_vcpu *me, bool yield_to_kernel_mode)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l04056">kvm_main.c:4056</a></div></div>
<div class="ttc" id="asvm_8c_html_ab386821d47e9af4c7a362e43dca751fa"><div class="ttname"><a href="svm_8c.html#ab386821d47e9af4c7a362e43dca751fa">grow_ple_window</a></div><div class="ttdeci">static void grow_ple_window(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01067">svm.c:1067</a></div></div>
<div class="ttc" id="asvm_8c_html_aec9fa4b1df8f24cd52b41eb10cfc0b4d"><div class="ttname"><a href="svm_8c.html#aec9fa4b1df8f24cd52b41eb10cfc0b4d">svm_get_cpl</a></div><div class="ttdeci">static int svm_get_cpl(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01779">svm.c:1779</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad65ceb76375d4e01d2b1e11a9c227b7c_cgraph.png" border="0" usemap="#asvm_8c_ad65ceb76375d4e01d2b1e11a9c227b7c_cgraph" alt=""/></div>
<map name="asvm_8c_ad65ceb76375d4e01d2b1e11a9c227b7c_cgraph" id="asvm_8c_ad65ceb76375d4e01d2b1e11a9c227b7c_cgraph">
<area shape="rect" title=" " alt="" coords="5,405,152,431"/>
<area shape="rect" href="svm_8c.html#ab386821d47e9af4c7a362e43dca751fa" title=" " alt="" coords="204,303,343,330"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="395,405,625,431"/>
<area shape="rect" href="kvm__main_8c.html#a7373edb7b1c787b14e657cd691e64d20" title=" " alt="" coords="200,547,347,574"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="218,682,329,709"/>
<area shape="rect" href="svm_8c.html#aec9fa4b1df8f24cd52b41eb10cfc0b4d" title=" " alt="" coords="221,354,325,381"/>
<area shape="rect" href="x86_8h.html#a31a89bf42745ce50d984bc0631945622" title=" " alt="" coords="434,253,586,279"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="431,303,589,330"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="475,354,545,381"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="442,202,578,229"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="676,122,857,149"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="673,405,860,431"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="941,173,1063,199"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="923,5,1081,47"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="915,71,1089,98"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="917,122,1087,149"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="1458,173,1549,199"/>
<area shape="rect" href="pmu_8h.html#abbf4b99efff2cdd22398e2992085c36f" title=" " alt="" coords="1144,5,1343,47"/>
<area shape="rect" href="pmu_8c.html#af08b63fb7910be3ee65e8036b4e48aad" title=" " alt="" coords="1155,223,1332,250"/>
<area shape="rect" href="pmu_8h.html#a156ede05e2f3b40ccf7a68f471f574b2" title=" " alt="" coords="1150,71,1337,98"/>
<area shape="rect" href="pmu_8h.html#a276700643eefb3c6911a7ae0dc0e3809" title=" " alt="" coords="1153,122,1334,149"/>
<area shape="rect" href="pmu_8c.html#aa6928ea92eba53de872c3bd3e966c3c6" title=" " alt="" coords="1417,274,1590,301"/>
<area shape="rect" href="pmu_8c.html#a6407f24f826977c89137761aae28662a" title=" " alt="" coords="1424,223,1583,250"/>
<area shape="rect" href="pmu_8h.html#ad8246d56b5d561e26e120ebcc9f2c2e7" title=" " alt="" coords="1391,71,1616,98"/>
<area shape="rect" href="pmu_8h.html#a121f90ace23861db2f644f0b36a08be6" title=" " alt="" coords="1450,122,1557,149"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="929,401,1075,427"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="910,498,1094,525"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="1171,426,1316,453"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1181,375,1305,402"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1188,325,1299,351"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="1447,375,1559,402"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1416,325,1591,351"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1152,543,1335,570"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="1440,426,1567,453"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1443,661,1563,687"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="1416,477,1591,519"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="1404,711,1603,738"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1411,543,1595,570"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="1419,595,1588,636"/>
<area shape="rect" href="kvm__main_8c.html#a51faeec43f0c1f5fe8a68cd44f7ff046" title=" " alt="" coords="411,624,609,665"/>
<area shape="rect" href="x86_8c.html#a81fd299a20cbefe3205c4524e9c90e7e" title=" " alt="" coords="415,690,605,717"/>
<area shape="rect" href="kvm__main_8c.html#a6c41937c88f6e58c4c2cc8b235921b8e" title=" " alt="" coords="425,456,595,497"/>
<area shape="rect" href="kvm__main_8c.html#a9bf210089ca6fb3f4b38293588ab53c5" title=" " alt="" coords="436,522,584,549"/>
<area shape="rect" href="kvm__main_8c.html#a06ed191cebec13ce2c4a7d15fdeb5a60" title=" " alt="" coords="440,573,580,599"/>
<area shape="rect" href="kvm__main_8c.html#ac5a3afd8e2d8d1139dc7711c4b9e07e3" title=" " alt="" coords="680,690,853,717"/>
<area shape="rect" href="kvm__main_8c.html#aac20f0d987f71a47c6701c7e93a0e261" title=" " alt="" coords="680,573,853,599"/>
<area shape="rect" href="x86_8c.html#a951bd40e58d87204d565c6cb5fc664e6" title=" " alt="" coords="908,602,1096,629"/>
<area shape="rect" href="x86_8c.html#a54ec69b24c80207e4e6122994db0a466" title=" " alt="" coords="1158,661,1329,687"/>
<area shape="rect" href="x86_8c.html#a50b142cb27db85027825ca5630046d8f" title=" " alt="" coords="1171,602,1316,629"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="457,741,563,767"/>
</map>
</div>

</div>
</div>
<a id="a589e870c8a06d1ba26f24da299e47b95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a589e870c8a06d1ba26f24da299e47b95">&#9670;&nbsp;</a></span>pf_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int pf_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02038">2038</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;{</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; </div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    u64 fault_address = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    u64 error_code = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mmu_8c.html#a4d6f2ec540cbdb86e2594df2e4d453c2">kvm_handle_page_fault</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, error_code, fault_address,</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;            static_cpu_has(X86_FEATURE_DECODEASSISTS) ?</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.insn_bytes : NULL,</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.insn_len);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;}</div>
<div class="ttc" id="ammu_8c_html_a4d6f2ec540cbdb86e2594df2e4d453c2"><div class="ttname"><a href="mmu_8c.html#a4d6f2ec540cbdb86e2594df2e4d453c2">kvm_handle_page_fault</a></div><div class="ttdeci">int kvm_handle_page_fault(struct kvm_vcpu *vcpu, u64 error_code, u64 fault_address, char *insn, int insn_len)</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8c_source.html#l04540">mmu.c:4540</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a589e870c8a06d1ba26f24da299e47b95_cgraph.png" border="0" usemap="#asvm_8c_a589e870c8a06d1ba26f24da299e47b95_cgraph" alt=""/></div>
<map name="asvm_8c_a589e870c8a06d1ba26f24da299e47b95_cgraph" id="asvm_8c_a589e870c8a06d1ba26f24da299e47b95_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,125,108"/>
<area shape="rect" href="mmu_8c.html#a4d6f2ec540cbdb86e2594df2e4d453c2" title=" " alt="" coords="173,56,352,83"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="227,107,298,133"/>
<area shape="rect" href="x86_8h.html#a2a4bd8f3c9a644ab1bc76383672e8d4b" title=" " alt="" coords="406,5,623,32"/>
<area shape="rect" href="mmu_8c.html#a3d0bd209d792a4316f3b40681fdc10f9" title=" " alt="" coords="431,309,599,336"/>
<area shape="rect" href="mmu_8c.html#af74327c8867527505d8ca995e2b8a3fb" title=" " alt="" coords="400,56,629,83"/>
<area shape="rect" href="mmu_8c.html#a899cf46c0ee6df6305c7fe167421e2b7" title=" " alt="" coords="689,436,876,463"/>
<area shape="rect" href="mmu_8c.html#abaee26e516b75f579b063a76c376b045" title=" " alt="" coords="959,259,1115,285"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1227,740,1347,767"/>
<area shape="rect" href="mmu__internal_8h.html#ae3c71be306692107b4d90bfb8d24d7f5" title=" " alt="" coords="687,183,878,209"/>
<area shape="rect" href="mmu_8c.html#a45417375d740e0905773ac641827e0a0" title=" " alt="" coords="1187,532,1387,559"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="691,1253,874,1280"/>
<area shape="rect" href="mmu_8c.html#aa6dadc0bd20da0d41281abe089941491" title=" " alt="" coords="967,411,1107,437"/>
<area shape="rect" href="mmu_8c.html#a24c91b8ae0a349c76c95f6266f62d6e1" title=" " alt="" coords="976,461,1099,488"/>
<area shape="rect" href="mmu_8c.html#a82303f01ba06fead33e8a67eac44807e" title=" " alt="" coords="950,512,1125,539"/>
<area shape="rect" href="mmu_8c.html#a1217d6225ddd3e8a27699bb59fc91211" title=" " alt="" coords="962,563,1113,589"/>
<area shape="rect" href="spte_8h.html#a2927d719923cb2ed2b5b83d739a275f7" title=" " alt="" coords="981,613,1094,640"/>
<area shape="rect" href="x86_8h.html#ab77d498df3e80dc4bdbbd7ef398f9f4e" title=" " alt="" coords="950,360,1125,387"/>
<area shape="rect" href="x86_8h.html#a661bc84e256a87cbd929ffb7c1f61b2f" title=" " alt="" coords="1224,348,1349,375"/>
<area shape="rect" href="x86_8h.html#adec8392408e5b0e363872e91e83a90af" title=" " alt="" coords="1198,272,1375,299"/>
<area shape="rect" href="x86_8h.html#a2cc991ad82a0546dd38fabaf3c096037" title=" " alt="" coords="1198,221,1375,248"/>
<area shape="rect" href="mmu__internal_8h.html#a8a367cbfff40c5c72d6f19049da9fc51" title=" " alt="" coords="941,208,1134,235"/>
<area shape="rect" href="mmu__internal_8h.html#a4bd7a8fd81e65c4e06e025d92c5787d9" title=" " alt="" coords="960,107,1115,133"/>
<area shape="rect" href="kvm__main_8c.html#ac4b56de4919be80c9cd4289f20437c64" title=" " alt="" coords="936,157,1139,184"/>
<area shape="rect" href="mmu_8c.html#ab8e14476297a48107341bc44a29b6af9" title=" " alt="" coords="1435,481,1653,508"/>
<area shape="rect" href="mmu_8c.html#aa915f695d4c341eca7d1f5b5a0a26a03" title=" " alt="" coords="1435,532,1653,559"/>
<area shape="rect" href="kvm__main_8c.html#aa8688eb80c9acaf8b0aa783b6ac68c16" title=" " alt="" coords="1497,583,1591,609"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="1219,1632,1354,1659"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="939,1035,1136,1061"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="948,1085,1127,1112"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="961,1137,1114,1178"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="976,1203,1099,1229"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="943,1253,1131,1280"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="1202,1304,1371,1331"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1195,1253,1379,1280"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="938,1304,1137,1331"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="957,1457,1117,1498"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="942,1523,1133,1549"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="957,1574,1118,1615"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="947,1640,1128,1667"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="980,1691,1095,1717"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="977,1405,1098,1432"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="951,1742,1123,1783"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="944,1808,1131,1835"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="956,664,1119,691"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="973,715,1102,741"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="956,816,1119,843"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="994,867,1081,893"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="953,918,1122,959"/>
<area shape="rect" href="x86_8c.html#a5192f48e840413ed18b661a0fb6bca11" title=" " alt="" coords="677,5,888,32"/>
</map>
</div>

</div>
</div>
<a id="a1337a20b038f182d9e04102e22c45f79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1337a20b038f182d9e04102e22c45f79">&#9670;&nbsp;</a></span>pre_svm_run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pre_svm_run </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03533">3533</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;{</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a> *sd = per_cpu_ptr(&amp;svm_data, vcpu-&gt;cpu);</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160; </div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;<span class="comment">     * If the previous vmrun of the vmcb occurred on a different physical</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="comment">     * cpu, then mark the vmcb dirty and assign a new asid.  Hardware&#39;s</span></div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;<span class="comment">     * vmcb clean bits are per logical CPU, as are KVM&#39;s asid assignments.</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    <span class="keywordflow">if</span> (unlikely(svm-&gt;<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a>-&gt;<a class="code" href="structkvm__vmcb__info.html#a77727aa5326106aedb6630f4100578ec">cpu</a> != <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;cpu)) {</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a>-&gt;<a class="code" href="structkvm__vmcb__info.html#a48661ae4516f12bd14f4cc4121700a90">asid_generation</a> = 0;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;        <a class="code" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb">vmcb_mark_all_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>);</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a>-&gt;<a class="code" href="structkvm__vmcb__info.html#a77727aa5326106aedb6630f4100578ec">cpu</a> = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;cpu;</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        }</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160; </div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="sev_8c.html#ad0a040a48a04ab47d0af3385ad214cd4">pre_sev_run</a>(svm, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;cpu);</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160; </div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    <span class="comment">/* FIXME: handle wraparound of asid_generation */</span></div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a>-&gt;<a class="code" href="structkvm__vmcb__info.html#a48661ae4516f12bd14f4cc4121700a90">asid_generation</a> != sd-&gt;<a class="code" href="structsvm__cpu__data.html#ab20eb4010776c6fe52661fcf95cdc017">asid_generation</a>)</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;        <a class="code" href="svm_8c.html#a1ec4f210ddd96122d1d787a383483514">new_asid</a>(svm, sd);</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_ad0a040a48a04ab47d0af3385ad214cd4"><div class="ttname"><a href="sev_8c.html#ad0a040a48a04ab47d0af3385ad214cd4">pre_sev_run</a></div><div class="ttdeci">void pre_sev_run(struct vcpu_svm *svm, int cpu)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02646">sev.c:2646</a></div></div>
<div class="ttc" id="astructkvm__vmcb__info_html_a77727aa5326106aedb6630f4100578ec"><div class="ttname"><a href="structkvm__vmcb__info.html#a77727aa5326106aedb6630f4100578ec">kvm_vmcb_info::cpu</a></div><div class="ttdeci">int cpu</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00112">svm.h:112</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html"><div class="ttname"><a href="structsvm__cpu__data.html">svm_cpu_data</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00297">svm.h:297</a></div></div>
<div class="ttc" id="asvm_8c_html_a1ec4f210ddd96122d1d787a383483514"><div class="ttname"><a href="svm_8c.html#a1ec4f210ddd96122d1d787a383483514">new_asid</a></div><div class="ttdeci">static void new_asid(struct vcpu_svm *svm, struct svm_cpu_data *sd)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01980">svm.c:1980</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1337a20b038f182d9e04102e22c45f79_cgraph.png" border="0" usemap="#asvm_8c_a1337a20b038f182d9e04102e22c45f79_cgraph" alt=""/></div>
<map name="asvm_8c_a1337a20b038f182d9e04102e22c45f79_cgraph" id="asvm_8c_a1337a20b038f182d9e04102e22c45f79_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,112,133"/>
<area shape="rect" href="svm_8c.html#a1ec4f210ddd96122d1d787a383483514" title=" " alt="" coords="198,5,281,32"/>
<area shape="rect" href="sev_8c.html#ad0a040a48a04ab47d0af3385ad214cd4" title=" " alt="" coords="189,56,290,83"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="391,107,479,133"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="204,157,275,184"/>
<area shape="rect" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb" title=" " alt="" coords="160,208,319,235"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="367,5,503,32"/>
<area shape="rect" href="sev_8c.html#a66cc6caa9f6331de794476e911d4ce53" title=" " alt="" coords="381,56,488,83"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="551,81,657,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1337a20b038f182d9e04102e22c45f79_icgraph.png" border="0" usemap="#asvm_8c_a1337a20b038f182d9e04102e22c45f79_icgraph" alt=""/></div>
<map name="asvm_8c_a1337a20b038f182d9e04102e22c45f79_icgraph" id="asvm_8c_a1337a20b038f182d9e04102e22c45f79_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,276,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="a9a0c3d292847d2488f5e720fcd358771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a0c3d292847d2488f5e720fcd358771">&#9670;&nbsp;</a></span>rsm_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int rsm_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02596">2596</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;{</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a4845fb440d16fcac83f010947c55d38d">kvm_emulate_instruction_from_buffer</a>(vcpu, <a class="code" href="svm_8c.html#a698bd21413d89411791bef819c6dbbf9">rsm_ins_bytes</a>, 2);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a698bd21413d89411791bef819c6dbbf9"><div class="ttname"><a href="svm_8c.html#a698bd21413d89411791bef819c6dbbf9">rsm_ins_bytes</a></div><div class="ttdeci">static u8 rsm_ins_bytes[]</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00243">svm.c:243</a></div></div>
<div class="ttc" id="ax86_8c_html_a4845fb440d16fcac83f010947c55d38d"><div class="ttname"><a href="x86_8c.html#a4845fb440d16fcac83f010947c55d38d">kvm_emulate_instruction_from_buffer</a></div><div class="ttdeci">int kvm_emulate_instruction_from_buffer(struct kvm_vcpu *vcpu, void *insn, int insn_len)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09268">x86.c:9268</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a9a0c3d292847d2488f5e720fcd358771_cgraph.png" border="0" usemap="#asvm_8c_a9a0c3d292847d2488f5e720fcd358771_cgraph" alt=""/></div>
<map name="asvm_8c_a9a0c3d292847d2488f5e720fcd358771_cgraph" id="asvm_8c_a9a0c3d292847d2488f5e720fcd358771_cgraph">
<area shape="rect" title=" " alt="" coords="5,968,137,995"/>
<area shape="rect" href="x86_8c.html#a4845fb440d16fcac83f010947c55d38d" title=" " alt="" coords="185,961,373,1002"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="421,968,604,995"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="937,8,1071,35"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="653,1019,850,1046"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="662,1070,841,1096"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="675,1121,828,1162"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="690,1187,813,1214"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="657,606,845,632"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="919,496,1089,523"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1388,463,1572,490"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="652,470,851,496"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="671,1238,831,1280"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="656,1304,847,1331"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="671,1356,832,1397"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="661,1422,842,1448"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="694,1472,809,1499"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="691,84,812,111"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="665,212,837,253"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="658,160,845,187"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="670,816,833,843"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="687,867,816,894"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="670,1523,833,1550"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="961,1136,1047,1163"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="667,1574,836,1616"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="681,918,822,944"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1180,8,1317,35"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1407,59,1553,86"/>
<area shape="rect" href="x86_8c.html#a2a7f61481aae2e0bfe4baaba68d6d650" title=" " alt="" coords="919,1187,1089,1214"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="929,1238,1079,1264"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1420,816,1540,843"/>
<area shape="rect" href="x86_8c.html#aea69aad92f3a36aaebec0c2a9e853b61" title=" " alt="" coords="915,598,1093,640"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1157,463,1340,490"/>
<area shape="rect" href="x86_8c.html#a8bbfd08c002f2e09b42bb56cd8f52653" title=" " alt="" coords="923,430,1085,472"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="943,1304,1065,1331"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="925,1356,1083,1397"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="917,1422,1091,1448"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="919,1472,1089,1499"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="915,1523,1093,1550"/>
<area shape="rect" href="x86_8c.html#a0a47622bf3c21272e9e0357e1f90540a" title=" " alt="" coords="912,212,1096,253"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="912,160,1096,187"/>
<area shape="rect" href="x86_8c.html#a2857d8949e4bb5216636d3f7b03edc88" title=" " alt="" coords="913,278,1095,304"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="959,715,1049,742"/>
<area shape="rect" href="x86_8c.html#a52a62306898287a4475c0b6e78b30bf8" title=" " alt="" coords="917,918,1091,960"/>
<area shape="rect" href="mmu_8c.html#a45417375d740e0905773ac641827e0a0" title=" " alt="" coords="904,867,1104,894"/>
<area shape="rect" href="kvm__main_8c.html#af83e69473e2fe5bf6e452f3fc1f414d2" title=" " alt="" coords="916,766,1092,792"/>
<area shape="rect" href="emulate_8c.html#aee81e1534f235fdd985a388efb39983d" title=" " alt="" coords="899,1035,1109,1062"/>
<area shape="rect" href="fpu_8h.html#a8688ee98febd42598a4f6e45d1e9ef0b" title=" " alt="" coords="1169,1238,1329,1264"/>
<area shape="rect" href="fpu_8h.html#aaa61f7bcc588bff69c55d04dd8563583" title=" " alt="" coords="1175,1136,1323,1163"/>
<area shape="rect" href="emulate_8c.html#add9e11c9950d2e663b204801be3aad7f" title=" " alt="" coords="1168,1187,1329,1214"/>
</map>
</div>

</div>
</div>
<a id="a7f08bf5cf3614629bd95b07ea03b08cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f08bf5cf3614629bd95b07ea03b08cf">&#9670;&nbsp;</a></span>set_dr_intercepts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_dr_intercepts </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00724">724</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;{</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR0_READ);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR1_READ);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR2_READ);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR3_READ);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR4_READ);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR5_READ);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR6_READ);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR0_WRITE);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR1_WRITE);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR2_WRITE);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR3_WRITE);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR4_WRITE);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR5_WRITE);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR6_WRITE);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR7_READ);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_DR7_WRITE);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="code" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(svm);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_afdbe781b81d2ae90e81d9bb9e9750789"><div class="ttname"><a href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a></div><div class="ttdeci">static void vmcb_set_intercept(struct vmcb_control_area *control, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00379">svm.h:379</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a7f08bf5cf3614629bd95b07ea03b08cf_cgraph.png" border="0" usemap="#asvm_8c_a7f08bf5cf3614629bd95b07ea03b08cf_cgraph" alt=""/></div>
<map name="asvm_8c_a7f08bf5cf3614629bd95b07ea03b08cf_cgraph" id="asvm_8c_a7f08bf5cf3614629bd95b07ea03b08cf_cgraph">
<area shape="rect" title=" " alt="" coords="5,239,140,265"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="188,188,321,215"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="385,289,536,316"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="401,5,521,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="369,57,552,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="370,122,551,163"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="387,188,534,215"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="393,239,529,265"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="617,104,736,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="600,155,753,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1040,97,1213,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="801,129,992,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a7f08bf5cf3614629bd95b07ea03b08cf_icgraph.png" border="0" usemap="#asvm_8c_a7f08bf5cf3614629bd95b07ea03b08cf_icgraph" alt=""/></div>
<map name="asvm_8c_a7f08bf5cf3614629bd95b07ea03b08cf_icgraph" id="asvm_8c_a7f08bf5cf3614629bd95b07ea03b08cf_icgraph">
<area shape="rect" title=" " alt="" coords="436,31,571,57"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="241,5,328,32"/>
<area shape="rect" href="svm_8c.html#a8e925350e4b7d486cb0b9bace97fc5f0" title=" " alt="" coords="181,56,388,83"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
</map>
</div>

</div>
</div>
<a id="ae7cebb5bd1d0e7eadb2b7df90cca0c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7cebb5bd1d0e7eadb2b7df90cca0c74">&#9670;&nbsp;</a></span>set_msr_interception()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_msr_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>msrpm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>msr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>write</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00859">859</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;{</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2">set_shadow_msr_intercept</a>(vcpu, msr, read, write);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a">set_msr_interception_bitmap</a>(vcpu, msrpm, msr, read, write);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a1ffde811cc7743857dbb3175beda4aa2"><div class="ttname"><a href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2">set_shadow_msr_intercept</a></div><div class="ttdeci">static void set_shadow_msr_intercept(struct kvm_vcpu *vcpu, u32 msr, int read, int write)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00768">svm.c:768</a></div></div>
<div class="ttc" id="asvm_8c_html_a7baa0f9e5f7d38e8ed066a4b8a61c09a"><div class="ttname"><a href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a">set_msr_interception_bitmap</a></div><div class="ttdeci">static void set_msr_interception_bitmap(struct kvm_vcpu *vcpu, u32 *msrpm, u32 msr, int read, int write)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00822">svm.c:822</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ae7cebb5bd1d0e7eadb2b7df90cca0c74_cgraph.png" border="0" usemap="#asvm_8c_ae7cebb5bd1d0e7eadb2b7df90cca0c74_cgraph" alt=""/></div>
<map name="asvm_8c_ae7cebb5bd1d0e7eadb2b7df90cca0c74_cgraph" id="asvm_8c_ae7cebb5bd1d0e7eadb2b7df90cca0c74_cgraph">
<area shape="rect" title=" " alt="" coords="5,195,164,221"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="231,137,389,178"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="212,224,408,251"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="487,5,629,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="456,57,660,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="485,123,631,149"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="523,224,593,251"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="483,173,633,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="708,224,881,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ae7cebb5bd1d0e7eadb2b7df90cca0c74_icgraph.png" border="0" usemap="#asvm_8c_ae7cebb5bd1d0e7eadb2b7df90cca0c74_icgraph" alt=""/></div>
<map name="asvm_8c_ae7cebb5bd1d0e7eadb2b7df90cca0c74_icgraph" id="asvm_8c_ae7cebb5bd1d0e7eadb2b7df90cca0c74_icgraph">
<area shape="rect" title=" " alt="" coords="2655,310,2813,337"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1809,231,1896,258"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="2230,123,2381,164"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="2021,64,2173,105"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="2453,281,2591,307"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="2437,5,2607,47"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="2454,551,2590,578"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="2043,653,2152,679"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="2455,501,2589,527"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="2443,332,2601,373"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="2437,450,2607,477"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1513,235,1641,262"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="2247,281,2363,307"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="2027,282,2168,309"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1732,282,1973,309"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="2232,5,2379,47"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="2238,551,2373,578"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1775,501,1930,527"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1743,602,1963,629"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,445,1673,471"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,357,1684,399"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,618,1679,645"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,523,719,550"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,295,1679,322"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,552,1668,593"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,457,1399,499"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,406,1403,433"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,355,1389,382"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,465,1144,491"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,465,939,491"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,305,1421,331"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,603,1408,644"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,603,1176,644"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,635,945,662"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,585,940,611"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,389,520,415"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,363,323,390"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,363,128,390"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,254,1412,281"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="2229,335,2381,362"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="2221,386,2389,413"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="2037,333,2157,359"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="2022,384,2173,425"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="1781,384,1925,425"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="1781,450,1924,477"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="2225,501,2385,527"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2042,551,2153,578"/>
</map>
</div>

</div>
</div>
<a id="a7baa0f9e5f7d38e8ed066a4b8a61c09a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7baa0f9e5f7d38e8ed066a4b8a61c09a">&#9670;&nbsp;</a></span>set_msr_interception_bitmap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_msr_interception_bitmap </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>msrpm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>msr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>write</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00822">822</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;{</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    u8 bit_read, bit_write;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> tmp;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    u32 offset;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">     * If this warning triggers extend the direct_access_msrs list at the</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">     * beginning of the file</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    WARN_ON(!<a class="code" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e">valid_msr_intercept</a>(msr));</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">/* Enforce non allowed MSRs to trap */</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordflow">if</span> (read &amp;&amp; !<a class="code" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940">kvm_msr_allowed</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, msr, KVM_MSR_FILTER_READ))</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        read = 0;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">if</span> (write &amp;&amp; !<a class="code" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940">kvm_msr_allowed</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, msr, KVM_MSR_FILTER_WRITE))</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        write = 0;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    offset    = <a class="code" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f">svm_msrpm_offset</a>(msr);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    bit_read  = 2 * (msr &amp; 0x0f);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    bit_write = 2 * (msr &amp; 0x0f) + 1;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    tmp       = <a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>[offset];</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    BUG_ON(offset == <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    read  ? clear_bit(bit_read,  &amp;tmp) : set_bit(bit_read,  &amp;tmp);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    write ? clear_bit(bit_write, &amp;tmp) : set_bit(bit_write, &amp;tmp);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>[offset] = tmp;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae">svm_hv_vmcb_dirty_nested_enlightenments</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#ab518a0d0e52def0384b5a65321ea2854">force_msr_bitmap_recalc</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;}</div>
<div class="ttc" id="astructsvm__nested__state_html_ab518a0d0e52def0384b5a65321ea2854"><div class="ttname"><a href="structsvm__nested__state.html#ab518a0d0e52def0384b5a65321ea2854">svm_nested_state::force_msr_bitmap_recalc</a></div><div class="ttdeci">bool force_msr_bitmap_recalc</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00190">svm.h:190</a></div></div>
<div class="ttc" id="asvm_8c_html_a48f427ed9696201e388996df7ceccb9e"><div class="ttname"><a href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e">valid_msr_intercept</a></div><div class="ttdeci">static bool valid_msr_intercept(u32 index)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00789">svm.c:789</a></div></div>
<div class="ttc" id="asvm__onhyperv_8h_html_aa8051536beeae65d3e4645edd68850ae"><div class="ttname"><a href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae">svm_hv_vmcb_dirty_nested_enlightenments</a></div><div class="ttdeci">static void svm_hv_vmcb_dirty_nested_enlightenments(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm__onhyperv_8h_source.html#l00105">svm_onhyperv.h:105</a></div></div>
<div class="ttc" id="ax86_8c_html_aea310c0e4f695bd1c6b5d96aa1dbd940"><div class="ttname"><a href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940">kvm_msr_allowed</a></div><div class="ttdeci">bool kvm_msr_allowed(struct kvm_vcpu *vcpu, u32 index, u32 type)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01796">x86.c:1796</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a7baa0f9e5f7d38e8ed066a4b8a61c09a_cgraph.png" border="0" usemap="#asvm_8c_a7baa0f9e5f7d38e8ed066a4b8a61c09a_cgraph" alt=""/></div>
<map name="asvm_8c_a7baa0f9e5f7d38e8ed066a4b8a61c09a_cgraph" id="asvm_8c_a7baa0f9e5f7d38e8ed066a4b8a61c09a_cgraph">
<area shape="rect" title=" " alt="" coords="5,115,164,157"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="243,5,385,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="212,57,416,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="241,123,387,149"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="279,173,349,200"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="239,224,389,251"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="464,224,637,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a7baa0f9e5f7d38e8ed066a4b8a61c09a_icgraph.png" border="0" usemap="#asvm_8c_a7baa0f9e5f7d38e8ed066a4b8a61c09a_icgraph" alt=""/></div>
<map name="asvm_8c_a7baa0f9e5f7d38e8ed066a4b8a61c09a_icgraph" id="asvm_8c_a7baa0f9e5f7d38e8ed066a4b8a61c09a_icgraph">
<area shape="rect" title=" " alt="" coords="2884,329,3043,371"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="2666,311,2825,338"/>
<area shape="rect" href="svm_8c.html#ab4bda9cd8e4f3408d51dff1dd4403a11" title=" " alt="" coords="2655,362,2836,389"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1809,231,1896,258"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="2230,123,2381,164"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="2021,64,2173,105"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="2453,282,2591,309"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="2437,5,2607,47"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="2454,551,2590,578"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="2043,653,2152,679"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="2455,501,2589,527"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="2443,333,2601,375"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="2437,450,2607,477"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1513,235,1641,262"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="2247,282,2363,309"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="2027,282,2168,309"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1732,282,1973,309"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="2232,5,2379,47"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="2238,551,2373,578"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1775,501,1930,527"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1743,602,1963,629"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,445,1673,471"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,357,1684,399"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,618,1679,645"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,523,719,550"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,295,1679,322"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,552,1668,593"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,457,1399,499"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,406,1403,433"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,355,1389,382"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,465,1144,491"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,465,939,491"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,305,1421,331"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,603,1408,644"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,603,1176,644"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,635,945,662"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,585,940,611"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,389,520,415"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,363,323,390"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,363,128,390"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,254,1412,281"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="2229,337,2381,363"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="2221,387,2389,414"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="2037,333,2157,359"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="2022,384,2173,425"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="1781,384,1925,425"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="1781,450,1924,477"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="2225,501,2385,527"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2042,551,2153,578"/>
</map>
</div>

</div>
</div>
<a id="a1ffde811cc7743857dbb3175beda4aa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ffde811cc7743857dbb3175beda4aa2">&#9670;&nbsp;</a></span>set_shadow_msr_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_shadow_msr_intercept </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>msr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>write</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00768">768</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;{</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordtype">int</span> slot = <a class="code" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3">direct_access_msr_slot</a>(msr);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (slot == -ENOENT)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">/* Set the shadow bitmaps to the desired intercept states */</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">if</span> (read)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        set_bit(slot, svm-&gt;<a class="code" href="structvcpu__svm.html#aa3288372e9c9edbcd129adb446479dfd">shadow_msr_intercept</a>.read);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        clear_bit(slot, svm-&gt;<a class="code" href="structvcpu__svm.html#aa3288372e9c9edbcd129adb446479dfd">shadow_msr_intercept</a>.read);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">if</span> (write)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        set_bit(slot, svm-&gt;<a class="code" href="structvcpu__svm.html#aa3288372e9c9edbcd129adb446479dfd">shadow_msr_intercept</a>.write);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        clear_bit(slot, svm-&gt;<a class="code" href="structvcpu__svm.html#aa3288372e9c9edbcd129adb446479dfd">shadow_msr_intercept</a>.write);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_aa3288372e9c9edbcd129adb446479dfd"><div class="ttname"><a href="structvcpu__svm.html#aa3288372e9c9edbcd129adb446479dfd">vcpu_svm::shadow_msr_intercept</a></div><div class="ttdeci">struct vcpu_svm::@33 shadow_msr_intercept</div></div>
<div class="ttc" id="asvm_8c_html_a6a3d076f98c7c25a44d90f49f0fca2c3"><div class="ttname"><a href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3">direct_access_msr_slot</a></div><div class="ttdeci">static int direct_access_msr_slot(u32 msr)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00757">svm.c:757</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1ffde811cc7743857dbb3175beda4aa2_cgraph.png" border="0" usemap="#asvm_8c_a1ffde811cc7743857dbb3175beda4aa2_cgraph" alt=""/></div>
<map name="asvm_8c_a1ffde811cc7743857dbb3175beda4aa2_cgraph" id="asvm_8c_a1ffde811cc7743857dbb3175beda4aa2_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,201,57"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="249,5,423,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="301,56,371,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1ffde811cc7743857dbb3175beda4aa2_icgraph.png" border="0" usemap="#asvm_8c_a1ffde811cc7743857dbb3175beda4aa2_icgraph" alt=""/></div>
<map name="asvm_8c_a1ffde811cc7743857dbb3175beda4aa2_icgraph" id="asvm_8c_a1ffde811cc7743857dbb3175beda4aa2_icgraph">
<area shape="rect" title=" " alt="" coords="2861,310,3057,337"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="2655,310,2813,337"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1809,231,1896,258"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="2230,123,2381,164"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="2021,64,2173,105"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="2453,281,2591,307"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="2437,5,2607,47"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="2454,551,2590,578"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="2043,653,2152,679"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="2455,501,2589,527"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="2443,332,2601,373"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="2437,450,2607,477"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1513,235,1641,262"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="2247,281,2363,307"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="2027,282,2168,309"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1732,282,1973,309"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="2232,5,2379,47"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="2238,551,2373,578"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1775,501,1930,527"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1743,602,1963,629"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,445,1673,471"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,357,1684,399"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,618,1679,645"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,523,719,550"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,295,1679,322"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,552,1668,593"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,457,1399,499"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,406,1403,433"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,355,1389,382"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,465,1144,491"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,465,939,491"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,305,1421,331"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,603,1408,644"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,603,1176,644"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,635,945,662"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,585,940,611"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,389,520,415"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,363,323,390"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,363,128,390"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,254,1412,281"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="2229,335,2381,362"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="2221,386,2389,413"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="2037,333,2157,359"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="2022,384,2173,425"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="1781,384,1925,425"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="1781,450,1924,477"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="2225,501,2385,527"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2042,551,2153,578"/>
</map>
</div>

</div>
</div>
<a id="a642305873006637d55c46a0f035dff2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a642305873006637d55c46a0f035dff2d">&#9670;&nbsp;</a></span>sev_post_set_cr3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sev_post_set_cr3 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>cr3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01829">1829</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;{</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment">     * For guests that don&#39;t set guest_state_protected, the cr3 update is</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="comment">     * handled via kvm_mmu_load() while entering the guest. For guests</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">     * that do (SEV-ES/SEV-SNP), the cr3 update needs to be written to</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment">     * VMCB save area now, since the save area will become the initial</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">     * contents of the VMSA, and future VMCB save area updates won&#39;t be</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">     * seen.</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm)) {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cr3 = cr3;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_aaf8fd5f0e57d456151c951e0f3715fc4a4c1bf85b59430883fd2a9f4eebbac975"><div class="ttname"><a href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a></div><div class="ttdeci">@ VMCB_CR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00055">svm.h:55</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a642305873006637d55c46a0f035dff2d_cgraph.png" border="0" usemap="#asvm_8c_a642305873006637d55c46a0f035dff2d_cgraph" alt=""/></div>
<map name="asvm_8c_a642305873006637d55c46a0f035dff2d_cgraph" id="asvm_8c_a642305873006637d55c46a0f035dff2d_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,140,83"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="201,5,311,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="221,56,291,83"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="188,107,324,133"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="372,5,479,32"/>
</map>
</div>

</div>
</div>
<a id="aacde987fd6ae3956ec075251296c37a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacde987fd6ae3956ec075251296c37a0">&#9670;&nbsp;</a></span>shrink_ple_window()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void shrink_ple_window </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01088">1088</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;{</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keyword">struct </span>vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a> = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordtype">int</span> old = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_count;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#ab226ac0135835109146350d5db3d4031">kvm_pause_in_guest</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_count =</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                <a class="code" href="x86_8h.html#ae123da10adfeadb5ddcdf423f0bba192">__shrink_ple_window</a>(old,</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                            <a class="code" href="svm_8c.html#a3bc68316af32e407d865d83e00a03316">pause_filter_count</a>,</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                            <a class="code" href="svm_8c.html#ad71d914e223758efb4dcac69978f4083">pause_filter_count_shrink</a>,</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                            <a class="code" href="svm_8c.html#a3bc68316af32e407d865d83e00a03316">pause_filter_count</a>);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_count != old) {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a>);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        trace_kvm_ple_window_update(vcpu-&gt;vcpu_id,</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                        <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;pause_filter_count, old);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_ad71d914e223758efb4dcac69978f4083"><div class="ttname"><a href="svm_8c.html#ad71d914e223758efb4dcac69978f4083">pause_filter_count_shrink</a></div><div class="ttdeci">static unsigned short pause_filter_count_shrink</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00187">svm.c:187</a></div></div>
<div class="ttc" id="ax86_8h_html_ae123da10adfeadb5ddcdf423f0bba192"><div class="ttname"><a href="x86_8h.html#ae123da10adfeadb5ddcdf423f0bba192">__shrink_ple_window</a></div><div class="ttdeci">static unsigned int __shrink_ple_window(unsigned int val, unsigned int base, unsigned int modifier, unsigned int min)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00076">x86.h:76</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aacde987fd6ae3956ec075251296c37a0_cgraph.png" border="0" usemap="#asvm_8c_aacde987fd6ae3956ec075251296c37a0_cgraph" alt=""/></div>
<map name="asvm_8c_aacde987fd6ae3956ec075251296c37a0_cgraph" id="asvm_8c_aacde987fd6ae3956ec075251296c37a0_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,152,108"/>
<area shape="rect" href="x86_8h.html#ae123da10adfeadb5ddcdf423f0bba192" title=" " alt="" coords="200,5,360,32"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="201,56,359,83"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="245,107,315,133"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="212,157,348,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aacde987fd6ae3956ec075251296c37a0_icgraph.png" border="0" usemap="#asvm_8c_aacde987fd6ae3956ec075251296c37a0_icgraph" alt=""/></div>
<map name="asvm_8c_aacde987fd6ae3956ec075251296c37a0_icgraph" id="asvm_8c_aacde987fd6ae3956ec075251296c37a0_icgraph">
<area shape="rect" title=" " alt="" coords="168,5,315,32"/>
<area shape="rect" href="svm_8c.html#aa3f43ee7024c775ce671371e2bb5bf98" title=" " alt="" coords="5,5,120,32"/>
</map>
</div>

</div>
</div>
<a id="a2ca2b108d5447ed4093cb0b07092b07d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ca2b108d5447ed4093cb0b07092b07d">&#9670;&nbsp;</a></span>shutdown_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int shutdown_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02185">2185</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;{</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keyword">struct </span>kvm_run *kvm_run = vcpu-&gt;run;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">     * VMCB is undefined after a SHUTDOWN intercept.  INIT the vCPU to put</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">     * the VMCB in a known good state.  Unfortuately, KVM doesn&#39;t have</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">     * KVM_MP_STATE_SHUTDOWN and can&#39;t add it without potentially breaking</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">     * userspace.  At a platform view, INIT is acceptable behavior as</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">     * there exist bare metal platforms that automatically INIT the CPU</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">     * in response to shutdown.</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">     * The VM save area for SEV-ES guests has already been encrypted so it</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">     * cannot be reinitialized, i.e. synthesizing INIT is futile.</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm)) {</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        clear_page(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        <a class="code" href="x86_8c.html#a2694456104c02a7204796d89d13a1e91">kvm_vcpu_reset</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160; </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    kvm_run-&gt;exit_reason = KVM_EXIT_SHUTDOWN;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;}</div>
<div class="ttc" id="ax86_8c_html_a2694456104c02a7204796d89d13a1e91"><div class="ttname"><a href="x86_8c.html#a2694456104c02a7204796d89d13a1e91">kvm_vcpu_reset</a></div><div class="ttdeci">void kvm_vcpu_reset(struct kvm_vcpu *vcpu, bool init_event)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l12224">x86.c:12224</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a2ca2b108d5447ed4093cb0b07092b07d_cgraph.png" border="0" usemap="#asvm_8c_a2ca2b108d5447ed4093cb0b07092b07d_cgraph" alt=""/></div>
<map name="asvm_8c_a2ca2b108d5447ed4093cb0b07092b07d_cgraph" id="asvm_8c_a2ca2b108d5447ed4093cb0b07092b07d_cgraph">
<area shape="rect" title=" " alt="" coords="5,989,176,1016"/>
<area shape="rect" href="x86_8c.html#a2694456104c02a7204796d89d13a1e91" title=" " alt="" coords="224,660,353,687"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="233,989,344,1016"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="253,1040,324,1067"/>
<area shape="rect" href="x86_8c.html#ad0df6b04ae08eb6eec89da2d81e465cd" title=" " alt="" coords="437,157,561,184"/>
<area shape="rect" href="x86_8c.html#a8543429a9ca5c6d3d88560ccd84bbccd" title=" " alt="" coords="690,407,809,433"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="439,275,559,301"/>
<area shape="rect" href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67" title=" " alt="" coords="462,325,535,352"/>
<area shape="rect" href="x86_8c.html#ad850a917f349195334a4ef07b53ca379" title=" " alt="" coords="401,376,596,403"/>
<area shape="rect" href="async__pf_8c.html#ad351bddfe80f107dfc95c6ab2768fe4f" title=" " alt="" coords="421,209,576,250"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="418,478,579,519"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="422,543,575,585"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="416,427,581,453"/>
<area shape="rect" href="lapic_8c.html#a8b8a5d87df5283a20e9aa9b828320552" title=" " alt="" coords="434,660,563,687"/>
<area shape="rect" href="x86_8c.html#ab8771c02486ef5edb9fe0008df56ce1a" title=" " alt="" coords="426,711,571,737"/>
<area shape="rect" href="x86_8c.html#a5a8141aa63a4bf45916d2adeab6504a1" title=" " alt="" coords="420,761,577,788"/>
<area shape="rect" href="mmu_8c.html#a56f1568115a55fdacc188e9b41159b8f" title=" " alt="" coords="405,812,593,839"/>
<area shape="rect" href="x86_8h.html#a5523aac5838b664e939f6560ae882d9e" title=" " alt="" coords="419,863,578,889"/>
<area shape="rect" href="x86_8c.html#aca7d72d338b3f1e73445d7b2ed0b1673" title=" " alt="" coords="423,913,574,940"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="441,964,556,991"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="441,1015,556,1041"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba" title=" " alt="" coords="441,1065,556,1092"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="405,1116,592,1143"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="441,1167,556,1193"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="438,1217,559,1244"/>
<area shape="rect" href="x86_8c.html#a7f55b680840b47f6503d94801f44f2d0" title=" " alt="" coords="421,5,576,32"/>
<area shape="rect" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a" title=" " alt="" coords="433,56,564,83"/>
<area shape="rect" href="x86_8c.html#a2ed72da9144cd3c6d136a2ce6e1a76cb" title=" " alt="" coords="436,107,561,133"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="939,325,1069,352"/>
<area shape="rect" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d" title=" " alt="" coords="672,36,827,63"/>
<area shape="rect" href="x86_8h.html#af9a5d53e18d888ed043578916e51cc55" title=" " alt="" coords="657,87,841,113"/>
<area shape="rect" href="x86_8h.html#af360aa7bd1f33ab25089b12431f11773" title=" " alt="" coords="929,112,1079,139"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="903,464,1105,491"/>
<area shape="rect" href="async__pf_8c.html#a5b03475159778ff1b6a78dbbfc913a01" title=" " alt="" coords="673,239,826,281"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="681,305,818,332"/>
<area shape="rect" href="lapic_8c.html#afefd171448cafa66f80ecb9b9659ebb1" title=" " alt="" coords="644,812,855,839"/>
<area shape="rect" href="lapic_8c.html#aeb32a868e76d57da9fab57fce43efdbe" title=" " alt="" coords="949,761,1059,788"/>
<area shape="rect" href="lapic_8c.html#ab2ee275fa1bc17aa0bfde435723b8f48" title=" " alt="" coords="1153,761,1297,788"/>
<area shape="rect" href="lapic_8c.html#ac7a03b55710bfcc78be7af0609f6f93d" title=" " alt="" coords="684,913,815,940"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="931,863,1077,889"/>
<area shape="rect" href="lapic_8c.html#a7cfae0ee851075e6141d0446f4a133ab" title=" " alt="" coords="685,1015,814,1041"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="678,457,821,484"/>
<area shape="rect" href="lapic_8c.html#a54214770509be207a1c1271e8b48acf4" title=" " alt="" coords="935,1040,1073,1067"/>
<area shape="rect" href="lapic_8c.html#a2a5ccc92c8b75ad6118bdc1b84a43554" title=" " alt="" coords="936,660,1072,687"/>
<area shape="rect" href="lapic_8c.html#aaa6716cc0b30bec513d223fbfdecfdcf" title=" " alt="" coords="666,356,833,383"/>
<area shape="rect" href="lapic_8c.html#ab24997de83c3fd44d1cd7520a615883e" title=" " alt="" coords="917,559,1091,585"/>
<area shape="rect" href="lapic_8c.html#a5468339c2df08ca538b77d4d48915c35" title=" " alt="" coords="660,660,839,687"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="666,711,833,737"/>
<area shape="rect" href="lapic_8c.html#a8d747385873e52f47e85179c21521e73" title=" " alt="" coords="672,508,827,535"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="445,1268,552,1295"/>
</map>
</div>

</div>
</div>
<a id="a2a0bfadf1447f60e987b7a725eaa8915"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a0bfadf1447f60e987b7a725eaa8915">&#9670;&nbsp;</a></span>skinit_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int skinit_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02480">2480</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;{</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    trace_kvm_skinit(<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;vmcb-&gt;save.rip, kvm_rax_read(vcpu));</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <a class="code" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a>(vcpu, UD_VECTOR);</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a2a0bfadf1447f60e987b7a725eaa8915_cgraph.png" border="0" usemap="#asvm_8c_a2a0bfadf1447f60e987b7a725eaa8915_cgraph" alt=""/></div>
<map name="asvm_8c_a2a0bfadf1447f60e987b7a725eaa8915_cgraph" id="asvm_8c_a2a0bfadf1447f60e987b7a725eaa8915_cgraph">
<area shape="rect" title=" " alt="" coords="5,199,148,225"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="196,173,365,200"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="245,224,316,251"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="413,173,596,200"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="680,5,807,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="683,56,803,83"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="656,107,831,149"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="644,173,843,200"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="651,224,835,251"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="659,275,828,317"/>
</map>
</div>

</div>
</div>
<a id="ada885d8d01d76b364afd5791c676bdd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada885d8d01d76b364afd5791c676bdd5">&#9670;&nbsp;</a></span>smi_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int smi_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02241">2241</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;{</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a2c47b46c5f4c14c1ae6a64119bcb60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a2c47b46c5f4c14c1ae6a64119bcb60">&#9670;&nbsp;</a></span>stgi_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int stgi_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02439">2439</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;{</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160; </div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8">nested_svm_check_permissions</a>(vcpu))</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160; </div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    ret = <a class="code" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a>(vcpu);</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    <a class="code" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a>(<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu), <span class="keyword">true</span>);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a0a2c47b46c5f4c14c1ae6a64119bcb60_cgraph.png" border="0" usemap="#asvm_8c_a0a2c47b46c5f4c14c1ae6a64119bcb60_cgraph" alt=""/></div>
<map name="asvm_8c_a0a2c47b46c5f4c14c1ae6a64119bcb60_cgraph" id="asvm_8c_a0a2c47b46c5f4c14c1ae6a64119bcb60_cgraph">
<area shape="rect" title=" " alt="" coords="5,502,136,529"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="185,350,415,377"/>
<area shape="rect" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8" title=" " alt="" coords="184,477,416,503"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="534,527,605,554"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="249,806,351,833"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="479,165,660,191"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="476,350,663,377"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="753,89,876,115"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="735,216,894,257"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="727,22,902,49"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="729,165,900,191"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="1255,147,1346,174"/>
<area shape="rect" href="pmu_8h.html#abbf4b99efff2cdd22398e2992085c36f" title=" " alt="" coords="955,5,1153,47"/>
<area shape="rect" href="pmu_8c.html#af08b63fb7910be3ee65e8036b4e48aad" title=" " alt="" coords="965,223,1143,250"/>
<area shape="rect" href="pmu_8h.html#a156ede05e2f3b40ccf7a68f471f574b2" title=" " alt="" coords="961,173,1147,199"/>
<area shape="rect" href="pmu_8h.html#a276700643eefb3c6911a7ae0dc0e3809" title=" " alt="" coords="963,122,1145,149"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="741,325,888,351"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="723,375,907,402"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="981,325,1127,351"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="992,375,1116,402"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="999,274,1109,301"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="963,426,1145,453"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="1237,543,1364,570"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1241,730,1361,757"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="1213,309,1388,351"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="1201,375,1400,402"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1209,426,1393,453"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="1216,477,1385,519"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="527,426,611,453"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="485,477,654,503"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="741,426,888,453"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="981,477,1127,503"/>
<area shape="rect" href="svm_8h.html#a711d42f525aa791008754514284a556c" title=" " alt="" coords="523,781,616,807"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="524,831,615,858"/>
<area shape="rect" href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd" title=" " alt="" coords="482,715,657,756"/>
<area shape="rect" href="irq_8c.html#a82ee83566d2724a298b67f23f481976b" title=" " alt="" coords="464,629,675,655"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="506,882,633,909"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="745,933,884,959"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="503,983,636,1010"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="755,781,874,807"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="975,781,1133,807"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="995,629,1113,655"/>
<area shape="rect" href="lapic_8c.html#aa421165466ac455ff3fff91fb9afe7bf" title=" " alt="" coords="725,527,904,554"/>
<area shape="rect" href="irq_8c.html#a0ba50d6865653a9d307102d8f0b36630" title=" " alt="" coords="737,629,893,655"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="725,578,904,605"/>
<area shape="rect" href="lapic_8c.html#a1bb0a1640f9f291f5c3154c6a2c40986" title=" " alt="" coords="983,527,1125,554"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1233,894,1369,921"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="987,933,1121,959"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="1227,958,1374,985"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="744,983,885,1010"/>
</map>
</div>

</div>
</div>
<a id="ae9ce56e3c8875ba1d607bb1be8ed420f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ce56e3c8875ba1d607bb1be8ed420f">&#9670;&nbsp;</a></span>svm_adjust_mmio_mask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __init void svm_adjust_mmio_mask </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l05042">5042</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;{</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> enc_bit, mask_bit;</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;    u64 msr, mask;</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160; </div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;    <span class="comment">/* If there is no memory encryption support, use existing mask */</span></div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;    <span class="keywordflow">if</span> (cpuid_eax(0x80000000) &lt; 0x8000001f)</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160; </div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;    <span class="comment">/* If memory encryption is not enabled, use existing mask */</span></div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;    rdmsrl(MSR_AMD64_SYSCFG, msr);</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;    <span class="keywordflow">if</span> (!(msr &amp; MSR_AMD64_SYSCFG_MEM_ENCRYPT))</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160; </div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;    enc_bit = cpuid_ebx(0x8000001f) &amp; 0x3f;</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;    mask_bit = boot_cpu_data.x86_phys_bits;</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160; </div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;    <span class="comment">/* Increment the mask bit if it is the same as the encryption bit */</span></div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;    <span class="keywordflow">if</span> (enc_bit == mask_bit)</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;        mask_bit++;</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160; </div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;<span class="comment">     * If the mask bit location is below 52, then some bits above the</span></div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;<span class="comment">     * physical addressing limit will always be reserved, so use the</span></div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;<span class="comment">     * rsvd_bits() function to generate the mask. This mask, along with</span></div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;<span class="comment">     * the present bit, will be used to generate a page fault with</span></div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;<span class="comment">     * PFER.RSV = 1.</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;<span class="comment">     * If the mask bit location is 52 (or above), then clear the mask.</span></div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;    mask = (mask_bit &lt; 52) ? <a class="code" href="mmu_8h.html#a20a41b0166b13eb22b15786964f5de9d">rsvd_bits</a>(mask_bit, 51) | <a class="code" href="mmu_8h.html#a6a3dca6eee809f72f4c5af9b1adfca58">PT_PRESENT_MASK</a> : 0;</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160; </div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;    <a class="code" href="spte_8c.html#a80f2cd338ffdc70a83e10eda040387a5">kvm_mmu_set_mmio_spte_mask</a>(mask, mask, <a class="code" href="mmu_8h.html#a8738f5e32b741b402eeb723accb071ed">PT_WRITABLE_MASK</a> | <a class="code" href="mmu_8h.html#aefe2df12a6601495d0fcf57568247dd2">PT_USER_MASK</a>);</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;}</div>
<div class="ttc" id="ammu_8h_html_a20a41b0166b13eb22b15786964f5de9d"><div class="ttname"><a href="mmu_8h.html#a20a41b0166b13eb22b15786964f5de9d">rsvd_bits</a></div><div class="ttdeci">static __always_inline u64 rsvd_bits(int s, int e)</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8h_source.html#l00045">mmu.h:45</a></div></div>
<div class="ttc" id="ammu_8h_html_a6a3dca6eee809f72f4c5af9b1adfca58"><div class="ttname"><a href="mmu_8h.html#a6a3dca6eee809f72f4c5af9b1adfca58">PT_PRESENT_MASK</a></div><div class="ttdeci">#define PT_PRESENT_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8h_source.html#l00014">mmu.h:14</a></div></div>
<div class="ttc" id="ammu_8h_html_a8738f5e32b741b402eeb723accb071ed"><div class="ttname"><a href="mmu_8h.html#a8738f5e32b741b402eeb723accb071ed">PT_WRITABLE_MASK</a></div><div class="ttdeci">#define PT_WRITABLE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8h_source.html#l00015">mmu.h:15</a></div></div>
<div class="ttc" id="ammu_8h_html_aefe2df12a6601495d0fcf57568247dd2"><div class="ttname"><a href="mmu_8h.html#aefe2df12a6601495d0fcf57568247dd2">PT_USER_MASK</a></div><div class="ttdeci">#define PT_USER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8h_source.html#l00016">mmu.h:16</a></div></div>
<div class="ttc" id="aspte_8c_html_a80f2cd338ffdc70a83e10eda040387a5"><div class="ttname"><a href="spte_8c.html#a80f2cd338ffdc70a83e10eda040387a5">kvm_mmu_set_mmio_spte_mask</a></div><div class="ttdeci">void kvm_mmu_set_mmio_spte_mask(u64 mmio_value, u64 mmio_mask, u64 access_mask)</div><div class="ttdef"><b>Definition:</b> <a href="spte_8c_source.html#l00362">spte.c:362</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ae9ce56e3c8875ba1d607bb1be8ed420f_cgraph.png" border="0" usemap="#asvm_8c_ae9ce56e3c8875ba1d607bb1be8ed420f_cgraph" alt=""/></div>
<map name="asvm_8c_ae9ce56e3c8875ba1d607bb1be8ed420f_cgraph" id="asvm_8c_ae9ce56e3c8875ba1d607bb1be8ed420f_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,191,57"/>
<area shape="rect" href="spte_8c.html#a80f2cd338ffdc70a83e10eda040387a5" title=" " alt="" coords="239,5,481,32"/>
<area shape="rect" href="mmu_8h.html#a20a41b0166b13eb22b15786964f5de9d" title=" " alt="" coords="319,56,401,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ae9ce56e3c8875ba1d607bb1be8ed420f_icgraph.png" border="0" usemap="#asvm_8c_ae9ce56e3c8875ba1d607bb1be8ed420f_icgraph" alt=""/></div>
<map name="asvm_8c_ae9ce56e3c8875ba1d607bb1be8ed420f_icgraph" id="asvm_8c_ae9ce56e3c8875ba1d607bb1be8ed420f_icgraph">
<area shape="rect" title=" " alt="" coords="215,5,400,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="aca7bf4b32b7e7a7cfa632783dd5e6fbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca7bf4b32b7e7a7cfa632783dd5e6fbf">&#9670;&nbsp;</a></span>svm_apic_init_signal_blocked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_apic_init_signal_blocked </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04868">4868</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;{</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160; </div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;    <span class="keywordflow">return</span> !<a class="code" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a>(svm);</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_aea7fbac9a0652dc113c81593522e47ca"><div class="ttname"><a href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a></div><div class="ttdeci">static bool gif_set(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00483">svm.h:483</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aca7bf4b32b7e7a7cfa632783dd5e6fbf_cgraph.png" border="0" usemap="#asvm_8c_aca7bf4b32b7e7a7cfa632783dd5e6fbf_cgraph" alt=""/></div>
<map name="asvm_8c_aca7bf4b32b7e7a7cfa632783dd5e6fbf_cgraph" id="asvm_8c_aca7bf4b32b7e7a7cfa632783dd5e6fbf_cgraph">
<area shape="rect" title=" " alt="" coords="5,49,164,90"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="214,31,281,57"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="212,81,283,108"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="331,31,449,57"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="516,5,636,32"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="497,56,655,83"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="703,56,821,83"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1108,49,1281,90"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="869,81,1060,108"/>
</map>
</div>

</div>
</div>
<a id="a6c03fa2ac66c8db77e6bdc408cf0b7bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c03fa2ac66c8db77e6bdc408cf0b7bb">&#9670;&nbsp;</a></span>svm_cache_reg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_cache_reg </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum kvm_reg&#160;</td>
          <td class="paramname"><em>reg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01612">1612</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;{</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <a class="code" href="kvm__cache__regs_8h.html#a02b01f3ac97e70ca6457508f8dd94b2f">kvm_register_mark_available</a>(vcpu, reg);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">switch</span> (reg) {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">case</span> VCPU_EXREG_PDPTR:</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment">         * When !npt_enabled, mmu-&gt;pdptrs[] is already available since</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">         * it is always updated per SDM when moving to CRs.</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>)</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;            <a class="code" href="x86_8c.html#ae69bdd054a70a95d99b79bae770372cf">load_pdptrs</a>(vcpu, <a class="code" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378">kvm_read_cr3</a>(vcpu));</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        KVM_BUG_ON(1, vcpu-&gt;kvm);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;}</div>
<div class="ttc" id="akvm__cache__regs_8h_html_a02b01f3ac97e70ca6457508f8dd94b2f"><div class="ttname"><a href="kvm__cache__regs_8h.html#a02b01f3ac97e70ca6457508f8dd94b2f">kvm_register_mark_available</a></div><div class="ttdeci">static void kvm_register_mark_available(struct kvm_vcpu *vcpu, enum kvm_reg reg)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00065">kvm_cache_regs.h:65</a></div></div>
<div class="ttc" id="ax86_8c_html_ae69bdd054a70a95d99b79bae770372cf"><div class="ttname"><a href="x86_8c.html#ae69bdd054a70a95d99b79bae770372cf">load_pdptrs</a></div><div class="ttdeci">int load_pdptrs(struct kvm_vcpu *vcpu, unsigned long cr3)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00866">x86.c:866</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a6c03fa2ac66c8db77e6bdc408cf0b7bb_cgraph.png" border="0" usemap="#asvm_8c_a6c03fa2ac66c8db77e6bdc408cf0b7bb_cgraph" alt=""/></div>
<map name="asvm_8c_a6c03fa2ac66c8db77e6bdc408cf0b7bb_cgraph" id="asvm_8c_a6c03fa2ac66c8db77e6bdc408cf0b7bb_cgraph">
<area shape="rect" title=" " alt="" coords="5,69,128,96"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="227,12,341,39"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a02b01f3ac97e70ca6457508f8dd94b2f" title=" " alt="" coords="176,69,392,96"/>
<area shape="rect" href="x86_8c.html#ae69bdd054a70a95d99b79bae770372cf" title=" " alt="" coords="235,132,333,159"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="447,5,640,32"/>
<area shape="rect" href="mmu_8c.html#ab7d4e418cb85a72507e384df5027293e" title=" " alt="" coords="461,335,626,361"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="450,56,637,83"/>
<area shape="rect" href="mmu_8h.html#a937b5147c498fb7bdafb70240b735089" title=" " alt="" coords="470,107,617,133"/>
<area shape="rect" href="kvm__main_8c.html#adfef9b2c2d6359fd443d98f51be19605" title=" " alt="" coords="440,157,647,184"/>
<area shape="rect" href="x86_8c.html#aee0eed4ae7aae6d67d9db92d30f029d8" title=" " alt="" coords="482,208,605,235"/>
<area shape="rect" href="mmu_8c.html#ab8e14476297a48107341bc44a29b6af9" title=" " alt="" coords="945,1043,1164,1069"/>
<area shape="rect" href="mmu__internal_8h.html#a6491934fd3538f608b4b91245943b6fc" title=" " alt="" coords="1228,297,1428,324"/>
<area shape="rect" href="kvm__main_8c.html#aa8688eb80c9acaf8b0aa783b6ac68c16" title=" " alt="" coords="749,309,843,336"/>
<area shape="rect" href="mmu_8c.html#a5b648a843c7267d204fe81facbc9f84f" title=" " alt="" coords="715,411,877,437"/>
<area shape="rect" href="spte_8h.html#ab169c1872e98b9731a05121e0439f244" title=" " alt="" coords="1009,277,1100,304"/>
<area shape="rect" href="kvm__main_8c.html#a54913b65d68c88909678d5cf9c983a6b" title=" " alt="" coords="1241,1097,1415,1124"/>
<area shape="rect" href="mmu_8c.html#a584797a273970c4c5a807189bdc0004e" title=" " alt="" coords="1217,1043,1439,1069"/>
<area shape="rect" href="kvm__main_8c.html#abaa3f5ff00150487b52dd21c1617bab6" title=" " alt="" coords="1492,1101,1703,1128"/>
<area shape="rect" href="kvm__main_8c.html#ac46e1a0e43c0784194a451a7e7394c02" title=" " alt="" coords="1751,1094,1961,1135"/>
<area shape="rect" href="kvm__main_8c.html#a56fa7dccf37545a9046522ded0354c7e" title=" " alt="" coords="2020,1076,2187,1103"/>
<area shape="rect" href="kvm__main_8c.html#a90667c5619416298aea980ad51ec8525" title=" " alt="" coords="2009,1127,2197,1153"/>
<area shape="rect" href="mmu_8c.html#a61b041a986244b62aedac5b132cf2c09" title=" " alt="" coords="1508,1035,1687,1077"/>
<area shape="rect" href="spte_8h.html#a7d73c1cb0114320b9dab8ba78033c686" title=" " alt="" coords="2016,960,2191,987"/>
<area shape="rect" href="mmu_8c.html#a69a9545d1380d3c51ec6fa0f9ff36555" title=" " alt="" coords="1763,1043,1949,1069"/>
<area shape="rect" href="tdp__mmu_8h.html#a166bc9e57a26e8a37e94e2314a72d226" title=" " alt="" coords="1785,461,1927,488"/>
<area shape="rect" href="mmu_8c.html#aa915f695d4c341eca7d1f5b5a0a26a03" title=" " alt="" coords="945,652,1164,679"/>
<area shape="rect" href="tdp__mmu_8c.html#a8a9d637b546d8dfd125028f823a6eac0" title=" " alt="" coords="964,411,1145,437"/>
<area shape="rect" href="mmu_8c.html#a01417b2ac70337a4419dc0f171bd548f" title=" " alt="" coords="1212,715,1444,741"/>
<area shape="rect" href="mmu_8c.html#a39242ba7b127ebf064de37a1224635cd" title=" " alt="" coords="1538,563,1657,589"/>
<area shape="rect" href="mmu_8c.html#abab2bb5454cc72ba2e4913a87e5800fe" title=" " alt="" coords="1508,867,1687,909"/>
<area shape="rect" href="mmu_8c.html#a9d4eccd9e1e1198a1e63d28b750efe83" title=" " alt="" coords="1500,816,1695,843"/>
<area shape="rect" href="mmu_8c.html#ac1f044f2e317d0cd567530208b7118ee" title=" " alt="" coords="1495,933,1700,960"/>
<area shape="rect" href="mmu_8c.html#a2a0cdee83771c8d171f5f809076773d2" title=" " alt="" coords="1502,613,1693,640"/>
<area shape="rect" href="mmu_8c.html#af8bc85c6e33cec42152e7982b1fb4cba" title=" " alt="" coords="1498,512,1697,539"/>
<area shape="rect" href="mmu_8c.html#a85d47efa797da896b3bb3cf1cc32d768" title=" " alt="" coords="1542,664,1653,691"/>
<area shape="rect" href="mmu_8c.html#a802c5b4f03cc2183d5a097abb661e90c" title=" " alt="" coords="1502,715,1693,741"/>
<area shape="rect" href="mmu_8c.html#ab0716e0d51f7a555f58f426cbfb6d890" title=" " alt="" coords="1516,765,1679,792"/>
<area shape="rect" href="mmu_8c.html#a5d549ae5b6c13e9b87ccc13127ddf86a" title=" " alt="" coords="1779,892,1933,919"/>
<area shape="rect" href="spte_8h.html#af8791b1ec453ef3bce3c87ea28744692" title=" " alt="" coords="2038,876,2169,903"/>
<area shape="rect" href="spte_8h.html#a6e93c3ba68ed8b0ab050918d92cf4c6b" title=" " alt="" coords="2245,876,2376,903"/>
<area shape="rect" href="tdp__mmu_8c.html#a92b80ecd9f7bf033d7ed2f28fb0a1279" title=" " alt="" coords="1245,399,1411,441"/>
<area shape="rect" href="tdp__mmu_8c.html#afab0b8fc9210a8e1190a153f664ef78b" title=" " alt="" coords="1528,407,1667,433"/>
<area shape="rect" href="mmu_8h.html#aa47e04c0739bc10134b493cc8bfb0dc6" title=" " alt="" coords="715,56,877,83"/>
<area shape="rect" href="x86_8h.html#a661bc84e256a87cbd929ffb7c1f61b2f" title=" " alt="" coords="992,56,1117,83"/>
<area shape="rect" href="kvm__main_8c.html#acc4698e3f076cdbbd5d8ca788a94decf" title=" " alt="" coords="705,107,887,133"/>
<area shape="rect" href="kvm__main_8c.html#ac4b56de4919be80c9cd4289f20437c64" title=" " alt="" coords="695,157,897,184"/>
<area shape="rect" href="kvm__main_8c.html#adb8a0a4f675ca16ea81acd3b88089f13" title=" " alt="" coords="959,107,1151,133"/>
<area shape="rect" href="kvm__main_8c.html#ab58025ccc253a102c64561fa61c2a514" title=" " alt="" coords="1252,132,1404,159"/>
<area shape="rect" href="kvm__main_8c.html#a77ec4b9140d69a05f3b4e7836cc03a96" title=" " alt="" coords="1516,107,1679,133"/>
<area shape="rect" href="mmu_8h.html#a20a41b0166b13eb22b15786964f5de9d" title=" " alt="" coords="755,208,837,235"/>
</map>
</div>

</div>
</div>
<a id="a508824f395cb7a7903a7f5dc7042b082"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a508824f395cb7a7903a7f5dc7042b082">&#9670;&nbsp;</a></span>svm_cancel_injection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_cancel_injection </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04077">4077</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;{</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;    <span class="keyword">struct </span>vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a> = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control;</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160; </div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_int_info = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;event_inj;</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_int_info_err = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;event_inj_err;</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;event_inj = 0;</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;    <a class="code" href="svm_8c.html#a921858ef8782f6b0eebb284c5db66de8">svm_complete_interrupts</a>(vcpu);</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a921858ef8782f6b0eebb284c5db66de8"><div class="ttname"><a href="svm_8c.html#a921858ef8782f6b0eebb284c5db66de8">svm_complete_interrupts</a></div><div class="ttdeci">static void svm_complete_interrupts(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l04008">svm.c:4008</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a508824f395cb7a7903a7f5dc7042b082_cgraph.png" border="0" usemap="#asvm_8c_a508824f395cb7a7903a7f5dc7042b082_cgraph" alt=""/></div>
<map name="asvm_8c_a508824f395cb7a7903a7f5dc7042b082_cgraph" id="asvm_8c_a508824f395cb7a7903a7f5dc7042b082_cgraph">
<area shape="rect" title=" " alt="" coords="5,417,168,444"/>
<area shape="rect" href="svm_8c.html#a921858ef8782f6b0eebb284c5db66de8" title=" " alt="" coords="216,291,404,317"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="768,544,839,571"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="477,58,639,99"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="481,123,635,165"/>
<area shape="rect" href="x86_8h.html#aaa166361b58ce8e326699e6cfe87e39a" title=" " alt="" coords="477,189,639,216"/>
<area shape="rect" href="x86_8c.html#a7afcfddd2ea5cf31a22813c76d9747c2" title=" " alt="" coords="467,240,649,267"/>
<area shape="rect" href="x86_8c.html#a0d7f1c47245e95be49d8925ca92b8365" title=" " alt="" coords="459,291,657,317"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1227,341,1338,368"/>
<area shape="rect" href="svm_8c.html#adf1eccfcab9b8a4c710b30fec219fe14" title=" " alt="" coords="452,443,664,469"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="712,224,895,251"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="979,5,1105,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="982,56,1102,83"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="955,107,1129,149"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="943,173,1141,200"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="950,224,1134,251"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="957,275,1127,317"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1424,341,1599,368"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1647,341,1840,368"/>
<area shape="rect" href="x86_8h.html#a441b0296c9e66d1e4f4c554d73a3093e" title=" " alt="" coords="718,392,889,419"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="735,443,872,469"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="746,493,861,520"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="969,417,1115,444"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="1210,392,1355,419"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1221,443,1345,469"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="1455,443,1567,469"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="953,493,1131,520"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="1189,493,1376,520"/>
</map>
</div>

</div>
</div>
<a id="a28ea9c19442062c9e284d39852ffab26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ea9c19442062c9e284d39852ffab26">&#9670;&nbsp;</a></span>svm_check_emulate_instruction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_check_emulate_instruction </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>emul_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>insn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>insn_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04721">4721</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;{</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;    <span class="keywordtype">bool</span> smep, smap, is_user;</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;    u64 error_code;</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160; </div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;    <span class="comment">/* Emulation is always possible when KVM has access to all guest state. */</span></div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="kvm__emulate_8h.html#a591057243ede58e1608aed5cd024e898">X86EMUL_CONTINUE</a>;</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160; </div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;    <span class="comment">/* #UD and #GP should never be intercepted for SEV guests. */</span></div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;    WARN_ON_ONCE(emul_type &amp; (EMULTYPE_TRAP_UD |</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;                  EMULTYPE_TRAP_UD_FORCED |</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;                  EMULTYPE_VMWARE_GP));</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160; </div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;<span class="comment">     * Emulation is impossible for SEV-ES guests as KVM doesn&#39;t have access</span></div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;<span class="comment">     * to guest register state.</span></div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="kvm__emulate_8h.html#afb3a8e077eac126075b2335c89d8d759">X86EMUL_RETRY_INSTR</a>;</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160; </div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;<span class="comment">     * Emulation is possible if the instruction is already decoded, e.g.</span></div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;<span class="comment">     * when completing I/O after returning from userspace.</span></div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;    <span class="keywordflow">if</span> (emul_type &amp; EMULTYPE_NO_DECODE)</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="kvm__emulate_8h.html#a591057243ede58e1608aed5cd024e898">X86EMUL_CONTINUE</a>;</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160; </div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;<span class="comment">     * Emulation is possible for SEV guests if and only if a prefilled</span></div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;<span class="comment">     * buffer containing the bytes of the intercepted instruction is</span></div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;<span class="comment">     * available. SEV guest memory is encrypted with a guest specific key</span></div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;<span class="comment">     * and cannot be decrypted by KVM, i.e. KVM would read ciphertext and</span></div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;<span class="comment">     * decode garbage.</span></div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;<span class="comment">     * If KVM is NOT trying to simply skip an instruction, inject #UD if</span></div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;<span class="comment">     * KVM reached this point without an instruction buffer.  In practice,</span></div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;<span class="comment">     * this path should never be hit by a well-behaved guest, e.g. KVM</span></div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;<span class="comment">     * doesn&#39;t intercept #UD or #GP for SEV guests, but this path is still</span></div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;<span class="comment">     * theoretically reachable, e.g. via unaccelerated fault-like AVIC</span></div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;<span class="comment">     * access, and needs to be handled by KVM to avoid putting the guest</span></div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;<span class="comment">     * into an infinite loop.   Injecting #UD is somewhat arbitrary, but</span></div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;<span class="comment">     * its the least awful option given lack of insight into the guest.</span></div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;<span class="comment">     * If KVM is trying to skip an instruction, simply resume the guest.</span></div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;<span class="comment">     * If a #NPF occurs while the guest is vectoring an INT3/INTO, then KVM</span></div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;<span class="comment">     * will attempt to re-inject the INT3/INTO and skip the instruction.</span></div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;<span class="comment">     * In that scenario, retrying the INT3/INTO and hoping the guest will</span></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;<span class="comment">     * make forward progress is the only option that has a chance of</span></div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;<span class="comment">     * success (and in practice it will work the vast majority of the time).</span></div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;    <span class="keywordflow">if</span> (unlikely(!insn)) {</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;        <span class="keywordflow">if</span> (emul_type &amp; EMULTYPE_SKIP)</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="kvm__emulate_8h.html#a4370bae0613d80c5a2647f57f446a502">X86EMUL_UNHANDLEABLE</a>;</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160; </div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;        <a class="code" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a>(vcpu, UD_VECTOR);</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="kvm__emulate_8h.html#a01c8e91dd24332df561abea456b09a5b">X86EMUL_PROPAGATE_FAULT</a>;</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;    }</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160; </div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;<span class="comment">     * Emulate for SEV guests if the insn buffer is not empty.  The buffer</span></div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;<span class="comment">     * will be empty if the DecodeAssist microcode cannot fetch bytes for</span></div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;<span class="comment">     * the faulting instruction because the code fetch itself faulted, e.g.</span></div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;<span class="comment">     * the guest attempted to fetch from emulated MMIO or a guest page</span></div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;<span class="comment">     * table used to translate CS:RIP resides in emulated MMIO.</span></div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;    <span class="keywordflow">if</span> (likely(insn_len))</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="kvm__emulate_8h.html#a591057243ede58e1608aed5cd024e898">X86EMUL_CONTINUE</a>;</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160; </div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;<span class="comment">     * Detect and workaround Errata 1096 Fam_17h_00_0Fh.</span></div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;<span class="comment">     * Errata:</span></div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;<span class="comment">     * When CPU raises #NPF on guest data access and vCPU CR4.SMAP=1, it is</span></div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;<span class="comment">     * possible that CPU microcode implementing DecodeAssist will fail to</span></div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;<span class="comment">     * read guest memory at CS:RIP and vmcb.GuestIntrBytes will incorrectly</span></div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;<span class="comment">     * be &#39;0&#39;.  This happens because microcode reads CS:RIP using a _data_</span></div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;<span class="comment">     * loap uop with CPL=0 privileges.  If the load hits a SMAP #PF, ucode</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;<span class="comment">     * gives up and does not fill the instruction bytes buffer.</span></div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;<span class="comment">     * As above, KVM reaches this point iff the VM is an SEV guest, the CPU</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;<span class="comment">     * supports DecodeAssist, a #NPF was raised, KVM&#39;s page fault handler</span></div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;<span class="comment">     * triggered emulation (e.g. for MMIO), and the CPU returned 0 in the</span></div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;<span class="comment">     * GuestIntrBytes field of the VMCB.</span></div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;<span class="comment">     * This does _not_ mean that the erratum has been encountered, as the</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;<span class="comment">     * DecodeAssist will also fail if the load for CS:RIP hits a legitimate</span></div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;<span class="comment">     * #PF, e.g. if the guest attempt to execute from emulated MMIO and</span></div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;<span class="comment">     * encountered a reserved/not-present #PF.</span></div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;<span class="comment">     * To hit the erratum, the following conditions must be true:</span></div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;<span class="comment">     *    1. CR4.SMAP=1 (obviously).</span></div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;<span class="comment">     *    2. CR4.SMEP=0 || CPL=3.  If SMEP=1 and CPL&lt;3, the erratum cannot</span></div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;<span class="comment">     *       have been hit as the guest would have encountered a SMEP</span></div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;<span class="comment">     *       violation #PF, not a #NPF.</span></div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;<span class="comment">     *    3. The #NPF is not due to a code fetch, in which case failure to</span></div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;<span class="comment">     *       retrieve the instruction bytes is legitimate (see abvoe).</span></div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;<span class="comment">     * In addition, don&#39;t apply the erratum workaround if the #NPF occurred</span></div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;<span class="comment">     * while translating guest page tables (see below).</span></div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;    error_code = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1;</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;    <span class="keywordflow">if</span> (error_code &amp; (PFERR_GUEST_PAGE_MASK | PFERR_FETCH_MASK))</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;        <span class="keywordflow">goto</span> resume_guest;</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160; </div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;    smep = <a class="code" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65">kvm_is_cr4_bit_set</a>(vcpu, X86_CR4_SMEP);</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;    smap = <a class="code" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65">kvm_is_cr4_bit_set</a>(vcpu, X86_CR4_SMAP);</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;    is_user = <a class="code" href="svm_8c.html#aec9fa4b1df8f24cd52b41eb10cfc0b4d">svm_get_cpl</a>(vcpu) == 3;</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;    <span class="keywordflow">if</span> (smap &amp;&amp; (!smep || is_user)) {</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;        pr_err_ratelimited(<span class="stringliteral">&quot;SEV Guest triggered AMD Erratum 1096\n&quot;</span>);</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160; </div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;<span class="comment">         * If the fault occurred in userspace, arbitrarily inject #GP</span></div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;<span class="comment">         * to avoid killing the guest and to hopefully avoid confusing</span></div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;<span class="comment">         * the guest kernel too much, e.g. injecting #PF would not be</span></div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;<span class="comment">         * coherent with respect to the guest&#39;s page tables.  Request</span></div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;<span class="comment">         * triple fault if the fault occurred in the kernel as there&#39;s</span></div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;<span class="comment">         * no fault that KVM can inject without confusing the guest.</span></div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;<span class="comment">         * In practice, the triple fault is moot as no sane SEV kernel</span></div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;<span class="comment">         * will execute from user memory while also running with SMAP=1.</span></div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;        <span class="keywordflow">if</span> (is_user)</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;            kvm_inject_gp(vcpu, 0);</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;            kvm_make_request(KVM_REQ_TRIPLE_FAULT, vcpu);</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="kvm__emulate_8h.html#a01c8e91dd24332df561abea456b09a5b">X86EMUL_PROPAGATE_FAULT</a>;</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;    }</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160; </div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;resume_guest:</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;<span class="comment">     * If the erratum was not hit, simply resume the guest and let it fault</span></div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;<span class="comment">     * again.  While awful, e.g. the vCPU may get stuck in an infinite loop</span></div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;<span class="comment">     * if the fault is at CPL=0, it&#39;s the lesser of all evils.  Exiting to</span></div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;<span class="comment">     * userspace will kill the guest, and letting the emulator read garbage</span></div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;<span class="comment">     * will yield random behavior and potentially corrupt the guest.</span></div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;<span class="comment">     * Simply resuming the guest is technically not a violation of the SEV</span></div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;<span class="comment">     * architecture.  AMD&#39;s APM states that all code fetches and page table</span></div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;<span class="comment">     * accesses for SEV guest are encrypted, regardless of the C-Bit.  The</span></div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;<span class="comment">     * APM also states that encrypted accesses to MMIO are &quot;ignored&quot;, but</span></div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;<span class="comment">     * doesn&#39;t explicitly define &quot;ignored&quot;, i.e. doing nothing and letting</span></div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;<span class="comment">     * the guest spin is technically &quot;ignoring&quot; the access.</span></div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="kvm__emulate_8h.html#afb3a8e077eac126075b2335c89d8d759">X86EMUL_RETRY_INSTR</a>;</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;}</div>
<div class="ttc" id="akvm__cache__regs_8h_html_a2b779657b20f7afa44c0172b1478ac65"><div class="ttname"><a href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65">kvm_is_cr4_bit_set</a></div><div class="ttdeci">static __always_inline bool kvm_is_cr4_bit_set(struct kvm_vcpu *vcpu, unsigned long cr4_bit)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00182">kvm_cache_regs.h:182</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a01c8e91dd24332df561abea456b09a5b"><div class="ttname"><a href="kvm__emulate_8h.html#a01c8e91dd24332df561abea456b09a5b">X86EMUL_PROPAGATE_FAULT</a></div><div class="ttdeci">#define X86EMUL_PROPAGATE_FAULT</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00085">kvm_emulate.h:85</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a4370bae0613d80c5a2647f57f446a502"><div class="ttname"><a href="kvm__emulate_8h.html#a4370bae0613d80c5a2647f57f446a502">X86EMUL_UNHANDLEABLE</a></div><div class="ttdeci">#define X86EMUL_UNHANDLEABLE</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00083">kvm_emulate.h:83</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a591057243ede58e1608aed5cd024e898"><div class="ttname"><a href="kvm__emulate_8h.html#a591057243ede58e1608aed5cd024e898">X86EMUL_CONTINUE</a></div><div class="ttdeci">#define X86EMUL_CONTINUE</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00081">kvm_emulate.h:81</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_afb3a8e077eac126075b2335c89d8d759"><div class="ttname"><a href="kvm__emulate_8h.html#afb3a8e077eac126075b2335c89d8d759">X86EMUL_RETRY_INSTR</a></div><div class="ttdeci">#define X86EMUL_RETRY_INSTR</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00086">kvm_emulate.h:86</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a28ea9c19442062c9e284d39852ffab26_cgraph.png" border="0" usemap="#asvm_8c_a28ea9c19442062c9e284d39852ffab26_cgraph" alt=""/></div>
<map name="asvm_8c_a28ea9c19442062c9e284d39852ffab26_cgraph" id="asvm_8c_a28ea9c19442062c9e284d39852ffab26_cgraph">
<area shape="rect" title=" " alt="" coords="5,257,237,284"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="297,131,443,157"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="285,181,455,208"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="315,232,425,259"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="326,283,414,309"/>
<area shape="rect" href="svm_8c.html#aec9fa4b1df8f24cd52b41eb10cfc0b4d" title=" " alt="" coords="318,333,422,360"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="559,347,629,373"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="521,119,667,145"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="736,5,929,32"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="503,195,685,221"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="769,56,896,83"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="773,107,893,133"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="745,158,920,199"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="733,224,932,251"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="741,275,925,301"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="748,326,917,367"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="541,271,647,297"/>
</map>
</div>

</div>
</div>
<a id="ad838ad3f2e1e678e2c13720c679dc8f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad838ad3f2e1e678e2c13720c679dc8f8">&#9670;&nbsp;</a></span>svm_check_exit_valid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_check_exit_valid </td>
          <td>(</td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>exit_code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03435">3435</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;{</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="keywordflow">return</span> (exit_code &lt; ARRAY_SIZE(<a class="code" href="svm_8c.html#af73415c5c6c2827a7671c0d2cc5b1c4f">svm_exit_handlers</a>) &amp;&amp;</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;        <a class="code" href="svm_8c.html#af73415c5c6c2827a7671c0d2cc5b1c4f">svm_exit_handlers</a>[exit_code]);</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_af73415c5c6c2827a7671c0d2cc5b1c4f"><div class="ttname"><a href="svm_8c.html#af73415c5c6c2827a7671c0d2cc5b1c4f">svm_exit_handlers</a></div><div class="ttdeci">static int(*const svm_exit_handlers[])(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03238">svm.c:3238</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad838ad3f2e1e678e2c13720c679dc8f8_icgraph.png" border="0" usemap="#asvm_8c_ad838ad3f2e1e678e2c13720c679dc8f8_icgraph" alt=""/></div>
<map name="asvm_8c_ad838ad3f2e1e678e2c13720c679dc8f8_icgraph" id="asvm_8c_ad838ad3f2e1e678e2c13720c679dc8f8_icgraph">
<area shape="rect" title=" " alt="" coords="652,35,819,61"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="416,35,604,61"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="5,5,163,32"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="211,27,368,69"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="223,93,356,120"/>
</map>
</div>

</div>
</div>
<a id="ae135f7d753cde05e6f726fb75e971ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae135f7d753cde05e6f726fb75e971ddd">&#9670;&nbsp;</a></span>svm_check_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_check_intercept </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structx86__instruction__info.html">x86_instruction_info</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="kvm__emulate_8h.html#add7a52f580084c3e63d2d85407ad2611">x86_intercept_stage</a>&#160;</td>
          <td class="paramname"><em>stage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structx86__exception.html">x86_exception</a> *&#160;</td>
          <td class="paramname"><em>exception</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04427">4427</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;{</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;    <span class="keywordtype">int</span> vmexit, ret = <a class="code" href="kvm__emulate_8h.html#a591057243ede58e1608aed5cd024e898">X86EMUL_CONTINUE</a>;</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;    <span class="keyword">struct </span><a class="code" href="struct____x86__intercept.html">__x86_intercept</a> icpt_info;</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>;</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160; </div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;    <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a> &gt;= ARRAY_SIZE(<a class="code" href="svm_8c.html#a5081d9a75e59287f7ae5e120d6ac4758">x86_intercept_map</a>))</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160; </div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;    icpt_info = <a class="code" href="svm_8c.html#a5081d9a75e59287f7ae5e120d6ac4758">x86_intercept_map</a>[info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a>];</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160; </div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;    <span class="keywordflow">if</span> (stage != icpt_info.stage)</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160; </div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;    <span class="keywordflow">switch</span> (icpt_info.exit_code) {</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_READ_CR0:</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;        <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a> == <a class="code" href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712abe6a116dfc63ff19121a7f7a5f48601a">x86_intercept_cr_read</a>)</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;            icpt_info.<a class="code" href="struct____x86__intercept.html#ae0c350d23368fe4bad74903febe29806">exit_code</a> += info-&gt;<a class="code" href="structx86__instruction__info.html#ad0bbba40f72ce3a736405e8795c6dc9d">modrm_reg</a>;</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_WRITE_CR0: {</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> cr0, val;</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160; </div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;        <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a> == <a class="code" href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a73133769f3a7ff98600545b336cd1bea">x86_intercept_cr_write</a>)</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;            icpt_info.exit_code += info-&gt;<a class="code" href="structx86__instruction__info.html#ad0bbba40f72ce3a736405e8795c6dc9d">modrm_reg</a>;</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160; </div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;        <span class="keywordflow">if</span> (icpt_info.exit_code != SVM_EXIT_WRITE_CR0 ||</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;            info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a> == <a class="code" href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a11e45114cd9a3a4b86c803aafd345225">x86_intercept_clts</a>)</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160; </div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>,</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;                    INTERCEPT_SELECTIVE_CR0)))</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160; </div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;        cr0 = vcpu-&gt;arch.cr0 &amp; ~SVM_CR0_SELECTIVE_MASK;</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;        val = info-&gt;<a class="code" href="structx86__instruction__info.html#a05f90a3aeab36e73b06a22333310b7a4">src_val</a>  &amp; ~SVM_CR0_SELECTIVE_MASK;</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160; </div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;        <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a> == <a class="code" href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712af9aed544804a5b09a3b1a20682cadb39">x86_intercept_lmsw</a>) {</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;            cr0 &amp;= 0xfUL;</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;            val &amp;= 0xfUL;</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;            <span class="comment">/* lmsw can&#39;t clear PE - catch this here */</span></div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;            <span class="keywordflow">if</span> (cr0 &amp; X86_CR0_PE)</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;                val |= X86_CR0_PE;</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;        }</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160; </div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;        <span class="keywordflow">if</span> (cr0 ^ val)</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;            icpt_info.exit_code = SVM_EXIT_CR0_SEL_WRITE;</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160; </div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;    }</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_READ_DR0:</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_WRITE_DR0:</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;        icpt_info.exit_code += info-&gt;<a class="code" href="structx86__instruction__info.html#ad0bbba40f72ce3a736405e8795c6dc9d">modrm_reg</a>;</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_MSR:</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;        <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a> == <a class="code" href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a260e7fdbdd94e72033d553cfab5938c5">x86_intercept_wrmsr</a>)</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;            vmcb-&gt;control.exit_info_1 = 1;</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;            vmcb-&gt;control.exit_info_1 = 0;</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_PAUSE:</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;<span class="comment">         * We get this for NOP only, but pause</span></div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;<span class="comment">         * is rep not, check this here</span></div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;        <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structx86__instruction__info.html#a83a830b6b6a44e69528870dfc5601ce1">rep_prefix</a> != <a class="code" href="kvm__emulate_8h.html#a3eaac9f6457a22cd0931c5d1cd9d045a">REPE_PREFIX</a>)</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;            <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_IOIO: {</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;        u64 exit_info;</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;        u32 bytes;</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160; </div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;        <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a> == <a class="code" href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712abce15d1162b3a83a521fe97adf866236">x86_intercept_in</a> ||</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;            info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a> == <a class="code" href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a075bc638ff281340cfcb97551dad98c1">x86_intercept_ins</a>) {</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;            exit_info = ((info-&gt;<a class="code" href="structx86__instruction__info.html#a05f90a3aeab36e73b06a22333310b7a4">src_val</a> &amp; 0xffff) &lt;&lt; 16) |</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;                SVM_IOIO_TYPE_MASK;</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;            bytes = info-&gt;<a class="code" href="structx86__instruction__info.html#a31ed8715176e86683e335bdd7951d602">dst_bytes</a>;</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;            exit_info = (info-&gt;<a class="code" href="structx86__instruction__info.html#a917f79d671867a97157706d651b1444e">dst_val</a> &amp; 0xffff) &lt;&lt; 16;</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;            bytes = info-&gt;<a class="code" href="structx86__instruction__info.html#a42a9cdda15216ce5ad0d3e77ae19a1da">src_bytes</a>;</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;        }</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160; </div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;        <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a> == <a class="code" href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a99dddcbf279950c8ba9826d79ee01f36">x86_intercept_outs</a> ||</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;            info-&gt;<a class="code" href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">intercept</a> == <a class="code" href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a075bc638ff281340cfcb97551dad98c1">x86_intercept_ins</a>)</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;            exit_info |= SVM_IOIO_STR_MASK;</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160; </div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;        <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structx86__instruction__info.html#a83a830b6b6a44e69528870dfc5601ce1">rep_prefix</a>)</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;            exit_info |= SVM_IOIO_REP_MASK;</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160; </div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;        bytes = min(bytes, 4u);</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160; </div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;        exit_info |= bytes &lt;&lt; SVM_IOIO_SIZE_SHIFT;</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160; </div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;        exit_info |= (u32)info-&gt;<a class="code" href="structx86__instruction__info.html#a789d943c83721742edc2ff846fdeb9a0">ad_bytes</a> &lt;&lt; (SVM_IOIO_ASIZE_SHIFT - 1);</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160; </div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;        vmcb-&gt;control.exit_info_1 = exit_info;</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;        vmcb-&gt;control.exit_info_2 = info-&gt;<a class="code" href="structx86__instruction__info.html#a98e44c516d18f38c936b924fff1d19b6">next_rip</a>;</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160; </div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;    }</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;    }</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160; </div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;    <span class="comment">/* TODO: Advertise NRIPS to guest hypervisor unconditionally */</span></div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;    <span class="keywordflow">if</span> (static_cpu_has(X86_FEATURE_NRIPS))</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;        vmcb-&gt;control.next_rip  = info-&gt;<a class="code" href="structx86__instruction__info.html#a98e44c516d18f38c936b924fff1d19b6">next_rip</a>;</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;    vmcb-&gt;control.exit_code = icpt_info.exit_code;</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;    vmexit = <a class="code" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6">nested_svm_exit_handled</a>(svm);</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160; </div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;    ret = (vmexit == <a class="code" href="svm_8h.html#a9c953f5ab9b400e9a1c5232515ec6293">NESTED_EXIT_DONE</a>) ? <a class="code" href="kvm__emulate_8h.html#a88fe9879c167f4e0e99729c7f162a407">X86EMUL_INTERCEPTED</a></div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;                       : <a class="code" href="kvm__emulate_8h.html#a591057243ede58e1608aed5cd024e898">X86EMUL_CONTINUE</a>;</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160; </div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;out:</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;}</div>
<div class="ttc" id="akvm__emulate_8h_html_a11eed4ab8accda0089eca13cc8782712a075bc638ff281340cfcb97551dad98c1"><div class="ttname"><a href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a075bc638ff281340cfcb97551dad98c1">x86_intercept_ins</a></div><div class="ttdeci">@ x86_intercept_ins</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00488">kvm_emulate.h:488</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a11eed4ab8accda0089eca13cc8782712a11e45114cd9a3a4b86c803aafd345225"><div class="ttname"><a href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a11e45114cd9a3a4b86c803aafd345225">x86_intercept_clts</a></div><div class="ttdeci">@ x86_intercept_clts</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00446">kvm_emulate.h:446</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a11eed4ab8accda0089eca13cc8782712a260e7fdbdd94e72033d553cfab5938c5"><div class="ttname"><a href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a260e7fdbdd94e72033d553cfab5938c5">x86_intercept_wrmsr</a></div><div class="ttdeci">@ x86_intercept_wrmsr</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00486">kvm_emulate.h:486</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a11eed4ab8accda0089eca13cc8782712a73133769f3a7ff98600545b336cd1bea"><div class="ttname"><a href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a73133769f3a7ff98600545b336cd1bea">x86_intercept_cr_write</a></div><div class="ttdeci">@ x86_intercept_cr_write</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00445">kvm_emulate.h:445</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a11eed4ab8accda0089eca13cc8782712a99dddcbf279950c8ba9826d79ee01f36"><div class="ttname"><a href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712a99dddcbf279950c8ba9826d79ee01f36">x86_intercept_outs</a></div><div class="ttdeci">@ x86_intercept_outs</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00490">kvm_emulate.h:490</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a11eed4ab8accda0089eca13cc8782712abce15d1162b3a83a521fe97adf866236"><div class="ttname"><a href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712abce15d1162b3a83a521fe97adf866236">x86_intercept_in</a></div><div class="ttdeci">@ x86_intercept_in</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00487">kvm_emulate.h:487</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a11eed4ab8accda0089eca13cc8782712abe6a116dfc63ff19121a7f7a5f48601a"><div class="ttname"><a href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712abe6a116dfc63ff19121a7f7a5f48601a">x86_intercept_cr_read</a></div><div class="ttdeci">@ x86_intercept_cr_read</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00444">kvm_emulate.h:444</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a11eed4ab8accda0089eca13cc8782712af9aed544804a5b09a3b1a20682cadb39"><div class="ttname"><a href="kvm__emulate_8h.html#a11eed4ab8accda0089eca13cc8782712af9aed544804a5b09a3b1a20682cadb39">x86_intercept_lmsw</a></div><div class="ttdeci">@ x86_intercept_lmsw</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00447">kvm_emulate.h:447</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a3eaac9f6457a22cd0931c5d1cd9d045a"><div class="ttname"><a href="kvm__emulate_8h.html#a3eaac9f6457a22cd0931c5d1cd9d045a">REPE_PREFIX</a></div><div class="ttdeci">#define REPE_PREFIX</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00387">kvm_emulate.h:387</a></div></div>
<div class="ttc" id="akvm__emulate_8h_html_a88fe9879c167f4e0e99729c7f162a407"><div class="ttname"><a href="kvm__emulate_8h.html#a88fe9879c167f4e0e99729c7f162a407">X86EMUL_INTERCEPTED</a></div><div class="ttdeci">#define X86EMUL_INTERCEPTED</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00089">kvm_emulate.h:89</a></div></div>
<div class="ttc" id="astruct____x86__intercept_html"><div class="ttname"><a href="struct____x86__intercept.html">__x86_intercept</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l04370">svm.c:4370</a></div></div>
<div class="ttc" id="astruct____x86__intercept_html_ae0c350d23368fe4bad74903febe29806"><div class="ttname"><a href="struct____x86__intercept.html#ae0c350d23368fe4bad74903febe29806">__x86_intercept::exit_code</a></div><div class="ttdeci">u32 exit_code</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l04371">svm.c:4371</a></div></div>
<div class="ttc" id="astructx86__instruction__info_html_a05f90a3aeab36e73b06a22333310b7a4"><div class="ttname"><a href="structx86__instruction__info.html#a05f90a3aeab36e73b06a22333310b7a4">x86_instruction_info::src_val</a></div><div class="ttdeci">u64 src_val</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00042">kvm_emulate.h:42</a></div></div>
<div class="ttc" id="astructx86__instruction__info_html_a31ed8715176e86683e335bdd7951d602"><div class="ttname"><a href="structx86__instruction__info.html#a31ed8715176e86683e335bdd7951d602">x86_instruction_info::dst_bytes</a></div><div class="ttdeci">u8 dst_bytes</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00045">kvm_emulate.h:45</a></div></div>
<div class="ttc" id="astructx86__instruction__info_html_a38dd76f0f668a718fa79740a493213e0"><div class="ttname"><a href="structx86__instruction__info.html#a38dd76f0f668a718fa79740a493213e0">x86_instruction_info::intercept</a></div><div class="ttdeci">u8 intercept</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00037">kvm_emulate.h:37</a></div></div>
<div class="ttc" id="astructx86__instruction__info_html_a42a9cdda15216ce5ad0d3e77ae19a1da"><div class="ttname"><a href="structx86__instruction__info.html#a42a9cdda15216ce5ad0d3e77ae19a1da">x86_instruction_info::src_bytes</a></div><div class="ttdeci">u8 src_bytes</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00044">kvm_emulate.h:44</a></div></div>
<div class="ttc" id="astructx86__instruction__info_html_a789d943c83721742edc2ff846fdeb9a0"><div class="ttname"><a href="structx86__instruction__info.html#a789d943c83721742edc2ff846fdeb9a0">x86_instruction_info::ad_bytes</a></div><div class="ttdeci">u8 ad_bytes</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00046">kvm_emulate.h:46</a></div></div>
<div class="ttc" id="astructx86__instruction__info_html_a83a830b6b6a44e69528870dfc5601ce1"><div class="ttname"><a href="structx86__instruction__info.html#a83a830b6b6a44e69528870dfc5601ce1">x86_instruction_info::rep_prefix</a></div><div class="ttdeci">u8 rep_prefix</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00038">kvm_emulate.h:38</a></div></div>
<div class="ttc" id="astructx86__instruction__info_html_a917f79d671867a97157706d651b1444e"><div class="ttname"><a href="structx86__instruction__info.html#a917f79d671867a97157706d651b1444e">x86_instruction_info::dst_val</a></div><div class="ttdeci">u64 dst_val</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00043">kvm_emulate.h:43</a></div></div>
<div class="ttc" id="astructx86__instruction__info_html_a98e44c516d18f38c936b924fff1d19b6"><div class="ttname"><a href="structx86__instruction__info.html#a98e44c516d18f38c936b924fff1d19b6">x86_instruction_info::next_rip</a></div><div class="ttdeci">u64 next_rip</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00047">kvm_emulate.h:47</a></div></div>
<div class="ttc" id="astructx86__instruction__info_html_ad0bbba40f72ce3a736405e8795c6dc9d"><div class="ttname"><a href="structx86__instruction__info.html#ad0bbba40f72ce3a736405e8795c6dc9d">x86_instruction_info::modrm_reg</a></div><div class="ttdeci">u8 modrm_reg</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00040">kvm_emulate.h:40</a></div></div>
<div class="ttc" id="asvm_8c_html_a5081d9a75e59287f7ae5e120d6ac4758"><div class="ttname"><a href="svm_8c.html#a5081d9a75e59287f7ae5e120d6ac4758">x86_intercept_map</a></div><div class="ttdeci">static const struct __x86_intercept x86_intercept_map[]</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ae135f7d753cde05e6f726fb75e971ddd_cgraph.png" border="0" usemap="#asvm_8c_ae135f7d753cde05e6f726fb75e971ddd_cgraph" alt=""/></div>
<map name="asvm_8c_ae135f7d753cde05e6f726fb75e971ddd_cgraph" id="asvm_8c_ae135f7d753cde05e6f726fb75e971ddd_cgraph">
<area shape="rect" title=" " alt="" coords="5,629,165,656"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="213,629,405,656"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="961,107,1118,133"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1247,1645,1317,1672"/>
<area shape="rect" href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba" title=" " alt="" coords="453,81,620,108"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="459,1049,614,1076"/>
<area shape="rect" href="svm_2nested_8c.html#a90464b57b273a88a7a1fb3c2cefb257a" title=" " alt="" coords="668,5,892,32"/>
<area shape="rect" href="svm_2nested_8c.html#ac11321f5c485c6fd9804b75a6b405f64" title=" " alt="" coords="681,56,879,83"/>
<area shape="rect" href="kvm__main_8c.html#ae63a6f386d39aff5ffc5645780018b7a" title=" " alt="" coords="955,56,1123,83"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="966,5,1113,32"/>
<area shape="rect" href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73" title=" " alt="" coords="681,1769,879,1796"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="980,335,1099,361"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="699,512,861,539"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="699,563,861,605"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="703,629,857,670"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="719,695,841,721"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="701,745,859,772"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="695,796,865,823"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="723,847,837,873"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="723,897,837,924"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="725,948,835,975"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="723,999,837,1025"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a30f9ca7e6fd08d1cf123f57fbfba01c7" title=" " alt="" coords="723,1049,837,1076"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633" title=" " alt="" coords="721,1100,839,1127"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="719,1151,841,1177"/>
<area shape="rect" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a" title=" " alt="" coords="715,1201,845,1228"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="717,1252,843,1279"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="709,1303,851,1329"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="707,1353,853,1380"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="705,208,855,235"/>
<area shape="rect" href="svm_2nested_8c.html#a5b731f64682240fd51bd242f194b33f4" title=" " alt="" coords="699,1455,861,1497"/>
<area shape="rect" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f" title=" " alt="" coords="679,1521,881,1562"/>
<area shape="rect" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab" title=" " alt="" coords="699,1587,861,1613"/>
<area shape="rect" href="svm_2nested_8c.html#af381358fd9991ce7d26d81fdb9f763a9" title=" " alt="" coords="695,1638,865,1679"/>
<area shape="rect" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53" title=" " alt="" coords="687,1703,873,1745"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="980,2023,1099,2049"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1214,1921,1350,1948"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="728,1871,832,1897"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="987,1820,1091,1847"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="725,1404,835,1431"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="989,1372,1090,1399"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="709,259,851,285"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="713,360,847,387"/>
<area shape="rect" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943" title=" " alt="" coords="946,1104,1133,1131"/>
<area shape="rect" href="lapic_8c.html#a5468339c2df08ca538b77d4d48915c35" title=" " alt="" coords="950,1668,1129,1695"/>
<area shape="rect" href="x86_8c.html#a8415cd1d2d30e65d505adb5ba75a0338" title=" " alt="" coords="961,1719,1118,1745"/>
<area shape="rect" href="x86_8c.html#ade52ab1bf2b3d66def1c4851fab08c45" title=" " alt="" coords="940,1769,1139,1796"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="980,1617,1099,1644"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1425,327,1599,369"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1187,360,1377,387"/>
</map>
</div>

</div>
</div>
<a id="ad903be303ec3da29f6f41d563d9cef80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad903be303ec3da29f6f41d563d9cef80">&#9670;&nbsp;</a></span>svm_check_processor_compat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_check_processor_compat </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00555">555</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;{</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a0c5962ecf16b873fd88c7d6664ea7f0c">__kvm_is_svm_supported</a>())</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad903be303ec3da29f6f41d563d9cef80_cgraph.png" border="0" usemap="#asvm_8c_ad903be303ec3da29f6f41d563d9cef80_cgraph" alt=""/></div>
<map name="asvm_8c_ad903be303ec3da29f6f41d563d9cef80_cgraph" id="asvm_8c_ad903be303ec3da29f6f41d563d9cef80_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,171,47"/>
<area shape="rect" href="svm_8c.html#a0c5962ecf16b873fd88c7d6664ea7f0c" title=" " alt="" coords="219,13,409,39"/>
</map>
</div>

</div>
</div>
<a id="a31c1032c7d7d9373379ac998c0a05805"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31c1032c7d7d9373379ac998c0a05805">&#9670;&nbsp;</a></span>svm_clear_current_vmcb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_clear_current_vmcb </td>
          <td>(</td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>vmcb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01478">1478</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;{</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    for_each_online_cpu(i)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        cmpxchg(per_cpu_ptr(&amp;svm_data.current_vmcb, i), vmcb, NULL);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a31c1032c7d7d9373379ac998c0a05805_icgraph.png" border="0" usemap="#asvm_8c_a31c1032c7d7d9373379ac998c0a05805_icgraph" alt=""/></div>
<map name="asvm_8c_a31c1032c7d7d9373379ac998c0a05805_icgraph" id="asvm_8c_a31c1032c7d7d9373379ac998c0a05805_icgraph">
<area shape="rect" title=" " alt="" coords="175,5,360,32"/>
<area shape="rect" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4" title=" " alt="" coords="5,5,127,32"/>
</map>
</div>

</div>
</div>
<a id="aea540cc79e685f3a2eebfa4226b63403"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea540cc79e685f3a2eebfa4226b63403">&#9670;&nbsp;</a></span>svm_clear_vintr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_clear_vintr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01663">1663</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;{</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_VINTR);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="comment">/* Drop int_ctl fields related to VINTR injection.  */</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl &amp;= ~V_IRQ_INJECTION_BITS_MASK;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>)) {</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;control.int_ctl &amp;= ~V_IRQ_INJECTION_BITS_MASK;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        WARN_ON((svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl &amp; V_TPR_MASK) !=</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp; V_TPR_MASK));</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl |= svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            V_IRQ_INJECTION_BITS_MASK;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_vector = svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#ab068abfea412a5ea88785570f3fab554">int_vector</a>;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    }</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160; </div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a>);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;}</div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a2c5d9afb37c1ab54586cdcf478b417c2"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">vmcb_ctrl_area_cached::int_ctl</a></div><div class="ttdeci">u32 int_ctl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00134">svm.h:134</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_ab068abfea412a5ea88785570f3fab554"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#ab068abfea412a5ea88785570f3fab554">vmcb_ctrl_area_cached::int_vector</a></div><div class="ttdeci">u32 int_vector</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00135">svm.h:135</a></div></div>
<div class="ttc" id="asvm_8h_html_aaf8fd5f0e57d456151c951e0f3715fc4a47e03f1935e6feea250cf3d13fa4c71e"><div class="ttname"><a href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a></div><div class="ttdeci">@ VMCB_INTR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00053">svm.h:53</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aea540cc79e685f3a2eebfa4226b63403_cgraph.png" border="0" usemap="#asvm_8c_aea540cc79e685f3a2eebfa4226b63403_cgraph" alt=""/></div>
<map name="asvm_8c_aea540cc79e685f3a2eebfa4226b63403_cgraph" id="asvm_8c_aea540cc79e685f3a2eebfa4226b63403_cgraph">
<area shape="rect" title=" " alt="" coords="5,213,132,240"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="579,5,699,32"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="180,213,319,240"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="571,289,707,316"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="367,188,500,215"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="566,239,713,265"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="548,57,731,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="549,122,730,163"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="564,188,715,215"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="796,104,915,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="779,155,932,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1219,97,1392,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="980,129,1171,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aea540cc79e685f3a2eebfa4226b63403_icgraph.png" border="0" usemap="#asvm_8c_aea540cc79e685f3a2eebfa4226b63403_icgraph" alt=""/></div>
<map name="asvm_8c_aea540cc79e685f3a2eebfa4226b63403_icgraph" id="asvm_8c_aea540cc79e685f3a2eebfa4226b63403_icgraph">
<area shape="rect" title=" " alt="" coords="2479,388,2605,415"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="2211,200,2431,227"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="2270,413,2371,440"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="1975,67,2163,93"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="1535,8,1693,35"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="1769,30,1927,71"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,77,1427,104"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="2003,464,2134,491"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,333,945,360"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1771,413,1925,440"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,580,940,607"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="2003,697,2134,724"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2013,363,2124,389"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,413,719,440"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,413,520,440"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,439,323,465"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,439,128,465"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,165,1710,192"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,515,1721,557"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,308,1716,335"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,464,1717,491"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,581,1705,622"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,129,1437,170"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,195,1440,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,136,1163,163"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,136,939,163"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,565,1459,592"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,297,1445,338"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,297,1195,338"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,515,1449,541"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,363,1213,389"/>
</map>
</div>

</div>
</div>
<a id="aff900c45df2faa151d783155ec034f86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff900c45df2faa151d783155ec034f86">&#9670;&nbsp;</a></span>svm_clr_iret_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_clr_iret_intercept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02554">2554</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;{</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.kvm))</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_IRET);</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aff900c45df2faa151d783155ec034f86_cgraph.png" border="0" usemap="#asvm_8c_aff900c45df2faa151d783155ec034f86_cgraph" alt=""/></div>
<map name="asvm_8c_aff900c45df2faa151d783155ec034f86_cgraph" id="asvm_8c_aff900c45df2faa151d783155ec034f86_cgraph">
<area shape="rect" title=" " alt="" coords="5,163,172,189"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="234,137,345,164"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="220,188,359,215"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="420,137,527,164"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="407,188,540,215"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="606,289,753,316"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="619,5,739,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="588,57,771,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="589,122,770,163"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="611,188,747,215"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="604,239,755,265"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="836,104,955,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="819,155,972,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1259,97,1432,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1020,129,1211,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aff900c45df2faa151d783155ec034f86_icgraph.png" border="0" usemap="#asvm_8c_aff900c45df2faa151d783155ec034f86_icgraph" alt=""/></div>
<map name="asvm_8c_aff900c45df2faa151d783155ec034f86_icgraph" id="asvm_8c_aff900c45df2faa151d783155ec034f86_icgraph">
<area shape="rect" title=" " alt="" coords="205,31,372,57"/>
<area shape="rect" href="svm_8c.html#aaa5bf4dc91985f4c533268b7e4ca811d" title=" " alt="" coords="17,5,146,32"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="5,56,157,83"/>
</map>
</div>

</div>
</div>
<a id="a90bdbebaa7d7557c12b54b7f969bc777"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90bdbebaa7d7557c12b54b7f969bc777">&#9670;&nbsp;</a></span>svm_complete_emulated_msr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_complete_emulated_msr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02934">2934</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;{</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <span class="keywordflow">if</span> (!err || !<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm) || WARN_ON_ONCE(!svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>))</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42">kvm_complete_insn_gp</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, err);</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160; </div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    ghcb_set_sw_exit_info_1(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>, 1);</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    ghcb_set_sw_exit_info_2(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>,</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                X86_TRAP_GP |</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                SVM_EVTINJ_TYPE_EXEPT |</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                SVM_EVTINJ_VALID);</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;}</div>
<div class="ttc" id="astructvcpu__sev__es__state_html_abb6b1331553e74269e36bf08c13b710c"><div class="ttname"><a href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">vcpu_sev_es_state::ghcb</a></div><div class="ttdeci">struct ghcb * ghcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00196">svm.h:196</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_aaaac2e4809a87c7130fd4d8e146b8cc2"><div class="ttname"><a href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">vcpu_svm::sev_es</a></div><div class="ttdeci">struct vcpu_sev_es_state sev_es</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00279">svm.h:287</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a90bdbebaa7d7557c12b54b7f969bc777_cgraph.png" border="0" usemap="#asvm_8c_a90bdbebaa7d7557c12b54b7f969bc777_cgraph" alt=""/></div>
<map name="asvm_8c_a90bdbebaa7d7557c12b54b7f969bc777_cgraph" id="asvm_8c_a90bdbebaa7d7557c12b54b7f969bc777_cgraph">
<area shape="rect" title=" " alt="" coords="5,275,224,301"/>
<area shape="rect" href="x86_8c.html#ab726ff4c508ed9b0c2826d532af24e42" title=" " alt="" coords="272,224,448,251"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="305,275,415,301"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="325,325,395,352"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="496,224,727,251"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="777,123,959,149"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="775,325,961,352"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1040,5,1163,32"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1022,57,1181,98"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1014,123,1189,149"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1016,173,1187,200"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="1555,13,1646,40"/>
<area shape="rect" href="pmu_8h.html#abbf4b99efff2cdd22398e2992085c36f" title=" " alt="" coords="1241,57,1440,98"/>
<area shape="rect" href="pmu_8c.html#af08b63fb7910be3ee65e8036b4e48aad" title=" " alt="" coords="1252,123,1429,149"/>
<area shape="rect" href="pmu_8h.html#a156ede05e2f3b40ccf7a68f471f574b2" title=" " alt="" coords="1247,173,1434,200"/>
<area shape="rect" href="pmu_8h.html#a276700643eefb3c6911a7ae0dc0e3809" title=" " alt="" coords="1250,224,1431,251"/>
<area shape="rect" href="pmu_8c.html#aa6928ea92eba53de872c3bd3e966c3c6" title=" " alt="" coords="1514,72,1687,99"/>
<area shape="rect" href="pmu_8c.html#a6407f24f826977c89137761aae28662a" title=" " alt="" coords="1521,123,1680,149"/>
<area shape="rect" href="pmu_8c.html#a7dbc4f0e4caa09f8aeb319f991e2c69f" title=" " alt="" coords="1777,123,1939,149"/>
<area shape="rect" href="pmu_8c.html#ac4adcf0013fcc455189fe088174040a5" title=" " alt="" coords="2209,97,2340,124"/>
<area shape="rect" href="pmu_8c.html#a9c8de681910157a36451cebc31149dff" title=" " alt="" coords="2019,123,2145,149"/>
<area shape="rect" href="pmu_8c.html#a27436377a7d8effa003c7dcc6d63e0b9" title=" " alt="" coords="2003,173,2161,200"/>
<area shape="rect" href="pmu_8c.html#ab2f6db97a2dac78800c74becd388bc90" title=" " alt="" coords="2388,97,2475,124"/>
<area shape="rect" href="pmu_8h.html#ad8246d56b5d561e26e120ebcc9f2c2e7" title=" " alt="" coords="1488,173,1713,200"/>
<area shape="rect" href="pmu_8h.html#a121f90ace23861db2f644f0b36a08be6" title=" " alt="" coords="1547,224,1654,251"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1028,325,1175,352"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="1009,456,1193,483"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="1268,275,1413,301"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1279,325,1403,352"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1285,376,1396,403"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="1545,325,1657,352"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1513,376,1688,403"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1761,376,1955,403"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1249,565,1432,592"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="1537,427,1664,453"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1541,477,1661,504"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="1513,529,1688,570"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="1501,595,1700,621"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1509,645,1693,672"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="1516,697,1685,738"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="558,275,665,301"/>
</map>
</div>

</div>
</div>
<a id="a1faf261e116f9d9481e1bd6796e32280"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1faf261e116f9d9481e1bd6796e32280">&#9670;&nbsp;</a></span>svm_complete_interrupt_delivery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_complete_interrupt_delivery </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>delivery_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trig_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03633">3633</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;{</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;<span class="comment">     * apic-&gt;apicv_active must be read after vcpu-&gt;mode.</span></div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;<span class="comment">     * Pairs with smp_store_release in vcpu_enter_guest.</span></div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    <span class="keywordtype">bool</span> in_guest_mode = (smp_load_acquire(&amp;vcpu-&gt;mode) == IN_GUEST_MODE);</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160; </div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    <span class="comment">/* Note, this is called iff the local APIC is in-kernel. */</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;    <span class="keywordflow">if</span> (!READ_ONCE(vcpu-&gt;arch.apic-&gt;apicv_active)) {</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;        <span class="comment">/* Process the interrupt via kvm_check_and_inject_events(). */</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;        kvm_make_request(KVM_REQ_EVENT, vcpu);</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;        <a class="code" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44">kvm_vcpu_kick</a>(vcpu);</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    }</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160; </div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    trace_kvm_apicv_accept_irq(vcpu-&gt;vcpu_id, delivery_mode, trig_mode, vector);</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    <span class="keywordflow">if</span> (in_guest_mode) {</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;<span class="comment">         * Signal the doorbell to tell hardware to inject the IRQ.  If</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;<span class="comment">         * the vCPU exits the guest before the doorbell chimes, hardware</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;<span class="comment">         * will automatically process AVIC interrupts at the next VMRUN.</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;        <a class="code" href="avic_8c.html#ac8c9ded2546dccf6e4b561e633d22e7e">avic_ring_doorbell</a>(vcpu);</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;<span class="comment">         * Wake the vCPU if it was blocking.  KVM will then detect the</span></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;<span class="comment">         * pending IRQ when checking if the vCPU has a wake event.</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;        <a class="code" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5">kvm_vcpu_wake_up</a>(vcpu);</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;    }</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_ac8c9ded2546dccf6e4b561e633d22e7e"><div class="ttname"><a href="avic_8c.html#ac8c9ded2546dccf6e4b561e633d22e7e">avic_ring_doorbell</a></div><div class="ttdeci">void avic_ring_doorbell(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00321">avic.c:321</a></div></div>
<div class="ttc" id="akvm__main_8c_html_ac82f28c95da4a0cc137c5a37f08d1f44"><div class="ttname"><a href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44">kvm_vcpu_kick</a></div><div class="ttdeci">void kvm_vcpu_kick(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l03931">kvm_main.c:3931</a></div></div>
<div class="ttc" id="akvm__main_8c_html_ad9f0140eebcdef9a9ebae54431d2fba5"><div class="ttname"><a href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5">kvm_vcpu_wake_up</a></div><div class="ttdeci">bool kvm_vcpu_wake_up(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l03915">kvm_main.c:3915</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1faf261e116f9d9481e1bd6796e32280_cgraph.png" border="0" usemap="#asvm_8c_a1faf261e116f9d9481e1bd6796e32280_cgraph" alt=""/></div>
<map name="asvm_8c_a1faf261e116f9d9481e1bd6796e32280_cgraph" id="asvm_8c_a1faf261e116f9d9481e1bd6796e32280_cgraph">
<area shape="rect" title=" " alt="" coords="5,49,187,90"/>
<area shape="rect" href="avic_8c.html#ac8c9ded2546dccf6e4b561e633d22e7e" title=" " alt="" coords="235,5,376,32"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="244,56,367,83"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="451,107,605,133"/>
<area shape="rect" href="x86_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="424,56,632,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1faf261e116f9d9481e1bd6796e32280_icgraph.png" border="0" usemap="#asvm_8c_a1faf261e116f9d9481e1bd6796e32280_icgraph" alt=""/></div>
<map name="asvm_8c_a1faf261e116f9d9481e1bd6796e32280_icgraph" id="asvm_8c_a1faf261e116f9d9481e1bd6796e32280_icgraph">
<area shape="rect" title=" " alt="" coords="1429,31,1611,72"/>
<area shape="rect" href="avic_8c.html#a2b9e298755a0d51bb5b2dfc9dd254c64" title=" " alt="" coords="1238,13,1359,39"/>
<area shape="rect" href="svm_8c.html#a501d86bb28fd272f1ab52b8689b5f948" title=" " alt="" coords="1216,63,1381,90"/>
<area shape="rect" href="avic_8c.html#ad9345a779111a59de8fa4110106c3adf" title=" " alt="" coords="205,13,380,39"/>
<area shape="rect" href="avic_8c.html#a4b900d047f49b6cd00266aba3f4912bf" title=" " alt="" coords="944,38,1168,65"/>
<area shape="rect" href="avic_8c.html#a4a11c0014568405b90307ef68285e4ff" title=" " alt="" coords="5,5,157,47"/>
<area shape="rect" href="avic_8c.html#a7cf9fdcdf4f5f6559c099faaab0c2d29" title=" " alt="" coords="428,38,635,65"/>
<area shape="rect" href="avic_8c.html#a1404df5f813565dd104640a6e5bfea67" title=" " alt="" coords="683,89,896,115"/>
</map>
</div>

</div>
</div>
<a id="a921858ef8782f6b0eebb284c5db66de8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a921858ef8782f6b0eebb284c5db66de8">&#9670;&nbsp;</a></span>svm_complete_interrupts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_complete_interrupts </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04008">4008</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;{</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    u8 vector;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <span class="keywordtype">int</span> type;</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;    u32 exitintinfo = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_int_info;</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">nmi_l1_to_l2</a> = svm-&gt;<a class="code" href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">nmi_l1_to_l2</a>;</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">soft_int_injected</a> = svm-&gt;<a class="code" href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">soft_int_injected</a>;</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160; </div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">nmi_l1_to_l2</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">soft_int_injected</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160; </div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;<span class="comment">     * If we&#39;ve made progress since setting awaiting_iret_completion, we&#39;ve</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;<span class="comment">     * executed an IRET and can allow NMI injection.</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#ae94a883f2e559703aaa7b93d14a3810a">awaiting_iret_completion</a> &amp;&amp;</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;        <a class="code" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446">kvm_rip_read</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) != svm-&gt;<a class="code" href="structvcpu__svm.html#a6fafc7c88cd9fcf600c03b6a74e9124a">nmi_iret_rip</a>) {</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#ae94a883f2e559703aaa7b93d14a3810a">awaiting_iret_completion</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">nmi_masked</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;        kvm_make_request(KVM_REQ_EVENT, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    }</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160; </div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.nmi_injected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;    <a class="code" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4">kvm_clear_exception_queue</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;    <a class="code" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160">kvm_clear_interrupt_queue</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160; </div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;    <span class="keywordflow">if</span> (!(exitintinfo &amp; SVM_EXITINTINFO_VALID))</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160; </div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;    kvm_make_request(KVM_REQ_EVENT, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160; </div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;    vector = exitintinfo &amp; SVM_EXITINTINFO_VEC_MASK;</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    type = exitintinfo &amp; SVM_EXITINTINFO_TYPE_MASK;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160; </div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">soft_int_injected</a>)</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;        <a class="code" href="svm_8c.html#adf1eccfcab9b8a4c710b30fec219fe14">svm_complete_soft_interrupt</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, vector, type);</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160; </div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;    <span class="keywordflow">case</span> SVM_EXITINTINFO_TYPE_NMI:</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;        <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.nmi_injected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">nmi_l1_to_l2</a> = <a class="code" href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">nmi_l1_to_l2</a>;</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <span class="keywordflow">case</span> SVM_EXITINTINFO_TYPE_EXEPT:</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;<span class="comment">         * Never re-inject a #VC exception.</span></div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;        <span class="keywordflow">if</span> (vector == X86_TRAP_VC)</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160; </div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;        <span class="keywordflow">if</span> (exitintinfo &amp; SVM_EXITINTINFO_VALID_ERR) {</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;            u32 err = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_int_info_err;</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;            <a class="code" href="x86_8c.html#a0d7f1c47245e95be49d8925ca92b8365">kvm_requeue_exception_e</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, vector, err);</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160; </div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;        } <span class="keywordflow">else</span></div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;            <a class="code" href="x86_8c.html#a7afcfddd2ea5cf31a22813c76d9747c2">kvm_requeue_exception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, vector);</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;    <span class="keywordflow">case</span> SVM_EXITINTINFO_TYPE_INTR:</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        <a class="code" href="x86_8h.html#aaa166361b58ce8e326699e6cfe87e39a">kvm_queue_interrupt</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, vector, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;    <span class="keywordflow">case</span> SVM_EXITINTINFO_TYPE_SOFT:</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;        <a class="code" href="x86_8h.html#aaa166361b58ce8e326699e6cfe87e39a">kvm_queue_interrupt</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, vector, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    }</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160; </div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_a5b467b57f59ac934189a11051dc5ac6d"><div class="ttname"><a href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">vcpu_svm::nmi_l1_to_l2</a></div><div class="ttdeci">bool nmi_l1_to_l2</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00260">svm.h:260</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a7de61a9710589d6f3c286663fc51506e"><div class="ttname"><a href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">vcpu_svm::soft_int_injected</a></div><div class="ttdeci">bool soft_int_injected</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00265">svm.h:265</a></div></div>
<div class="ttc" id="asvm_8c_html_adf1eccfcab9b8a4c710b30fec219fe14"><div class="ttname"><a href="svm_8c.html#adf1eccfcab9b8a4c710b30fec219fe14">svm_complete_soft_interrupt</a></div><div class="ttdeci">static void svm_complete_soft_interrupt(struct kvm_vcpu *vcpu, u8 vector, int type)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03976">svm.c:3976</a></div></div>
<div class="ttc" id="ax86_8c_html_a0d7f1c47245e95be49d8925ca92b8365"><div class="ttname"><a href="x86_8c.html#a0d7f1c47245e95be49d8925ca92b8365">kvm_requeue_exception_e</a></div><div class="ttdeci">void kvm_requeue_exception_e(struct kvm_vcpu *vcpu, unsigned nr, u32 error_code)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00830">x86.c:830</a></div></div>
<div class="ttc" id="ax86_8c_html_a7afcfddd2ea5cf31a22813c76d9747c2"><div class="ttname"><a href="x86_8c.html#a7afcfddd2ea5cf31a22813c76d9747c2">kvm_requeue_exception</a></div><div class="ttdeci">void kvm_requeue_exception(struct kvm_vcpu *vcpu, unsigned nr)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00737">x86.c:737</a></div></div>
<div class="ttc" id="ax86_8h_html_a9dbf3d5bc7a0735443e0e21e00802160"><div class="ttname"><a href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160">kvm_clear_interrupt_queue</a></div><div class="ttdeci">static void kvm_clear_interrupt_queue(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00122">x86.h:122</a></div></div>
<div class="ttc" id="ax86_8h_html_aaa166361b58ce8e326699e6cfe87e39a"><div class="ttname"><a href="x86_8h.html#aaa166361b58ce8e326699e6cfe87e39a">kvm_queue_interrupt</a></div><div class="ttdeci">static void kvm_queue_interrupt(struct kvm_vcpu *vcpu, u8 vector, bool soft)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00114">x86.h:114</a></div></div>
<div class="ttc" id="ax86_8h_html_acdc826b0cd2ce8b958a826c8faa306b4"><div class="ttname"><a href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4">kvm_clear_exception_queue</a></div><div class="ttdeci">static void kvm_clear_exception_queue(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00107">x86.h:107</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a921858ef8782f6b0eebb284c5db66de8_cgraph.png" border="0" usemap="#asvm_8c_a921858ef8782f6b0eebb284c5db66de8_cgraph" alt=""/></div>
<map name="asvm_8c_a921858ef8782f6b0eebb284c5db66de8_cgraph" id="asvm_8c_a921858ef8782f6b0eebb284c5db66de8_cgraph">
<area shape="rect" title=" " alt="" coords="5,265,193,292"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="267,58,428,99"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="271,123,424,165"/>
<area shape="rect" href="x86_8h.html#aaa166361b58ce8e326699e6cfe87e39a" title=" " alt="" coords="267,189,428,216"/>
<area shape="rect" href="x86_8c.html#a7afcfddd2ea5cf31a22813c76d9747c2" title=" " alt="" coords="256,240,439,267"/>
<area shape="rect" href="x86_8c.html#a0d7f1c47245e95be49d8925ca92b8365" title=" " alt="" coords="249,291,446,317"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1017,341,1127,368"/>
<area shape="rect" href="svm_8c.html#adf1eccfcab9b8a4c710b30fec219fe14" title=" " alt="" coords="241,443,453,469"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="557,544,628,571"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="501,224,684,251"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="768,5,895,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="771,56,891,83"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="744,107,919,149"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="732,173,931,200"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="739,224,923,251"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="747,275,916,317"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1213,341,1388,368"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1436,341,1629,368"/>
<area shape="rect" href="x86_8h.html#a441b0296c9e66d1e4f4c554d73a3093e" title=" " alt="" coords="507,392,678,419"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="524,443,661,469"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="535,493,650,520"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="758,417,905,444"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="999,392,1145,419"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1010,443,1134,469"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="1245,443,1357,469"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="742,493,921,520"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="979,493,1165,520"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a921858ef8782f6b0eebb284c5db66de8_icgraph.png" border="0" usemap="#asvm_8c_a921858ef8782f6b0eebb284c5db66de8_icgraph" alt=""/></div>
<map name="asvm_8c_a921858ef8782f6b0eebb284c5db66de8_icgraph" id="asvm_8c_a921858ef8782f6b0eebb284c5db66de8_icgraph">
<area shape="rect" title=" " alt="" coords="216,31,404,57"/>
<area shape="rect" href="svm_8c.html#a508824f395cb7a7903a7f5dc7042b082" title=" " alt="" coords="5,5,168,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="29,56,145,83"/>
</map>
</div>

</div>
</div>
<a id="adf1eccfcab9b8a4c710b30fec219fe14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf1eccfcab9b8a4c710b30fec219fe14">&#9670;&nbsp;</a></span>svm_complete_soft_interrupt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_complete_soft_interrupt </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03976">3976</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;{</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;    <span class="keywordtype">bool</span> is_exception = (type == SVM_EXITINTINFO_TYPE_EXEPT);</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;    <span class="keywordtype">bool</span> is_soft = (type == SVM_EXITINTINFO_TYPE_SOFT);</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160; </div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;<span class="comment">     * If NRIPS is enabled, KVM must snapshot the pre-VMRUN next_rip that&#39;s</span></div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;<span class="comment">     * associated with the original soft exception/interrupt.  next_rip is</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;<span class="comment">     * cleared on all exits that can occur while vectoring an event, so KVM</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;<span class="comment">     * needs to manually set next_rip for re-injection.  Unlike the !nrips</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;<span class="comment">     * case below, this needs to be done if and only if KVM is re-injecting</span></div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;<span class="comment">     * the same event, i.e. if the event is a soft exception/interrupt,</span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;<span class="comment">     * otherwise next_rip is unused on VMRUN.</span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a> &amp;&amp; (is_soft || (is_exception &amp;&amp; <a class="code" href="x86_8h.html#a441b0296c9e66d1e4f4c554d73a3093e">kvm_exception_is_soft</a>(vector))) &amp;&amp;</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;        <a class="code" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6">kvm_is_linear_rip</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a45518dab6750d2180fb4d5de532d76">soft_int_old_rip</a> + svm-&gt;<a class="code" href="structvcpu__svm.html#a7c4559533cfca9ae99de999b4c26d5fb">soft_int_csbase</a>))</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.next_rip = svm-&gt;<a class="code" href="structvcpu__svm.html#a47c387d2cf9e9df4331860eca2305fe6">soft_int_next_rip</a>;</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;<span class="comment">     * If NRIPS isn&#39;t enabled, KVM must manually advance RIP prior to</span></div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;<span class="comment">     * injecting the soft exception/interrupt.  That advancement needs to</span></div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;<span class="comment">     * be unwound if vectoring didn&#39;t complete.  Note, the new event may</span></div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;<span class="comment">     * not be the injected event, e.g. if KVM injected an INTn, the INTn</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;<span class="comment">     * hit a #NP in the guest, and the #NP encountered a #PF, the #NP will</span></div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;<span class="comment">     * be the reported vectored event, but RIP still needs to be unwound.</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a> &amp;&amp; (is_soft || is_exception) &amp;&amp;</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;         <a class="code" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6">kvm_is_linear_rip</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a47c387d2cf9e9df4331860eca2305fe6">soft_int_next_rip</a> + svm-&gt;<a class="code" href="structvcpu__svm.html#a7c4559533cfca9ae99de999b4c26d5fb">soft_int_csbase</a>))</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;        <a class="code" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f">kvm_rip_write</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a45518dab6750d2180fb4d5de532d76">soft_int_old_rip</a>);</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_a3a45518dab6750d2180fb4d5de532d76"><div class="ttname"><a href="structvcpu__svm.html#a3a45518dab6750d2180fb4d5de532d76">vcpu_svm::soft_int_old_rip</a></div><div class="ttdeci">unsigned long soft_int_old_rip</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00263">svm.h:263</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a47c387d2cf9e9df4331860eca2305fe6"><div class="ttname"><a href="structvcpu__svm.html#a47c387d2cf9e9df4331860eca2305fe6">vcpu_svm::soft_int_next_rip</a></div><div class="ttdeci">unsigned long soft_int_next_rip</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00264">svm.h:264</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a7c4559533cfca9ae99de999b4c26d5fb"><div class="ttname"><a href="structvcpu__svm.html#a7c4559533cfca9ae99de999b4c26d5fb">vcpu_svm::soft_int_csbase</a></div><div class="ttdeci">unsigned long soft_int_csbase</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00262">svm.h:262</a></div></div>
<div class="ttc" id="ax86_8c_html_a333df16e0456af479cb64edbd93345d6"><div class="ttname"><a href="x86_8c.html#a333df16e0456af479cb64edbd93345d6">kvm_is_linear_rip</a></div><div class="ttdeci">bool kvm_is_linear_rip(struct kvm_vcpu *vcpu, unsigned long linear_rip)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13164">x86.c:13164</a></div></div>
<div class="ttc" id="ax86_8h_html_a441b0296c9e66d1e4f4c554d73a3093e"><div class="ttname"><a href="x86_8h.html#a441b0296c9e66d1e4f4c554d73a3093e">kvm_exception_is_soft</a></div><div class="ttdeci">static bool kvm_exception_is_soft(unsigned int nr)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00133">x86.h:133</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_adf1eccfcab9b8a4c710b30fec219fe14_cgraph.png" border="0" usemap="#asvm_8c_adf1eccfcab9b8a4c710b30fec219fe14_cgraph" alt=""/></div>
<map name="asvm_8c_adf1eccfcab9b8a4c710b30fec219fe14_cgraph" id="asvm_8c_adf1eccfcab9b8a4c710b30fec219fe14_cgraph">
<area shape="rect" title=" " alt="" coords="5,100,217,127"/>
<area shape="rect" href="x86_8h.html#a441b0296c9e66d1e4f4c554d73a3093e" title=" " alt="" coords="265,24,436,51"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="282,75,419,101"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="293,125,408,152"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="315,176,386,203"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="500,69,647,96"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="731,5,877,32"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="742,56,866,83"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="749,107,859,133"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="977,56,1089,83"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="945,107,1120,133"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1168,107,1361,133"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="484,132,663,159"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="711,157,897,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_adf1eccfcab9b8a4c710b30fec219fe14_icgraph.png" border="0" usemap="#asvm_8c_adf1eccfcab9b8a4c710b30fec219fe14_icgraph" alt=""/></div>
<map name="asvm_8c_adf1eccfcab9b8a4c710b30fec219fe14_icgraph" id="asvm_8c_adf1eccfcab9b8a4c710b30fec219fe14_icgraph">
<area shape="rect" title=" " alt="" coords="452,31,664,57"/>
<area shape="rect" href="svm_8c.html#a921858ef8782f6b0eebb284c5db66de8" title=" " alt="" coords="216,31,404,57"/>
<area shape="rect" href="svm_8c.html#a508824f395cb7a7903a7f5dc7042b082" title=" " alt="" coords="5,5,168,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="29,56,145,83"/>
</map>
</div>

</div>
</div>
<a id="a06d8a6a899d49f3235ec1294d1943c84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06d8a6a899d49f3235ec1294d1943c84">&#9670;&nbsp;</a></span>svm_copy_lbrs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_copy_lbrs </td>
          <td>(</td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>to_vmcb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>from_vmcb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00982">982</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;{</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    to_vmcb-&gt;save.dbgctl        = from_vmcb-&gt;save.dbgctl;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    to_vmcb-&gt;save.br_from       = from_vmcb-&gt;save.br_from;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    to_vmcb-&gt;save.br_to     = from_vmcb-&gt;save.br_to;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    to_vmcb-&gt;save.last_excp_from    = from_vmcb-&gt;save.last_excp_from;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    to_vmcb-&gt;save.last_excp_to  = from_vmcb-&gt;save.last_excp_to;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(to_vmcb, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a7ffead4bb2fd939a3b453692fdc4664a">VMCB_LBR</a>);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_aaf8fd5f0e57d456151c951e0f3715fc4a7ffead4bb2fd939a3b453692fdc4664a"><div class="ttname"><a href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a7ffead4bb2fd939a3b453692fdc4664a">VMCB_LBR</a></div><div class="ttdeci">@ VMCB_LBR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00060">svm.h:60</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a06d8a6a899d49f3235ec1294d1943c84_cgraph.png" border="0" usemap="#asvm_8c_a06d8a6a899d49f3235ec1294d1943c84_cgraph" alt=""/></div>
<map name="asvm_8c_a06d8a6a899d49f3235ec1294d1943c84_cgraph" id="asvm_8c_a06d8a6a899d49f3235ec1294d1943c84_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,124,32"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="172,5,308,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a06d8a6a899d49f3235ec1294d1943c84_icgraph.png" border="0" usemap="#asvm_8c_a06d8a6a899d49f3235ec1294d1943c84_icgraph" alt=""/></div>
<map name="asvm_8c_a06d8a6a899d49f3235ec1294d1943c84_icgraph" id="asvm_8c_a06d8a6a899d49f3235ec1294d1943c84_icgraph">
<area shape="rect" title=" " alt="" coords="2367,274,2485,301"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,327,1919,354"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,222,1952,249"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="2183,299,2319,326"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="2184,249,2317,275"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,146,1673,173"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,441,1684,483"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,273,1679,299"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,226,719,253"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,390,1679,417"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,324,1668,365"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,55,1399,96"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,121,1403,147"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,171,1389,198"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,62,1144,89"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,62,939,89"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,445,1421,471"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,273,1408,315"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,273,1176,315"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,226,945,253"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,281,940,307"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,283,520,310"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,365,323,391"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,365,128,391"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,339,1412,366"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="2000,277,2135,303"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1787,277,1897,303"/>
</map>
</div>

</div>
</div>
<a id="ad791a60fcdb50ec0a9aeb753e780ddb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad791a60fcdb50ec0a9aeb753e780ddb6">&#9670;&nbsp;</a></span>svm_cpu_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_cpu_init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00700">700</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;{</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a> *sd = per_cpu_ptr(&amp;svm_data, cpu);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordtype">int</span> ret = -ENOMEM;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    memset(sd, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a>));</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a> = alloc_page(GFP_KERNEL | __GFP_ZERO);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">if</span> (!sd-&gt;<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a>)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    ret = <a class="code" href="sev_8c.html#a87f63ae4bc207e3d5a5d80e34243cf50">sev_cpu_init</a>(sd);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keywordflow">goto</span> free_save_area;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#a7b3be8bfedec131eb474be2ec6a8de10">save_area_pa</a> = <a class="code" href="svm_8h.html#a006ecae20fd705ed2184ec4e6f0f5dd9">__sme_page_pa</a>(sd-&gt;<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;free_save_area:</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    __free_page(sd-&gt;<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a>);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a> = NULL;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a87f63ae4bc207e3d5a5d80e34243cf50"><div class="ttname"><a href="sev_8c.html#a87f63ae4bc207e3d5a5d80e34243cf50">sev_cpu_init</a></div><div class="ttdeci">int sev_cpu_init(struct svm_cpu_data *sd)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02313">sev.c:2313</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_a7b3be8bfedec131eb474be2ec6a8de10"><div class="ttname"><a href="structsvm__cpu__data.html#a7b3be8bfedec131eb474be2ec6a8de10">svm_cpu_data::save_area_pa</a></div><div class="ttdeci">unsigned long save_area_pa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00304">svm.h:304</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_ac7d670a65f2dda678bc5f58478c5ebbc"><div class="ttname"><a href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">svm_cpu_data::save_area</a></div><div class="ttdeci">struct page * save_area</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00303">svm.h:303</a></div></div>
<div class="ttc" id="asvm_8h_html_a006ecae20fd705ed2184ec4e6f0f5dd9"><div class="ttname"><a href="svm_8h.html#a006ecae20fd705ed2184ec4e6f0f5dd9">__sme_page_pa</a></div><div class="ttdeci">#define __sme_page_pa(x)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00028">svm.h:28</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad791a60fcdb50ec0a9aeb753e780ddb6_cgraph.png" border="0" usemap="#asvm_8c_ad791a60fcdb50ec0a9aeb753e780ddb6_cgraph" alt=""/></div>
<map name="asvm_8c_ad791a60fcdb50ec0a9aeb753e780ddb6_cgraph" id="asvm_8c_ad791a60fcdb50ec0a9aeb753e780ddb6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,113,32"/>
<area shape="rect" href="sev_8c.html#a87f63ae4bc207e3d5a5d80e34243cf50" title=" " alt="" coords="161,5,264,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad791a60fcdb50ec0a9aeb753e780ddb6_icgraph.png" border="0" usemap="#asvm_8c_ad791a60fcdb50ec0a9aeb753e780ddb6_icgraph" alt=""/></div>
<map name="asvm_8c_ad791a60fcdb50ec0a9aeb753e780ddb6_icgraph" id="asvm_8c_ad791a60fcdb50ec0a9aeb753e780ddb6_icgraph">
<area shape="rect" title=" " alt="" coords="215,5,323,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="adf31fa601aecc0caef0ec738dee9cd86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf31fa601aecc0caef0ec738dee9cd86">&#9670;&nbsp;</a></span>svm_cpu_uninit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_cpu_uninit </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00687">687</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;{</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a> *sd = per_cpu_ptr(&amp;svm_data, cpu);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">if</span> (!sd-&gt;<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a>)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    kfree(sd-&gt;<a class="code" href="structsvm__cpu__data.html#af89c94b4ad75ed4396bb2f85415fcf38">sev_vmcbs</a>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    __free_page(sd-&gt;<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a>);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#a7b3be8bfedec131eb474be2ec6a8de10">save_area_pa</a> = 0;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a> = NULL;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;}</div>
<div class="ttc" id="astructsvm__cpu__data_html_af89c94b4ad75ed4396bb2f85415fcf38"><div class="ttname"><a href="structsvm__cpu__data.html#af89c94b4ad75ed4396bb2f85415fcf38">svm_cpu_data::sev_vmcbs</a></div><div class="ttdeci">struct vmcb ** sev_vmcbs</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00309">svm.h:309</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_adf31fa601aecc0caef0ec738dee9cd86_icgraph.png" border="0" usemap="#asvm_8c_adf31fa601aecc0caef0ec738dee9cd86_icgraph" alt=""/></div>
<map name="asvm_8c_adf31fa601aecc0caef0ec738dee9cd86_icgraph" id="asvm_8c_adf31fa601aecc0caef0ec738dee9cd86_icgraph">
<area shape="rect" title=" " alt="" coords="440,5,564,32"/>
<area shape="rect" href="svm_8c.html#a96aba01528b17e2beabf86e9c19ac13a" title=" " alt="" coords="215,5,392,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="a501d86bb28fd272f1ab52b8689b5f948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a501d86bb28fd272f1ab52b8689b5f948">&#9670;&nbsp;</a></span>svm_deliver_interrupt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_deliver_interrupt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkvm__lapic.html">kvm_lapic</a> *&#160;</td>
          <td class="paramname"><em>apic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>delivery_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trig_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03667">3667</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;{</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;    <a class="code" href="lapic_8h.html#a12227432ca4a620c3a4e249cbb28ecbe">kvm_lapic_set_irr</a>(vector, apic);</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160; </div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;<span class="comment">     * Pairs with the smp_mb_*() after setting vcpu-&gt;guest_mode in</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;<span class="comment">     * vcpu_enter_guest() to ensure the write to the vIRR is ordered before</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;<span class="comment">     * the read of guest_mode.  This guarantees that either VMRUN will see</span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;<span class="comment">     * and process the new vIRR entry, or that svm_complete_interrupt_delivery</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="comment">     * will signal the doorbell if the CPU has already entered the guest.</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;    smp_mb__after_atomic();</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;    <a class="code" href="svm_8c.html#a1faf261e116f9d9481e1bd6796e32280">svm_complete_interrupt_delivery</a>(apic-&gt;<a class="code" href="structkvm__lapic.html#a54741597d07b2792d2da72ea301ad648">vcpu</a>, delivery_mode, trig_mode, vector);</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;}</div>
<div class="ttc" id="alapic_8h_html_a12227432ca4a620c3a4e249cbb28ecbe"><div class="ttname"><a href="lapic_8h.html#a12227432ca4a620c3a4e249cbb28ecbe">kvm_lapic_set_irr</a></div><div class="ttdeci">static void kvm_lapic_set_irr(int vec, struct kvm_lapic *apic)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00164">lapic.h:164</a></div></div>
<div class="ttc" id="astructkvm__lapic_html_a54741597d07b2792d2da72ea301ad648"><div class="ttname"><a href="structkvm__lapic.html#a54741597d07b2792d2da72ea301ad648">kvm_lapic::vcpu</a></div><div class="ttdeci">struct kvm_vcpu * vcpu</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00064">lapic.h:64</a></div></div>
<div class="ttc" id="asvm_8c_html_a1faf261e116f9d9481e1bd6796e32280"><div class="ttname"><a href="svm_8c.html#a1faf261e116f9d9481e1bd6796e32280">svm_complete_interrupt_delivery</a></div><div class="ttdeci">void svm_complete_interrupt_delivery(struct kvm_vcpu *vcpu, int delivery_mode, int trig_mode, int vector)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03633">svm.c:3633</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a501d86bb28fd272f1ab52b8689b5f948_cgraph.png" border="0" usemap="#asvm_8c_a501d86bb28fd272f1ab52b8689b5f948_cgraph" alt=""/></div>
<map name="asvm_8c_a501d86bb28fd272f1ab52b8689b5f948_cgraph" id="asvm_8c_a501d86bb28fd272f1ab52b8689b5f948_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,171,83"/>
<area shape="rect" href="lapic_8h.html#a12227432ca4a620c3a4e249cbb28ecbe" title=" " alt="" coords="241,16,378,43"/>
<area shape="rect" href="svm_8c.html#a1faf261e116f9d9481e1bd6796e32280" title=" " alt="" coords="219,78,400,119"/>
<area shape="rect" href="lapic_8h.html#aecd6ca5347dbb81047584149b2291019" title=" " alt="" coords="448,5,612,32"/>
<area shape="rect" href="avic_8c.html#ac8c9ded2546dccf6e4b561e633d22e7e" title=" " alt="" coords="459,56,601,83"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="469,107,591,133"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="687,157,841,184"/>
<area shape="rect" href="x86_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="660,107,868,133"/>
</map>
</div>

</div>
</div>
<a id="aaa7d57cd8b29b959a08ccd6dc53196c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa7d57cd8b29b959a08ccd6dc53196c4">&#9670;&nbsp;</a></span>svm_disable_lbrv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_disable_lbrv </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01008">1008</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;{</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.virt_ext &amp;= ~LBR_CTL_ENABLE_MASK;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_LASTBRANCHFROMIP, 0, 0);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_LASTBRANCHTOIP, 0, 0);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_LASTINTFROMIP, 0, 0);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_LASTINTTOIP, 0, 0);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">     * Move the LBR msrs back to the vmcb01 to avoid copying them</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">     * on nested guest entries.</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <a class="code" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84">svm_copy_lbrs</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a06d8a6a899d49f3235ec1294d1943c84"><div class="ttname"><a href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84">svm_copy_lbrs</a></div><div class="ttdeci">void svm_copy_lbrs(struct vmcb *to_vmcb, struct vmcb *from_vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00982">svm.c:982</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aaa7d57cd8b29b959a08ccd6dc53196c4_cgraph.png" border="0" usemap="#asvm_8c_aaa7d57cd8b29b959a08ccd6dc53196c4_cgraph" alt=""/></div>
<map name="asvm_8c_aaa7d57cd8b29b959a08ccd6dc53196c4_cgraph" id="asvm_8c_aaa7d57cd8b29b959a08ccd6dc53196c4_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,141,108"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="209,5,329,32"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="189,107,348,133"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="707,81,777,108"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="209,191,328,217"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="415,158,573,199"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="396,107,592,133"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="671,300,813,327"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="640,133,844,174"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="669,199,815,225"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="667,249,817,276"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="892,140,1065,167"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="426,224,562,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aaa7d57cd8b29b959a08ccd6dc53196c4_icgraph.png" border="0" usemap="#asvm_8c_aaa7d57cd8b29b959a08ccd6dc53196c4_icgraph" alt=""/></div>
<map name="asvm_8c_aaa7d57cd8b29b959a08ccd6dc53196c4_icgraph" id="asvm_8c_aaa7d57cd8b29b959a08ccd6dc53196c4_icgraph">
<area shape="rect" title=" " alt="" coords="2155,428,2291,455"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="1972,428,2107,455"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1769,241,1924,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,428,1213,455"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1792,479,1901,505"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,241,1710,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,170,1721,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,364,1716,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,111,1717,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,293,1705,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,297,1437,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,245,1440,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,195,1427,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,304,1163,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,144,1459,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,362,1445,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,362,1195,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,93,1449,120"/>
</map>
</div>

</div>
</div>
<a id="ab4fa734cd92223a6150551cd5243b4aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4fa734cd92223a6150551cd5243b4aa">&#9670;&nbsp;</a></span>svm_emergency_disable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_emergency_disable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00588">588</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;{</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    kvm_rebooting = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="svm_8c.html#a53176c61179bfcec5f1c122b110cc8c3">kvm_cpu_svm_disable</a>();</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a53176c61179bfcec5f1c122b110cc8c3"><div class="ttname"><a href="svm_8c.html#a53176c61179bfcec5f1c122b110cc8c3">kvm_cpu_svm_disable</a></div><div class="ttdeci">static void kvm_cpu_svm_disable(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00572">svm.c:572</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab4fa734cd92223a6150551cd5243b4aa_cgraph.png" border="0" usemap="#asvm_8c_ab4fa734cd92223a6150551cd5243b4aa_cgraph" alt=""/></div>
<map name="asvm_8c_ab4fa734cd92223a6150551cd5243b4aa_cgraph" id="asvm_8c_ab4fa734cd92223a6150551cd5243b4aa_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,189,32"/>
<area shape="rect" href="svm_8c.html#a53176c61179bfcec5f1c122b110cc8c3" title=" " alt="" coords="237,5,408,32"/>
<area shape="rect" href="svm__ops_8h.html#a97407302752e909143951887456521ef" title=" " alt="" coords="456,5,503,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab4fa734cd92223a6150551cd5243b4aa_icgraph.png" border="0" usemap="#asvm_8c_ab4fa734cd92223a6150551cd5243b4aa_icgraph" alt=""/></div>
<map name="asvm_8c_ab4fa734cd92223a6150551cd5243b4aa_icgraph" id="asvm_8c_ab4fa734cd92223a6150551cd5243b4aa_icgraph">
<area shape="rect" title=" " alt="" coords="280,31,464,57"/>
<area shape="rect" href="svm_8c.html#a5b14d1e0632116bdfd341cd3c892a5eb" title=" " alt="" coords="136,5,232,32"/>
<area shape="rect" href="svm_8c.html#aa667b0a0f202f83aa1533825aeecb402" title=" " alt="" coords="7,56,86,83"/>
<area shape="rect" href="svm_8c.html#ae292292ef2cf8cb0d48cfa27ce94ef88" title=" " alt="" coords="5,5,88,32"/>
</map>
</div>

</div>
</div>
<a id="a1ccd7665fc572e5e6782f88c40e82e88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ccd7665fc572e5e6782f88c40e82e88">&#9670;&nbsp;</a></span>svm_enable_irq_window()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_enable_irq_window </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03813">3813</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;{</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160; </div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;<span class="comment">     * In case GIF=0 we can&#39;t rely on the CPU to tell us when GIF becomes</span></div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;<span class="comment">     * 1, because that&#39;s a separate STGI/VMRUN intercept.  The next time we</span></div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;<span class="comment">     * get that intercept, this function will be called again though and</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="comment">     * we&#39;ll get the vintr intercept. However, if the vGIF feature is</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;<span class="comment">     * enabled, the STGI interception will not occur. Enable the irq</span></div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;<span class="comment">     * window under the assumption that the hardware will set the GIF.</span></div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a> || <a class="code" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a>(svm)) {</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;<span class="comment">         * IRQ window is not needed when AVIC is enabled,</span></div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;<span class="comment">         * unless we have pending ExtINT since it cannot be injected</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;<span class="comment">         * via AVIC. In such case, KVM needs to temporarily disable AVIC,</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;<span class="comment">         * and fallback to injecting IRQ via V_IRQ.</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;<span class="comment">         * If running nested, AVIC is already locally inhibited</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;<span class="comment">         * on this vCPU, therefore there is no need to request</span></div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="comment">         * the VM wide AVIC inhibition.</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;            kvm_set_apicv_inhibit(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm, APICV_INHIBIT_REASON_IRQWIN);</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160; </div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;        <a class="code" href="svm_8c.html#a27df28527cda6f7917355af86817d940">svm_set_vintr</a>(svm);</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;    }</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a27df28527cda6f7917355af86817d940"><div class="ttname"><a href="svm_8c.html#a27df28527cda6f7917355af86817d940">svm_set_vintr</a></div><div class="ttdeci">static void svm_set_vintr(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01630">svm.c:1630</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1ccd7665fc572e5e6782f88c40e82e88_cgraph.png" border="0" usemap="#asvm_8c_a1ccd7665fc572e5e6782f88c40e82e88_cgraph" alt=""/></div>
<map name="asvm_8c_a1ccd7665fc572e5e6782f88c40e82e88_cgraph" id="asvm_8c_a1ccd7665fc572e5e6782f88c40e82e88_cgraph">
<area shape="rect" title=" " alt="" coords="5,105,188,132"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="260,29,327,56"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="866,56,986,83"/>
<area shape="rect" href="svm_8c.html#a27df28527cda6f7917355af86817d940" title=" " alt="" coords="236,156,351,183"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="258,207,329,233"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="657,29,775,56"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="847,5,1005,32"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1083,35,1201,61"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1505,27,1679,69"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1267,60,1457,87"/>
<area shape="rect" href="x86_8c.html#ade52ab1bf2b3d66def1c4851fab08c45" title=" " alt="" coords="399,131,597,157"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="431,181,565,208"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="427,232,569,259"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="858,341,994,368"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="645,181,787,208"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="649,232,783,259"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="851,291,1001,317"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="835,225,1017,266"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="835,107,1017,149"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="853,173,999,200"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1065,115,1219,141"/>
</map>
</div>

</div>
</div>
<a id="af2c512591b577cf59656808ac082a47a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2c512591b577cf59656808ac082a47a">&#9670;&nbsp;</a></span>svm_enable_lbrv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_enable_lbrv </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00993">993</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;{</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.virt_ext |= LBR_CTL_ENABLE_MASK;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_LASTBRANCHFROMIP, 1, 1);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_LASTBRANCHTOIP, 1, 1);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_LASTINTFROMIP, 1, 1);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_LASTINTTOIP, 1, 1);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="comment">/* Move the LBR msrs to the vmcb02 so that the guest can see them. */</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <a class="code" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84">svm_copy_lbrs</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af2c512591b577cf59656808ac082a47a_cgraph.png" border="0" usemap="#asvm_8c_af2c512591b577cf59656808ac082a47a_cgraph" alt=""/></div>
<map name="asvm_8c_af2c512591b577cf59656808ac082a47a_cgraph" id="asvm_8c_af2c512591b577cf59656808ac082a47a_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,139,108"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="206,5,326,32"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="187,107,345,133"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="704,81,775,108"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="207,191,325,217"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="412,158,571,199"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="393,107,589,133"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="669,300,810,327"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="637,133,841,174"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="666,199,813,225"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="664,249,815,276"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="889,140,1063,167"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="423,224,559,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af2c512591b577cf59656808ac082a47a_icgraph.png" border="0" usemap="#asvm_8c_af2c512591b577cf59656808ac082a47a_icgraph" alt=""/></div>
<map name="asvm_8c_af2c512591b577cf59656808ac082a47a_icgraph" id="asvm_8c_af2c512591b577cf59656808ac082a47a_icgraph">
<area shape="rect" title=" " alt="" coords="2155,428,2288,455"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="1972,428,2107,455"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1769,241,1924,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,428,1213,455"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1792,479,1901,505"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,241,1710,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,170,1721,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,364,1716,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,111,1717,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,293,1705,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,297,1437,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,245,1440,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,195,1427,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,304,1163,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,144,1459,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,362,1445,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,362,1195,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,93,1449,120"/>
</map>
</div>

</div>
</div>
<a id="a57894275d4e8aa0a3d5a4ad55e2c4d6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57894275d4e8aa0a3d5a4ad55e2c4d6e">&#9670;&nbsp;</a></span>svm_enable_nmi_window()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_enable_nmi_window </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03843">3843</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;{</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160; </div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;<span class="comment">     * KVM should never request an NMI window when vNMI is enabled, as KVM</span></div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;<span class="comment">     * allows at most one to-be-injected NMI and one pending NMI, i.e. if</span></div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;<span class="comment">     * two NMIs arrive simultaneously, KVM will inject one and set</span></div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;<span class="comment">     * V_NMI_PENDING for the other.  WARN, but continue with the standard</span></div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;<span class="comment">     * single-step approach to try and salvage the pending NMI.</span></div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;    WARN_ON_ONCE(<a class="code" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">is_vnmi_enabled</a>(svm));</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160; </div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3">svm_get_nmi_mask</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; !svm-&gt;<a class="code" href="structvcpu__svm.html#ae94a883f2e559703aaa7b93d14a3810a">awaiting_iret_completion</a>)</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;        <span class="keywordflow">return</span>; <span class="comment">/* IRET will cause a vm exit */</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160; </div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;<span class="comment">     * SEV-ES guests are responsible for signaling when a vCPU is ready to</span></div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;<span class="comment">     * receive a new NMI, as SEV-ES guests can&#39;t be single-stepped, i.e.</span></div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;<span class="comment">     * KVM can&#39;t intercept and single-step IRET to detect when NMIs are</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;<span class="comment">     * unblocked (architecturally speaking).  See SVM_VMGEXIT_NMI_COMPLETE.</span></div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;<span class="comment">     * Note, GIF is guaranteed to be &#39;1&#39; for SEV-ES guests as hardware</span></div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;<span class="comment">     * ignores SEV-ES guest writes to EFER.SVME *and* CLGI/STGI are not</span></div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;<span class="comment">     * supported NAEs in the GHCB protocol.</span></div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160; </div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a>(svm)) {</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>)</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;            <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_STGI);</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;        <span class="keywordflow">return</span>; <span class="comment">/* STGI will cause a vm exit */</span></div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;    }</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160; </div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;<span class="comment">     * Something prevents NMI from been injected. Single step over possible</span></div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;<span class="comment">     * problem (IRET or exception injection or interrupt shadow)</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">nmi_singlestep_guest_rflags</a> = <a class="code" href="svm_8c.html#aebf053055bbd922cecbebdcd0bdecf09">svm_get_rflags</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">nmi_singlestep</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rflags |= (X86_EFLAGS_TF | X86_EFLAGS_RF);</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_ac87074e79786dc9fe0d4f587e5baf8b3"><div class="ttname"><a href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3">svm_get_nmi_mask</a></div><div class="ttdeci">static bool svm_get_nmi_mask(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03706">svm.c:3706</a></div></div>
<div class="ttc" id="asvm_8c_html_aebf053055bbd922cecbebdcd0bdecf09"><div class="ttname"><a href="svm_8c.html#aebf053055bbd922cecbebdcd0bdecf09">svm_get_rflags</a></div><div class="ttdeci">static unsigned long svm_get_rflags(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01575">svm.c:1575</a></div></div>
<div class="ttc" id="asvm_8h_html_a66eedd855edb50a1b78c2ac2c48a4d5d"><div class="ttname"><a href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">is_vnmi_enabled</a></div><div class="ttdeci">static bool is_vnmi_enabled(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00524">svm.h:524</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a57894275d4e8aa0a3d5a4ad55e2c4d6e_cgraph.png" border="0" usemap="#asvm_8c_a57894275d4e8aa0a3d5a4ad55e2c4d6e_cgraph" alt=""/></div>
<map name="asvm_8c_a57894275d4e8aa0a3d5a4ad55e2c4d6e_cgraph" id="asvm_8c_a57894275d4e8aa0a3d5a4ad55e2c4d6e_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,196,184"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="287,107,354,133"/>
<area shape="rect" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d" title=" " alt="" coords="446,56,578,83"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="265,5,376,32"/>
<area shape="rect" href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3" title=" " alt="" coords="244,157,397,184"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="477,208,547,235"/>
<area shape="rect" href="svm_8c.html#aebf053055bbd922cecbebdcd0bdecf09" title=" " alt="" coords="260,208,381,235"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="249,331,392,357"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="453,107,571,133"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="874,81,994,108"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="639,132,797,159"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="875,245,993,272"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1297,238,1471,279"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1059,271,1249,297"/>
<area shape="rect" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8" title=" " alt="" coords="645,31,791,57"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="459,5,565,32"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="445,331,579,357"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="643,468,793,495"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="627,234,809,275"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="627,402,809,443"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="645,300,791,327"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="650,351,786,377"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="857,409,1011,436"/>
</map>
</div>

</div>
</div>
<a id="ae292292ef2cf8cb0d48cfa27ce94ef88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae292292ef2cf8cb0d48cfa27ce94ef88">&#9670;&nbsp;</a></span>svm_exit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __exit svm_exit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l05373">5373</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;{</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;    <a class="code" href="kvm__main_8c.html#aa2c75d9780a1fec0d5f1351fe501392b">kvm_exit</a>();</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;    <a class="code" href="svm_8c.html#a5b14d1e0632116bdfd341cd3c892a5eb">__svm_exit</a>();</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;}</div>
<div class="ttc" id="akvm__main_8c_html_aa2c75d9780a1fec0d5f1351fe501392b"><div class="ttname"><a href="kvm__main_8c.html#aa2c75d9780a1fec0d5f1351fe501392b">kvm_exit</a></div><div class="ttdeci">void kvm_exit(void)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l06495">kvm_main.c:6495</a></div></div>
<div class="ttc" id="asvm_8c_html_a5b14d1e0632116bdfd341cd3c892a5eb"><div class="ttname"><a href="svm_8c.html#a5b14d1e0632116bdfd341cd3c892a5eb">__svm_exit</a></div><div class="ttdeci">static void __svm_exit(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l05335">svm.c:5335</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ae292292ef2cf8cb0d48cfa27ce94ef88_cgraph.png" border="0" usemap="#asvm_8c_ae292292ef2cf8cb0d48cfa27ce94ef88_cgraph" alt=""/></div>
<map name="asvm_8c_ae292292ef2cf8cb0d48cfa27ce94ef88_cgraph" id="asvm_8c_ae292292ef2cf8cb0d48cfa27ce94ef88_cgraph">
<area shape="rect" title=" " alt="" coords="5,132,88,159"/>
<area shape="rect" href="svm_8c.html#a5b14d1e0632116bdfd341cd3c892a5eb" title=" " alt="" coords="136,107,232,133"/>
<area shape="rect" href="kvm__main_8c.html#aa2c75d9780a1fec0d5f1351fe501392b" title=" " alt="" coords="143,157,225,184"/>
<area shape="rect" href="x86_8c.html#a6b0e9d5b7fc8842b6316f94643af7023" title=" " alt="" coords="289,56,455,83"/>
<area shape="rect" href="svm_8c.html#ab4fa734cd92223a6150551cd5243b4aa" title=" " alt="" coords="280,107,464,133"/>
<area shape="rect" href="lapic_8c.html#af2d9c133a24e68f345a3fe133bf8bfaf" title=" " alt="" coords="567,5,689,32"/>
<area shape="rect" href="mmu_8c.html#a300e442ad7216d17c3ad006fab006622" title=" " alt="" coords="512,56,744,83"/>
<area shape="rect" href="mmu_8c.html#a7972fb42d26603fda02b76d2ab6e6d8b" title=" " alt="" coords="792,56,956,83"/>
<area shape="rect" href="svm_8c.html#a53176c61179bfcec5f1c122b110cc8c3" title=" " alt="" coords="543,107,713,133"/>
<area shape="rect" href="svm__ops_8h.html#a97407302752e909143951887456521ef" title=" " alt="" coords="851,107,897,133"/>
<area shape="rect" href="async__pf_8c.html#a6a95381b9989e167d6652a615d5d23ca" title=" " alt="" coords="292,157,452,184"/>
<area shape="rect" href="vfio_8c.html#a446b600ca5ab23d5f144817c3f4b0e63" title=" " alt="" coords="300,208,444,235"/>
</map>
</div>

</div>
</div>
<a id="a82c8447e70f06dd52623c696446104b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82c8447e70f06dd52623c696446104b5">&#9670;&nbsp;</a></span>svm_exit_handlers_fastpath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static fastpath_t svm_exit_handlers_fastpath </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04093">4093</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;{</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;vmcb-&gt;control.exit_code == SVM_EXIT_MSR &amp;&amp;</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;        <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;vmcb-&gt;control.exit_info_1)</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a8a37294ff599bdc5183d75ecdd61412a">handle_fastpath_set_msr_irqoff</a>(vcpu);</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160; </div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;    <span class="keywordflow">return</span> EXIT_FASTPATH_NONE;</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;}</div>
<div class="ttc" id="ax86_8c_html_a8a37294ff599bdc5183d75ecdd61412a"><div class="ttname"><a href="x86_8c.html#a8a37294ff599bdc5183d75ecdd61412a">handle_fastpath_set_msr_irqoff</a></div><div class="ttdeci">fastpath_t handle_fastpath_set_msr_irqoff(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l02185">x86.c:2185</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a82c8447e70f06dd52623c696446104b5_cgraph.png" border="0" usemap="#asvm_8c_a82c8447e70f06dd52623c696446104b5_cgraph" alt=""/></div>
<map name="asvm_8c_a82c8447e70f06dd52623c696446104b5_cgraph" id="asvm_8c_a82c8447e70f06dd52623c696446104b5_cgraph">
<area shape="rect" title=" " alt="" coords="5,456,212,483"/>
<area shape="rect" href="x86_8c.html#a8a37294ff599bdc5183d75ecdd61412a" title=" " alt="" coords="260,419,415,461"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="302,485,373,512"/>
<area shape="rect" href="x86_8c.html#a7b5659746726fd8443c25a3faca86d7c" title=" " alt="" coords="757,162,912,203"/>
<area shape="rect" href="x86_8c.html#aa034c812534431b2514d9ab68edddc71" title=" " alt="" coords="501,390,655,431"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a7284219cd6cc4787f8e1eba2d4cf2c19" title=" " alt="" coords="503,456,653,483"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="463,647,693,673"/>
<area shape="rect" href="lapic_8c.html#a2400290b895608d302ecce4ee352ee25" title=" " alt="" coords="1003,60,1179,87"/>
<area shape="rect" href="lapic_8c.html#a44881cc17bdbe632a483e8c7c1dd0dfb" title=" " alt="" coords="976,169,1207,196"/>
<area shape="rect" href="lapic_8c.html#ad7790e6f84a1592b5298b2da79a633a9" title=" " alt="" coords="1275,53,1433,94"/>
<area shape="rect" href="x86_8h.html#a8a31c0c01a5fe5dc33f7c5675ba4d376" title=" " alt="" coords="1511,5,1673,32"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="1523,60,1661,87"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="1503,195,1681,221"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="1757,271,1875,297"/>
<area shape="rect" href="lapic_8c.html#adaceffbfc91320b193a66d974fb12ce0" title=" " alt="" coords="1274,169,1434,196"/>
<area shape="rect" href="lapic_8h.html#ae7e74fde3e4fb01f561634e789b5eab4" title=" " alt="" coords="1521,321,1663,348"/>
<area shape="rect" href="lapic_8c.html#a5f5c49ce8a579b59663644f0f1a6cbe3" title=" " alt="" coords="1290,119,1418,145"/>
<area shape="rect" href="lapic_8h.html#a1d8660ecbda996b11b10b179013e52d4" title=" " alt="" coords="1731,321,1901,348"/>
<area shape="rect" href="lapic_8c.html#a108aca5a9980d721f30b333be204d005" title=" " alt="" coords="1521,119,1663,145"/>
<area shape="rect" href="lapic_8c.html#adf8f8ff420925292fe7ce7e1ea72924a" title=" " alt="" coords="1949,195,2087,221"/>
<area shape="rect" href="lapic_8c.html#a843b5038a6a8d6c20b11bd97b69bf667" title=" " alt="" coords="1955,119,2081,145"/>
<area shape="rect" href="lapic_8c.html#ade21404bee3e5dbbe596ff391e0a23db" title=" " alt="" coords="1745,119,1887,145"/>
<area shape="rect" href="lapic_8c.html#a0efcb9037756de47e9d28f0a5ea1009f" title=" " alt="" coords="1735,169,1897,196"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="1283,448,1425,475"/>
<area shape="rect" href="lapic_8c.html#adf2487dc76dace6e577b637cc357998b" title=" " alt="" coords="753,397,917,424"/>
<area shape="rect" href="lapic_8c.html#a4b7f12cb3ba68245df79bc30d938b728" title=" " alt="" coords="1018,397,1165,424"/>
<area shape="rect" href="lapic_8c.html#a8c69ed3d074907a7adcee84e8570ebb2" title=" " alt="" coords="1011,347,1171,373"/>
<area shape="rect" href="irq_8h.html#a50293a78b5c0b6715243dc7854bcb210" title=" " alt="" coords="1259,397,1449,424"/>
<area shape="rect" href="lapic_8c.html#a47d52843df792ef8e7bffdfb66a3b40b" title=" " alt="" coords="1501,372,1683,399"/>
<area shape="rect" href="lapic_8c.html#adb63e5a650d4571316b450d153a3105d" title=" " alt="" coords="1508,423,1676,449"/>
<area shape="rect" href="lapic_8c.html#a3d272e1b73f22f797955e7ddea84b741" title=" " alt="" coords="1524,473,1660,500"/>
<area shape="rect" href="lapic_8h.html#a447b1b971acaf871dd62669b4aa3116f" title=" " alt="" coords="1507,524,1677,551"/>
<area shape="rect" href="lapic_8c.html#a39839decdbbb9e8a6718f3ac7c0b3707" title=" " alt="" coords="1267,347,1441,373"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="744,647,925,673"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="741,844,928,871"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1030,545,1153,572"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1012,669,1171,710"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1004,735,1179,761"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1006,617,1177,644"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="1547,575,1637,601"/>
<area shape="rect" href="pmu_8h.html#abbf4b99efff2cdd22398e2992085c36f" title=" " alt="" coords="1255,727,1453,769"/>
<area shape="rect" href="pmu_8c.html#af08b63fb7910be3ee65e8036b4e48aad" title=" " alt="" coords="1265,575,1443,601"/>
<area shape="rect" href="pmu_8h.html#a156ede05e2f3b40ccf7a68f471f574b2" title=" " alt="" coords="1261,625,1447,652"/>
<area shape="rect" href="pmu_8h.html#a276700643eefb3c6911a7ae0dc0e3809" title=" " alt="" coords="1263,676,1445,703"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1018,844,1165,871"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="999,920,1183,947"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="1281,793,1427,820"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1292,844,1416,871"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1299,895,1409,921"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1263,945,1445,972"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a82c8447e70f06dd52623c696446104b5_icgraph.png" border="0" usemap="#asvm_8c_a82c8447e70f06dd52623c696446104b5_icgraph" alt=""/></div>
<map name="asvm_8c_a82c8447e70f06dd52623c696446104b5_icgraph" id="asvm_8c_a82c8447e70f06dd52623c696446104b5_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,376,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="a89adfbeb2d2d711fc4dc821ee133248c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89adfbeb2d2d711fc4dc821ee133248c">&#9670;&nbsp;</a></span>svm_flush_tlb_all()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_flush_tlb_all </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03927">3927</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;{</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;<span class="comment">     * When running on Hyper-V with EnlightenedNptTlb enabled, remote TLB</span></div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="comment">     * flushes should be routed to hv_flush_remote_tlbs() without requesting</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;<span class="comment">     * a &quot;regular&quot; remote flush.  Reaching this point means either there&#39;s</span></div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;<span class="comment">     * a KVM bug or a prior hv_flush_remote_tlbs() call failed, both of</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;<span class="comment">     * which might be fatal to the guest.  Yell, but try to recover.</span></div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;    <span class="keywordflow">if</span> (WARN_ON_ONCE(<a class="code" href="svm__onhyperv_8h.html#a9786e3a21f906e6463bb5045e59088ec">svm_hv_is_enlightened_tlb_enabled</a>(vcpu)))</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;        <a class="code" href="kvm__onhyperv_8c.html#a2cb4387189fe3ba2db779c40333eed56">hv_flush_remote_tlbs</a>(vcpu-&gt;kvm);</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160; </div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;    <a class="code" href="svm_8c.html#aba80ec8e0369ea53585b03f6b783e16d">svm_flush_tlb_asid</a>(vcpu);</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;}</div>
<div class="ttc" id="akvm__onhyperv_8c_html_a2cb4387189fe3ba2db779c40333eed56"><div class="ttname"><a href="kvm__onhyperv_8c.html#a2cb4387189fe3ba2db779c40333eed56">hv_flush_remote_tlbs</a></div><div class="ttdeci">int hv_flush_remote_tlbs(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__onhyperv_8c_source.html#l00106">kvm_onhyperv.c:106</a></div></div>
<div class="ttc" id="asvm_8c_html_aba80ec8e0369ea53585b03f6b783e16d"><div class="ttname"><a href="svm_8c.html#aba80ec8e0369ea53585b03f6b783e16d">svm_flush_tlb_asid</a></div><div class="ttdeci">static void svm_flush_tlb_asid(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03887">svm.c:3887</a></div></div>
<div class="ttc" id="asvm__onhyperv_8h_html_a9786e3a21f906e6463bb5045e59088ec"><div class="ttname"><a href="svm__onhyperv_8h.html#a9786e3a21f906e6463bb5045e59088ec">svm_hv_is_enlightened_tlb_enabled</a></div><div class="ttdeci">static bool svm_hv_is_enlightened_tlb_enabled(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm__onhyperv_8h_source.html#l00092">svm_onhyperv.h:92</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a89adfbeb2d2d711fc4dc821ee133248c_cgraph.png" border="0" usemap="#asvm_8c_a89adfbeb2d2d711fc4dc821ee133248c_cgraph" alt=""/></div>
<map name="asvm_8c_a89adfbeb2d2d711fc4dc821ee133248c_cgraph" id="asvm_8c_a89adfbeb2d2d711fc4dc821ee133248c_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,140,98"/>
<area shape="rect" href="kvm__onhyperv_8c.html#a2cb4387189fe3ba2db779c40333eed56" title=" " alt="" coords="195,17,356,43"/>
<area shape="rect" href="svm_8c.html#aba80ec8e0369ea53585b03f6b783e16d" title=" " alt="" coords="202,71,349,98"/>
<area shape="rect" href="svm__onhyperv_8h.html#a9786e3a21f906e6463bb5045e59088ec" title=" " alt="" coords="188,123,363,164"/>
<area shape="rect" href="kvm__onhyperv_8c.html#a8b8dd786b7872c03b29fda0f4995a6d5" title=" " alt="" coords="433,5,607,47"/>
<area shape="rect" href="kvm__onhyperv_8c.html#a7312126e879429e4deebc844f605e203" title=" " alt="" coords="677,13,868,39"/>
<area shape="rect" href="kvm__onhyperv_8c.html#aa4b7fe2c8c56541efd19fc9d77739637" title=" " alt="" coords="916,13,1113,39"/>
<area shape="rect" href="hyperv_8h.html#a130eef63d3c6a1d540994ebbb371be24" title=" " alt="" coords="411,71,629,98"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="485,122,555,149"/>
</map>
</div>

</div>
</div>
<a id="aba80ec8e0369ea53585b03f6b783e16d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba80ec8e0369ea53585b03f6b783e16d">&#9670;&nbsp;</a></span>svm_flush_tlb_asid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_flush_tlb_asid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03887">3887</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;{</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160; </div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;<span class="comment">     * Unlike VMX, SVM doesn&#39;t provide a way to flush only NPT TLB entries.</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;<span class="comment">     * A TLB flush for the current ASID flushes both &quot;host&quot; and &quot;guest&quot; TLB</span></div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;<span class="comment">     * entries, and thus is a superset of Hyper-V&#39;s fine grained flushing.</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;    <a class="code" href="hyperv_8h.html#a130eef63d3c6a1d540994ebbb371be24">kvm_hv_vcpu_purge_flush_tlb</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160; </div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="comment">     * Flush only the current ASID even if the TLB flush was invoked via</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;<span class="comment">     * kvm_flush_remote_tlbs().  Although flushing remote TLBs requires all</span></div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;<span class="comment">     * ASIDs to be flushed, KVM uses a single ASID for L1 and L2, and</span></div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;<span class="comment">     * unconditionally does a TLB flush on both nested VM-Enter and nested</span></div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;<span class="comment">     * VM-Exit (via kvm_mmu_reset_context()).</span></div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;    <span class="keywordflow">if</span> (static_cpu_has(X86_FEATURE_FLUSHBYASID))</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.tlb_ctl = TLB_CONTROL_FLUSH_ASID;</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a>-&gt;<a class="code" href="structkvm__vmcb__info.html#a48661ae4516f12bd14f4cc4121700a90">asid_generation</a>--;</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;}</div>
<div class="ttc" id="ahyperv_8h_html_a130eef63d3c6a1d540994ebbb371be24"><div class="ttname"><a href="hyperv_8h.html#a130eef63d3c6a1d540994ebbb371be24">kvm_hv_vcpu_purge_flush_tlb</a></div><div class="ttdeci">static void kvm_hv_vcpu_purge_flush_tlb(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="hyperv_8h_source.html#l00288">hyperv.h:288</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aba80ec8e0369ea53585b03f6b783e16d_cgraph.png" border="0" usemap="#asvm_8c_aba80ec8e0369ea53585b03f6b783e16d_cgraph" alt=""/></div>
<map name="asvm_8c_aba80ec8e0369ea53585b03f6b783e16d_cgraph" id="asvm_8c_aba80ec8e0369ea53585b03f6b783e16d_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,152,57"/>
<area shape="rect" href="hyperv_8h.html#a130eef63d3c6a1d540994ebbb371be24" title=" " alt="" coords="200,5,419,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="274,56,345,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aba80ec8e0369ea53585b03f6b783e16d_icgraph.png" border="0" usemap="#asvm_8c_aba80ec8e0369ea53585b03f6b783e16d_icgraph" alt=""/></div>
<map name="asvm_8c_aba80ec8e0369ea53585b03f6b783e16d_icgraph" id="asvm_8c_aba80ec8e0369ea53585b03f6b783e16d_icgraph">
<area shape="rect" title=" " alt="" coords="2517,209,2664,235"/>
<area shape="rect" href="svm_8c.html#a89adfbeb2d2d711fc4dc821ee133248c" title=" " alt="" coords="2319,183,2454,210"/>
<area shape="rect" href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08" title=" " alt="" coords="2304,234,2469,261"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="2152,234,2256,261"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1809,165,1875,191"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,285,1919,311"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,222,1952,249"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="2000,259,2104,286"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,146,1673,173"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,441,1684,483"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,273,1679,299"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,226,719,253"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,390,1679,417"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,324,1668,365"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,55,1399,96"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,121,1403,147"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,171,1389,198"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,62,1144,89"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,62,939,89"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,445,1421,471"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,273,1408,315"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,273,1176,315"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,226,945,253"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,281,940,307"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,267,520,294"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,310,323,337"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,310,128,337"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,339,1412,366"/>
</map>
</div>

</div>
</div>
<a id="ac9fb8e1d8461d85400d73c9438073a08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9fb8e1d8461d85400d73c9438073a08">&#9670;&nbsp;</a></span>svm_flush_tlb_current()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_flush_tlb_current </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03911">3911</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;{</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;    hpa_t root_tdp = vcpu-&gt;arch.mmu-&gt;root.hpa;</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160; </div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;<span class="comment">     * When running on Hyper-V with EnlightenedNptTlb enabled, explicitly</span></div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;<span class="comment">     * flush the NPT mappings via hypercall as flushing the ASID only</span></div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;<span class="comment">     * affects virtual to physical mappings, it does not invalidate guest</span></div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;<span class="comment">     * physical to host physical mappings.</span></div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm__onhyperv_8h.html#a9786e3a21f906e6463bb5045e59088ec">svm_hv_is_enlightened_tlb_enabled</a>(vcpu) &amp;&amp; VALID_PAGE(root_tdp))</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;        hyperv_flush_guest_mapping(root_tdp);</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160; </div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;    <a class="code" href="svm_8c.html#aba80ec8e0369ea53585b03f6b783e16d">svm_flush_tlb_asid</a>(vcpu);</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ac9fb8e1d8461d85400d73c9438073a08_cgraph.png" border="0" usemap="#asvm_8c_ac9fb8e1d8461d85400d73c9438073a08_cgraph" alt=""/></div>
<map name="asvm_8c_ac9fb8e1d8461d85400d73c9438073a08_cgraph" id="asvm_8c_ac9fb8e1d8461d85400d73c9438073a08_cgraph">
<area shape="rect" title=" " alt="" coords="5,60,171,87"/>
<area shape="rect" href="svm_8c.html#aba80ec8e0369ea53585b03f6b783e16d" title=" " alt="" coords="233,31,379,57"/>
<area shape="rect" href="svm__onhyperv_8h.html#a9786e3a21f906e6463bb5045e59088ec" title=" " alt="" coords="219,82,393,123"/>
<area shape="rect" href="hyperv_8h.html#a130eef63d3c6a1d540994ebbb371be24" title=" " alt="" coords="441,5,660,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="515,56,586,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ac9fb8e1d8461d85400d73c9438073a08_icgraph.png" border="0" usemap="#asvm_8c_ac9fb8e1d8461d85400d73c9438073a08_icgraph" alt=""/></div>
<map name="asvm_8c_ac9fb8e1d8461d85400d73c9438073a08_icgraph" id="asvm_8c_ac9fb8e1d8461d85400d73c9438073a08_icgraph">
<area shape="rect" title=" " alt="" coords="2304,234,2469,261"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="2152,234,2256,261"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1809,165,1875,191"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,285,1919,311"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,222,1952,249"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="2000,259,2104,286"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,146,1673,173"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,441,1684,483"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,273,1679,299"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,226,719,253"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,390,1679,417"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,324,1668,365"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,55,1399,96"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,121,1403,147"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,171,1389,198"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,62,1144,89"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,62,939,89"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,445,1421,471"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,273,1408,315"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,273,1176,315"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,226,945,253"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,281,940,307"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,267,520,294"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,310,323,337"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,310,128,337"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,339,1412,366"/>
</map>
</div>

</div>
</div>
<a id="a0cd895643ff213d3fefeaede1dae0746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cd895643ff213d3fefeaede1dae0746">&#9670;&nbsp;</a></span>svm_flush_tlb_gva()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_flush_tlb_gva </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gva_t&#160;</td>
          <td class="paramname"><em>gva</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03942">3942</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;{</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160; </div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;    <a class="code" href="svm__ops_8h.html#a9d8ce16cea670ce3239bbf3f26c9f4cb">invlpga</a>(gva, svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.asid);</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;}</div>
<div class="ttc" id="asvm__ops_8h_html_a9d8ce16cea670ce3239bbf3f26c9f4cb"><div class="ttname"><a href="svm__ops_8h.html#a9d8ce16cea670ce3239bbf3f26c9f4cb">invlpga</a></div><div class="ttdeci">static void invlpga(unsigned long addr, u32 asid)</div><div class="ttdef"><b>Definition:</b> <a href="svm__ops_8h_source.html#l00049">svm_ops.h:49</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a0cd895643ff213d3fefeaede1dae0746_cgraph.png" border="0" usemap="#asvm_8c_a0cd895643ff213d3fefeaede1dae0746_cgraph" alt=""/></div>
<map name="asvm_8c_a0cd895643ff213d3fefeaede1dae0746_cgraph" id="asvm_8c_a0cd895643ff213d3fefeaede1dae0746_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,148,57"/>
<area shape="rect" href="svm__ops_8h.html#a9d8ce16cea670ce3239bbf3f26c9f4cb" title=" " alt="" coords="196,5,267,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="196,56,267,83"/>
</map>
</div>

</div>
</div>
<a id="aec9fa4b1df8f24cd52b41eb10cfc0b4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec9fa4b1df8f24cd52b41eb10cfc0b4d">&#9670;&nbsp;</a></span>svm_get_cpl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_get_cpl </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01779">1779</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;{</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keyword">struct </span>vmcb_save_area *save = &amp;<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">return</span> save-&gt;cpl;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aec9fa4b1df8f24cd52b41eb10cfc0b4d_cgraph.png" border="0" usemap="#asvm_8c_aec9fa4b1df8f24cd52b41eb10cfc0b4d_cgraph" alt=""/></div>
<map name="asvm_8c_aec9fa4b1df8f24cd52b41eb10cfc0b4d_cgraph" id="asvm_8c_aec9fa4b1df8f24cd52b41eb10cfc0b4d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,109,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="157,5,228,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aec9fa4b1df8f24cd52b41eb10cfc0b4d_icgraph.png" border="0" usemap="#asvm_8c_aec9fa4b1df8f24cd52b41eb10cfc0b4d_icgraph" alt=""/></div>
<map name="asvm_8c_aec9fa4b1df8f24cd52b41eb10cfc0b4d_icgraph" id="asvm_8c_aec9fa4b1df8f24cd52b41eb10cfc0b4d_icgraph">
<area shape="rect" title=" " alt="" coords="285,31,389,57"/>
<area shape="rect" href="svm_8c.html#ad65ceb76375d4e01d2b1e11a9c227b7c" title=" " alt="" coords="48,5,195,32"/>
<area shape="rect" href="svm_8c.html#a28ea9c19442062c9e284d39852ffab26" title=" " alt="" coords="5,56,237,83"/>
</map>
</div>

</div>
</div>
<a id="aa993ddc604d61adf2f6b26668d37cee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa993ddc604d61adf2f6b26668d37cee5">&#9670;&nbsp;</a></span>svm_get_cs_db_l_bits()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_get_cs_db_l_bits </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01786">1786</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;{</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="keyword">struct </span>kvm_segment cs;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <a class="code" href="svm_8c.html#a6daa12edeead3fa3897d8e868a20c63e">svm_get_segment</a>(vcpu, &amp;cs, VCPU_SREG_CS);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    *db = cs.db;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    *l = cs.l;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a6daa12edeead3fa3897d8e868a20c63e"><div class="ttname"><a href="svm_8c.html#a6daa12edeead3fa3897d8e868a20c63e">svm_get_segment</a></div><div class="ttdeci">static void svm_get_segment(struct kvm_vcpu *vcpu, struct kvm_segment *var, int seg)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01710">svm.c:1710</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aa993ddc604d61adf2f6b26668d37cee5_cgraph.png" border="0" usemap="#asvm_8c_aa993ddc604d61adf2f6b26668d37cee5_cgraph" alt=""/></div>
<map name="asvm_8c_aa993ddc604d61adf2f6b26668d37cee5_cgraph" id="asvm_8c_aa993ddc604d61adf2f6b26668d37cee5_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,169,57"/>
<area shape="rect" href="svm_8c.html#a6daa12edeead3fa3897d8e868a20c63e" title=" " alt="" coords="217,31,360,57"/>
<area shape="rect" href="svm_8c.html#aa1743f35bf86caa51b20a010c228520b" title=" " alt="" coords="408,5,488,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="536,31,607,57"/>
</map>
</div>

</div>
</div>
<a id="afa926f80cf0e6c6d933937170b6991f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa926f80cf0e6c6d933937170b6991f3">&#9670;&nbsp;</a></span>svm_get_exit_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_get_exit_info </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64 *&#160;</td>
          <td class="paramname"><em>info1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64 *&#160;</td>
          <td class="paramname"><em>info2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>intr_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>error_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03473">3473</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;{</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;    <span class="keyword">struct </span>vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a> = &amp;<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control;</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160; </div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    *reason = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_code;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    *info1 = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_1;</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    *info2 = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_2;</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;    *intr_info = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_int_info;</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;    <span class="keywordflow">if</span> ((*intr_info &amp; SVM_EXITINTINFO_VALID) &amp;&amp;</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        (*intr_info &amp; SVM_EXITINTINFO_VALID_ERR))</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        *error_code = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_int_info_err;</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;        *error_code = 0;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_afa926f80cf0e6c6d933937170b6991f3_cgraph.png" border="0" usemap="#asvm_8c_afa926f80cf0e6c6d933937170b6991f3_cgraph" alt=""/></div>
<map name="asvm_8c_afa926f80cf0e6c6d933937170b6991f3_cgraph" id="asvm_8c_afa926f80cf0e6c6d933937170b6991f3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,148,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="196,5,267,32"/>
</map>
</div>

</div>
</div>
<a id="aaddc1011ccd3c9fc0acf431a09012569"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaddc1011ccd3c9fc0acf431a09012569">&#9670;&nbsp;</a></span>svm_get_gdt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_get_gdt </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct desc_ptr *&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01812">1812</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;{</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    dt-&gt;size = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.gdtr.limit;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    dt-&gt;address = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.gdtr.base;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aaddc1011ccd3c9fc0acf431a09012569_cgraph.png" border="0" usemap="#asvm_8c_aaddc1011ccd3c9fc0acf431a09012569_cgraph" alt=""/></div>
<map name="asvm_8c_aaddc1011ccd3c9fc0acf431a09012569_cgraph" id="asvm_8c_aaddc1011ccd3c9fc0acf431a09012569_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,112,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="160,5,231,32"/>
</map>
</div>

</div>
</div>
<a id="acce4be1ba744049afda22aa447c80228"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acce4be1ba744049afda22aa447c80228">&#9670;&nbsp;</a></span>svm_get_idt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_get_idt </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct desc_ptr *&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01795">1795</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;{</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; </div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    dt-&gt;size = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.idtr.limit;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    dt-&gt;address = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.idtr.base;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_acce4be1ba744049afda22aa447c80228_cgraph.png" border="0" usemap="#asvm_8c_acce4be1ba744049afda22aa447c80228_cgraph" alt=""/></div>
<map name="asvm_8c_acce4be1ba744049afda22aa447c80228_cgraph" id="asvm_8c_acce4be1ba744049afda22aa447c80228_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,108,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="156,5,227,32"/>
</map>
</div>

</div>
</div>
<a id="a4a9065695154691afff42bc585235d64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a9065695154691afff42bc585235d64">&#9670;&nbsp;</a></span>svm_get_if_flag()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_get_if_flag </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01603">1603</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;{</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(vcpu-&gt;kvm)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        ? vmcb-&gt;control.int_state &amp; SVM_GUEST_INTERRUPT_MASK</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        : <a class="code" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c">kvm_get_rflags</a>(vcpu) &amp; X86_EFLAGS_IF;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;}</div>
<div class="ttc" id="ax86_8c_html_aeca964de04721f39e3ec34f195707b5c"><div class="ttname"><a href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c">kvm_get_rflags</a></div><div class="ttdeci">unsigned long kvm_get_rflags(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13170">x86.c:13170</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a4a9065695154691afff42bc585235d64_cgraph.png" border="0" usemap="#asvm_8c_a4a9065695154691afff42bc585235d64_cgraph" alt=""/></div>
<map name="asvm_8c_a4a9065695154691afff42bc585235d64_cgraph" id="asvm_8c_a4a9065695154691afff42bc585235d64_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,131,83"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="179,5,301,32"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="185,56,295,83"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="205,107,275,133"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="349,56,456,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a4a9065695154691afff42bc585235d64_icgraph.png" border="0" usemap="#asvm_8c_a4a9065695154691afff42bc585235d64_icgraph" alt=""/></div>
<map name="asvm_8c_a4a9065695154691afff42bc585235d64_icgraph" id="asvm_8c_a4a9065695154691afff42bc585235d64_icgraph">
<area shape="rect" title=" " alt="" coords="469,31,595,57"/>
<area shape="rect" href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa" title=" " alt="" coords="251,31,421,57"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,5,203,32"/>
<area shape="rect" href="svm_8c.html#a005049e4b080345fc3924233b8e33bce" title=" " alt="" coords="19,56,189,83"/>
</map>
</div>

</div>
</div>
<a id="a8dc8423f336a2a1ed01c6487383d4ba8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dc8423f336a2a1ed01c6487383d4ba8">&#9670;&nbsp;</a></span>svm_get_interrupt_shadow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u32 svm_get_interrupt_shadow </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00348">348</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;{</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    u32 ret = 0;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_state &amp; SVM_INTERRUPT_SHADOW_MASK)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        ret = KVM_X86_SHADOW_INT_STI | KVM_X86_SHADOW_INT_MOV_SS;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a8dc8423f336a2a1ed01c6487383d4ba8_cgraph.png" border="0" usemap="#asvm_8c_a8dc8423f336a2a1ed01c6487383d4ba8_cgraph" alt=""/></div>
<map name="asvm_8c_a8dc8423f336a2a1ed01c6487383d4ba8_cgraph" id="asvm_8c_a8dc8423f336a2a1ed01c6487383d4ba8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,204,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="252,5,323,32"/>
</map>
</div>

</div>
</div>
<a id="a25d69045754132f8878c2e1a65c2f163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25d69045754132f8878c2e1a65c2f163">&#9670;&nbsp;</a></span>svm_get_l2_tsc_multiplier()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 svm_get_l2_tsc_multiplier </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01147">1147</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;{</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">tsc_ratio_msr</a>;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a25d69045754132f8878c2e1a65c2f163_cgraph.png" border="0" usemap="#asvm_8c_a25d69045754132f8878c2e1a65c2f163_cgraph" alt=""/></div>
<map name="asvm_8c_a25d69045754132f8878c2e1a65c2f163_cgraph" id="asvm_8c_a25d69045754132f8878c2e1a65c2f163_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,199,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="247,5,317,32"/>
</map>
</div>

</div>
</div>
<a id="a147c81ec20836268891f32ecd6254f3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a147c81ec20836268891f32ecd6254f3a">&#9670;&nbsp;</a></span>svm_get_l2_tsc_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 svm_get_l2_tsc_offset </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01140">1140</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;{</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#aa8133737f749481d1105fbb6cfefa014">tsc_offset</a>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;}</div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_aa8133737f749481d1105fbb6cfefa014"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#aa8133737f749481d1105fbb6cfefa014">vmcb_ctrl_area_cached::tsc_offset</a></div><div class="ttdeci">u64 tsc_offset</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00131">svm.h:131</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a147c81ec20836268891f32ecd6254f3a_cgraph.png" border="0" usemap="#asvm_8c_a147c81ec20836268891f32ecd6254f3a_cgraph" alt=""/></div>
<map name="asvm_8c_a147c81ec20836268891f32ecd6254f3a_cgraph" id="asvm_8c_a147c81ec20836268891f32ecd6254f3a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,172,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="220,5,291,32"/>
</map>
</div>

</div>
</div>
<a id="a9ba5c45bbaca2c94f46c1a9ba653fcd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ba5c45bbaca2c94f46c1a9ba653fcd8">&#9670;&nbsp;</a></span>svm_get_lbr_vmcb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct vmcb* svm_get_lbr_vmcb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01026">1026</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;{</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">     * If LBR virtualization is disabled, the LBR MSRs are always kept in</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">     * vmcb01.  If LBR virtualization is enabled and L1 is running VMs of</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">     * its own, the MSRs are moved between vmcb01 and vmcb02 as needed.</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.virt_ext &amp; LBR_CTL_ENABLE_MASK ? svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a> :</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                   svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a9ba5c45bbaca2c94f46c1a9ba653fcd8_icgraph.png" border="0" usemap="#asvm_8c_a9ba5c45bbaca2c94f46c1a9ba653fcd8_icgraph" alt=""/></div>
<map name="asvm_8c_a9ba5c45bbaca2c94f46c1a9ba653fcd8_icgraph" id="asvm_8c_a9ba5c45bbaca2c94f46c1a9ba653fcd8_icgraph">
<area shape="rect" title=" " alt="" coords="2155,56,2300,83"/>
<area shape="rect" href="svm_8c.html#a091db4f6d8d0fc811fdd6d9b2a775889" title=" " alt="" coords="1984,5,2095,32"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1792,56,1901,83"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="1972,107,2107,133"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1769,287,1924,313"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,107,1213,133"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,287,1710,313"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,363,1721,405"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,236,1716,263"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,443,719,469"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,436,1717,463"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,170,1705,211"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,326,1437,367"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,275,1440,301"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,224,1427,251"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,333,1163,360"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,333,939,360"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,392,1459,419"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,158,1445,199"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,158,1195,199"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,140,945,167"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,191,940,217"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,443,520,469"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,468,323,495"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,468,128,495"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,443,1449,469"/>
</map>
</div>

</div>
</div>
<a id="a091db4f6d8d0fc811fdd6d9b2a775889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a091db4f6d8d0fc811fdd6d9b2a775889">&#9670;&nbsp;</a></span>svm_get_msr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_get_msr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct msr_data *&#160;</td>
          <td class="paramname"><em>msr_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02826">2826</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;{</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160; </div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="keywordflow">switch</span> (msr_info-&gt;index) {</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <span class="keywordflow">case</span> MSR_AMD64_TSC_RATIO:</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;        <span class="keywordflow">if</span> (!msr_info-&gt;host_initiated &amp;&amp;</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;            !<a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_TSCRATEMSR))</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">tsc_ratio_msr</a>;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    <span class="keywordflow">case</span> MSR_STAR:</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.star;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="preprocessor">#ifdef CONFIG_X86_64</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <span class="keywordflow">case</span> MSR_LSTAR:</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.lstar;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    <span class="keywordflow">case</span> MSR_CSTAR:</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.cstar;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    <span class="keywordflow">case</span> MSR_KERNEL_GS_BASE:</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.kernel_gs_base;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <span class="keywordflow">case</span> MSR_SYSCALL_MASK:</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.sfmask;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_SYSENTER_CS:</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.sysenter_cs;</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_SYSENTER_EIP:</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        msr_info-&gt;data = (u32)svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.sysenter_eip;</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        if (<a class="code" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d">guest_cpuid_is_intel</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;            msr_info-&gt;data |= (u64)svm-&gt;<a class="code" href="structvcpu__svm.html#a80fa0b4dcbb7f9758bd7c0c29e1ed1a5">sysenter_eip_hi</a> &lt;&lt; 32;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_SYSENTER_ESP:</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.sysenter_esp;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d">guest_cpuid_is_intel</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;            msr_info-&gt;data |= (u64)svm-&gt;<a class="code" href="structvcpu__svm.html#a747a3e237abb2217a6a93de9d17de74e">sysenter_esp_hi</a> &lt;&lt; 32;</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    <span class="keywordflow">case</span> MSR_TSC_AUX:</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#ae25c348c7b9864253f4db3fb8a3c3e59">tsc_aux</a>;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_DEBUGCTLMSR:</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        msr_info-&gt;data = <a class="code" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a>(svm)-&gt;save.dbgctl;</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_LASTBRANCHFROMIP:</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        msr_info-&gt;data = <a class="code" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a>(svm)-&gt;save.br_from;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_LASTBRANCHTOIP:</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;        msr_info-&gt;data = <a class="code" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a>(svm)-&gt;save.br_to;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_LASTINTFROMIP:</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;        msr_info-&gt;data = <a class="code" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a>(svm)-&gt;save.last_excp_from;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_LASTINTTOIP:</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        msr_info-&gt;data = <a class="code" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a>(svm)-&gt;save.last_excp_to;</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="keywordflow">case</span> MSR_VM_HSAVE_PA:</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#abb9c6243e2a90048413ab9d68a450e45">hsave_msr</a>;</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <span class="keywordflow">case</span> MSR_VM_CR:</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a07d2ebcca90ff4e7e8469a1cf7f720fe">vm_cr_msr</a>;</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_SPEC_CTRL:</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        <span class="keywordflow">if</span> (!msr_info-&gt;host_initiated &amp;&amp;</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;            !<a class="code" href="cpuid_8h.html#ad24a5bcf0ff93dc56c64e6867b8a2415">guest_has_spec_ctrl_msr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160; </div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_V_SPEC_CTRL))</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;            msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.spec_ctrl;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;            msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#a9a30016a1a0975a7ce12de950ec2a2cc">spec_ctrl</a>;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    <span class="keywordflow">case</span> MSR_AMD64_VIRT_SPEC_CTRL:</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        <span class="keywordflow">if</span> (!msr_info-&gt;host_initiated &amp;&amp;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;            !<a class="code" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_VIRT_SSBD))</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160; </div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#a78586d5e57b40fdc6d040b900300ef6d">virt_spec_ctrl</a>;</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    <span class="keywordflow">case</span> MSR_F15H_IC_CFG: {</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160; </div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        <span class="keywordtype">int</span> family, model;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160; </div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;        family = <a class="code" href="cpuid_8h.html#adaefbcb7a479c2699345d74eb1fe3602">guest_cpuid_family</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;        model  = <a class="code" href="cpuid_8h.html#a000a8b4d5c33ede65d4a34091f93b934">guest_cpuid_model</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160; </div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        <span class="keywordflow">if</span> (family &lt; 0 || model &lt; 0)</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a0e93cb5e88dc8c07d9357181a3a7b2e9">kvm_get_msr_common</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, msr_info);</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160; </div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        msr_info-&gt;data = 0;</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160; </div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;        <span class="keywordflow">if</span> (family == 0x15 &amp;&amp;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;            (model &gt;= 0x2 &amp;&amp; model &lt; 0x20))</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;            msr_info-&gt;data = 0x1E;</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        }</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    <span class="keywordflow">case</span> MSR_AMD64_DE_CFG:</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        msr_info-&gt;data = svm-&gt;<a class="code" href="structvcpu__svm.html#adb9edaf400032eba81ff85b2e419844a">msr_decfg</a>;</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a0e93cb5e88dc8c07d9357181a3a7b2e9">kvm_get_msr_common</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, msr_info);</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    }</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;}</div>
<div class="ttc" id="acpuid_8h_html_a000a8b4d5c33ede65d4a34091f93b934"><div class="ttname"><a href="cpuid_8h.html#a000a8b4d5c33ede65d4a34091f93b934">guest_cpuid_model</a></div><div class="ttdeci">static int guest_cpuid_model(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00144">cpuid.h:144</a></div></div>
<div class="ttc" id="acpuid_8h_html_acf67f5848a2ddd59dc852e37bc330390"><div class="ttname"><a href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a></div><div class="ttdeci">static __always_inline bool guest_can_use(struct kvm_vcpu *vcpu, unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00278">cpuid.h:278</a></div></div>
<div class="ttc" id="acpuid_8h_html_ad24a5bcf0ff93dc56c64e6867b8a2415"><div class="ttname"><a href="cpuid_8h.html#ad24a5bcf0ff93dc56c64e6867b8a2415">guest_has_spec_ctrl_msr</a></div><div class="ttdeci">static bool guest_has_spec_ctrl_msr(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00171">cpuid.h:171</a></div></div>
<div class="ttc" id="acpuid_8h_html_adaefbcb7a479c2699345d74eb1fe3602"><div class="ttname"><a href="cpuid_8h.html#adaefbcb7a479c2699345d74eb1fe3602">guest_cpuid_family</a></div><div class="ttdeci">static int guest_cpuid_family(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00133">cpuid.h:133</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a07d2ebcca90ff4e7e8469a1cf7f720fe"><div class="ttname"><a href="structsvm__nested__state.html#a07d2ebcca90ff4e7e8469a1cf7f720fe">svm_nested_state::vm_cr_msr</a></div><div class="ttdeci">u64 vm_cr_msr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00161">svm.h:161</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_abb9c6243e2a90048413ab9d68a450e45"><div class="ttname"><a href="structsvm__nested__state.html#abb9c6243e2a90048413ab9d68a450e45">svm_nested_state::hsave_msr</a></div><div class="ttdeci">u64 hsave_msr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00160">svm.h:160</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a747a3e237abb2217a6a93de9d17de74e"><div class="ttname"><a href="structvcpu__svm.html#a747a3e237abb2217a6a93de9d17de74e">vcpu_svm::sysenter_esp_hi</a></div><div class="ttdeci">u32 sysenter_esp_hi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00216">svm.h:216</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a78586d5e57b40fdc6d040b900300ef6d"><div class="ttname"><a href="structvcpu__svm.html#a78586d5e57b40fdc6d040b900300ef6d">vcpu_svm::virt_spec_ctrl</a></div><div class="ttdeci">u64 virt_spec_ctrl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00232">svm.h:232</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a80fa0b4dcbb7f9758bd7c0c29e1ed1a5"><div class="ttname"><a href="structvcpu__svm.html#a80fa0b4dcbb7f9758bd7c0c29e1ed1a5">vcpu_svm::sysenter_eip_hi</a></div><div class="ttdeci">u32 sysenter_eip_hi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00217">svm.h:217</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a9a30016a1a0975a7ce12de950ec2a2cc"><div class="ttname"><a href="structvcpu__svm.html#a9a30016a1a0975a7ce12de950ec2a2cc">vcpu_svm::spec_ctrl</a></div><div class="ttdeci">u64 spec_ctrl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00224">svm.h:224</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_adb9edaf400032eba81ff85b2e419844a"><div class="ttname"><a href="structvcpu__svm.html#adb9edaf400032eba81ff85b2e419844a">vcpu_svm::msr_decfg</a></div><div class="ttdeci">u64 msr_decfg</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00220">svm.h:220</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_ae25c348c7b9864253f4db3fb8a3c3e59"><div class="ttname"><a href="structvcpu__svm.html#ae25c348c7b9864253f4db3fb8a3c3e59">vcpu_svm::tsc_aux</a></div><div class="ttdeci">uint64_t tsc_aux</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00218">svm.h:218</a></div></div>
<div class="ttc" id="asvm_8c_html_a9ba5c45bbaca2c94f46c1a9ba653fcd8"><div class="ttname"><a href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a></div><div class="ttdeci">static struct vmcb * svm_get_lbr_vmcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01026">svm.c:1026</a></div></div>
<div class="ttc" id="ax86_8c_html_a0e93cb5e88dc8c07d9357181a3a7b2e9"><div class="ttname"><a href="x86_8c.html#a0e93cb5e88dc8c07d9357181a3a7b2e9">kvm_get_msr_common</a></div><div class="ttdeci">int kvm_get_msr_common(struct kvm_vcpu *vcpu, struct msr_data *msr_info)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l04182">x86.c:4182</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a091db4f6d8d0fc811fdd6d9b2a775889_cgraph.png" border="0" usemap="#asvm_8c_a091db4f6d8d0fc811fdd6d9b2a775889_cgraph" alt=""/></div>
<map name="asvm_8c_a091db4f6d8d0fc811fdd6d9b2a775889_cgraph" id="asvm_8c_a091db4f6d8d0fc811fdd6d9b2a775889_cgraph">
<area shape="rect" title=" " alt="" coords="5,267,116,294"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="197,63,316,90"/>
<area shape="rect" href="cpuid_8h.html#adaefbcb7a479c2699345d74eb1fe3602" title=" " alt="" coords="182,115,331,142"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="447,267,578,294"/>
<area shape="rect" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d" title=" " alt="" coords="179,217,334,243"/>
<area shape="rect" href="cpuid_8h.html#a000a8b4d5c33ede65d4a34091f93b934" title=" " alt="" coords="183,166,331,193"/>
<area shape="rect" href="cpuid_8h.html#ad24a5bcf0ff93dc56c64e6867b8a2415" title=" " alt="" coords="164,318,349,345"/>
<area shape="rect" href="x86_8c.html#a0e93cb5e88dc8c07d9357181a3a7b2e9" title=" " alt="" coords="169,473,344,499"/>
<area shape="rect" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8" title=" " alt="" coords="184,523,329,550"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="221,574,292,601"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="702,5,875,47"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="417,63,608,90"/>
<area shape="rect" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="430,139,595,166"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1176,101,1313,127"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="980,290,1087,317"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="696,187,881,214"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1372,265,1520,291"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1165,265,1324,291"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="949,189,1117,215"/>
<area shape="rect" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="951,123,1116,164"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="962,239,1105,266"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1187,214,1302,241"/>
<area shape="rect" href="kvm__emulate_8h.html#a61f034a07a99eee07bf2588db4d89494" title=" " alt="" coords="431,217,595,243"/>
<area shape="rect" href="x86_8c.html#a65afa365f7ef68d8d4f95e705b077d81" title=" " alt="" coords="457,574,568,601"/>
<area shape="rect" href="cpuid_8h.html#a831ae844ef432e45ec7a88f170a7e1dc" title=" " alt="" coords="457,625,568,651"/>
<area shape="rect" href="x86_8c.html#a62fc68a9f819c5044440e2cf6a7763e8" title=" " alt="" coords="437,675,588,702"/>
<area shape="rect" href="lapic_8c.html#af2fa5313476adb8240d3595805d784fc" title=" " alt="" coords="397,726,628,753"/>
<area shape="rect" href="hyperv_8c.html#a23d197f9ae27f820fa7e977aec518698" title=" " alt="" coords="413,979,612,1006"/>
<area shape="rect" href="x86_8c.html#a55618c7cba87bb75862507a65d590c17" title=" " alt="" coords="433,321,592,347"/>
<area shape="rect" href="mtrr_8c.html#a81a164c2615ef1c0fc231d71e5ba9a53" title=" " alt="" coords="439,371,586,398"/>
<area shape="rect" href="pmu_8c.html#a3e5c0df944435a47f03c7be238a08247" title=" " alt="" coords="439,422,586,449"/>
<area shape="rect" href="pmu_8c.html#a5051f59b2585f6137d3781a4d2bd0c38" title=" " alt="" coords="425,473,601,499"/>
<area shape="rect" href="x86_8c.html#a82290aaeb3d7ee560af215724efad4c2" title=" " alt="" coords="453,523,572,550"/>
<area shape="rect" href="lapic_8c.html#a179cfc2268db31f40b5bd9b1c247a37b" title=" " alt="" coords="428,802,597,829"/>
<area shape="rect" href="lapic_8c.html#adaceffbfc91320b193a66d974fb12ce0" title=" " alt="" coords="709,726,869,753"/>
<area shape="rect" href="lapic_8h.html#ae7e74fde3e4fb01f561634e789b5eab4" title=" " alt="" coords="718,675,859,702"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="974,751,1093,778"/>
<area shape="rect" href="hyperv_8c.html#acd3e0dad98bde91068115067f6ec3ae6" title=" " alt="" coords="721,979,856,1006"/>
<area shape="rect" href="hyperv_8c.html#ad5361485ecad0a70e99567d541738000" title=" " alt="" coords="709,1030,869,1057"/>
<area shape="rect" href="hyperv_8c.html#aab39439bc7208406fbf9d3e724bafc95" title=" " alt="" coords="685,1081,892,1107"/>
<area shape="rect" href="hyperv_8c.html#a6b9b9a8864c87d56aa2c400fa1331b0b" title=" " alt="" coords="719,929,859,955"/>
<area shape="rect" href="mtrr_8c.html#a39fe4726415af865aeb43bf8181e5610" title=" " alt="" coords="714,289,863,331"/>
<area shape="rect" href="mtrr_8c.html#a175681f9bc2f7ce2f99dd5e5f9d1da84" title=" " alt="" coords="719,355,858,382"/>
<area shape="rect" href="cpuid_8c.html#a8bf272b370f8a27bb68bf5bf9e5ae7d5" title=" " alt="" coords="697,407,881,448"/>
<area shape="rect" href="mtrr_8c.html#a9fde5f938b047bce967efc41c8b0e756" title=" " alt="" coords="728,473,849,499"/>
<area shape="rect" href="mtrr_8c.html#a48767cfb0bdec5a2a38ea0395fad54e9" title=" " alt="" coords="701,523,876,550"/>
<area shape="rect" href="pmu_8h.html#ad8246d56b5d561e26e120ebcc9f2c2e7" title=" " alt="" coords="676,574,901,601"/>
<area shape="rect" href="x86_8c.html#a6137b318fa926306eb86e2b06f78ef90" title=" " alt="" coords="741,625,837,651"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="717,878,860,905"/>
<area shape="rect" href="lapic_8c.html#a2913418710d9efa46bbdbb0070b766da" title=" " alt="" coords="710,777,867,803"/>
</map>
</div>

</div>
</div>
<a id="abed03713357a4ac6d8c5a1bf89e9ed10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abed03713357a4ac6d8c5a1bf89e9ed10">&#9670;&nbsp;</a></span>svm_get_msr_feature()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_get_msr_feature </td>
          <td>(</td>
          <td class="paramtype">struct kvm_msr_entry *&#160;</td>
          <td class="paramname"><em>msr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02810">2810</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;{</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    msr-&gt;data = 0;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; </div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    <span class="keywordflow">switch</span> (msr-&gt;index) {</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    <span class="keywordflow">case</span> MSR_AMD64_DE_CFG:</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        <span class="keywordflow">if</span> (cpu_feature_enabled(X86_FEATURE_LFENCE_RDTSC))</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;            msr-&gt;data |= MSR_AMD64_DE_CFG_LFENCE_SERIALIZE;</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8h.html#ab6b80774ea2294f5cbe77a62e510e3dd">KVM_MSR_RET_INVALID</a>;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    }</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160; </div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;}</div>
<div class="ttc" id="ax86_8h_html_ab6b80774ea2294f5cbe77a62e510e3dd"><div class="ttname"><a href="x86_8h.html#ab6b80774ea2294f5cbe77a62e510e3dd">KVM_MSR_RET_INVALID</a></div><div class="ttdeci">#define KVM_MSR_RET_INVALID</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00508">x86.h:508</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_abed03713357a4ac6d8c5a1bf89e9ed10_icgraph.png" border="0" usemap="#asvm_8c_abed03713357a4ac6d8c5a1bf89e9ed10_icgraph" alt=""/></div>
<map name="asvm_8c_abed03713357a4ac6d8c5a1bf89e9ed10_icgraph" id="asvm_8c_abed03713357a4ac6d8c5a1bf89e9ed10_icgraph">
<area shape="rect" title=" " alt="" coords="163,5,327,32"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="5,5,115,32"/>
</map>
</div>

</div>
</div>
<a id="ac87074e79786dc9fe0d4f587e5baf8b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac87074e79786dc9fe0d4f587e5baf8b3">&#9670;&nbsp;</a></span>svm_get_nmi_mask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_get_nmi_mask </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03706">3706</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;{</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160; </div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">is_vnmi_enabled</a>(svm))</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;        <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl &amp; V_NMI_BLOCKING_MASK;</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;        <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">nmi_masked</a>;</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ac87074e79786dc9fe0d4f587e5baf8b3_cgraph.png" border="0" usemap="#asvm_8c_ac87074e79786dc9fe0d4f587e5baf8b3_cgraph" alt=""/></div>
<map name="asvm_8c_ac87074e79786dc9fe0d4f587e5baf8b3_cgraph" id="asvm_8c_ac87074e79786dc9fe0d4f587e5baf8b3_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,159,57"/>
<area shape="rect" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d" title=" " alt="" coords="207,5,339,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="237,56,308,83"/>
<area shape="rect" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8" title=" " alt="" coords="387,5,532,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="580,5,700,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ac87074e79786dc9fe0d4f587e5baf8b3_icgraph.png" border="0" usemap="#asvm_8c_ac87074e79786dc9fe0d4f587e5baf8b3_icgraph" alt=""/></div>
<map name="asvm_8c_ac87074e79786dc9fe0d4f587e5baf8b3_icgraph" id="asvm_8c_ac87074e79786dc9fe0d4f587e5baf8b3_icgraph">
<area shape="rect" title=" " alt="" coords="489,31,643,57"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="251,5,441,32"/>
<area shape="rect" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e" title=" " alt="" coords="277,56,415,83"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,31,203,57"/>
<area shape="rect" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695" title=" " alt="" coords="34,81,174,108"/>
</map>
</div>

</div>
</div>
<a id="aebf053055bbd922cecbebdcd0bdecf09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebf053055bbd922cecbebdcd0bdecf09">&#9670;&nbsp;</a></span>svm_get_rflags()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned long svm_get_rflags </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01575">1575</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;{</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> rflags = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rflags;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">nmi_singlestep</a>) {</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="comment">/* Hide our flags if they were not set by the guest */</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordflow">if</span> (!(svm-&gt;<a class="code" href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">nmi_singlestep_guest_rflags</a> &amp; X86_EFLAGS_TF))</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            rflags &amp;= ~X86_EFLAGS_TF;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="keywordflow">if</span> (!(svm-&gt;<a class="code" href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">nmi_singlestep_guest_rflags</a> &amp; X86_EFLAGS_RF))</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            rflags &amp;= ~X86_EFLAGS_RF;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordflow">return</span> rflags;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aebf053055bbd922cecbebdcd0bdecf09_cgraph.png" border="0" usemap="#asvm_8c_aebf053055bbd922cecbebdcd0bdecf09_cgraph" alt=""/></div>
<map name="asvm_8c_aebf053055bbd922cecbebdcd0bdecf09_cgraph" id="asvm_8c_aebf053055bbd922cecbebdcd0bdecf09_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,127,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="175,5,245,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aebf053055bbd922cecbebdcd0bdecf09_icgraph.png" border="0" usemap="#asvm_8c_aebf053055bbd922cecbebdcd0bdecf09_icgraph" alt=""/></div>
<map name="asvm_8c_aebf053055bbd922cecbebdcd0bdecf09_icgraph" id="asvm_8c_aebf053055bbd922cecbebdcd0bdecf09_icgraph">
<area shape="rect" title=" " alt="" coords="244,5,365,32"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="5,5,196,32"/>
</map>
</div>

</div>
</div>
<a id="a6daa12edeead3fa3897d8e868a20c63e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6daa12edeead3fa3897d8e868a20c63e">&#9670;&nbsp;</a></span>svm_get_segment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_get_segment </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_segment *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01710">1710</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;{</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keyword">struct </span>vmcb_seg *s = <a class="code" href="svm_8c.html#aa1743f35bf86caa51b20a010c228520b">svm_seg</a>(vcpu, seg);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    var-&gt;base = s-&gt;base;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    var-&gt;limit = s-&gt;limit;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    var-&gt;selector = s-&gt;selector;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    var-&gt;type = s-&gt;attrib &amp; SVM_SELECTOR_TYPE_MASK;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    var-&gt;s = (s-&gt;attrib &gt;&gt; SVM_SELECTOR_S_SHIFT) &amp; 1;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    var-&gt;dpl = (s-&gt;attrib &gt;&gt; SVM_SELECTOR_DPL_SHIFT) &amp; 3;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    var-&gt;present = (s-&gt;attrib &gt;&gt; SVM_SELECTOR_P_SHIFT) &amp; 1;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    var-&gt;avl = (s-&gt;attrib &gt;&gt; SVM_SELECTOR_AVL_SHIFT) &amp; 1;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    var-&gt;l = (s-&gt;attrib &gt;&gt; SVM_SELECTOR_L_SHIFT) &amp; 1;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    var-&gt;db = (s-&gt;attrib &gt;&gt; SVM_SELECTOR_DB_SHIFT) &amp; 1;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment">     * AMD CPUs circa 2014 track the G bit for all segments except CS.</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">     * However, the SVM spec states that the G bit is not observed by the</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment">     * CPU, and some VMware virtual CPUs drop the G bit for all segments.</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">     * So let&#39;s synthesize a legal G bit for all segments, this helps</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="comment">     * running KVM nested. It also helps cross-vendor migration, because</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="comment">     * Intel&#39;s vmentry has a check on the &#39;G&#39; bit.</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    var-&gt;g = s-&gt;limit &gt; 0xfffff;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160; </div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment">     * AMD&#39;s VMCB does not have an explicit unusable field, so emulate it</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment">     * for cross vendor migration purposes by &quot;not present&quot;</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    var-&gt;unusable = !var-&gt;present;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keywordflow">switch</span> (seg) {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_TR:</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">         * Work around a bug where the busy flag in the tr selector</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">         * isn&#39;t exposed</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        var-&gt;type |= 0x2;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_DS:</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_ES:</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_FS:</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_GS:</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">         * The accessed bit must always be set in the segment</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment">         * descriptor cache, although it can be cleared in the</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment">         * descriptor, the cached bit always remains at 1. Since</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">         * Intel has a check on this, set it here to support</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment">         * cross-vendor migration.</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <span class="keywordflow">if</span> (!var-&gt;unusable)</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            var-&gt;type |= 0x1;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_SS:</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">         * On AMD CPUs sometimes the DB bit in the segment</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="comment">         * descriptor is left as 1, although the whole segment has</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="comment">         * been made unusable. Clear it here to pass an Intel VMX</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment">         * entry check when cross vendor migrating.</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="keywordflow">if</span> (var-&gt;unusable)</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            var-&gt;db = 0;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        <span class="comment">/* This is symmetric with svm_set_segment() */</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        var-&gt;dpl = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cpl;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    }</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_aa1743f35bf86caa51b20a010c228520b"><div class="ttname"><a href="svm_8c.html#aa1743f35bf86caa51b20a010c228520b">svm_seg</a></div><div class="ttdeci">static struct vmcb_seg * svm_seg(struct kvm_vcpu *vcpu, int seg)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01684">svm.c:1684</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a6daa12edeead3fa3897d8e868a20c63e_cgraph.png" border="0" usemap="#asvm_8c_a6daa12edeead3fa3897d8e868a20c63e_cgraph" alt=""/></div>
<map name="asvm_8c_a6daa12edeead3fa3897d8e868a20c63e_cgraph" id="asvm_8c_a6daa12edeead3fa3897d8e868a20c63e_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,148,57"/>
<area shape="rect" href="svm_8c.html#aa1743f35bf86caa51b20a010c228520b" title=" " alt="" coords="196,5,276,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="324,31,395,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a6daa12edeead3fa3897d8e868a20c63e_icgraph.png" border="0" usemap="#asvm_8c_a6daa12edeead3fa3897d8e868a20c63e_icgraph" alt=""/></div>
<map name="asvm_8c_a6daa12edeead3fa3897d8e868a20c63e_icgraph" id="asvm_8c_a6daa12edeead3fa3897d8e868a20c63e_icgraph">
<area shape="rect" title=" " alt="" coords="217,5,360,32"/>
<area shape="rect" href="svm_8c.html#aa993ddc604d61adf2f6b26668d37cee5" title=" " alt="" coords="5,5,169,32"/>
</map>
</div>

</div>
</div>
<a id="afe9828b3134c1b062cee0f740a236605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe9828b3134c1b062cee0f740a236605">&#9670;&nbsp;</a></span>svm_get_segment_base()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 svm_get_segment_base </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01703">1703</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;{</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="keyword">struct </span>vmcb_seg *s = <a class="code" href="svm_8c.html#aa1743f35bf86caa51b20a010c228520b">svm_seg</a>(vcpu, seg);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">return</span> s-&gt;base;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_afe9828b3134c1b062cee0f740a236605_cgraph.png" border="0" usemap="#asvm_8c_afe9828b3134c1b062cee0f740a236605_cgraph" alt=""/></div>
<map name="asvm_8c_afe9828b3134c1b062cee0f740a236605_cgraph" id="asvm_8c_afe9828b3134c1b062cee0f740a236605_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,185,32"/>
<area shape="rect" href="svm_8c.html#aa1743f35bf86caa51b20a010c228520b" title=" " alt="" coords="233,5,313,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="361,5,432,32"/>
</map>
</div>

</div>
</div>
<a id="a3f8983432f4aae138a6f4d167c561132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f8983432f4aae138a6f4d167c561132">&#9670;&nbsp;</a></span>svm_handle_exit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_handle_exit </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fastpath_t&#160;</td>
          <td class="paramname"><em>exit_fastpath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03490">3490</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;{</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;    <span class="keyword">struct </span>kvm_run *kvm_run = vcpu-&gt;run;</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;    u32 exit_code = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code;</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160; </div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;    <span class="comment">/* SEV-ES guests must use the CR write traps to track CR registers. */</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(vcpu-&gt;kvm)) {</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a>(svm, INTERCEPT_CR0_WRITE))</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;            vcpu-&gt;arch.cr0 = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cr0;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>)</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;            vcpu-&gt;arch.cr3 = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cr3;</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    }</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160; </div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(vcpu)) {</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;        <span class="keywordtype">int</span> vmexit;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160; </div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;        trace_kvm_nested_vmexit(vcpu, <a class="code" href="trace_8h.html#a4d128aa094f6d97def671922abd09d29">KVM_ISA_SVM</a>);</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160; </div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;        vmexit = <a class="code" href="svm_2nested_8c.html#abfe06c5436ae4d724c3c4495f8af136d">nested_svm_exit_special</a>(svm);</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160; </div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;        <span class="keywordflow">if</span> (vmexit == <a class="code" href="svm_8h.html#ac75660e3dace3bef9ab0d76dedf2034e">NESTED_EXIT_CONTINUE</a>)</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;            vmexit = <a class="code" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6">nested_svm_exit_handled</a>(svm);</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160; </div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;        <span class="keywordflow">if</span> (vmexit == <a class="code" href="svm_8h.html#a9c953f5ab9b400e9a1c5232515ec6293">NESTED_EXIT_DONE</a>)</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    }</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160; </div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code == SVM_EXIT_ERR) {</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        kvm_run-&gt;exit_reason = KVM_EXIT_FAIL_ENTRY;</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;        kvm_run-&gt;fail_entry.hardware_entry_failure_reason</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;            = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code;</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;        kvm_run-&gt;fail_entry.cpu = vcpu-&gt;arch.last_vmentry_cpu;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        <a class="code" href="svm_8c.html#adc30f731ef4ff2d797ec137e5fab0f69">dump_vmcb</a>(vcpu);</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;    }</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160; </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;    <span class="keywordflow">if</span> (exit_fastpath != EXIT_FASTPATH_NONE)</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160; </div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a8afafecae406016532810194f187fe2c">svm_invoke_exit_handler</a>(vcpu, exit_code);</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;}</div>
<div class="ttc" id="asvm_2nested_8c_html_abfe06c5436ae4d724c3c4495f8af136d"><div class="ttname"><a href="svm_2nested_8c.html#abfe06c5436ae4d724c3c4495f8af136d">nested_svm_exit_special</a></div><div class="ttdeci">int nested_svm_exit_special(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01496">nested.c:1496</a></div></div>
<div class="ttc" id="asvm_8c_html_a8afafecae406016532810194f187fe2c"><div class="ttname"><a href="svm_8c.html#a8afafecae406016532810194f187fe2c">svm_invoke_exit_handler</a></div><div class="ttdeci">int svm_invoke_exit_handler(struct kvm_vcpu *vcpu, u64 exit_code)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03453">svm.c:3453</a></div></div>
<div class="ttc" id="asvm_8c_html_adc30f731ef4ff2d797ec137e5fab0f69"><div class="ttname"><a href="svm_8c.html#adc30f731ef4ff2d797ec137e5fab0f69">dump_vmcb</a></div><div class="ttdeci">static void dump_vmcb(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03312">svm.c:3312</a></div></div>
<div class="ttc" id="asvm_8h_html_a397a88cd5af0b0bb8a9ef4a5e6bc849d"><div class="ttname"><a href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a></div><div class="ttdeci">static bool svm_is_intercept(struct vcpu_svm *svm, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00441">svm.h:441</a></div></div>
<div class="ttc" id="asvm_8h_html_ac75660e3dace3bef9ab0d76dedf2034e"><div class="ttname"><a href="svm_8h.html#ac75660e3dace3bef9ab0d76dedf2034e">NESTED_EXIT_CONTINUE</a></div><div class="ttdeci">#define NESTED_EXIT_CONTINUE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00567">svm.h:567</a></div></div>
<div class="ttc" id="atrace_8h_html_a4d128aa094f6d97def671922abd09d29"><div class="ttname"><a href="trace_8h.html#a4d128aa094f6d97def671922abd09d29">KVM_ISA_SVM</a></div><div class="ttdeci">#define KVM_ISA_SVM</div><div class="ttdef"><b>Definition:</b> <a href="trace_8h_source.html#l00284">trace.h:284</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a3f8983432f4aae138a6f4d167c561132_cgraph.png" border="0" usemap="#asvm_8c_a3f8983432f4aae138a6f4d167c561132_cgraph" alt=""/></div>
<map name="asvm_8c_a3f8983432f4aae138a6f4d167c561132_cgraph" id="asvm_8c_a3f8983432f4aae138a6f4d167c561132_cgraph">
<area shape="rect" title=" " alt="" coords="5,685,139,712"/>
<area shape="rect" href="svm_8c.html#adc30f731ef4ff2d797ec137e5fab0f69" title=" " alt="" coords="755,112,858,139"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1010,163,1081,189"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="223,660,343,687"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="187,711,379,737"/>
<area shape="rect" href="svm_2nested_8c.html#abfe06c5436ae4d724c3c4495f8af136d" title=" " alt="" coords="189,1055,376,1081"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="227,1140,338,1167"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="189,289,377,316"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="216,1260,349,1287"/>
<area shape="rect" href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba" title=" " alt="" coords="453,467,620,493"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="459,979,614,1005"/>
<area shape="rect" href="svm_2nested_8c.html#a90464b57b273a88a7a1fb3c2cefb257a" title=" " alt="" coords="695,365,919,392"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="967,391,1124,417"/>
<area shape="rect" href="svm_2nested_8c.html#ac11321f5c485c6fd9804b75a6b405f64" title=" " alt="" coords="708,416,905,443"/>
<area shape="rect" href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73" title=" " alt="" coords="708,517,905,544"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="747,568,866,595"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="726,619,887,645"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="726,670,887,711"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="730,735,883,777"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="745,801,868,828"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="727,852,886,879"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="722,903,891,929"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="749,953,864,980"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="749,1004,864,1031"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="751,1055,862,1081"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="749,1105,864,1132"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a30f9ca7e6fd08d1cf123f57fbfba01c7" title=" " alt="" coords="749,1156,864,1183"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633" title=" " alt="" coords="747,1207,866,1233"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="746,1257,867,1284"/>
<area shape="rect" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a" title=" " alt="" coords="741,1308,872,1335"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="744,1359,869,1385"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="736,1409,877,1436"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="734,1460,879,1487"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="731,467,882,493"/>
<area shape="rect" href="svm_2nested_8c.html#a5b731f64682240fd51bd242f194b33f4" title=" " alt="" coords="725,1511,888,1553"/>
<area shape="rect" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f" title=" " alt="" coords="705,1577,908,1618"/>
<area shape="rect" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab" title=" " alt="" coords="725,1643,888,1669"/>
<area shape="rect" href="svm_2nested_8c.html#af381358fd9991ce7d26d81fdb9f763a9" title=" " alt="" coords="721,1694,892,1735"/>
<area shape="rect" href="hyperv_8h.html#a902f3e7ce9ea9015898912540b132bd9" title=" " alt="" coords="460,1030,613,1071"/>
<area shape="rect" href="hyperv_8h.html#a1d303f485b6e5e724a2fecb90fa8534b" title=" " alt="" coords="459,1095,614,1137"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="445,1161,628,1202"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="483,1227,590,1253"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="427,163,647,189"/>
<area shape="rect" href="svm_8c.html#a21af2401d39dc5c49a388960ce1196ad" title=" " alt="" coords="472,315,601,341"/>
<area shape="rect" href="x86_8c.html#a92f17256a8d83aac265d08a1e3500340" title=" " alt="" coords="465,365,609,392"/>
<area shape="rect" href="svm_8c.html#a173c3f7c02a4287d140cc0f34564a7bd" title=" " alt="" coords="471,213,603,240"/>
<area shape="rect" href="svm_8c.html#a723646ac5d3234ba8e1845249e6a0935" title=" " alt="" coords="473,264,601,291"/>
<area shape="rect" href="svm_8c.html#ad838ad3f2e1e678e2c13720c679dc8f8" title=" " alt="" coords="453,416,620,443"/>
<area shape="rect" href="svm_8c.html#ab46a833ac93ce3fda7973768cadb1929" title=" " alt="" coords="445,112,629,139"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="466,1277,607,1304"/>
</map>
</div>

</div>
</div>
<a id="af104b66d9c914ae84dffcd6d99833e56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af104b66d9c914ae84dffcd6d99833e56">&#9670;&nbsp;</a></span>svm_handle_exit_irqoff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_handle_exit_irqoff </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04547">4547</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;{</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;vmcb-&gt;control.exit_code == SVM_EXIT_INTR)</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;        vcpu-&gt;arch.at_instruction_boundary = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af104b66d9c914ae84dffcd6d99833e56_cgraph.png" border="0" usemap="#asvm_8c_af104b66d9c914ae84dffcd6d99833e56_cgraph" alt=""/></div>
<map name="asvm_8c_af104b66d9c914ae84dffcd6d99833e56_cgraph" id="asvm_8c_af104b66d9c914ae84dffcd6d99833e56_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="228,5,299,32"/>
</map>
</div>

</div>
</div>
<a id="ab46a833ac93ce3fda7973768cadb1929"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab46a833ac93ce3fda7973768cadb1929">&#9670;&nbsp;</a></span>svm_handle_invalid_exit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_handle_invalid_exit </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>exit_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03441">3441</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;{</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    vcpu_unimpl(vcpu, <span class="stringliteral">&quot;svm: unexpected exit reason 0x%llx\n&quot;</span>, exit_code);</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;    <a class="code" href="svm_8c.html#adc30f731ef4ff2d797ec137e5fab0f69">dump_vmcb</a>(vcpu);</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;    vcpu-&gt;run-&gt;exit_reason = KVM_EXIT_INTERNAL_ERROR;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;    vcpu-&gt;run-&gt;internal.suberror = KVM_INTERNAL_ERROR_UNEXPECTED_EXIT_REASON;</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    vcpu-&gt;run-&gt;internal.ndata = 2;</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    vcpu-&gt;run-&gt;internal.data[0] = exit_code;</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    vcpu-&gt;run-&gt;internal.data[1] = vcpu-&gt;arch.last_vmentry_cpu;</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab46a833ac93ce3fda7973768cadb1929_cgraph.png" border="0" usemap="#asvm_8c_ab46a833ac93ce3fda7973768cadb1929_cgraph" alt=""/></div>
<map name="asvm_8c_ab46a833ac93ce3fda7973768cadb1929_cgraph" id="asvm_8c_ab46a833ac93ce3fda7973768cadb1929_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,189,32"/>
<area shape="rect" href="svm_8c.html#adc30f731ef4ff2d797ec137e5fab0f69" title=" " alt="" coords="237,5,340,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="388,5,459,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab46a833ac93ce3fda7973768cadb1929_icgraph.png" border="0" usemap="#asvm_8c_ab46a833ac93ce3fda7973768cadb1929_icgraph" alt=""/></div>
<map name="asvm_8c_ab46a833ac93ce3fda7973768cadb1929_icgraph" id="asvm_8c_ab46a833ac93ce3fda7973768cadb1929_icgraph">
<area shape="rect" title=" " alt="" coords="652,35,836,61"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="416,35,604,61"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="5,5,163,32"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="211,27,368,69"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="223,93,356,120"/>
</map>
</div>

</div>
</div>
<a id="af1c9d228af74c8b5f794a4babc5d465b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1c9d228af74c8b5f794a4babc5d465b">&#9670;&nbsp;</a></span>svm_handle_mce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_handle_mce </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02159">2159</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;{</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ac7c5304a8c015386109035f7ab577919">is_erratum_383</a>()) {</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="comment">         * Erratum 383 triggered. Guest state is corrupt so kill the</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment">         * guest.</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        pr_err(<span class="stringliteral">&quot;Guest triggered AMD Erratum 383\n&quot;</span>);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        kvm_make_request(KVM_REQ_TRIPLE_FAULT, vcpu);</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160; </div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    }</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment">     * On an #MC intercept the MCE handler is not called automatically in</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">     * the host. So do it by hand here.</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <a class="code" href="x86_8h.html#aa539ceac11af1b634966fdd3d8c68cc5">kvm_machine_check</a>();</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_ac7c5304a8c015386109035f7ab577919"><div class="ttname"><a href="svm_8c.html#ac7c5304a8c015386109035f7ab577919">is_erratum_383</a></div><div class="ttdeci">static bool is_erratum_383(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02120">svm.c:2120</a></div></div>
<div class="ttc" id="ax86_8h_html_aa539ceac11af1b634966fdd3d8c68cc5"><div class="ttname"><a href="x86_8h.html#aa539ceac11af1b634966fdd3d8c68cc5">kvm_machine_check</a></div><div class="ttdeci">static void kvm_machine_check(void)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00482">x86.h:482</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af1c9d228af74c8b5f794a4babc5d465b_cgraph.png" border="0" usemap="#asvm_8c_af1c9d228af74c8b5f794a4babc5d465b_cgraph" alt=""/></div>
<map name="asvm_8c_af1c9d228af74c8b5f794a4babc5d465b_cgraph" id="asvm_8c_af1c9d228af74c8b5f794a4babc5d465b_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,141,57"/>
<area shape="rect" href="svm_8c.html#ac7c5304a8c015386109035f7ab577919" title=" " alt="" coords="207,5,330,32"/>
<area shape="rect" href="x86_8h.html#aa539ceac11af1b634966fdd3d8c68cc5" title=" " alt="" coords="189,56,348,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af1c9d228af74c8b5f794a4babc5d465b_icgraph.png" border="0" usemap="#asvm_8c_af1c9d228af74c8b5f794a4babc5d465b_icgraph" alt=""/></div>
<map name="asvm_8c_af1c9d228af74c8b5f794a4babc5d465b_icgraph" id="asvm_8c_af1c9d228af74c8b5f794a4babc5d465b_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,305,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="accd19fd9a37bd9d9ed52a1f26a86e7b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accd19fd9a37bd9d9ed52a1f26a86e7b5">&#9670;&nbsp;</a></span>svm_hardware_disable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_hardware_disable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00595">595</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">/* Make sure we clean up behind us */</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#adacf7fe5bb2bb2fdef07153a859b75ba">tsc_scaling</a>)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34">__svm_write_tsc_multiplier</a>(SVM_TSC_RATIO_DEFAULT);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <a class="code" href="svm_8c.html#a53176c61179bfcec5f1c122b110cc8c3">kvm_cpu_svm_disable</a>();</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    amd_pmu_disable_virt();</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a66671c85c774356d50d71cbd11633a34"><div class="ttname"><a href="svm_8c.html#a66671c85c774356d50d71cbd11633a34">__svm_write_tsc_multiplier</a></div><div class="ttdeci">static void __svm_write_tsc_multiplier(u64 multiplier)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00563">svm.c:563</a></div></div>
<div class="ttc" id="asvm_8c_html_adacf7fe5bb2bb2fdef07153a859b75ba"><div class="ttname"><a href="svm_8c.html#adacf7fe5bb2bb2fdef07153a859b75ba">tsc_scaling</a></div><div class="ttdeci">static int tsc_scaling</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00221">svm.c:221</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_accd19fd9a37bd9d9ed52a1f26a86e7b5_cgraph.png" border="0" usemap="#asvm_8c_accd19fd9a37bd9d9ed52a1f26a86e7b5_cgraph" alt=""/></div>
<map name="asvm_8c_accd19fd9a37bd9d9ed52a1f26a86e7b5_cgraph" id="asvm_8c_accd19fd9a37bd9d9ed52a1f26a86e7b5_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,177,57"/>
<area shape="rect" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34" title=" " alt="" coords="225,5,425,32"/>
<area shape="rect" href="svm_8c.html#a53176c61179bfcec5f1c122b110cc8c3" title=" " alt="" coords="240,56,411,83"/>
<area shape="rect" href="svm__ops_8h.html#a97407302752e909143951887456521ef" title=" " alt="" coords="473,56,520,83"/>
</map>
</div>

</div>
</div>
<a id="ace8f9c582674fc49f475a61c3e9ed257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace8f9c582674fc49f475a61c3e9ed257">&#9670;&nbsp;</a></span>svm_hardware_enable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_hardware_enable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00606">606</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;{</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a> *sd;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    uint64_t efer;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">int</span> me = raw_smp_processor_id();</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    rdmsrl(MSR_EFER, efer);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">if</span> (efer &amp; EFER_SVME)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">return</span> -EBUSY;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    sd = per_cpu_ptr(&amp;svm_data, me);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#ab20eb4010776c6fe52661fcf95cdc017">asid_generation</a> = 1;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#a2e5110b54e6436c6a017892e0b4a37db">max_asid</a> = cpuid_ebx(SVM_CPUID_FUNC) - 1;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#a8dec08f7e08061480ab12f9b5426991d">next_asid</a> = sd-&gt;<a class="code" href="structsvm__cpu__data.html#a2e5110b54e6436c6a017892e0b4a37db">max_asid</a> + 1;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#a86b414e2f46215b5b4d4e0d7e207dd7a">min_asid</a> = <a class="code" href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a> + 1;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    wrmsrl(MSR_EFER, efer | EFER_SVME);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    wrmsrl(MSR_VM_HSAVE_PA, sd-&gt;<a class="code" href="structsvm__cpu__data.html#a7b3be8bfedec131eb474be2ec6a8de10">save_area_pa</a>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span> (static_cpu_has(X86_FEATURE_TSCRATEMSR)) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">         * Set the default value, even if we don&#39;t use TSC scaling</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">         * to avoid having stale value in the msr</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <a class="code" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34">__svm_write_tsc_multiplier</a>(SVM_TSC_RATIO_DEFAULT);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">     * Get OSVW bits.</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">     * Note that it is possible to have a system with mixed processor</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">     * revisions and therefore different OSVW bits. If bits are not the same</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">     * on different processors then choose the worst case (i.e. if erratum</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">     * is present on one processor and not on another then assume that the</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">     * erratum is present everywhere).</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">if</span> (cpu_has(&amp;boot_cpu_data, X86_FEATURE_OSVW)) {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        uint64_t len, status = 0;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        len = native_read_msr_safe(MSR_AMD64_OSVW_ID_LENGTH, &amp;err);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">if</span> (!err)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            status = native_read_msr_safe(MSR_AMD64_OSVW_STATUS,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                              &amp;err);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">if</span> (err)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <a class="code" href="svm_8c.html#ad74f8bf67f324d305a1bde6cebadd841">osvw_status</a> = <a class="code" href="svm_8c.html#a9cd9c6d58f164e1428e93fac80a1fc34">osvw_len</a> = 0;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keywordflow">if</span> (len &lt; <a class="code" href="svm_8c.html#a9cd9c6d58f164e1428e93fac80a1fc34">osvw_len</a>)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                <a class="code" href="svm_8c.html#a9cd9c6d58f164e1428e93fac80a1fc34">osvw_len</a> = len;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <a class="code" href="svm_8c.html#ad74f8bf67f324d305a1bde6cebadd841">osvw_status</a> |= status;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <a class="code" href="svm_8c.html#ad74f8bf67f324d305a1bde6cebadd841">osvw_status</a> &amp;= (1ULL &lt;&lt; <a class="code" href="svm_8c.html#a9cd9c6d58f164e1428e93fac80a1fc34">osvw_len</a>) - 1;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <a class="code" href="svm_8c.html#ad74f8bf67f324d305a1bde6cebadd841">osvw_status</a> = <a class="code" href="svm_8c.html#a9cd9c6d58f164e1428e93fac80a1fc34">osvw_len</a> = 0;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="svm_8c.html#a845aceb79827a59a1e6e703aeee0b02a">svm_init_erratum_383</a>();</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    amd_pmu_enable_virt();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">     * If TSC_AUX virtualization is supported, TSC_AUX becomes a swap type</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">     * &quot;B&quot; field (see sev_es_prepare_switch_to_guest()) for SEV-ES guests.</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">     * Since Linux does not change the value of TSC_AUX once set, prime the</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">     * TSC_AUX field now to avoid a RDMSR on every vCPU run.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_V_TSC_AUX)) {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keyword">struct </span>sev_es_save_area *hostsa;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        u32 __maybe_unused msr_hi;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        hostsa = (<span class="keyword">struct </span>sev_es_save_area *)(page_address(sd-&gt;<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a>) + 0x400);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        rdmsr(MSR_TSC_AUX, hostsa-&gt;tsc_aux, msr_hi);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a37d57b174f959f39f30e8f0796dc3afb"><div class="ttname"><a href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a></div><div class="ttdeci">unsigned int max_sev_asid</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00071">sev.c:71</a></div></div>
<div class="ttc" id="asvm_8c_html_a845aceb79827a59a1e6e703aeee0b02a"><div class="ttname"><a href="svm_8c.html#a845aceb79827a59a1e6e703aeee0b02a">svm_init_erratum_383</a></div><div class="ttdeci">static void svm_init_erratum_383(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00475">svm.c:475</a></div></div>
<div class="ttc" id="asvm_8c_html_a9cd9c6d58f164e1428e93fac80a1fc34"><div class="ttname"><a href="svm_8c.html#a9cd9c6d58f164e1428e93fac80a1fc34">osvw_len</a></div><div class="ttdeci">static uint64_t osvw_len</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00077">svm.c:77</a></div></div>
<div class="ttc" id="asvm_8c_html_ad74f8bf67f324d305a1bde6cebadd841"><div class="ttname"><a href="svm_8c.html#ad74f8bf67f324d305a1bde6cebadd841">osvw_status</a></div><div class="ttdeci">static uint64_t osvw_status</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00077">svm.c:77</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ace8f9c582674fc49f475a61c3e9ed257_cgraph.png" border="0" usemap="#asvm_8c_ace8f9c582674fc49f475a61c3e9ed257_cgraph" alt=""/></div>
<map name="asvm_8c_ace8f9c582674fc49f475a61c3e9ed257_cgraph" id="asvm_8c_ace8f9c582674fc49f475a61c3e9ed257_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,175,57"/>
<area shape="rect" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34" title=" " alt="" coords="223,5,423,32"/>
<area shape="rect" href="svm_8c.html#a845aceb79827a59a1e6e703aeee0b02a" title=" " alt="" coords="239,56,407,83"/>
</map>
</div>

</div>
</div>
<a id="aa4cdf4791105d54ebcadfeafdcdf01ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4cdf4791105d54ebcadfeafdcdf01ac">&#9670;&nbsp;</a></span>svm_hardware_setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __init int svm_hardware_setup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l05152">5152</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;{</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;    <span class="keywordtype">int</span> cpu;</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;    <span class="keyword">struct </span>page *iopm_pages;</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;    <span class="keywordtype">void</span> *iopm_va;</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> order = get_order(<a class="code" href="svm_8h.html#a3db0df1165fd78ebd0af2184562f090c">IOPM_SIZE</a>);</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160; </div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;<span class="comment">     * NX is required for shadow paging and for NPT if the NX huge pages</span></div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;<span class="comment">     * mitigation is enabled.</span></div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;    <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_NX)) {</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;        pr_err_ratelimited(<span class="stringliteral">&quot;NX (Execute Disable) not supported\n&quot;</span>);</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;        <span class="keywordflow">return</span> -EOPNOTSUPP;</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;    }</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;    <a class="code" href="x86_8c.html#ae273e27a68a0bcb1705012232ea34204">kvm_enable_efer_bits</a>(EFER_NX);</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160; </div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;    iopm_pages = alloc_pages(GFP_KERNEL, order);</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160; </div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;    <span class="keywordflow">if</span> (!iopm_pages)</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160; </div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;    iopm_va = page_address(iopm_pages);</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;    memset(iopm_va, 0xff, PAGE_SIZE * (1 &lt;&lt; order));</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;    <a class="code" href="svm_8c.html#a14f8324fee7e48032e60893cd7590076">iopm_base</a> = page_to_pfn(iopm_pages) &lt;&lt; PAGE_SHIFT;</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160; </div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;    <a class="code" href="svm_8c.html#a0a9af31dcd464498479ea7b57cdc106f">init_msrpm_offsets</a>();</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160; </div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;    <a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#acb835ad2fee6979c5058003aa5cb601a">supported_xcr0</a> &amp;= ~(XFEATURE_MASK_BNDREGS |</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;                     XFEATURE_MASK_BNDCSR);</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160; </div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_FXSR_OPT))</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;        <a class="code" href="x86_8c.html#ae273e27a68a0bcb1705012232ea34204">kvm_enable_efer_bits</a>(EFER_FFXSR);</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160; </div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#adacf7fe5bb2bb2fdef07153a859b75ba">tsc_scaling</a>) {</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;        <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_TSCRATEMSR)) {</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;            <a class="code" href="svm_8c.html#adacf7fe5bb2bb2fdef07153a859b75ba">tsc_scaling</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;            pr_info(<span class="stringliteral">&quot;TSC scaling supported\n&quot;</span>);</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;            <a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#abcc6bf2008df1844dba6d861c15712a7">has_tsc_control</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;        }</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;    }</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;    <a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#a955589a58e0cf935c8c4536ba2712fd4">max_tsc_scaling_ratio</a> = SVM_TSC_RATIO_MAX;</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;    <a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#ab5f7d5c3ca8acc0bd672f8a2d0655c9c">tsc_scaling_ratio_frac_bits</a> = 32;</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160; </div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;    tsc_aux_uret_slot = <a class="code" href="x86_8c.html#a94e6fe0995d79d296c6b38669db7e139">kvm_add_user_return_msr</a>(MSR_TSC_AUX);</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160; </div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_AUTOIBRS))</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;        <a class="code" href="x86_8c.html#ae273e27a68a0bcb1705012232ea34204">kvm_enable_efer_bits</a>(EFER_AUTOIBRS);</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160; </div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;    <span class="comment">/* Check for pause filtering support */</span></div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;    <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_PAUSEFILTER)) {</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;        <a class="code" href="svm_8c.html#a3bc68316af32e407d865d83e00a03316">pause_filter_count</a> = 0;</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;        <a class="code" href="svm_8c.html#a7844865730b4425faa277774dddb41b6">pause_filter_thresh</a> = 0;</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_PFTHRESHOLD)) {</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;        <a class="code" href="svm_8c.html#a7844865730b4425faa277774dddb41b6">pause_filter_thresh</a> = 0;</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;    }</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160; </div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#abe2e85eb9e667809ab7e5dd3ad442b26">nested</a>) {</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;        pr_info(<span class="stringliteral">&quot;Nested Virtualization enabled\n&quot;</span>);</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;        <a class="code" href="x86_8c.html#ae273e27a68a0bcb1705012232ea34204">kvm_enable_efer_bits</a>(EFER_SVME | EFER_LMSLE);</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;    }</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160; </div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;<span class="comment">     * KVM&#39;s MMU doesn&#39;t support using 2-level paging for itself, and thus</span></div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;<span class="comment">     * NPT isn&#39;t supported if the host is using 2-level paging since host</span></div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;<span class="comment">     * CR4 is unchanged on VMRUN.</span></div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;    <span class="keywordflow">if</span> (!IS_ENABLED(CONFIG_X86_64) &amp;&amp; !IS_ENABLED(CONFIG_X86_PAE))</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;        <a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160; </div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;    <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_NPT))</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;        <a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160; </div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;    <span class="comment">/* Force VM NPT level equal to the host&#39;s paging level */</span></div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;    <a class="code" href="mmu_8c.html#a951ec475b6a27cf3b2203305636ff29e">kvm_configure_mmu</a>(<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>, <a class="code" href="svm_8c.html#a1a78719a48d64b80ead6c34e9ab1cccf">get_npt_level</a>(),</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;              <a class="code" href="svm_8c.html#a1a78719a48d64b80ead6c34e9ab1cccf">get_npt_level</a>(), PG_LEVEL_1G);</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;    pr_info(<span class="stringliteral">&quot;Nested Paging %sabled\n&quot;</span>, <a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a> ? <span class="stringliteral">&quot;en&quot;</span> : <span class="stringliteral">&quot;dis&quot;</span>);</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160; </div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;    <span class="comment">/* Setup shadow_me_value and shadow_me_mask */</span></div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;    <a class="code" href="spte_8c.html#a24f526505004d8f749e0e069c2efd17a">kvm_mmu_set_me_spte_mask</a>(sme_me_mask, sme_me_mask);</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160; </div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;    <a class="code" href="svm_8c.html#ae9ce56e3c8875ba1d607bb1be8ed420f">svm_adjust_mmio_mask</a>();</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160; </div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;    <a class="code" href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a> = <a class="code" href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a> &amp;&amp; boot_cpu_has(X86_FEATURE_NRIPS);</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160; </div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;<span class="comment">     * Note, SEV setup consumes npt_enabled and enable_mmio_caching (which</span></div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;<span class="comment">     * may be modified by svm_adjust_mmio_mask()), as well as nrips.</span></div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;    <a class="code" href="sev_8c.html#a9afc6299b4f92c15a93b02db0318ad79">sev_hardware_setup</a>();</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160; </div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;    <a class="code" href="svm__onhyperv_8h.html#a3f87b0238d2174299072ab571b628edf">svm_hv_hardware_setup</a>();</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160; </div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;    for_each_possible_cpu(cpu) {</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;        r = <a class="code" href="svm_8c.html#ad791a60fcdb50ec0a9aeb753e780ddb6">svm_cpu_init</a>(cpu);</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;        <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;            <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;    }</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160; </div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;    <a class="code" href="x86_8c.html#a04af9ab3eee510b54cba17a6fa94ee04">enable_apicv</a> = <a class="code" href="svm_8c.html#a8c4ea69d2d0310307567f305689357f8">avic</a> = <a class="code" href="svm_8c.html#a8c4ea69d2d0310307567f305689357f8">avic</a> &amp;&amp; <a class="code" href="avic_8c.html#ada833d2b35b3e565a6900b25d1cce7c7">avic_hardware_setup</a>();</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160; </div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a04af9ab3eee510b54cba17a6fa94ee04">enable_apicv</a>) {</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;        svm_x86_ops.vcpu_blocking = NULL;</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;        svm_x86_ops.vcpu_unblocking = NULL;</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;        svm_x86_ops.vcpu_get_apicv_inhibit_reasons = NULL;</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="avic_8c.html#ad4c0ba70ab315cedbb11f259b1d7ae08">x2avic_enabled</a>) {</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;        svm_x86_ops.allow_apicv_in_x2apic_without_x2apic_virtualization = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;    }</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160; </div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a3ad937a1fd2ef8fcdd87953c6a5db405">vls</a>) {</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a> ||</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;            !boot_cpu_has(X86_FEATURE_V_VMSAVE_VMLOAD) ||</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;            !IS_ENABLED(CONFIG_X86_64)) {</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;            <a class="code" href="svm_8c.html#a3ad937a1fd2ef8fcdd87953c6a5db405">vls</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;            pr_info(<span class="stringliteral">&quot;Virtual VMLOAD VMSAVE supported\n&quot;</span>);</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;        }</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;    }</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160; </div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_SVME_ADDR_CHK))</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;        <a class="code" href="svm_8c.html#a275c3d046aa0623ea238016c5002acbd">svm_gp_erratum_intercept</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160; </div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>) {</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;        <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_VGIF))</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;            <a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;            pr_info(<span class="stringliteral">&quot;Virtual GIF supported\n&quot;</span>);</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;    }</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160; </div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;    <a class="code" href="svm_8c.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a> = <a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a> &amp;&amp; <a class="code" href="svm_8c.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a> &amp;&amp; boot_cpu_has(X86_FEATURE_VNMI);</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a>)</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;        pr_info(<span class="stringliteral">&quot;Virtual NMI enabled\n&quot;</span>);</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160; </div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a>) {</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;        svm_x86_ops.is_vnmi_pending = NULL;</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;        svm_x86_ops.set_vnmi_pending = NULL;</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;    }</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160; </div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160; </div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ac6093899c4533e4c669b24862528077d">lbrv</a>) {</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;        <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_LBRV))</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;            <a class="code" href="svm_8c.html#ac6093899c4533e4c669b24862528077d">lbrv</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;            pr_info(<span class="stringliteral">&quot;LBR virtualization supported\n&quot;</span>);</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;    }</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160; </div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a868c360a5f6eb018cc1d24ecd766d971">enable_pmu</a>)</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;        pr_info(<span class="stringliteral">&quot;PMU virtualization is disabled\n&quot;</span>);</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160; </div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;    <a class="code" href="svm_8c.html#ab2ed2d9e233f1c6a1a3c806826d63401">svm_set_cpu_caps</a>();</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160; </div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;<span class="comment">     * It seems that on AMD processors PTE&#39;s accessed bit is</span></div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;<span class="comment">     * being set by the CPU hardware before the NPF vmexit.</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;<span class="comment">     * This is not expected behaviour and our tests fail because</span></div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;<span class="comment">     * of it.</span></div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;<span class="comment">     * A workaround here is to disable support for</span></div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;<span class="comment">     * GUEST_MAXPHYADDR &lt; HOST_MAXPHYADDR if NPT is enabled.</span></div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;<span class="comment">     * In this case userspace can know if there is support using</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;<span class="comment">     * KVM_CAP_SMALLER_MAXPHYADDR extension and decide how to handle</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;<span class="comment">     * it</span></div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;<span class="comment">     * If future AMD CPU models change the behaviour described above,</span></div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;<span class="comment">     * this variable can be changed accordingly</span></div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;    <a class="code" href="vmx_8c.html#a81470553890562f7758333794b26f1ec">allow_smaller_maxphyaddr</a> = !<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>;</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160; </div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160; </div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;err:</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;    <a class="code" href="svm_8c.html#a96aba01528b17e2beabf86e9c19ac13a">svm_hardware_unsetup</a>();</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_ad4c0ba70ab315cedbb11f259b1d7ae08"><div class="ttname"><a href="avic_8c.html#ad4c0ba70ab315cedbb11f259b1d7ae08">x2avic_enabled</a></div><div class="ttdeci">bool x2avic_enabled</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00075">avic.c:75</a></div></div>
<div class="ttc" id="aavic_8c_html_ada833d2b35b3e565a6900b25d1cce7c7"><div class="ttname"><a href="avic_8c.html#ada833d2b35b3e565a6900b25d1cce7c7">avic_hardware_setup</a></div><div class="ttdeci">bool avic_hardware_setup(void)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01188">avic.c:1188</a></div></div>
<div class="ttc" id="ammu_8c_html_a951ec475b6a27cf3b2203305636ff29e"><div class="ttname"><a href="mmu_8c.html#a951ec475b6a27cf3b2203305636ff29e">kvm_configure_mmu</a></div><div class="ttdeci">void kvm_configure_mmu(bool enable_tdp, int tdp_forced_root_level, int tdp_max_root_level, int tdp_huge_page_level)</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8c_source.html#l06012">mmu.c:6012</a></div></div>
<div class="ttc" id="asev_8c_html_a9afc6299b4f92c15a93b02db0318ad79"><div class="ttname"><a href="sev_8c.html#a9afc6299b4f92c15a93b02db0318ad79">sev_hardware_setup</a></div><div class="ttdeci">void __init sev_hardware_setup(void)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02193">sev.c:2193</a></div></div>
<div class="ttc" id="aspte_8c_html_a24f526505004d8f749e0e069c2efd17a"><div class="ttname"><a href="spte_8c.html#a24f526505004d8f749e0e069c2efd17a">kvm_mmu_set_me_spte_mask</a></div><div class="ttdeci">void kvm_mmu_set_me_spte_mask(u64 me_value, u64 me_mask)</div><div class="ttdef"><b>Definition:</b> <a href="spte_8c_source.html#l00414">spte.c:414</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a955589a58e0cf935c8c4536ba2712fd4"><div class="ttname"><a href="structkvm__caps.html#a955589a58e0cf935c8c4536ba2712fd4">kvm_caps::max_tsc_scaling_ratio</a></div><div class="ttdeci">u64 max_tsc_scaling_ratio</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00020">x86.h:20</a></div></div>
<div class="ttc" id="astructkvm__caps_html_ab5f7d5c3ca8acc0bd672f8a2d0655c9c"><div class="ttname"><a href="structkvm__caps.html#ab5f7d5c3ca8acc0bd672f8a2d0655c9c">kvm_caps::tsc_scaling_ratio_frac_bits</a></div><div class="ttdeci">u8 tsc_scaling_ratio_frac_bits</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00018">x86.h:18</a></div></div>
<div class="ttc" id="astructkvm__caps_html_abcc6bf2008df1844dba6d861c15712a7"><div class="ttname"><a href="structkvm__caps.html#abcc6bf2008df1844dba6d861c15712a7">kvm_caps::has_tsc_control</a></div><div class="ttdeci">bool has_tsc_control</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00014">x86.h:14</a></div></div>
<div class="ttc" id="astructkvm__caps_html_acb835ad2fee6979c5058003aa5cb601a"><div class="ttname"><a href="structkvm__caps.html#acb835ad2fee6979c5058003aa5cb601a">kvm_caps::supported_xcr0</a></div><div class="ttdeci">u64 supported_xcr0</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00029">x86.h:29</a></div></div>
<div class="ttc" id="asvm_8c_html_a0a9af31dcd464498479ea7b57cdc106f"><div class="ttname"><a href="svm_8c.html#a0a9af31dcd464498479ea7b57cdc106f">init_msrpm_offsets</a></div><div class="ttdeci">static void init_msrpm_offsets(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00966">svm.c:966</a></div></div>
<div class="ttc" id="asvm_8c_html_a1a78719a48d64b80ead6c34e9ab1cccf"><div class="ttname"><a href="svm_8c.html#a1a78719a48d64b80ead6c34e9ab1cccf">get_npt_level</a></div><div class="ttdeci">static int get_npt_level(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00287">svm.c:287</a></div></div>
<div class="ttc" id="asvm_8c_html_a275c3d046aa0623ea238016c5002acbd"><div class="ttname"><a href="svm_8c.html#a275c3d046aa0623ea238016c5002acbd">svm_gp_erratum_intercept</a></div><div class="ttdeci">static bool svm_gp_erratum_intercept</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00241">svm.c:241</a></div></div>
<div class="ttc" id="asvm_8c_html_a8c4ea69d2d0310307567f305689357f8"><div class="ttname"><a href="svm_8c.html#a8c4ea69d2d0310307567f305689357f8">avic</a></div><div class="ttdeci">static bool avic</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00228">svm.c:228</a></div></div>
<div class="ttc" id="asvm_8c_html_a96aba01528b17e2beabf86e9c19ac13a"><div class="ttname"><a href="svm_8c.html#a96aba01528b17e2beabf86e9c19ac13a">svm_hardware_unsetup</a></div><div class="ttdeci">static void svm_hardware_unsetup(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01109">svm.c:1109</a></div></div>
<div class="ttc" id="asvm_8c_html_ab2ed2d9e233f1c6a1a3c806826d63401"><div class="ttname"><a href="svm_8c.html#ab2ed2d9e233f1c6a1a3c806826d63401">svm_set_cpu_caps</a></div><div class="ttdeci">static __init void svm_set_cpu_caps(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l05077">svm.c:5077</a></div></div>
<div class="ttc" id="asvm_8c_html_abe2e85eb9e667809ab7e5dd3ad442b26"><div class="ttname"><a href="svm_8c.html#abe2e85eb9e667809ab7e5dd3ad442b26">nested</a></div><div class="ttdeci">static int nested</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00202">svm.c:202</a></div></div>
<div class="ttc" id="asvm_8c_html_ac6093899c4533e4c669b24862528077d"><div class="ttname"><a href="svm_8c.html#ac6093899c4533e4c669b24862528077d">lbrv</a></div><div class="ttdeci">static int lbrv</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00218">svm.c:218</a></div></div>
<div class="ttc" id="asvm_8c_html_ad791a60fcdb50ec0a9aeb753e780ddb6"><div class="ttname"><a href="svm_8c.html#ad791a60fcdb50ec0a9aeb753e780ddb6">svm_cpu_init</a></div><div class="ttdeci">static int svm_cpu_init(int cpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00700">svm.c:700</a></div></div>
<div class="ttc" id="asvm_8c_html_ae9ce56e3c8875ba1d607bb1be8ed420f"><div class="ttname"><a href="svm_8c.html#ae9ce56e3c8875ba1d607bb1be8ed420f">svm_adjust_mmio_mask</a></div><div class="ttdeci">static __init void svm_adjust_mmio_mask(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l05042">svm.c:5042</a></div></div>
<div class="ttc" id="asvm_8h_html_a3db0df1165fd78ebd0af2184562f090c"><div class="ttname"><a href="svm_8h.html#a3db0df1165fd78ebd0af2184562f090c">IOPM_SIZE</a></div><div class="ttdeci">#define IOPM_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00030">svm.h:30</a></div></div>
<div class="ttc" id="asvm__onhyperv_8h_html_a3f87b0238d2174299072ab571b628edf"><div class="ttname"><a href="svm__onhyperv_8h.html#a3f87b0238d2174299072ab571b628edf">svm_hv_hardware_setup</a></div><div class="ttdeci">static __init void svm_hv_hardware_setup(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm__onhyperv_8h_source.html#l00101">svm_onhyperv.h:101</a></div></div>
<div class="ttc" id="avmx_8c_html_a81470553890562f7758333794b26f1ec"><div class="ttname"><a href="vmx_8c.html#a81470553890562f7758333794b26f1ec">allow_smaller_maxphyaddr</a></div><div class="ttdeci">bool __read_mostly allow_smaller_maxphyaddr</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00232">x86.c:232</a></div></div>
<div class="ttc" id="ax86_8c_html_a04af9ab3eee510b54cba17a6fa94ee04"><div class="ttname"><a href="x86_8c.html#a04af9ab3eee510b54cba17a6fa94ee04">enable_apicv</a></div><div class="ttdeci">bool __read_mostly enable_apicv</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00235">x86.c:235</a></div></div>
<div class="ttc" id="ax86_8c_html_a868c360a5f6eb018cc1d24ecd766d971"><div class="ttname"><a href="x86_8c.html#a868c360a5f6eb018cc1d24ecd766d971">enable_pmu</a></div><div class="ttdeci">bool __read_mostly enable_pmu</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00192">x86.c:192</a></div></div>
<div class="ttc" id="ax86_8c_html_a94e6fe0995d79d296c6b38669db7e139"><div class="ttname"><a href="x86_8c.html#a94e6fe0995d79d296c6b38669db7e139">kvm_add_user_return_msr</a></div><div class="ttdeci">int kvm_add_user_return_msr(u32 msr)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00404">x86.c:404</a></div></div>
<div class="ttc" id="ax86_8c_html_ae273e27a68a0bcb1705012232ea34204"><div class="ttname"><a href="x86_8c.html#ae273e27a68a0bcb1705012232ea34204">kvm_enable_efer_bits</a></div><div class="ttdeci">void kvm_enable_efer_bits(u64 mask)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01790">x86.c:1790</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aa4cdf4791105d54ebcadfeafdcdf01ac_cgraph.png" border="0" usemap="#asvm_8c_aa4cdf4791105d54ebcadfeafdcdf01ac_cgraph" alt=""/></div>
<map name="asvm_8c_aa4cdf4791105d54ebcadfeafdcdf01ac_cgraph" id="asvm_8c_aa4cdf4791105d54ebcadfeafdcdf01ac_cgraph">
<area shape="rect" title=" " alt="" coords="5,309,167,336"/>
<area shape="rect" href="avic_8c.html#ada833d2b35b3e565a6900b25d1cce7c7" title=" " alt="" coords="247,5,407,32"/>
<area shape="rect" href="svm_8c.html#a1a78719a48d64b80ead6c34e9ab1cccf" title=" " alt="" coords="272,56,383,83"/>
<area shape="rect" href="svm_8c.html#a0a9af31dcd464498479ea7b57cdc106f" title=" " alt="" coords="254,107,401,133"/>
<area shape="rect" href="x86_8c.html#a94e6fe0995d79d296c6b38669db7e139" title=" " alt="" coords="230,157,425,184"/>
<area shape="rect" href="mmu_8c.html#a951ec475b6a27cf3b2203305636ff29e" title=" " alt="" coords="248,208,407,235"/>
<area shape="rect" href="x86_8c.html#ae273e27a68a0bcb1705012232ea34204" title=" " alt="" coords="244,259,411,285"/>
<area shape="rect" href="spte_8c.html#a24f526505004d8f749e0e069c2efd17a" title=" " alt="" coords="215,309,440,336"/>
<area shape="rect" href="sev_8c.html#a9afc6299b4f92c15a93b02db0318ad79" title=" " alt="" coords="249,360,405,387"/>
<area shape="rect" href="svm_8c.html#ae9ce56e3c8875ba1d607bb1be8ed420f" title=" " alt="" coords="235,411,420,437"/>
<area shape="rect" href="svm_8c.html#ad791a60fcdb50ec0a9aeb753e780ddb6" title=" " alt="" coords="273,461,381,488"/>
<area shape="rect" href="svm_8c.html#a96aba01528b17e2beabf86e9c19ac13a" title=" " alt="" coords="239,512,416,539"/>
<area shape="rect" href="svm__onhyperv_8h.html#a3f87b0238d2174299072ab571b628edf" title=" " alt="" coords="235,563,419,589"/>
<area shape="rect" href="svm_8c.html#ab2ed2d9e233f1c6a1a3c806826d63401" title=" " alt="" coords="255,803,399,829"/>
<area shape="rect" href="svm_8c.html#a82b315b23a07eb3743b2458ccefb729d" title=" " alt="" coords="548,56,671,83"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="536,107,683,133"/>
<area shape="rect" href="x86_8c.html#a7d0ba1a09c730f4fb15f6ef1c8d42d09" title=" " alt="" coords="505,157,713,184"/>
<area shape="rect" href="spte_8c.html#a80f2cd338ffdc70a83e10eda040387a5" title=" " alt="" coords="488,360,731,387"/>
<area shape="rect" href="mmu_8h.html#a20a41b0166b13eb22b15786964f5de9d" title=" " alt="" coords="569,411,650,437"/>
<area shape="rect" href="sev_8c.html#a87f63ae4bc207e3d5a5d80e34243cf50" title=" " alt="" coords="558,461,661,488"/>
<area shape="rect" href="sev_8c.html#a0bc306a80e6f2622f2c58d1271dcc05b" title=" " alt="" coords="523,512,695,539"/>
<area shape="rect" href="svm_8c.html#adf31fa601aecc0caef0ec738dee9cd86" title=" " alt="" coords="547,563,671,589"/>
<area shape="rect" href="sev_8c.html#a4987bfdf20b1a61d4718ceeb2aaceff6" title=" " alt="" coords="824,512,948,539"/>
<area shape="rect" href="cpuid_8h.html#a267779506f2b7e74c16d026c5e5648f8" title=" " alt="" coords="779,664,993,691"/>
<area shape="rect" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201" title=" " alt="" coords="1056,669,1195,696"/>
<area shape="rect" href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198" title=" " alt="" coords="1050,980,1201,1007"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="815,883,957,909"/>
<area shape="rect" href="cpuid_8c.html#ac4b31e077b5a352bd48a541ad53e3162" title=" " alt="" coords="537,803,682,829"/>
<area shape="rect" href="sev_8c.html#aeaff9c624af59b36fd36d1c25e279a50" title=" " alt="" coords="540,959,679,985"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1288,977,1395,1004"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1473,901,1632,928"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1495,825,1610,852"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1680,876,1828,903"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="1056,905,1195,932"/>
<area shape="rect" href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042" title=" " alt="" coords="799,766,973,807"/>
<area shape="rect" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938" title=" " alt="" coords="809,832,963,859"/>
<area shape="rect" href="cpuid_8c.html#ac97e11439f61d1a659b33cba3dc32abf" title=" " alt="" coords="1041,773,1209,800"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1257,775,1425,801"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1270,623,1413,649"/>
</map>
</div>

</div>
</div>
<a id="a96aba01528b17e2beabf86e9c19ac13a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96aba01528b17e2beabf86e9c19ac13a">&#9670;&nbsp;</a></span>svm_hardware_unsetup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_hardware_unsetup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01109">1109</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;{</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordtype">int</span> cpu;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="sev_8c.html#a0bc306a80e6f2622f2c58d1271dcc05b">sev_hardware_unsetup</a>();</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    for_each_possible_cpu(cpu)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <a class="code" href="svm_8c.html#adf31fa601aecc0caef0ec738dee9cd86">svm_cpu_uninit</a>(cpu);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    __free_pages(pfn_to_page(<a class="code" href="svm_8c.html#a14f8324fee7e48032e60893cd7590076">iopm_base</a> &gt;&gt; PAGE_SHIFT),</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    get_order(<a class="code" href="svm_8h.html#a3db0df1165fd78ebd0af2184562f090c">IOPM_SIZE</a>));</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="svm_8c.html#a14f8324fee7e48032e60893cd7590076">iopm_base</a> = 0;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a0bc306a80e6f2622f2c58d1271dcc05b"><div class="ttname"><a href="sev_8c.html#a0bc306a80e6f2622f2c58d1271dcc05b">sev_hardware_unsetup</a></div><div class="ttdeci">void sev_hardware_unsetup(void)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02298">sev.c:2298</a></div></div>
<div class="ttc" id="asvm_8c_html_adf31fa601aecc0caef0ec738dee9cd86"><div class="ttname"><a href="svm_8c.html#adf31fa601aecc0caef0ec738dee9cd86">svm_cpu_uninit</a></div><div class="ttdeci">static void svm_cpu_uninit(int cpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00687">svm.c:687</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a96aba01528b17e2beabf86e9c19ac13a_cgraph.png" border="0" usemap="#asvm_8c_a96aba01528b17e2beabf86e9c19ac13a_cgraph" alt=""/></div>
<map name="asvm_8c_a96aba01528b17e2beabf86e9c19ac13a_cgraph" id="asvm_8c_a96aba01528b17e2beabf86e9c19ac13a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,183,57"/>
<area shape="rect" href="sev_8c.html#a0bc306a80e6f2622f2c58d1271dcc05b" title=" " alt="" coords="231,5,403,32"/>
<area shape="rect" href="svm_8c.html#adf31fa601aecc0caef0ec738dee9cd86" title=" " alt="" coords="255,56,379,83"/>
<area shape="rect" href="sev_8c.html#a4987bfdf20b1a61d4718ceeb2aaceff6" title=" " alt="" coords="451,5,575,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a96aba01528b17e2beabf86e9c19ac13a_icgraph.png" border="0" usemap="#asvm_8c_a96aba01528b17e2beabf86e9c19ac13a_icgraph" alt=""/></div>
<map name="asvm_8c_a96aba01528b17e2beabf86e9c19ac13a_icgraph" id="asvm_8c_a96aba01528b17e2beabf86e9c19ac13a_icgraph">
<area shape="rect" title=" " alt="" coords="215,5,392,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="a40fda471b3faf8734e7467631861c082"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40fda471b3faf8734e7467631861c082">&#9670;&nbsp;</a></span>svm_has_emulated_msr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_has_emulated_msr </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04286">4286</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;{</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;    <span class="keywordflow">switch</span> (index) {</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_MCG_EXT_CTL:</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="x86_8h.html#a5d4283aad352f6c530dd3f0cb2d8a22f">KVM_FIRST_EMULATED_VMX_MSR</a> ... <a class="code" href="x86_8h.html#ad1d14b87c7c2d00f9a7433e88c3268e6">KVM_LAST_EMULATED_VMX_MSR</a>:</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_SMBASE:</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;        <span class="keywordflow">if</span> (!IS_ENABLED(CONFIG_KVM_SMM))</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;        <span class="comment">/* SEV-ES guests do not support SMM, so report false */</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;        <span class="keywordflow">if</span> (kvm &amp;&amp; <a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(kvm))</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;    }</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160; </div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;}</div>
<div class="ttc" id="ax86_8h_html_a5d4283aad352f6c530dd3f0cb2d8a22f"><div class="ttname"><a href="x86_8h.html#a5d4283aad352f6c530dd3f0cb2d8a22f">KVM_FIRST_EMULATED_VMX_MSR</a></div><div class="ttdeci">#define KVM_FIRST_EMULATED_VMX_MSR</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00049">x86.h:49</a></div></div>
<div class="ttc" id="ax86_8h_html_ad1d14b87c7c2d00f9a7433e88c3268e6"><div class="ttname"><a href="x86_8h.html#ad1d14b87c7c2d00f9a7433e88c3268e6">KVM_LAST_EMULATED_VMX_MSR</a></div><div class="ttdeci">#define KVM_LAST_EMULATED_VMX_MSR</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00050">x86.h:50</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a40fda471b3faf8734e7467631861c082_cgraph.png" border="0" usemap="#asvm_8c_a40fda471b3faf8734e7467631861c082_cgraph" alt=""/></div>
<map name="asvm_8c_a40fda471b3faf8734e7467631861c082_cgraph" id="asvm_8c_a40fda471b3faf8734e7467631861c082_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,187,32"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="235,5,345,32"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="393,5,500,32"/>
</map>
</div>

</div>
</div>
<a id="a942df5fa6c49bd103275f10b5af1d847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a942df5fa6c49bd103275f10b5af1d847">&#9670;&nbsp;</a></span>svm_has_wbinvd_exit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_has_wbinvd_exit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04358">4358</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;{</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa667b0a0f202f83aa1533825aeecb402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa667b0a0f202f83aa1533825aeecb402">&#9670;&nbsp;</a></span>svm_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __init svm_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l05342">5342</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;{</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160; </div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;    __unused_size_checks();</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160; </div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#ad1ba53021522940c5c8b84e82d574243">kvm_is_svm_supported</a>())</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;        <span class="keywordflow">return</span> -EOPNOTSUPP;</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160; </div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;    r = <a class="code" href="x86_8c.html#ae295ff45fc91a432658e57dda4dfea68">kvm_x86_vendor_init</a>(&amp;svm_init_ops);</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;    <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;        <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160; </div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;    cpu_emergency_register_virt_callback(<a class="code" href="svm_8c.html#ab4fa734cd92223a6150551cd5243b4aa">svm_emergency_disable</a>);</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160; </div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;<span class="comment">     * Common KVM initialization _must_ come last, after this, /dev/kvm is</span></div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;<span class="comment">     * exposed to userspace!</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;    r = <a class="code" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc">kvm_init</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a>), __alignof__(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a>),</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;             THIS_MODULE);</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;    <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;        <span class="keywordflow">goto</span> err_kvm_init;</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160; </div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160; </div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;err_kvm_init:</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;    <a class="code" href="svm_8c.html#a5b14d1e0632116bdfd341cd3c892a5eb">__svm_exit</a>();</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;}</div>
<div class="ttc" id="akvm__main_8c_html_a2372c616bc55bc4cd3446660cb7322fc"><div class="ttname"><a href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc">kvm_init</a></div><div class="ttdeci">int kvm_init(unsigned vcpu_size, unsigned vcpu_align, struct module *module)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l06402">kvm_main.c:6402</a></div></div>
<div class="ttc" id="asvm_8c_html_ad1ba53021522940c5c8b84e82d574243"><div class="ttname"><a href="svm_8c.html#ad1ba53021522940c5c8b84e82d574243">kvm_is_svm_supported</a></div><div class="ttdeci">static bool kvm_is_svm_supported(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00544">svm.c:544</a></div></div>
<div class="ttc" id="ax86_8c_html_ae295ff45fc91a432658e57dda4dfea68"><div class="ttname"><a href="x86_8c.html#ae295ff45fc91a432658e57dda4dfea68">kvm_x86_vendor_init</a></div><div class="ttdeci">int kvm_x86_vendor_init(struct kvm_x86_init_ops *ops)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09786">x86.c:9786</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aa667b0a0f202f83aa1533825aeecb402_cgraph.png" border="0" usemap="#asvm_8c_aa667b0a0f202f83aa1533825aeecb402_cgraph" alt=""/></div>
<map name="asvm_8c_aa667b0a0f202f83aa1533825aeecb402_cgraph" id="asvm_8c_aa667b0a0f202f83aa1533825aeecb402_cgraph">
<area shape="rect" title=" " alt="" coords="5,604,84,631"/>
<area shape="rect" href="svm_8c.html#a5b14d1e0632116bdfd341cd3c892a5eb" title=" " alt="" coords="172,553,268,580"/>
<area shape="rect" href="svm_8c.html#ab4fa734cd92223a6150551cd5243b4aa" title=" " alt="" coords="359,579,543,605"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="181,781,259,808"/>
<area shape="rect" href="svm_8c.html#ad1ba53021522940c5c8b84e82d574243" title=" " alt="" coords="132,933,308,960"/>
<area shape="rect" href="x86_8c.html#ae295ff45fc91a432658e57dda4dfea68" title=" " alt="" coords="139,376,301,403"/>
<area shape="rect" href="x86_8c.html#a6b0e9d5b7fc8842b6316f94643af7023" title=" " alt="" coords="368,528,535,555"/>
<area shape="rect" href="lapic_8c.html#af2d9c133a24e68f345a3fe133bf8bfaf" title=" " alt="" coords="650,528,771,555"/>
<area shape="rect" href="mmu_8c.html#a300e442ad7216d17c3ad006fab006622" title=" " alt="" coords="595,477,827,504"/>
<area shape="rect" href="mmu_8c.html#a7972fb42d26603fda02b76d2ab6e6d8b" title=" " alt="" coords="885,320,1049,347"/>
<area shape="rect" href="svm_8c.html#a53176c61179bfcec5f1c122b110cc8c3" title=" " alt="" coords="625,579,796,605"/>
<area shape="rect" href="svm__ops_8h.html#a97407302752e909143951887456521ef" title=" " alt="" coords="944,468,991,495"/>
<area shape="rect" href="async__pf_8c.html#a6a95381b9989e167d6652a615d5d23ca" title=" " alt="" coords="371,629,531,656"/>
<area shape="rect" href="async__pf_8c.html#aa76d0c30ba513293e8e456a30b9ffaca" title=" " alt="" coords="379,680,523,707"/>
<area shape="rect" href="guest__memfd_8c.html#a68c040b0b6a5e2b2ab09b08948e52bdf" title=" " alt="" coords="387,731,515,757"/>
<area shape="rect" href="kvm__main_8c.html#ad17bbe7ce4e145f608f3338509d268e2" title=" " alt="" coords="388,781,515,808"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="394,832,509,859"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="389,883,513,909"/>
<area shape="rect" href="vfio_8c.html#a446b600ca5ab23d5f144817c3f4b0e63" title=" " alt="" coords="379,933,523,960"/>
<area shape="rect" href="vfio_8c.html#aadfb91e55569080466bdad79bcec7205" title=" " alt="" coords="381,984,521,1011"/>
<area shape="rect" href="kvm__main_8c.html#ac73f827fa7e442cbfd730ec1d98649b4" title=" " alt="" coords="614,731,807,757"/>
<area shape="rect" href="x86_8c.html#a78fdc2a1fb48a0d68d6c833a9053ab51" title=" " alt="" coords="635,832,786,859"/>
<area shape="rect" href="x86_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="631,781,790,808"/>
<area shape="rect" href="kvm__main_8c.html#a9b5b3037a51f08700bdbe7a74c86fbff" title=" " alt="" coords="617,883,805,909"/>
<area shape="rect" href="x86_8c.html#a0c9dab9b636523857087b20e07eab23b" title=" " alt="" coords="884,883,1051,909"/>
<area shape="rect" href="x86_8c.html#abe7489cc3771df9264f3f412ef452594" title=" " alt="" coords="875,933,1060,960"/>
<area shape="rect" href="x86_8c.html#a37404aa00211466502dd27a08460271b" title=" " alt="" coords="887,519,1047,561"/>
<area shape="rect" href="lapic_8c.html#a054dd145c5435c8bfe1dea1adf2ed1e1" title=" " alt="" coords="890,585,1045,626"/>
<area shape="rect" href="lapic_8c.html#ab785e74943a17874760f3d4b6b5359d0" title=" " alt="" coords="886,650,1049,691"/>
<area shape="rect" href="x86_8c.html#a7c9ec3443e88bcdbc3befa436fdea079" title=" " alt="" coords="890,715,1045,757"/>
<area shape="rect" href="x86_8c.html#aeb9a8081faba5e3fde01100b514c31c6" title=" " alt="" coords="883,781,1052,808"/>
<area shape="rect" href="x86_8c.html#a58b091ff3f3eebb9f9e5e0a0a281080c" title=" " alt="" coords="921,832,1013,859"/>
<area shape="rect" href="x86_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="635,992,787,1019"/>
<area shape="rect" href="x86_8c.html#a7cbbeecc94112a98780c6fec0c01516e" title=" " alt="" coords="890,985,1045,1026"/>
<area shape="rect" href="xen_8h.html#ac0591bab3ec68dc53bba67f12bbf141e" title=" " alt="" coords="881,1051,1053,1077"/>
<area shape="rect" href="xen_8h.html#a2a87d72d866eb3429f991cbb5c61ba13" title=" " alt="" coords="883,1102,1052,1143"/>
<area shape="rect" href="kvm__main_8c.html#a04cec4716182d98b08f008f317aaf698" title=" " alt="" coords="617,1043,805,1069"/>
<area shape="rect" href="svm_8c.html#a0c5962ecf16b873fd88c7d6664ea7f0c" title=" " alt="" coords="356,1035,547,1061"/>
<area shape="rect" href="x86_8c.html#a0ad8fc4784d6d316f3d9f5afe640af81" title=" " alt="" coords="363,275,539,301"/>
<area shape="rect" href="x86_8c.html#a6137b318fa926306eb86e2b06f78ef90" title=" " alt="" coords="663,56,759,83"/>
<area shape="rect" href="x86_8c.html#abae582880b2a63d92c4870f50a8e4fd9" title=" " alt="" coords="633,107,788,149"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="640,5,781,32"/>
<area shape="rect" href="x86_8c.html#acdc59867c9bea51ae5c7aa92e36e5c2a" title=" " alt="" coords="638,173,783,200"/>
<area shape="rect" href="pmu_8h.html#a396fb061862658f24b451f625e7549e5" title=" " alt="" coords="617,275,804,301"/>
<area shape="rect" href="mmu_8c.html#ac1e20896385a0e158bf217a24a6d6234" title=" " alt="" coords="597,224,825,251"/>
<area shape="rect" href="x86_8c.html#a6ee0218160b3eedc23a9d5d4bc0fb68e" title=" " alt="" coords="644,325,777,352"/>
<area shape="rect" href="x86_8c.html#a0444c9593de92a4e9c2f3d66244b34fa" title=" " alt="" coords="650,376,771,403"/>
<area shape="rect" href="x86_8c.html#a48f93f51d0a93f4cb170e549d8fa5a12" title=" " alt="" coords="604,427,817,453"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="898,5,1037,32"/>
<area shape="rect" href="x86_8c.html#ac11a66b15d35b2693fcda8d63f629018" title=" " alt="" coords="877,173,1058,200"/>
</map>
</div>

</div>
</div>
<a id="a845aceb79827a59a1e6e703aeee0b02a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a845aceb79827a59a1e6e703aeee0b02a">&#9670;&nbsp;</a></span>svm_init_erratum_383()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_init_erratum_383 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00475">475</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    u32 low, high;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    u64 val;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">if</span> (!static_cpu_has_bug(X86_BUG_AMD_TLB_MMATCH))</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">/* Use _safe variants to not break nested virtualization */</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    val = native_read_msr_safe(MSR_AMD64_DC_CFG, &amp;err);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> (err)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    val |= (1ULL &lt;&lt; 47);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    low  = lower_32_bits(val);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    high = upper_32_bits(val);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    native_write_msr_safe(MSR_AMD64_DC_CFG, low, high);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    erratum_383_found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a845aceb79827a59a1e6e703aeee0b02a_icgraph.png" border="0" usemap="#asvm_8c_a845aceb79827a59a1e6e703aeee0b02a_icgraph" alt=""/></div>
<map name="asvm_8c_a845aceb79827a59a1e6e703aeee0b02a_icgraph" id="asvm_8c_a845aceb79827a59a1e6e703aeee0b02a_icgraph">
<area shape="rect" title=" " alt="" coords="223,5,391,32"/>
<area shape="rect" href="svm_8c.html#ace8f9c582674fc49f475a61c3e9ed257" title=" " alt="" coords="5,5,175,32"/>
</map>
</div>

</div>
</div>
<a id="a7f710210623f08aa3f8ba9efdd0746b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f710210623f08aa3f8ba9efdd0746b1">&#9670;&nbsp;</a></span>svm_init_osvw()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_init_osvw </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00499">499</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;{</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">     * Guests should see errata 400 and 415 as fixed (assuming that</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">     * HLT and IO instructions are intercepted).</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    vcpu-&gt;arch.osvw.length = (<a class="code" href="svm_8c.html#a9cd9c6d58f164e1428e93fac80a1fc34">osvw_len</a> &gt;= 3) ? (<a class="code" href="svm_8c.html#a9cd9c6d58f164e1428e93fac80a1fc34">osvw_len</a>) : 3;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    vcpu-&gt;arch.osvw.status = <a class="code" href="svm_8c.html#ad74f8bf67f324d305a1bde6cebadd841">osvw_status</a> &amp; ~(6ULL);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">     * By increasing VCPU&#39;s osvw.length to 3 we are telling the guest that</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">     * all osvw.status bits inside that length, including bit 0 (which is</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">     * reserved for erratum 298), are valid. However, if host processor&#39;s</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">     * osvw_len is 0 then osvw_status[0] carries no information. We need to</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">     * be conservative here and therefore we tell the guest that erratum 298</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">     * is present (because we really don&#39;t know).</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a9cd9c6d58f164e1428e93fac80a1fc34">osvw_len</a> == 0 &amp;&amp; boot_cpu_data.x86 == 0x10)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        vcpu-&gt;arch.osvw.status |= 1;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a7f710210623f08aa3f8ba9efdd0746b1_icgraph.png" border="0" usemap="#asvm_8c_a7f710210623f08aa3f8ba9efdd0746b1_icgraph" alt=""/></div>
<map name="asvm_8c_a7f710210623f08aa3f8ba9efdd0746b1_icgraph" id="asvm_8c_a7f710210623f08aa3f8ba9efdd0746b1_icgraph">
<area shape="rect" title=" " alt="" coords="372,5,491,32"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="181,5,324,32"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
</map>
</div>

</div>
</div>
<a id="a13190482bab2b529a02a5cf83309f510"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13190482bab2b529a02a5cf83309f510">&#9670;&nbsp;</a></span>svm_inject_exception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_inject_exception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00457">457</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keyword">struct </span>kvm_queued_exception *ex = &amp;vcpu-&gt;arch.exception;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="x86_8c.html#a92e1a819da31f9776852acd897808e99">kvm_deliver_exception_payload</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, ex);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#a441b0296c9e66d1e4f4c554d73a3093e">kvm_exception_is_soft</a>(ex-&gt;vector) &amp;&amp;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="svm_8c.html#ac18fc14fa96cb83668d789973478dbc0">svm_update_soft_interrupt_rip</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.event_inj = ex-&gt;vector</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        | SVM_EVTINJ_VALID</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        | (ex-&gt;has_error_code ? SVM_EVTINJ_VALID_ERR : 0)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        | SVM_EVTINJ_TYPE_EXEPT;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.event_inj_err = ex-&gt;error_code;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_ac18fc14fa96cb83668d789973478dbc0"><div class="ttname"><a href="svm_8c.html#ac18fc14fa96cb83668d789973478dbc0">svm_update_soft_interrupt_rip</a></div><div class="ttdeci">static int svm_update_soft_interrupt_rip(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00412">svm.c:412</a></div></div>
<div class="ttc" id="ax86_8c_html_a92e1a819da31f9776852acd897808e99"><div class="ttname"><a href="x86_8c.html#a92e1a819da31f9776852acd897808e99">kvm_deliver_exception_payload</a></div><div class="ttdeci">void kvm_deliver_exception_payload(struct kvm_vcpu *vcpu, struct kvm_queued_exception *ex)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00573">x86.c:573</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a13190482bab2b529a02a5cf83309f510_cgraph.png" border="0" usemap="#asvm_8c_a13190482bab2b529a02a5cf83309f510_cgraph" alt=""/></div>
<map name="asvm_8c_a13190482bab2b529a02a5cf83309f510_cgraph" id="asvm_8c_a13190482bab2b529a02a5cf83309f510_cgraph">
<area shape="rect" title=" " alt="" coords="5,371,169,397"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="1899,217,2074,258"/>
<area shape="rect" href="x86_8h.html#a441b0296c9e66d1e4f4c554d73a3093e" title=" " alt="" coords="242,345,413,372"/>
<area shape="rect" href="svm_8c.html#ac18fc14fa96cb83668d789973478dbc0" title=" " alt="" coords="217,396,437,423"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1007,421,1077,448"/>
<area shape="rect" href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe" title=" " alt="" coords="485,439,652,481"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="1229,1288,1343,1315"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="513,295,624,321"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="705,607,893,633"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="743,396,854,423"/>
<area shape="rect" href="svm_8c.html#a88f50f26e46655ddf4e070bcabcc66ad" title=" " alt="" coords="700,497,897,524"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="951,607,1133,633"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="1455,396,1590,423"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="1187,211,1385,237"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="1197,93,1375,120"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="1209,262,1363,303"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="1225,429,1347,456"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="1192,632,1380,659"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="1438,581,1607,608"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1895,548,2079,575"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="1187,531,1385,557"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="1206,683,1366,725"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="1191,749,1381,776"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="1205,801,1367,842"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="1195,1085,1377,1112"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="1225,480,1347,507"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="1200,969,1372,1010"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="1193,1035,1379,1061"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="1672,1155,1835,1181"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="1689,948,1818,975"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="1205,1187,1367,1213"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="1479,871,1566,897"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="1201,145,1371,186"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="1215,867,1357,893"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1685,396,1822,423"/>
<area shape="rect" href="x86_8c.html#a2a7f61481aae2e0bfe4baaba68d6d650" title=" " alt="" coords="1437,93,1608,120"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="1447,269,1598,296"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1927,820,2047,847"/>
<area shape="rect" href="x86_8c.html#aea69aad92f3a36aaebec0c2a9e853b61" title=" " alt="" coords="1434,683,1611,725"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1662,548,1845,575"/>
<area shape="rect" href="x86_8c.html#a8bbfd08c002f2e09b42bb56cd8f52653" title=" " alt="" coords="1441,515,1604,557"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1461,1023,1584,1049"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1443,1074,1602,1115"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1435,921,1610,948"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1437,972,1608,999"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="1433,1288,1612,1315"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="1660,1288,1847,1315"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="989,371,1095,397"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="711,295,886,321"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="945,295,1139,321"/>
</map>
</div>

</div>
</div>
<a id="aea4014f3f951e100eb2acc13cef94502"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea4014f3f951e100eb2acc13cef94502">&#9670;&nbsp;</a></span>svm_inject_irq()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_inject_irq </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>reinjected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03611">3611</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;{</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;    u32 type;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160; </div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.interrupt.soft) {</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ac18fc14fa96cb83668d789973478dbc0">svm_update_soft_interrupt_rip</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160; </div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;        type = SVM_EVTINJ_TYPE_SOFT;</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;        type = SVM_EVTINJ_TYPE_INTR;</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;    }</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160; </div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    trace_kvm_inj_virq(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.interrupt.nr,</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;               <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.interrupt.soft, reinjected);</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    ++<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;stat.irq_injections;</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160; </div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.event_inj = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.interrupt.nr |</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                       SVM_EVTINJ_VALID | type;</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aea4014f3f951e100eb2acc13cef94502_cgraph.png" border="0" usemap="#asvm_8c_aea4014f3f951e100eb2acc13cef94502_cgraph" alt=""/></div>
<map name="asvm_8c_aea4014f3f951e100eb2acc13cef94502_cgraph" id="asvm_8c_aea4014f3f951e100eb2acc13cef94502_cgraph">
<area shape="rect" title=" " alt="" coords="5,119,123,145"/>
<area shape="rect" href="svm_8c.html#ac18fc14fa96cb83668d789973478dbc0" title=" " alt="" coords="171,93,391,120"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="955,169,1025,196"/>
<area shape="rect" href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe" title=" " alt="" coords="439,263,605,305"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="2075,720,2185,747"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="1171,347,1286,373"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="658,397,846,424"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="697,296,807,323"/>
<area shape="rect" href="svm_8c.html#a88f50f26e46655ddf4e070bcabcc66ad" title=" " alt="" coords="653,195,851,221"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="899,960,1081,987"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="1401,1423,1535,1449"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="1130,448,1327,475"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="1139,549,1318,576"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="1152,666,1305,707"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="1167,884,1290,911"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="1135,935,1323,961"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="1383,808,1553,835"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1843,808,2027,835"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="1129,783,1328,809"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="1149,1138,1309,1179"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="1133,1204,1324,1231"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="1148,1255,1309,1297"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="1138,1707,1319,1733"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="1168,1423,1289,1449"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="1143,1525,1315,1566"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="1608,1473,1795,1500"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="1620,1077,1783,1104"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="1637,1027,1766,1053"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="1147,499,1310,525"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="1425,1249,1511,1276"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="1144,601,1313,642"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="1158,1087,1299,1113"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1633,1423,1770,1449"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1861,1448,2008,1475"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="2233,720,2408,747"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="2456,720,2649,747"/>
<area shape="rect" href="x86_8c.html#a2a7f61481aae2e0bfe4baaba68d6d650" title=" " alt="" coords="1383,448,1553,475"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="1393,589,1543,616"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1875,1027,1995,1053"/>
<area shape="rect" href="x86_8c.html#aea69aad92f3a36aaebec0c2a9e853b61" title=" " alt="" coords="1379,961,1557,1002"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1610,859,1793,885"/>
<area shape="rect" href="x86_8c.html#a8bbfd08c002f2e09b42bb56cd8f52653" title=" " alt="" coords="1387,691,1549,733"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1407,1808,1529,1835"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1389,1641,1547,1682"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1381,1707,1555,1733"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1383,1757,1553,1784"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="1379,347,1557,373"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="1608,347,1795,373"/>
<area shape="rect" href="x86_8c.html#a0a47622bf3c21272e9e0357e1f90540a" title=" " alt="" coords="1376,1575,1560,1617"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="937,296,1043,323"/>
</map>
</div>

</div>
</div>
<a id="a67bccbcbb6b439b80103663fe58cd626"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67bccbcbb6b439b80103663fe58cd626">&#9670;&nbsp;</a></span>svm_inject_nmi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_inject_nmi </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03557">3557</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;{</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160; </div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.event_inj = SVM_EVTINJ_VALID | SVM_EVTINJ_TYPE_NMI;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160; </div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">nmi_l1_to_l2</a>)</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160; </div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;<span class="comment">     * No need to manually track NMI masking when vNMI is enabled, hardware</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<span class="comment">     * automatically sets V_NMI_BLOCKING_MASK as appropriate, including the</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;<span class="comment">     * case where software directly injects an NMI.</span></div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">is_vnmi_enabled</a>(svm)) {</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">nmi_masked</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;        <a class="code" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066">svm_set_iret_intercept</a>(svm);</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;    }</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    ++<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;stat.nmi_injections;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_af4501b19af9ab262bc899adc902a5066"><div class="ttname"><a href="svm_8c.html#af4501b19af9ab262bc899adc902a5066">svm_set_iret_intercept</a></div><div class="ttdeci">static void svm_set_iret_intercept(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02560">svm.c:2560</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a67bccbcbb6b439b80103663fe58cd626_cgraph.png" border="0" usemap="#asvm_8c_a67bccbcbb6b439b80103663fe58cd626_cgraph" alt=""/></div>
<map name="asvm_8c_a67bccbcbb6b439b80103663fe58cd626_cgraph" id="asvm_8c_a67bccbcbb6b439b80103663fe58cd626_cgraph">
<area shape="rect" title=" " alt="" coords="5,92,131,119"/>
<area shape="rect" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d" title=" " alt="" coords="198,31,330,57"/>
<area shape="rect" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066" title=" " alt="" coords="179,92,349,119"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="229,143,299,169"/>
<area shape="rect" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8" title=" " alt="" coords="588,8,733,35"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="813,5,933,32"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="413,92,524,119"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="397,183,540,209"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="607,92,714,119"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="594,183,727,209"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="797,289,948,316"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="781,57,964,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="782,122,963,163"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="799,188,946,215"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="805,239,941,265"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1029,104,1148,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1012,155,1165,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1452,97,1625,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1213,129,1404,156"/>
</map>
</div>

</div>
</div>
<a id="a0a4c593c8666cfa6b032b7bc7639b81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a4c593c8666cfa6b032b7bc7639b81b">&#9670;&nbsp;</a></span>svm_instr_opcode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_instr_opcode </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02312">2312</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;{</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="keyword">struct </span><a class="code" href="structx86__emulate__ctxt.html">x86_emulate_ctxt</a> *ctxt = <a class="code" href="structx86__emulate__ctxt.html#ab957da78003b9336cb805fad802aa4fb">vcpu</a>-&gt;arch.emulate_ctxt;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160; </div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="keywordflow">if</span> (ctxt-&gt;<a class="code" href="structx86__emulate__ctxt.html#acf17d7e95c7f349d5bc24cc455aa169a">b</a> != 0x1 || ctxt-&gt;<a class="code" href="structx86__emulate__ctxt.html#aa5577f0be76b2738d6ec0d0a46bd5206">opcode_len</a> != 2)</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603acde1334d18ebb932ec5a98bf93c431ae">NONE_SVM_INSTR</a>;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160; </div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <span class="keywordflow">switch</span> (ctxt-&gt;<a class="code" href="structx86__emulate__ctxt.html#a0523ec45c580fc35c1b1fda921fdc398">modrm</a>) {</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <span class="keywordflow">case</span> 0xd8: <span class="comment">/* VMRUN */</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a4fc4da3a6a1a9c998f04b7988ba00834">SVM_INSTR_VMRUN</a>;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="keywordflow">case</span> 0xda: <span class="comment">/* VMLOAD */</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603aafab86473fad2281466fe8b1d89b74d9">SVM_INSTR_VMLOAD</a>;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keywordflow">case</span> 0xdb: <span class="comment">/* VMSAVE */</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603a5eb1e788833fd7f4e89343327e575e32">SVM_INSTR_VMSAVE</a>;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    }</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160; </div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#aedcf2109f459315e1a7f2af73ec9b603acde1334d18ebb932ec5a98bf93c431ae">NONE_SVM_INSTR</a>;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;}</div>
<div class="ttc" id="astructx86__emulate__ctxt_html"><div class="ttname"><a href="structx86__emulate__ctxt.html">x86_emulate_ctxt</a></div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00307">kvm_emulate.h:307</a></div></div>
<div class="ttc" id="astructx86__emulate__ctxt_html_a0523ec45c580fc35c1b1fda921fdc398"><div class="ttname"><a href="structx86__emulate__ctxt.html#a0523ec45c580fc35c1b1fda921fdc398">x86_emulate_ctxt::modrm</a></div><div class="ttdeci">u8 modrm</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00355">kvm_emulate.h:355</a></div></div>
<div class="ttc" id="astructx86__emulate__ctxt_html_aa5577f0be76b2738d6ec0d0a46bd5206"><div class="ttname"><a href="structx86__emulate__ctxt.html#aa5577f0be76b2738d6ec0d0a46bd5206">x86_emulate_ctxt::opcode_len</a></div><div class="ttdeci">u8 opcode_len</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00335">kvm_emulate.h:335</a></div></div>
<div class="ttc" id="astructx86__emulate__ctxt_html_ab957da78003b9336cb805fad802aa4fb"><div class="ttname"><a href="structx86__emulate__ctxt.html#ab957da78003b9336cb805fad802aa4fb">x86_emulate_ctxt::vcpu</a></div><div class="ttdeci">void * vcpu</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00308">kvm_emulate.h:308</a></div></div>
<div class="ttc" id="astructx86__emulate__ctxt_html_acf17d7e95c7f349d5bc24cc455aa169a"><div class="ttname"><a href="structx86__emulate__ctxt.html#acf17d7e95c7f349d5bc24cc455aa169a">x86_emulate_ctxt::b</a></div><div class="ttdeci">u8 b</div><div class="ttdef"><b>Definition:</b> <a href="kvm__emulate_8h_source.html#l00336">kvm_emulate.h:336</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a0a4c593c8666cfa6b032b7bc7639b81b_icgraph.png" border="0" usemap="#asvm_8c_a0a4c593c8666cfa6b032b7bc7639b81b_icgraph" alt=""/></div>
<map name="asvm_8c_a0a4c593c8666cfa6b032b7bc7639b81b_icgraph" id="asvm_8c_a0a4c593c8666cfa6b032b7bc7639b81b_icgraph">
<area shape="rect" title=" " alt="" coords="176,5,316,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="a005049e4b080345fc3924233b8e33bce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a005049e4b080345fc3924233b8e33bce">&#9670;&nbsp;</a></span>svm_interrupt_allowed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_interrupt_allowed </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_injection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03793">3793</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;{</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160; </div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">nested_run_pending</a>)</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;        <span class="keywordflow">return</span> -EBUSY;</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160; </div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa">svm_interrupt_blocked</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160; </div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;<span class="comment">     * An IRQ must not be injected into L2 if it&#39;s supposed to VM-Exit,</span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;<span class="comment">     * e.g. if the IRQ arrived asynchronously after checking nested events.</span></div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;    <span class="keywordflow">if</span> (for_injection &amp;&amp; <a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; <a class="code" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141">nested_exit_on_intr</a>(svm))</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;        <span class="keywordflow">return</span> -EBUSY;</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160; </div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;}</div>
<div class="ttc" id="astructsvm__nested__state_html_a32951ee4dfbf17d414fcdad2d336b25b"><div class="ttname"><a href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">svm_nested_state::nested_run_pending</a></div><div class="ttdeci">bool nested_run_pending</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00170">svm.h:170</a></div></div>
<div class="ttc" id="asvm_8c_html_a67762809a8b14687a3bffdd5a4cd03aa"><div class="ttname"><a href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa">svm_interrupt_blocked</a></div><div class="ttdeci">bool svm_interrupt_blocked(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03767">svm.c:3767</a></div></div>
<div class="ttc" id="asvm_8h_html_a13cbed806a9638fcaab4d01cb926d141"><div class="ttname"><a href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141">nested_exit_on_intr</a></div><div class="ttdeci">static bool nested_exit_on_intr(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00581">svm.h:581</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a005049e4b080345fc3924233b8e33bce_cgraph.png" border="0" usemap="#asvm_8c_a005049e4b080345fc3924233b8e33bce_cgraph" alt=""/></div>
<map name="asvm_8c_a005049e4b080345fc3924233b8e33bce_cgraph" id="asvm_8c_a005049e4b080345fc3924233b8e33bce_cgraph">
<area shape="rect" title=" " alt="" coords="5,104,176,131"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="865,104,985,131"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="443,53,593,80"/>
<area shape="rect" href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa" title=" " alt="" coords="224,155,395,181"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="685,307,755,333"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="641,53,799,80"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="485,155,551,181"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="659,205,781,232"/>
<area shape="rect" href="svm_8c.html#a4a9065695154691afff42bc585235d64" title=" " alt="" coords="455,256,581,283"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="661,155,779,181"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="847,155,1004,181"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1052,155,1171,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1457,147,1631,189"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1219,180,1409,207"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="665,256,775,283"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="872,256,979,283"/>
</map>
</div>

</div>
</div>
<a id="a67762809a8b14687a3bffdd5a4cd03aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67762809a8b14687a3bffdd5a4cd03aa">&#9670;&nbsp;</a></span>svm_interrupt_blocked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool svm_interrupt_blocked </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03767">3767</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;{</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>;</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160; </div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a>(svm))</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160; </div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(vcpu)) {</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;        <span class="comment">/* As long as interrupts are being delivered...  */</span></div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        <span class="keywordflow">if</span> ((svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp; V_INTR_MASKING_MASK)</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;            ? !(svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.rflags &amp; X86_EFLAGS_IF)</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;            : !(<a class="code" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c">kvm_get_rflags</a>(vcpu) &amp; X86_EFLAGS_IF))</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160; </div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;        <span class="comment">/* ... vmexits aren&#39;t blocked by the interrupt shadow  */</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141">nested_exit_on_intr</a>(svm))</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a4a9065695154691afff42bc585235d64">svm_get_if_flag</a>(vcpu))</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;    }</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160; </div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;    <span class="keywordflow">return</span> (vmcb-&gt;control.int_state &amp; SVM_INTERRUPT_SHADOW_MASK);</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a4a9065695154691afff42bc585235d64"><div class="ttname"><a href="svm_8c.html#a4a9065695154691afff42bc585235d64">svm_get_if_flag</a></div><div class="ttdeci">static bool svm_get_if_flag(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01603">svm.c:1603</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a67762809a8b14687a3bffdd5a4cd03aa_cgraph.png" border="0" usemap="#asvm_8c_a67762809a8b14687a3bffdd5a4cd03aa_cgraph" alt=""/></div>
<map name="asvm_8c_a67762809a8b14687a3bffdd5a4cd03aa_cgraph" id="asvm_8c_a67762809a8b14687a3bffdd5a4cd03aa_cgraph">
<area shape="rect" title=" " alt="" coords="5,139,176,166"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="266,13,333,39"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="647,63,767,90"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="440,165,563,191"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="224,114,375,141"/>
<area shape="rect" href="svm_8c.html#a4a9065695154691afff42bc585235d64" title=" " alt="" coords="237,215,362,242"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="466,266,537,293"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="442,13,561,39"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="628,13,785,39"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="833,13,952,39"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1239,5,1412,47"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1000,38,1191,65"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="423,114,580,141"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="446,215,557,242"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="653,215,760,242"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a67762809a8b14687a3bffdd5a4cd03aa_icgraph.png" border="0" usemap="#asvm_8c_a67762809a8b14687a3bffdd5a4cd03aa_icgraph" alt=""/></div>
<map name="asvm_8c_a67762809a8b14687a3bffdd5a4cd03aa_icgraph" id="asvm_8c_a67762809a8b14687a3bffdd5a4cd03aa_icgraph">
<area shape="rect" title=" " alt="" coords="251,31,421,57"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,5,203,32"/>
<area shape="rect" href="svm_8c.html#a005049e4b080345fc3924233b8e33bce" title=" " alt="" coords="19,56,189,83"/>
</map>
</div>

</div>
</div>
<a id="a8afafecae406016532810194f187fe2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8afafecae406016532810194f187fe2c">&#9670;&nbsp;</a></span>svm_invoke_exit_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int svm_invoke_exit_handler </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>exit_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03453">3453</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;{</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#ad838ad3f2e1e678e2c13720c679dc8f8">svm_check_exit_valid</a>(exit_code))</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#ab46a833ac93ce3fda7973768cadb1929">svm_handle_invalid_exit</a>(vcpu, exit_code);</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160; </div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;<span class="preprocessor">#ifdef CONFIG_RETPOLINE</span></div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;    <span class="keywordflow">if</span> (exit_code == SVM_EXIT_MSR)</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a173c3f7c02a4287d140cc0f34564a7bd">msr_interception</a>(vcpu);</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exit_code == SVM_EXIT_VINTR)</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404">interrupt_window_interception</a>(vcpu);</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exit_code == SVM_EXIT_INTR)</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a21af2401d39dc5c49a388960ce1196ad">intr_interception</a>(vcpu);</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exit_code == SVM_EXIT_HLT)</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a92f17256a8d83aac265d08a1e3500340">kvm_emulate_halt</a>(vcpu);</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exit_code == SVM_EXIT_NPF)</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a723646ac5d3234ba8e1845249e6a0935">npf_interception</a>(vcpu);</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#af73415c5c6c2827a7671c0d2cc5b1c4f">svm_exit_handlers</a>[exit_code](vcpu);</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a173c3f7c02a4287d140cc0f34564a7bd"><div class="ttname"><a href="svm_8c.html#a173c3f7c02a4287d140cc0f34564a7bd">msr_interception</a></div><div class="ttdeci">static int msr_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03169">svm.c:3169</a></div></div>
<div class="ttc" id="asvm_8c_html_a21af2401d39dc5c49a388960ce1196ad"><div class="ttname"><a href="svm_8c.html#a21af2401d39dc5c49a388960ce1196ad">intr_interception</a></div><div class="ttdeci">static int intr_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02246">svm.c:2246</a></div></div>
<div class="ttc" id="asvm_8c_html_a723646ac5d3234ba8e1845249e6a0935"><div class="ttname"><a href="svm_8c.html#a723646ac5d3234ba8e1845249e6a0935">npf_interception</a></div><div class="ttdeci">static int npf_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02051">svm.c:2051</a></div></div>
<div class="ttc" id="asvm_8c_html_ab07aabd2b78a54e2f9a6bd72ffbfa404"><div class="ttname"><a href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404">interrupt_window_interception</a></div><div class="ttdeci">static int interrupt_window_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03177">svm.c:3177</a></div></div>
<div class="ttc" id="asvm_8c_html_ab46a833ac93ce3fda7973768cadb1929"><div class="ttname"><a href="svm_8c.html#ab46a833ac93ce3fda7973768cadb1929">svm_handle_invalid_exit</a></div><div class="ttdeci">static int svm_handle_invalid_exit(struct kvm_vcpu *vcpu, u64 exit_code)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03441">svm.c:3441</a></div></div>
<div class="ttc" id="asvm_8c_html_ad838ad3f2e1e678e2c13720c679dc8f8"><div class="ttname"><a href="svm_8c.html#ad838ad3f2e1e678e2c13720c679dc8f8">svm_check_exit_valid</a></div><div class="ttdeci">static bool svm_check_exit_valid(u64 exit_code)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03435">svm.c:3435</a></div></div>
<div class="ttc" id="ax86_8c_html_a92f17256a8d83aac265d08a1e3500340"><div class="ttname"><a href="x86_8c.html#a92f17256a8d83aac265d08a1e3500340">kvm_emulate_halt</a></div><div class="ttdeci">int kvm_emulate_halt(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09857">x86.c:9857</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a8afafecae406016532810194f187fe2c_cgraph.png" border="0" usemap="#asvm_8c_a8afafecae406016532810194f187fe2c_cgraph" alt=""/></div>
<map name="asvm_8c_a8afafecae406016532810194f187fe2c_cgraph" id="asvm_8c_a8afafecae406016532810194f187fe2c_cgraph">
<area shape="rect" title=" " alt="" coords="5,610,193,637"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="241,559,461,586"/>
<area shape="rect" href="svm_8c.html#a21af2401d39dc5c49a388960ce1196ad" title=" " alt="" coords="287,509,416,535"/>
<area shape="rect" href="x86_8c.html#a92f17256a8d83aac265d08a1e3500340" title=" " alt="" coords="521,939,665,966"/>
<area shape="rect" href="svm_8c.html#a173c3f7c02a4287d140cc0f34564a7bd" title=" " alt="" coords="285,378,417,405"/>
<area shape="rect" href="svm_8c.html#a723646ac5d3234ba8e1845249e6a0935" title=" " alt="" coords="287,661,415,687"/>
<area shape="rect" href="svm_8c.html#ad838ad3f2e1e678e2c13720c679dc8f8" title=" " alt="" coords="268,711,435,738"/>
<area shape="rect" href="svm_8c.html#ab46a833ac93ce3fda7973768cadb1929" title=" " alt="" coords="259,610,443,637"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="530,458,657,485"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="805,559,876,586"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1283,509,1403,535"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="771,407,910,434"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1275,446,1411,473"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="1037,407,1170,434"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="1269,370,1416,397"/>
<area shape="rect" href="x86_8c.html#a8e4eadde8e72cc522781d684a646fbe6" title=" " alt="" coords="743,1002,938,1029"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="725,939,956,966"/>
<area shape="rect" href="x86_8c.html#ad9a061ca4a3ded30c0c698224da4504d" title=" " alt="" coords="1024,1015,1183,1042"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="1283,1041,1402,1067"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="1013,866,1194,893"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="1010,939,1197,966"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1281,822,1404,849"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1263,873,1422,915"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1255,721,1430,747"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1257,771,1428,798"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1269,939,1416,966"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="1251,990,1435,1017"/>
<area shape="rect" href="x86_8c.html#a955a40f66041d085593b16a75075a1ae" title=" " alt="" coords="515,243,672,270"/>
<area shape="rect" href="x86_8c.html#a1550ae1115ac5be61ab770f6f3c5f513" title=" " alt="" coords="513,117,673,143"/>
<area shape="rect" href="x86_8c.html#aeeb1ecca8bf1a2b4cda190c5426b80c9" title=" " alt="" coords="761,218,921,245"/>
<area shape="rect" href="x86_8c.html#a3eb5a7800dd3bcd13dbc74632fbf22a1" title=" " alt="" coords="749,269,932,295"/>
<area shape="rect" href="x86_8c.html#accdc879b22f280aa9ba41e58a6c1658e" title=" " alt="" coords="759,167,922,194"/>
<area shape="rect" href="x86_8c.html#a0f0d8061749acba7b8f4d1b9b0884079" title=" " alt="" coords="1004,122,1203,149"/>
<area shape="rect" href="x86_8c.html#a5492b645ed1b58ebf45bd68cad0b5092" title=" " alt="" coords="1025,173,1181,215"/>
<area shape="rect" href="x86_8c.html#a6b64ebea5fdc7d1f0434fb509942a56f" title=" " alt="" coords="1020,291,1187,332"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="1033,239,1174,266"/>
<area shape="rect" href="x86_8c.html#a493307a40b51eeb761e91a1910876721" title=" " alt="" coords="1036,71,1171,98"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a7284219cd6cc4787f8e1eba2d4cf2c19" title=" " alt="" coords="766,66,915,93"/>
<area shape="rect" href="x86_8c.html#a99cf4c7be0b4cac0886649c7da9daa66" title=" " alt="" coords="749,117,932,143"/>
<area shape="rect" href="x86_8c.html#a4a7acb17f522083e1a9edc95e3788295" title=" " alt="" coords="1020,5,1187,47"/>
<area shape="rect" href="mmu_8c.html#a3d0bd209d792a4316f3b40681fdc10f9" title=" " alt="" coords="509,737,677,763"/>
<area shape="rect" href="mmu_8c.html#a899cf46c0ee6df6305c7fe167421e2b7" title=" " alt="" coords="747,686,934,713"/>
<area shape="rect" href="mmu_8c.html#abaee26e516b75f579b063a76c376b045" title=" " alt="" coords="1025,799,1181,826"/>
<area shape="rect" href="mmu__internal_8h.html#ae3c71be306692107b4d90bfb8d24d7f5" title=" " alt="" coords="745,787,936,814"/>
<area shape="rect" href="mmu_8c.html#a45417375d740e0905773ac641827e0a0" title=" " alt="" coords="741,838,941,865"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="749,889,932,915"/>
<area shape="rect" href="mmu_8c.html#aa6dadc0bd20da0d41281abe089941491" title=" " alt="" coords="1033,647,1173,674"/>
<area shape="rect" href="mmu_8c.html#a24c91b8ae0a349c76c95f6266f62d6e1" title=" " alt="" coords="1042,698,1165,725"/>
<area shape="rect" href="mmu_8c.html#a82303f01ba06fead33e8a67eac44807e" title=" " alt="" coords="1016,749,1191,775"/>
<area shape="rect" href="svm_8c.html#adc30f731ef4ff2d797ec137e5fab0f69" title=" " alt="" coords="542,610,645,637"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a8afafecae406016532810194f187fe2c_icgraph.png" border="0" usemap="#asvm_8c_a8afafecae406016532810194f187fe2c_icgraph" alt=""/></div>
<map name="asvm_8c_a8afafecae406016532810194f187fe2c_icgraph" id="asvm_8c_a8afafecae406016532810194f187fe2c_icgraph">
<area shape="rect" title=" " alt="" coords="416,35,604,61"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="5,5,163,32"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="211,27,368,69"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="223,93,356,120"/>
</map>
</div>

</div>
</div>
<a id="ab8f81a22445092aa0952e6a93442586b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8f81a22445092aa0952e6a93442586b">&#9670;&nbsp;</a></span>svm_is_valid_cr0()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_is_valid_cr0 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>cr0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01847">1847</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;{</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7bfd600c22c380630d68725c8af7e709"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bfd600c22c380630d68725c8af7e709">&#9670;&nbsp;</a></span>svm_is_valid_cr4()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_is_valid_cr4 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>cr4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01909">1909</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;{</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a66b89ca49c9571c6ce3532b335aeed2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66b89ca49c9571c6ce3532b335aeed2d">&#9670;&nbsp;</a></span>svm_is_vnmi_pending()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_is_vnmi_pending </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03578">3578</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;{</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160; </div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">is_vnmi_enabled</a>(svm))</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160; </div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    <span class="keywordflow">return</span> !!(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl &amp; V_NMI_PENDING_MASK);</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a66b89ca49c9571c6ce3532b335aeed2d_cgraph.png" border="0" usemap="#asvm_8c_a66b89ca49c9571c6ce3532b335aeed2d_cgraph" alt=""/></div>
<map name="asvm_8c_a66b89ca49c9571c6ce3532b335aeed2d_cgraph" id="asvm_8c_a66b89ca49c9571c6ce3532b335aeed2d_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,172,57"/>
<area shape="rect" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d" title=" " alt="" coords="220,5,352,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="251,56,321,83"/>
<area shape="rect" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8" title=" " alt="" coords="400,5,545,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="593,5,713,32"/>
</map>
</div>

</div>
</div>
<a id="a5f28637bd5292dc7bb085750c3e31d94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f28637bd5292dc7bb085750c3e31d94">&#9670;&nbsp;</a></span>svm_load_mmu_pgd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_load_mmu_pgd </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hpa_t&#160;</td>
          <td class="paramname"><em>root_hpa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>root_level</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04246">4246</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;{</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> cr3;</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160; </div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>) {</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.nested_cr3 = __sme_set(root_hpa);</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;        <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a7c9727e792c945164c49fbd9793c4e97">VMCB_NPT</a>);</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160; </div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;        <a class="code" href="kvm__onhyperv_8c.html#a1e1056d6c56ab8e95a215e42a0290633">hv_track_root_tdp</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, root_hpa);</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160; </div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;        cr3 = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.cr3;</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (root_level &gt;= <a class="code" href="mmu_8h.html#ac16f657d0a07511b24afa81de87e2404">PT64_ROOT_4LEVEL</a>) {</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;        cr3 = __sme_set(root_hpa) | <a class="code" href="mmu_8h.html#ad1aee9e6e5e9d85568a734930c8a084a">kvm_get_active_pcid</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;        <span class="comment">/* PCID in the guest should be impossible with a 32-bit MMU. */</span></div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;        WARN_ON_ONCE(<a class="code" href="mmu_8h.html#ad1aee9e6e5e9d85568a734930c8a084a">kvm_get_active_pcid</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>));</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;        cr3 = root_hpa;</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;    }</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160; </div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cr3 = cr3;</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>);</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;}</div>
<div class="ttc" id="akvm__onhyperv_8c_html_a1e1056d6c56ab8e95a215e42a0290633"><div class="ttname"><a href="kvm__onhyperv_8c.html#a1e1056d6c56ab8e95a215e42a0290633">hv_track_root_tdp</a></div><div class="ttdeci">void hv_track_root_tdp(struct kvm_vcpu *vcpu, hpa_t root_tdp)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__onhyperv_8c_source.html#l00112">kvm_onhyperv.c:112</a></div></div>
<div class="ttc" id="ammu_8h_html_ad1aee9e6e5e9d85568a734930c8a084a"><div class="ttname"><a href="mmu_8h.html#ad1aee9e6e5e9d85568a734930c8a084a">kvm_get_active_pcid</a></div><div class="ttdeci">static unsigned long kvm_get_active_pcid(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8h_source.html#l00144">mmu.h:144</a></div></div>
<div class="ttc" id="asvm_8h_html_aaf8fd5f0e57d456151c951e0f3715fc4a7c9727e792c945164c49fbd9793c4e97"><div class="ttname"><a href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a7c9727e792c945164c49fbd9793c4e97">VMCB_NPT</a></div><div class="ttdeci">@ VMCB_NPT</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00054">svm.h:54</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5f28637bd5292dc7bb085750c3e31d94_cgraph.png" border="0" usemap="#asvm_8c_a5f28637bd5292dc7bb085750c3e31d94_cgraph" alt=""/></div>
<map name="asvm_8c_a5f28637bd5292dc7bb085750c3e31d94_cgraph" id="asvm_8c_a5f28637bd5292dc7bb085750c3e31d94_cgraph">
<area shape="rect" title=" " alt="" coords="5,97,163,123"/>
<area shape="rect" href="kvm__onhyperv_8c.html#a1e1056d6c56ab8e95a215e42a0290633" title=" " alt="" coords="221,19,360,46"/>
<area shape="rect" href="mmu_8h.html#ad1aee9e6e5e9d85568a734930c8a084a" title=" " alt="" coords="211,71,371,98"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="255,122,326,149"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="223,173,359,199"/>
<area shape="rect" href="kvm__onhyperv_8c.html#a2cb4387189fe3ba2db779c40333eed56" title=" " alt="" coords="419,17,580,43"/>
<area shape="rect" href="kvm__onhyperv_8c.html#a8b8dd786b7872c03b29fda0f4995a6d5" title=" " alt="" coords="628,5,803,47"/>
<area shape="rect" href="kvm__onhyperv_8c.html#a7312126e879429e4deebc844f605e203" title=" " alt="" coords="851,13,1041,39"/>
<area shape="rect" href="kvm__onhyperv_8c.html#aa4b7fe2c8c56541efd19fc9d77739637" title=" " alt="" coords="1089,13,1287,39"/>
<area shape="rect" href="mmu_8h.html#a573994365668ea7cc32c0858f96d8e64" title=" " alt="" coords="443,71,556,98"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="658,122,773,149"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="642,71,789,98"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="873,71,1019,98"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1091,97,1285,123"/>
</map>
</div>

</div>
</div>
<a id="ab4bda9cd8e4f3408d51dff1dd4403a11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4bda9cd8e4f3408d51dff1dd4403a11">&#9670;&nbsp;</a></span>svm_msr_filter_changed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_msr_filter_changed </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00920">920</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;{</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    u32 i;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">     * Set intercept permissions for all direct access MSRs again. They</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">     * will automatically get filtered through the MSR filter, so we are</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">     * back in sync after this.</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">for</span> (i = 0; <a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].<a class="code" href="structsvm__direct__access__msrs.html#a392caedc2f625128ed478904dafbe718">index</a> != <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>; i++) {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        u32 msr = <a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].<a class="code" href="structsvm__direct__access__msrs.html#a392caedc2f625128ed478904dafbe718">index</a>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        u32 read = test_bit(i, svm-&gt;<a class="code" href="structvcpu__svm.html#aa3288372e9c9edbcd129adb446479dfd">shadow_msr_intercept</a>.read);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        u32 write = test_bit(i, svm-&gt;<a class="code" href="structvcpu__svm.html#aa3288372e9c9edbcd129adb446479dfd">shadow_msr_intercept</a>.write);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <a class="code" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a">set_msr_interception_bitmap</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, msr, read, write);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    }</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab4bda9cd8e4f3408d51dff1dd4403a11_cgraph.png" border="0" usemap="#asvm_8c_ab4bda9cd8e4f3408d51dff1dd4403a11_cgraph" alt=""/></div>
<map name="asvm_8c_ab4bda9cd8e4f3408d51dff1dd4403a11_cgraph" id="asvm_8c_ab4bda9cd8e4f3408d51dff1dd4403a11_cgraph">
<area shape="rect" title=" " alt="" coords="5,173,187,200"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="235,126,393,167"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="508,224,579,251"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="473,5,614,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="441,57,645,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="470,123,617,149"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="468,173,619,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="693,173,867,200"/>
</map>
</div>

</div>
</div>
<a id="a35438091c40e77c617ce2ec9d521cc1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35438091c40e77c617ce2ec9d521cc1f">&#9670;&nbsp;</a></span>svm_msrpm_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u32 svm_msrpm_offset </td>
          <td>(</td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>msr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00264">264</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    u32 offset;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="svm_8c.html#ac84410b6049231218187535376fcbdba">NUM_MSR_MAPS</a>; i++) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span> (msr &lt; <a class="code" href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a>[i] ||</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            msr &gt;= <a class="code" href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a>[i] + <a class="code" href="svm_8c.html#a6c585eaa599f4c72e9f1f6fcc1ea0fb8">MSRS_IN_RANGE</a>)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        offset  = (msr - <a class="code" href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a>[i]) / 4; <span class="comment">/* 4 msrs per u8 */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        offset += (i * <a class="code" href="svm_8c.html#a0c8786ad06a6d122f851eee8d43424d9">MSRS_RANGE_SIZE</a>);       <span class="comment">/* add range offset */</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">/* Now we have the u8 offset - but need the u32 offset */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">return</span> offset / 4;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">/* MSR not in any range */</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a0c8786ad06a6d122f851eee8d43424d9"><div class="ttname"><a href="svm_8c.html#a0c8786ad06a6d122f851eee8d43424d9">MSRS_RANGE_SIZE</a></div><div class="ttdeci">#define MSRS_RANGE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00261">svm.c:261</a></div></div>
<div class="ttc" id="asvm_8c_html_a6c585eaa599f4c72e9f1f6fcc1ea0fb8"><div class="ttname"><a href="svm_8c.html#a6c585eaa599f4c72e9f1f6fcc1ea0fb8">MSRS_IN_RANGE</a></div><div class="ttdeci">#define MSRS_IN_RANGE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00262">svm.c:262</a></div></div>
<div class="ttc" id="asvm_8c_html_ac84410b6049231218187535376fcbdba"><div class="ttname"><a href="svm_8c.html#ac84410b6049231218187535376fcbdba">NUM_MSR_MAPS</a></div><div class="ttdeci">#define NUM_MSR_MAPS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00260">svm.c:260</a></div></div>
<div class="ttc" id="asvm_8c_html_aee88cc07545f234f7f296637887bb17c"><div class="ttname"><a href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a></div><div class="ttdeci">static const u32 msrpm_ranges[]</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00258">svm.c:258</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a35438091c40e77c617ce2ec9d521cc1f_icgraph.png" border="0" usemap="#asvm_8c_a35438091c40e77c617ce2ec9d521cc1f_icgraph" alt=""/></div>
<map name="asvm_8c_a35438091c40e77c617ce2ec9d521cc1f_icgraph" id="asvm_8c_a35438091c40e77c617ce2ec9d521cc1f_icgraph">
<area shape="rect" title=" " alt="" coords="2319,319,2465,346"/>
<area shape="rect" href="svm_8c.html#a0a9af31dcd464498479ea7b57cdc106f" title=" " alt="" coords="2085,239,2232,266"/>
<area shape="rect" href="svm_8c.html#a9dbf1138872247b45ebbc4880523c0dd" title=" " alt="" coords="2075,290,2243,316"/>
<area shape="rect" href="svm_2nested_8c.html#a90464b57b273a88a7a1fb3c2cefb257a" title=" " alt="" coords="2047,424,2271,451"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="2079,341,2238,382"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="1827,239,1989,266"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="1850,290,1966,316"/>
<area shape="rect" href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba" title=" " alt="" coords="1825,568,1991,595"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="643,707,835,734"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="409,644,562,685"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="405,710,565,736"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="419,760,552,787"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="220,651,339,678"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="5,651,172,678"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="1829,391,1987,418"/>
<area shape="rect" href="svm_8c.html#ab4bda9cd8e4f3408d51dff1dd4403a11" title=" " alt="" coords="1817,340,1999,367"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="972,223,1059,250"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="1393,100,1543,141"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="1184,157,1336,198"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="1615,391,1754,418"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="1600,165,1769,206"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="1617,644,1753,671"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1205,543,1315,570"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="1618,594,1751,620"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="1605,325,1764,366"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="1600,442,1769,468"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="675,271,803,298"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="1410,391,1526,418"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="1189,391,1331,418"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="895,391,1136,418"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="1395,165,1541,206"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="1401,594,1535,620"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="938,566,1093,592"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="905,492,1125,519"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="632,473,847,514"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="637,590,841,616"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="637,539,842,566"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="410,396,561,423"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="648,641,831,682"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="387,503,584,530"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="400,578,571,620"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="650,371,829,398"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="1392,332,1544,359"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="1384,282,1552,308"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="1200,223,1320,250"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="1185,274,1335,316"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="943,274,1087,316"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="944,442,1087,468"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="1388,492,1548,519"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="1205,492,1315,519"/>
</map>
</div>

</div>
</div>
<a id="a20c1180c4bb6850bae73e3cbda53c695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20c1180c4bb6850bae73e3cbda53c695">&#9670;&nbsp;</a></span>svm_nmi_allowed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_nmi_allowed </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_injection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03752">3752</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;{</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">nested_run_pending</a>)</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;        <span class="keywordflow">return</span> -EBUSY;</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160; </div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e">svm_nmi_blocked</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160; </div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    <span class="comment">/* An NMI must not be injected into L2 if it&#39;s supposed to VM-Exit.  */</span></div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;    <span class="keywordflow">if</span> (for_injection &amp;&amp; <a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; <a class="code" href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346">nested_exit_on_nmi</a>(svm))</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;        <span class="keywordflow">return</span> -EBUSY;</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a37477553ea45acae098350e7d572ae2e"><div class="ttname"><a href="svm_8c.html#a37477553ea45acae098350e7d572ae2e">svm_nmi_blocked</a></div><div class="ttdeci">bool svm_nmi_blocked(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03735">svm.c:3735</a></div></div>
<div class="ttc" id="asvm_8h_html_aefa7c9e670f5a86519f40b06f5277346"><div class="ttname"><a href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346">nested_exit_on_nmi</a></div><div class="ttdeci">static bool nested_exit_on_nmi(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00586">svm.h:586</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a20c1180c4bb6850bae73e3cbda53c695_cgraph.png" border="0" usemap="#asvm_8c_a20c1180c4bb6850bae73e3cbda53c695_cgraph" alt=""/></div>
<map name="asvm_8c_a20c1180c4bb6850bae73e3cbda53c695_cgraph" id="asvm_8c_a20c1180c4bb6850bae73e3cbda53c695_cgraph">
<area shape="rect" title=" " alt="" coords="5,95,145,121"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="992,119,1112,145"/>
<area shape="rect" href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346" title=" " alt="" coords="380,43,533,69"/>
<area shape="rect" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e" title=" " alt="" coords="193,132,332,159"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="625,195,695,221"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="581,43,739,69"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="423,245,490,272"/>
<area shape="rect" href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3" title=" " alt="" coords="380,144,533,171"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="601,245,719,272"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="787,245,944,272"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="993,245,1111,272"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1399,238,1572,279"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1160,271,1351,297"/>
<area shape="rect" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d" title=" " alt="" coords="594,144,726,171"/>
<area shape="rect" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8" title=" " alt="" coords="793,144,938,171"/>
</map>
</div>

</div>
</div>
<a id="a37477553ea45acae098350e7d572ae2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37477553ea45acae098350e7d572ae2e">&#9670;&nbsp;</a></span>svm_nmi_blocked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool svm_nmi_blocked </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03735">3735</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;{</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160; </div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a>(svm))</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160; </div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(vcpu) &amp;&amp; <a class="code" href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346">nested_exit_on_nmi</a>(svm))</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160; </div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3">svm_get_nmi_mask</a>(vcpu))</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160; </div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    <span class="keywordflow">return</span> vmcb-&gt;control.int_state &amp; SVM_INTERRUPT_SHADOW_MASK;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a37477553ea45acae098350e7d572ae2e_cgraph.png" border="0" usemap="#asvm_8c_a37477553ea45acae098350e7d572ae2e_cgraph" alt=""/></div>
<map name="asvm_8c_a37477553ea45acae098350e7d572ae2e_cgraph" id="asvm_8c_a37477553ea45acae098350e7d572ae2e_cgraph">
<area shape="rect" title=" " alt="" coords="5,165,144,191"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="235,63,302,90"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="804,114,924,141"/>
<area shape="rect" href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346" title=" " alt="" coords="192,165,345,191"/>
<area shape="rect" href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3" title=" " alt="" coords="192,215,345,242"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="437,266,507,293"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="413,63,531,90"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="599,13,756,39"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="805,13,923,39"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1211,5,1384,47"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="972,38,1163,65"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="393,165,551,191"/>
<area shape="rect" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d" title=" " alt="" coords="406,215,538,242"/>
<area shape="rect" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8" title=" " alt="" coords="605,190,750,217"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a37477553ea45acae098350e7d572ae2e_icgraph.png" border="0" usemap="#asvm_8c_a37477553ea45acae098350e7d572ae2e_icgraph" alt=""/></div>
<map name="asvm_8c_a37477553ea45acae098350e7d572ae2e_icgraph" id="asvm_8c_a37477553ea45acae098350e7d572ae2e_icgraph">
<area shape="rect" title=" " alt="" coords="251,31,389,57"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,5,203,32"/>
<area shape="rect" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695" title=" " alt="" coords="34,56,174,83"/>
</map>
</div>

</div>
</div>
<a id="a6140ed0efc94e021cb04529340c1dc98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6140ed0efc94e021cb04529340c1dc98">&#9670;&nbsp;</a></span>svm_patch_hypercall()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_patch_hypercall </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>hypercall</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04272">4272</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;{</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;<span class="comment">     * Patch in the VMMCALL instruction:</span></div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;    hypercall[0] = 0x0f;</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;    hypercall[1] = 0x01;</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;    hypercall[2] = 0xd9;</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad72538164da58fe5a35e1753dd52d5b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad72538164da58fe5a35e1753dd52d5b4">&#9670;&nbsp;</a></span>svm_prepare_host_switch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_prepare_host_switch </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01545">1545</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;{</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#a4969041ad5b96825f67160eb1ae9f726">guest_state_loaded</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_a4969041ad5b96825f67160eb1ae9f726"><div class="ttname"><a href="structvcpu__svm.html#a4969041ad5b96825f67160eb1ae9f726">vcpu_svm::guest_state_loaded</a></div><div class="ttdeci">bool guest_state_loaded</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00289">svm.h:289</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad72538164da58fe5a35e1753dd52d5b4_cgraph.png" border="0" usemap="#asvm_8c_ad72538164da58fe5a35e1753dd52d5b4_cgraph" alt=""/></div>
<map name="asvm_8c_ad72538164da58fe5a35e1753dd52d5b4_cgraph" id="asvm_8c_ad72538164da58fe5a35e1753dd52d5b4_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,196,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="244,5,315,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad72538164da58fe5a35e1753dd52d5b4_icgraph.png" border="0" usemap="#asvm_8c_ad72538164da58fe5a35e1753dd52d5b4_icgraph" alt=""/></div>
<map name="asvm_8c_ad72538164da58fe5a35e1753dd52d5b4_icgraph" id="asvm_8c_ad72538164da58fe5a35e1753dd52d5b4_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,360,32"/>
<area shape="rect" href="svm_8c.html#af102e65fa4a28844d0bd7bbb75bd4565" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="a6571ab4636ff87fda563be50ab7195ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6571ab4636ff87fda563be50ab7195ef">&#9670;&nbsp;</a></span>svm_prepare_switch_to_guest()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_prepare_switch_to_guest </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01506">1506</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;{</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a> *sd = per_cpu_ptr(&amp;svm_data, vcpu-&gt;cpu);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <a class="code" href="sev_8c.html#aba11fc99cad465d138aeb5c2cb3508e2">sev_es_unmap_ghcb</a>(svm);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#a4969041ad5b96825f67160eb1ae9f726">guest_state_loaded</a>)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160; </div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">     * Save additional host state that will be restored on VMEXIT (sev-es)</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">     * or subsequent vmload of host save area.</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <a class="code" href="svm__ops_8h.html#a3336fc2e6f1d8900d37d75cd3472ee6c">vmsave</a>(sd-&gt;<a class="code" href="structsvm__cpu__data.html#a7b3be8bfedec131eb474be2ec6a8de10">save_area_pa</a>);</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(vcpu-&gt;kvm)) {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keyword">struct </span>sev_es_save_area *hostsa;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        hostsa = (<span class="keyword">struct </span>sev_es_save_area *)(page_address(sd-&gt;<a class="code" href="structsvm__cpu__data.html#ac7d670a65f2dda678bc5f58478c5ebbc">save_area</a>) + 0x400);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <a class="code" href="sev_8c.html#ad4655e18a7969aeb0228ecbbc011f546">sev_es_prepare_switch_to_guest</a>(hostsa);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    }</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#adacf7fe5bb2bb2fdef07153a859b75ba">tsc_scaling</a>)</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <a class="code" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34">__svm_write_tsc_multiplier</a>(vcpu-&gt;arch.tsc_scaling_ratio);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment">     * TSC_AUX is always virtualized for SEV-ES guests when the feature is</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">     * available. The user return MSR support is not required in this case</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">     * because TSC_AUX is restored on #VMEXIT from the host save area</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">     * (which has been initialized in svm_hardware_enable()).</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keywordflow">if</span> (likely(tsc_aux_uret_slot &gt;= 0) &amp;&amp;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        (!boot_cpu_has(X86_FEATURE_V_TSC_AUX) || !<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(vcpu-&gt;kvm)))</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <a class="code" href="x86_8c.html#af6db8fdfb7625ba5b530e59102ab2520">kvm_set_user_return_msr</a>(tsc_aux_uret_slot, svm-&gt;<a class="code" href="structvcpu__svm.html#ae25c348c7b9864253f4db3fb8a3c3e59">tsc_aux</a>, -1ull);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a4969041ad5b96825f67160eb1ae9f726">guest_state_loaded</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_aba11fc99cad465d138aeb5c2cb3508e2"><div class="ttname"><a href="sev_8c.html#aba11fc99cad465d138aeb5c2cb3508e2">sev_es_unmap_ghcb</a></div><div class="ttdeci">void sev_es_unmap_ghcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02614">sev.c:2614</a></div></div>
<div class="ttc" id="asev_8c_html_ad4655e18a7969aeb0228ecbbc011f546"><div class="ttname"><a href="sev_8c.html#ad4655e18a7969aeb0228ecbbc011f546">sev_es_prepare_switch_to_guest</a></div><div class="ttdeci">void sev_es_prepare_switch_to_guest(struct sev_es_save_area *hostsa)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03119">sev.c:3119</a></div></div>
<div class="ttc" id="asvm__ops_8h_html_a3336fc2e6f1d8900d37d75cd3472ee6c"><div class="ttname"><a href="svm__ops_8h.html#a3336fc2e6f1d8900d37d75cd3472ee6c">vmsave</a></div><div class="ttdeci">static __always_inline void vmsave(unsigned long pa)</div><div class="ttdef"><b>Definition:</b> <a href="svm__ops_8h_source.html#l00059">svm_ops.h:59</a></div></div>
<div class="ttc" id="ax86_8c_html_af6db8fdfb7625ba5b530e59102ab2520"><div class="ttname"><a href="x86_8c.html#af6db8fdfb7625ba5b530e59102ab2520">kvm_set_user_return_msr</a></div><div class="ttdeci">int kvm_set_user_return_msr(unsigned slot, u64 value, u64 mask)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00442">x86.c:442</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a6571ab4636ff87fda563be50ab7195ef_cgraph.png" border="0" usemap="#asvm_8c_a6571ab4636ff87fda563be50ab7195ef_cgraph" alt=""/></div>
<map name="asvm_8c_a6571ab4636ff87fda563be50ab7195ef_cgraph" id="asvm_8c_a6571ab4636ff87fda563be50ab7195ef_cgraph">
<area shape="rect" title=" " alt="" coords="5,158,161,199"/>
<area shape="rect" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34" title=" " alt="" coords="209,5,409,32"/>
<area shape="rect" href="x86_8c.html#af6db8fdfb7625ba5b530e59102ab2520" title=" " alt="" coords="214,56,405,83"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="254,107,365,133"/>
<area shape="rect" href="sev_8c.html#ad4655e18a7969aeb0228ecbbc011f546" title=" " alt="" coords="223,158,396,199"/>
<area shape="rect" href="sev_8c.html#aba11fc99cad465d138aeb5c2cb3508e2" title=" " alt="" coords="231,224,388,251"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="274,275,345,301"/>
<area shape="rect" href="svm__ops_8h.html#a3336fc2e6f1d8900d37d75cd3472ee6c" title=" " alt="" coords="272,325,347,352"/>
<area shape="rect" href="x86_8c.html#a5b48d629cc7cd7f1016e42f036f60159" title=" " alt="" coords="461,56,616,83"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="485,107,592,133"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="468,275,609,301"/>
<area shape="rect" href="kvm__main_8c.html#a1cf9d9c864cd7f9b5b32fc880c0872ab" title=" " alt="" coords="471,173,606,200"/>
<area shape="rect" href="sev_8c.html#a9a51f2493b65daa56d8c07a204acc7cc" title=" " alt="" coords="457,224,620,251"/>
<area shape="rect" href="kvm__main_8c.html#a6f9056f6dc868b557b2a2c8e1c548762" title=" " alt="" coords="687,313,822,340"/>
<area shape="rect" href="kvm__main_8c.html#ab3f118170e5a0cf30913bc0cd0a79cfd" title=" " alt="" coords="670,247,839,289"/>
<area shape="rect" href="kvm__main_8c.html#af83e69473e2fe5bf6e452f3fc1f414d2" title=" " alt="" coords="903,309,1079,336"/>
<area shape="rect" href="kvm__main_8c.html#a18a05d2f708322bccd0481cee9b76bdc" title=" " alt="" coords="905,360,1076,387"/>
<area shape="rect" href="kvm__main_8c.html#a99f99281cc81d5cd69f5825ccb8793b4" title=" " alt="" coords="1140,359,1355,385"/>
<area shape="rect" href="kvm__main_8c.html#a6845d169e1c19786abe7719700b9f6b9" title=" " alt="" coords="1407,308,1594,335"/>
<area shape="rect" href="kvm__main_8c.html#a6c7165822622ebbd29159771905bd317" title=" " alt="" coords="1403,359,1599,385"/>
<area shape="rect" href="kvm__main_8c.html#a05228520c714138c61d76bfbc12c162c" title=" " alt="" coords="1651,320,1835,347"/>
<area shape="rect" href="kvm__main_8c.html#aefbc4e0cbda09938de01d0afb0c06d59" title=" " alt="" coords="1887,345,2073,372"/>
<area shape="rect" href="kvm__main_8c.html#acf5fa0af4d165e38ac4721f4061b6f73" title=" " alt="" coords="1156,409,1339,436"/>
<area shape="rect" href="kvm__main_8c.html#adb6ddc9dc8c5e447e04b1be97543f347" title=" " alt="" coords="1665,396,1820,423"/>
<area shape="rect" href="kvm__main_8c.html#ac4b56de4919be80c9cd4289f20437c64" title=" " alt="" coords="889,256,1092,283"/>
<area shape="rect" href="kvm__main_8c.html#ae4806d9a69b751639c175cb98e468f15" title=" " alt="" coords="1156,205,1339,232"/>
<area shape="rect" href="dirty__ring_8c.html#ac1878b63f1f337e93cf186ebd4fffcc4" title=" " alt="" coords="1415,141,1587,182"/>
<area shape="rect" href="dirty__ring_8c.html#a81ebbf462440ed5392d6d3412a859ae7" title=" " alt="" coords="1421,207,1580,233"/>
<area shape="rect" href="kvm__main_8c.html#ac5a3afd8e2d8d1139dc7711c4b9e07e3" title=" " alt="" coords="1414,257,1587,284"/>
<area shape="rect" href="dirty__ring_8c.html#ad6e626257c739b2ac3d397119a7cf798" title=" " alt="" coords="1647,257,1839,284"/>
<area shape="rect" href="dirty__ring_8c.html#a6fe5cd75b9bac6497e1ae7340f2a5f7b" title=" " alt="" coords="1669,156,1817,183"/>
<area shape="rect" href="dirty__ring_8c.html#a22c9a239acf3463a8599a21c0a756538" title=" " alt="" coords="1653,207,1832,233"/>
<area shape="rect" href="dirty__ring_8c.html#acd0a1e586324b4c49b429c7a392db73f" title=" " alt="" coords="1901,181,2059,208"/>
<area shape="rect" href="kvm__main_8c.html#a49ed988e062d259a8706411f619bf1f7" title=" " alt="" coords="668,141,841,168"/>
<area shape="rect" href="kvm__main_8c.html#a03aae88de564edba8a3a2d10bc5e7b20" title=" " alt="" coords="697,192,812,219"/>
<area shape="rect" href="kvm__main_8c.html#a7079b0256c7572c701a6e1526f58fdac" title=" " alt="" coords="897,97,1084,124"/>
<area shape="rect" href="kvm__main_8c.html#a7c20e0f654f0b4472c3833f0a563e11e" title=" " alt="" coords="927,148,1055,175"/>
<area shape="rect" href="kvm__main_8c.html#a04c9651c5f9a0485fd1e7152bdb01353" title=" " alt="" coords="1168,97,1327,124"/>
<area shape="rect" href="kvm__main_8c.html#ae374ebe48072080788db56075dd9a762" title=" " alt="" coords="1431,89,1570,116"/>
<area shape="rect" href="kvm__main_8c.html#ab58025ccc253a102c64561fa61c2a514" title=" " alt="" coords="1667,89,1819,116"/>
<area shape="rect" href="kvm__main_8c.html#a77ec4b9140d69a05f3b4e7836cc03a96" title=" " alt="" coords="1899,89,2061,116"/>
</map>
</div>

</div>
</div>
<a id="a12d4d3a3b5ae14af748037ebf85485c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12d4d3a3b5ae14af748037ebf85485c1">&#9670;&nbsp;</a></span>svm_recalc_instruction_intercepts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_recalc_instruction_intercepts </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01172">1172</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;{</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">     * Intercept INVPCID if shadow paging is enabled to sync/free shadow</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">     * roots, or if INVPCID is disabled in the guest to inject #UD.</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_INVPCID)) {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a> ||</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            !<a class="code" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_INVPCID))</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_INVPCID);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_INVPCID);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_RDTSCP)) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a>(vcpu, X86_FEATURE_RDTSCP))</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_RDTSCP);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_RDTSCP);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;}</div>
<div class="ttc" id="acpuid_8h_html_a4a2881bd1ba1c3c4b2fb5f3b13ac12de"><div class="ttname"><a href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a></div><div class="ttdeci">static __always_inline bool kvm_cpu_cap_has(unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00221">cpuid.h:221</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a12d4d3a3b5ae14af748037ebf85485c1_cgraph.png" border="0" usemap="#asvm_8c_a12d4d3a3b5ae14af748037ebf85485c1_cgraph" alt=""/></div>
<map name="asvm_8c_a12d4d3a3b5ae14af748037ebf85485c1_cgraph" id="asvm_8c_a12d4d3a3b5ae14af748037ebf85485c1_cgraph">
<area shape="rect" title=" " alt="" coords="5,293,177,334"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="231,123,362,149"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="226,249,367,276"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="227,325,366,352"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="225,449,368,476"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="687,123,794,149"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="416,68,601,95"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1108,173,1256,200"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="880,173,1039,200"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="657,5,825,32"/>
<area shape="rect" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="658,57,823,98"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="669,173,812,200"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="891,64,1028,91"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="902,224,1017,251"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="439,249,578,276"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="442,449,575,476"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="667,325,814,352"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="681,559,801,585"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="649,377,832,418"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="650,442,831,483"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="673,508,809,535"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="665,609,816,636"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="900,424,1019,451"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="883,475,1036,501"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1325,417,1499,458"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1087,449,1277,476"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a12d4d3a3b5ae14af748037ebf85485c1_icgraph.png" border="0" usemap="#asvm_8c_a12d4d3a3b5ae14af748037ebf85485c1_icgraph" alt=""/></div>
<map name="asvm_8c_a12d4d3a3b5ae14af748037ebf85485c1_icgraph" id="asvm_8c_a12d4d3a3b5ae14af748037ebf85485c1_icgraph">
<area shape="rect" title=" " alt="" coords="381,27,553,69"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="214,5,301,32"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="181,57,333,98"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
</map>
</div>

</div>
</div>
<a id="aa3f43ee7024c775ce671371e2bb5bf98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3f43ee7024c775ce671371e2bb5bf98">&#9670;&nbsp;</a></span>svm_sched_in()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_sched_in </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cpu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04553">4553</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;{</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#ab226ac0135835109146350d5db3d4031">kvm_pause_in_guest</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;        <a class="code" href="svm_8c.html#aacde987fd6ae3956ec075251296c37a0">shrink_ple_window</a>(vcpu);</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_aacde987fd6ae3956ec075251296c37a0"><div class="ttname"><a href="svm_8c.html#aacde987fd6ae3956ec075251296c37a0">shrink_ple_window</a></div><div class="ttdeci">static void shrink_ple_window(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01088">svm.c:1088</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aa3f43ee7024c775ce671371e2bb5bf98_cgraph.png" border="0" usemap="#asvm_8c_aa3f43ee7024c775ce671371e2bb5bf98_cgraph" alt=""/></div>
<map name="asvm_8c_aa3f43ee7024c775ce671371e2bb5bf98_cgraph" id="asvm_8c_aa3f43ee7024c775ce671371e2bb5bf98_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,120,57"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="363,5,522,32"/>
<area shape="rect" href="svm_8c.html#aacde987fd6ae3956ec075251296c37a0" title=" " alt="" coords="168,56,315,83"/>
<area shape="rect" href="x86_8h.html#ae123da10adfeadb5ddcdf423f0bba192" title=" " alt="" coords="363,56,523,83"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="407,107,478,133"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="375,157,511,184"/>
</map>
</div>

</div>
</div>
<a id="aa1743f35bf86caa51b20a010c228520b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1743f35bf86caa51b20a010c228520b">&#9670;&nbsp;</a></span>svm_seg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct vmcb_seg* svm_seg </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01684">1684</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;{</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="keyword">struct </span>vmcb_save_area *save = &amp;<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keyword">struct </span>vmcb_save_area *save01 = &amp;<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">switch</span> (seg) {</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_CS: <span class="keywordflow">return</span> &amp;save-&gt;cs;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_DS: <span class="keywordflow">return</span> &amp;save-&gt;ds;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_ES: <span class="keywordflow">return</span> &amp;save-&gt;es;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_FS: <span class="keywordflow">return</span> &amp;save01-&gt;fs;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_GS: <span class="keywordflow">return</span> &amp;save01-&gt;gs;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_SS: <span class="keywordflow">return</span> &amp;save-&gt;ss;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_TR: <span class="keywordflow">return</span> &amp;save01-&gt;tr;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">case</span> VCPU_SREG_LDTR: <span class="keywordflow">return</span> &amp;save01-&gt;ldtr;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    BUG();</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aa1743f35bf86caa51b20a010c228520b_cgraph.png" border="0" usemap="#asvm_8c_aa1743f35bf86caa51b20a010c228520b_cgraph" alt=""/></div>
<map name="asvm_8c_aa1743f35bf86caa51b20a010c228520b_cgraph" id="asvm_8c_aa1743f35bf86caa51b20a010c228520b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,85,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="133,5,204,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aa1743f35bf86caa51b20a010c228520b_icgraph.png" border="0" usemap="#asvm_8c_aa1743f35bf86caa51b20a010c228520b_icgraph" alt=""/></div>
<map name="asvm_8c_aa1743f35bf86caa51b20a010c228520b_icgraph" id="asvm_8c_aa1743f35bf86caa51b20a010c228520b_icgraph">
<area shape="rect" title=" " alt="" coords="445,56,525,83"/>
<area shape="rect" href="svm_8c.html#a6daa12edeead3fa3897d8e868a20c63e" title=" " alt="" coords="236,5,379,32"/>
<area shape="rect" href="svm_8c.html#afe9828b3134c1b062cee0f740a236605" title=" " alt="" coords="217,56,397,83"/>
<area shape="rect" href="svm_8c.html#a7c278e923bb07084a7b0f64312968d9e" title=" " alt="" coords="237,107,378,133"/>
<area shape="rect" href="svm_8c.html#aa993ddc604d61adf2f6b26668d37cee5" title=" " alt="" coords="5,5,169,32"/>
</map>
</div>

</div>
</div>
<a id="ab2ed2d9e233f1c6a1a3c806826d63401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2ed2d9e233f1c6a1a3c806826d63401">&#9670;&nbsp;</a></span>svm_set_cpu_caps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __init void svm_set_cpu_caps </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l05077">5077</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;{</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;    <a class="code" href="cpuid_8c.html#ac4b31e077b5a352bd48a541ad53e3162">kvm_set_cpu_caps</a>();</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160; </div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;    <a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#a6ebc5215d02fcc2f2d691280cefad7a2">supported_perf_cap</a> = 0;</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;    <a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#a6f09eefaf33e60131be48a78f993b353">supported_xss</a> = 0;</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160; </div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;    <span class="comment">/* CPUID 0x80000001 and 0x8000000A (SVM features) */</span></div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#abe2e85eb9e667809ab7e5dd3ad442b26">nested</a>) {</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_SVM);</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_VMCBCLEAN);</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160; </div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;<span class="comment">         * KVM currently flushes TLBs on *every* nested SVM transition,</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;<span class="comment">         * and so for all intents and purposes KVM supports flushing by</span></div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;<span class="comment">         * ASID, i.e. KVM is guaranteed to honor every L1 ASID flush.</span></div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_FLUSHBYASID);</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160; </div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a>)</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;            <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_NRIPS);</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160; </div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>)</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;            <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_NPT);</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160; </div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#adacf7fe5bb2bb2fdef07153a859b75ba">tsc_scaling</a>)</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;            <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_TSCRATEMSR);</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160; </div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a3ad937a1fd2ef8fcdd87953c6a5db405">vls</a>)</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;            <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_V_VMSAVE_VMLOAD);</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ac6093899c4533e4c669b24862528077d">lbrv</a>)</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;            <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_LBRV);</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160; </div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;        <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_PAUSEFILTER))</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;            <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_PAUSEFILTER);</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160; </div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;        <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_PFTHRESHOLD))</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;            <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_PFTHRESHOLD);</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160; </div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>)</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;            <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_VGIF);</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160; </div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a>)</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;            <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_VNMI);</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160; </div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;        <span class="comment">/* Nested VM can receive #VMEXIT instead of triggering #GP */</span></div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_SVME_ADDR_CHK);</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;    }</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160; </div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;    <span class="comment">/* CPUID 0x80000008 */</span></div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_LS_CFG_SSBD) ||</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;        boot_cpu_has(X86_FEATURE_AMD_SSBD))</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;        <a class="code" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a>(X86_FEATURE_VIRT_SSBD);</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160; </div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8c.html#a868c360a5f6eb018cc1d24ecd766d971">enable_pmu</a>) {</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;<span class="comment">         * Enumerate support for PERFCTR_CORE if and only if KVM has</span></div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;<span class="comment">         * access to enough counters to virtualize &quot;core&quot; support,</span></div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;<span class="comment">         * otherwise limit vPMU support to the legacy number of counters.</span></div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.num_counters_gp &lt; AMD64_NUM_COUNTERS_CORE)</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;            <a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.num_counters_gp = min(AMD64_NUM_COUNTERS,</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;                              <a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.num_counters_gp);</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;            <a class="code" href="cpuid_8h.html#a267779506f2b7e74c16d026c5e5648f8">kvm_cpu_cap_check_and_set</a>(X86_FEATURE_PERFCTR_CORE);</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160; </div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a>.version != 2 ||</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;            !<a class="code" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de">kvm_cpu_cap_has</a>(X86_FEATURE_PERFCTR_CORE))</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;            <a class="code" href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198">kvm_cpu_cap_clear</a>(X86_FEATURE_PERFMON_V2);</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;    }</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160; </div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;    <span class="comment">/* CPUID 0x8000001F (SME/SEV features) */</span></div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;    <a class="code" href="sev_8c.html#aeaff9c624af59b36fd36d1c25e279a50">sev_set_cpu_caps</a>();</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_ac4b31e077b5a352bd48a541ad53e3162"><div class="ttname"><a href="cpuid_8c.html#ac4b31e077b5a352bd48a541ad53e3162">kvm_set_cpu_caps</a></div><div class="ttdeci">void kvm_set_cpu_caps(void)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00585">cpuid.c:585</a></div></div>
<div class="ttc" id="acpuid_8h_html_a267779506f2b7e74c16d026c5e5648f8"><div class="ttname"><a href="cpuid_8h.html#a267779506f2b7e74c16d026c5e5648f8">kvm_cpu_cap_check_and_set</a></div><div class="ttdeci">static __always_inline void kvm_cpu_cap_check_and_set(unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00226">cpuid.h:226</a></div></div>
<div class="ttc" id="acpuid_8h_html_abdc65f0e23a3e84daece0c718bac6198"><div class="ttname"><a href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198">kvm_cpu_cap_clear</a></div><div class="ttdeci">static __always_inline void kvm_cpu_cap_clear(unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00197">cpuid.h:197</a></div></div>
<div class="ttc" id="acpuid_8h_html_aee66583565e70e231c1319604da3a201"><div class="ttname"><a href="cpuid_8h.html#aee66583565e70e231c1319604da3a201">kvm_cpu_cap_set</a></div><div class="ttdeci">static __always_inline void kvm_cpu_cap_set(unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00205">cpuid.h:205</a></div></div>
<div class="ttc" id="apmu_8c_html_a7cb675dbab35a9d80853027c23e33c1f"><div class="ttname"><a href="pmu_8c.html#a7cb675dbab35a9d80853027c23e33c1f">kvm_pmu_cap</a></div><div class="ttdeci">struct x86_pmu_capability __read_mostly kvm_pmu_cap</div><div class="ttdef"><b>Definition:</b> <a href="pmu_8c_source.html#l00001">pmu.c:29</a></div></div>
<div class="ttc" id="asev_8c_html_aeaff9c624af59b36fd36d1c25e279a50"><div class="ttname"><a href="sev_8c.html#aeaff9c624af59b36fd36d1c25e279a50">sev_set_cpu_caps</a></div><div class="ttdeci">void __init sev_set_cpu_caps(void)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02185">sev.c:2185</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a6ebc5215d02fcc2f2d691280cefad7a2"><div class="ttname"><a href="structkvm__caps.html#a6ebc5215d02fcc2f2d691280cefad7a2">kvm_caps::supported_perf_cap</a></div><div class="ttdeci">u64 supported_perf_cap</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00031">x86.h:31</a></div></div>
<div class="ttc" id="astructkvm__caps_html_a6f09eefaf33e60131be48a78f993b353"><div class="ttname"><a href="structkvm__caps.html#a6f09eefaf33e60131be48a78f993b353">kvm_caps::supported_xss</a></div><div class="ttdeci">u64 supported_xss</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00030">x86.h:30</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab2ed2d9e233f1c6a1a3c806826d63401_cgraph.png" border="0" usemap="#asvm_8c_ab2ed2d9e233f1c6a1a3c806826d63401_cgraph" alt=""/></div>
<map name="asvm_8c_ab2ed2d9e233f1c6a1a3c806826d63401_cgraph" id="asvm_8c_ab2ed2d9e233f1c6a1a3c806826d63401_cgraph">
<area shape="rect" title=" " alt="" coords="5,125,149,152"/>
<area shape="rect" href="cpuid_8h.html#a267779506f2b7e74c16d026c5e5648f8" title=" " alt="" coords="391,150,605,177"/>
<area shape="rect" href="cpuid_8h.html#aee66583565e70e231c1319604da3a201" title=" " alt="" coords="668,142,807,169"/>
<area shape="rect" href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198" title=" " alt="" coords="662,62,813,89"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="427,420,569,446"/>
<area shape="rect" href="cpuid_8c.html#ac4b31e077b5a352bd48a541ad53e3162" title=" " alt="" coords="197,252,343,278"/>
<area shape="rect" href="sev_8c.html#aeaff9c624af59b36fd36d1c25e279a50" title=" " alt="" coords="201,49,339,76"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="900,125,1007,152"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1085,226,1244,253"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1107,74,1222,101"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1292,100,1440,126"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="668,277,807,304"/>
<area shape="rect" href="cpuid_8c.html#a080099f5d91326fd1c8c10429df2d042" title=" " alt="" coords="411,303,585,344"/>
<area shape="rect" href="cpuid_8c.html#a230e01b33626a01b4d37e8441e995938" title=" " alt="" coords="421,369,575,396"/>
<area shape="rect" href="cpuid_8c.html#ac97e11439f61d1a659b33cba3dc32abf" title=" " alt="" coords="653,369,821,396"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="869,378,1037,405"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="882,277,1025,304"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab2ed2d9e233f1c6a1a3c806826d63401_icgraph.png" border="0" usemap="#asvm_8c_ab2ed2d9e233f1c6a1a3c806826d63401_icgraph" alt=""/></div>
<map name="asvm_8c_ab2ed2d9e233f1c6a1a3c806826d63401_icgraph" id="asvm_8c_ab2ed2d9e233f1c6a1a3c806826d63401_icgraph">
<area shape="rect" title=" " alt="" coords="215,5,359,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="a1a9474f1273be079ac4f3c1320093c3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a9474f1273be079ac4f3c1320093c3d">&#9670;&nbsp;</a></span>svm_set_cr0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_set_cr0 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>cr0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01852">1852</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;{</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    u64 hcr0 = cr0;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordtype">bool</span> old_paging = <a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160; </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="preprocessor">#ifdef CONFIG_X86_64</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer &amp; EFER_LME) {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; (cr0 &amp; X86_CR0_PG)) {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer |= EFER_LMA;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.guest_state_protected)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.efer |= EFER_LMA | EFER_LME;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; !(cr0 &amp; X86_CR0_PG)) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer &amp;= ~EFER_LMA;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.guest_state_protected)</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.efer &amp;= ~(EFER_LMA | EFER_LME);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    }</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.cr0 = cr0;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>) {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        hcr0 |= X86_CR0_PG | X86_CR0_WP;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        <span class="keywordflow">if</span> (old_paging != <a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            <a class="code" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109">svm_set_cr4</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, <a class="code" href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba">kvm_read_cr4</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>));</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    }</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="comment">     * re-enable caching here because the QEMU bios</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment">     * does not do it - this results in some delay at</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment">     * reboot</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf">kvm_check_has_quirk</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm, KVM_X86_QUIRK_CD_NW_CLEARED))</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        hcr0 &amp;= ~(X86_CR0_CD | X86_CR0_NW);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; </div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cr0 = hcr0;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment">     * SEV-ES guests must always keep the CR intercepts cleared. CR</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">     * tracking is done using the CR write traps.</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">if</span> (hcr0 == cr0) {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="comment">/* Selective CR0 write remains on.  */</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_CR0_READ);</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_CR0_WRITE);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR0_READ);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR0_WRITE);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    }</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;}</div>
<div class="ttc" id="ax86_8h_html_a716c9d1b6fc76fd454097cf39d640878"><div class="ttname"><a href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a></div><div class="ttdeci">static bool is_paging(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00198">x86.h:198</a></div></div>
<div class="ttc" id="ax86_8h_html_adf8330176a8805826ed4711a51ce93cf"><div class="ttname"><a href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf">kvm_check_has_quirk</a></div><div class="ttdeci">static bool kvm_check_has_quirk(struct kvm *kvm, u64 quirk)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00288">x86.h:288</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1a9474f1273be079ac4f3c1320093c3d_cgraph.png" border="0" usemap="#asvm_8c_a1a9474f1273be079ac4f3c1320093c3d_cgraph" alt=""/></div>
<map name="asvm_8c_a1a9474f1273be079ac4f3c1320093c3d_cgraph" id="asvm_8c_a1a9474f1273be079ac4f3c1320093c3d_cgraph">
<area shape="rect" title=" " alt="" coords="5,523,109,549"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="407,5,491,32"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="855,107,1022,133"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba" title=" " alt="" coords="171,111,286,137"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="173,755,284,781"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="159,624,298,651"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="622,573,758,600"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="177,396,281,423"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="903,579,974,605"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="157,679,300,705"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="617,5,763,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="1119,5,1264,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1335,31,1528,57"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="1119,56,1264,83"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="396,780,503,807"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="383,679,516,705"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="617,624,763,651"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="630,741,750,768"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="599,793,781,834"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="599,675,781,717"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="615,859,765,885"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="879,648,998,675"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="862,699,1015,725"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1345,641,1518,682"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1096,673,1287,700"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="348,295,551,321"/>
<area shape="rect" href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08" title=" " alt="" coords="367,371,532,397"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="611,275,769,317"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="851,259,1026,301"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1123,237,1260,264"/>
<area shape="rect" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4" title=" " alt="" coords="1115,325,1267,352"/>
<area shape="rect" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826" title=" " alt="" coords="875,376,1003,403"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="870,427,1007,453"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="865,157,1012,184"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="860,477,1017,504"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1607,376,1713,403"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="1354,300,1509,327"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1999,325,2147,352"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1792,325,1951,352"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1576,325,1744,352"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1589,275,1731,301"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1814,275,1929,301"/>
<area shape="rect" href="reverse__cpuid_8h.html#a5c0c9322094b13d5fff76b5ab593339a" title=" " alt="" coords="1128,376,1255,403"/>
<area shape="rect" href="svm_8c.html#aba80ec8e0369ea53585b03f6b783e16d" title=" " alt="" coords="617,341,763,368"/>
<area shape="rect" href="svm__onhyperv_8h.html#a9786e3a21f906e6463bb5045e59088ec" title=" " alt="" coords="603,393,777,434"/>
<area shape="rect" href="hyperv_8h.html#a130eef63d3c6a1d540994ebbb371be24" title=" " alt="" coords="829,528,1048,555"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1a9474f1273be079ac4f3c1320093c3d_icgraph.png" border="0" usemap="#asvm_8c_a1a9474f1273be079ac4f3c1320093c3d_icgraph" alt=""/></div>
<map name="asvm_8c_a1a9474f1273be079ac4f3c1320093c3d_icgraph" id="asvm_8c_a1a9474f1273be079ac4f3c1320093c3d_icgraph">
<area shape="rect" title=" " alt="" coords="1972,242,2076,269"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1813,192,1880,218"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1769,242,1924,269"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,429,1213,456"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,242,1710,269"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,171,1721,212"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,365,1716,392"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,94,719,121"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,112,1717,138"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,294,1705,335"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,298,1437,339"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,246,1440,273"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,196,1427,222"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,305,1163,332"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,305,939,332"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,145,1459,172"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,363,1445,404"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,363,1195,404"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,413,945,440"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,362,940,389"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,94,520,121"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,69,323,96"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,69,128,96"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,94,1449,121"/>
</map>
</div>

</div>
</div>
<a id="aec23ca96447aab4ff19f594a297bc109"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec23ca96447aab4ff19f594a297bc109">&#9670;&nbsp;</a></span>svm_set_cr4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_set_cr4 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>cr4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01914">1914</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;{</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> host_cr4_mce = cr4_read_shadow() &amp; X86_CR4_MCE;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> old_cr4 = vcpu-&gt;arch.cr4;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a> &amp;&amp; ((old_cr4 ^ cr4) &amp; X86_CR4_PGE))</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <a class="code" href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08">svm_flush_tlb_current</a>(vcpu);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160; </div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    vcpu-&gt;arch.cr4 = cr4;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>) {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        cr4 |= X86_CR4_PAE;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(vcpu))</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;            cr4 &amp;= ~(X86_CR4_SMEP | X86_CR4_SMAP | X86_CR4_PKE);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    cr4 |= host_cr4_mce;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cr4 = cr4;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;vmcb, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordflow">if</span> ((cr4 ^ old_cr4) &amp; (X86_CR4_OSXSAVE | X86_CR4_PKE))</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <a class="code" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea">kvm_update_cpuid_runtime</a>(vcpu);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a537512099e11c7ab0553aeae5e38d9ea"><div class="ttname"><a href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea">kvm_update_cpuid_runtime</a></div><div class="ttdeci">void kvm_update_cpuid_runtime(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00309">cpuid.c:309</a></div></div>
<div class="ttc" id="asvm_8c_html_ac9fb8e1d8461d85400d73c9438073a08"><div class="ttname"><a href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08">svm_flush_tlb_current</a></div><div class="ttdeci">static void svm_flush_tlb_current(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03911">svm.c:3911</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aec23ca96447aab4ff19f594a297bc109_cgraph.png" border="0" usemap="#asvm_8c_aec23ca96447aab4ff19f594a297bc109_cgraph" alt=""/></div>
<map name="asvm_8c_aec23ca96447aab4ff19f594a297bc109_cgraph" id="asvm_8c_aec23ca96447aab4ff19f594a297bc109_cgraph">
<area shape="rect" title=" " alt="" coords="5,495,109,521"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="217,411,301,437"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="157,280,360,307"/>
<area shape="rect" href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08" title=" " alt="" coords="176,495,341,521"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="705,561,775,588"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="191,612,327,639"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="422,393,569,420"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="901,427,1046,453"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1097,401,1291,428"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="416,209,575,250"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="653,209,827,250"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="905,187,1042,213"/>
<area shape="rect" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4" title=" " alt="" coords="897,136,1049,163"/>
<area shape="rect" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826" title=" " alt="" coords="676,275,804,301"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="657,325,823,352"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="671,5,809,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="667,376,813,403"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="661,56,819,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1369,212,1476,239"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="1117,136,1271,163"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1761,161,1909,188"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1555,161,1713,188"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1339,161,1507,188"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1351,111,1494,137"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1577,111,1691,137"/>
<area shape="rect" href="reverse__cpuid_8h.html#a5c0c9322094b13d5fff76b5ab593339a" title=" " alt="" coords="910,237,1037,264"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="901,376,1046,403"/>
<area shape="rect" href="svm_8c.html#aba80ec8e0369ea53585b03f6b783e16d" title=" " alt="" coords="422,511,569,537"/>
<area shape="rect" href="svm__onhyperv_8h.html#a9786e3a21f906e6463bb5045e59088ec" title=" " alt="" coords="408,445,583,486"/>
<area shape="rect" href="hyperv_8h.html#a130eef63d3c6a1d540994ebbb371be24" title=" " alt="" coords="631,511,849,537"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aec23ca96447aab4ff19f594a297bc109_icgraph.png" border="0" usemap="#asvm_8c_aec23ca96447aab4ff19f594a297bc109_icgraph" alt=""/></div>
<map name="asvm_8c_aec23ca96447aab4ff19f594a297bc109_icgraph" id="asvm_8c_aec23ca96447aab4ff19f594a297bc109_icgraph">
<area shape="rect" title=" " alt="" coords="2152,234,2256,261"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1809,165,1875,191"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,285,1919,311"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,222,1952,249"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="2000,259,2104,286"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,146,1673,173"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,441,1684,483"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,273,1679,299"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,226,719,253"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,390,1679,417"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,324,1668,365"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,55,1399,96"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,121,1403,147"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,171,1389,198"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,62,1144,89"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,62,939,89"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,445,1421,471"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,273,1408,315"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,273,1176,315"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,226,945,253"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,281,940,307"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,267,520,294"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,310,323,337"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,310,128,337"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,339,1412,366"/>
</map>
</div>

</div>
</div>
<a id="af4202e53ce31f4e2eb93adf37be9ec5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4202e53ce31f4e2eb93adf37be9ec5d">&#9670;&nbsp;</a></span>svm_set_dr6()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_dr6 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01993">1993</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;{</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.guest_state_protected)</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="keywordflow">if</span> (unlikely(value != vmcb-&gt;save.dr6)) {</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        vmcb-&gt;save.dr6 = value;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(vmcb, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4ac7c020c96383ecc6a3d358e1fdd99be7">VMCB_DR</a>);</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    }</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_aaf8fd5f0e57d456151c951e0f3715fc4ac7c020c96383ecc6a3d358e1fdd99be7"><div class="ttname"><a href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4ac7c020c96383ecc6a3d358e1fdd99be7">VMCB_DR</a></div><div class="ttdeci">@ VMCB_DR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00056">svm.h:56</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af4202e53ce31f4e2eb93adf37be9ec5d_cgraph.png" border="0" usemap="#asvm_8c_af4202e53ce31f4e2eb93adf37be9ec5d_cgraph" alt=""/></div>
<map name="asvm_8c_af4202e53ce31f4e2eb93adf37be9ec5d_cgraph" id="asvm_8c_af4202e53ce31f4e2eb93adf37be9ec5d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,111,32"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="159,5,295,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af4202e53ce31f4e2eb93adf37be9ec5d_icgraph.png" border="0" usemap="#asvm_8c_af4202e53ce31f4e2eb93adf37be9ec5d_icgraph" alt=""/></div>
<map name="asvm_8c_af4202e53ce31f4e2eb93adf37be9ec5d_icgraph" id="asvm_8c_af4202e53ce31f4e2eb93adf37be9ec5d_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,275,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="a862a657ea41e77d18613b33cd6599b90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a862a657ea41e77d18613b33cd6599b90">&#9670;&nbsp;</a></span>svm_set_dr7()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_dr7 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02027">2027</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;{</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.guest_state_protected)</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160; </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.dr7 = value;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4ac7c020c96383ecc6a3d358e1fdd99be7">VMCB_DR</a>);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a862a657ea41e77d18613b33cd6599b90_cgraph.png" border="0" usemap="#asvm_8c_a862a657ea41e77d18613b33cd6599b90_cgraph" alt=""/></div>
<map name="asvm_8c_a862a657ea41e77d18613b33cd6599b90_cgraph" id="asvm_8c_a862a657ea41e77d18613b33cd6599b90_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,111,57"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="191,5,262,32"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="159,56,295,83"/>
</map>
</div>

</div>
</div>
<a id="a5df90c8772700a60441f2ba19472f726"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5df90c8772700a60441f2ba19472f726">&#9670;&nbsp;</a></span>svm_set_efer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int svm_set_efer </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>efer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00296">296</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    u64 old_efer = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer = efer;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">/* Shadow paging assumes NX to be available.  */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        efer |= EFER_NX;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span> (!(efer &amp; EFER_LMA))</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            efer &amp;= ~EFER_LME;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">if</span> ((old_efer &amp; EFER_SVME) != (efer &amp; EFER_SVME)) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span> (!(efer &amp; EFER_SVME)) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <a class="code" href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11">svm_leave_nested</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a>(svm, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="comment">/* #GP intercept is still needed for vmware backdoor */</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a2ce1016cd5cbf9583cfe1ec0e64e9118">enable_vmware_backdoor</a>)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <a class="code" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a>(svm, GP_VECTOR);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">             * Free the nested guest state, unless we are in SMM.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">             * In this case we will return to the nested guest</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">             * as soon as we leave SMM.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67">is_smm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <a class="code" href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e">svm_free_nested</a>(svm);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordtype">int</span> ret = <a class="code" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d">svm_allocate_nested</a>(svm);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">if</span> (ret) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer = old_efer;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">             * Never intercept #GP for SEV guests, KVM can&#39;t</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">             * decrypt guest memory to workaround the erratum.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a275c3d046aa0623ea238016c5002acbd">svm_gp_erratum_intercept</a> &amp;&amp; !<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <a class="code" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a>(svm, GP_VECTOR);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.efer = efer | EFER_SVME;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div>
<div class="ttc" id="asmm_8h_html_aa0d6bb14bef67edc441fccd36d205a67"><div class="ttname"><a href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67">is_smm</a></div><div class="ttdeci">static bool is_smm(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="smm_8h_source.html#l00160">smm.h:160</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a690337312a648d2948b22540da6f031e"><div class="ttname"><a href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e">svm_free_nested</a></div><div class="ttdeci">void svm_free_nested(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01203">nested.c:1203</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_aaeebe6cee9f13a0540cbd9b696648a1d"><div class="ttname"><a href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d">svm_allocate_nested</a></div><div class="ttdeci">int svm_allocate_nested(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01177">nested.c:1177</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_afea614d490148481c96faf7c1b5ecb11"><div class="ttname"><a href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11">svm_leave_nested</a></div><div class="ttdeci">void svm_leave_nested(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01229">nested.c:1229</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5df90c8772700a60441f2ba19472f726_cgraph.png" border="0" usemap="#asvm_8c_a5df90c8772700a60441f2ba19472f726_cgraph" alt=""/></div>
<map name="asvm_8c_a5df90c8772700a60441f2ba19472f726_cgraph" id="asvm_8c_a5df90c8772700a60441f2ba19472f726_cgraph">
<area shape="rect" title=" " alt="" coords="5,1124,116,1151"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="633,137,807,164"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1125,239,1261,265"/>
<area shape="rect" href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67" title=" " alt="" coords="207,1428,281,1455"/>
<area shape="rect" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642" title=" " alt="" coords="631,87,809,113"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="200,1479,288,1505"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="164,1276,324,1303"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1157,1268,1228,1295"/>
<area shape="rect" href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e" title=" " alt="" coords="177,1175,311,1201"/>
<area shape="rect" href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11" title=" " alt="" coords="172,1048,316,1075"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="193,555,295,581"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="889,87,1022,113"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="1119,188,1266,215"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1133,441,1253,468"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="1101,122,1284,163"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="1102,57,1283,98"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="1117,5,1268,32"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1349,201,1468,228"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1332,64,1485,91"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="424,1479,531,1505"/>
<area shape="rect" href="svm_8c.html#aaf821ba71761474726fdfb616796a0c8" title=" " alt="" coords="388,1327,567,1353"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="393,1276,562,1303"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="641,1276,799,1303"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="876,1290,1035,1331"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="857,1239,1053,1265"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="406,1175,549,1201"/>
<area shape="rect" href="svm_8c.html#a67937d45023d92583b0bd363c73b6c2b" title=" " alt="" coords="390,1225,565,1252"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="397,1023,558,1049"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="405,1124,550,1151"/>
<area shape="rect" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53" title=" " alt="" coords="384,906,571,947"/>
<area shape="rect" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb" title=" " alt="" coords="398,972,557,999"/>
<area shape="rect" href="svm_8h.html#a711d42f525aa791008754514284a556c" title=" " alt="" coords="431,455,524,481"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="432,517,523,544"/>
<area shape="rect" href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd" title=" " alt="" coords="633,847,807,889"/>
<area shape="rect" href="irq_8c.html#a82ee83566d2724a298b67f23f481976b" title=" " alt="" coords="372,593,583,620"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="414,377,541,404"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="651,289,789,316"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="411,656,544,683"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="661,441,779,468"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="1114,315,1271,341"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="1133,720,1252,747"/>
<area shape="rect" href="lapic_8c.html#aa421165466ac455ff3fff91fb9afe7bf" title=" " alt="" coords="631,745,809,772"/>
<area shape="rect" href="irq_8c.html#a0ba50d6865653a9d307102d8f0b36630" title=" " alt="" coords="642,593,798,620"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="866,695,1045,721"/>
<area shape="rect" href="lapic_8c.html#a1bb0a1640f9f291f5c3154c6a2c40986" title=" " alt="" coords="884,863,1027,889"/>
<area shape="rect" href="lapic_8c.html#ac1c99098894f4751a556057800e906e0" title=" " alt="" coords="884,797,1027,838"/>
<area shape="rect" href="lapic_8h.html#ae7e74fde3e4fb01f561634e789b5eab4" title=" " alt="" coords="885,745,1026,772"/>
<area shape="rect" href="irq_8h.html#a68413268c1f1f354270e9a0de9c2fe44" title=" " alt="" coords="905,593,1006,620"/>
<area shape="rect" href="lapic_8c.html#a1f4df169625f9c4c2cb06f7443698af4" title=" " alt="" coords="860,543,1051,569"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="649,796,791,823"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5df90c8772700a60441f2ba19472f726_icgraph.png" border="0" usemap="#asvm_8c_a5df90c8772700a60441f2ba19472f726_icgraph" alt=""/></div>
<map name="asvm_8c_a5df90c8772700a60441f2ba19472f726_icgraph" id="asvm_8c_a5df90c8772700a60441f2ba19472f726_icgraph">
<area shape="rect" title=" " alt="" coords="2000,332,2111,359"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,241,1919,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,357,1952,384"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,241,1673,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,170,1684,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,364,1679,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,111,1679,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,293,1668,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,297,1399,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,245,1403,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,195,1389,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,304,1144,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,144,1421,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,362,1408,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,362,1176,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,93,1412,120"/>
</map>
</div>

</div>
</div>
<a id="a90fb234370a757876039727fc833a10d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90fb234370a757876039727fc833a10d">&#9670;&nbsp;</a></span>svm_set_gdt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_gdt </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct desc_ptr *&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01820">1820</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;{</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; </div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.gdtr.limit = dt-&gt;size;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.gdtr.base = dt-&gt;address ;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a1c1bbe2afa896e3b5fc2f2d850eb41b3">VMCB_DT</a>);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_aaf8fd5f0e57d456151c951e0f3715fc4a1c1bbe2afa896e3b5fc2f2d850eb41b3"><div class="ttname"><a href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a1c1bbe2afa896e3b5fc2f2d850eb41b3">VMCB_DT</a></div><div class="ttdeci">@ VMCB_DT</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00057">svm.h:57</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a90fb234370a757876039727fc833a10d_cgraph.png" border="0" usemap="#asvm_8c_a90fb234370a757876039727fc833a10d_cgraph" alt=""/></div>
<map name="asvm_8c_a90fb234370a757876039727fc833a10d_cgraph" id="asvm_8c_a90fb234370a757876039727fc833a10d_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,111,57"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="191,5,262,32"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="159,56,295,83"/>
</map>
</div>

</div>
</div>
<a id="a5c26f1ceaa6cc778d986bd33629dc539"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c26f1ceaa6cc778d986bd33629dc539">&#9670;&nbsp;</a></span>svm_set_gif()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_set_gif </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02406">2406</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;{</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="keywordflow">if</span> (value) {</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">         * If VGIF is enabled, the STGI intercept is only added to</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">         * detect the opening of the SMI/NMI window; remove it now.</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">         * Likewise, clear the VINTR intercept, we will set it</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment">         * again while processing KVM_REQ_EVENT if needed.</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>)</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_STGI);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a>(svm, INTERCEPT_VINTR))</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;            <a class="code" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403">svm_clear_vintr</a>(svm);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        <a class="code" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64">enable_gif</a>(svm);</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.smi_pending ||</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.nmi_pending ||</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;            <a class="code" href="irq_8c.html#a82ee83566d2724a298b67f23f481976b">kvm_cpu_has_injectable_intr</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) ||</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            <a class="code" href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd">kvm_apic_has_pending_init_or_sipi</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            kvm_make_request(KVM_REQ_EVENT, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <a class="code" href="svm_8h.html#a711d42f525aa791008754514284a556c">disable_gif</a>(svm);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; </div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">         * After a CLGI no interrupts should come.  But if vGIF is</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">         * in use, we still rely on the VINTR intercept (rather than</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">         * STGI) to detect an open interrupt window.</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>)</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;            <a class="code" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403">svm_clear_vintr</a>(svm);</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    }</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;}</div>
<div class="ttc" id="airq_8c_html_a82ee83566d2724a298b67f23f481976b"><div class="ttname"><a href="irq_8c.html#a82ee83566d2724a298b67f23f481976b">kvm_cpu_has_injectable_intr</a></div><div class="ttdeci">int kvm_cpu_has_injectable_intr(struct kvm_vcpu *v)</div><div class="ttdef"><b>Definition:</b> <a href="irq_8c_source.html#l00082">irq.c:82</a></div></div>
<div class="ttc" id="alapic_8h_html_a106127db5f69d94e5ea9d6d2982c23fd"><div class="ttname"><a href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd">kvm_apic_has_pending_init_or_sipi</a></div><div class="ttdeci">static bool kvm_apic_has_pending_init_or_sipi(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00231">lapic.h:231</a></div></div>
<div class="ttc" id="asvm_8h_html_a711d42f525aa791008754514284a556c"><div class="ttname"><a href="svm_8h.html#a711d42f525aa791008754514284a556c">disable_gif</a></div><div class="ttdeci">static void disable_gif(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00473">svm.h:473</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5c26f1ceaa6cc778d986bd33629dc539_cgraph.png" border="0" usemap="#asvm_8c_a5c26f1ceaa6cc778d986bd33629dc539_cgraph" alt=""/></div>
<map name="asvm_8c_a5c26f1ceaa6cc778d986bd33629dc539_cgraph" id="asvm_8c_a5c26f1ceaa6cc778d986bd33629dc539_cgraph">
<area shape="rect" title=" " alt="" coords="5,616,107,643"/>
<area shape="rect" href="svm_8h.html#a711d42f525aa791008754514284a556c" title=" " alt="" coords="213,616,307,643"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="215,565,305,592"/>
<area shape="rect" href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd" title=" " alt="" coords="173,111,347,153"/>
<area shape="rect" href="irq_8c.html#a82ee83566d2724a298b67f23f481976b" title=" " alt="" coords="155,355,365,381"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="197,667,323,693"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="433,717,572,744"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="193,768,327,795"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="443,565,562,592"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="911,565,1031,592"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="657,515,815,541"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1131,569,1249,596"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1556,562,1729,603"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1317,595,1508,621"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="912,17,1031,44"/>
<area shape="rect" href="lapic_8c.html#aa421165466ac455ff3fff91fb9afe7bf" title=" " alt="" coords="413,355,592,381"/>
<area shape="rect" href="irq_8c.html#a0ba50d6865653a9d307102d8f0b36630" title=" " alt="" coords="425,169,581,196"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="413,68,592,95"/>
<area shape="rect" href="lapic_8c.html#a1bb0a1640f9f291f5c3154c6a2c40986" title=" " alt="" coords="665,413,807,440"/>
<area shape="rect" href="lapic_8c.html#ac1c99098894f4751a556057800e906e0" title=" " alt="" coords="665,347,807,389"/>
<area shape="rect" href="lapic_8h.html#ae7e74fde3e4fb01f561634e789b5eab4" title=" " alt="" coords="665,245,807,272"/>
<area shape="rect" href="lapic_8c.html#a80d977ac48cfa76440f2961e38b23fd0" title=" " alt="" coords="1111,405,1269,432"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="899,301,1044,328"/>
<area shape="rect" href="lapic_8c.html#ab2ee275fa1bc17aa0bfde435723b8f48" title=" " alt="" coords="899,456,1043,483"/>
<area shape="rect" href="lapic_8c.html#a656567b4197d9a5af833ffd04dff7a52" title=" " alt="" coords="1338,380,1487,407"/>
<area shape="rect" href="lapic_8h.html#aa28a43e0f54449e2ec4d25e1f8ecb178" title=" " alt="" coords="1111,301,1269,328"/>
<area shape="rect" href="lapic_8c.html#a5de365e734b929b65e2d75f62cea6f7e" title=" " alt="" coords="1111,456,1269,483"/>
<area shape="rect" href="lapic_8c.html#aebc526fc8720e4db45143f8e05f85c79" title=" " alt="" coords="893,355,1049,381"/>
<area shape="rect" href="lapic_8c.html#a734e8a2b56a9a0b0d9117f20f2bb0fc1" title=" " alt="" coords="1130,355,1250,381"/>
<area shape="rect" href="lapic_8h.html#a1d8660ecbda996b11b10b179013e52d4" title=" " alt="" coords="886,247,1057,273"/>
<area shape="rect" href="irq_8h.html#a68413268c1f1f354270e9a0de9c2fe44" title=" " alt="" coords="685,195,787,221"/>
<area shape="rect" href="lapic_8c.html#a1f4df169625f9c4c2cb06f7443698af4" title=" " alt="" coords="641,296,831,323"/>
<area shape="rect" href="xen_8h.html#a54d6c533ab0ee711fc2dbf6a420fc66d" title=" " alt="" coords="649,93,823,120"/>
<area shape="rect" href="irq_8c.html#ac5a27e69dfd0e834cf2a86ee875ecf72" title=" " alt="" coords="640,144,832,171"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="903,616,1039,643"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="669,717,803,744"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="898,851,1045,877"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="880,785,1063,826"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="881,667,1062,709"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="896,733,1047,760"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1113,675,1267,701"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="432,768,573,795"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5c26f1ceaa6cc778d986bd33629dc539_icgraph.png" border="0" usemap="#asvm_8c_a5c26f1ceaa6cc778d986bd33629dc539_icgraph" alt=""/></div>
<map name="asvm_8c_a5c26f1ceaa6cc778d986bd33629dc539_icgraph" id="asvm_8c_a5c26f1ceaa6cc778d986bd33629dc539_icgraph">
<area shape="rect" title=" " alt="" coords="2179,256,2280,283"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="2000,5,2131,32"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,107,945,133"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,281,1919,308"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,597,940,624"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="2000,652,2131,679"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2010,231,2121,257"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,157,719,184"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,197,520,224"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,237,323,264"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,237,128,264"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,463,1673,489"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,274,1684,315"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,391,1679,417"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,340,1679,367"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,209,1668,250"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,535,1399,577"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,484,1403,511"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,433,1389,460"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,543,1144,569"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,543,939,569"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,215,1421,241"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,367,1408,409"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,367,1176,409"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,265,1412,292"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,169,1952,196"/>
</map>
</div>

</div>
</div>
<a id="a401dcf35e3ec2d996a00c612126ae78e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a401dcf35e3ec2d996a00c612126ae78e">&#9670;&nbsp;</a></span>svm_set_idt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_idt </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct desc_ptr *&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01803">1803</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;{</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.idtr.limit = dt-&gt;size;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.idtr.base = dt-&gt;address ;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a1c1bbe2afa896e3b5fc2f2d850eb41b3">VMCB_DT</a>);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a401dcf35e3ec2d996a00c612126ae78e_cgraph.png" border="0" usemap="#asvm_8c_a401dcf35e3ec2d996a00c612126ae78e_cgraph" alt=""/></div>
<map name="asvm_8c_a401dcf35e3ec2d996a00c612126ae78e_cgraph" id="asvm_8c_a401dcf35e3ec2d996a00c612126ae78e_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,107,57"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="187,5,258,32"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="155,56,291,83"/>
</map>
</div>

</div>
</div>
<a id="a88f50f26e46655ddf4e070bcabcc66ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88f50f26e46655ddf4e070bcabcc66ad">&#9670;&nbsp;</a></span>svm_set_interrupt_shadow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_interrupt_shadow </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00358">358</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;{</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> (mask == 0)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_state &amp;= ~SVM_INTERRUPT_SHADOW_MASK;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_state |= SVM_INTERRUPT_SHADOW_MASK;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a88f50f26e46655ddf4e070bcabcc66ad_cgraph.png" border="0" usemap="#asvm_8c_a88f50f26e46655ddf4e070bcabcc66ad_cgraph" alt=""/></div>
<map name="asvm_8c_a88f50f26e46655ddf4e070bcabcc66ad_cgraph" id="asvm_8c_a88f50f26e46655ddf4e070bcabcc66ad_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,203,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="251,5,321,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a88f50f26e46655ddf4e070bcabcc66ad_icgraph.png" border="0" usemap="#asvm_8c_a88f50f26e46655ddf4e070bcabcc66ad_icgraph" alt=""/></div>
<map name="asvm_8c_a88f50f26e46655ddf4e070bcabcc66ad_icgraph" id="asvm_8c_a88f50f26e46655ddf4e070bcabcc66ad_icgraph">
<area shape="rect" title=" " alt="" coords="729,31,927,57"/>
<area shape="rect" href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe" title=" " alt="" coords="515,23,681,65"/>
<area shape="rect" href="svm_8c.html#a879b6475034eccd7032ffd436966f341" title=" " alt="" coords="237,5,467,32"/>
<area shape="rect" href="svm_8c.html#ac18fc14fa96cb83668d789973478dbc0" title=" " alt="" coords="242,56,462,83"/>
<area shape="rect" href="svm_8c.html#a034d0058215cd4fddf9fbaa460d3faf6" title=" " alt="" coords="5,5,189,32"/>
<area shape="rect" href="svm_8c.html#a13190482bab2b529a02a5cf83309f510" title=" " alt="" coords="15,56,179,83"/>
<area shape="rect" href="svm_8c.html#aea4014f3f951e100eb2acc13cef94502" title=" " alt="" coords="39,107,156,133"/>
</map>
</div>

</div>
</div>
<a id="af4501b19af9ab262bc899adc902a5066"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4501b19af9ab262bc899adc902a5066">&#9670;&nbsp;</a></span>svm_set_iret_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_iret_intercept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02560">2560</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;{</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.kvm))</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_IRET);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af4501b19af9ab262bc899adc902a5066_cgraph.png" border="0" usemap="#asvm_8c_af4501b19af9ab262bc899adc902a5066_cgraph" alt=""/></div>
<map name="asvm_8c_af4501b19af9ab262bc899adc902a5066_cgraph" id="asvm_8c_af4501b19af9ab262bc899adc902a5066_cgraph">
<area shape="rect" title=" " alt="" coords="5,163,176,189"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="240,137,351,164"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="224,188,367,215"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="428,137,535,164"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="415,188,548,215"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="612,289,763,316"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="627,5,747,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="596,57,779,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="597,122,778,163"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="614,188,761,215"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="619,239,755,265"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="844,104,963,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="827,155,980,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1267,97,1440,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1028,129,1219,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af4501b19af9ab262bc899adc902a5066_icgraph.png" border="0" usemap="#asvm_8c_af4501b19af9ab262bc899adc902a5066_icgraph" alt=""/></div>
<map name="asvm_8c_af4501b19af9ab262bc899adc902a5066_icgraph" id="asvm_8c_af4501b19af9ab262bc899adc902a5066_icgraph">
<area shape="rect" title=" " alt="" coords="205,31,376,57"/>
<area shape="rect" href="svm_8c.html#a67bccbcbb6b439b80103663fe58cd626" title=" " alt="" coords="19,5,144,32"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="5,56,157,83"/>
</map>
</div>

</div>
</div>
<a id="aac18b9094154a2c8b8e27c3b08c9e359"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac18b9094154a2c8b8e27c3b08c9e359">&#9670;&nbsp;</a></span>svm_set_msr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_set_msr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct msr_data *&#160;</td>
          <td class="paramname"><em>msr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02973">2973</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;{</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160; </div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    u32 ecx = msr-&gt;index;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;    u64 data = msr-&gt;data;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    <span class="keywordflow">switch</span> (ecx) {</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    <span class="keywordflow">case</span> MSR_AMD64_TSC_RATIO:</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160; </div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_TSCRATEMSR)) {</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160; </div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;            <span class="keywordflow">if</span> (!msr-&gt;host_initiated)</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;<span class="comment">             * In case TSC scaling is not enabled, always</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="comment">             * leave this MSR at the default value.</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;<span class="comment">             *</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;<span class="comment">             * Due to bug in qemu 6.2.0, it would try to set</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;<span class="comment">             * this msr to 0 if tsc scaling is not enabled.</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;<span class="comment">             * Ignore this value as well.</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;            <span class="keywordflow">if</span> (data != 0 &amp;&amp; data != svm-&gt;<a class="code" href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">tsc_ratio_msr</a>)</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        }</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160; </div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        <span class="keywordflow">if</span> (data &amp; SVM_TSC_RATIO_RSVD)</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160; </div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">tsc_ratio_msr</a> = data;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160; </div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_TSCRATEMSR) &amp;&amp;</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;            <a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;            <a class="code" href="svm_2nested_8c.html#ae003d7b6aae84aa9b70d64f464e70dfc">nested_svm_update_tsc_ratio_msr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160; </div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_CR_PAT:</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        ret = <a class="code" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299">kvm_set_msr_common</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, msr);</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160; </div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.g_pat = data;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;            <a class="code" href="svm_2nested_8c.html#a5124cfade7c6ad2a6e136fdd0391f0a2">nested_vmcb02_compute_g_pat</a>(svm);</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;        <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a7c9727e792c945164c49fbd9793c4e97">VMCB_NPT</a>);</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_SPEC_CTRL:</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;        <span class="keywordflow">if</span> (!msr-&gt;host_initiated &amp;&amp;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;            !<a class="code" href="cpuid_8h.html#ad24a5bcf0ff93dc56c64e6867b8a2415">guest_has_spec_ctrl_msr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160; </div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="x86_8c.html#a005f66d3c1752a2c76df97c8e160110f">kvm_spec_ctrl_test_value</a>(data))</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160; </div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;        <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_V_SPEC_CTRL))</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.spec_ctrl = data;</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#a9a30016a1a0975a7ce12de950ec2a2cc">spec_ctrl</a> = data;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        <span class="keywordflow">if</span> (!data)</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160; </div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;<span class="comment">         * For non-nested:</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;<span class="comment">         * When it&#39;s written (to non-zero) for the first time, pass</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;<span class="comment">         * it through.</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="comment">         * For nested:</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;<span class="comment">         * The handling of the MSR bitmap for L2 guests is done in</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="comment">         * nested_svm_vmrun_msrpm.</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;<span class="comment">         * We update the L1 MSR bit as well since it will end up</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="comment">         * touching the MSR anyway now.</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_SPEC_CTRL, 1, 1);</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    <span class="keywordflow">case</span> MSR_AMD64_VIRT_SPEC_CTRL:</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        <span class="keywordflow">if</span> (!msr-&gt;host_initiated &amp;&amp;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;            !<a class="code" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_VIRT_SSBD))</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160; </div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        <span class="keywordflow">if</span> (data &amp; ~SPEC_CTRL_SSBD)</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160; </div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a78586d5e57b40fdc6d040b900300ef6d">virt_spec_ctrl</a> = data;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="keywordflow">case</span> MSR_STAR:</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.star = data;</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;<span class="preprocessor">#ifdef CONFIG_X86_64</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    <span class="keywordflow">case</span> MSR_LSTAR:</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.lstar = data;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    <span class="keywordflow">case</span> MSR_CSTAR:</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.cstar = data;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <span class="keywordflow">case</span> MSR_KERNEL_GS_BASE:</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.kernel_gs_base = data;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    <span class="keywordflow">case</span> MSR_SYSCALL_MASK:</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.sfmask = data;</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_SYSENTER_CS:</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.sysenter_cs = data;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_SYSENTER_EIP:</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.sysenter_eip = (u32)data;</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;<span class="comment">         * We only intercept the MSR_IA32_SYSENTER_{EIP|ESP} msrs</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;<span class="comment">         * when we spoof an Intel vendor ID (for cross vendor migration).</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;<span class="comment">         * In this case we use this intercept to track the high</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;<span class="comment">         * 32 bit part of these msrs to support Intel&#39;s</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;<span class="comment">         * implementation of SYSENTER/SYSEXIT.</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a80fa0b4dcbb7f9758bd7c0c29e1ed1a5">sysenter_eip_hi</a> = <a class="code" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d">guest_cpuid_is_intel</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) ? (data &gt;&gt; 32) : 0;</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_SYSENTER_ESP:</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.sysenter_esp = (u32)data;</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a747a3e237abb2217a6a93de9d17de74e">sysenter_esp_hi</a> = <a class="code" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d">guest_cpuid_is_intel</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) ? (data &gt;&gt; 32) : 0;</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    <span class="keywordflow">case</span> MSR_TSC_AUX:</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;<span class="comment">         * TSC_AUX is always virtualized for SEV-ES guests when the</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;<span class="comment">         * feature is available. The user return MSR support is not</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;<span class="comment">         * required in this case because TSC_AUX is restored on #VMEXIT</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;<span class="comment">         * from the host save area (which has been initialized in</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;<span class="comment">         * svm_hardware_enable()).</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;        <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_V_TSC_AUX) &amp;&amp; <a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160; </div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;<span class="comment">         * TSC_AUX is usually changed only during boot and never read</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="comment">         * directly.  Intercept TSC_AUX instead of exposing it to the</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;<span class="comment">         * guest via direct_access_msrs, and switch it via user return.</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;        preempt_disable();</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;        ret = <a class="code" href="x86_8c.html#af6db8fdfb7625ba5b530e59102ab2520">kvm_set_user_return_msr</a>(tsc_aux_uret_slot, data, -1ull);</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;        preempt_enable();</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160; </div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#ae25c348c7b9864253f4db3fb8a3c3e59">tsc_aux</a> = data;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    <span class="keywordflow">case</span> MSR_IA32_DEBUGCTLMSR:</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#ac6093899c4533e4c669b24862528077d">lbrv</a>) {</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;            <a class="code" href="x86_8h.html#acc780a5b6599f782ea4d46c4cd5d9d1f">kvm_pr_unimpl_wrmsr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, ecx, data);</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        }</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        <span class="keywordflow">if</span> (data &amp; <a class="code" href="svm_8h.html#acfd26afe0ecab7e00defb0b34eb0a94a">DEBUGCTL_RESERVED_BITS</a>)</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160; </div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        <a class="code" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a>(svm)-&gt;save.dbgctl = data;</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        <a class="code" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef">svm_update_lbrv</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;    <span class="keywordflow">case</span> MSR_VM_HSAVE_PA:</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;<span class="comment">         * Old kernels did not validate the value written to</span></div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;<span class="comment">         * MSR_VM_HSAVE_PA.  Allow KVM_SET_MSR to set an invalid</span></div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="comment">         * value to allow live migrating buggy or malicious guests</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;<span class="comment">         * originating from those kernels.</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;        <span class="keywordflow">if</span> (!msr-&gt;host_initiated &amp;&amp; !<a class="code" href="cpuid_8h.html#a324c2cf2152bc998a4e85165ee805f83">page_address_valid</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, data))</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160; </div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#abb9c6243e2a90048413ab9d68a450e45">hsave_msr</a> = data &amp; PAGE_MASK;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    <span class="keywordflow">case</span> MSR_VM_CR:</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#adcf271f3cd8bdb3afc435eb5f0d241bb">svm_set_vm_cr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, data);</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    <span class="keywordflow">case</span> MSR_VM_IGNNE:</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;        <a class="code" href="x86_8h.html#acc780a5b6599f782ea4d46c4cd5d9d1f">kvm_pr_unimpl_wrmsr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, ecx, data);</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    <span class="keywordflow">case</span> MSR_AMD64_DE_CFG: {</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        <span class="keyword">struct </span>kvm_msr_entry msr_entry;</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160; </div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;        msr_entry.index = msr-&gt;index;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#abed03713357a4ac6d8c5a1bf89e9ed10">svm_get_msr_feature</a>(&amp;msr_entry))</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160; </div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;        <span class="comment">/* Check the supported bits */</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;        <span class="keywordflow">if</span> (data &amp; ~msr_entry.data)</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160; </div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;        <span class="comment">/* Don&#39;t allow the guest to change a bit, #GP */</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;        <span class="keywordflow">if</span> (!msr-&gt;host_initiated &amp;&amp; (data ^ msr_entry.data))</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160; </div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#adb9edaf400032eba81ff85b2e419844a">msr_decfg</a> = data;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    }</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299">kvm_set_msr_common</a>(vcpu, msr);</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    }</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;}</div>
<div class="ttc" id="acpuid_8h_html_a324c2cf2152bc998a4e85165ee805f83"><div class="ttname"><a href="cpuid_8h.html#a324c2cf2152bc998a4e85165ee805f83">page_address_valid</a></div><div class="ttdeci">static bool page_address_valid(struct kvm_vcpu *vcpu, gpa_t gpa)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00056">cpuid.h:56</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a5124cfade7c6ad2a6e136fdd0391f0a2"><div class="ttname"><a href="svm_2nested_8c.html#a5124cfade7c6ad2a6e136fdd0391f0a2">nested_vmcb02_compute_g_pat</a></div><div class="ttdeci">void nested_vmcb02_compute_g_pat(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00528">nested.c:528</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_ae003d7b6aae84aa9b70d64f464e70dfc"><div class="ttname"><a href="svm_2nested_8c.html#ae003d7b6aae84aa9b70d64f464e70dfc">nested_svm_update_tsc_ratio_msr</a></div><div class="ttdeci">void nested_svm_update_tsc_ratio_msr(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01532">nested.c:1532</a></div></div>
<div class="ttc" id="asvm_8c_html_abed03713357a4ac6d8c5a1bf89e9ed10"><div class="ttname"><a href="svm_8c.html#abed03713357a4ac6d8c5a1bf89e9ed10">svm_get_msr_feature</a></div><div class="ttdeci">static int svm_get_msr_feature(struct kvm_msr_entry *msr)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02810">svm.c:2810</a></div></div>
<div class="ttc" id="asvm_8c_html_ad5aa214e23ea9ec9418bebbe889d41ef"><div class="ttname"><a href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef">svm_update_lbrv</a></div><div class="ttdeci">void svm_update_lbrv(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01037">svm.c:1037</a></div></div>
<div class="ttc" id="asvm_8c_html_adcf271f3cd8bdb3afc435eb5f0d241bb"><div class="ttname"><a href="svm_8c.html#adcf271f3cd8bdb3afc435eb5f0d241bb">svm_set_vm_cr</a></div><div class="ttdeci">static int svm_set_vm_cr(struct kvm_vcpu *vcpu, u64 data)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02948">svm.c:2948</a></div></div>
<div class="ttc" id="asvm_8h_html_acfd26afe0ecab7e00defb0b34eb0a94a"><div class="ttname"><a href="svm_8h.html#acfd26afe0ecab7e00defb0b34eb0a94a">DEBUGCTL_RESERVED_BITS</a></div><div class="ttdeci">#define DEBUGCTL_RESERVED_BITS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00537">svm.h:537</a></div></div>
<div class="ttc" id="ax86_8c_html_a005f66d3c1752a2c76df97c8e160110f"><div class="ttname"><a href="x86_8c.html#a005f66d3c1752a2c76df97c8e160110f">kvm_spec_ctrl_test_value</a></div><div class="ttdeci">int kvm_spec_ctrl_test_value(u64 value)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13532">x86.c:13532</a></div></div>
<div class="ttc" id="ax86_8h_html_acc780a5b6599f782ea4d46c4cd5d9d1f"><div class="ttname"><a href="x86_8h.html#acc780a5b6599f782ea4d46c4cd5d9d1f">kvm_pr_unimpl_wrmsr</a></div><div class="ttdeci">static void kvm_pr_unimpl_wrmsr(struct kvm_vcpu *vcpu, u32 msr, u64 data)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00377">x86.h:377</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aac18b9094154a2c8b8e27c3b08c9e359_cgraph.png" border="0" usemap="#asvm_8c_aac18b9094154a2c8b8e27c3b08c9e359_cgraph" alt=""/></div>
<map name="asvm_8c_aac18b9094154a2c8b8e27c3b08c9e359_cgraph" id="asvm_8c_aac18b9094154a2c8b8e27c3b08c9e359_cgraph">
<area shape="rect" title=" " alt="" coords="5,621,115,648"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="457,31,576,57"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="710,385,841,412"/>
<area shape="rect" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d" title=" " alt="" coords="181,791,335,817"/>
<area shape="rect" href="cpuid_8h.html#ad24a5bcf0ff93dc56c64e6867b8a2415" title=" " alt="" coords="165,481,351,508"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="457,81,577,108"/>
<area shape="rect" href="x86_8h.html#acc780a5b6599f782ea4d46c4cd5d9d1f" title=" " alt="" coords="431,335,602,361"/>
<area shape="rect" href="x86_8c.html#aec2b7dd73668f030b4e2f8d8815d7299" title=" " alt="" coords="171,740,345,767"/>
<area shape="rect" href="x86_8c.html#af6db8fdfb7625ba5b530e59102ab2520" title=" " alt="" coords="163,841,353,868"/>
<area shape="rect" href="x86_8c.html#a005f66d3c1752a2c76df97c8e160110f" title=" " alt="" coords="184,893,332,934"/>
<area shape="rect" href="svm_2nested_8c.html#ae003d7b6aae84aa9b70d64f464e70dfc" title=" " alt="" coords="169,285,347,326"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="481,132,552,159"/>
<area shape="rect" href="svm_2nested_8c.html#a5124cfade7c6ad2a6e136fdd0391f0a2" title=" " alt="" coords="163,958,353,999"/>
<area shape="rect" href="cpuid_8h.html#a324c2cf2152bc998a4e85165ee805f83" title=" " alt="" coords="183,1024,333,1051"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="179,1075,337,1101"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="203,1125,313,1152"/>
<area shape="rect" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8" title=" " alt="" coords="444,183,589,209"/>
<area shape="rect" href="svm_8c.html#abed03713357a4ac6d8c5a1bf89e9ed10" title=" " alt="" coords="176,1176,340,1203"/>
<area shape="rect" href="svm_8c.html#adcf271f3cd8bdb3afc435eb5f0d241bb" title=" " alt="" coords="196,183,320,209"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="191,132,325,159"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="190,1227,326,1253"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="925,23,1098,65"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="680,5,871,32"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="958,411,1065,437"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="919,360,1104,387"/>
<area shape="rect" href="kvm__emulate_8h.html#a61f034a07a99eee07bf2588db4d89494" title=" " alt="" coords="435,1684,599,1711"/>
<area shape="rect" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="434,1633,599,1660"/>
<area shape="rect" href="x86_8c.html#a630ac093595c64d6afa91d75a62743a3" title=" " alt="" coords="429,689,604,716"/>
<area shape="rect" href="cpuid_8h.html#af84298b58b36ef9fc4198f2de91c2771" title=" " alt="" coords="440,791,593,817"/>
<area shape="rect" href="cpuid_8h.html#a7d953eb2c52baf0364a2a26c6748ee94" title=" " alt="" coords="421,385,612,412"/>
<area shape="rect" href="cpuid_8h.html#a831ae844ef432e45ec7a88f170a7e1dc" title=" " alt="" coords="720,827,831,853"/>
<area shape="rect" href="async__pf_8c.html#aac6395172fbf7947412604d7e2f33417" title=" " alt="" coords="436,994,597,1035"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="433,1060,600,1087"/>
<area shape="rect" href="x86_8c.html#a37404aa00211466502dd27a08460271b" title=" " alt="" coords="695,899,855,941"/>
<area shape="rect" href="hyperv_8c.html#ab6a097fa5ccc00cb31061629a4e3e2f7" title=" " alt="" coords="418,1111,615,1137"/>
<area shape="rect" href="x86_8c.html#a55618c7cba87bb75862507a65d590c17" title=" " alt="" coords="437,1161,596,1188"/>
<area shape="rect" href="lapic_8c.html#a9c3f4680631c7f6cb33a6a5c4c001750" title=" " alt="" coords="433,1212,600,1239"/>
<area shape="rect" href="mtrr_8c.html#a2b95f238c68e317e64e57d06f2a698dd" title=" " alt="" coords="444,1263,589,1289"/>
<area shape="rect" href="x86_8h.html#a572e16f77096be80cec8ed2137ea74c2" title=" " alt="" coords="457,1313,576,1340"/>
<area shape="rect" href="pmu_8c.html#a5051f59b2585f6137d3781a4d2bd0c38" title=" " alt="" coords="429,1364,605,1391"/>
<area shape="rect" href="pmu_8c.html#a6d6bf5af13e5325bcfc07034b4d06e6c" title=" " alt="" coords="447,1415,587,1441"/>
<area shape="rect" href="pmu_8c.html#a57bb9e9b63066a1ad4b7e8096b7e7cf9" title=" " alt="" coords="443,1465,590,1492"/>
<area shape="rect" href="x86_8c.html#a56e13bff56e8184d17fdc89b142a05c3" title=" " alt="" coords="421,740,612,767"/>
<area shape="rect" href="x86_8c.html#ae62d7dbb6a6146b0fa1af42e6099b9ba" title=" " alt="" coords="431,1517,602,1558"/>
<area shape="rect" href="x86_8c.html#a9d9f2a266299bc56c932735db94816d5" title=" " alt="" coords="441,436,592,463"/>
<area shape="rect" href="lapic_8c.html#a44881cc17bdbe632a483e8c7c1dd0dfb" title=" " alt="" coords="401,1583,632,1609"/>
<area shape="rect" href="x86_8c.html#a6665e0ffd62305dcaa5e032291350190" title=" " alt="" coords="435,943,598,969"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="415,487,618,513"/>
<area shape="rect" href="x86_8c.html#ac78db676ecdcad5ee88c478439da75a9" title=" " alt="" coords="425,537,608,564"/>
<area shape="rect" href="x86_8c.html#addff58fdbcf682ae8665b64238e3adfb" title=" " alt="" coords="433,588,600,615"/>
</map>
</div>

</div>
</div>
<a id="a68ca826a04be38c12e0f0cd877d32029"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68ca826a04be38c12e0f0cd877d32029">&#9670;&nbsp;</a></span>svm_set_nmi_mask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_nmi_mask </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>masked</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03716">3716</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;{</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160; </div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">is_vnmi_enabled</a>(svm)) {</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;        <span class="keywordflow">if</span> (masked)</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl |= V_NMI_BLOCKING_MASK;</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl &amp;= ~V_NMI_BLOCKING_MASK;</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160; </div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">nmi_masked</a> = masked;</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;        <span class="keywordflow">if</span> (masked)</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;            <a class="code" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066">svm_set_iret_intercept</a>(svm);</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;            <a class="code" href="svm_8c.html#aff900c45df2faa151d783155ec034f86">svm_clr_iret_intercept</a>(svm);</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    }</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a68ca826a04be38c12e0f0cd877d32029_cgraph.png" border="0" usemap="#asvm_8c_a68ca826a04be38c12e0f0cd877d32029_cgraph" alt=""/></div>
<map name="asvm_8c_a68ca826a04be38c12e0f0cd877d32029_cgraph" id="asvm_8c_a68ca826a04be38c12e0f0cd877d32029_cgraph">
<area shape="rect" title=" " alt="" coords="5,127,157,153"/>
<area shape="rect" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d" title=" " alt="" coords="225,23,357,49"/>
<area shape="rect" href="svm_8c.html#aff900c45df2faa151d783155ec034f86" title=" " alt="" coords="207,101,374,128"/>
<area shape="rect" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066" title=" " alt="" coords="205,152,376,179"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="255,203,326,229"/>
<area shape="rect" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8" title=" " alt="" coords="615,8,760,35"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="839,5,959,32"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="440,152,551,179"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="426,101,565,128"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="634,165,741,192"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="621,115,754,141"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="826,56,973,83"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="808,225,991,266"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="809,107,990,149"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="831,173,967,200"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="824,291,975,317"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1056,89,1175,116"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1039,140,1192,167"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1479,82,1652,123"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1240,115,1431,141"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="424,203,567,229"/>
</map>
</div>

</div>
</div>
<a id="ae6289195c8ae7b64acfdb6cbe8e5342f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6289195c8ae7b64acfdb6cbe8e5342f">&#9670;&nbsp;</a></span>svm_set_rflags()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_rflags </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>rflags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01590">1590</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;{</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;nmi_singlestep)</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        rflags |= (X86_EFLAGS_TF | X86_EFLAGS_RF);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;       <span class="comment">/*</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">        * Any change of EFLAGS.VM is accompanied by a reload of SS</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">        * (caused by either a task switch or an inter-privilege IRET),</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">        * so we do not need to update the CPL here.</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rflags = rflags;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ae6289195c8ae7b64acfdb6cbe8e5342f_cgraph.png" border="0" usemap="#asvm_8c_ae6289195c8ae7b64acfdb6cbe8e5342f_cgraph" alt=""/></div>
<map name="asvm_8c_ae6289195c8ae7b64acfdb6cbe8e5342f_cgraph" id="asvm_8c_ae6289195c8ae7b64acfdb6cbe8e5342f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,125,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="173,5,244,32"/>
</map>
</div>

</div>
</div>
<a id="a7c278e923bb07084a7b0f64312968d9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c278e923bb07084a7b0f64312968d9e">&#9670;&nbsp;</a></span>svm_set_segment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_segment </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_segment *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01937">1937</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;{</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keyword">struct </span>vmcb_seg *s = <a class="code" href="svm_8c.html#aa1743f35bf86caa51b20a010c228520b">svm_seg</a>(vcpu, seg);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160; </div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    s-&gt;base = var-&gt;base;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    s-&gt;limit = var-&gt;limit;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    s-&gt;selector = var-&gt;selector;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    s-&gt;attrib = (var-&gt;type &amp; SVM_SELECTOR_TYPE_MASK);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    s-&gt;attrib |= (var-&gt;s &amp; 1) &lt;&lt; SVM_SELECTOR_S_SHIFT;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    s-&gt;attrib |= (var-&gt;dpl &amp; 3) &lt;&lt; SVM_SELECTOR_DPL_SHIFT;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    s-&gt;attrib |= ((var-&gt;present &amp; 1) &amp;&amp; !var-&gt;unusable) &lt;&lt; SVM_SELECTOR_P_SHIFT;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    s-&gt;attrib |= (var-&gt;avl &amp; 1) &lt;&lt; SVM_SELECTOR_AVL_SHIFT;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    s-&gt;attrib |= (var-&gt;l &amp; 1) &lt;&lt; SVM_SELECTOR_L_SHIFT;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    s-&gt;attrib |= (var-&gt;db &amp; 1) &lt;&lt; SVM_SELECTOR_DB_SHIFT;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    s-&gt;attrib |= (var-&gt;g &amp; 1) &lt;&lt; SVM_SELECTOR_G_SHIFT;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="comment">     * This is always accurate, except if SYSRET returned to a segment</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment">     * with SS.DPL != 3.  Intel does not have this quirk, and always</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">     * forces SS.DPL to 3 on sysret, so we ignore that case; fixing it</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment">     * would entail passing the CPL to userspace and back.</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="keywordflow">if</span> (seg == VCPU_SREG_SS)</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="comment">/* This is symmetric with svm_get_segment() */</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cpl = (var-&gt;dpl &amp; 3);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4ab13d3c949ef62a4213fe70e2ed836b91">VMCB_SEG</a>);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_aaf8fd5f0e57d456151c951e0f3715fc4ab13d3c949ef62a4213fe70e2ed836b91"><div class="ttname"><a href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4ab13d3c949ef62a4213fe70e2ed836b91">VMCB_SEG</a></div><div class="ttdeci">@ VMCB_SEG</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00058">svm.h:58</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a7c278e923bb07084a7b0f64312968d9e_cgraph.png" border="0" usemap="#asvm_8c_a7c278e923bb07084a7b0f64312968d9e_cgraph" alt=""/></div>
<map name="asvm_8c_a7c278e923bb07084a7b0f64312968d9e_cgraph" id="asvm_8c_a7c278e923bb07084a7b0f64312968d9e_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,147,83"/>
<area shape="rect" href="svm_8c.html#aa1743f35bf86caa51b20a010c228520b" title=" " alt="" coords="223,5,303,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="379,31,449,57"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="195,107,331,133"/>
</map>
</div>

</div>
</div>
<a id="a27df28527cda6f7917355af86817d940"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27df28527cda6f7917355af86817d940">&#9670;&nbsp;</a></span>svm_set_vintr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_vintr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01630">1630</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;{</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="keyword">struct </span>vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">     * The following fields are ignored when AVIC is enabled</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    WARN_ON(<a class="code" href="x86_8c.html#ade52ab1bf2b3d66def1c4851fab08c45">kvm_vcpu_apicv_activated</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>));</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160; </div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_VINTR);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment">     * Recalculating intercepts may have cleared the VINTR intercept.  If</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment">     * V_INTR_MASKING is enabled in vmcb12, then the effective RFLAGS.IF</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment">     * for L1 physical interrupts is L1&#39;s RFLAGS.IF at the time of VMRUN.</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment">     * Requesting an interrupt window if save.RFLAGS.IF=0 is pointless as</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">     * interrupts will never be unblocked while L2 is running.</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a>(svm, INTERCEPT_VINTR))</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">     * This is just a dummy VINTR to actually cause a vmexit to happen.</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment">     * Actual injection of virtual interrupts happens through EVENTINJ.</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a> = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;int_vector = 0x0;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;int_ctl &amp;= ~V_INTR_PRIO_MASK;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;int_ctl |= V_IRQ_MASK |</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        ((<span class="comment">/*control-&gt;int_vector &gt;&gt; 4*/</span> 0xf) &lt;&lt; V_INTR_PRIO_SHIFT);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a>);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;}</div>
<div class="ttc" id="ax86_8c_html_ade52ab1bf2b3d66def1c4851fab08c45"><div class="ttname"><a href="x86_8c.html#ade52ab1bf2b3d66def1c4851fab08c45">kvm_vcpu_apicv_activated</a></div><div class="ttdeci">bool kvm_vcpu_apicv_activated(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09941">x86.c:9941</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a27df28527cda6f7917355af86817d940_cgraph.png" border="0" usemap="#asvm_8c_a27df28527cda6f7917355af86817d940_cgraph" alt=""/></div>
<map name="asvm_8c_a27df28527cda6f7917355af86817d940_cgraph" id="asvm_8c_a27df28527cda6f7917355af86817d940_cgraph">
<area shape="rect" title=" " alt="" coords="5,211,120,238"/>
<area shape="rect" href="x86_8c.html#ade52ab1bf2b3d66def1c4851fab08c45" title=" " alt="" coords="168,135,367,162"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="201,186,334,213"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="196,237,339,263"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="627,315,763,342"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="415,158,556,185"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="419,209,552,235"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="620,265,771,291"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="635,147,755,174"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="604,199,787,240"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="605,31,786,72"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="622,97,769,123"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="852,13,971,39"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="835,63,988,90"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1275,5,1448,47"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1036,38,1227,65"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a27df28527cda6f7917355af86817d940_icgraph.png" border="0" usemap="#asvm_8c_a27df28527cda6f7917355af86817d940_icgraph" alt=""/></div>
<map name="asvm_8c_a27df28527cda6f7917355af86817d940_icgraph" id="asvm_8c_a27df28527cda6f7917355af86817d940_icgraph">
<area shape="rect" title=" " alt="" coords="236,5,351,32"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="5,5,188,32"/>
</map>
</div>

</div>
</div>
<a id="adcf271f3cd8bdb3afc435eb5f0d241bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcf271f3cd8bdb3afc435eb5f0d241bb">&#9670;&nbsp;</a></span>svm_set_vm_cr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_set_vm_cr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02948">2948</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;{</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;    <span class="keywordtype">int</span> svm_dis, chg_mask;</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160; </div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    <span class="keywordflow">if</span> (data &amp; ~SVM_VM_CR_VALID_MASK)</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160; </div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    chg_mask = SVM_VM_CR_VALID_MASK;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160; </div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a07d2ebcca90ff4e7e8469a1cf7f720fe">vm_cr_msr</a> &amp; SVM_VM_CR_SVM_DIS_MASK)</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        chg_mask &amp;= ~(SVM_VM_CR_SVM_LOCK_MASK | SVM_VM_CR_SVM_DIS_MASK);</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160; </div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a07d2ebcca90ff4e7e8469a1cf7f720fe">vm_cr_msr</a> &amp;= ~chg_mask;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a07d2ebcca90ff4e7e8469a1cf7f720fe">vm_cr_msr</a> |= (data &amp; chg_mask);</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160; </div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    svm_dis = svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a07d2ebcca90ff4e7e8469a1cf7f720fe">vm_cr_msr</a> &amp; SVM_VM_CR_SVM_DIS_MASK;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160; </div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <span class="comment">/* check for svm_disable while efer.svme is set */</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <span class="keywordflow">if</span> (svm_dis &amp;&amp; (<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer &amp; EFER_SVME))</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160; </div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_adcf271f3cd8bdb3afc435eb5f0d241bb_cgraph.png" border="0" usemap="#asvm_8c_adcf271f3cd8bdb3afc435eb5f0d241bb_cgraph" alt=""/></div>
<map name="asvm_8c_adcf271f3cd8bdb3afc435eb5f0d241bb_cgraph" id="asvm_8c_adcf271f3cd8bdb3afc435eb5f0d241bb_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,129,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="177,5,248,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_adcf271f3cd8bdb3afc435eb5f0d241bb_icgraph.png" border="0" usemap="#asvm_8c_adcf271f3cd8bdb3afc435eb5f0d241bb_icgraph" alt=""/></div>
<map name="asvm_8c_adcf271f3cd8bdb3afc435eb5f0d241bb_icgraph" id="asvm_8c_adcf271f3cd8bdb3afc435eb5f0d241bb_icgraph">
<area shape="rect" title=" " alt="" coords="163,5,287,32"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="5,5,115,32"/>
</map>
</div>

</div>
</div>
<a id="a1b5b579e10dbea76b1e9711f1b793975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b5b579e10dbea76b1e9711f1b793975">&#9670;&nbsp;</a></span>svm_set_vnmi_pending()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_set_vnmi_pending </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03588">3588</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;{</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160; </div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">is_vnmi_enabled</a>(svm))</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160; </div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl &amp; V_NMI_PENDING_MASK)</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160; </div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl |= V_NMI_PENDING_MASK;</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a>);</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160; </div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;<span class="comment">     * Because the pending NMI is serviced by hardware, KVM can&#39;t know when</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;<span class="comment">     * the NMI is &quot;injected&quot;, but for all intents and purposes, passing the</span></div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;<span class="comment">     * NMI off to hardware counts as injection.</span></div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    ++<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;stat.nmi_injections;</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160; </div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a1b5b579e10dbea76b1e9711f1b793975_cgraph.png" border="0" usemap="#asvm_8c_a1b5b579e10dbea76b1e9711f1b793975_cgraph" alt=""/></div>
<map name="asvm_8c_a1b5b579e10dbea76b1e9711f1b793975_cgraph" id="asvm_8c_a1b5b579e10dbea76b1e9711f1b793975_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,181,83"/>
<area shape="rect" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d" title=" " alt="" coords="231,5,363,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="262,56,333,83"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="229,107,365,133"/>
<area shape="rect" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8" title=" " alt="" coords="413,5,559,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="607,5,727,32"/>
</map>
</div>

</div>
</div>
<a id="a195738d23c6f6b6bf7269334d3a38721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a195738d23c6f6b6bf7269334d3a38721">&#9670;&nbsp;</a></span>svm_set_x2apic_msr_interception()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_set_x2apic_msr_interception </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>intercept</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00892">892</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;{</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span> (intercept == svm-&gt;<a class="code" href="structvcpu__svm.html#afbff2f35453153777bd80da134d164e0">x2avic_msrs_intercepted</a>)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="avic_8c.html#ad4c0ba70ab315cedbb11f259b1d7ae08">x2avic_enabled</a>)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">MAX_DIRECT_ACCESS_MSRS</a>; i++) {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordtype">int</span> index = <a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].<a class="code" href="structsvm__direct__access__msrs.html#a392caedc2f625128ed478904dafbe718">index</a>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="keywordflow">if</span> ((index &lt; APIC_BASE_MSR) ||</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            (index &gt; APIC_BASE_MSR + 0xff))</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, index,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                     !intercept, !intercept);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#afbff2f35453153777bd80da134d164e0">x2avic_msrs_intercepted</a> = intercept;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_afbff2f35453153777bd80da134d164e0"><div class="ttname"><a href="structvcpu__svm.html#afbff2f35453153777bd80da134d164e0">vcpu_svm::x2avic_msrs_intercepted</a></div><div class="ttdeci">bool x2avic_msrs_intercepted</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00291">svm.h:291</a></div></div>
<div class="ttc" id="asvm_8h_html_a5da6b86ca5c95c3562c7d03dcbefe138"><div class="ttname"><a href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">MAX_DIRECT_ACCESS_MSRS</a></div><div class="ttdeci">#define MAX_DIRECT_ACCESS_MSRS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00033">svm.h:33</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a195738d23c6f6b6bf7269334d3a38721_cgraph.png" border="0" usemap="#asvm_8c_a195738d23c6f6b6bf7269334d3a38721_cgraph" alt=""/></div>
<map name="asvm_8c_a195738d23c6f6b6bf7269334d3a38721_cgraph" id="asvm_8c_a195738d23c6f6b6bf7269334d3a38721_cgraph">
<area shape="rect" title=" " alt="" coords="5,187,164,229"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="212,195,371,221"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="437,137,596,178"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="419,224,615,251"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="694,5,835,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="663,57,867,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="691,123,838,149"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="729,224,800,251"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="689,173,840,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="915,224,1088,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a195738d23c6f6b6bf7269334d3a38721_icgraph.png" border="0" usemap="#asvm_8c_a195738d23c6f6b6bf7269334d3a38721_icgraph" alt=""/></div>
<map name="asvm_8c_a195738d23c6f6b6bf7269334d3a38721_icgraph" id="asvm_8c_a195738d23c6f6b6bf7269334d3a38721_icgraph">
<area shape="rect" title=" " alt="" coords="788,27,947,69"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="580,9,732,36"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="572,60,740,87"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="389,5,509,32"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="373,57,524,98"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="210,5,297,32"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="181,57,325,98"/>
</map>
</div>

</div>
</div>
<a id="a346257464a9f6d1e9ea4f27c4e8fcc61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a346257464a9f6d1e9ea4f27c4e8fcc61">&#9670;&nbsp;</a></span>svm_setup_mce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_setup_mce </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04559">4559</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;{</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;    <span class="comment">/* [63:9] are reserved. */</span></div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;    vcpu-&gt;arch.mcg_cap &amp;= 0x1ff;</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a879b6475034eccd7032ffd436966f341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a879b6475034eccd7032ffd436966f341">&#9670;&nbsp;</a></span>svm_skip_emulated_instruction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_skip_emulated_instruction </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00407">407</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe">__svm_skip_emulated_instruction</a>(vcpu, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a1f6d0a95558c52f05d9b3b97b2710cfe"><div class="ttname"><a href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe">__svm_skip_emulated_instruction</a></div><div class="ttdeci">static int __svm_skip_emulated_instruction(struct kvm_vcpu *vcpu, bool commit_side_effects)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00369">svm.c:369</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a879b6475034eccd7032ffd436966f341_cgraph.png" border="0" usemap="#asvm_8c_a879b6475034eccd7032ffd436966f341_cgraph" alt=""/></div>
<map name="asvm_8c_a879b6475034eccd7032ffd436966f341_cgraph" id="asvm_8c_a879b6475034eccd7032ffd436966f341_cgraph">
<area shape="rect" title=" " alt="" coords="5,1621,235,1648"/>
<area shape="rect" href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe" title=" " alt="" coords="283,1614,449,1655"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="502,1520,690,1547"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="1015,1571,1130,1597"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="541,1621,651,1648"/>
<area shape="rect" href="svm_8c.html#a88f50f26e46655ddf4e070bcabcc66ad" title=" " alt="" coords="497,1672,695,1699"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="799,1697,869,1724"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="743,940,925,967"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="1245,275,1379,301"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="974,1168,1171,1195"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="983,1117,1162,1144"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="996,49,1149,90"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="1011,1285,1134,1312"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="979,763,1167,789"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="1227,813,1397,840"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1687,755,1871,781"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="973,864,1172,891"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="993,1337,1153,1378"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="977,1403,1168,1429"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="992,1454,1153,1495"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="982,165,1163,192"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="1012,363,1133,389"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="987,427,1159,469"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="979,544,1166,571"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="991,915,1154,941"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="1008,965,1137,992"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="991,493,1154,520"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="1269,1251,1355,1277"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="988,1219,1157,1261"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="1002,1016,1143,1043"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1477,308,1614,335"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1705,392,1852,419"/>
<area shape="rect" href="x86_8c.html#a2a7f61481aae2e0bfe4baaba68d6d650" title=" " alt="" coords="1227,1301,1397,1328"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="1237,5,1387,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1719,1032,1839,1059"/>
<area shape="rect" href="x86_8c.html#aea69aad92f3a36aaebec0c2a9e853b61" title=" " alt="" coords="1223,697,1401,738"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1454,755,1637,781"/>
<area shape="rect" href="x86_8c.html#a8bbfd08c002f2e09b42bb56cd8f52653" title=" " alt="" coords="1231,915,1393,957"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1251,107,1373,133"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1233,158,1391,199"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1225,224,1399,251"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1227,56,1397,83"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="1223,1571,1401,1597"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="1452,1571,1639,1597"/>
<area shape="rect" href="x86_8c.html#a0a47622bf3c21272e9e0357e1f90540a" title=" " alt="" coords="1220,326,1404,367"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="1220,544,1404,571"/>
<area shape="rect" href="x86_8c.html#a2857d8949e4bb5216636d3f7b03edc88" title=" " alt="" coords="1221,443,1403,469"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="1267,981,1357,1008"/>
<area shape="rect" href="x86_8c.html#a52a62306898287a4475c0b6e78b30bf8" title=" " alt="" coords="1225,1083,1399,1125"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="781,1621,887,1648"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a879b6475034eccd7032ffd436966f341_icgraph.png" border="0" usemap="#asvm_8c_a879b6475034eccd7032ffd436966f341_icgraph" alt=""/></div>
<map name="asvm_8c_a879b6475034eccd7032ffd436966f341_icgraph" id="asvm_8c_a879b6475034eccd7032ffd436966f341_icgraph">
<area shape="rect" title=" " alt="" coords="237,5,467,32"/>
<area shape="rect" href="svm_8c.html#a034d0058215cd4fddf9fbaa460d3faf6" title=" " alt="" coords="5,5,189,32"/>
</map>
</div>

</div>
</div>
<a id="a051d09f3fa8790388364ac3f69ed3e53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a051d09f3fa8790388364ac3f69ed3e53">&#9670;&nbsp;</a></span>svm_switch_vmcb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_switch_vmcb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkvm__vmcb__info.html">kvm_vmcb_info</a> *&#160;</td>
          <td class="paramname"><em>target_vmcb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01407">1407</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;{</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a> = target_vmcb;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a> = target_vmcb-&gt;<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a051d09f3fa8790388364ac3f69ed3e53_icgraph.png" border="0" usemap="#asvm_8c_a051d09f3fa8790388364ac3f69ed3e53_icgraph" alt=""/></div>
<map name="asvm_8c_a051d09f3fa8790388364ac3f69ed3e53_icgraph" id="asvm_8c_a051d09f3fa8790388364ac3f69ed3e53_icgraph">
<area shape="rect" title=" " alt="" coords="2361,235,2504,261"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,529,945,556"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,260,1919,287"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,43,940,69"/>
<area shape="rect" href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e" title=" " alt="" coords="2174,260,2309,287"/>
<area shape="rect" href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11" title=" " alt="" coords="2169,209,2313,236"/>
<area shape="rect" href="svm_8c.html#a2af2f754ca7838a0253d54c33aae7d1e" title=" " alt="" coords="2173,631,2309,657"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,479,719,505"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,453,520,480"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,428,323,455"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,428,128,455"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,203,1673,229"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,311,1684,353"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,260,1679,287"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,377,1679,404"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,137,1668,178"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,195,1399,237"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,144,1403,171"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,93,1389,120"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,203,1144,229"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,203,939,229"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,327,1421,353"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,261,1408,302"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,261,1176,302"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,428,1412,455"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2005,260,2116,287"/>
<area shape="rect" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4" title=" " alt="" coords="2000,209,2121,236"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,420,1952,447"/>
</map>
</div>

</div>
</div>
<a id="a8e925350e4b7d486cb0b9bace97fc5f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e925350e4b7d486cb0b9bace97fc5f0">&#9670;&nbsp;</a></span>svm_sync_dirty_debug_regs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_sync_dirty_debug_regs </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02006">2006</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;{</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="keywordflow">if</span> (WARN_ON_ONCE(<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm)))</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    get_debugreg(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.db[0], 0);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    get_debugreg(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.db[1], 1);</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    get_debugreg(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.db[2], 2);</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    get_debugreg(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.db[3], 3);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">     * We cannot reset svm-&gt;vmcb-&gt;save.dr6 to DR6_ACTIVE_LOW here,</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="comment">     * because db_interception might need it.  We can do it before vmentry.</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.dr6 = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.dr6;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.dr7 = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.dr7;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.switch_db_regs &amp;= ~KVM_DEBUGREG_WONT_EXIT;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <a class="code" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf">set_dr_intercepts</a>(svm);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a8e925350e4b7d486cb0b9bace97fc5f0_cgraph.png" border="0" usemap="#asvm_8c_a8e925350e4b7d486cb0b9bace97fc5f0_cgraph" alt=""/></div>
<map name="asvm_8c_a8e925350e4b7d486cb0b9bace97fc5f0_cgraph" id="asvm_8c_a8e925350e4b7d486cb0b9bace97fc5f0_cgraph">
<area shape="rect" title=" " alt="" coords="5,315,212,341"/>
<area shape="rect" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf" title=" " alt="" coords="260,264,395,291"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="272,315,383,341"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="292,365,363,392"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="443,188,576,215"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="640,289,791,316"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="655,5,775,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="624,57,807,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="625,122,806,163"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="642,188,789,215"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="647,239,783,265"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="872,104,991,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="855,155,1008,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1295,97,1468,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1056,129,1247,156"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="456,315,563,341"/>
</map>
</div>

</div>
</div>
<a id="aa30e5cb5ad1759988fc349bd703bd4dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa30e5cb5ad1759988fc349bd703bd4dc">&#9670;&nbsp;</a></span>svm_update_cr8_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_update_cr8_intercept </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tpr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>irr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03683">3683</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;{</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160; </div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;<span class="comment">     * SEV-ES guests must always keep the CR intercepts cleared. CR</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;<span class="comment">     * tracking is done using the CR write traps.</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160; </div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a">nested_svm_virtualize_tpr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160; </div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_CR8_WRITE);</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160; </div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    <span class="keywordflow">if</span> (irr == -1)</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160; </div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    <span class="keywordflow">if</span> (tpr &gt;= irr)</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR8_WRITE);</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a0040cee9c1580bba0c7d61a63494c04a"><div class="ttname"><a href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a">nested_svm_virtualize_tpr</a></div><div class="ttdeci">static bool nested_svm_virtualize_tpr(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00569">svm.h:569</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aa30e5cb5ad1759988fc349bd703bd4dc_cgraph.png" border="0" usemap="#asvm_8c_aa30e5cb5ad1759988fc349bd703bd4dc_cgraph" alt=""/></div>
<map name="asvm_8c_aa30e5cb5ad1759988fc349bd703bd4dc_cgraph" id="asvm_8c_aa30e5cb5ad1759988fc349bd703bd4dc_cgraph">
<area shape="rect" title=" " alt="" coords="5,132,200,159"/>
<area shape="rect" href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a" title=" " alt="" coords="248,31,443,57"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="522,56,593,83"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="290,233,401,260"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="276,132,415,159"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="274,183,417,209"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="703,5,823,32"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="504,259,611,285"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="491,157,624,184"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="690,56,837,83"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="672,225,855,266"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="673,107,854,149"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="695,173,831,200"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="688,291,839,317"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="920,89,1039,116"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="903,140,1056,167"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1343,82,1516,123"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1104,115,1295,141"/>
</map>
</div>

</div>
</div>
<a id="aeb01a3f5d5204374edbbdb185d87ffcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb01a3f5d5204374edbbdb185d87ffcd">&#9670;&nbsp;</a></span>svm_update_exception_bitmap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_update_exception_bitmap </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01968">1968</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;{</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <a class="code" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a>(svm, BP_VECTOR);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;guest_debug &amp; KVM_GUESTDBG_ENABLE) {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;guest_debug &amp; KVM_GUESTDBG_USE_SW_BP)</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            <a class="code" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a>(svm, BP_VECTOR);</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    }</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aeb01a3f5d5204374edbbdb185d87ffcd_cgraph.png" border="0" usemap="#asvm_8c_aeb01a3f5d5204374edbbdb185d87ffcd_cgraph" alt=""/></div>
<map name="asvm_8c_aeb01a3f5d5204374edbbdb185d87ffcd_cgraph" id="asvm_8c_aeb01a3f5d5204374edbbdb185d87ffcd_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,179,198"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="229,113,403,140"/>
<area shape="rect" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642" title=" " alt="" coords="227,164,405,191"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="281,215,351,241"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="453,139,587,165"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="653,5,799,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="666,107,786,133"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="635,158,817,199"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="635,223,817,265"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="658,56,794,83"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="651,289,801,316"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="883,205,1001,232"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="865,256,1019,283"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1305,198,1479,239"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1067,231,1257,257"/>
</map>
</div>

</div>
</div>
<a id="ad5aa214e23ea9ec9418bebbe889d41ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5aa214e23ea9ec9418bebbe889d41ef">&#9670;&nbsp;</a></span>svm_update_lbrv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_update_lbrv </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01037">1037</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;{</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordtype">bool</span> current_enable_lbrv = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.virt_ext &amp; LBR_CTL_ENABLE_MASK;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordtype">bool</span> enable_lbrv = (<a class="code" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a>(svm)-&gt;save.dbgctl &amp; DEBUGCTLMSR_LBR) ||</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; <a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_LBRV) &amp;&amp;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a7c13a2a3665942eb4cc17fc335c4185f">virt_ext</a> &amp; LBR_CTL_ENABLE_MASK));</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span> (enable_lbrv == current_enable_lbrv)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">if</span> (enable_lbrv)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <a class="code" href="svm_8c.html#af2c512591b577cf59656808ac082a47a">svm_enable_lbrv</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <a class="code" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4">svm_disable_lbrv</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;}</div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a7c13a2a3665942eb4cc17fc335c4185f"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a7c13a2a3665942eb4cc17fc335c4185f">vmcb_ctrl_area_cached::virt_ext</a></div><div class="ttdeci">u64 virt_ext</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00148">svm.h:148</a></div></div>
<div class="ttc" id="asvm_8c_html_aaa7d57cd8b29b959a08ccd6dc53196c4"><div class="ttname"><a href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4">svm_disable_lbrv</a></div><div class="ttdeci">static void svm_disable_lbrv(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01008">svm.c:1008</a></div></div>
<div class="ttc" id="asvm_8c_html_af2c512591b577cf59656808ac082a47a"><div class="ttname"><a href="svm_8c.html#af2c512591b577cf59656808ac082a47a">svm_enable_lbrv</a></div><div class="ttdeci">static void svm_enable_lbrv(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00993">svm.c:993</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad5aa214e23ea9ec9418bebbe889d41ef_cgraph.png" border="0" usemap="#asvm_8c_ad5aa214e23ea9ec9418bebbe889d41ef_cgraph" alt=""/></div>
<map name="asvm_8c_ad5aa214e23ea9ec9418bebbe889d41ef_cgraph" id="asvm_8c_ad5aa214e23ea9ec9418bebbe889d41ef_cgraph">
<area shape="rect" title=" " alt="" coords="5,273,140,300"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="201,108,320,135"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="417,159,537,185"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="193,248,329,275"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="931,275,1001,301"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="194,299,327,325"/>
<area shape="rect" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8" title=" " alt="" coords="188,412,333,439"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="631,58,805,99"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="381,108,572,135"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="397,209,556,236"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="417,311,536,337"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="639,130,797,171"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="620,209,816,236"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="895,5,1037,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="864,57,1068,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="893,123,1039,149"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="891,173,1041,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="1116,199,1289,225"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="650,311,786,337"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad5aa214e23ea9ec9418bebbe889d41ef_icgraph.png" border="0" usemap="#asvm_8c_ad5aa214e23ea9ec9418bebbe889d41ef_icgraph" alt=""/></div>
<map name="asvm_8c_ad5aa214e23ea9ec9418bebbe889d41ef_icgraph" id="asvm_8c_ad5aa214e23ea9ec9418bebbe889d41ef_icgraph">
<area shape="rect" title=" " alt="" coords="1972,428,2107,455"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1769,241,1924,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,428,1213,455"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1792,479,1901,505"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,241,1710,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,170,1721,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,364,1716,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,111,1717,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,293,1705,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,297,1437,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,245,1440,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,195,1427,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,304,1163,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,144,1459,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,362,1445,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,362,1195,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,93,1449,120"/>
</map>
</div>

</div>
</div>
<a id="ac18fc14fa96cb83668d789973478dbc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac18fc14fa96cb83668d789973478dbc0">&#9670;&nbsp;</a></span>svm_update_soft_interrupt_rip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_update_soft_interrupt_rip </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00412">412</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;{</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> rip, old_rip = <a class="code" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446">kvm_rip_read</a>(vcpu);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">     * Due to architectural shortcomings, the CPU doesn&#39;t always provide</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">     * NextRIP, e.g. if KVM intercepted an exception that occurred while</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">     * the CPU was vectoring an INTO/INT3 in the guest.  Temporarily skip</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">     * the instruction even if NextRIP is supported to acquire the next</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">     * RIP so that it can be shoved into the NextRIP field, otherwise</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">     * hardware will fail to advance guest RIP during event injection.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">     * Drop the exception/interrupt if emulation fails and effectively</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">     * retry the instruction, it&#39;s the least awful option.  If NRIPS is</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">     * in use, the skip must not commit any side effects such as clearing</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">     * the interrupt shadow or RFLAGS.RF.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe">__svm_skip_emulated_instruction</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, !<a class="code" href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a>))</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    rip = <a class="code" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446">kvm_rip_read</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">     * Save the injection information, even when using next_rip, as the</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">     * VMCB&#39;s next_rip will be lost (cleared on VM-Exit) if the injection</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">     * doesn&#39;t complete due to a VM-Exit occurring while the CPU is</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">     * vectoring the event.   Decoding the instruction isn&#39;t guaranteed to</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">     * work as there may be no backing instruction, e.g. if the event is</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">     * being injected by L1 for L2, or if the guest is patching INT3 into</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">     * a different instruction.</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">soft_int_injected</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a7c4559533cfca9ae99de999b4c26d5fb">soft_int_csbase</a> = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cs.base;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a3a45518dab6750d2180fb4d5de532d76">soft_int_old_rip</a> = old_rip;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a47c387d2cf9e9df4331860eca2305fe6">soft_int_next_rip</a> = rip;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a>)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <a class="code" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f">kvm_rip_write</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, old_rip);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (static_cpu_has(X86_FEATURE_NRIPS))</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.next_rip = rip;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ac18fc14fa96cb83668d789973478dbc0_cgraph.png" border="0" usemap="#asvm_8c_ac18fc14fa96cb83668d789973478dbc0_cgraph" alt=""/></div>
<map name="asvm_8c_ac18fc14fa96cb83668d789973478dbc0_cgraph" id="asvm_8c_ac18fc14fa96cb83668d789973478dbc0_cgraph">
<area shape="rect" title=" " alt="" coords="5,1087,225,1113"/>
<area shape="rect" href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe" title=" " alt="" coords="273,666,440,707"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1909,1259,2020,1285"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="1006,1309,1121,1336"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="789,5,860,32"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="493,648,681,675"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="531,699,642,725"/>
<area shape="rect" href="svm_8c.html#a88f50f26e46655ddf4e070bcabcc66ad" title=" " alt="" coords="488,144,685,171"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="733,648,916,675"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="1235,1267,1370,1293"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="965,187,1162,213"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="974,136,1153,163"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="987,303,1140,345"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="1002,521,1125,548"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="969,420,1157,447"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="1218,459,1387,485"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1677,441,1861,468"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="964,572,1163,599"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="983,775,1143,817"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="968,841,1159,868"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="983,893,1144,934"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="973,959,1154,985"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="1003,1208,1124,1235"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="977,1142,1149,1183"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="970,1009,1157,1036"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="1455,627,1617,653"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="1471,863,1601,889"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="982,85,1145,112"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="1259,728,1346,755"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="979,238,1148,279"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="993,673,1134,700"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1467,1233,1605,1260"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1696,1191,1843,1217"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="2068,1259,2243,1285"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="2291,1259,2484,1285"/>
<area shape="rect" href="x86_8c.html#a2a7f61481aae2e0bfe4baaba68d6d650" title=" " alt="" coords="1217,136,1388,163"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="1227,189,1378,216"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1709,627,1829,653"/>
<area shape="rect" href="x86_8c.html#aea69aad92f3a36aaebec0c2a9e853b61" title=" " alt="" coords="1214,291,1391,333"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1445,492,1627,519"/>
<area shape="rect" href="x86_8c.html#a8bbfd08c002f2e09b42bb56cd8f52653" title=" " alt="" coords="1221,561,1384,602"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1241,829,1364,856"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1223,881,1382,922"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1215,947,1390,973"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1217,779,1388,805"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="1213,1317,1392,1344"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="1443,1317,1629,1344"/>
<area shape="rect" href="x86_8c.html#a0a47622bf3c21272e9e0357e1f90540a" title=" " alt="" coords="1211,1201,1395,1242"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="1211,997,1395,1024"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="771,699,878,725"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ac18fc14fa96cb83668d789973478dbc0_icgraph.png" border="0" usemap="#asvm_8c_ac18fc14fa96cb83668d789973478dbc0_icgraph" alt=""/></div>
<map name="asvm_8c_ac18fc14fa96cb83668d789973478dbc0_icgraph" id="asvm_8c_ac18fc14fa96cb83668d789973478dbc0_icgraph">
<area shape="rect" title=" " alt="" coords="217,31,437,57"/>
<area shape="rect" href="svm_8c.html#a13190482bab2b529a02a5cf83309f510" title=" " alt="" coords="5,5,169,32"/>
<area shape="rect" href="svm_8c.html#aea4014f3f951e100eb2acc13cef94502" title=" " alt="" coords="29,56,146,83"/>
</map>
</div>

</div>
</div>
<a id="a204e4c169e1e8029eff521725a526a57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a204e4c169e1e8029eff521725a526a57">&#9670;&nbsp;</a></span>svm_vcpu_after_set_cpuid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_vcpu_after_set_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04306">4306</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;{</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160; </div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;<span class="comment">     * SVM doesn&#39;t provide a way to disable just XSAVES in the guest, KVM</span></div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;<span class="comment">     * can only disable all variants of by disallowing CR4.OSXSAVE from</span></div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;<span class="comment">     * being set.  As a result, if the host has XSAVE and XSAVES, and the</span></div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;<span class="comment">     * guest has XSAVE enabled, the guest can execute XSAVES without</span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;<span class="comment">     * faulting.  Treat XSAVES as enabled in this case regardless of</span></div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;<span class="comment">     * whether it&#39;s advertised to the guest so that KVM context switches</span></div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;<span class="comment">     * XSS on VM-Enter/VM-Exit.  Failure to do so would effectively give</span></div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;<span class="comment">     * the guest read/write access to the host&#39;s XSS.</span></div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_XSAVE) &amp;&amp;</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;        boot_cpu_has(X86_FEATURE_XSAVES) &amp;&amp;</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;        <a class="code" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_XSAVE))</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;        <a class="code" href="cpuid_8h.html#a898d2d1ac4ac03c41e5bb2ebd1402ac0">kvm_governed_feature_set</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_XSAVES);</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160; </div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;    <a class="code" href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0">kvm_governed_feature_check_and_set</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_NRIPS);</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;    <a class="code" href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0">kvm_governed_feature_check_and_set</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_TSCRATEMSR);</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;    <a class="code" href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0">kvm_governed_feature_check_and_set</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_LBRV);</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160; </div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;<span class="comment">     * Intercept VMLOAD if the vCPU mode is Intel in order to emulate that</span></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;<span class="comment">     * VMLOAD drops bits 63:32 of SYSENTER (ignoring the fact that exposing</span></div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;<span class="comment">     * SVM on Intel is bonkers and extremely unlikely to work).</span></div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d">guest_cpuid_is_intel</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;        <a class="code" href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0">kvm_governed_feature_check_and_set</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_V_VMSAVE_VMLOAD);</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160; </div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;    <a class="code" href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0">kvm_governed_feature_check_and_set</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_PAUSEFILTER);</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;    <a class="code" href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0">kvm_governed_feature_check_and_set</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_PFTHRESHOLD);</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;    <a class="code" href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0">kvm_governed_feature_check_and_set</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_VGIF);</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;    <a class="code" href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0">kvm_governed_feature_check_and_set</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_VNMI);</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160; </div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;    <a class="code" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1">svm_recalc_instruction_intercepts</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm);</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160; </div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_IBPB))</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_PRED_CMD, 0,</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;                     !!<a class="code" href="cpuid_8h.html#a7d953eb2c52baf0364a2a26c6748ee94">guest_has_pred_cmd_msr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>));</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160; </div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_FLUSH_L1D))</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, MSR_IA32_FLUSH_CMD, 0,</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;                     !!<a class="code" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9">guest_cpuid_has</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_FLUSH_L1D));</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160; </div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;        <a class="code" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b">sev_vcpu_after_set_cpuid</a>(svm);</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160; </div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    <a class="code" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139">init_vmcb_after_set_cpuid</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;}</div>
<div class="ttc" id="acpuid_8h_html_a7d953eb2c52baf0364a2a26c6748ee94"><div class="ttname"><a href="cpuid_8h.html#a7d953eb2c52baf0364a2a26c6748ee94">guest_has_pred_cmd_msr</a></div><div class="ttdeci">static bool guest_has_pred_cmd_msr(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00179">cpuid.h:179</a></div></div>
<div class="ttc" id="acpuid_8h_html_a898d2d1ac4ac03c41e5bb2ebd1402ac0"><div class="ttname"><a href="cpuid_8h.html#a898d2d1ac4ac03c41e5bb2ebd1402ac0">kvm_governed_feature_set</a></div><div class="ttdeci">static __always_inline void kvm_governed_feature_set(struct kvm_vcpu *vcpu, unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00262">cpuid.h:262</a></div></div>
<div class="ttc" id="acpuid_8h_html_aacf5b21a9aa34f7acd0df7fa8093c4a0"><div class="ttname"><a href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0">kvm_governed_feature_check_and_set</a></div><div class="ttdeci">static __always_inline void kvm_governed_feature_check_and_set(struct kvm_vcpu *vcpu, unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00271">cpuid.h:271</a></div></div>
<div class="ttc" id="asev_8c_html_a00c492279a529b66b80ed039ae6de23b"><div class="ttname"><a href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b">sev_vcpu_after_set_cpuid</a></div><div class="ttdeci">void sev_vcpu_after_set_cpuid(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03015">sev.c:3015</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a204e4c169e1e8029eff521725a526a57_cgraph.png" border="0" usemap="#asvm_8c_a204e4c169e1e8029eff521725a526a57_cgraph" alt=""/></div>
<map name="asvm_8c_a204e4c169e1e8029eff521725a526a57_cgraph" id="asvm_8c_a204e4c169e1e8029eff521725a526a57_cgraph">
<area shape="rect" title=" " alt="" coords="5,529,157,570"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="700,699,831,725"/>
<area shape="rect" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d" title=" " alt="" coords="453,123,608,149"/>
<area shape="rect" href="cpuid_8h.html#a7d953eb2c52baf0364a2a26c6748ee94" title=" " alt="" coords="205,696,396,723"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="225,293,376,334"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="686,203,845,229"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1224,93,1295,120"/>
<area shape="rect" href="cpuid_8h.html#aacf5b21a9aa34f7acd0df7fa8093c4a0" title=" " alt="" coords="444,747,617,789"/>
<area shape="rect" href="cpuid_8h.html#a898d2d1ac4ac03c41e5bb2ebd1402ac0" title=" " alt="" coords="665,820,865,847"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="257,915,345,941"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="227,529,374,570"/>
<area shape="rect" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1" title=" " alt="" coords="215,463,387,505"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1206,851,1313,877"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="919,699,1104,725"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1661,903,1809,929"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1425,901,1584,928"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1175,749,1343,776"/>
<area shape="rect" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="1177,633,1342,674"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1188,952,1331,979"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1436,581,1573,608"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1447,952,1562,979"/>
<area shape="rect" href="kvm__emulate_8h.html#a61f034a07a99eee07bf2588db4d89494" title=" " alt="" coords="683,93,847,120"/>
<area shape="rect" href="cpuid_8h.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="683,144,848,171"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="461,325,600,352"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="459,376,602,403"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="932,195,1091,237"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="913,93,1109,120"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="1189,195,1330,221"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="1157,246,1361,287"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="1186,312,1333,339"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="1184,144,1335,171"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="1418,43,1591,69"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="699,375,832,401"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="938,261,1085,288"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="951,312,1071,339"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="920,363,1103,405"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="921,481,1102,522"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="943,429,1079,456"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="936,547,1087,573"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1200,699,1319,725"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1183,488,1336,515"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1648,789,1821,830"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1409,796,1600,823"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="695,755,836,781"/>
<area shape="rect" href="cpuid_8h.html#a865db4a5b4bd205aeed6d939d971a768" title=" " alt="" coords="942,876,1081,903"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="712,900,819,927"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="448,427,613,453"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="475,813,586,840"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="446,478,615,519"/>
</map>
</div>

</div>
</div>
<a id="aaf821ba71761474726fdfb616796a0c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf821ba71761474726fdfb616796a0c8">&#9670;&nbsp;</a></span>svm_vcpu_alloc_msrpm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u32* svm_vcpu_alloc_msrpm </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00866">866</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;{</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> order = get_order(<a class="code" href="svm_8h.html#a106125dd7b1447fe5e6cb6f08240137b">MSRPM_SIZE</a>);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keyword">struct </span>page *pages = alloc_pages(GFP_KERNEL_ACCOUNT, order);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    u32 *msrpm;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">if</span> (!pages)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    msrpm = page_address(pages);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    memset(msrpm, 0xff, PAGE_SIZE * (1 &lt;&lt; order));</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">return</span> msrpm;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a106125dd7b1447fe5e6cb6f08240137b"><div class="ttname"><a href="svm_8h.html#a106125dd7b1447fe5e6cb6f08240137b">MSRPM_SIZE</a></div><div class="ttdeci">#define MSRPM_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00031">svm.h:31</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aaf821ba71761474726fdfb616796a0c8_icgraph.png" border="0" usemap="#asvm_8c_aaf821ba71761474726fdfb616796a0c8_icgraph" alt=""/></div>
<map name="asvm_8c_aaf821ba71761474726fdfb616796a0c8_icgraph" id="asvm_8c_aaf821ba71761474726fdfb616796a0c8_icgraph">
<area shape="rect" title=" " alt="" coords="2367,357,2545,384"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="2159,332,2319,359"/>
<area shape="rect" href="svm_8c.html#a2af2f754ca7838a0253d54c33aae7d1e" title=" " alt="" coords="2171,383,2307,409"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2000,332,2111,359"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,241,1919,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,357,1952,384"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,241,1673,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,170,1684,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,364,1679,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,111,1679,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,293,1668,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,297,1399,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,245,1403,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,195,1389,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,304,1144,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,144,1421,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,362,1408,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,362,1176,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,93,1412,120"/>
</map>
</div>

</div>
</div>
<a id="a2af2f754ca7838a0253d54c33aae7d1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2af2f754ca7838a0253d54c33aae7d1e">&#9670;&nbsp;</a></span>svm_vcpu_create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_vcpu_create </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01413">1413</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;{</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keyword">struct </span>page *vmcb01_page;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keyword">struct </span>page *vmsa_page = NULL;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    BUILD_BUG_ON(offsetof(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a>, vcpu) != 0);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    err = -ENOMEM;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    vmcb01_page = alloc_page(GFP_KERNEL_ACCOUNT | __GFP_ZERO);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">if</span> (!vmcb01_page)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(vcpu-&gt;kvm)) {</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">         * SEV-ES guests require a separate VMSA page used to contain</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">         * the encrypted register state of the guest.</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        vmsa_page = alloc_page(GFP_KERNEL_ACCOUNT | __GFP_ZERO);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="keywordflow">if</span> (!vmsa_page)</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            <span class="keywordflow">goto</span> error_free_vmcb_page;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">         * SEV-ES guests maintain an encrypted version of their FPU</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">         * state which is restored and saved on VMRUN and VMEXIT.</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">         * Mark vcpu-&gt;arch.guest_fpu-&gt;fpstate as scratch so it won&#39;t</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">         * do xsave/xrstor on it.</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        fpstate_set_confidential(&amp;vcpu-&gt;arch.guest_fpu);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    err = <a class="code" href="avic_8c.html#a8e0a22138080054f4ac064064402f74a">avic_init_vcpu</a>(svm);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">if</span> (err)</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <span class="keywordflow">goto</span> error_free_vmsa_page;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a> = <a class="code" href="svm_8c.html#aaf821ba71761474726fdfb616796a0c8">svm_vcpu_alloc_msrpm</a>();</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordflow">if</span> (!svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>) {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        err = -ENOMEM;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordflow">goto</span> error_free_vmsa_page;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#afbff2f35453153777bd80da134d164e0">x2avic_msrs_intercepted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a> = page_address(vmcb01_page);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a91e376066b465faac6f37deac812bee5">pa</a> = __sme_set(page_to_pfn(vmcb01_page) &lt;&lt; PAGE_SHIFT);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <a class="code" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a>(svm, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keywordflow">if</span> (vmsa_page)</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a40070a764eb6f9ab2573d7961a0c6f8e">vmsa</a> = page_address(vmsa_page);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a4969041ad5b96825f67160eb1ae9f726">guest_state_loaded</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160; </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;error_free_vmsa_page:</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">if</span> (vmsa_page)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        __free_page(vmsa_page);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;error_free_vmcb_page:</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    __free_page(vmcb01_page);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;out:</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a8e0a22138080054f4ac064064402f74a"><div class="ttname"><a href="avic_8c.html#a8e0a22138080054f4ac064064402f74a">avic_init_vcpu</a></div><div class="ttdeci">int avic_init_vcpu(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00719">avic.c:719</a></div></div>
<div class="ttc" id="astructkvm__vmcb__info_html_a91e376066b465faac6f37deac812bee5"><div class="ttname"><a href="structkvm__vmcb__info.html#a91e376066b465faac6f37deac812bee5">kvm_vmcb_info::pa</a></div><div class="ttdeci">unsigned long pa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00111">svm.h:111</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_a40070a764eb6f9ab2573d7961a0c6f8e"><div class="ttname"><a href="structvcpu__sev__es__state.html#a40070a764eb6f9ab2573d7961a0c6f8e">vcpu_sev_es_state::vmsa</a></div><div class="ttdeci">struct sev_es_save_area * vmsa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00195">svm.h:195</a></div></div>
<div class="ttc" id="asvm_8c_html_a051d09f3fa8790388364ac3f69ed3e53"><div class="ttname"><a href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a></div><div class="ttdeci">void svm_switch_vmcb(struct vcpu_svm *svm, struct kvm_vmcb_info *target_vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01407">svm.c:1407</a></div></div>
<div class="ttc" id="asvm_8c_html_aaf821ba71761474726fdfb616796a0c8"><div class="ttname"><a href="svm_8c.html#aaf821ba71761474726fdfb616796a0c8">svm_vcpu_alloc_msrpm</a></div><div class="ttdeci">u32 * svm_vcpu_alloc_msrpm(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00866">svm.c:866</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a2af2f754ca7838a0253d54c33aae7d1e_cgraph.png" border="0" usemap="#asvm_8c_a2af2f754ca7838a0253d54c33aae7d1e_cgraph" alt=""/></div>
<map name="asvm_8c_a2af2f754ca7838a0253d54c33aae7d1e_cgraph" id="asvm_8c_a2af2f754ca7838a0253d54c33aae7d1e_cgraph">
<area shape="rect" title=" " alt="" coords="5,837,141,863"/>
<area shape="rect" href="avic_8c.html#a8e0a22138080054f4ac064064402f74a" title=" " alt="" coords="221,786,336,813"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="710,862,781,889"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="448,690,559,717"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="207,887,350,914"/>
<area shape="rect" href="svm_8c.html#aaf821ba71761474726fdfb616796a0c8" title=" " alt="" coords="189,938,368,965"/>
<area shape="rect" href="avic_8c.html#aefc63eafb35c1efd94f6d53e7d0b20d5" title=" " alt="" coords="416,786,591,813"/>
<area shape="rect" href="avic_8c.html#a8cfb06497cbd5960a4a909c44e701f06" title=" " alt="" coords="667,695,824,736"/>
<area shape="rect" href="lapic_8c.html#a8c6616d2cbae35632aa5debb15b552ec" title=" " alt="" coords="639,761,852,787"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="665,811,826,838"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="945,674,1052,701"/>
<area shape="rect" href="x86_8c.html#a0c0c5e35bc626e4140927bf15b4881f9" title=" " alt="" coords="900,729,1097,755"/>
<area shape="rect" href="kvm__main_8c.html#a5132836c5be1763ca353ca2489a7fe23" title=" " alt="" coords="947,787,1050,814"/>
<area shape="rect" href="kvm__main_8c.html#ac76f506181e49aa4800bb202e11cb2b3" title=" " alt="" coords="1151,147,1354,174"/>
<area shape="rect" href="kvm__main_8c.html#ab790fe1e5bd86339acfc80a95efddf4c" title=" " alt="" coords="1431,5,1602,47"/>
<area shape="rect" href="kvm__main_8c.html#a8f5a06af032a1edb199b4ae393b2de8e" title=" " alt="" coords="1408,71,1625,98"/>
<area shape="rect" href="guest__memfd_8c.html#abaf64b8cb9e32ccb368d1d9c49d0bb02" title=" " alt="" coords="1449,122,1584,149"/>
<area shape="rect" href="guest__memfd_8c.html#a905ecfa162a290dceb1c7d5678e2a70f" title=" " alt="" coords="2223,198,2374,225"/>
<area shape="rect" href="kvm__main_8c.html#ac81a7d714d0668ccea6d0c2ddfd0fed5" title=" " alt="" coords="1445,610,1588,637"/>
<area shape="rect" href="guest__memfd_8c.html#a2eab57d9fb8529d3751b5c8179d881c9" title=" " alt="" coords="2471,198,2625,225"/>
<area shape="rect" href="kvm__main_8c.html#a52d56a5dc447602839375289b5bbffb2" title=" " alt="" coords="1955,610,2131,637"/>
<area shape="rect" href="kvm__main_8c.html#a05eed662dd45e4e4f7485e3158d95a3b" title=" " alt="" coords="1673,303,1892,330"/>
<area shape="rect" href="kvm__main_8c.html#a8c9bd99a64bbedb0930e29ed4dcc7897" title=" " alt="" coords="1701,610,1865,637"/>
<area shape="rect" href="kvm__main_8c.html#ac4ce014a99262ed5672a102c6d2ffdbd" title=" " alt="" coords="1701,661,1865,687"/>
<area shape="rect" href="kvm__main_8c.html#aae203bcd73cff0002aeddd37bea71323" title=" " alt="" coords="1949,863,2137,890"/>
<area shape="rect" href="kvm__main_8c.html#afdb5cea8958921b2ea9bd3a29cf9d7a6" title=" " alt="" coords="1703,711,1863,738"/>
<area shape="rect" href="kvm__main_8c.html#a6dd13a049fee9663450eebbf2ac16faa" title=" " alt="" coords="1697,493,1868,535"/>
<area shape="rect" href="kvm__main_8c.html#a192569033b972982f6b53e13666ef82b" title=" " alt="" coords="1679,762,1886,789"/>
<area shape="rect" href="kvm__main_8c.html#aa89329e461345f4a586065895ca072c6" title=" " alt="" coords="2452,635,2644,662"/>
<area shape="rect" href="kvm__main_8c.html#a115855e32d0da82706ba0bf22d90d8f1" title=" " alt="" coords="2213,711,2384,738"/>
<area shape="rect" href="kvm__main_8c.html#a6178ec8efee3ce8e53d84403b2a25401" title=" " alt="" coords="2193,661,2404,687"/>
<area shape="rect" href="kvm__main_8c.html#ada893d7e7d49d1023d23653b23944572" title=" " alt="" coords="2467,711,2629,738"/>
<area shape="rect" href="x86_8c.html#af7325960c06aa482e6f168f881d83069" title=" " alt="" coords="1940,325,2145,367"/>
<area shape="rect" href="kvm__main_8c.html#aab592fb3a4d6204c86d8f99caa0986ba" title=" " alt="" coords="2200,274,2397,301"/>
<area shape="rect" href="kvm__main_8c.html#ae2d9291adcda0ba0f7a20350dabdd418" title=" " alt="" coords="1968,223,2117,250"/>
<area shape="rect" href="mmu_8c.html#a58fe7b43995ae8c20c597e1bb9c4c007" title=" " alt="" coords="2208,787,2389,828"/>
<area shape="rect" href="kvm__main_8c.html#a31dbd36d8363fc2e5979b3976ebc0dbb" title=" " alt="" coords="2203,852,2394,893"/>
<area shape="rect" href="kvm__main_8c.html#aa87d0b55e37a312b7291fa9b5c83634c" title=" " alt="" coords="2221,918,2376,945"/>
<area shape="rect" href="kvm__main_8c.html#a40ed7705420af10446677d1c99a0978e" title=" " alt="" coords="1953,442,2132,469"/>
<area shape="rect" href="x86_8c.html#a14568e065745512e03b3088070848289" title=" " alt="" coords="1940,493,2145,535"/>
<area shape="rect" href="dirty__ring_8c.html#a38d9bd671fa9181708075184e77eca3a" title=" " alt="" coords="1957,559,2128,586"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="1207,787,1298,814"/>
<area shape="rect" href="kvm__main_8c.html#a99f99281cc81d5cd69f5825ccb8793b4" title=" " alt="" coords="1145,838,1360,865"/>
<area shape="rect" href="kvm__main_8c.html#a7c20e0f654f0b4472c3833f0a563e11e" title=" " alt="" coords="1453,762,1581,789"/>
<area shape="rect" href="kvm__main_8c.html#aa77d8fc2ee9fe5965c45f1d0989eb266" title=" " alt="" coords="1439,813,1595,839"/>
<area shape="rect" href="kvm__main_8c.html#a63ec3e18db03a212e6e84391b5025689" title=" " alt="" coords="1697,943,1868,970"/>
<area shape="rect" href="kvm__main_8c.html#ab58025ccc253a102c64561fa61c2a514" title=" " alt="" coords="1967,969,2119,995"/>
<area shape="rect" href="kvm__main_8c.html#a77ec4b9140d69a05f3b4e7836cc03a96" title=" " alt="" coords="2217,969,2380,995"/>
<area shape="rect" href="kvm__main_8c.html#adfbe9f59cac426f2ff01ab4fcfd631a7" title=" " alt="" coords="1995,1019,2090,1046"/>
<area shape="rect" href="kvm__main_8c.html#a6c7165822622ebbd29159771905bd317" title=" " alt="" coords="1419,863,1615,890"/>
</map>
</div>

</div>
</div>
<a id="ac8932e9146797ddd1e75d6d8dd4afc23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8932e9146797ddd1e75d6d8dd4afc23">&#9670;&nbsp;</a></span>svm_vcpu_deliver_sipi_vector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_vcpu_deliver_sipi_vector </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04875">4875</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;{</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a7afd565914b50c480be127ae5f1bb8e5">kvm_vcpu_deliver_sipi_vector</a>(vcpu, vector);</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160; </div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;    <a class="code" href="sev_8c.html#a9809425cf0d198f1c65811a4716ceecf">sev_vcpu_deliver_sipi_vector</a>(vcpu, vector);</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a9809425cf0d198f1c65811a4716ceecf"><div class="ttname"><a href="sev_8c.html#a9809425cf0d198f1c65811a4716ceecf">sev_vcpu_deliver_sipi_vector</a></div><div class="ttdeci">void sev_vcpu_deliver_sipi_vector(struct kvm_vcpu *vcpu, u8 vector)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03159">sev.c:3159</a></div></div>
<div class="ttc" id="ax86_8c_html_a7afd565914b50c480be127ae5f1bb8e5"><div class="ttname"><a href="x86_8c.html#a7afd565914b50c480be127ae5f1bb8e5">kvm_vcpu_deliver_sipi_vector</a></div><div class="ttdeci">void kvm_vcpu_deliver_sipi_vector(struct kvm_vcpu *vcpu, u8 vector)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l12374">x86.c:12374</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ac8932e9146797ddd1e75d6d8dd4afc23_cgraph.png" border="0" usemap="#asvm_8c_ac8932e9146797ddd1e75d6d8dd4afc23_cgraph" alt=""/></div>
<map name="asvm_8c_ac8932e9146797ddd1e75d6d8dd4afc23_cgraph" id="asvm_8c_ac8932e9146797ddd1e75d6d8dd4afc23_cgraph">
<area shape="rect" title=" " alt="" coords="5,139,176,181"/>
<area shape="rect" href="x86_8c.html#a7afd565914b50c480be127ae5f1bb8e5" title=" " alt="" coords="224,59,395,101"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="254,147,365,173"/>
<area shape="rect" href="sev_8c.html#a9809425cf0d198f1c65811a4716ceecf" title=" " alt="" coords="227,198,392,239"/>
<area shape="rect" href="x86_8c.html#a50008deef9c4ea0555bf2d6294cd9813" title=" " alt="" coords="443,5,585,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="457,56,571,83"/>
<area shape="rect" href="x86_8c.html#a6818ed0db6dca9dc6dfc7b59963a0e18" title=" " alt="" coords="443,107,585,133"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="633,56,812,83"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="860,56,1047,83"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="461,157,567,184"/>
</map>
</div>

</div>
</div>
<a id="a04b96ed53c5aaf42d298205d87cd7762"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04b96ed53c5aaf42d298205d87cd7762">&#9670;&nbsp;</a></span>svm_vcpu_enter_exit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static noinstr void svm_vcpu_enter_exit </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>spec_ctrl_intercepted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04102">4102</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;{</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160; </div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    guest_state_enter_irqoff();</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160; </div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    amd_clear_divider();</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160; </div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;        <a class="code" href="svm_8h.html#aba6feca2fbeab5686eaf28f921a819f7">__svm_sev_es_vcpu_run</a>(svm, spec_ctrl_intercepted);</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;        <a class="code" href="svm_8h.html#abedd386d3abba4edb2cf133ab91c57f3">__svm_vcpu_run</a>(svm, spec_ctrl_intercepted);</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160; </div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;    guest_state_exit_irqoff();</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_aba6feca2fbeab5686eaf28f921a819f7"><div class="ttname"><a href="svm_8h.html#aba6feca2fbeab5686eaf28f921a819f7">__svm_sev_es_vcpu_run</a></div><div class="ttdeci">void __svm_sev_es_vcpu_run(struct vcpu_svm *svm, bool spec_ctrl_intercepted)</div></div>
<div class="ttc" id="asvm_8h_html_abedd386d3abba4edb2cf133ab91c57f3"><div class="ttname"><a href="svm_8h.html#abedd386d3abba4edb2cf133ab91c57f3">__svm_vcpu_run</a></div><div class="ttdeci">void __svm_vcpu_run(struct vcpu_svm *svm, bool spec_ctrl_intercepted)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a04b96ed53c5aaf42d298205d87cd7762_cgraph.png" border="0" usemap="#asvm_8c_a04b96ed53c5aaf42d298205d87cd7762_cgraph" alt=""/></div>
<map name="asvm_8c_a04b96ed53c5aaf42d298205d87cd7762_cgraph" id="asvm_8c_a04b96ed53c5aaf42d298205d87cd7762_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,167,108"/>
<area shape="rect" href="svm_8h.html#aba6feca2fbeab5686eaf28f921a819f7" title=" " alt="" coords="215,5,397,32"/>
<area shape="rect" href="svm_8h.html#abedd386d3abba4edb2cf133ab91c57f3" title=" " alt="" coords="241,56,371,83"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="251,107,361,133"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="271,157,341,184"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="445,107,552,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a04b96ed53c5aaf42d298205d87cd7762_icgraph.png" border="0" usemap="#asvm_8c_a04b96ed53c5aaf42d298205d87cd7762_icgraph" alt=""/></div>
<map name="asvm_8c_a04b96ed53c5aaf42d298205d87cd7762_icgraph" id="asvm_8c_a04b96ed53c5aaf42d298205d87cd7762_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,331,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="a394304ab136d5db4f5dad5b7c05e06e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a394304ab136d5db4f5dad5b7c05e06e4">&#9670;&nbsp;</a></span>svm_vcpu_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_vcpu_free </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01486">1486</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;{</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">     * The vmcb page can be recycled, causing a false negative in</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">     * svm_vcpu_load(). So, ensure that no logical CPU has this</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">     * vmcb page recorded as its current vmcb.</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <a class="code" href="svm_8c.html#a31c1032c7d7d9373379ac998c0a05805">svm_clear_current_vmcb</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <a class="code" href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11">svm_leave_nested</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e">svm_free_nested</a>(svm);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <a class="code" href="sev_8c.html#af343f7dd067883e0f81017a68e854c09">sev_free_vcpu</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    __free_page(pfn_to_page(__sme_clr(svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a91e376066b465faac6f37deac812bee5">pa</a>) &gt;&gt; PAGE_SHIFT));</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    __free_pages(virt_to_page(svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>), get_order(<a class="code" href="svm_8h.html#a106125dd7b1447fe5e6cb6f08240137b">MSRPM_SIZE</a>));</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_af343f7dd067883e0f81017a68e854c09"><div class="ttname"><a href="sev_8c.html#af343f7dd067883e0f81017a68e854c09">sev_free_vcpu</a></div><div class="ttdeci">void sev_free_vcpu(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02373">sev.c:2373</a></div></div>
<div class="ttc" id="asvm_8c_html_a31c1032c7d7d9373379ac998c0a05805"><div class="ttname"><a href="svm_8c.html#a31c1032c7d7d9373379ac998c0a05805">svm_clear_current_vmcb</a></div><div class="ttdeci">static void svm_clear_current_vmcb(struct vmcb *vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01478">svm.c:1478</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a394304ab136d5db4f5dad5b7c05e06e4_cgraph.png" border="0" usemap="#asvm_8c_a394304ab136d5db4f5dad5b7c05e06e4_cgraph" alt=""/></div>
<map name="asvm_8c_a394304ab136d5db4f5dad5b7c05e06e4_cgraph" id="asvm_8c_a394304ab136d5db4f5dad5b7c05e06e4_cgraph">
<area shape="rect" title=" " alt="" coords="5,196,127,223"/>
<area shape="rect" href="sev_8c.html#af343f7dd067883e0f81017a68e854c09" title=" " alt="" coords="209,81,325,108"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="470,107,541,133"/>
<area shape="rect" href="svm_8c.html#a31c1032c7d7d9373379ac998c0a05805" title=" " alt="" coords="175,309,360,336"/>
<area shape="rect" href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e" title=" " alt="" coords="200,196,335,223"/>
<area shape="rect" href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11" title=" " alt="" coords="195,259,339,285"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="651,5,761,32"/>
<area shape="rect" href="sev_8c.html#abf63e5ae3e1e3c9eb770e330ab3eef8c" title=" " alt="" coords="408,56,603,83"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="809,31,916,57"/>
<area shape="rect" href="sev_8c.html#a66cc6caa9f6331de794476e911d4ce53" title=" " alt="" coords="653,56,759,83"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="434,208,577,235"/>
<area shape="rect" href="svm_8c.html#a67937d45023d92583b0bd363c73b6c2b" title=" " alt="" coords="418,157,593,184"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="445,259,565,285"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="425,309,586,336"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="433,360,578,387"/>
<area shape="rect" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53" title=" " alt="" coords="412,411,599,453"/>
<area shape="rect" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb" title=" " alt="" coords="426,477,585,504"/>
</map>
</div>

</div>
</div>
<a id="a67937d45023d92583b0bd363c73b6c2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67937d45023d92583b0bd363c73b6c2b">&#9670;&nbsp;</a></span>svm_vcpu_free_msrpm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_vcpu_free_msrpm </td>
          <td>(</td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>msrpm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00915">915</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;{</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    __free_pages(virt_to_page(msrpm), get_order(<a class="code" href="svm_8h.html#a106125dd7b1447fe5e6cb6f08240137b">MSRPM_SIZE</a>));</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a67937d45023d92583b0bd363c73b6c2b_icgraph.png" border="0" usemap="#asvm_8c_a67937d45023d92583b0bd363c73b6c2b_icgraph" alt=""/></div>
<map name="asvm_8c_a67937d45023d92583b0bd363c73b6c2b_icgraph" id="asvm_8c_a67937d45023d92583b0bd363c73b6c2b_icgraph">
<area shape="rect" title=" " alt="" coords="2352,324,2527,351"/>
<area shape="rect" href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e" title=" " alt="" coords="2169,324,2304,351"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2005,299,2116,325"/>
<area shape="rect" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4" title=" " alt="" coords="2000,349,2121,376"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,241,1919,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,357,1952,384"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,241,1673,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,170,1684,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,364,1679,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,111,1679,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,293,1668,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,297,1399,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,245,1403,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,195,1389,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,304,1144,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,144,1421,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,362,1408,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,362,1176,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,93,1412,120"/>
</map>
</div>

</div>
</div>
<a id="aaee43a83fe8c444128a4d22b2d5d5c21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee43a83fe8c444128a4d22b2d5d5c21">&#9670;&nbsp;</a></span>svm_vcpu_init_msrpm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_vcpu_init_msrpm </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>msrpm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00881">881</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;{</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">for</span> (i = 0; <a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].<a class="code" href="structsvm__direct__access__msrs.html#a392caedc2f625128ed478904dafbe718">index</a> != <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>; i++) {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].always)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(vcpu, msrpm, <a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].index, 1, 1);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aaee43a83fe8c444128a4d22b2d5d5c21_cgraph.png" border="0" usemap="#asvm_8c_aaee43a83fe8c444128a4d22b2d5d5c21_cgraph" alt=""/></div>
<map name="asvm_8c_aaee43a83fe8c444128a4d22b2d5d5c21_cgraph" id="asvm_8c_aaee43a83fe8c444128a4d22b2d5d5c21_cgraph">
<area shape="rect" title=" " alt="" coords="5,195,175,221"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="223,195,381,221"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="448,137,607,178"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="429,224,625,251"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="705,5,846,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="673,57,877,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="702,123,849,149"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="740,224,811,251"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="700,173,851,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="925,224,1099,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_aaee43a83fe8c444128a4d22b2d5d5c21_icgraph.png" border="0" usemap="#asvm_8c_aaee43a83fe8c444128a4d22b2d5d5c21_icgraph" alt=""/></div>
<map name="asvm_8c_aaee43a83fe8c444128a4d22b2d5d5c21_icgraph" id="asvm_8c_aaee43a83fe8c444128a4d22b2d5d5c21_icgraph">
<area shape="rect" title=" " alt="" coords="2384,307,2553,333"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="2185,281,2327,308"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="2176,332,2336,359"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="2000,281,2128,308"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2009,332,2119,359"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,241,1919,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,357,1952,384"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,241,1673,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,170,1684,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,364,1679,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,111,1679,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,293,1668,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,297,1399,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,245,1403,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,195,1389,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,304,1144,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,144,1421,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,362,1408,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,362,1176,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,93,1412,120"/>
</map>
</div>

</div>
</div>
<a id="ab9e5b464a654de732fe7b0ce81145897"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9e5b464a654de732fe7b0ce81145897">&#9670;&nbsp;</a></span>svm_vcpu_load()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_vcpu_load </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cpu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01550">1550</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;{</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a> *sd = per_cpu_ptr(&amp;svm_data, cpu);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="structsvm__cpu__data.html#a5316200cc4682a70f7a1ec0cfccd9e55">current_vmcb</a> != svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>) {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        sd-&gt;<a class="code" href="structsvm__cpu__data.html#a5316200cc4682a70f7a1ec0cfccd9e55">current_vmcb</a> = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <span class="keywordflow">if</span> (!cpu_feature_enabled(X86_FEATURE_IBPB_ON_VMEXIT))</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            indirect_branch_prediction_barrier();</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(vcpu))</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <a class="code" href="avic_8c.html#a7decdbafc7d47b2241e68ce3c90a9779">avic_vcpu_load</a>(vcpu, cpu);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a7decdbafc7d47b2241e68ce3c90a9779"><div class="ttname"><a href="avic_8c.html#a7decdbafc7d47b2241e68ce3c90a9779">avic_vcpu_load</a></div><div class="ttdeci">void avic_vcpu_load(struct kvm_vcpu *vcpu, int cpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01028">avic.c:1028</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_a5316200cc4682a70f7a1ec0cfccd9e55"><div class="ttname"><a href="structsvm__cpu__data.html#a5316200cc4682a70f7a1ec0cfccd9e55">svm_cpu_data::current_vmcb</a></div><div class="ttdeci">struct vmcb * current_vmcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00306">svm.h:306</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ab9e5b464a654de732fe7b0ce81145897_cgraph.png" border="0" usemap="#asvm_8c_ab9e5b464a654de732fe7b0ce81145897_cgraph" alt=""/></div>
<map name="asvm_8c_ab9e5b464a654de732fe7b0ce81145897_cgraph" id="asvm_8c_ab9e5b464a654de732fe7b0ce81145897_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,128,149"/>
<area shape="rect" href="avic_8c.html#a7decdbafc7d47b2241e68ce3c90a9779" title=" " alt="" coords="204,71,327,98"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="698,71,769,98"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="176,173,355,199"/>
<area shape="rect" href="avic_8c.html#a7b088623e16cec4875e37d8ce15231b2" title=" " alt="" coords="403,5,595,47"/>
<area shape="rect" href="x86_8c.html#ae63567e9b665b34f8c84fc4dc594f3c8" title=" " alt="" coords="643,5,824,47"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="439,173,558,199"/>
</map>
</div>

</div>
</div>
<a id="a344cfdb20819ed5fd746bc45ed5d0b55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a344cfdb20819ed5fd746bc45ed5d0b55">&#9670;&nbsp;</a></span>svm_vcpu_pre_run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_vcpu_pre_run </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04088">4088</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;{</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af102e65fa4a28844d0bd7bbb75bd4565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af102e65fa4a28844d0bd7bbb75bd4565">&#9670;&nbsp;</a></span>svm_vcpu_put()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_vcpu_put </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01565">1565</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;{</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(vcpu))</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <a class="code" href="avic_8c.html#a461f968598a11484e76a07fb87221bf2">avic_vcpu_put</a>(vcpu);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <a class="code" href="svm_8c.html#ad72538164da58fe5a35e1753dd52d5b4">svm_prepare_host_switch</a>(vcpu);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    ++vcpu-&gt;stat.host_state_reload;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a461f968598a11484e76a07fb87221bf2"><div class="ttname"><a href="avic_8c.html#a461f968598a11484e76a07fb87221bf2">avic_vcpu_put</a></div><div class="ttdeci">void avic_vcpu_put(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01072">avic.c:1072</a></div></div>
<div class="ttc" id="asvm_8c_html_ad72538164da58fe5a35e1753dd52d5b4"><div class="ttname"><a href="svm_8c.html#ad72538164da58fe5a35e1753dd52d5b4">svm_prepare_host_switch</a></div><div class="ttdeci">static void svm_prepare_host_switch(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01545">svm.c:1545</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_af102e65fa4a28844d0bd7bbb75bd4565_cgraph.png" border="0" usemap="#asvm_8c_af102e65fa4a28844d0bd7bbb75bd4565_cgraph" alt=""/></div>
<map name="asvm_8c_af102e65fa4a28844d0bd7bbb75bd4565_cgraph" id="asvm_8c_af102e65fa4a28844d0bd7bbb75bd4565_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,121,149"/>
<area shape="rect" href="avic_8c.html#a461f968598a11484e76a07fb87221bf2" title=" " alt="" coords="201,71,316,98"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="169,122,348,149"/>
<area shape="rect" href="svm_8c.html#ad72538164da58fe5a35e1753dd52d5b4" title=" " alt="" coords="397,173,587,199"/>
<area shape="rect" href="avic_8c.html#a7b088623e16cec4875e37d8ce15231b2" title=" " alt="" coords="396,5,588,47"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="691,71,762,98"/>
<area shape="rect" href="x86_8c.html#ae63567e9b665b34f8c84fc4dc594f3c8" title=" " alt="" coords="636,5,817,47"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="433,122,551,149"/>
</map>
</div>

</div>
</div>
<a id="a72a80d54451776cc2794da8564a424fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72a80d54451776cc2794da8564a424fa">&#9670;&nbsp;</a></span>svm_vcpu_reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_vcpu_reset </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>init_event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01394">1394</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;{</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a9a30016a1a0975a7ce12de950ec2a2cc">spec_ctrl</a> = 0;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a78586d5e57b40fdc6d040b900300ef6d">virt_spec_ctrl</a> = 0;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <a class="code" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181">init_vmcb</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">if</span> (!init_event)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        <a class="code" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc">__svm_vcpu_reset</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a6bd9f9c3ade9fe75356f04bdf58433cc"><div class="ttname"><a href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc">__svm_vcpu_reset</a></div><div class="ttdeci">static void __svm_vcpu_reset(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01377">svm.c:1377</a></div></div>
<div class="ttc" id="asvm_8c_html_aa3d3185c3eece1cf1e99fd5da3ca3181"><div class="ttname"><a href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181">init_vmcb</a></div><div class="ttdeci">static void init_vmcb(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01227">svm.c:1227</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a72a80d54451776cc2794da8564a424fa_cgraph.png" border="0" usemap="#asvm_8c_a72a80d54451776cc2794da8564a424fa_cgraph" alt=""/></div>
<map name="asvm_8c_a72a80d54451776cc2794da8564a424fa_cgraph" id="asvm_8c_a72a80d54451776cc2794da8564a424fa_cgraph">
<area shape="rect" title=" " alt="" coords="5,200,133,226"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="334,112,477,138"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1440,448,1511,474"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="181,945,268,972"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="573,326,684,353"/>
<area shape="rect" href="sev_8c.html#aa924db70d759d98124ad13172de1f0c5" title=" " alt="" coords="556,48,701,74"/>
<area shape="rect" href="svm_8c.html#a7f710210623f08aa3f8ba9efdd0746b1" title=" " alt="" coords="569,98,688,125"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="544,149,713,176"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="799,338,905,365"/>
<area shape="rect" href="sev_8c.html#a791cdac9e53d50f78c0943d78462f16e" title=" " alt="" coords="796,48,908,74"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="989,448,1148,474"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="1215,411,1373,452"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="1196,477,1392,504"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="345,529,465,556"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="765,912,939,938"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="360,996,451,1022"/>
<area shape="rect" href="svm_8c.html#a2c67b65be7f511419da6e7d00fa6a544" title=" " alt="" coords="369,1286,442,1313"/>
<area shape="rect" href="svm_8c.html#a449783a93b602b1f32967c74581c38cf" title=" " alt="" coords="354,1337,457,1364"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="553,752,704,794"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="783,861,921,888"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="781,1114,923,1141"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="337,1388,474,1414"/>
<area shape="rect" href="x86_8h.html#a8a31c0c01a5fe5dc33f7c5675ba4d376" title=" " alt="" coords="325,1438,486,1465"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="326,1489,485,1516"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="316,1540,495,1566"/>
<area shape="rect" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf" title=" " alt="" coords="785,1317,919,1344"/>
<area shape="rect" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642" title=" " alt="" coords="763,1266,941,1293"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="585,377,673,404"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="347,869,463,896"/>
<area shape="rect" href="svm__onhyperv_8h.html#a5d03a25e2e39d0a1d3b4420ebdf8bb37" title=" " alt="" coords="333,478,477,505"/>
<area shape="rect" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1" title=" " alt="" coords="543,1123,715,1164"/>
<area shape="rect" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb" title=" " alt="" coords="326,580,485,606"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="553,478,705,505"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="545,580,713,606"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="548,529,709,556"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="781,389,923,416"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="773,440,931,482"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1234,846,1354,873"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="773,506,931,533"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="1002,962,1135,989"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="1221,933,1367,960"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="1203,995,1385,1036"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="1219,1082,1369,1109"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="1009,810,1128,837"/>
<area shape="rect" href="cpuid_8h.html#aa35dee13971a1366be933e974552a02d" title=" " alt="" coords="775,810,929,837"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="569,1540,688,1566"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="1002,1013,1135,1040"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="559,970,698,997"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="787,1165,917,1192"/>
<area shape="rect" href="cpuid_8h.html#a4a2881bd1ba1c3c4b2fb5f3b13ac12de" title=" " alt="" coords="781,1216,923,1242"/>
</map>
</div>

</div>
</div>
<a id="a5d2703bd914c4ae4fcb1eb83c208b085"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d2703bd914c4ae4fcb1eb83c208b085">&#9670;&nbsp;</a></span>svm_vcpu_run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __no_kcsan fastpath_t svm_vcpu_run </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04118">4118</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;{</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;    <span class="keywordtype">bool</span> spec_ctrl_intercepted = <a class="code" href="svm_8c.html#a9dbf1138872247b45ebbc4880523c0dd">msr_write_intercepted</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, MSR_IA32_SPEC_CTRL);</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160; </div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;    trace_kvm_entry(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160; </div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rax = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.regs[VCPU_REGS_RAX];</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rsp = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.regs[VCPU_REGS_RSP];</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rip = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.regs[VCPU_REGS_RIP];</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160; </div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;<span class="comment">     * Disable singlestep if we&#39;re injecting an interrupt/exception.</span></div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;<span class="comment">     * We don&#39;t want our modified rflags to be pushed on the stack where</span></div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;<span class="comment">     * we might not be able to easily reset them if we disabled NMI</span></div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;<span class="comment">     * singlestep later.</span></div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">nmi_singlestep</a> &amp;&amp; svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.event_inj) {</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;<span class="comment">         * Event injection happens before external interrupts cause a</span></div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;<span class="comment">         * vmexit and interrupts are disabled here, so smp_send_reschedule</span></div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;<span class="comment">         * is enough to force an immediate vmexit.</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;        <a class="code" href="svm_8c.html#a7ff4c846a46f6bb2e429d79bbc18f052">disable_nmi_singlestep</a>(svm);</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;        smp_send_reschedule(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;cpu);</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;    }</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160; </div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;    <a class="code" href="svm_8c.html#a1337a20b038f182d9e04102e22c45f79">pre_svm_run</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160; </div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;    <a class="code" href="svm_8c.html#ac7f791888ec3548c8fa076367bbc84d9">sync_lapic_to_cr8</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160; </div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;    <span class="keywordflow">if</span> (unlikely(svm-&gt;<a class="code" href="structvcpu__svm.html#a7c494fa07f9ddd95637bb1061808402e">asid</a> != svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.asid)) {</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.asid = svm-&gt;<a class="code" href="structvcpu__svm.html#a7c494fa07f9ddd95637bb1061808402e">asid</a>;</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;        <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4ace538c75028034c3e121fd96a0bdaf64">VMCB_ASID</a>);</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    }</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cr2 = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.cr2;</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160; </div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;    <a class="code" href="svm__onhyperv_8h.html#ad0874023d06644e3a4d157d4a4082eda">svm_hv_update_vp_id</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160; </div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;<span class="comment">     * Run with all-zero DR6 unless needed, so that we can get the exact cause</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;<span class="comment">     * of a #DB.</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    <span class="keywordflow">if</span> (unlikely(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.switch_db_regs &amp; KVM_DEBUGREG_WONT_EXIT))</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;        <a class="code" href="svm_8c.html#af4202e53ce31f4e2eb93adf37be9ec5d">svm_set_dr6</a>(svm, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.dr6);</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;        <a class="code" href="svm_8c.html#af4202e53ce31f4e2eb93adf37be9ec5d">svm_set_dr6</a>(svm, DR6_ACTIVE_LOW);</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160; </div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    <a class="code" href="svm__ops_8h.html#a8d0a3ba898bb1fad86d53f334336e9bd">clgi</a>();</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;    <a class="code" href="x86_8c.html#aed9e7eaa275b4dc9692bbbfea052ca53">kvm_load_guest_xsave_state</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160; </div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    <a class="code" href="lapic_8c.html#a94273a31a16c3d074d5722f22474bcbb">kvm_wait_lapic_expire</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160; </div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;<span class="comment">     * If this vCPU has touched SPEC_CTRL, restore the guest&#39;s value if</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="comment">     * it&#39;s non-zero. Since vmentry is serialising on affected CPUs, there</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="comment">     * is no need to worry about the conditional branch over the wrmsr</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;<span class="comment">     * being speculatively taken.</span></div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;    <span class="keywordflow">if</span> (!static_cpu_has(X86_FEATURE_V_SPEC_CTRL))</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;        x86_spec_ctrl_set_guest(svm-&gt;<a class="code" href="structvcpu__svm.html#a78586d5e57b40fdc6d040b900300ef6d">virt_spec_ctrl</a>);</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160; </div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;    <a class="code" href="svm_8c.html#a04b96ed53c5aaf42d298205d87cd7762">svm_vcpu_enter_exit</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, spec_ctrl_intercepted);</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160; </div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;    <span class="keywordflow">if</span> (!static_cpu_has(X86_FEATURE_V_SPEC_CTRL))</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;        x86_spec_ctrl_restore_host(svm-&gt;<a class="code" href="structvcpu__svm.html#a78586d5e57b40fdc6d040b900300ef6d">virt_spec_ctrl</a>);</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160; </div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm)) {</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;        <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.cr2 = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cr2;</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;        <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.regs[VCPU_REGS_RAX] = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rax;</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;        <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.regs[VCPU_REGS_RSP] = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rsp;</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;        <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.regs[VCPU_REGS_RIP] = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rip;</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    }</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.regs_dirty = 0;</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160; </div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;    <span class="keywordflow">if</span> (unlikely(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code == SVM_EXIT_NMI))</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;        <a class="code" href="x86_8h.html#a759070a52abe7fcdf99cc62134289d72">kvm_before_interrupt</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, <a class="code" href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bdaacdf5086536076396283ee0384fe725a">KVM_HANDLING_NMI</a>);</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160; </div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;    <a class="code" href="x86_8c.html#aff7b722decad07b127dc964cb4ba5ebc">kvm_load_host_xsave_state</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;    <a class="code" href="svm__ops_8h.html#a97407302752e909143951887456521ef">stgi</a>();</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160; </div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;    <span class="comment">/* Any pending NMI will happen here */</span></div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160; </div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    <span class="keywordflow">if</span> (unlikely(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code == SVM_EXIT_NMI))</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;        <a class="code" href="x86_8h.html#a3fd078203f842566e7e4250b50fd3691">kvm_after_interrupt</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160; </div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;    <a class="code" href="svm_8c.html#a640846de1c48f3e408644fcb85a6004b">sync_cr8_to_lapic</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160; </div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af9472805586ac10a411dde4a890047ac">next_rip</a> = 0;</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>)) {</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;        <a class="code" href="svm_2nested_8c.html#a232d9e4f1731f0d495e3b4f9d530d0ee">nested_sync_control_from_vmcb02</a>(svm);</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160; </div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;        <span class="comment">/* Track VMRUNs that have made past consistency checking */</span></div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;        <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">nested_run_pending</a> &amp;&amp;</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code != SVM_EXIT_ERR)</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;                        ++<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;stat.nested_run;</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160; </div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">nested_run_pending</a> = 0;</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;    }</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160; </div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.tlb_ctl = TLB_CONTROL_DO_NOTHING;</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;    <a class="code" href="svm_8h.html#a64fd8d98c29189b4f4e47f96958aeeca">vmcb_mark_all_clean</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>);</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160; </div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;    <span class="comment">/* if exit due to PF check for async PF */</span></div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code == SVM_EXIT_EXCP_BASE + PF_VECTOR)</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;        <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.apf.host_apf_flags =</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;            kvm_read_and_reset_apf_flags();</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160; </div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.regs_avail &amp;= ~<a class="code" href="svm_8h.html#a45c751b4204124bee221bec64ada4d72">SVM_REGS_LAZY_LOAD_SET</a>;</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160; </div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;<span class="comment">     * We need to handle MC intercepts here before the vcpu has a chance to</span></div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;<span class="comment">     * change the physical cpu</span></div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;    <span class="keywordflow">if</span> (unlikely(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code ==</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;             SVM_EXIT_EXCP_BASE + MC_VECTOR))</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;        <a class="code" href="svm_8c.html#af1c9d228af74c8b5f794a4babc5d465b">svm_handle_mce</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160; </div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;    trace_kvm_exit(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, <a class="code" href="trace_8h.html#a4d128aa094f6d97def671922abd09d29">KVM_ISA_SVM</a>);</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160; </div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;    <a class="code" href="svm_8c.html#a921858ef8782f6b0eebb284c5db66de8">svm_complete_interrupts</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160; </div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;        <span class="keywordflow">return</span> EXIT_FASTPATH_NONE;</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160; </div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a82c8447e70f06dd52623c696446104b5">svm_exit_handlers_fastpath</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;}</div>
<div class="ttc" id="alapic_8c_html_a94273a31a16c3d074d5722f22474bcbb"><div class="ttname"><a href="lapic_8c.html#a94273a31a16c3d074d5722f22474bcbb">kvm_wait_lapic_expire</a></div><div class="ttdeci">void kvm_wait_lapic_expire(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8c_source.html#l01869">lapic.c:1869</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a232d9e4f1731f0d495e3b4f9d530d0ee"><div class="ttname"><a href="svm_2nested_8c.html#a232d9e4f1731f0d495e3b4f9d530d0ee">nested_sync_control_from_vmcb02</a></div><div class="ttdeci">void nested_sync_control_from_vmcb02(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00414">nested.c:414</a></div></div>
<div class="ttc" id="asvm_8c_html_a04b96ed53c5aaf42d298205d87cd7762"><div class="ttname"><a href="svm_8c.html#a04b96ed53c5aaf42d298205d87cd7762">svm_vcpu_enter_exit</a></div><div class="ttdeci">static noinstr void svm_vcpu_enter_exit(struct kvm_vcpu *vcpu, bool spec_ctrl_intercepted)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l04102">svm.c:4102</a></div></div>
<div class="ttc" id="asvm_8c_html_a1337a20b038f182d9e04102e22c45f79"><div class="ttname"><a href="svm_8c.html#a1337a20b038f182d9e04102e22c45f79">pre_svm_run</a></div><div class="ttdeci">static void pre_svm_run(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03533">svm.c:3533</a></div></div>
<div class="ttc" id="asvm_8c_html_a640846de1c48f3e408644fcb85a6004b"><div class="ttname"><a href="svm_8c.html#a640846de1c48f3e408644fcb85a6004b">sync_cr8_to_lapic</a></div><div class="ttdeci">static void sync_cr8_to_lapic(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03949">svm.c:3949</a></div></div>
<div class="ttc" id="asvm_8c_html_a82c8447e70f06dd52623c696446104b5"><div class="ttname"><a href="svm_8c.html#a82c8447e70f06dd52623c696446104b5">svm_exit_handlers_fastpath</a></div><div class="ttdeci">static fastpath_t svm_exit_handlers_fastpath(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l04093">svm.c:4093</a></div></div>
<div class="ttc" id="asvm_8c_html_a9dbf1138872247b45ebbc4880523c0dd"><div class="ttname"><a href="svm_8c.html#a9dbf1138872247b45ebbc4880523c0dd">msr_write_intercepted</a></div><div class="ttdeci">static bool msr_write_intercepted(struct kvm_vcpu *vcpu, u32 msr)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00794">svm.c:794</a></div></div>
<div class="ttc" id="asvm_8c_html_ac7f791888ec3548c8fa076367bbc84d9"><div class="ttname"><a href="svm_8c.html#ac7f791888ec3548c8fa076367bbc84d9">sync_lapic_to_cr8</a></div><div class="ttdeci">static void sync_lapic_to_cr8(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03962">svm.c:3962</a></div></div>
<div class="ttc" id="asvm_8c_html_af1c9d228af74c8b5f794a4babc5d465b"><div class="ttname"><a href="svm_8c.html#af1c9d228af74c8b5f794a4babc5d465b">svm_handle_mce</a></div><div class="ttdeci">static void svm_handle_mce(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02159">svm.c:2159</a></div></div>
<div class="ttc" id="asvm_8c_html_af4202e53ce31f4e2eb93adf37be9ec5d"><div class="ttname"><a href="svm_8c.html#af4202e53ce31f4e2eb93adf37be9ec5d">svm_set_dr6</a></div><div class="ttdeci">static void svm_set_dr6(struct vcpu_svm *svm, unsigned long value)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01993">svm.c:1993</a></div></div>
<div class="ttc" id="asvm_8h_html_a45c751b4204124bee221bec64ada4d72"><div class="ttname"><a href="svm_8h.html#a45c751b4204124bee221bec64ada4d72">SVM_REGS_LAZY_LOAD_SET</a></div><div class="ttdeci">#define SVM_REGS_LAZY_LOAD_SET</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00377">svm.h:377</a></div></div>
<div class="ttc" id="asvm_8h_html_a64fd8d98c29189b4f4e47f96958aeeca"><div class="ttname"><a href="svm_8h.html#a64fd8d98c29189b4f4e47f96958aeeca">vmcb_mark_all_clean</a></div><div class="ttdeci">static void vmcb_mark_all_clean(struct vmcb *vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00348">svm.h:348</a></div></div>
<div class="ttc" id="asvm__onhyperv_8h_html_ad0874023d06644e3a4d157d4a4082eda"><div class="ttname"><a href="svm__onhyperv_8h.html#ad0874023d06644e3a4d157d4a4082eda">svm_hv_update_vp_id</a></div><div class="ttdeci">static void svm_hv_update_vp_id(struct vmcb *vmcb, struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm__onhyperv_8h_source.html#l00110">svm_onhyperv.h:110</a></div></div>
<div class="ttc" id="asvm__ops_8h_html_a8d0a3ba898bb1fad86d53f334336e9bd"><div class="ttname"><a href="svm__ops_8h.html#a8d0a3ba898bb1fad86d53f334336e9bd">clgi</a></div><div class="ttdeci">static void clgi(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm__ops_8h_source.html#l00039">svm_ops.h:39</a></div></div>
<div class="ttc" id="ax86_8c_html_aed9e7eaa275b4dc9692bbbfea052ca53"><div class="ttname"><a href="x86_8c.html#aed9e7eaa275b4dc9692bbbfea052ca53">kvm_load_guest_xsave_state</a></div><div class="ttdeci">void kvm_load_guest_xsave_state(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01018">x86.c:1018</a></div></div>
<div class="ttc" id="ax86_8c_html_aff7b722decad07b127dc964cb4ba5ebc"><div class="ttname"><a href="x86_8c.html#aff7b722decad07b127dc964cb4ba5ebc">kvm_load_host_xsave_state</a></div><div class="ttdeci">void kvm_load_host_xsave_state(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01041">x86.c:1041</a></div></div>
<div class="ttc" id="ax86_8h_html_a3fd078203f842566e7e4250b50fd3691"><div class="ttname"><a href="x86_8h.html#a3fd078203f842566e7e4250b50fd3691">kvm_after_interrupt</a></div><div class="ttdeci">static __always_inline void kvm_after_interrupt(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00446">x86.h:446</a></div></div>
<div class="ttc" id="ax86_8h_html_a759070a52abe7fcdf99cc62134289d72"><div class="ttname"><a href="x86_8h.html#a759070a52abe7fcdf99cc62134289d72">kvm_before_interrupt</a></div><div class="ttdeci">static __always_inline void kvm_before_interrupt(struct kvm_vcpu *vcpu, enum kvm_intr_type intr)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00440">x86.h:440</a></div></div>
<div class="ttc" id="ax86_8h_html_a7ba75eeb6127223035e9f970dc4513bdaacdf5086536076396283ee0384fe725a"><div class="ttname"><a href="x86_8h.html#a7ba75eeb6127223035e9f970dc4513bdaacdf5086536076396283ee0384fe725a">KVM_HANDLING_NMI</a></div><div class="ttdeci">@ KVM_HANDLING_NMI</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00437">x86.h:437</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5d2703bd914c4ae4fcb1eb83c208b085_cgraph.png" border="0" usemap="#asvm_8c_a5d2703bd914c4ae4fcb1eb83c208b085_cgraph" alt=""/></div>
<map name="asvm_8c_a5d2703bd914c4ae4fcb1eb83c208b085_cgraph" id="asvm_8c_a5d2703bd914c4ae4fcb1eb83c208b085_cgraph">
<area shape="rect" title=" " alt="" coords="5,1295,121,1321"/>
<area shape="rect" href="svm__ops_8h.html#a8d0a3ba898bb1fad86d53f334336e9bd" title=" " alt="" coords="250,5,295,32"/>
<area shape="rect" href="svm_8c.html#a7ff4c846a46f6bb2e429d79bbc18f052" title=" " alt="" coords="185,56,360,83"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="470,107,590,133"/>
<area shape="rect" href="x86_8h.html#a3fd078203f842566e7e4250b50fd3691" title=" " alt="" coords="197,1620,348,1647"/>
<area shape="rect" href="x86_8h.html#a759070a52abe7fcdf99cc62134289d72" title=" " alt="" coords="191,1671,354,1697"/>
<area shape="rect" href="x86_8c.html#aed9e7eaa275b4dc9692bbbfea052ca53" title=" " alt="" coords="185,1554,360,1595"/>
<area shape="rect" href="x86_8c.html#aff7b722decad07b127dc964cb4ba5ebc" title=" " alt="" coords="189,1489,356,1530"/>
<area shape="rect" href="lapic_8c.html#a94273a31a16c3d074d5722f22474bcbb" title=" " alt="" coords="187,1724,359,1751"/>
<area shape="rect" href="svm_8c.html#a9dbf1138872247b45ebbc4880523c0dd" title=" " alt="" coords="189,208,357,235"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="717,360,787,387"/>
<area shape="rect" href="svm_2nested_8c.html#a232d9e4f1731f0d495e3b4f9d530d0ee" title=" " alt="" coords="195,1422,350,1463"/>
<area shape="rect" href="svm_8c.html#a1337a20b038f182d9e04102e22c45f79" title=" " alt="" coords="219,1041,326,1068"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="684,1193,820,1220"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="475,1219,585,1245"/>
<area shape="rect" href="svm__ops_8h.html#a97407302752e909143951887456521ef" title=" " alt="" coords="249,1775,296,1801"/>
<area shape="rect" href="svm_8c.html#a921858ef8782f6b0eebb284c5db66de8" title=" " alt="" coords="179,528,367,555"/>
<area shape="rect" href="svm_8c.html#a82c8447e70f06dd52623c696446104b5" title=" " alt="" coords="169,805,376,832"/>
<area shape="rect" href="svm_8c.html#af1c9d228af74c8b5f794a4babc5d465b" title=" " alt="" coords="205,1825,341,1852"/>
<area shape="rect" href="svm__onhyperv_8h.html#ad0874023d06644e3a4d157d4a4082eda" title=" " alt="" coords="189,1876,356,1903"/>
<area shape="rect" href="svm_8c.html#af4202e53ce31f4e2eb93adf37be9ec5d" title=" " alt="" coords="220,1269,325,1296"/>
<area shape="rect" href="svm_8c.html#a04b96ed53c5aaf42d298205d87cd7762" title=" " alt="" coords="192,1168,353,1195"/>
<area shape="rect" href="svm_8c.html#a640846de1c48f3e408644fcb85a6004b" title=" " alt="" coords="204,1320,341,1347"/>
<area shape="rect" href="svm_8c.html#ac7f791888ec3548c8fa076367bbc84d9" title=" " alt="" coords="204,107,341,133"/>
<area shape="rect" href="svm_8h.html#a64fd8d98c29189b4f4e47f96958aeeca" title=" " alt="" coords="191,1927,355,1953"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="693,1548,811,1575"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="457,1624,603,1651"/>
<area shape="rect" href="lapic_8c.html#aad64663521c2c2f523dce26a339df367" title=" " alt="" coords="437,1776,623,1803"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="471,1827,589,1853"/>
<area shape="rect" href="lapic_8c.html#a4d28368a44947389f8a7afec1c3288d3" title=" " alt="" coords="441,1725,619,1752"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="457,157,603,184"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="451,1523,609,1549"/>
<area shape="rect" href="svm_8h.html#ab452fafde694bb5dfd7c6dfc5707ae12" title=" " alt="" coords="447,1472,613,1499"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="463,1421,597,1448"/>
<area shape="rect" href="svm_8c.html#a1ec4f210ddd96122d1d787a383483514" title=" " alt="" coords="489,1067,571,1093"/>
<area shape="rect" href="sev_8c.html#ad0a040a48a04ab47d0af3385ad214cd4" title=" " alt="" coords="479,1117,581,1144"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="486,1016,574,1043"/>
<area shape="rect" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb" title=" " alt="" coords="451,864,609,891"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="699,1079,805,1105"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="449,681,611,722"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="453,411,607,453"/>
<area shape="rect" href="x86_8h.html#aaa166361b58ce8e326699e6cfe87e39a" title=" " alt="" coords="449,477,611,504"/>
<area shape="rect" href="x86_8c.html#a7afcfddd2ea5cf31a22813c76d9747c2" title=" " alt="" coords="439,528,621,555"/>
<area shape="rect" href="x86_8c.html#a0d7f1c47245e95be49d8925ca92b8365" title=" " alt="" coords="431,579,629,605"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="475,629,585,656"/>
<area shape="rect" href="svm_8c.html#adf1eccfcab9b8a4c710b30fec219fe14" title=" " alt="" coords="424,360,636,387"/>
<area shape="rect" href="x86_8c.html#a8a37294ff599bdc5183d75ecdd61412a" title=" " alt="" coords="453,798,607,839"/>
<area shape="rect" href="svm_8c.html#ac7c5304a8c015386109035f7ab577919" title=" " alt="" coords="469,1928,591,1955"/>
<area shape="rect" href="x86_8h.html#aa539ceac11af1b634966fdd3d8c68cc5" title=" " alt="" coords="451,1877,609,1904"/>
<area shape="rect" href="svm_8h.html#aba6feca2fbeab5686eaf28f921a819f7" title=" " alt="" coords="439,1168,621,1195"/>
</map>
</div>

</div>
</div>
<a id="a0e69cefce46e7b11e1e8e056ea5b6561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e69cefce46e7b11e1e8e056ea5b6561">&#9670;&nbsp;</a></span>svm_vm_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_vm_destroy </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04883">4883</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;{</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;    <a class="code" href="avic_8c.html#a3bb736e8688ecfaa3696b347764fd37d">avic_vm_destroy</a>(kvm);</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;    <a class="code" href="sev_8c.html#af1eb77eac84f085b0a943b87f783e30d">sev_vm_destroy</a>(kvm);</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a3bb736e8688ecfaa3696b347764fd37d"><div class="ttname"><a href="avic_8c.html#a3bb736e8688ecfaa3696b347764fd37d">avic_vm_destroy</a></div><div class="ttdeci">void avic_vm_destroy(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00174">avic.c:174</a></div></div>
<div class="ttc" id="asev_8c_html_af1eb77eac84f085b0a943b87f783e30d"><div class="ttname"><a href="sev_8c.html#af1eb77eac84f085b0a943b87f783e30d">sev_vm_destroy</a></div><div class="ttdeci">void sev_vm_destroy(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02140">sev.c:2140</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a0e69cefce46e7b11e1e8e056ea5b6561_cgraph.png" border="0" usemap="#asvm_8c_a0e69cefce46e7b11e1e8e056ea5b6561_cgraph" alt=""/></div>
<map name="asvm_8c_a0e69cefce46e7b11e1e8e056ea5b6561_cgraph" id="asvm_8c_a0e69cefce46e7b11e1e8e056ea5b6561_cgraph">
<area shape="rect" title=" " alt="" coords="5,867,140,893"/>
<area shape="rect" href="avic_8c.html#a3bb736e8688ecfaa3696b347764fd37d" title=" " alt="" coords="188,892,321,919"/>
<area shape="rect" href="sev_8c.html#af1eb77eac84f085b0a943b87f783e30d" title=" " alt="" coords="190,791,319,817"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="879,867,986,893"/>
<area shape="rect" href="sev_8c.html#a362d02e2a9852da2f2dae93d2dbd70f9" title=" " alt="" coords="369,699,549,741"/>
<area shape="rect" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc" title=" " alt="" coords="597,816,784,843"/>
<area shape="rect" href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241" title=" " alt="" coords="402,555,517,581"/>
<area shape="rect" href="sev_8c.html#aee6abadc293da84185f2a9b6e78bfd43" title=" " alt="" coords="403,867,515,893"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="415,917,503,944"/>
<area shape="rect" href="sev_8c.html#a4e8d6041acaecc396b4c6eca246fcd67" title=" " alt="" coords="394,765,525,792"/>
<area shape="rect" href="sev_8c.html#aa9ba426e70b3cfcb263352b3ac89173f" title=" " alt="" coords="615,711,766,737"/>
<area shape="rect" href="kvm__main_8c.html#afd922c538c448ab1248cdb9dccae9410" title=" " alt="" coords="623,512,758,539"/>
<area shape="rect" href="kvm__main_8c.html#a1c487edf6b04278a8ba6638e4f714643" title=" " alt="" coords="853,309,1013,336"/>
<area shape="rect" href="x86_8c.html#ad84dda268db5d48c48f3ef2f438c62a7" title=" " alt="" coords="847,411,1018,437"/>
<area shape="rect" href="kvm__main_8c.html#a3089edf2c0e5790aab7e8ed723f34b5b" title=" " alt="" coords="1587,248,1743,275"/>
<area shape="rect" href="x86_8c.html#a30933173bb4382eb522f58c7a46dfe48" title=" " alt="" coords="859,512,1006,539"/>
<area shape="rect" href="kvm__main_8c.html#a82d4376e528b0e4ff28ec43f992f364a" title=" " alt="" coords="833,563,1032,589"/>
<area shape="rect" href="x86_8c.html#a6f324dc73c5f97fe0b9dfa35f303d5f9" title=" " alt="" coords="845,360,1020,387"/>
<area shape="rect" href="coalesced__mmio_8c.html#acbde5f51051def5601627c214de053d5" title=" " alt="" coords="832,613,1033,640"/>
<area shape="rect" href="kvm__main_8c.html#abfe532698477df01f13e371d91388539" title=" " alt="" coords="851,664,1015,691"/>
<area shape="rect" href="kvm__main_8c.html#a7e9f8db90d91053e866c157b6c162013" title=" " alt="" coords="839,715,1027,741"/>
<area shape="rect" href="kvm__main_8c.html#a78be2b95971bc468a0a368d314280776" title=" " alt="" coords="835,765,1030,792"/>
<area shape="rect" href="kvm__main_8c.html#ab6320575dc04178df16ea4d7dddff190" title=" " alt="" coords="848,816,1017,843"/>
<area shape="rect" href="irqchip_8c.html#a841c49803610b79f779b380bffbe07cb" title=" " alt="" coords="852,44,1013,71"/>
<area shape="rect" href="kvm__main_8c.html#ae58ffa9a2b55027be40935dd4410bd30" title=" " alt="" coords="855,132,1011,159"/>
<area shape="rect" href="kvm__main_8c.html#ad245c522a96e3da12a65f213f34d2305" title=" " alt="" coords="832,259,1033,285"/>
<area shape="rect" href="x86_8c.html#a0c0c5e35bc626e4140927bf15b4881f9" title=" " alt="" coords="1085,461,1282,488"/>
<area shape="rect" href="kvm__main_8c.html#a0fcd9f7671bee7debec1bc05dcd9557b" title=" " alt="" coords="1107,613,1259,640"/>
<area shape="rect" href="x86_8c.html#ad83ae43be57823912b41e24e4b6bbc41" title=" " alt="" coords="1107,512,1260,539"/>
<area shape="rect" href="hyperv_8c.html#ac7f9f19a66e3ae5ae397e937daf75a73" title=" " alt="" coords="1104,563,1263,589"/>
<area shape="rect" href="ioapic_8c.html#ae707e80b0215afe92318ac1813d15345" title=" " alt="" coords="1107,157,1260,184"/>
<area shape="rect" href="mmu_8c.html#a0beae9a256ad42642a6b522a36a18a74" title=" " alt="" coords="1101,360,1265,387"/>
<area shape="rect" href="page__track_8h.html#a061d2d3a74ebe3354da60bb521b8ef13" title=" " alt="" coords="1089,208,1277,235"/>
<area shape="rect" href="i8259_8c.html#a48d54ace62d2b40899cadfddf0b70781" title=" " alt="" coords="1117,309,1250,336"/>
<area shape="rect" href="x86_8c.html#a6710e6b26ce720cb1d40113afe17efa7" title=" " alt="" coords="1089,411,1277,437"/>
<area shape="rect" href="xen_8c.html#a2de7c50ba573dd74c833c6b0bc675909" title=" " alt="" coords="1101,259,1266,285"/>
<area shape="rect" href="kvm__main_8c.html#ac76f506181e49aa4800bb202e11cb2b3" title=" " alt="" coords="1335,477,1537,504"/>
<area shape="rect" href="kvm__main_8c.html#a7218df747387e4034ab8442f187306b1" title=" " alt="" coords="1363,613,1509,640"/>
<area shape="rect" href="kvm__main_8c.html#a103c02eb7ca545106f3130776c2a8897" title=" " alt="" coords="1334,197,1538,224"/>
<area shape="rect" href="kvm__main_8c.html#aa6d7dea09a0b657f29e92f424e5d0633" title=" " alt="" coords="1791,223,1977,249"/>
<area shape="rect" href="tdp__mmu_8c.html#a73432bf42fbb3d43b3e04f88cd92b592" title=" " alt="" coords="1333,295,1539,321"/>
<area shape="rect" href="mmu_8c.html#a30c216bd5aafa41e32fcffa372d89380" title=" " alt="" coords="1347,346,1525,387"/>
<area shape="rect" href="async__pf_8c.html#ad351bddfe80f107dfc95c6ab2768fe4f" title=" " alt="" coords="1359,411,1513,453"/>
<area shape="rect" href="i8254_8c.html#a2a7ca7f5194b378ba7f0ae7a38cc26ba" title=" " alt="" coords="1129,107,1237,133"/>
<area shape="rect" href="mmu_8c.html#a6a9d3382763ac1478855bd15907a98e2" title=" " alt="" coords="1081,787,1285,813"/>
<area shape="rect" href="kvm__main_8c.html#a31dbd36d8363fc2e5979b3976ebc0dbb" title=" " alt="" coords="1088,838,1279,879"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="1101,5,1266,32"/>
<area shape="rect" href="kvm__main_8c.html#ae2d9291adcda0ba0f7a20350dabdd418" title=" " alt="" coords="1109,56,1258,83"/>
<area shape="rect" href="sev_8c.html#abb38e8cb91318a62d655dc9c4eaaaafd" title=" " alt="" coords="605,867,777,893"/>
<area shape="rect" href="sev_8c.html#aa7faf38fc33d615dc428806df7b26845" title=" " alt="" coords="617,765,764,792"/>
</map>
</div>

</div>
</div>
<a id="ad90f40489ad04f5f81a69a87f36e4eca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad90f40489ad04f5f81a69a87f36e4eca">&#9670;&nbsp;</a></span>svm_vm_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int svm_vm_init </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04889">4889</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;{</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a3bc68316af32e407d865d83e00a03316">pause_filter_count</a> || !<a class="code" href="svm_8c.html#a7844865730b4425faa277774dddb41b6">pause_filter_thresh</a>)</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;        kvm-&gt;arch.pause_in_guest = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160; </div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8c.html#a04af9ab3eee510b54cba17a6fa94ee04">enable_apicv</a>) {</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;        <span class="keywordtype">int</span> ret = <a class="code" href="avic_8c.html#a0ddedac4b0b428928fae6bc9fe902e2a">avic_vm_init</a>(kvm);</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;            <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;    }</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160; </div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a0ddedac4b0b428928fae6bc9fe902e2a"><div class="ttname"><a href="avic_8c.html#a0ddedac4b0b428928fae6bc9fe902e2a">avic_vm_init</a></div><div class="ttdeci">int avic_vm_init(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00192">avic.c:192</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9a1b45b05505f9435cc2d1dd1c37943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9a1b45b05505f9435cc2d1dd1c37943">&#9670;&nbsp;</a></span>svm_write_tsc_multiplier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_write_tsc_multiplier </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01163">1163</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;{</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    preempt_disable();</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;guest_state_loaded)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <a class="code" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34">__svm_write_tsc_multiplier</a>(vcpu-&gt;arch.tsc_scaling_ratio);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    preempt_enable();</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad9a1b45b05505f9435cc2d1dd1c37943_cgraph.png" border="0" usemap="#asvm_8c_ad9a1b45b05505f9435cc2d1dd1c37943_cgraph" alt=""/></div>
<map name="asvm_8c_ad9a1b45b05505f9435cc2d1dd1c37943_cgraph" id="asvm_8c_ad9a1b45b05505f9435cc2d1dd1c37943_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,192,57"/>
<area shape="rect" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34" title=" " alt="" coords="240,5,440,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="305,56,375,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ad9a1b45b05505f9435cc2d1dd1c37943_icgraph.png" border="0" usemap="#asvm_8c_ad9a1b45b05505f9435cc2d1dd1c37943_icgraph" alt=""/></div>
<map name="asvm_8c_ad9a1b45b05505f9435cc2d1dd1c37943_icgraph" id="asvm_8c_ad9a1b45b05505f9435cc2d1dd1c37943_icgraph">
<area shape="rect" title=" " alt="" coords="1959,124,2145,151"/>
<area shape="rect" href="svm_2nested_8c.html#ae003d7b6aae84aa9b70d64f464e70dfc" title=" " alt="" coords="1732,19,1911,61"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1744,221,1899,248"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,33,1176,74"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1522,27,1631,53"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,27,945,53"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,77,940,104"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,128,719,155"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,128,520,155"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,153,323,180"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,153,128,180"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,339,1673,365"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,273,1684,314"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,77,1679,104"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,221,1679,248"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,390,1668,431"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,331,1399,373"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,397,1403,424"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,448,1389,475"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,339,1144,365"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,339,939,365"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,280,1421,307"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,45,1408,86"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,229,1412,256"/>
</map>
</div>

</div>
</div>
<a id="a5779d517a24ab13b687f430474e7b018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5779d517a24ab13b687f430474e7b018">&#9670;&nbsp;</a></span>svm_write_tsc_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_write_tsc_offset </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01154">1154</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;{</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;control.tsc_offset = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.l1_tsc_offset;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.tsc_offset = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.tsc_offset;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#aaf8fd5f0e57d456151c951e0f3715fc4aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a>);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5779d517a24ab13b687f430474e7b018_cgraph.png" border="0" usemap="#asvm_8c_a5779d517a24ab13b687f430474e7b018_cgraph" alt=""/></div>
<map name="asvm_8c_a5779d517a24ab13b687f430474e7b018_cgraph" id="asvm_8c_a5779d517a24ab13b687f430474e7b018_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,165,57"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="246,5,317,32"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="213,56,349,83"/>
</map>
</div>

</div>
</div>
<a id="a640846de1c48f3e408644fcb85a6004b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a640846de1c48f3e408644fcb85a6004b">&#9670;&nbsp;</a></span>sync_cr8_to_lapic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sync_cr8_to_lapic </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03949">3949</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;{</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160; </div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a">nested_svm_virtualize_tpr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160; </div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a>(svm, INTERCEPT_CR8_WRITE)) {</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;        <span class="keywordtype">int</span> cr8 = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl &amp; V_TPR_MASK;</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;        <a class="code" href="x86_8c.html#a120377d5a571d3fb86660cd5f6cd982d">kvm_set_cr8</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, cr8);</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;    }</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a640846de1c48f3e408644fcb85a6004b_cgraph.png" border="0" usemap="#asvm_8c_a640846de1c48f3e408644fcb85a6004b_cgraph" alt=""/></div>
<map name="asvm_8c_a640846de1c48f3e408644fcb85a6004b_cgraph" id="asvm_8c_a640846de1c48f3e408644fcb85a6004b_cgraph">
<area shape="rect" title=" " alt="" coords="5,208,143,235"/>
<area shape="rect" href="x86_8c.html#a120377d5a571d3fb86660cd5f6cd982d" title=" " alt="" coords="235,132,341,159"/>
<area shape="rect" href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a" title=" " alt="" coords="191,183,385,209"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="469,233,539,260"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="221,284,355,311"/>
<area shape="rect" href="lapic_8c.html#aee34622e495b500817e0b0905bfd0d4c" title=" " alt="" coords="433,132,575,159"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="445,81,563,108"/>
<area shape="rect" href="lapic_8c.html#a02bd03bf711be3200ea2316ced434ff1" title=" " alt="" coords="623,132,724,159"/>
<area shape="rect" href="lapic_8c.html#a7cfae0ee851075e6141d0446f4a133ab" title=" " alt="" coords="772,107,901,133"/>
<area shape="rect" href="lapic_8c.html#ab2ee275fa1bc17aa0bfde435723b8f48" title=" " alt="" coords="1146,157,1290,184"/>
<area shape="rect" href="lapic_8c.html#a1bb0a1640f9f291f5c3154c6a2c40986" title=" " alt="" coords="949,107,1092,133"/>
<area shape="rect" href="lapic_8c.html#ac1c99098894f4751a556057800e906e0" title=" " alt="" coords="949,19,1092,61"/>
<area shape="rect" href="lapic_8c.html#a80d977ac48cfa76440f2961e38b23fd0" title=" " alt="" coords="1344,107,1503,133"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="1145,56,1291,83"/>
<area shape="rect" href="lapic_8c.html#a656567b4197d9a5af833ffd04dff7a52" title=" " alt="" coords="1551,56,1700,83"/>
<area shape="rect" href="lapic_8h.html#aa28a43e0f54449e2ec4d25e1f8ecb178" title=" " alt="" coords="1344,56,1503,83"/>
<area shape="rect" href="lapic_8c.html#a5de365e734b929b65e2d75f62cea6f7e" title=" " alt="" coords="1344,157,1503,184"/>
<area shape="rect" href="lapic_8c.html#aebc526fc8720e4db45143f8e05f85c79" title=" " alt="" coords="1140,5,1296,32"/>
<area shape="rect" href="lapic_8c.html#a734e8a2b56a9a0b0d9117f20f2bb0fc1" title=" " alt="" coords="1363,5,1483,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="444,183,564,209"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="433,284,575,311"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a640846de1c48f3e408644fcb85a6004b_icgraph.png" border="0" usemap="#asvm_8c_a640846de1c48f3e408644fcb85a6004b_icgraph" alt=""/></div>
<map name="asvm_8c_a640846de1c48f3e408644fcb85a6004b_icgraph" id="asvm_8c_a640846de1c48f3e408644fcb85a6004b_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,307,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="ac7f791888ec3548c8fa076367bbc84d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7f791888ec3548c8fa076367bbc84d9">&#9670;&nbsp;</a></span>sync_lapic_to_cr8()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sync_lapic_to_cr8 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03962">3962</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;{</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;    u64 cr8;</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160; </div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a">nested_svm_virtualize_tpr</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) ||</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;        <a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160; </div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    cr8 = <a class="code" href="x86_8c.html#a314ef23ae9439bea8ebd5983055cfad8">kvm_get_cr8</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl &amp;= ~V_TPR_MASK;</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl |= cr8 &amp; V_TPR_MASK;</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ac7f791888ec3548c8fa076367bbc84d9_cgraph.png" border="0" usemap="#asvm_8c_ac7f791888ec3548c8fa076367bbc84d9_cgraph" alt=""/></div>
<map name="asvm_8c_ac7f791888ec3548c8fa076367bbc84d9_cgraph" id="asvm_8c_ac7f791888ec3548c8fa076367bbc84d9_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,143,108"/>
<area shape="rect" href="x86_8c.html#a314ef23ae9439bea8ebd5983055cfad8" title=" " alt="" coords="235,5,341,32"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="199,56,377,83"/>
<area shape="rect" href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a" title=" " alt="" coords="191,107,385,133"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="470,157,541,184"/>
<area shape="rect" href="lapic_8c.html#a3aead5d19fd0505da0197dfc140d6824" title=" " alt="" coords="433,5,577,32"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="446,56,565,83"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="625,5,771,32"/>
<area shape="rect" href="lapic_8h.html#aa28a43e0f54449e2ec4d25e1f8ecb178" title=" " alt="" coords="819,5,977,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="445,107,565,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_ac7f791888ec3548c8fa076367bbc84d9_icgraph.png" border="0" usemap="#asvm_8c_ac7f791888ec3548c8fa076367bbc84d9_icgraph" alt=""/></div>
<map name="asvm_8c_ac7f791888ec3548c8fa076367bbc84d9_icgraph" id="asvm_8c_ac7f791888ec3548c8fa076367bbc84d9_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,307,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="a034d0058215cd4fddf9fbaa460d3faf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a034d0058215cd4fddf9fbaa460d3faf6">&#9670;&nbsp;</a></span>task_switch_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int task_switch_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02488">2488</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;{</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    u16 tss_selector;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <span class="keywordtype">int</span> reason;</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="keywordtype">int</span> int_type = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_int_info &amp;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        SVM_EXITINTINFO_TYPE_MASK;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <span class="keywordtype">int</span> int_vec = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_int_info &amp; SVM_EVTINJ_VEC_MASK;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    uint32_t type =</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_int_info &amp; SVM_EXITINTINFO_TYPE_MASK;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    uint32_t idt_v =</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_int_info &amp; SVM_EXITINTINFO_VALID;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    <span class="keywordtype">bool</span> has_error_code = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    u32 error_code = 0;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160; </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    tss_selector = (u16)svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160; </div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    if (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2 &amp;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        (1ULL &lt;&lt; SVM_EXITINFOSHIFT_TS_REASON_IRET))</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;        reason = TASK_SWITCH_IRET;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2 &amp;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;         (1ULL &lt;&lt; SVM_EXITINFOSHIFT_TS_REASON_JMP))</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        reason = TASK_SWITCH_JMP;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idt_v)</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        reason = TASK_SWITCH_GATE;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        reason = TASK_SWITCH_CALL;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160; </div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <span class="keywordflow">if</span> (reason == TASK_SWITCH_GATE) {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        <span class="keywordflow">case</span> SVM_EXITINTINFO_TYPE_NMI:</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;            <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.nmi_injected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        <span class="keywordflow">case</span> SVM_EXITINTINFO_TYPE_EXEPT:</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;            <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2 &amp;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                (1ULL &lt;&lt; SVM_EXITINFOSHIFT_TS_HAS_ERROR_CODE)) {</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                has_error_code = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                error_code =</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                    (u32)svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2;</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;            }</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;            <a class="code" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4">kvm_clear_exception_queue</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        <span class="keywordflow">case</span> SVM_EXITINTINFO_TYPE_INTR:</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        <span class="keywordflow">case</span> SVM_EXITINTINFO_TYPE_SOFT:</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;            <a class="code" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160">kvm_clear_interrupt_queue</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        }</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    }</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160; </div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keywordflow">if</span> (reason != TASK_SWITCH_GATE ||</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        int_type == SVM_EXITINTINFO_TYPE_SOFT ||</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        (int_type == SVM_EXITINTINFO_TYPE_EXEPT &amp;&amp;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;         (int_vec == OF_VECTOR || int_vec == BP_VECTOR))) {</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a879b6475034eccd7032ffd436966f341">svm_skip_emulated_instruction</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    }</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160; </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="keywordflow">if</span> (int_type != SVM_EXITINTINFO_TYPE_SOFT)</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        int_vec = -1;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a2bbfe1f9bc7dbf9d4f69022d69128851">kvm_task_switch</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, tss_selector, int_vec, reason,</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                   has_error_code, error_code);</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a879b6475034eccd7032ffd436966f341"><div class="ttname"><a href="svm_8c.html#a879b6475034eccd7032ffd436966f341">svm_skip_emulated_instruction</a></div><div class="ttdeci">static int svm_skip_emulated_instruction(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00407">svm.c:407</a></div></div>
<div class="ttc" id="ax86_8c_html_a2bbfe1f9bc7dbf9d4f69022d69128851"><div class="ttname"><a href="x86_8c.html#a2bbfe1f9bc7dbf9d4f69022d69128851">kvm_task_switch</a></div><div class="ttdeci">int kvm_task_switch(struct kvm_vcpu *vcpu, u16 tss_selector, int idt_index, int reason, bool has_error_code, u32 error_code)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l11657">x86.c:11657</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a034d0058215cd4fddf9fbaa460d3faf6_cgraph.png" border="0" usemap="#asvm_8c_a034d0058215cd4fddf9fbaa460d3faf6_cgraph" alt=""/></div>
<map name="asvm_8c_a034d0058215cd4fddf9fbaa460d3faf6_cgraph" id="asvm_8c_a034d0058215cd4fddf9fbaa460d3faf6_cgraph">
<area shape="rect" title=" " alt="" coords="5,917,189,944"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="1207,889,1369,930"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="275,1019,429,1061"/>
<area shape="rect" href="x86_8c.html#a2bbfe1f9bc7dbf9d4f69022d69128851" title=" " alt="" coords="999,613,1133,640"/>
<area shape="rect" href="svm_8c.html#a879b6475034eccd7032ffd436966f341" title=" " alt="" coords="237,841,467,868"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1031,867,1101,893"/>
<area shape="rect" href="emulate_8c.html#acd24acfc7335123b776af97f24d7a47c" title=" " alt="" coords="1205,360,1371,387"/>
<area shape="rect" href="x86_8c.html#a1ea3de1eeac2d51a6580bf4335b544a3" title=" " alt="" coords="1220,588,1356,615"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="1231,765,1345,792"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="1227,664,1349,691"/>
<area shape="rect" href="emulate_8c.html#a4072a51bbe640dbf8860185d709b1170" title=" " alt="" coords="1419,335,1607,361"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="1437,385,1588,412"/>
<area shape="rect" href="emulate_8c.html#a068063f5fe57c50016d23ff322851f29" title=" " alt="" coords="1437,284,1588,311"/>
<area shape="rect" href="emulate_8c.html#a27c9897ba6079f6be68f6715aa5926f6" title=" " alt="" coords="1681,385,1819,412"/>
<area shape="rect" href="emulate_8c.html#a6ba204a1abcf641452bda2aed0713879" title=" " alt="" coords="1709,335,1791,361"/>
<area shape="rect" href="emulate_8c.html#abc0996c2a79441f6e77530b751eb78c1" title=" " alt="" coords="2146,436,2245,463"/>
<area shape="rect" href="emulate_8c.html#a529c22274ccca6882d65e374e35080b5" title=" " alt="" coords="2148,512,2243,539"/>
<area shape="rect" href="emulate_8c.html#a1a268b7cc824436c566d598b894c6a6e" title=" " alt="" coords="2112,81,2279,108"/>
<area shape="rect" href="emulate_8c.html#a8c20ad36666544992abc2c12e9968783" title=" " alt="" coords="1657,436,1843,463"/>
<area shape="rect" href="emulate_8c.html#a9ef6489026cd15b1fd6e5f294a05cd93" title=" " alt="" coords="1657,284,1843,311"/>
<area shape="rect" href="emulate_8c.html#ad544fe8341616cf1be70837c114b746a" title=" " alt="" coords="1689,132,1811,159"/>
<area shape="rect" href="emulate_8c.html#ad9471baea7b02308bfc13d4b98b0db39" title=" " alt="" coords="1689,233,1811,260"/>
<area shape="rect" href="emulate_8c.html#a7ba91a0de5ebd9c24f4d21f8e611202d" title=" " alt="" coords="1655,183,1845,209"/>
<area shape="rect" href="emulate_8c.html#af8fc62bb1ad5c7f1bc37a0ed230c5044" title=" " alt="" coords="1952,385,2005,412"/>
<area shape="rect" href="emulate_8c.html#a36457e3b49fd0f4050a41531cee0c215" title=" " alt="" coords="2327,487,2473,513"/>
<area shape="rect" href="emulate_8c.html#abad2c9866014370330cfb555f04d09ec" title=" " alt="" coords="1903,335,2054,361"/>
<area shape="rect" href="emulate_8c.html#ae3aa900d923376aeaadcf638e4a3e685" title=" " alt="" coords="1909,284,2049,311"/>
<area shape="rect" href="emulate_8c.html#a38066300a93610daf47184cc45f1a7ef" title=" " alt="" coords="1901,132,2056,159"/>
<area shape="rect" href="emulate_8c.html#a22f00b9a328bda483ed3363bee8befcb" title=" " alt="" coords="1893,31,2064,57"/>
<area shape="rect" href="emulate_8c.html#a289219cf18ee887fed54365caa520a46" title=" " alt="" coords="1901,81,2056,108"/>
<area shape="rect" href="emulate_8c.html#a9f6608aaea91e4f966f9faec0ed30d11" title=" " alt="" coords="1893,233,2064,260"/>
<area shape="rect" href="emulate_8c.html#a1b4848e9fdb6e596ef6b1797bc1faa13" title=" " alt="" coords="1901,183,2056,209"/>
<area shape="rect" href="emulate_8c.html#a98958741961401f4fc2eefc28ba3bdd7" title=" " alt="" coords="1441,461,1584,488"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="1457,512,1569,539"/>
<area shape="rect" href="x86_8h.html#a134b4e55e4ea92a3519e9538f05d4e6b" title=" " alt="" coords="1461,563,1564,589"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="1451,613,1574,640"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1457,664,1568,691"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="1677,588,1823,615"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="1906,588,2051,615"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1663,664,1837,691"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="1423,765,1602,792"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="1657,765,1843,792"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="1445,715,1580,741"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1681,715,1819,741"/>
<area shape="rect" href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe" title=" " alt="" coords="515,783,681,825"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="734,715,922,741"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="773,664,883,691"/>
<area shape="rect" href="svm_8c.html#a88f50f26e46655ddf4e070bcabcc66ad" title=" " alt="" coords="729,816,927,843"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="975,715,1157,741"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="1013,664,1119,691"/>
</map>
</div>

</div>
</div>
<a id="a945e4b7aeb0acfaeed484133937f5b1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a945e4b7aeb0acfaeed484133937f5b1f">&#9670;&nbsp;</a></span>ud_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ud_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02109">2109</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;{</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#adc471c9bb1bd010f5c75e803cb312b53">handle_ud</a>(vcpu);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;}</div>
<div class="ttc" id="ax86_8c_html_adc471c9bb1bd010f5c75e803cb312b53"><div class="ttname"><a href="x86_8c.html#adc471c9bb1bd010f5c75e803cb312b53">handle_ud</a></div><div class="ttdeci">int handle_ud(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l07669">x86.c:7669</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a945e4b7aeb0acfaeed484133937f5b1f_cgraph.png" border="0" usemap="#asvm_8c_a945e4b7aeb0acfaeed484133937f5b1f_cgraph" alt=""/></div>
<map name="asvm_8c_a945e4b7aeb0acfaeed484133937f5b1f_cgraph" id="asvm_8c_a945e4b7aeb0acfaeed484133937f5b1f_cgraph">
<area shape="rect" title=" " alt="" coords="5,999,128,1025"/>
<area shape="rect" href="x86_8c.html#adc471c9bb1bd010f5c75e803cb312b53" title=" " alt="" coords="176,999,265,1025"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="788,43,979,69"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="313,667,501,693"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1501,1013,1648,1040"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1713,1249,1824,1276"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="826,1333,941,1360"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="823,93,944,120"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="346,1435,469,1461"/>
<area shape="rect" href="x86_8c.html#a7064cd8944dd550352cef83c72612045" title=" " alt="" coords="328,1485,487,1512"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="549,667,732,693"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="1059,195,1194,221"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="785,464,982,491"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="794,413,973,440"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="807,718,960,759"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="822,616,945,643"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="789,784,977,811"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="1042,843,1211,869"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1035,896,1219,923"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="784,1068,983,1095"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="803,886,963,927"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="803,951,964,993"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="793,1169,974,1196"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="1274,1006,1446,1047"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="1267,1177,1453,1204"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="802,667,965,693"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="819,565,948,592"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="802,296,965,323"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="1083,489,1170,516"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="799,347,968,389"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="813,515,954,541"/>
<area shape="rect" href="x86_8c.html#a333df16e0456af479cb64edbd93345d6" title=" " alt="" coords="1291,575,1429,601"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="1696,1039,1841,1065"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1707,988,1831,1015"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="1921,988,2033,1015"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1889,1249,2064,1276"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="2112,1249,2305,1276"/>
<area shape="rect" href="x86_8c.html#a2a7f61481aae2e0bfe4baaba68d6d650" title=" " alt="" coords="1041,413,1212,440"/>
<area shape="rect" href="emulate_8c.html#ae69320a0fcebe18444870430331b44b1" title=" " alt="" coords="1051,725,1202,752"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1067,616,1187,643"/>
<area shape="rect" href="x86_8c.html#aea69aad92f3a36aaebec0c2a9e853b61" title=" " alt="" coords="1038,777,1215,818"/>
<area shape="rect" href="x86_8c.html#a8bbfd08c002f2e09b42bb56cd8f52653" title=" " alt="" coords="1045,947,1208,989"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1065,1165,1188,1192"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1047,1217,1206,1258"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1039,1064,1214,1091"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1041,1115,1212,1141"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="1037,1333,1216,1360"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a0f6830d8a03ec49d8ac457e2a9c1d687" title=" " alt="" coords="1267,1333,1453,1360"/>
<area shape="rect" href="x86_8c.html#ab9c276fafa298a76b0f6a9f001db989b" title=" " alt="" coords="561,1478,720,1519"/>
<area shape="rect" href="kvm__main_8c.html#adfef9b2c2d6359fd443d98f51be19605" title=" " alt="" coords="780,1485,987,1512"/>
</map>
</div>

</div>
</div>
<a id="a48f427ed9696201e388996df7ceccb9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f427ed9696201e388996df7ceccb9e">&#9670;&nbsp;</a></span>valid_msr_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool valid_msr_intercept </td>
          <td>(</td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00789">789</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;{</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3">direct_access_msr_slot</a>(index) != -ENOENT;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a48f427ed9696201e388996df7ceccb9e_cgraph.png" border="0" usemap="#asvm_8c_a48f427ed9696201e388996df7ceccb9e_cgraph" alt=""/></div>
<map name="asvm_8c_a48f427ed9696201e388996df7ceccb9e_cgraph" id="asvm_8c_a48f427ed9696201e388996df7ceccb9e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,156,32"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="204,5,377,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a48f427ed9696201e388996df7ceccb9e_icgraph.png" border="0" usemap="#asvm_8c_a48f427ed9696201e388996df7ceccb9e_icgraph" alt=""/></div>
<map name="asvm_8c_a48f427ed9696201e388996df7ceccb9e_icgraph" id="asvm_8c_a48f427ed9696201e388996df7ceccb9e_icgraph">
<area shape="rect" title=" " alt="" coords="3091,337,3241,363"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="2884,329,3043,371"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="2666,311,2825,338"/>
<area shape="rect" href="svm_8c.html#ab4bda9cd8e4f3408d51dff1dd4403a11" title=" " alt="" coords="2655,362,2836,389"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1809,231,1896,258"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="2230,123,2381,164"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="2021,64,2173,105"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="2453,282,2591,309"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="2437,5,2607,47"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="2454,551,2590,578"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="2043,653,2152,679"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="2455,501,2589,527"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="2443,333,2601,375"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="2437,450,2607,477"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1513,235,1641,262"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="2247,282,2363,309"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="2027,282,2168,309"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1732,282,1973,309"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="2232,5,2379,47"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="2238,551,2373,578"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1775,501,1930,527"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1743,602,1963,629"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,445,1673,471"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,357,1684,399"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,618,1679,645"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,523,719,550"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,295,1679,322"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,552,1668,593"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,457,1399,499"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,406,1403,433"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,355,1389,382"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,465,1144,491"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,465,939,491"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,305,1421,331"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,603,1408,644"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,603,1176,644"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,635,945,662"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,585,940,611"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,389,520,415"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,363,323,390"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,363,128,390"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,254,1412,281"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="2229,337,2381,363"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="2221,387,2389,414"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="2037,333,2157,359"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="2022,384,2173,425"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="1781,384,1925,425"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="1781,450,1924,477"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="2225,501,2385,527"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2042,551,2153,578"/>
</map>
</div>

</div>
</div>
<a id="a21c0c414304458bb0fdecde7cc8eeb2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21c0c414304458bb0fdecde7cc8eeb2d">&#9670;&nbsp;</a></span>vmload_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int vmload_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02286">2286</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;{</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a22d5ad8a3cac7e24cb8438a20eb39348">vmload_vmsave_interception</a>(vcpu, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a22d5ad8a3cac7e24cb8438a20eb39348"><div class="ttname"><a href="svm_8c.html#a22d5ad8a3cac7e24cb8438a20eb39348">vmload_vmsave_interception</a></div><div class="ttdeci">static int vmload_vmsave_interception(struct kvm_vcpu *vcpu, bool vmload)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02252">svm.c:2252</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a21c0c414304458bb0fdecde7cc8eeb2d_cgraph.png" border="0" usemap="#asvm_8c_a21c0c414304458bb0fdecde7cc8eeb2d_cgraph" alt=""/></div>
<map name="asvm_8c_a21c0c414304458bb0fdecde7cc8eeb2d_cgraph" id="asvm_8c_a21c0c414304458bb0fdecde7cc8eeb2d_cgraph">
<area shape="rect" title=" " alt="" coords="5,533,161,560"/>
<area shape="rect" href="svm_8c.html#a22d5ad8a3cac7e24cb8438a20eb39348" title=" " alt="" coords="209,533,424,560"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="473,331,703,357"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="525,559,651,585"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="517,609,659,636"/>
<area shape="rect" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8" title=" " alt="" coords="472,457,704,484"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="810,508,881,535"/>
<area shape="rect" href="svm_2nested_8c.html#ae2a559173016267c3c1ef55be6571c0c" title=" " alt="" coords="501,661,675,702"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="755,140,936,167"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="752,331,939,357"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1027,5,1149,32"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1009,133,1167,174"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1001,199,1175,225"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1003,81,1173,108"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="1554,7,1645,33"/>
<area shape="rect" href="pmu_8h.html#abbf4b99efff2cdd22398e2992085c36f" title=" " alt="" coords="1245,189,1444,230"/>
<area shape="rect" href="pmu_8c.html#af08b63fb7910be3ee65e8036b4e48aad" title=" " alt="" coords="1256,32,1433,59"/>
<area shape="rect" href="pmu_8h.html#a156ede05e2f3b40ccf7a68f471f574b2" title=" " alt="" coords="1251,83,1438,109"/>
<area shape="rect" href="pmu_8h.html#a276700643eefb3c6911a7ae0dc0e3809" title=" " alt="" coords="1254,133,1435,160"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1015,305,1161,332"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="996,356,1180,383"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="1272,255,1417,281"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1283,305,1407,332"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1289,356,1400,383"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1253,407,1436,433"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="1536,272,1663,299"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1539,323,1659,349"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="1512,374,1687,415"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="1500,440,1699,467"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1507,491,1691,517"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="800,559,891,585"/>
<area shape="rect" href="kvm__main_8c.html#a7c20e0f654f0b4472c3833f0a563e11e" title=" " alt="" coords="1024,508,1152,535"/>
<area shape="rect" href="kvm__main_8c.html#aa77d8fc2ee9fe5965c45f1d0989eb266" title=" " alt="" coords="1010,559,1166,585"/>
<area shape="rect" href="kvm__main_8c.html#a63ec3e18db03a212e6e84391b5025689" title=" " alt="" coords="1259,512,1430,539"/>
<area shape="rect" href="kvm__main_8c.html#a6f9056f6dc868b557b2a2c8e1c548762" title=" " alt="" coords="778,609,913,636"/>
<area shape="rect" href="kvm__main_8c.html#ab3f118170e5a0cf30913bc0cd0a79cfd" title=" " alt="" coords="761,709,930,750"/>
<area shape="rect" href="kvm__main_8c.html#af83e69473e2fe5bf6e452f3fc1f414d2" title=" " alt="" coords="1000,609,1176,636"/>
<area shape="rect" href="kvm__main_8c.html#a18a05d2f708322bccd0481cee9b76bdc" title=" " alt="" coords="1003,660,1173,687"/>
<area shape="rect" href="kvm__main_8c.html#a99f99281cc81d5cd69f5825ccb8793b4" title=" " alt="" coords="1237,613,1452,640"/>
<area shape="rect" href="kvm__main_8c.html#a6845d169e1c19786abe7719700b9f6b9" title=" " alt="" coords="1506,589,1693,616"/>
<area shape="rect" href="kvm__main_8c.html#acf5fa0af4d165e38ac4721f4061b6f73" title=" " alt="" coords="1253,664,1436,691"/>
<area shape="rect" href="kvm__main_8c.html#ac4b56de4919be80c9cd4289f20437c64" title=" " alt="" coords="987,716,1189,743"/>
<area shape="rect" href="kvm__main_8c.html#ae4806d9a69b751639c175cb98e468f15" title=" " alt="" coords="997,775,1179,801"/>
<area shape="rect" href="dirty__ring_8c.html#ac1878b63f1f337e93cf186ebd4fffcc4" title=" " alt="" coords="1259,715,1431,757"/>
<area shape="rect" href="dirty__ring_8c.html#a81ebbf462440ed5392d6d3412a859ae7" title=" " alt="" coords="1265,781,1424,808"/>
<area shape="rect" href="kvm__main_8c.html#ac5a3afd8e2d8d1139dc7711c4b9e07e3" title=" " alt="" coords="1258,832,1431,859"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="803,457,887,484"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="761,407,930,433"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="1015,457,1161,484"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="1272,457,1417,484"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a21c0c414304458bb0fdecde7cc8eeb2d_icgraph.png" border="0" usemap="#asvm_8c_a21c0c414304458bb0fdecde7cc8eeb2d_icgraph" alt=""/></div>
<map name="asvm_8c_a21c0c414304458bb0fdecde7cc8eeb2d_icgraph" id="asvm_8c_a21c0c414304458bb0fdecde7cc8eeb2d_icgraph">
<area shape="rect" title=" " alt="" coords="371,5,527,32"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="a22d5ad8a3cac7e24cb8438a20eb39348"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22d5ad8a3cac7e24cb8438a20eb39348">&#9670;&nbsp;</a></span>vmload_vmsave_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int vmload_vmsave_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>vmload</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02252">2252</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;{</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb12;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keyword">struct </span>kvm_host_map map;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160; </div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8">nested_svm_check_permissions</a>(vcpu))</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    ret = <a class="code" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9">kvm_vcpu_map</a>(vcpu, gpa_to_gfn(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rax), &amp;map);</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="keywordflow">if</span> (ret) {</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <span class="keywordflow">if</span> (ret == -EINVAL)</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;            kvm_inject_gp(vcpu, 0);</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    }</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160; </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    vmcb12 = map.hva;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    ret = <a class="code" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a>(vcpu);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; </div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="keywordflow">if</span> (vmload) {</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        <a class="code" href="svm_2nested_8c.html#ae2a559173016267c3c1ef55be6571c0c">svm_copy_vmloadsave_state</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, vmcb12);</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a80fa0b4dcbb7f9758bd7c0c29e1ed1a5">sysenter_eip_hi</a> = 0;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a747a3e237abb2217a6a93de9d17de74e">sysenter_esp_hi</a> = 0;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        <a class="code" href="svm_2nested_8c.html#ae2a559173016267c3c1ef55be6571c0c">svm_copy_vmloadsave_state</a>(vmcb12, svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>);</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    }</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160; </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <a class="code" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155">kvm_vcpu_unmap</a>(vcpu, &amp;map, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160; </div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;}</div>
<div class="ttc" id="akvm__main_8c_html_a96c7b38454f962b34da813b043f4abe9"><div class="ttname"><a href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9">kvm_vcpu_map</a></div><div class="ttdeci">int kvm_vcpu_map(struct kvm_vcpu *vcpu, gfn_t gfn, struct kvm_host_map *map)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l03152">kvm_main.c:3152</a></div></div>
<div class="ttc" id="akvm__main_8c_html_af9a24e7d30a38de04326c683ebc6a155"><div class="ttname"><a href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155">kvm_vcpu_unmap</a></div><div class="ttdeci">void kvm_vcpu_unmap(struct kvm_vcpu *vcpu, struct kvm_host_map *map, bool dirty)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l03186">kvm_main.c:3186</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_ae2a559173016267c3c1ef55be6571c0c"><div class="ttname"><a href="svm_2nested_8c.html#ae2a559173016267c3c1ef55be6571c0c">svm_copy_vmloadsave_state</a></div><div class="ttdeci">void svm_copy_vmloadsave_state(struct vmcb *to_vmcb, struct vmcb *from_vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00951">nested.c:951</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a22d5ad8a3cac7e24cb8438a20eb39348_cgraph.png" border="0" usemap="#asvm_8c_a22d5ad8a3cac7e24cb8438a20eb39348_cgraph" alt=""/></div>
<map name="asvm_8c_a22d5ad8a3cac7e24cb8438a20eb39348_cgraph" id="asvm_8c_a22d5ad8a3cac7e24cb8438a20eb39348_cgraph">
<area shape="rect" title=" " alt="" coords="5,533,220,560"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="269,331,499,357"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="321,559,447,585"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="313,609,455,636"/>
<area shape="rect" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8" title=" " alt="" coords="268,457,500,484"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="606,508,677,535"/>
<area shape="rect" href="svm_2nested_8c.html#ae2a559173016267c3c1ef55be6571c0c" title=" " alt="" coords="297,661,471,702"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="551,140,732,167"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="548,331,735,357"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="823,5,945,32"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="805,133,963,174"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="797,199,971,225"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="799,81,969,108"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="1350,7,1441,33"/>
<area shape="rect" href="pmu_8h.html#abbf4b99efff2cdd22398e2992085c36f" title=" " alt="" coords="1041,189,1240,230"/>
<area shape="rect" href="pmu_8c.html#af08b63fb7910be3ee65e8036b4e48aad" title=" " alt="" coords="1052,32,1229,59"/>
<area shape="rect" href="pmu_8h.html#a156ede05e2f3b40ccf7a68f471f574b2" title=" " alt="" coords="1047,83,1234,109"/>
<area shape="rect" href="pmu_8h.html#a276700643eefb3c6911a7ae0dc0e3809" title=" " alt="" coords="1050,133,1231,160"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="811,305,957,332"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="792,356,976,383"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="1068,255,1213,281"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1079,305,1203,332"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1085,356,1196,383"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1049,407,1232,433"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="1332,239,1459,265"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1335,289,1455,316"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="1308,341,1483,382"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="1296,407,1495,433"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1303,457,1487,484"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="1311,509,1480,550"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="596,559,687,585"/>
<area shape="rect" href="kvm__main_8c.html#a7c20e0f654f0b4472c3833f0a563e11e" title=" " alt="" coords="820,508,948,535"/>
<area shape="rect" href="kvm__main_8c.html#aa77d8fc2ee9fe5965c45f1d0989eb266" title=" " alt="" coords="806,559,962,585"/>
<area shape="rect" href="kvm__main_8c.html#a63ec3e18db03a212e6e84391b5025689" title=" " alt="" coords="1055,516,1226,543"/>
<area shape="rect" href="kvm__main_8c.html#a6f9056f6dc868b557b2a2c8e1c548762" title=" " alt="" coords="574,609,709,636"/>
<area shape="rect" href="kvm__main_8c.html#ab3f118170e5a0cf30913bc0cd0a79cfd" title=" " alt="" coords="557,711,726,753"/>
<area shape="rect" href="kvm__main_8c.html#af83e69473e2fe5bf6e452f3fc1f414d2" title=" " alt="" coords="796,609,972,636"/>
<area shape="rect" href="kvm__main_8c.html#a18a05d2f708322bccd0481cee9b76bdc" title=" " alt="" coords="799,660,969,687"/>
<area shape="rect" href="kvm__main_8c.html#a99f99281cc81d5cd69f5825ccb8793b4" title=" " alt="" coords="1033,617,1248,644"/>
<area shape="rect" href="kvm__main_8c.html#a6845d169e1c19786abe7719700b9f6b9" title=" " alt="" coords="1302,621,1489,648"/>
<area shape="rect" href="kvm__main_8c.html#acf5fa0af4d165e38ac4721f4061b6f73" title=" " alt="" coords="1049,668,1232,695"/>
<area shape="rect" href="kvm__main_8c.html#ac4b56de4919be80c9cd4289f20437c64" title=" " alt="" coords="783,719,985,745"/>
<area shape="rect" href="kvm__main_8c.html#ae4806d9a69b751639c175cb98e468f15" title=" " alt="" coords="793,777,975,804"/>
<area shape="rect" href="dirty__ring_8c.html#ac1878b63f1f337e93cf186ebd4fffcc4" title=" " alt="" coords="1055,719,1227,761"/>
<area shape="rect" href="dirty__ring_8c.html#a81ebbf462440ed5392d6d3412a859ae7" title=" " alt="" coords="1061,785,1220,812"/>
<area shape="rect" href="kvm__main_8c.html#ac5a3afd8e2d8d1139dc7711c4b9e07e3" title=" " alt="" coords="1054,836,1227,863"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="599,457,683,484"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="557,407,726,433"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="811,457,957,484"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="1068,457,1213,484"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a22d5ad8a3cac7e24cb8438a20eb39348_icgraph.png" border="0" usemap="#asvm_8c_a22d5ad8a3cac7e24cb8438a20eb39348_icgraph" alt=""/></div>
<map name="asvm_8c_a22d5ad8a3cac7e24cb8438a20eb39348_icgraph" id="asvm_8c_a22d5ad8a3cac7e24cb8438a20eb39348_icgraph">
<area shape="rect" title=" " alt="" coords="577,31,792,57"/>
<area shape="rect" href="svm_8c.html#a21c0c414304458bb0fdecde7cc8eeb2d" title=" " alt="" coords="372,5,528,32"/>
<area shape="rect" href="svm_8c.html#a81c9359522d571596389c15258054845" title=" " alt="" coords="371,56,529,83"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,31,323,57"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,31,128,57"/>
</map>
</div>

</div>
</div>
<a id="a5d52c93beeb85ba5a99283d4eba589e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d52c93beeb85ba5a99283d4eba589e1">&#9670;&nbsp;</a></span>vmrun_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int vmrun_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02296">2296</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;{</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8">nested_svm_check_permissions</a>(vcpu))</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160; </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f">nested_svm_vmrun</a>(vcpu);</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;}</div>
<div class="ttc" id="asvm_2nested_8c_html_a4ec7e878f6af209e74dd84285ee0198f"><div class="ttname"><a href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f">nested_svm_vmrun</a></div><div class="ttdeci">int nested_svm_vmrun(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00837">nested.c:837</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5d52c93beeb85ba5a99283d4eba589e1_cgraph.png" border="0" usemap="#asvm_8c_a5d52c93beeb85ba5a99283d4eba589e1_cgraph" alt=""/></div>
<map name="asvm_8c_a5d52c93beeb85ba5a99283d4eba589e1_cgraph" id="asvm_8c_a5d52c93beeb85ba5a99283d4eba589e1_cgraph">
<area shape="rect" title=" " alt="" coords="5,623,155,649"/>
<area shape="rect" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8" title=" " alt="" coords="203,257,435,284"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="243,823,394,849"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="556,409,640,436"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="787,13,956,40"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="836,64,907,91"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="798,399,945,425"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="1048,1105,1193,1132"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1260,1156,1453,1183"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1029,13,1212,40"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="509,359,687,385"/>
<area shape="rect" href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67" title=" " alt="" coords="561,772,635,799"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="810,668,933,695"/>
<area shape="rect" href="hyperv_8h.html#a2ff068b2830d40b54df6cf8bad14e171" title=" " alt="" coords="505,873,691,900"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="814,1105,929,1132"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="814,1156,929,1183"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="816,1207,927,1233"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="483,1359,713,1385"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="809,1257,934,1284"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="801,1308,942,1335"/>
<area shape="rect" href="svm_2nested_8c.html#add5ee1e85234f2457480494694865c21" title=" " alt="" coords="499,1422,697,1463"/>
<area shape="rect" href="svm_2nested_8c.html#ae052404bed168cf69c578a697ce25526" title=" " alt="" coords="505,1513,691,1554"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="521,823,675,849"/>
<area shape="rect" href="svm_2nested_8c.html#a3c235b4ddb7200e464cacf8dfb3b4f00" title=" " alt="" coords="497,257,699,284"/>
<area shape="rect" href="svm_2nested_8c.html#aeb4d38d47572db12942883495b996356" title=" " alt="" coords="491,207,705,233"/>
<area shape="rect" href="svm_2nested_8c.html#ae732aef70a2e3611917e028d9ec42ace" title=" " alt="" coords="502,308,694,335"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="782,297,961,324"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1044,144,1197,171"/>
<area shape="rect" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f" title=" " alt="" coords="770,602,973,643"/>
<area shape="rect" href="svm_2hyperv_8h.html#a3983896ad03a4957172ab441f7182b9d" title=" " alt="" coords="783,231,959,273"/>
<area shape="rect" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab" title=" " alt="" coords="790,449,953,476"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="780,166,963,207"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="761,348,981,375"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="821,500,922,527"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="800,551,943,577"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1061,348,1180,375"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="1041,584,1200,611"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="1063,820,1178,847"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="1033,1207,1208,1233"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="781,1359,962,1385"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="778,1409,965,1436"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="1075,1257,1166,1284"/>
<area shape="rect" href="kvm__main_8c.html#a6f9056f6dc868b557b2a2c8e1c548762" title=" " alt="" coords="1053,1375,1188,1401"/>
<area shape="rect" href="kvm__main_8c.html#ab3f118170e5a0cf30913bc0cd0a79cfd" title=" " alt="" coords="1036,1309,1205,1350"/>
<area shape="rect" href="svm_2nested_8c.html#a1fc7997959fb33b39415a12879645d2d" title=" " alt="" coords="791,1461,952,1502"/>
<area shape="rect" href="svm_2nested_8c.html#a5f775ed43f15dcd9b51601e16d13ba02" title=" " alt="" coords="791,1526,952,1567"/>
<area shape="rect" href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73" title=" " alt="" coords="773,937,970,964"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="791,988,952,1015"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="791,1039,952,1081"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="795,871,948,913"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a5d52c93beeb85ba5a99283d4eba589e1_icgraph.png" border="0" usemap="#asvm_8c_a5d52c93beeb85ba5a99283d4eba589e1_icgraph" alt=""/></div>
<map name="asvm_8c_a5d52c93beeb85ba5a99283d4eba589e1_icgraph" id="asvm_8c_a5d52c93beeb85ba5a99283d4eba589e1_icgraph">
<area shape="rect" title=" " alt="" coords="371,5,520,32"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="a81c9359522d571596389c15258054845"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81c9359522d571596389c15258054845">&#9670;&nbsp;</a></span>vmsave_interception()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int vmsave_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02291">2291</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;{</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a22d5ad8a3cac7e24cb8438a20eb39348">vmload_vmsave_interception</a>(vcpu, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a81c9359522d571596389c15258054845_cgraph.png" border="0" usemap="#asvm_8c_a81c9359522d571596389c15258054845_cgraph" alt=""/></div>
<map name="asvm_8c_a81c9359522d571596389c15258054845_cgraph" id="asvm_8c_a81c9359522d571596389c15258054845_cgraph">
<area shape="rect" title=" " alt="" coords="5,533,164,560"/>
<area shape="rect" href="svm_8c.html#a22d5ad8a3cac7e24cb8438a20eb39348" title=" " alt="" coords="212,533,427,560"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="475,331,706,357"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="528,559,653,585"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="520,609,661,636"/>
<area shape="rect" href="svm_2nested_8c.html#a8907fcb136a33618dbbc1c2b7d3872f8" title=" " alt="" coords="475,457,707,484"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="813,508,883,535"/>
<area shape="rect" href="svm_2nested_8c.html#ae2a559173016267c3c1ef55be6571c0c" title=" " alt="" coords="503,661,678,702"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="757,140,939,167"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="755,331,941,357"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1029,5,1152,32"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1011,133,1170,174"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1003,199,1178,225"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1005,81,1176,108"/>
<area shape="rect" href="pmu_8h.html#a5024a14da9d7fdac47fefed9449d0d2d" title=" " alt="" coords="1557,7,1647,33"/>
<area shape="rect" href="pmu_8h.html#abbf4b99efff2cdd22398e2992085c36f" title=" " alt="" coords="1248,189,1447,230"/>
<area shape="rect" href="pmu_8c.html#af08b63fb7910be3ee65e8036b4e48aad" title=" " alt="" coords="1259,32,1436,59"/>
<area shape="rect" href="pmu_8h.html#a156ede05e2f3b40ccf7a68f471f574b2" title=" " alt="" coords="1254,83,1441,109"/>
<area shape="rect" href="pmu_8h.html#a276700643eefb3c6911a7ae0dc0e3809" title=" " alt="" coords="1257,133,1438,160"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1017,305,1164,332"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="999,356,1183,383"/>
<area shape="rect" href="x86_8c.html#a45ce50c8a83f9e81b45ea94d89c55271" title=" " alt="" coords="1275,255,1420,281"/>
<area shape="rect" href="x86_8h.html#ada9d5e605374059a5e34c42817ed5118" title=" " alt="" coords="1285,305,1409,332"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="1292,356,1403,383"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="1256,407,1439,433"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="1539,272,1665,299"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1542,323,1662,349"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="1515,374,1689,415"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="1503,440,1701,467"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="1510,491,1694,517"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="803,559,893,585"/>
<area shape="rect" href="kvm__main_8c.html#a7c20e0f654f0b4472c3833f0a563e11e" title=" " alt="" coords="1027,508,1155,535"/>
<area shape="rect" href="kvm__main_8c.html#aa77d8fc2ee9fe5965c45f1d0989eb266" title=" " alt="" coords="1013,559,1169,585"/>
<area shape="rect" href="kvm__main_8c.html#a63ec3e18db03a212e6e84391b5025689" title=" " alt="" coords="1262,512,1433,539"/>
<area shape="rect" href="kvm__main_8c.html#a6f9056f6dc868b557b2a2c8e1c548762" title=" " alt="" coords="781,609,915,636"/>
<area shape="rect" href="kvm__main_8c.html#ab3f118170e5a0cf30913bc0cd0a79cfd" title=" " alt="" coords="763,709,933,750"/>
<area shape="rect" href="kvm__main_8c.html#af83e69473e2fe5bf6e452f3fc1f414d2" title=" " alt="" coords="1003,609,1179,636"/>
<area shape="rect" href="kvm__main_8c.html#a18a05d2f708322bccd0481cee9b76bdc" title=" " alt="" coords="1005,660,1176,687"/>
<area shape="rect" href="kvm__main_8c.html#a99f99281cc81d5cd69f5825ccb8793b4" title=" " alt="" coords="1240,613,1455,640"/>
<area shape="rect" href="kvm__main_8c.html#a6845d169e1c19786abe7719700b9f6b9" title=" " alt="" coords="1509,589,1695,616"/>
<area shape="rect" href="kvm__main_8c.html#acf5fa0af4d165e38ac4721f4061b6f73" title=" " alt="" coords="1256,664,1439,691"/>
<area shape="rect" href="kvm__main_8c.html#ac4b56de4919be80c9cd4289f20437c64" title=" " alt="" coords="989,716,1192,743"/>
<area shape="rect" href="kvm__main_8c.html#ae4806d9a69b751639c175cb98e468f15" title=" " alt="" coords="999,775,1182,801"/>
<area shape="rect" href="dirty__ring_8c.html#ac1878b63f1f337e93cf186ebd4fffcc4" title=" " alt="" coords="1261,715,1433,757"/>
<area shape="rect" href="dirty__ring_8c.html#a81ebbf462440ed5392d6d3412a859ae7" title=" " alt="" coords="1268,781,1427,808"/>
<area shape="rect" href="kvm__main_8c.html#ac5a3afd8e2d8d1139dc7711c4b9e07e3" title=" " alt="" coords="1261,832,1434,859"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="806,457,890,484"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="763,407,933,433"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="1017,457,1164,484"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="1275,457,1420,484"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8c_a81c9359522d571596389c15258054845_icgraph.png" border="0" usemap="#asvm_8c_a81c9359522d571596389c15258054845_icgraph" alt=""/></div>
<map name="asvm_8c_a81c9359522d571596389c15258054845_icgraph" id="asvm_8c_a81c9359522d571596389c15258054845_icgraph">
<area shape="rect" title=" " alt="" coords="371,5,529,32"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ac7d9d348c903d8605668fa4a24248bef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7d9d348c903d8605668fa4a24248bef">&#9670;&nbsp;</a></span>__initdata</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct kvm_x86_init_ops svm_init_ops __initdata</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l04889">4889</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a654225ed9cb5ee3717561aed704a8012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a654225ed9cb5ee3717561aed704a8012">&#9670;&nbsp;</a></span>__read_mostly</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int tsc_aux_uret_slot __read_mostly = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00069">69</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a8c4ea69d2d0310307567f305689357f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c4ea69d2d0310307567f305689357f8">&#9670;&nbsp;</a></span>avic</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool avic</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00228">228</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="ad73a1ea1e074171f7049d11e84aa1814"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad73a1ea1e074171f7049d11e84aa1814">&#9670;&nbsp;</a></span>direct_access_msrs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="structsvm__direct__access__msrs.html">svm_direct_access_msrs</a> direct_access_msrs[<a class="el" href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">MAX_DIRECT_ACCESS_MSRS</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a66f9274e37ab06b0ee941e4480352ba8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66f9274e37ab06b0ee941e4480352ba8">&#9670;&nbsp;</a></span>dump_invalid_vmcb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="x86_8c.html#a721f8d5b210e9625587f13b92870ba38">__read_mostly</a> dump_invalid_vmcb</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00231">231</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="adc8812d5d875ec9a2bf431790db71cfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8812d5d875ec9a2bf431790db71cfb">&#9670;&nbsp;</a></span>intercept_smi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool intercept_smi = true</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00235">235</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a14f8324fee7e48032e60893cd7590076"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f8324fee7e48032e60893cd7590076">&#9670;&nbsp;</a></span>iopm_base</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long iopm_base</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00245">245</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="ac6093899c4533e4c669b24862528077d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6093899c4533e4c669b24862528077d">&#9670;&nbsp;</a></span>lbrv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int lbrv = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00218">218</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="aee88cc07545f234f7f296637887bb17c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee88cc07545f234f7f296637887bb17c">&#9670;&nbsp;</a></span>msrpm_ranges</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const u32 msrpm_ranges[] = {0, 0xc0000000, 0xc0010000}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00258">258</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="abe2e85eb9e667809ab7e5dd3ad442b26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe2e85eb9e667809ab7e5dd3ad442b26">&#9670;&nbsp;</a></span>nested</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int nested = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00202">202</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a17a219d0651f1db709a3af0fc5527aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17a219d0651f1db709a3af0fc5527aa0">&#9670;&nbsp;</a></span>npt_enabled</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool npt_enabled = true</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00198">198</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="aea86d846f25c8a44402d3bc2d176130b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea86d846f25c8a44402d3bc2d176130b">&#9670;&nbsp;</a></span>nrips</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nrips = true</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00206">206</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a9cd9c6d58f164e1428e93fac80a1fc34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cd9c6d58f164e1428e93fac80a1fc34">&#9670;&nbsp;</a></span>osvw_len</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t osvw_len = 4</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00077">77</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="ad74f8bf67f324d305a1bde6cebadd841"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad74f8bf67f324d305a1bde6cebadd841">&#9670;&nbsp;</a></span>osvw_status</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t osvw_status</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00077">77</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a3bc68316af32e407d865d83e00a03316"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bc68316af32e407d865d83e00a03316">&#9670;&nbsp;</a></span>pause_filter_count</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short pause_filter_count = <a class="el" href="x86_8h.html#a59cb051233b1de170d81a73ed5aeda6d">KVM_SVM_DEFAULT_PLE_WINDOW</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00179">179</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a64b792e4e2d6162271f1704fbabc4884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64b792e4e2d6162271f1704fbabc4884">&#9670;&nbsp;</a></span>pause_filter_count_grow</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short pause_filter_count_grow = <a class="el" href="x86_8h.html#a8dbcf8fedcb1848df9b0915ee77ad3dd">KVM_DEFAULT_PLE_WINDOW_GROW</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00183">183</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="ac5ab188f15144152c91129b044a371d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5ab188f15144152c91129b044a371d8">&#9670;&nbsp;</a></span>pause_filter_count_max</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short pause_filter_count_max = <a class="el" href="x86_8h.html#a8d95d1ac359797529714473f95160801">KVM_SVM_DEFAULT_PLE_WINDOW_MAX</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00191">191</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="ad71d914e223758efb4dcac69978f4083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad71d914e223758efb4dcac69978f4083">&#9670;&nbsp;</a></span>pause_filter_count_shrink</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short pause_filter_count_shrink = <a class="el" href="x86_8h.html#a65245c185743fd9f09cab0ea68087bda">KVM_DEFAULT_PLE_WINDOW_SHRINK</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00187">187</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a7844865730b4425faa277774dddb41b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7844865730b4425faa277774dddb41b6">&#9670;&nbsp;</a></span>pause_filter_thresh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short pause_filter_thresh = <a class="el" href="x86_8h.html#ac4cf971fee08547c5647367a9393fca2">KVM_DEFAULT_PLE_GAP</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00176">176</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a698bd21413d89411791bef819c6dbbf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a698bd21413d89411791bef819c6dbbf9">&#9670;&nbsp;</a></span>rsm_ins_bytes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">u8 rsm_ins_bytes[] = &quot;\x0f\xaa&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00243">243</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="af73415c5c6c2827a7671c0d2cc5b1c4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af73415c5c6c2827a7671c0d2cc5b1c4f">&#9670;&nbsp;</a></span>svm_exit_handlers</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int(*const svm_exit_handlers[])(struct kvm_vcpu *vcpu) </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03238">3238</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a275c3d046aa0623ea238016c5002acbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a275c3d046aa0623ea238016c5002acbd">&#9670;&nbsp;</a></span>svm_gp_erratum_intercept</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool svm_gp_erratum_intercept = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00241">241</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="adacf7fe5bb2bb2fdef07153a859b75ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adacf7fe5bb2bb2fdef07153a859b75ba">&#9670;&nbsp;</a></span>tsc_scaling</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int tsc_scaling = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00221">221</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="ab0a8ab91829811c7705c6455fb294bbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0a8ab91829811c7705c6455fb294bbc">&#9670;&nbsp;</a></span>vgif</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vgif = true</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00214">214</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a3ad937a1fd2ef8fcdd87953c6a5db405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ad937a1fd2ef8fcdd87953c6a5db405">&#9670;&nbsp;</a></span>vls</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int vls = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00210">210</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a8d0afd60cabe4ff8b40d7099f49a1bb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d0afd60cabe4ff8b40d7099f49a1bb8">&#9670;&nbsp;</a></span>vnmi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool vnmi = true</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00238">238</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a5081d9a75e59287f7ae5e120d6ac4758"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5081d9a75e59287f7ae5e120d6ac4758">&#9670;&nbsp;</a></span>x86_intercept_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="struct____x86__intercept.html">__x86_intercept</a> x86_intercept_map[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
