<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KVM: arch/arm64/kvm/arch_timer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ea9599923402ca8ab47fc3e495999dea.html">arch</a></li><li class="navelem"><a class="el" href="dir_67a9e021ce8db5d46236c6154ee454bc.html">arm64</a></li><li class="navelem"><a class="el" href="dir_42f87ef63ac4150166bf7887f68288e2.html">kvm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">arch_timer.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/cpu.h&gt;</code><br />
<code>#include &lt;linux/kvm.h&gt;</code><br />
<code>#include &lt;linux/kvm_host.h&gt;</code><br />
<code>#include &lt;linux/interrupt.h&gt;</code><br />
<code>#include &lt;linux/irq.h&gt;</code><br />
<code>#include &lt;linux/irqdomain.h&gt;</code><br />
<code>#include &lt;linux/uaccess.h&gt;</code><br />
<code>#include &lt;clocksource/arm_arch_timer.h&gt;</code><br />
<code>#include &lt;asm/arch_timer.h&gt;</code><br />
<code>#include &lt;asm/kvm_emulate.h&gt;</code><br />
<code>#include &lt;asm/kvm_hyp.h&gt;</code><br />
<code>#include &lt;asm/kvm_nested.h&gt;</code><br />
<code>#include &lt;kvm/arm_vgic.h&gt;</code><br />
<code>#include &lt;kvm/arm_arch_timer.h&gt;</code><br />
<code>#include &quot;<a class="el" href="trace_8h_source.html">trace.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for arch_timer.c:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c__incl.png" border="0" usemap="#aarch_2arm64_2kvm_2arch__timer_8c" alt=""/></div>
<map name="aarch_2arm64_2kvm_2arch__timer_8c" id="aarch_2arm64_2kvm_2arch__timer_8c">
<area shape="rect" title=" " alt="" coords="975,5,1137,47"/>
<area shape="rect" title=" " alt="" coords="5,102,99,129"/>
<area shape="rect" title=" " alt="" coords="123,102,221,129"/>
<area shape="rect" title=" " alt="" coords="246,102,381,129"/>
<area shape="rect" title=" " alt="" coords="405,102,531,129"/>
<area shape="rect" title=" " alt="" coords="555,102,642,129"/>
<area shape="rect" title=" " alt="" coords="667,102,803,129"/>
<area shape="rect" title=" " alt="" coords="827,102,949,129"/>
<area shape="rect" title=" " alt="" coords="974,95,1138,136"/>
<area shape="rect" title=" " alt="" coords="1162,102,1297,129"/>
<area shape="rect" title=" " alt="" coords="1378,259,1534,285"/>
<area shape="rect" title=" " alt="" coords="1373,102,1499,129"/>
<area shape="rect" title=" " alt="" coords="1524,102,1671,129"/>
<area shape="rect" title=" " alt="" coords="1695,102,1822,129"/>
<area shape="rect" title=" " alt="" coords="1679,259,1849,285"/>
<area shape="rect" href="trace_8h.html" title=" " alt="" coords="1915,102,1981,129"/>
<area shape="rect" href="trace__arm_8h.html" title=" " alt="" coords="1898,184,1998,211"/>
<area shape="rect" href="trace__handle__exit_8h.html" title=" " alt="" coords="2031,184,2182,211"/>
<area shape="rect" title=" " alt="" coords="2048,259,2184,285"/>
<area shape="rect" title=" " alt="" coords="1873,259,2023,285"/>
<area shape="rect" href="sys__regs_8h.html" title=" " alt="" coords="2208,259,2299,285"/>
<area shape="rect" title=" " alt="" coords="2193,333,2314,360"/>
</map>
</div>
</div>
<p><a href="arch__timer_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aea983e592b69df371a4501567756dbe4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#aea983e592b69df371a4501567756dbe4">assign_clear_set_bit</a>(_pred,  _bit,  _clr,  _set)</td></tr>
<tr class="separator:aea983e592b69df371a4501567756dbe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6456a80f41d0f4b7af21e135c96e649f"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a6456a80f41d0f4b7af21e135c96e649f">DEFINE_STATIC_KEY_FALSE</a> (has_gic_active_state)</td></tr>
<tr class="separator:a6456a80f41d0f4b7af21e135c96e649f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae722c5e3eba2098c012b2cdc4d74bf9f"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f">kvm_timer_irq_can_fire</a> (struct arch_timer_context *timer_ctx)</td></tr>
<tr class="separator:ae722c5e3eba2098c012b2cdc4d74bf9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5abc04b494763cd0814855753e56671f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f">kvm_timer_update_irq</a> (struct kvm_vcpu *vcpu, bool new_level, struct arch_timer_context *timer_ctx)</td></tr>
<tr class="separator:a5abc04b494763cd0814855753e56671f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64a4d2f3d2a9b83524edda4b27246092"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a> (struct arch_timer_context *timer_ctx)</td></tr>
<tr class="separator:a64a4d2f3d2a9b83524edda4b27246092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb5181064df0b30b53f567189e15771"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771">kvm_arm_timer_write</a> (struct kvm_vcpu *vcpu, struct arch_timer_context *timer, enum kvm_arch_timer_regs treg, u64 val)</td></tr>
<tr class="separator:affb5181064df0b30b53f567189e15771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3873c5e4f0eb8a0fa2a466d8e2b9a894"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894">kvm_arm_timer_read</a> (struct kvm_vcpu *vcpu, struct arch_timer_context *timer, enum kvm_arch_timer_regs treg)</td></tr>
<tr class="separator:a3873c5e4f0eb8a0fa2a466d8e2b9a894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25b09c8d95a2582f37a1a2719920e59c"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a25b09c8d95a2582f37a1a2719920e59c">kvm_arch_timer_get_input_level</a> (int vintid)</td></tr>
<tr class="separator:a25b09c8d95a2582f37a1a2719920e59c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2a704b646b65309708c3a7f6ab70913"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913">nr_timers</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad2a704b646b65309708c3a7f6ab70913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7dab91af9f69654aa27010f96125c13"><td class="memItemLeft" align="right" valign="top">u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13">timer_get_ctl</a> (struct arch_timer_context *ctxt)</td></tr>
<tr class="separator:ad7dab91af9f69654aa27010f96125c13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a848ba80b4ffee7a071e37abb241262cd"><td class="memItemLeft" align="right" valign="top">u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd">timer_get_cval</a> (struct arch_timer_context *ctxt)</td></tr>
<tr class="separator:a848ba80b4ffee7a071e37abb241262cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f5f777b74b5c9ec6e13d4f7576d7f43"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a> (struct arch_timer_context *ctxt)</td></tr>
<tr class="separator:a7f5f777b74b5c9ec6e13d4f7576d7f43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e57f3714ec062699e29ae4e13d80dac"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac">timer_set_ctl</a> (struct arch_timer_context *ctxt, u32 ctl)</td></tr>
<tr class="separator:a2e57f3714ec062699e29ae4e13d80dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab50c2af796cc5134fa3942c857dd4fb7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7">timer_set_cval</a> (struct arch_timer_context *ctxt, u64 cval)</td></tr>
<tr class="separator:ab50c2af796cc5134fa3942c857dd4fb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafe1b11938ff5abb30a790c16eb77c77"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#aafe1b11938ff5abb30a790c16eb77c77">timer_set_offset</a> (struct arch_timer_context *ctxt, u64 offset)</td></tr>
<tr class="separator:aafe1b11938ff5abb30a790c16eb77c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f7917175f1d6031a77dcbc82f9ee98"><td class="memItemLeft" align="right" valign="top">u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98">kvm_phys_timer_read</a> (void)</td></tr>
<tr class="separator:ac9f7917175f1d6031a77dcbc82f9ee98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7e756ea5077e85e2a10bfe35543ce21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21">get_timer_map</a> (struct kvm_vcpu *vcpu, struct timer_map *map)</td></tr>
<tr class="separator:ad7e756ea5077e85e2a10bfe35543ce21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f7db088b5aab3a8a6013b7f6fd12fa0"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0">userspace_irqchip</a> (struct kvm *kvm)</td></tr>
<tr class="separator:a4f7db088b5aab3a8a6013b7f6fd12fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00de950346bea7137e0f06522d67ab2b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a00de950346bea7137e0f06522d67ab2b">soft_timer_start</a> (struct hrtimer *hrt, u64 ns)</td></tr>
<tr class="separator:a00de950346bea7137e0f06522d67ab2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad19b9cbace853dd534bf572a35f83710"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710">soft_timer_cancel</a> (struct hrtimer *hrt)</td></tr>
<tr class="separator:ad19b9cbace853dd534bf572a35f83710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d59bcd17bdbce3017dbc041cd6e9629"><td class="memItemLeft" align="right" valign="top">static irqreturn_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629">kvm_arch_timer_handler</a> (int irq, void *dev_id)</td></tr>
<tr class="separator:a7d59bcd17bdbce3017dbc041cd6e9629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c290bf8212ea1388cdb4a839eae7228"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228">kvm_counter_compute_delta</a> (struct arch_timer_context *timer_ctx, u64 val)</td></tr>
<tr class="separator:a6c290bf8212ea1388cdb4a839eae7228"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed64583773b01dafc949df326d17db3"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3">kvm_timer_compute_delta</a> (struct arch_timer_context *timer_ctx)</td></tr>
<tr class="separator:aeed64583773b01dafc949df326d17db3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad210f5f7b0361777290f8b36f023a518"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518">vcpu_has_wfit_active</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad210f5f7b0361777290f8b36f023a518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d0120f96e99b20be8023dad5c6a7f0b"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b">wfit_delay_ns</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a9d0120f96e99b20be8023dad5c6a7f0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe9b97af2fe25eb9d48e231bba23fcf"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#adbe9b97af2fe25eb9d48e231bba23fcf">kvm_timer_earliest_exp</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:adbe9b97af2fe25eb9d48e231bba23fcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5109f58e0ef877d3f053d0593359c1e"><td class="memItemLeft" align="right" valign="top">static enum hrtimer_restart&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e">kvm_bg_timer_expire</a> (struct hrtimer *hrt)</td></tr>
<tr class="separator:aa5109f58e0ef877d3f053d0593359c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc4d9a1d61348137665ab9a6b18cfa5b"><td class="memItemLeft" align="right" valign="top">static enum hrtimer_restart&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#abc4d9a1d61348137665ab9a6b18cfa5b">kvm_hrtimer_expire</a> (struct hrtimer *hrt)</td></tr>
<tr class="separator:abc4d9a1d61348137665ab9a6b18cfa5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78e23e83bece8c269268f3a263fbb114"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a78e23e83bece8c269268f3a263fbb114">kvm_cpu_has_pending_timer</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a78e23e83bece8c269268f3a263fbb114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a629de40452a9be84148e3c8442a80db6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a629de40452a9be84148e3c8442a80db6">kvm_timer_update_run</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a629de40452a9be84148e3c8442a80db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea899fae895cedf39458ed51af3cb1a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a">timer_emulate</a> (struct arch_timer_context *ctx)</td></tr>
<tr class="separator:acea899fae895cedf39458ed51af3cb1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a207ce56a4fe08e050e49e49334548e15"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a207ce56a4fe08e050e49e49334548e15">set_cntvoff</a> (u64 cntvoff)</td></tr>
<tr class="separator:a207ce56a4fe08e050e49e49334548e15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fcfce8307e73b5ae888edca334508aa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a6fcfce8307e73b5ae888edca334508aa">set_cntpoff</a> (u64 cntpoff)</td></tr>
<tr class="separator:a6fcfce8307e73b5ae888edca334508aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08b7dad9cb511eeaec5ab08e2a2ae1af"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af">timer_save_state</a> (struct arch_timer_context *ctx)</td></tr>
<tr class="separator:a08b7dad9cb511eeaec5ab08e2a2ae1af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0abce4d3df0f10be896c5ff0cb489041"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041">kvm_timer_blocking</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a0abce4d3df0f10be896c5ff0cb489041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabed21346a0fc6b04d9fc11ee754d19a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#aabed21346a0fc6b04d9fc11ee754d19a">kvm_timer_unblocking</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aabed21346a0fc6b04d9fc11ee754d19a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e1e1c3a85e2d375519e32f57a54e301"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301">timer_restore_state</a> (struct arch_timer_context *ctx)</td></tr>
<tr class="separator:a7e1e1c3a85e2d375519e32f57a54e301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae906d98d68ae56770507afe2e63ade68"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ae906d98d68ae56770507afe2e63ade68">set_timer_irq_phys_active</a> (struct arch_timer_context *ctx, bool active)</td></tr>
<tr class="separator:ae906d98d68ae56770507afe2e63ade68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c4f03de391e27f5ba91d10b6dfab0bf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf">kvm_timer_vcpu_load_gic</a> (struct arch_timer_context *ctx)</td></tr>
<tr class="separator:a1c4f03de391e27f5ba91d10b6dfab0bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fb06d125602c5b00fa9c213aa7e2520"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520">kvm_timer_vcpu_load_nogic</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a8fb06d125602c5b00fa9c213aa7e2520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f34b892b5c9b1e79065006b4353c76e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a9f34b892b5c9b1e79065006b4353c76e">kvm_timer_vcpu_load_nested_switch</a> (struct kvm_vcpu *vcpu, struct timer_map *map)</td></tr>
<tr class="separator:a9f34b892b5c9b1e79065006b4353c76e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19caca81734fff66363042c1e8e2181"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#af19caca81734fff66363042c1e8e2181">timer_set_traps</a> (struct kvm_vcpu *vcpu, struct timer_map *map)</td></tr>
<tr class="separator:af19caca81734fff66363042c1e8e2181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bf6ac76380146820b45b06feb3eab27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27">kvm_timer_vcpu_load</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a4bf6ac76380146820b45b06feb3eab27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939939efd4c7eb8c054ca12e04623358"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a939939efd4c7eb8c054ca12e04623358">kvm_timer_should_notify_user</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a939939efd4c7eb8c054ca12e04623358"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0006e1b52ff819dd99be6dca260e52d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6">kvm_timer_vcpu_put</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a0006e1b52ff819dd99be6dca260e52d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7af96c32754607120bf365569aac71c0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0">unmask_vtimer_irq_user</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a7af96c32754607120bf365569aac71c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ae73bff466fcdc60319f9726d53b571"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571">kvm_timer_sync_user</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a6ae73bff466fcdc60319f9726d53b571"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11b9b6e6338bbec6085332661c934e91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a11b9b6e6338bbec6085332661c934e91">kvm_timer_vcpu_reset</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a11b9b6e6338bbec6085332661c934e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a277ad23da04b884fe1d588984e372943"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a277ad23da04b884fe1d588984e372943">timer_context_init</a> (struct kvm_vcpu *vcpu, int timerid)</td></tr>
<tr class="separator:a277ad23da04b884fe1d588984e372943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7dc50f59c235841d864ef598f814247"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247">kvm_timer_vcpu_init</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ab7dc50f59c235841d864ef598f814247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b851d39d19bcc70062d97e0a24e1290"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a7b851d39d19bcc70062d97e0a24e1290">kvm_timer_init_vm</a> (struct kvm *kvm)</td></tr>
<tr class="separator:a7b851d39d19bcc70062d97e0a24e1290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35495530036f43da928b82e7a1ffee34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a35495530036f43da928b82e7a1ffee34">kvm_timer_cpu_up</a> (void)</td></tr>
<tr class="separator:a35495530036f43da928b82e7a1ffee34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a993c30c61801fad7f3e557bcacbc8638"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a993c30c61801fad7f3e557bcacbc8638">kvm_timer_cpu_down</a> (void)</td></tr>
<tr class="separator:a993c30c61801fad7f3e557bcacbc8638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaab6e45ec6d5188b23d96695db532140"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#aaab6e45ec6d5188b23d96695db532140">kvm_arm_timer_set_reg</a> (struct kvm_vcpu *vcpu, u64 regid, u64 value)</td></tr>
<tr class="separator:aaab6e45ec6d5188b23d96695db532140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fb3bc59ad8d869dc692674f2db4bfe9"><td class="memItemLeft" align="right" valign="top">static u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9">read_timer_ctl</a> (struct arch_timer_context *timer)</td></tr>
<tr class="separator:a2fb3bc59ad8d869dc692674f2db4bfe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa832b704b06a4b6109f7f3a71f6755cc"><td class="memItemLeft" align="right" valign="top">u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc">kvm_arm_timer_get_reg</a> (struct kvm_vcpu *vcpu, u64 regid)</td></tr>
<tr class="separator:aa832b704b06a4b6109f7f3a71f6755cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b6d62f10023e1b1effbf51b28d46d3c"><td class="memItemLeft" align="right" valign="top">u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c">kvm_arm_timer_read_sysreg</a> (struct kvm_vcpu *vcpu, enum kvm_arch_timers tmr, enum kvm_arch_timer_regs treg)</td></tr>
<tr class="separator:a4b6d62f10023e1b1effbf51b28d46d3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0209ad4256c7a1fd5ea70b6abe030954"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954">kvm_arm_timer_write_sysreg</a> (struct kvm_vcpu *vcpu, enum kvm_arch_timers tmr, enum kvm_arch_timer_regs treg, u64 val)</td></tr>
<tr class="separator:a0209ad4256c7a1fd5ea70b6abe030954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b276b958e6b737660bc24559f657468"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a8b276b958e6b737660bc24559f657468">timer_irq_set_vcpu_affinity</a> (struct irq_data *d, void *vcpu)</td></tr>
<tr class="separator:a8b276b958e6b737660bc24559f657468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40c01efaf9201aebf595f9123e46fcc7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a40c01efaf9201aebf595f9123e46fcc7">timer_irq_set_irqchip_state</a> (struct irq_data *d, enum irqchip_irq_state which, bool val)</td></tr>
<tr class="separator:a40c01efaf9201aebf595f9123e46fcc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f3e6a118389a4e8a5a4aa1bb62c2fb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#af5f3e6a118389a4e8a5a4aa1bb62c2fb">timer_irq_eoi</a> (struct irq_data *d)</td></tr>
<tr class="separator:af5f3e6a118389a4e8a5a4aa1bb62c2fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a819b2da5a7c1a98ae423f604167c48d5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a819b2da5a7c1a98ae423f604167c48d5">timer_irq_ack</a> (struct irq_data *d)</td></tr>
<tr class="separator:a819b2da5a7c1a98ae423f604167c48d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bfbd5fe414719c1e7b6b39ffc7d82c8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a6bfbd5fe414719c1e7b6b39ffc7d82c8">timer_irq_domain_alloc</a> (struct irq_domain *domain, unsigned int virq, unsigned int nr_irqs, void *arg)</td></tr>
<tr class="separator:a6bfbd5fe414719c1e7b6b39ffc7d82c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3215639ad183676bc549f2d755f645b9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a3215639ad183676bc549f2d755f645b9">timer_irq_domain_free</a> (struct irq_domain *domain, unsigned int virq, unsigned int nr_irqs)</td></tr>
<tr class="separator:a3215639ad183676bc549f2d755f645b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ca26b238c7b7ccc9f231451e3b44f0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a93ca26b238c7b7ccc9f231451e3b44f0">kvm_irq_fixup_flags</a> (unsigned int virq, u32 *flags)</td></tr>
<tr class="separator:a93ca26b238c7b7ccc9f231451e3b44f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a167e7a9fc4c0e10e12bec622f676e31b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a167e7a9fc4c0e10e12bec622f676e31b">kvm_irq_init</a> (struct arch_timer_kvm_info *info)</td></tr>
<tr class="separator:a167e7a9fc4c0e10e12bec622f676e31b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27c9feb35e6d7126c054c3325fea59b0"><td class="memItemLeft" align="right" valign="top">int __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0">kvm_timer_hyp_init</a> (bool has_gic)</td></tr>
<tr class="separator:a27c9feb35e6d7126c054c3325fea59b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1910c992141ccc5e0753c9440f66292e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a1910c992141ccc5e0753c9440f66292e">kvm_timer_vcpu_terminate</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a1910c992141ccc5e0753c9440f66292e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a37a6f350a857f42fe872aeebc8e2e4"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a7a37a6f350a857f42fe872aeebc8e2e4">timer_irqs_are_valid</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a7a37a6f350a857f42fe872aeebc8e2e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eb7255c40d5b43938e99918b3d9d06a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a6eb7255c40d5b43938e99918b3d9d06a">kvm_timer_enable</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a6eb7255c40d5b43938e99918b3d9d06a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa42ee7f3aa49455d33441110cea315fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#aa42ee7f3aa49455d33441110cea315fa">kvm_timer_init_vhe</a> (void)</td></tr>
<tr class="separator:aa42ee7f3aa49455d33441110cea315fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a143f4cabe1f682a6cfc888d54d85a1ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a143f4cabe1f682a6cfc888d54d85a1ae">kvm_arm_timer_set_attr</a> (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)</td></tr>
<tr class="separator:a143f4cabe1f682a6cfc888d54d85a1ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a653a586574104ddc469f6d4048ac214b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a653a586574104ddc469f6d4048ac214b">kvm_arm_timer_get_attr</a> (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)</td></tr>
<tr class="separator:a653a586574104ddc469f6d4048ac214b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0d336ce012b8bbb60c3acc93fa7db2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#af0d336ce012b8bbb60c3acc93fa7db2c">kvm_arm_timer_has_attr</a> (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)</td></tr>
<tr class="separator:af0d336ce012b8bbb60c3acc93fa7db2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a971e3b70c1ab3b3d6eab6188d8734cc2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a971e3b70c1ab3b3d6eab6188d8734cc2">kvm_vm_ioctl_set_counter_offset</a> (struct kvm *kvm, struct kvm_arm_counter_offset *offset)</td></tr>
<tr class="separator:a971e3b70c1ab3b3d6eab6188d8734cc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a35098fc91b751950a191213b1c2e5853"><td class="memItemLeft" align="right" valign="top">static struct timecounter *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a35098fc91b751950a191213b1c2e5853">timecounter</a></td></tr>
<tr class="separator:a35098fc91b751950a191213b1c2e5853"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1df41cdaba1d42a2fd8a5b75c763f16"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a></td></tr>
<tr class="separator:af1df41cdaba1d42a2fd8a5b75c763f16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d4a341dfd2af12f6b5b19bfde475c1"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a></td></tr>
<tr class="separator:a20d4a341dfd2af12f6b5b19bfde475c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0df8fd11369dad2ecb88bca05586a2a"><td class="memItemLeft" align="right" valign="top">static u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ad0df8fd11369dad2ecb88bca05586a2a">host_vtimer_irq_flags</a></td></tr>
<tr class="separator:ad0df8fd11369dad2ecb88bca05586a2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade5cd660147808f96da12823ae71454a"><td class="memItemLeft" align="right" valign="top">static u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ade5cd660147808f96da12823ae71454a">host_ptimer_irq_flags</a></td></tr>
<tr class="separator:ade5cd660147808f96da12823ae71454a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f0fe0305f0fed5e43fa92387f3de4b3"><td class="memItemLeft" align="right" valign="top">static const u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a2f0fe0305f0fed5e43fa92387f3de4b3">default_ppi</a> []</td></tr>
<tr class="separator:a2f0fe0305f0fed5e43fa92387f3de4b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ea143fc77aa4520f032211fd9487ae5"><td class="memItemLeft" align="right" valign="top">static struct irq_ops&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#a3ea143fc77aa4520f032211fd9487ae5">arch_timer_irq_ops</a></td></tr>
<tr class="separator:a3ea143fc77aa4520f032211fd9487ae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad045572494d147b468245ef231e4d69b"><td class="memItemLeft" align="right" valign="top">static struct irq_chip&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ad045572494d147b468245ef231e4d69b">timer_chip</a></td></tr>
<tr class="separator:ad045572494d147b468245ef231e4d69b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4e307d79fe80f37b11012a68ed27295"><td class="memItemLeft" align="right" valign="top">static const struct irq_domain_ops&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch__timer_8c.html#ae4e307d79fe80f37b11012a68ed27295">timer_domain_ops</a></td></tr>
<tr class="separator:ae4e307d79fe80f37b11012a68ed27295"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aea983e592b69df371a4501567756dbe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea983e592b69df371a4501567756dbe4">&#9670;&nbsp;</a></span>assign_clear_set_bit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define assign_clear_set_bit</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_pred, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_bit, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_clr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_set&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keywordflow">do</span> {                                \</div>
<div class="line">        if (_pred)                      \</div>
<div class="line">            (_set) |= (_bit);               \</div>
<div class="line">        else                            \</div>
<div class="line">            (_clr) |= (_bit);               \</div>
<div class="line">    } <span class="keywordflow">while</span> (0)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00705">705</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6456a80f41d0f4b7af21e135c96e649f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6456a80f41d0f4b7af21e135c96e649f">&#9670;&nbsp;</a></span>DEFINE_STATIC_KEY_FALSE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static DEFINE_STATIC_KEY_FALSE </td>
          <td>(</td>
          <td class="paramtype">has_gic_active_state&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad7e756ea5077e85e2a10bfe35543ce21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7e756ea5077e85e2a10bfe35543ce21">&#9670;&nbsp;</a></span>get_timer_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_timer_map </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timer_map *&#160;</td>
          <td class="paramname"><em>map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00178">178</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (vcpu_has_nv(vcpu)) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">if</span> (is_hyp_ctxt(vcpu)) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            map-&gt;direct_vtimer = vcpu_hvtimer(vcpu);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            map-&gt;direct_ptimer = vcpu_hptimer(vcpu);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            map-&gt;emul_vtimer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            map-&gt;emul_ptimer = vcpu_ptimer(vcpu);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            map-&gt;direct_vtimer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            map-&gt;direct_ptimer = vcpu_ptimer(vcpu);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            map-&gt;emul_vtimer = vcpu_hvtimer(vcpu);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            map-&gt;emul_ptimer = vcpu_hptimer(vcpu);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (has_vhe()) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        map-&gt;direct_vtimer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        map-&gt;direct_ptimer = vcpu_ptimer(vcpu);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        map-&gt;emul_vtimer = NULL;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        map-&gt;emul_ptimer = NULL;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        map-&gt;direct_vtimer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        map-&gt;direct_ptimer = NULL;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        map-&gt;emul_vtimer = NULL;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        map-&gt;emul_ptimer = vcpu_ptimer(vcpu);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    trace_kvm_get_timer_map(vcpu-&gt;vcpu_id, map);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ad7e756ea5077e85e2a10bfe35543ce21_icgraph.png" border="0" usemap="#aarch__timer_8c_ad7e756ea5077e85e2a10bfe35543ce21_icgraph" alt=""/></div>
<map name="aarch__timer_8c_ad7e756ea5077e85e2a10bfe35543ce21_icgraph" id="aarch__timer_8c_ad7e756ea5077e85e2a10bfe35543ce21_icgraph">
<area shape="rect" title=" " alt="" coords="1985,385,2107,412"/>
<area shape="rect" href="vhe_2switch_8c.html#a13dbdaa438ac9e00d7e17a2bd5acc5cf" title=" " alt="" coords="1781,81,1910,108"/>
<area shape="rect" href="vhe_2switch_8c.html#ae0a32b92b674eb6922cbfab5f8d22daf" title=" " alt="" coords="1773,132,1918,159"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1753,259,1937,285"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1764,574,1927,615"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1762,653,1929,694"/>
<area shape="rect" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041" title=" " alt="" coords="1768,411,1923,437"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1543,360,1701,387"/>
<area shape="rect" href="arch__timer_8c.html#a6eb7255c40d5b43938e99918b3d9d06a" title=" " alt="" coords="1773,516,1917,543"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1539,309,1705,336"/>
<area shape="rect" href="arch__timer_8c.html#a11b9b6e6338bbec6085332661c934e91" title=" " alt="" coords="1320,461,1491,488"/>
<area shape="rect" href="vhe_2switch_8c.html#a1e6833f85cd789386b1d4bd05759903d" title=" " alt="" coords="1541,81,1703,108"/>
<area shape="rect" href="vhe_2switch_8c.html#af2f5ac35e771dfefeec346aaa6a850fa" title=" " alt="" coords="1340,5,1471,32"/>
<area shape="rect" href="vhe_2switch_8c.html#a2c3f13ae3d0d6c0cee03845c35c31da8" title=" " alt="" coords="1556,132,1688,159"/>
<area shape="rect" href="vhe_2switch_8c.html#a4253f73e8ba22b83245789d214c4a8ef" title=" " alt="" coords="1361,56,1449,83"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="1546,259,1698,285"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="873,107,1001,133"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="648,132,760,159"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1551,664,1693,691"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1329,360,1481,387"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="1076,309,1272,336"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1101,360,1247,387"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1109,461,1239,488"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1112,259,1236,285"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="896,360,977,387"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="637,208,771,235"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="845,259,1028,285"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="617,259,791,285"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="656,309,752,336"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="657,360,751,387"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="404,259,563,285"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="849,512,1025,539"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="623,504,785,531"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="187,529,346,556"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="856,411,1017,437"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="404,497,563,538"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,529,129,556"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="611,411,797,437"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="897,157,976,184"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="177,593,356,634"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1326,309,1485,336"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1117,157,1231,184"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1130,208,1218,235"/>
</map>
</div>

</div>
</div>
<a id="a25b09c8d95a2582f37a1a2719920e59c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25b09c8d95a2582f37a1a2719920e59c">&#9670;&nbsp;</a></span>kvm_arch_timer_get_input_level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool kvm_arch_timer_get_input_level </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vintid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01485">1485</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;{</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = <a class="code" href="kvm__main_8c.html#ac5a3afd8e2d8d1139dc7711c4b9e07e3">kvm_get_running_vcpu</a>();</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160; </div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordflow">if</span> (WARN(!vcpu, <span class="stringliteral">&quot;No vcpu context!\n&quot;</span>))</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913">nr_timers</a>(vcpu); i++) {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <span class="keyword">struct </span>arch_timer_context *ctx;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        ctx = vcpu_get_timer(vcpu, i);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="keywordflow">if</span> (timer_irq(ctx) == vintid)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a>(ctx);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">/* A timer IRQ has fired, but no matching timer was found? */</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    WARN_RATELIMIT(1, <span class="stringliteral">&quot;timer INTID%d unknown\n&quot;</span>, vintid);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a64a4d2f3d2a9b83524edda4b27246092"><div class="ttname"><a href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a></div><div class="ttdeci">static bool kvm_timer_should_fire(struct arch_timer_context *timer_ctx)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00380">arch_timer.c:380</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_ad2a704b646b65309708c3a7f6ab70913"><div class="ttname"><a href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913">nr_timers</a></div><div class="ttdeci">static int nr_timers(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00058">arch_timer.c:58</a></div></div>
<div class="ttc" id="akvm__main_8c_html_ac5a3afd8e2d8d1139dc7711c4b9e07e3"><div class="ttname"><a href="kvm__main_8c.html#ac5a3afd8e2d8d1139dc7711c4b9e07e3">kvm_get_running_vcpu</a></div><div class="ttdeci">struct kvm_vcpu * kvm_get_running_vcpu(void)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l06338">kvm_main.c:6338</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a25b09c8d95a2582f37a1a2719920e59c_cgraph.png" border="0" usemap="#aarch__timer_8c_a25b09c8d95a2582f37a1a2719920e59c_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a25b09c8d95a2582f37a1a2719920e59c_cgraph" id="aarch__timer_8c_a25b09c8d95a2582f37a1a2719920e59c_cgraph">
<area shape="rect" title=" " alt="" coords="5,74,161,115"/>
<area shape="rect" href="kvm__main_8c.html#ac5a3afd8e2d8d1139dc7711c4b9e07e3" title=" " alt="" coords="209,31,383,57"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="211,81,381,108"/>
<area shape="rect" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913" title=" " alt="" coords="254,132,338,159"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="435,5,601,32"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="431,56,605,83"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="459,107,577,133"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="453,157,583,184"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="653,56,761,83"/>
</map>
</div>

</div>
</div>
<a id="a7d59bcd17bdbce3017dbc041cd6e9629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d59bcd17bdbce3017dbc041cd6e9629">&#9670;&nbsp;</a></span>kvm_arch_timer_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static irqreturn_t kvm_arch_timer_handler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>irq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>dev_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00224">224</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = *(<span class="keyword">struct </span>kvm_vcpu **)dev_id;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">struct </span>arch_timer_context *ctx;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keyword">struct </span>timer_map map;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">     * We may see a timer interrupt after vcpu_put() has been called which</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">     * sets the CPU&#39;s vcpu pointer to NULL, because even though the timer</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">     * has been disabled in timer_save_state(), the hardware interrupt</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">     * signal may not have been retired from the interrupt controller yet.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (!vcpu)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">return</span> IRQ_HANDLED;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21">get_timer_map</a>(vcpu, &amp;map);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (irq == <a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        ctx = map.direct_vtimer;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        ctx = map.direct_ptimer;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a>(ctx))</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f">kvm_timer_update_irq</a>(vcpu, <span class="keyword">true</span>, ctx);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0">userspace_irqchip</a>(vcpu-&gt;kvm) &amp;&amp;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        !static_branch_unlikely(&amp;has_gic_active_state))</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        disable_percpu_irq(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">return</span> IRQ_HANDLED;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a4f7db088b5aab3a8a6013b7f6fd12fa0"><div class="ttname"><a href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0">userspace_irqchip</a></div><div class="ttdeci">static bool userspace_irqchip(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00207">arch_timer.c:207</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a5abc04b494763cd0814855753e56671f"><div class="ttname"><a href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f">kvm_timer_update_irq</a></div><div class="ttdeci">static void kvm_timer_update_irq(struct kvm_vcpu *vcpu, bool new_level, struct arch_timer_context *timer_ctx)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00445">arch_timer.c:445</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_ad7e756ea5077e85e2a10bfe35543ce21"><div class="ttname"><a href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21">get_timer_map</a></div><div class="ttdeci">void get_timer_map(struct kvm_vcpu *vcpu, struct timer_map *map)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00178">arch_timer.c:178</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_af1df41cdaba1d42a2fd8a5b75c763f16"><div class="ttname"><a href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a></div><div class="ttdeci">static unsigned int host_vtimer_irq</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00027">arch_timer.c:27</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a7d59bcd17bdbce3017dbc041cd6e9629_cgraph.png" border="0" usemap="#aarch__timer_8c_a7d59bcd17bdbce3017dbc041cd6e9629_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a7d59bcd17bdbce3017dbc041cd6e9629_cgraph" id="aarch__timer_8c_a7d59bcd17bdbce3017dbc041cd6e9629_cgraph">
<area shape="rect" title=" " alt="" coords="5,416,189,443"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="262,315,383,341"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="237,365,408,392"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="238,441,407,468"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="474,492,613,519"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="460,340,627,367"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="456,391,631,417"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="484,239,603,265"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="479,289,608,316"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="711,289,819,316"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="467,441,619,468"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="714,391,815,417"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="709,441,820,468"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="2621,608,2723,635"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="2587,440,2757,467"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="679,340,851,367"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1745,5,1845,32"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="2819,205,2954,232"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="899,267,976,293"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1043,391,1187,417"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1024,325,1205,366"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="2621,221,2723,248"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="1027,157,1202,184"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1053,208,1177,235"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1040,259,1189,301"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1697,131,1892,157"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="1065,441,1165,468"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1267,332,1422,359"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="1484,307,1649,333"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1491,357,1643,384"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1709,357,1881,384"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="1979,292,2089,319"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="1965,380,2103,407"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="2176,237,2323,264"/>
<area shape="rect" href="vgic-its_8c.html#a53bf66e96dae9553e637fa69e8835365" title=" " alt="" coords="2176,364,2323,391"/>
<area shape="rect" href="vgic-its_8c.html#a352c8627ccf81a8154ae2275c7d50659" title=" " alt="" coords="2371,491,2539,533"/>
<area shape="rect" href="vgic-its_8c.html#ad62375be0591178764e98b79cd7217bf" title=" " alt="" coords="2378,389,2531,416"/>
<area shape="rect" href="vgic-its_8c.html#a94bbb30efc49ad5494a7f4b1410dbe01" title=" " alt="" coords="2393,339,2516,365"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="2805,608,2968,635"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="3056,608,3184,635"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="2825,524,2948,551"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="2815,440,2958,467"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="3016,499,3224,525"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="3043,549,3197,576"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="3062,440,3178,467"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1283,208,1406,235"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1283,157,1406,184"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="1253,441,1436,468"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="1275,391,1415,417"/>
<area shape="rect" href="vgic-v4_8c.html#ac22161596c9858cc700bab08c03fc422" title=" " alt="" coords="1940,453,2128,480"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a7d59bcd17bdbce3017dbc041cd6e9629_icgraph.png" border="0" usemap="#aarch__timer_8c_a7d59bcd17bdbce3017dbc041cd6e9629_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a7d59bcd17bdbce3017dbc041cd6e9629_icgraph" id="aarch__timer_8c_a7d59bcd17bdbce3017dbc041cd6e9629_icgraph">
<area shape="rect" title=" " alt="" coords="541,5,725,32"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="341,5,493,32"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="165,5,293,32"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="5,5,117,32"/>
</map>
</div>

</div>
</div>
<a id="a653a586574104ddc469f6d4048ac214b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a653a586574104ddc469f6d4048ac214b">&#9670;&nbsp;</a></span>kvm_arm_timer_get_attr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_arm_timer_get_attr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_device_attr *&#160;</td>
          <td class="paramname"><em>attr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01611">1611</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;{</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="keywordtype">int</span> __user *uaddr = (<span class="keywordtype">int</span> __user *)(<span class="keywordtype">long</span>)attr-&gt;addr;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="keyword">struct </span>arch_timer_context *timer;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="keywordtype">int</span> irq;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">switch</span> (attr-&gt;attr) {</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_VTIMER:</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        timer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_PTIMER:</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        timer = vcpu_ptimer(vcpu);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_HVTIMER:</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        timer = vcpu_hvtimer(vcpu);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_HPTIMER:</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        timer = vcpu_hptimer(vcpu);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        <span class="keywordflow">return</span> -ENXIO;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    irq = timer_irq(timer);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordflow">return</span> put_user(irq, uaddr);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a653a586574104ddc469f6d4048ac214b_icgraph.png" border="0" usemap="#aarch__timer_8c_a653a586574104ddc469f6d4048ac214b_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a653a586574104ddc469f6d4048ac214b_icgraph" id="aarch__timer_8c_a653a586574104ddc469f6d4048ac214b_icgraph">
<area shape="rect" title=" " alt="" coords="875,5,1059,32"/>
<area shape="rect" href="guest_8c.html#aa99fc533fb03ffbdc691ecf41ef0ee78" title=" " alt="" coords="612,5,827,32"/>
<area shape="rect" href="arm_8c.html#ac4516032589fef2e518e9ac17c4cc850" title=" " alt="" coords="384,5,564,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,5,336,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="aa832b704b06a4b6109f7f3a71f6755cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa832b704b06a4b6109f7f3a71f6755cc">&#9670;&nbsp;</a></span>kvm_arm_timer_get_reg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u64 kvm_arm_timer_get_reg </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>regid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01107">1107</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;{</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">switch</span> (regid) {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_TIMER_CTL:</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894">kvm_arm_timer_read</a>(vcpu,</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                      vcpu_vtimer(vcpu), TIMER_REG_CTL);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_TIMER_CNT:</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894">kvm_arm_timer_read</a>(vcpu,</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                      vcpu_vtimer(vcpu), TIMER_REG_CNT);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_TIMER_CVAL:</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894">kvm_arm_timer_read</a>(vcpu,</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                      vcpu_vtimer(vcpu), TIMER_REG_CVAL);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_PTIMER_CTL:</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894">kvm_arm_timer_read</a>(vcpu,</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                      vcpu_ptimer(vcpu), TIMER_REG_CTL);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_PTIMER_CNT:</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894">kvm_arm_timer_read</a>(vcpu,</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                      vcpu_ptimer(vcpu), TIMER_REG_CNT);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_PTIMER_CVAL:</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894">kvm_arm_timer_read</a>(vcpu,</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                      vcpu_ptimer(vcpu), TIMER_REG_CVAL);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordflow">return</span> (u64)-1;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a3873c5e4f0eb8a0fa2a466d8e2b9a894"><div class="ttname"><a href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894">kvm_arm_timer_read</a></div><div class="ttdeci">static u64 kvm_arm_timer_read(struct kvm_vcpu *vcpu, struct arch_timer_context *timer, enum kvm_arch_timer_regs treg)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01132">arch_timer.c:1132</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aa832b704b06a4b6109f7f3a71f6755cc_cgraph.png" border="0" usemap="#aarch__timer_8c_aa832b704b06a4b6109f7f3a71f6755cc_cgraph" alt=""/></div>
<map name="aarch__timer_8c_aa832b704b06a4b6109f7f3a71f6755cc_cgraph" id="aarch__timer_8c_aa832b704b06a4b6109f7f3a71f6755cc_cgraph">
<area shape="rect" title=" " alt="" coords="5,105,188,132"/>
<area shape="rect" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894" title=" " alt="" coords="236,105,399,132"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="1075,32,1241,58"/>
<area shape="rect" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9" title=" " alt="" coords="447,80,563,106"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="1093,112,1223,138"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="882,130,1001,157"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="611,80,808,106"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="655,29,763,56"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="856,64,1027,106"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aa832b704b06a4b6109f7f3a71f6755cc_icgraph.png" border="0" usemap="#aarch__timer_8c_aa832b704b06a4b6109f7f3a71f6755cc_icgraph" alt=""/></div>
<map name="aarch__timer_8c_aa832b704b06a4b6109f7f3a71f6755cc_icgraph" id="aarch__timer_8c_aa832b704b06a4b6109f7f3a71f6755cc_icgraph">
<area shape="rect" title=" " alt="" coords="753,31,936,57"/>
<area shape="rect" href="guest_8c.html#a91e885a78ebf3a7c410b4b8ffa443729" title=" " alt="" coords="582,5,695,32"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="572,56,705,83"/>
<area shape="rect" href="guest_8c.html#ad1a71190592cc60155333934b84d1d11" title=" " alt="" coords="384,5,524,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,5,336,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="af0d336ce012b8bbb60c3acc93fa7db2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0d336ce012b8bbb60c3acc93fa7db2c">&#9670;&nbsp;</a></span>kvm_arm_timer_has_attr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_arm_timer_has_attr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_device_attr *&#160;</td>
          <td class="paramname"><em>attr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01638">1638</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;{</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordflow">switch</span> (attr-&gt;attr) {</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_VTIMER:</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_PTIMER:</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_HVTIMER:</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_HPTIMER:</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    }</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160; </div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordflow">return</span> -ENXIO;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_af0d336ce012b8bbb60c3acc93fa7db2c_icgraph.png" border="0" usemap="#aarch__timer_8c_af0d336ce012b8bbb60c3acc93fa7db2c_icgraph" alt=""/></div>
<map name="aarch__timer_8c_af0d336ce012b8bbb60c3acc93fa7db2c_icgraph" id="aarch__timer_8c_af0d336ce012b8bbb60c3acc93fa7db2c_icgraph">
<area shape="rect" title=" " alt="" coords="880,5,1067,32"/>
<area shape="rect" href="guest_8c.html#a433aea1c6b1de56454d83bdfffea5244" title=" " alt="" coords="615,5,832,32"/>
<area shape="rect" href="arm_8c.html#a0c30ed81235d5fe106242b7be1863342" title=" " alt="" coords="384,5,567,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,5,336,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a3873c5e4f0eb8a0fa2a466d8e2b9a894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3873c5e4f0eb8a0fa2a466d8e2b9a894">&#9670;&nbsp;</a></span>kvm_arm_timer_read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 kvm_arm_timer_read </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>timer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum kvm_arch_timer_regs&#160;</td>
          <td class="paramname"><em>treg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01132">1132</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;{</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    u64 val;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">switch</span> (treg) {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">case</span> TIMER_REG_TVAL:</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        val = <a class="code" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd">timer_get_cval</a>(timer) - <a class="code" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98">kvm_phys_timer_read</a>() + <a class="code" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a>(timer);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        val = lower_32_bits(val);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">case</span> TIMER_REG_CTL:</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        val = <a class="code" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9">read_timer_ctl</a>(timer);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keywordflow">case</span> TIMER_REG_CVAL:</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        val = <a class="code" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd">timer_get_cval</a>(timer);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordflow">case</span> TIMER_REG_CNT:</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        val = <a class="code" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98">kvm_phys_timer_read</a>() - <a class="code" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a>(timer);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">case</span> TIMER_REG_VOFF:</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        val = *timer-&gt;offset.vcpu_offset;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        BUG();</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a2fb3bc59ad8d869dc692674f2db4bfe9"><div class="ttname"><a href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9">read_timer_ctl</a></div><div class="ttdeci">static u64 read_timer_ctl(struct arch_timer_context *timer)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01091">arch_timer.c:1091</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a7f5f777b74b5c9ec6e13d4f7576d7f43"><div class="ttname"><a href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a></div><div class="ttdeci">static u64 timer_get_offset(struct arch_timer_context *ctxt)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00104">arch_timer.c:104</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a848ba80b4ffee7a071e37abb241262cd"><div class="ttname"><a href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd">timer_get_cval</a></div><div class="ttdeci">u64 timer_get_cval(struct arch_timer_context *ctxt)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00085">arch_timer.c:85</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_ac9f7917175f1d6031a77dcbc82f9ee98"><div class="ttname"><a href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98">kvm_phys_timer_read</a></div><div class="ttdeci">u64 kvm_phys_timer_read(void)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00173">arch_timer.c:173</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a3873c5e4f0eb8a0fa2a466d8e2b9a894_cgraph.png" border="0" usemap="#aarch__timer_8c_a3873c5e4f0eb8a0fa2a466d8e2b9a894_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a3873c5e4f0eb8a0fa2a466d8e2b9a894_cgraph" id="aarch__timer_8c_a3873c5e4f0eb8a0fa2a466d8e2b9a894_cgraph">
<area shape="rect" title=" " alt="" coords="5,105,168,132"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="844,32,1011,58"/>
<area shape="rect" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9" title=" " alt="" coords="216,80,332,106"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="863,112,992,138"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="651,130,770,157"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="380,80,577,106"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="425,29,533,56"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="625,64,796,106"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a3873c5e4f0eb8a0fa2a466d8e2b9a894_icgraph.png" border="0" usemap="#aarch__timer_8c_a3873c5e4f0eb8a0fa2a466d8e2b9a894_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a3873c5e4f0eb8a0fa2a466d8e2b9a894_icgraph" id="aarch__timer_8c_a3873c5e4f0eb8a0fa2a466d8e2b9a894_icgraph">
<area shape="rect" title=" " alt="" coords="993,81,1156,108"/>
<area shape="rect" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc" title=" " alt="" coords="763,52,945,79"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="773,103,935,145"/>
<area shape="rect" href="guest_8c.html#a91e885a78ebf3a7c410b4b8ffa443729" title=" " alt="" coords="587,5,700,32"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="577,56,710,83"/>
<area shape="rect" href="guest_8c.html#ad1a71190592cc60155333934b84d1d11" title=" " alt="" coords="384,5,524,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,5,336,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="572,111,715,137"/>
</map>
</div>

</div>
</div>
<a id="a4b6d62f10023e1b1effbf51b28d46d3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b6d62f10023e1b1effbf51b28d46d3c">&#9670;&nbsp;</a></span>kvm_arm_timer_read_sysreg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u64 kvm_arm_timer_read_sysreg </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum kvm_arch_timers&#160;</td>
          <td class="paramname"><em>tmr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum kvm_arch_timer_regs&#160;</td>
          <td class="paramname"><em>treg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01167">1167</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;{</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keyword">struct </span>arch_timer_context *timer;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keyword">struct </span>timer_map map;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    u64 val;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <a class="code" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21">get_timer_map</a>(vcpu, &amp;map);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    timer = vcpu_get_timer(vcpu, tmr);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">if</span> (timer == map.emul_vtimer || timer == map.emul_ptimer)</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894">kvm_arm_timer_read</a>(vcpu, timer, treg);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    preempt_disable();</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <a class="code" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af">timer_save_state</a>(timer);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    val = <a class="code" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894">kvm_arm_timer_read</a>(vcpu, timer, treg);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <a class="code" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301">timer_restore_state</a>(timer);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    preempt_enable();</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a08b7dad9cb511eeaec5ab08e2a2ae1af"><div class="ttname"><a href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af">timer_save_state</a></div><div class="ttdeci">static void timer_save_state(struct arch_timer_context *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00497">arch_timer.c:497</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a7e1e1c3a85e2d375519e32f57a54e301"><div class="ttname"><a href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301">timer_restore_state</a></div><div class="ttdeci">static void timer_restore_state(struct arch_timer_context *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00603">arch_timer.c:603</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a4b6d62f10023e1b1effbf51b28d46d3c_cgraph.png" border="0" usemap="#aarch__timer_8c_a4b6d62f10023e1b1effbf51b28d46d3c_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a4b6d62f10023e1b1effbf51b28d46d3c_cgraph" id="aarch__timer_8c_a4b6d62f10023e1b1effbf51b28d46d3c_cgraph">
<area shape="rect" title=" " alt="" coords="5,189,168,230"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="237,107,358,134"/>
<area shape="rect" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894" title=" " alt="" coords="216,158,379,184"/>
<area shape="rect" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301" title=" " alt="" coords="427,310,577,336"/>
<area shape="rect" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af" title=" " alt="" coords="435,462,569,488"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="1105,111,1272,138"/>
<area shape="rect" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9" title=" " alt="" coords="444,183,560,210"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="1124,212,1253,239"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="905,220,1023,247"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="625,183,823,210"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="670,234,778,260"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="879,154,1049,196"/>
<area shape="rect" href="arch__timer_8c.html#a6fcfce8307e73b5ae888edca334508aa" title=" " alt="" coords="677,386,771,412"/>
<area shape="rect" href="arch__timer_8c.html#a207ce56a4fe08e050e49e49334548e15" title=" " alt="" coords="677,436,771,463"/>
<area shape="rect" href="nvhe_2timer-sr_8c.html#a73539c3eaa37749e44c40351913b9efb" title=" " alt="" coords="871,436,1057,463"/>
<area shape="rect" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac" title=" " alt="" coords="671,538,777,564"/>
<area shape="rect" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7" title=" " alt="" coords="665,588,783,615"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a4b6d62f10023e1b1effbf51b28d46d3c_icgraph.png" border="0" usemap="#aarch__timer_8c_a4b6d62f10023e1b1effbf51b28d46d3c_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a4b6d62f10023e1b1effbf51b28d46d3c_icgraph" id="aarch__timer_8c_a4b6d62f10023e1b1effbf51b28d46d3c_icgraph">
<area shape="rect" title=" " alt="" coords="196,5,359,47"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="5,13,148,39"/>
</map>
</div>

</div>
</div>
<a id="a143f4cabe1f682a6cfc888d54d85a1ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a143f4cabe1f682a6cfc888d54d85a1ae">&#9670;&nbsp;</a></span>kvm_arm_timer_set_attr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_arm_timer_set_attr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_device_attr *&#160;</td>
          <td class="paramname"><em>attr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01559">1559</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;{</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordtype">int</span> __user *uaddr = (<span class="keywordtype">int</span> __user *)(<span class="keywordtype">long</span>)attr-&gt;addr;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="keywordtype">int</span> irq, idx, ret = 0;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordflow">if</span> (!irqchip_in_kernel(vcpu-&gt;kvm))</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160; </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordflow">if</span> (get_user(irq, uaddr))</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="keywordflow">return</span> -EFAULT;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="keywordflow">if</span> (!(irq_is_ppi(irq)))</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    mutex_lock(&amp;vcpu-&gt;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keywordflow">if</span> (test_bit(KVM_ARCH_FLAG_TIMER_PPIS_IMMUTABLE,</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;             &amp;vcpu-&gt;kvm-&gt;arch.flags)) {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        ret = -EBUSY;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">switch</span> (attr-&gt;attr) {</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_VTIMER:</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        idx = TIMER_VTIMER;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_PTIMER:</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        idx = TIMER_PTIMER;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_HVTIMER:</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        idx = TIMER_HVTIMER;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordflow">case</span> KVM_ARM_VCPU_TIMER_IRQ_HPTIMER:</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        idx = TIMER_HPTIMER;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        ret = -ENXIO;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">     * We cannot validate the IRQ unicity before we run, so take it at</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">     * face value. The verdict will be given on first vcpu run, for each</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">     * vcpu. Yes this is late. Blame it on the stupid API.</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    vcpu-&gt;kvm-&gt;arch.timer_data.ppi[idx] = irq;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160; </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;out:</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    mutex_unlock(&amp;vcpu-&gt;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a143f4cabe1f682a6cfc888d54d85a1ae_icgraph.png" border="0" usemap="#aarch__timer_8c_a143f4cabe1f682a6cfc888d54d85a1ae_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a143f4cabe1f682a6cfc888d54d85a1ae_icgraph" id="aarch__timer_8c_a143f4cabe1f682a6cfc888d54d85a1ae_icgraph">
<area shape="rect" title=" " alt="" coords="873,5,1056,32"/>
<area shape="rect" href="guest_8c.html#a932910ec1cc3b5a552da035d4d74a4eb" title=" " alt="" coords="611,5,825,32"/>
<area shape="rect" href="arm_8c.html#adcf63ac6c9c7383fcf0dcb2ce097afbe" title=" " alt="" coords="384,5,563,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,5,336,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="aaab6e45ec6d5188b23d96695db532140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaab6e45ec6d5188b23d96695db532140">&#9670;&nbsp;</a></span>kvm_arm_timer_set_reg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_arm_timer_set_reg </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>regid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01048">1048</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;{</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keyword">struct </span>arch_timer_context *timer;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">switch</span> (regid) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_TIMER_CTL:</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        timer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <a class="code" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771">kvm_arm_timer_write</a>(vcpu, timer, TIMER_REG_CTL, value);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_TIMER_CNT:</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keywordflow">if</span> (!test_bit(KVM_ARCH_FLAG_VM_COUNTER_OFFSET,</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                  &amp;vcpu-&gt;kvm-&gt;arch.flags)) {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            timer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            <a class="code" href="arch__timer_8c.html#aafe1b11938ff5abb30a790c16eb77c77">timer_set_offset</a>(timer, <a class="code" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98">kvm_phys_timer_read</a>() - value);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_TIMER_CVAL:</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        timer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <a class="code" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771">kvm_arm_timer_write</a>(vcpu, timer, TIMER_REG_CVAL, value);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_PTIMER_CTL:</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        timer = vcpu_ptimer(vcpu);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <a class="code" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771">kvm_arm_timer_write</a>(vcpu, timer, TIMER_REG_CTL, value);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_PTIMER_CNT:</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="keywordflow">if</span> (!test_bit(KVM_ARCH_FLAG_VM_COUNTER_OFFSET,</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                  &amp;vcpu-&gt;kvm-&gt;arch.flags)) {</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            timer = vcpu_ptimer(vcpu);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <a class="code" href="arch__timer_8c.html#aafe1b11938ff5abb30a790c16eb77c77">timer_set_offset</a>(timer, <a class="code" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98">kvm_phys_timer_read</a>() - value);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">case</span> KVM_REG_ARM_PTIMER_CVAL:</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        timer = vcpu_ptimer(vcpu);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <a class="code" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771">kvm_arm_timer_write</a>(vcpu, timer, TIMER_REG_CVAL, value);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_aafe1b11938ff5abb30a790c16eb77c77"><div class="ttname"><a href="arch__timer_8c.html#aafe1b11938ff5abb30a790c16eb77c77">timer_set_offset</a></div><div class="ttdeci">static void timer_set_offset(struct arch_timer_context *ctxt, u64 offset)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00163">arch_timer.c:163</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_affb5181064df0b30b53f567189e15771"><div class="ttname"><a href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771">kvm_arm_timer_write</a></div><div class="ttdeci">static void kvm_arm_timer_write(struct kvm_vcpu *vcpu, struct arch_timer_context *timer, enum kvm_arch_timer_regs treg, u64 val)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01192">arch_timer.c:1192</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aaab6e45ec6d5188b23d96695db532140_cgraph.png" border="0" usemap="#aarch__timer_8c_aaab6e45ec6d5188b23d96695db532140_cgraph" alt=""/></div>
<map name="aarch__timer_8c_aaab6e45ec6d5188b23d96695db532140_cgraph" id="aarch__timer_8c_aaab6e45ec6d5188b23d96695db532140_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,187,83"/>
<area shape="rect" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771" title=" " alt="" coords="235,56,401,83"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="449,5,616,32"/>
<area shape="rect" href="arch__timer_8c.html#aafe1b11938ff5abb30a790c16eb77c77" title=" " alt="" coords="254,107,382,133"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="468,56,597,83"/>
<area shape="rect" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac" title=" " alt="" coords="479,107,586,133"/>
<area shape="rect" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7" title=" " alt="" coords="473,157,592,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aaab6e45ec6d5188b23d96695db532140_icgraph.png" border="0" usemap="#aarch__timer_8c_aaab6e45ec6d5188b23d96695db532140_icgraph" alt=""/></div>
<map name="aarch__timer_8c_aaab6e45ec6d5188b23d96695db532140_icgraph" id="aarch__timer_8c_aaab6e45ec6d5188b23d96695db532140_icgraph">
<area shape="rect" title=" " alt="" coords="731,5,912,32"/>
<area shape="rect" href="guest_8c.html#acd7401987c2e84cad89f08207d34bf3f" title=" " alt="" coords="571,5,683,32"/>
<area shape="rect" href="guest_8c.html#a8ee5ced2d0c0d538319888057bc58b4a" title=" " alt="" coords="384,5,523,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,5,336,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="affb5181064df0b30b53f567189e15771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affb5181064df0b30b53f567189e15771">&#9670;&nbsp;</a></span>kvm_arm_timer_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_arm_timer_write </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>timer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum kvm_arch_timer_regs&#160;</td>
          <td class="paramname"><em>treg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01192">1192</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;{</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">switch</span> (treg) {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">case</span> TIMER_REG_TVAL:</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <a class="code" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7">timer_set_cval</a>(timer, <a class="code" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98">kvm_phys_timer_read</a>() - <a class="code" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a>(timer) + (s32)val);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordflow">case</span> TIMER_REG_CTL:</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <a class="code" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac">timer_set_ctl</a>(timer, val &amp; ~ARCH_TIMER_CTRL_IT_STAT);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">case</span> TIMER_REG_CVAL:</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <a class="code" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7">timer_set_cval</a>(timer, val);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">case</span> TIMER_REG_VOFF:</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        *timer-&gt;offset.vcpu_offset = val;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        BUG();</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a2e57f3714ec062699e29ae4e13d80dac"><div class="ttname"><a href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac">timer_set_ctl</a></div><div class="ttdeci">static void timer_set_ctl(struct arch_timer_context *ctxt, u32 ctl)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00119">arch_timer.c:119</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_ab50c2af796cc5134fa3942c857dd4fb7"><div class="ttname"><a href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7">timer_set_cval</a></div><div class="ttdeci">static void timer_set_cval(struct arch_timer_context *ctxt, u64 cval)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00141">arch_timer.c:141</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_affb5181064df0b30b53f567189e15771_cgraph.png" border="0" usemap="#aarch__timer_8c_affb5181064df0b30b53f567189e15771_cgraph" alt=""/></div>
<map name="aarch__timer_8c_affb5181064df0b30b53f567189e15771_cgraph" id="aarch__timer_8c_affb5181064df0b30b53f567189e15771_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,172,108"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="220,5,387,32"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="239,56,368,83"/>
<area shape="rect" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac" title=" " alt="" coords="250,107,357,133"/>
<area shape="rect" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7" title=" " alt="" coords="244,157,363,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_affb5181064df0b30b53f567189e15771_icgraph.png" border="0" usemap="#aarch__timer_8c_affb5181064df0b30b53f567189e15771_icgraph" alt=""/></div>
<map name="aarch__timer_8c_affb5181064df0b30b53f567189e15771_icgraph" id="aarch__timer_8c_affb5181064df0b30b53f567189e15771_icgraph">
<area shape="rect" title=" " alt="" coords="991,35,1157,61"/>
<area shape="rect" href="arch__timer_8c.html#aaab6e45ec6d5188b23d96695db532140" title=" " alt="" coords="761,5,943,32"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="769,57,935,98"/>
<area shape="rect" href="guest_8c.html#acd7401987c2e84cad89f08207d34bf3f" title=" " alt="" coords="586,5,698,32"/>
<area shape="rect" href="guest_8c.html#a8ee5ced2d0c0d538319888057bc58b4a" title=" " alt="" coords="384,5,523,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,5,336,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="571,64,713,91"/>
</map>
</div>

</div>
</div>
<a id="a0209ad4256c7a1fd5ea70b6abe030954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0209ad4256c7a1fd5ea70b6abe030954">&#9670;&nbsp;</a></span>kvm_arm_timer_write_sysreg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_arm_timer_write_sysreg </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum kvm_arch_timers&#160;</td>
          <td class="paramname"><em>tmr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum kvm_arch_timer_regs&#160;</td>
          <td class="paramname"><em>treg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01219">1219</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;{</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keyword">struct </span>arch_timer_context *timer;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keyword">struct </span>timer_map map;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <a class="code" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21">get_timer_map</a>(vcpu, &amp;map);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    timer = vcpu_get_timer(vcpu, tmr);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">if</span> (timer == map.emul_vtimer || timer == map.emul_ptimer) {</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <a class="code" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710">soft_timer_cancel</a>(&amp;timer-&gt;hrtimer);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <a class="code" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771">kvm_arm_timer_write</a>(vcpu, timer, treg, val);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <a class="code" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a">timer_emulate</a>(timer);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        preempt_disable();</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <a class="code" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af">timer_save_state</a>(timer);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <a class="code" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771">kvm_arm_timer_write</a>(vcpu, timer, treg, val);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <a class="code" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301">timer_restore_state</a>(timer);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        preempt_enable();</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_acea899fae895cedf39458ed51af3cb1a"><div class="ttname"><a href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a">timer_emulate</a></div><div class="ttdeci">static void timer_emulate(struct arch_timer_context *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00464">arch_timer.c:464</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_ad19b9cbace853dd534bf572a35f83710"><div class="ttname"><a href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710">soft_timer_cancel</a></div><div class="ttdeci">static void soft_timer_cancel(struct hrtimer *hrt)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00219">arch_timer.c:219</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a0209ad4256c7a1fd5ea70b6abe030954_cgraph.png" border="0" usemap="#aarch__timer_8c_a0209ad4256c7a1fd5ea70b6abe030954_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a0209ad4256c7a1fd5ea70b6abe030954_cgraph" id="aarch__timer_8c_a0209ad4256c7a1fd5ea70b6abe030954_cgraph">
<area shape="rect" title=" " alt="" coords="5,659,172,701"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="228,464,349,491"/>
<area shape="rect" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771" title=" " alt="" coords="421,692,587,719"/>
<area shape="rect" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710" title=" " alt="" coords="220,641,357,668"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="229,515,348,541"/>
<area shape="rect" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301" title=" " alt="" coords="429,895,579,921"/>
<area shape="rect" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af" title=" " alt="" coords="437,793,571,820"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="883,464,1050,491"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="902,667,1031,693"/>
<area shape="rect" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac" title=" " alt="" coords="685,768,791,795"/>
<area shape="rect" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7" title=" " alt="" coords="679,717,797,744"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="405,413,603,440"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="651,565,825,592"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="419,464,589,491"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="419,296,589,323"/>
<area shape="rect" href="arch__timer_8c.html#a00de950346bea7137e0f06522d67ab2b" title=" " alt="" coords="441,515,567,541"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="653,347,823,389"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="679,413,797,440"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="913,819,1021,845"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="662,245,814,272"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="669,296,807,323"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="916,44,1017,71"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="911,313,1022,340"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="916,380,1017,407"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="881,132,1052,159"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="881,245,1053,272"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1139,5,1239,32"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="1355,5,1490,32"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="1151,376,1228,403"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1351,208,1495,235"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1332,259,1513,301"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="1335,544,1510,571"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1361,376,1485,403"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="1601,376,1703,403"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1348,478,1497,519"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1325,325,1520,352"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="1373,595,1473,621"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1575,267,1729,293"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1591,569,1713,596"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1591,519,1713,545"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="1108,536,1271,563"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="1359,645,1487,672"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="1128,107,1251,133"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="1118,157,1261,184"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="1319,56,1527,83"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="1346,107,1499,133"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="1365,157,1481,184"/>
<area shape="rect" href="arch__timer_8c.html#a6fcfce8307e73b5ae888edca334508aa" title=" " alt="" coords="691,869,785,896"/>
<area shape="rect" href="arch__timer_8c.html#a207ce56a4fe08e050e49e49334548e15" title=" " alt="" coords="691,971,785,997"/>
<area shape="rect" href="nvhe_2timer-sr_8c.html#a73539c3eaa37749e44c40351913b9efb" title=" " alt="" coords="873,971,1060,997"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a0209ad4256c7a1fd5ea70b6abe030954_icgraph.png" border="0" usemap="#aarch__timer_8c_a0209ad4256c7a1fd5ea70b6abe030954_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a0209ad4256c7a1fd5ea70b6abe030954_icgraph" id="aarch__timer_8c_a0209ad4256c7a1fd5ea70b6abe030954_icgraph">
<area shape="rect" title=" " alt="" coords="196,5,363,47"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="5,13,148,39"/>
</map>
</div>

</div>
</div>
<a id="aa5109f58e0ef877d3f053d0593359c1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5109f58e0ef877d3f053d0593359c1e">&#9670;&nbsp;</a></span>kvm_bg_timer_expire()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum hrtimer_restart kvm_bg_timer_expire </td>
          <td>(</td>
          <td class="paramtype">struct hrtimer *&#160;</td>
          <td class="paramname"><em>hrt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00307">307</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    u64 ns;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    timer = container_of(hrt, <span class="keyword">struct</span> arch_timer_cpu, bg_timer);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    vcpu = container_of(timer, <span class="keyword">struct</span> kvm_vcpu, arch.timer_cpu);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">     * Check that the timer has really expired from the guest&#39;s</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">     * PoV (NTP on the host may have forced it to expire</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">     * early). If we should have slept longer, restart it.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    ns = <a class="code" href="arch__timer_8c.html#adbe9b97af2fe25eb9d48e231bba23fcf">kvm_timer_earliest_exp</a>(vcpu);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">if</span> (unlikely(ns)) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        hrtimer_forward_now(hrt, ns_to_ktime(ns));</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">return</span> HRTIMER_RESTART;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5">kvm_vcpu_wake_up</a>(vcpu);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span> HRTIMER_NORESTART;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_adbe9b97af2fe25eb9d48e231bba23fcf"><div class="ttname"><a href="arch__timer_8c.html#adbe9b97af2fe25eb9d48e231bba23fcf">kvm_timer_earliest_exp</a></div><div class="ttdeci">static u64 kvm_timer_earliest_exp(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00307">arch_timer.c:307</a></div></div>
<div class="ttc" id="akvm__main_8c_html_ad9f0140eebcdef9a9ebae54431d2fba5"><div class="ttname"><a href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5">kvm_vcpu_wake_up</a></div><div class="ttdeci">bool kvm_vcpu_wake_up(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l03915">kvm_main.c:3915</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aa5109f58e0ef877d3f053d0593359c1e_cgraph.png" border="0" usemap="#aarch__timer_8c_aa5109f58e0ef877d3f053d0593359c1e_cgraph" alt=""/></div>
<map name="aarch__timer_8c_aa5109f58e0ef877d3f053d0593359c1e_cgraph" id="aarch__timer_8c_aa5109f58e0ef877d3f053d0593359c1e_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,169,133"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="217,56,415,83"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="229,5,403,32"/>
<area shape="rect" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913" title=" " alt="" coords="274,107,358,133"/>
<area shape="rect" href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518" title=" " alt="" coords="235,157,397,184"/>
<area shape="rect" href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b" title=" " alt="" coords="261,208,371,235"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="463,154,633,195"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="489,56,607,83"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="681,136,848,163"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="700,187,829,213"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="494,5,602,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aa5109f58e0ef877d3f053d0593359c1e_icgraph.png" border="0" usemap="#aarch__timer_8c_aa5109f58e0ef877d3f053d0593359c1e_icgraph" alt=""/></div>
<map name="aarch__timer_8c_aa5109f58e0ef877d3f053d0593359c1e_icgraph" id="aarch__timer_8c_aa5109f58e0ef877d3f053d0593359c1e_icgraph">
<area shape="rect" title=" " alt="" coords="680,5,844,32"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="473,5,632,32"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="253,5,425,32"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="5,5,205,32"/>
</map>
</div>

</div>
</div>
<a id="a6c290bf8212ea1388cdb4a839eae7228"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c290bf8212ea1388cdb4a839eae7228">&#9670;&nbsp;</a></span>kvm_counter_compute_delta()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 kvm_counter_compute_delta </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>timer_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00256">256</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;{</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    u64 now = <a class="code" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98">kvm_phys_timer_read</a>() - <a class="code" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a>(timer_ctx);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span> (now &lt; val) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        u64 ns;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        ns = cyclecounter_cyc2ns(<a class="code" href="arch__timer_8c.html#a35098fc91b751950a191213b1c2e5853">timecounter</a>-&gt;cc,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                     val - now,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                     <a class="code" href="arch__timer_8c.html#a35098fc91b751950a191213b1c2e5853">timecounter</a>-&gt;mask,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                     &amp;timer_ctx-&gt;ns_frac);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">return</span> ns;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a35098fc91b751950a191213b1c2e5853"><div class="ttname"><a href="arch__timer_8c.html#a35098fc91b751950a191213b1c2e5853">timecounter</a></div><div class="ttdeci">static struct timecounter * timecounter</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00026">arch_timer.c:26</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a6c290bf8212ea1388cdb4a839eae7228_cgraph.png" border="0" usemap="#aarch__timer_8c_a6c290bf8212ea1388cdb4a839eae7228_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a6c290bf8212ea1388cdb4a839eae7228_cgraph" id="aarch__timer_8c_a6c290bf8212ea1388cdb4a839eae7228_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,176,65"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="224,5,391,32"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="243,56,372,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a6c290bf8212ea1388cdb4a839eae7228_icgraph.png" border="0" usemap="#aarch__timer_8c_a6c290bf8212ea1388cdb4a839eae7228_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a6c290bf8212ea1388cdb4a839eae7228_icgraph" id="aarch__timer_8c_a6c290bf8212ea1388cdb4a839eae7228_icgraph">
<area shape="rect" title=" " alt="" coords="2633,347,2804,389"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="2229,329,2427,356"/>
<area shape="rect" href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b" title=" " alt="" coords="2475,380,2585,407"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="2011,380,2175,407"/>
<area shape="rect" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9" title=" " alt="" coords="2035,329,2151,356"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1817,236,1935,263"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="1797,381,1955,408"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="1575,411,1747,437"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="1327,411,1527,437"/>
<area shape="rect" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894" title=" " alt="" coords="1795,329,1957,356"/>
<area shape="rect" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc" title=" " alt="" coords="1335,360,1518,387"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1579,294,1742,335"/>
<area shape="rect" href="guest_8c.html#a91e885a78ebf3a7c410b4b8ffa443729" title=" " alt="" coords="1131,360,1244,387"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="1121,411,1254,437"/>
<area shape="rect" href="guest_8c.html#ad1a71190592cc60155333934b84d1d11" title=" " alt="" coords="420,444,560,471"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="191,339,349,365"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,265,129,292"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1355,269,1498,296"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1577,229,1744,270"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1577,168,1744,195"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1347,163,1506,189"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="852,157,1048,184"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1115,107,1260,133"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1123,309,1252,336"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1130,44,1245,71"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="906,208,994,235"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="643,208,778,235"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="859,107,1041,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="624,107,797,133"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="19,356,115,383"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="663,56,758,83"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="411,107,569,133"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="862,360,1038,387"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="629,368,792,395"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="869,259,1031,285"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="411,361,569,402"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="617,259,804,285"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="911,31,989,57"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="655,5,767,32"/>
<area shape="rect" href="arch__timer_8c.html#a78e23e83bece8c269268f3a263fbb114" title=" " alt="" coords="2243,431,2413,473"/>
<area shape="rect" href="kvm__main_8c.html#a3de4d6991bdd1a714e8afa6a55136cdd" title=" " alt="" coords="2005,439,2181,465"/>
<area shape="rect" href="kvm__main_8c.html#a8e18df0287ddedfd516454aeeb669807" title=" " alt="" coords="1811,487,1941,513"/>
<area shape="rect" href="kvm__main_8c.html#a7256a8615584a9ae83a46c071f6aa0e9" title=" " alt="" coords="1600,461,1721,488"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="1369,461,1484,488"/>
<area shape="rect" href="psci_8c.html#abe7d85200e79143f87dab785a204fb3a" title=" " alt="" coords="1096,512,1279,539"/>
<area shape="rect" href="arm_8c.html#ad33fe3df0e24d8ff8cb0a7f4657ec3fa" title=" " alt="" coords="1112,461,1263,488"/>
<area shape="rect" href="psci_8c.html#ac7522f6e0d1805f44a3e932397de4582" title=" " alt="" coords="878,512,1022,539"/>
<area shape="rect" href="psci_8c.html#a8f59d47a1b54f561b8c42f509798142e" title=" " alt="" coords="639,512,783,539"/>
<area shape="rect" href="psci_8c.html#a3daa8000eb9717dde07d817c306b052b" title=" " alt="" coords="433,512,547,539"/>
<area shape="rect" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4" title=" " alt="" coords="177,436,363,463"/>
</map>
</div>

</div>
</div>
<a id="a78e23e83bece8c269268f3a263fbb114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78e23e83bece8c269268f3a263fbb114">&#9670;&nbsp;</a></span>kvm_cpu_has_pending_timer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_cpu_has_pending_timer </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00422">422</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518">vcpu_has_wfit_active</a>(vcpu) &amp;&amp; <a class="code" href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b">wfit_delay_ns</a>(vcpu) == 0;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a9d0120f96e99b20be8023dad5c6a7f0b"><div class="ttname"><a href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b">wfit_delay_ns</a></div><div class="ttdeci">static u64 wfit_delay_ns(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00293">arch_timer.c:293</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_ad210f5f7b0361777290f8b36f023a518"><div class="ttname"><a href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518">vcpu_has_wfit_active</a></div><div class="ttdeci">static bool vcpu_has_wfit_active(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00287">arch_timer.c:287</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a78e23e83bece8c269268f3a263fbb114_cgraph.png" border="0" usemap="#aarch__timer_8c_a78e23e83bece8c269268f3a263fbb114_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a78e23e83bece8c269268f3a263fbb114_cgraph" id="aarch__timer_8c_a78e23e83bece8c269268f3a263fbb114_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,176,65"/>
<area shape="rect" href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518" title=" " alt="" coords="224,5,385,32"/>
<area shape="rect" href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b" title=" " alt="" coords="249,56,360,83"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="433,49,604,90"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="652,31,819,57"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="671,81,800,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a78e23e83bece8c269268f3a263fbb114_icgraph.png" border="0" usemap="#aarch__timer_8c_a78e23e83bece8c269268f3a263fbb114_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a78e23e83bece8c269268f3a263fbb114_icgraph" id="aarch__timer_8c_a78e23e83bece8c269268f3a263fbb114_icgraph">
<area shape="rect" title=" " alt="" coords="1968,49,2139,90"/>
<area shape="rect" href="kvm__main_8c.html#a3de4d6991bdd1a714e8afa6a55136cdd" title=" " alt="" coords="1744,56,1920,83"/>
<area shape="rect" href="kvm__main_8c.html#a8e18df0287ddedfd516454aeeb669807" title=" " alt="" coords="1565,31,1696,57"/>
<area shape="rect" href="kvm__main_8c.html#a7256a8615584a9ae83a46c071f6aa0e9" title=" " alt="" coords="1396,56,1517,83"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="1233,56,1348,83"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="1027,5,1161,32"/>
<area shape="rect" href="psci_8c.html#abe7d85200e79143f87dab785a204fb3a" title=" " alt="" coords="1003,56,1185,83"/>
<area shape="rect" href="arm_8c.html#ad33fe3df0e24d8ff8cb0a7f4657ec3fa" title=" " alt="" coords="1019,107,1169,133"/>
<area shape="rect" href="psci_8c.html#ac7522f6e0d1805f44a3e932397de4582" title=" " alt="" coords="802,56,946,83"/>
<area shape="rect" href="psci_8c.html#a8f59d47a1b54f561b8c42f509798142e" title=" " alt="" coords="580,5,724,32"/>
<area shape="rect" href="psci_8c.html#a3daa8000eb9717dde07d817c306b052b" title=" " alt="" coords="391,31,506,57"/>
<area shape="rect" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4" title=" " alt="" coords="153,31,339,57"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="7,5,103,32"/>
<area shape="rect" href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746" title=" " alt="" coords="5,56,105,83"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="793,107,955,133"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="559,107,745,133"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="387,107,511,133"/>
</map>
</div>

</div>
</div>
<a id="abc4d9a1d61348137665ab9a6b18cfa5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc4d9a1d61348137665ab9a6b18cfa5b">&#9670;&nbsp;</a></span>kvm_hrtimer_expire()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum hrtimer_restart kvm_hrtimer_expire </td>
          <td>(</td>
          <td class="paramtype">struct hrtimer *&#160;</td>
          <td class="paramname"><em>hrt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00307">307</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">struct </span>arch_timer_context *ctx;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    u64 ns;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    ctx = container_of(hrt, <span class="keyword">struct</span> arch_timer_context, hrtimer);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    vcpu = ctx-&gt;vcpu;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    trace_kvm_timer_hrtimer_expire(ctx);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">     * Check that the timer has really expired from the guest&#39;s</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">     * PoV (NTP on the host may have forced it to expire</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">     * early). If not ready, schedule for a later time.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    ns = <a class="code" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3">kvm_timer_compute_delta</a>(ctx);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span> (unlikely(ns)) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        hrtimer_forward_now(hrt, ns_to_ktime(ns));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">return</span> HRTIMER_RESTART;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f">kvm_timer_update_irq</a>(vcpu, <span class="keyword">true</span>, ctx);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">return</span> HRTIMER_NORESTART;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_aeed64583773b01dafc949df326d17db3"><div class="ttname"><a href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3">kvm_timer_compute_delta</a></div><div class="ttdeci">static u64 kvm_timer_compute_delta(struct arch_timer_context *timer_ctx)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00274">arch_timer.c:274</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_abc4d9a1d61348137665ab9a6b18cfa5b_icgraph.png" border="0" usemap="#aarch__timer_8c_abc4d9a1d61348137665ab9a6b18cfa5b_icgraph" alt=""/></div>
<map name="aarch__timer_8c_abc4d9a1d61348137665ab9a6b18cfa5b_icgraph" id="aarch__timer_8c_abc4d9a1d61348137665ab9a6b18cfa5b_icgraph">
<area shape="rect" title=" " alt="" coords="869,5,1024,32"/>
<area shape="rect" href="arch__timer_8c.html#a277ad23da04b884fe1d588984e372943" title=" " alt="" coords="680,5,821,32"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="473,5,632,32"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="253,5,425,32"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="5,5,205,32"/>
</map>
</div>

</div>
</div>
<a id="a93ca26b238c7b7ccc9f231451e3b44f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93ca26b238c7b7ccc9f231451e3b44f0">&#9670;&nbsp;</a></span>kvm_irq_fixup_flags()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_irq_fixup_flags </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>virq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01309">1309</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;{</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    *flags = irq_get_trigger_type(virq);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">if</span> (*flags != IRQF_TRIGGER_HIGH &amp;&amp; *flags != IRQF_TRIGGER_LOW) {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        kvm_err(<span class="stringliteral">&quot;Invalid trigger for timer IRQ%d, assuming level low\n&quot;</span>,</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            virq);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        *flags = IRQF_TRIGGER_LOW;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a93ca26b238c7b7ccc9f231451e3b44f0_icgraph.png" border="0" usemap="#aarch__timer_8c_a93ca26b238c7b7ccc9f231451e3b44f0_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a93ca26b238c7b7ccc9f231451e3b44f0_icgraph" id="aarch__timer_8c_a93ca26b238c7b7ccc9f231451e3b44f0_icgraph">
<area shape="rect" title=" " alt="" coords="692,5,844,32"/>
<area shape="rect" href="arch__timer_8c.html#a167e7a9fc4c0e10e12bec622f676e31b" title=" " alt="" coords="541,5,644,32"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="341,5,493,32"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="165,5,293,32"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="5,5,117,32"/>
</map>
</div>

</div>
</div>
<a id="a167e7a9fc4c0e10e12bec622f676e31b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a167e7a9fc4c0e10e12bec622f676e31b">&#9670;&nbsp;</a></span>kvm_irq_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int kvm_irq_init </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_kvm_info *&#160;</td>
          <td class="paramname"><em>info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01319">1319</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;{</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keyword">struct </span>irq_domain *domain = NULL;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordflow">if</span> (info-&gt;virtual_irq &lt;= 0) {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        kvm_err(<span class="stringliteral">&quot;kvm_arch_timer: invalid virtual timer IRQ: %d\n&quot;</span>,</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            info-&gt;virtual_irq);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">return</span> -ENODEV;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a> = info-&gt;virtual_irq;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <a class="code" href="arch__timer_8c.html#a93ca26b238c7b7ccc9f231451e3b44f0">kvm_irq_fixup_flags</a>(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>, &amp;<a class="code" href="arch__timer_8c.html#ad0df8fd11369dad2ecb88bca05586a2a">host_vtimer_irq_flags</a>);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordflow">if</span> (kvm_vgic_global_state.no_hw_deactivation) {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="keyword">struct </span>fwnode_handle *fwnode;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        <span class="keyword">struct </span>irq_data *data;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        fwnode = irq_domain_alloc_named_fwnode(<span class="stringliteral">&quot;kvm-timer&quot;</span>);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <span class="keywordflow">if</span> (!fwnode)</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="comment">/* Assume both vtimer and ptimer in the same parent */</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        data = irq_get_irq_data(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        domain = irq_domain_create_hierarchy(data-&gt;domain, 0,</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                             NR_KVM_TIMERS, fwnode,</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                             &amp;<a class="code" href="arch__timer_8c.html#ae4e307d79fe80f37b11012a68ed27295">timer_domain_ops</a>, NULL);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        <span class="keywordflow">if</span> (!domain) {</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            irq_domain_free_fwnode(fwnode);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        }</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <a class="code" href="arch__timer_8c.html#a3ea143fc77aa4520f032211fd9487ae5">arch_timer_irq_ops</a>.flags |= VGIC_IRQ_SW_RESAMPLE;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        WARN_ON(irq_domain_push_irq(domain, <a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>,</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                        (<span class="keywordtype">void</span> *)TIMER_VTIMER));</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keywordflow">if</span> (info-&gt;physical_irq &gt; 0) {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        <a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a> = info-&gt;physical_irq;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        <a class="code" href="arch__timer_8c.html#a93ca26b238c7b7ccc9f231451e3b44f0">kvm_irq_fixup_flags</a>(<a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>, &amp;<a class="code" href="arch__timer_8c.html#ade5cd660147808f96da12823ae71454a">host_ptimer_irq_flags</a>);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="keywordflow">if</span> (domain)</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            WARN_ON(irq_domain_push_irq(domain, <a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>,</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                            (<span class="keywordtype">void</span> *)TIMER_PTIMER));</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a20d4a341dfd2af12f6b5b19bfde475c1"><div class="ttname"><a href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a></div><div class="ttdeci">static unsigned int host_ptimer_irq</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00028">arch_timer.c:28</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a3ea143fc77aa4520f032211fd9487ae5"><div class="ttname"><a href="arch__timer_8c.html#a3ea143fc77aa4520f032211fd9487ae5">arch_timer_irq_ops</a></div><div class="ttdeci">static struct irq_ops arch_timer_irq_ops</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00052">arch_timer.c:54</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a93ca26b238c7b7ccc9f231451e3b44f0"><div class="ttname"><a href="arch__timer_8c.html#a93ca26b238c7b7ccc9f231451e3b44f0">kvm_irq_fixup_flags</a></div><div class="ttdeci">static void kvm_irq_fixup_flags(unsigned int virq, u32 *flags)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01309">arch_timer.c:1309</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_ad0df8fd11369dad2ecb88bca05586a2a"><div class="ttname"><a href="arch__timer_8c.html#ad0df8fd11369dad2ecb88bca05586a2a">host_vtimer_irq_flags</a></div><div class="ttdeci">static u32 host_vtimer_irq_flags</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00029">arch_timer.c:29</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_ade5cd660147808f96da12823ae71454a"><div class="ttname"><a href="arch__timer_8c.html#ade5cd660147808f96da12823ae71454a">host_ptimer_irq_flags</a></div><div class="ttdeci">static u32 host_ptimer_irq_flags</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00030">arch_timer.c:30</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_ae4e307d79fe80f37b11012a68ed27295"><div class="ttname"><a href="arch__timer_8c.html#ae4e307d79fe80f37b11012a68ed27295">timer_domain_ops</a></div><div class="ttdeci">static const struct irq_domain_ops timer_domain_ops</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01299">arch_timer.c:1304</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a167e7a9fc4c0e10e12bec622f676e31b_cgraph.png" border="0" usemap="#aarch__timer_8c_a167e7a9fc4c0e10e12bec622f676e31b_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a167e7a9fc4c0e10e12bec622f676e31b_cgraph" id="aarch__timer_8c_a167e7a9fc4c0e10e12bec622f676e31b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,108,32"/>
<area shape="rect" href="arch__timer_8c.html#a93ca26b238c7b7ccc9f231451e3b44f0" title=" " alt="" coords="156,5,308,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a167e7a9fc4c0e10e12bec622f676e31b_icgraph.png" border="0" usemap="#aarch__timer_8c_a167e7a9fc4c0e10e12bec622f676e31b_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a167e7a9fc4c0e10e12bec622f676e31b_icgraph" id="aarch__timer_8c_a167e7a9fc4c0e10e12bec622f676e31b_icgraph">
<area shape="rect" title=" " alt="" coords="541,5,644,32"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="341,5,493,32"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="165,5,293,32"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="5,5,117,32"/>
</map>
</div>

</div>
</div>
<a id="ac9f7917175f1d6031a77dcbc82f9ee98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9f7917175f1d6031a77dcbc82f9ee98">&#9670;&nbsp;</a></span>kvm_phys_timer_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u64 kvm_phys_timer_read </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00173">173</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a35098fc91b751950a191213b1c2e5853">timecounter</a>-&gt;cc-&gt;read(<a class="code" href="arch__timer_8c.html#a35098fc91b751950a191213b1c2e5853">timecounter</a>-&gt;cc);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ac9f7917175f1d6031a77dcbc82f9ee98_icgraph.png" border="0" usemap="#aarch__timer_8c_ac9f7917175f1d6031a77dcbc82f9ee98_icgraph" alt=""/></div>
<map name="aarch__timer_8c_ac9f7917175f1d6031a77dcbc82f9ee98_icgraph" id="aarch__timer_8c_ac9f7917175f1d6031a77dcbc82f9ee98_icgraph">
<area shape="rect" title=" " alt="" coords="2056,202,2223,228"/>
<area shape="rect" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894" title=" " alt="" coords="1104,267,1267,294"/>
<area shape="rect" href="arch__timer_8c.html#aaab6e45ec6d5188b23d96695db532140" title=" " alt="" coords="1600,227,1781,254"/>
<area shape="rect" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771" title=" " alt="" coords="1839,227,2006,254"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="1837,110,2008,152"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="1106,12,1265,39"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="1605,539,1776,566"/>
<area shape="rect" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc" title=" " alt="" coords="867,255,1049,282"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="877,306,1039,348"/>
<area shape="rect" href="guest_8c.html#a91e885a78ebf3a7c410b4b8ffa443729" title=" " alt="" coords="662,256,775,283"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="190,128,323,155"/>
<area shape="rect" href="guest_8c.html#ad1a71190592cc60155333934b84d1d11" title=" " alt="" coords="407,283,547,310"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,359,336,386"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,536,129,563"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="647,310,790,336"/>
<area shape="rect" href="guest_8c.html#acd7401987c2e84cad89f08207d34bf3f" title=" " alt="" coords="1377,227,1489,254"/>
<area shape="rect" href="guest_8c.html#a8ee5ced2d0c0d538319888057bc58b4a" title=" " alt="" coords="408,218,547,244"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1102,364,1269,405"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="1592,172,1789,199"/>
<area shape="rect" href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b" title=" " alt="" coords="1635,118,1746,144"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="1351,126,1515,152"/>
<area shape="rect" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9" title=" " alt="" coords="1375,176,1491,203"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1373,379,1492,406"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="872,12,1044,39"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="619,12,819,39"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1102,482,1269,508"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="879,482,1037,508"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="621,512,817,539"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="646,563,791,590"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="413,384,542,411"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="661,614,776,640"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="675,462,763,488"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="384,664,571,691"/>
<area shape="rect" href="arch__timer_8c.html#a78e23e83bece8c269268f3a263fbb114" title=" " alt="" coords="1347,60,1518,101"/>
<area shape="rect" href="kvm__main_8c.html#a3de4d6991bdd1a714e8afa6a55136cdd" title=" " alt="" coords="1097,67,1273,94"/>
<area shape="rect" href="kvm__main_8c.html#a8e18df0287ddedfd516454aeeb669807" title=" " alt="" coords="893,114,1023,140"/>
<area shape="rect" href="kvm__main_8c.html#a7256a8615584a9ae83a46c071f6aa0e9" title=" " alt="" coords="658,103,779,130"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="420,103,535,130"/>
<area shape="rect" href="arch__timer_8c.html#a25b09c8d95a2582f37a1a2719920e59c" title=" " alt="" coords="1355,649,1511,690"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1341,430,1525,456"/>
<area shape="rect" href="arch__timer_8c.html#a939939efd4c7eb8c054ca12e04623358" title=" " alt="" coords="1321,766,1544,792"/>
<area shape="rect" href="arch__timer_8c.html#a629de40452a9be84148e3c8442a80db6" title=" " alt="" coords="871,631,1045,658"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1337,480,1529,507"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1349,532,1516,573"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1341,715,1524,742"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="1109,430,1261,456"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="894,428,1022,455"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="663,360,775,387"/>
<area shape="rect" href="arm_8c.html#a545524d72330cd45dae4f51a686943c0" title=" " alt="" coords="869,766,1047,792"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="1103,715,1268,742"/>
</map>
</div>

</div>
</div>
<a id="a0abce4d3df0f10be896c5ff0cb489041"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0abce4d3df0f10be896c5ff0cb489041">&#9670;&nbsp;</a></span>kvm_timer_blocking()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_timer_blocking </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00571">571</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;{</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(vcpu);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keyword">struct </span>timer_map map;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <a class="code" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21">get_timer_map</a>(vcpu, &amp;map);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">     * If no timers are capable of raising interrupts (disabled or</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">     * masked), then there&#39;s no more work for us to do.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f">kvm_timer_irq_can_fire</a>(map.direct_vtimer) &amp;&amp;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        !<a class="code" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f">kvm_timer_irq_can_fire</a>(map.direct_ptimer) &amp;&amp;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        !<a class="code" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f">kvm_timer_irq_can_fire</a>(map.emul_vtimer) &amp;&amp;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        !<a class="code" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f">kvm_timer_irq_can_fire</a>(map.emul_ptimer) &amp;&amp;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        !<a class="code" href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518">vcpu_has_wfit_active</a>(vcpu))</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">     * At least one guest time will expire. Schedule a background timer.</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">     * Set the earliest expiration time among the guest timers.</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <a class="code" href="arch__timer_8c.html#a00de950346bea7137e0f06522d67ab2b">soft_timer_start</a>(&amp;timer-&gt;bg_timer, <a class="code" href="arch__timer_8c.html#adbe9b97af2fe25eb9d48e231bba23fcf">kvm_timer_earliest_exp</a>(vcpu));</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a00de950346bea7137e0f06522d67ab2b"><div class="ttname"><a href="arch__timer_8c.html#a00de950346bea7137e0f06522d67ab2b">soft_timer_start</a></div><div class="ttdeci">static void soft_timer_start(struct hrtimer *hrt, u64 ns)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00213">arch_timer.c:213</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_ae722c5e3eba2098c012b2cdc4d74bf9f"><div class="ttname"><a href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f">kvm_timer_irq_can_fire</a></div><div class="ttdeci">static bool kvm_timer_irq_can_fire(struct arch_timer_context *timer_ctx)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00279">arch_timer.c:279</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a0abce4d3df0f10be896c5ff0cb489041_cgraph.png" border="0" usemap="#aarch__timer_8c_a0abce4d3df0f10be896c5ff0cb489041_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a0abce4d3df0f10be896c5ff0cb489041_cgraph" id="aarch__timer_8c_a0abce4d3df0f10be896c5ff0cb489041_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,160,133"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="237,5,359,32"/>
<area shape="rect" href="arch__timer_8c.html#adbe9b97af2fe25eb9d48e231bba23fcf" title=" " alt="" coords="208,56,388,83"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="211,107,385,133"/>
<area shape="rect" href="arch__timer_8c.html#a00de950346bea7137e0f06522d67ab2b" title=" " alt="" coords="235,157,361,184"/>
<area shape="rect" href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518" title=" " alt="" coords="217,208,379,235"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="436,107,544,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a0abce4d3df0f10be896c5ff0cb489041_icgraph.png" border="0" usemap="#aarch__timer_8c_a0abce4d3df0f10be896c5ff0cb489041_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a0abce4d3df0f10be896c5ff0cb489041_icgraph" id="aarch__timer_8c_a0abce4d3df0f10be896c5ff0cb489041_icgraph">
<area shape="rect" title=" " alt="" coords="1669,237,1824,264"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1463,237,1621,264"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1263,237,1415,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1080,376,1204,403"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="1101,300,1183,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="aeed64583773b01dafc949df326d17db3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed64583773b01dafc949df326d17db3">&#9670;&nbsp;</a></span>kvm_timer_compute_delta()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 kvm_timer_compute_delta </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>timer_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00274">274</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;{</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228">kvm_counter_compute_delta</a>(timer_ctx, <a class="code" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd">timer_get_cval</a>(timer_ctx));</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a6c290bf8212ea1388cdb4a839eae7228"><div class="ttname"><a href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228">kvm_counter_compute_delta</a></div><div class="ttdeci">static u64 kvm_counter_compute_delta(struct arch_timer_context *timer_ctx, u64 val)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00256">arch_timer.c:256</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aeed64583773b01dafc949df326d17db3_cgraph.png" border="0" usemap="#aarch__timer_8c_aeed64583773b01dafc949df326d17db3_cgraph" alt=""/></div>
<map name="aarch__timer_8c_aeed64583773b01dafc949df326d17db3_cgraph" id="aarch__timer_8c_aeed64583773b01dafc949df326d17db3_cgraph">
<area shape="rect" title=" " alt="" coords="5,60,203,87"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="251,23,421,65"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="277,89,395,116"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="469,5,636,32"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="488,56,617,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aeed64583773b01dafc949df326d17db3_icgraph.png" border="0" usemap="#aarch__timer_8c_aeed64583773b01dafc949df326d17db3_icgraph" alt=""/></div>
<map name="aarch__timer_8c_aeed64583773b01dafc949df326d17db3_icgraph" id="aarch__timer_8c_aeed64583773b01dafc949df326d17db3_icgraph">
<area shape="rect" title=" " alt="" coords="1975,129,2172,156"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="1763,64,1927,91"/>
<area shape="rect" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9" title=" " alt="" coords="1787,129,1903,156"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1785,205,1904,232"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="1552,35,1711,61"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="1323,16,1495,43"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="1069,5,1269,32"/>
<area shape="rect" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894" title=" " alt="" coords="1550,129,1713,156"/>
<area shape="rect" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc" title=" " alt="" coords="1317,88,1500,115"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1327,139,1490,181"/>
<area shape="rect" href="guest_8c.html#a91e885a78ebf3a7c410b4b8ffa443729" title=" " alt="" coords="1113,107,1226,133"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="1103,56,1236,83"/>
<area shape="rect" href="guest_8c.html#ad1a71190592cc60155333934b84d1d11" title=" " alt="" coords="393,132,533,159"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,432,336,459"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,487,129,513"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1098,157,1241,184"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1548,198,1715,239"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1548,272,1715,299"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1329,292,1488,319"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,183,1021,209"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1097,259,1242,285"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1105,411,1234,437"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1112,309,1227,336"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="879,563,967,589"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,157,751,184"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,259,1015,285"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,208,771,235"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,259,732,285"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,309,731,336"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,208,543,235"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,360,1011,387"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,411,765,437"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,512,1004,539"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,395,543,437"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,512,777,539"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,309,963,336"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,360,740,387"/>
</map>
</div>

</div>
</div>
<a id="a993c30c61801fad7f3e557bcacbc8638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a993c30c61801fad7f3e557bcacbc8638">&#9670;&nbsp;</a></span>kvm_timer_cpu_down()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_cpu_down </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01041">1041</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;{</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    disable_percpu_irq(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        disable_percpu_irq(<a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a993c30c61801fad7f3e557bcacbc8638_icgraph.png" border="0" usemap="#aarch__timer_8c_a993c30c61801fad7f3e557bcacbc8638_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a993c30c61801fad7f3e557bcacbc8638_icgraph" id="aarch__timer_8c_a993c30c61801fad7f3e557bcacbc8638_icgraph">
<area shape="rect" title=" " alt="" coords="261,5,427,32"/>
<area shape="rect" href="arm_8c.html#ad6968510b101877130dc9494f5dc4d4b" title=" " alt="" coords="5,5,213,32"/>
</map>
</div>

</div>
</div>
<a id="a35495530036f43da928b82e7a1ffee34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35495530036f43da928b82e7a1ffee34">&#9670;&nbsp;</a></span>kvm_timer_cpu_up()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_cpu_up </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01034">1034</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;{</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    enable_percpu_irq(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>, <a class="code" href="arch__timer_8c.html#ad0df8fd11369dad2ecb88bca05586a2a">host_vtimer_irq_flags</a>);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        enable_percpu_irq(<a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>, <a class="code" href="arch__timer_8c.html#ade5cd660147808f96da12823ae71454a">host_ptimer_irq_flags</a>);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a35495530036f43da928b82e7a1ffee34_icgraph.png" border="0" usemap="#aarch__timer_8c_a35495530036f43da928b82e7a1ffee34_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a35495530036f43da928b82e7a1ffee34_icgraph" id="aarch__timer_8c_a35495530036f43da928b82e7a1ffee34_icgraph">
<area shape="rect" title=" " alt="" coords="259,5,405,32"/>
<area shape="rect" href="arm_8c.html#ac1582780a8801f86aa06da8b95cbcfe9" title=" " alt="" coords="5,5,211,32"/>
</map>
</div>

</div>
</div>
<a id="adbe9b97af2fe25eb9d48e231bba23fcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe9b97af2fe25eb9d48e231bba23fcf">&#9670;&nbsp;</a></span>kvm_timer_earliest_exp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 kvm_timer_earliest_exp </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00307">307</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    u64 min_delta = ULLONG_MAX;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913">nr_timers</a>(vcpu); i++) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keyword">struct </span>arch_timer_context *ctx = &amp;vcpu-&gt;arch.timer_cpu.timers[i];</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        WARN(ctx-&gt;loaded, <span class="stringliteral">&quot;timer %d loaded\n&quot;</span>, i);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f">kvm_timer_irq_can_fire</a>(ctx))</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            min_delta = min(min_delta, <a class="code" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3">kvm_timer_compute_delta</a>(ctx));</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518">vcpu_has_wfit_active</a>(vcpu))</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        min_delta = min(min_delta, <a class="code" href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b">wfit_delay_ns</a>(vcpu));</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">/* If none of timers can fire, then return 0 */</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (min_delta == ULLONG_MAX)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">return</span> min_delta;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_adbe9b97af2fe25eb9d48e231bba23fcf_icgraph.png" border="0" usemap="#aarch__timer_8c_adbe9b97af2fe25eb9d48e231bba23fcf_icgraph" alt=""/></div>
<map name="aarch__timer_8c_adbe9b97af2fe25eb9d48e231bba23fcf_icgraph" id="aarch__timer_8c_adbe9b97af2fe25eb9d48e231bba23fcf_icgraph">
<area shape="rect" title=" " alt="" coords="1872,237,2052,264"/>
<area shape="rect" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041" title=" " alt="" coords="1669,237,1824,264"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1463,237,1621,264"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1263,237,1415,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1080,376,1204,403"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="1101,300,1183,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a6eb7255c40d5b43938e99918b3d9d06a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eb7255c40d5b43938e99918b3d9d06a">&#9670;&nbsp;</a></span>kvm_timer_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_timer_enable </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01506">1506</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;{</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(vcpu);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keyword">struct </span>timer_map map;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="keywordflow">if</span> (timer-&gt;enabled)</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160; </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="comment">/* Without a VGIC we do not map virtual IRQs to physical IRQs */</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">if</span> (!irqchip_in_kernel(vcpu-&gt;kvm))</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <span class="keywordflow">goto</span> no_vgic;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">     * At this stage, we have the guarantee that the vgic is both</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">     * available and initialized.</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arch__timer_8c.html#a7a37a6f350a857f42fe872aeebc8e2e4">timer_irqs_are_valid</a>(vcpu)) {</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        kvm_debug(<span class="stringliteral">&quot;incorrectly configured timer irqs\n&quot;</span>);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    }</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160; </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <a class="code" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21">get_timer_map</a>(vcpu, &amp;map);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    ret = <a class="code" href="vgic_8c.html#ab4243e0ac375259b39c04a6cc6266a9f">kvm_vgic_map_phys_irq</a>(vcpu,</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                    map.direct_vtimer-&gt;host_timer_irq,</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                    timer_irq(map.direct_vtimer),</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                    &amp;<a class="code" href="arch__timer_8c.html#a3ea143fc77aa4520f032211fd9487ae5">arch_timer_irq_ops</a>);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">if</span> (map.direct_ptimer) {</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        ret = <a class="code" href="vgic_8c.html#ab4243e0ac375259b39c04a6cc6266a9f">kvm_vgic_map_phys_irq</a>(vcpu,</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                        map.direct_ptimer-&gt;host_timer_irq,</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                        timer_irq(map.direct_ptimer),</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                        &amp;<a class="code" href="arch__timer_8c.html#a3ea143fc77aa4520f032211fd9487ae5">arch_timer_irq_ops</a>);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160; </div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;no_vgic:</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    timer-&gt;enabled = 1;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a7a37a6f350a857f42fe872aeebc8e2e4"><div class="ttname"><a href="arch__timer_8c.html#a7a37a6f350a857f42fe872aeebc8e2e4">timer_irqs_are_valid</a></div><div class="ttdeci">static bool timer_irqs_are_valid(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01452">arch_timer.c:1452</a></div></div>
<div class="ttc" id="avgic_8c_html_ab4243e0ac375259b39c04a6cc6266a9f"><div class="ttname"><a href="vgic_8c.html#ab4243e0ac375259b39c04a6cc6266a9f">kvm_vgic_map_phys_irq</a></div><div class="ttdeci">int kvm_vgic_map_phys_irq(struct kvm_vcpu *vcpu, unsigned int host_irq, u32 vintid, struct irq_ops *ops)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00514">vgic.c:514</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a6eb7255c40d5b43938e99918b3d9d06a_cgraph.png" border="0" usemap="#aarch__timer_8c_a6eb7255c40d5b43938e99918b3d9d06a_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a6eb7255c40d5b43938e99918b3d9d06a_cgraph" id="aarch__timer_8c_a6eb7255c40d5b43938e99918b3d9d06a_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,149,108"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="228,31,349,57"/>
<area shape="rect" href="vgic_8c.html#ab4243e0ac375259b39c04a6cc6266a9f" title=" " alt="" coords="197,81,380,108"/>
<area shape="rect" href="arch__timer_8c.html#a7a37a6f350a857f42fe872aeebc8e2e4" title=" " alt="" coords="211,157,366,184"/>
<area shape="rect" href="vgic_8c.html#a727bab6843a2191df705d005fa7f764f" title=" " alt="" coords="435,107,580,133"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="665,132,767,159"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="457,5,558,32"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="859,132,959,159"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="1021,132,1156,159"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="635,5,797,32"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="845,5,973,32"/>
<area shape="rect" href="vgic_8c.html#a99527df04c2db316d7f8c1733c18d99e" title=" " alt="" coords="428,208,587,235"/>
<area shape="rect" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913" title=" " alt="" coords="465,157,549,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a6eb7255c40d5b43938e99918b3d9d06a_icgraph.png" border="0" usemap="#aarch__timer_8c_a6eb7255c40d5b43938e99918b3d9d06a_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a6eb7255c40d5b43938e99918b3d9d06a_icgraph" id="aarch__timer_8c_a6eb7255c40d5b43938e99918b3d9d06a_icgraph">
<area shape="rect" title=" " alt="" coords="404,13,548,39"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="177,5,356,47"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,13,129,39"/>
</map>
</div>

</div>
</div>
<a id="a27c9feb35e6d7126c054c3325fea59b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27c9feb35e6d7126c054c3325fea59b0">&#9670;&nbsp;</a></span>kvm_timer_hyp_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __init kvm_timer_hyp_init </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>has_gic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01367">1367</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;{</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="keyword">struct </span>arch_timer_kvm_info *info;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    info = arch_timer_get_kvm_info();</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <a class="code" href="arch__timer_8c.html#a35098fc91b751950a191213b1c2e5853">timecounter</a> = &amp;info-&gt;timecounter;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arch__timer_8c.html#a35098fc91b751950a191213b1c2e5853">timecounter</a>-&gt;cc) {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        kvm_err(<span class="stringliteral">&quot;kvm_arch_timer: uninitialized timecounter\n&quot;</span>);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <span class="keywordflow">return</span> -ENODEV;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    }</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    err = <a class="code" href="arch__timer_8c.html#a167e7a9fc4c0e10e12bec622f676e31b">kvm_irq_init</a>(info);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">if</span> (err)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160; </div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="comment">/* First, do the virtual EL1 timer irq */</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    err = request_percpu_irq(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>, <a class="code" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629">kvm_arch_timer_handler</a>,</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                 <span class="stringliteral">&quot;kvm guest vtimer&quot;</span>, <a class="code" href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f">kvm_get_running_vcpus</a>());</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        kvm_err(<span class="stringliteral">&quot;kvm_arch_timer: can&#39;t request vtimer interrupt %d (%d)\n&quot;</span>,</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            <a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>, err);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordflow">if</span> (has_gic) {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        err = irq_set_vcpu_affinity(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>,</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                        <a class="code" href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f">kvm_get_running_vcpus</a>());</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            kvm_err(<span class="stringliteral">&quot;kvm_arch_timer: error setting vcpu affinity\n&quot;</span>);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <span class="keywordflow">goto</span> out_free_vtimer_irq;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        static_branch_enable(&amp;has_gic_active_state);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    }</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    kvm_debug(<span class="stringliteral">&quot;virtual timer IRQ%d\n&quot;</span>, <a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">/* Now let&#39;s do the physical EL1 timer irq */</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">if</span> (info-&gt;physical_irq &gt; 0) {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        err = request_percpu_irq(<a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>, <a class="code" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629">kvm_arch_timer_handler</a>,</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                     <span class="stringliteral">&quot;kvm guest ptimer&quot;</span>, <a class="code" href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f">kvm_get_running_vcpus</a>());</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            kvm_err(<span class="stringliteral">&quot;kvm_arch_timer: can&#39;t request ptimer interrupt %d (%d)\n&quot;</span>,</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                <a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>, err);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            <span class="keywordflow">goto</span> out_free_vtimer_irq;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="keywordflow">if</span> (has_gic) {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            err = irq_set_vcpu_affinity(<a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>,</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                            <a class="code" href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f">kvm_get_running_vcpus</a>());</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                kvm_err(<span class="stringliteral">&quot;kvm_arch_timer: error setting vcpu affinity\n&quot;</span>);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                <span class="keywordflow">goto</span> out_free_ptimer_irq;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            }</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        kvm_debug(<span class="stringliteral">&quot;physical timer IRQ%d\n&quot;</span>, <a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (has_vhe()) {</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        kvm_err(<span class="stringliteral">&quot;kvm_arch_timer: invalid physical timer IRQ: %d\n&quot;</span>,</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            info-&gt;physical_irq);</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        err = -ENODEV;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="keywordflow">goto</span> out_free_vtimer_irq;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;out_free_ptimer_irq:</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordflow">if</span> (info-&gt;physical_irq &gt; 0)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        free_percpu_irq(<a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>, <a class="code" href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f">kvm_get_running_vcpus</a>());</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;out_free_vtimer_irq:</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    free_percpu_irq(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>, <a class="code" href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f">kvm_get_running_vcpus</a>());</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a167e7a9fc4c0e10e12bec622f676e31b"><div class="ttname"><a href="arch__timer_8c.html#a167e7a9fc4c0e10e12bec622f676e31b">kvm_irq_init</a></div><div class="ttdeci">static int kvm_irq_init(struct arch_timer_kvm_info *info)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01319">arch_timer.c:1319</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a7d59bcd17bdbce3017dbc041cd6e9629"><div class="ttname"><a href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629">kvm_arch_timer_handler</a></div><div class="ttdeci">static irqreturn_t kvm_arch_timer_handler(int irq, void *dev_id)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00224">arch_timer.c:224</a></div></div>
<div class="ttc" id="akvm__main_8c_html_a1798daf88e30c60711caf936851d823f"><div class="ttname"><a href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f">kvm_get_running_vcpus</a></div><div class="ttdeci">struct kvm_vcpu *__percpu * kvm_get_running_vcpus(void)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l06353">kvm_main.c:6353</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a27c9feb35e6d7126c054c3325fea59b0_cgraph.png" border="0" usemap="#aarch__timer_8c_a27c9feb35e6d7126c054c3325fea59b0_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a27c9feb35e6d7126c054c3325fea59b0_cgraph" id="aarch__timer_8c_a27c9feb35e6d7126c054c3325fea59b0_cgraph">
<area shape="rect" title=" " alt="" coords="5,620,157,647"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="205,569,389,596"/>
<area shape="rect" href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f" title=" " alt="" coords="207,620,387,647"/>
<area shape="rect" href="arch__timer_8c.html#a167e7a9fc4c0e10e12bec622f676e31b" title=" " alt="" coords="246,671,349,697"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="462,519,583,545"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="437,620,608,647"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="438,569,607,596"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="674,468,813,495"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="660,671,827,697"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="656,721,831,748"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="684,569,803,596"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="679,620,808,647"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="911,721,1019,748"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="667,519,819,545"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="914,595,1015,621"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="909,308,1020,335"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="914,443,1015,469"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="1099,544,1269,571"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="879,544,1051,571"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1134,595,1234,621"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="1341,595,1475,621"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="1145,224,1223,251"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1336,5,1480,32"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1317,377,1499,418"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="2534,224,2637,251"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="1321,107,1495,133"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1346,325,1470,352"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1333,158,1483,199"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="2013,224,2208,251"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="1358,275,1458,301"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1561,413,1715,440"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="1789,413,1954,440"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1795,544,1947,571"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="2025,544,2197,571"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="2305,537,2415,564"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="2291,595,2429,621"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="2512,537,2659,564"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1577,157,1699,184"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1577,107,1699,133"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="1547,344,1729,371"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="1568,275,1708,301"/>
<area shape="rect" href="vgic-v4_8c.html#ac22161596c9858cc700bab08c03fc422" title=" " alt="" coords="1777,349,1965,376"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="2049,391,2172,417"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="2256,403,2464,429"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="2283,352,2437,379"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="1103,443,1265,469"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="1344,443,1472,469"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="1337,544,1479,571"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="1580,544,1696,571"/>
<area shape="rect" href="arch__timer_8c.html#a93ca26b238c7b7ccc9f231451e3b44f0" title=" " alt="" coords="447,671,599,697"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a27c9feb35e6d7126c054c3325fea59b0_icgraph.png" border="0" usemap="#aarch__timer_8c_a27c9feb35e6d7126c054c3325fea59b0_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a27c9feb35e6d7126c054c3325fea59b0_icgraph" id="aarch__timer_8c_a27c9feb35e6d7126c054c3325fea59b0_icgraph">
<area shape="rect" title=" " alt="" coords="341,5,493,32"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="165,5,293,32"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="5,5,117,32"/>
</map>
</div>

</div>
</div>
<a id="aa42ee7f3aa49455d33441110cea315fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa42ee7f3aa49455d33441110cea315fa">&#9670;&nbsp;</a></span>kvm_timer_init_vhe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_init_vhe </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01553">1553</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;{</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">if</span> (cpus_have_final_cap(ARM64_HAS_ECV_CNTPOFF))</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        sysreg_clear_set(cnthctl_el2, 0, CNTHCTL_ECV);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aa42ee7f3aa49455d33441110cea315fa_icgraph.png" border="0" usemap="#aarch__timer_8c_aa42ee7f3aa49455d33441110cea315fa_icgraph" alt=""/></div>
<map name="aarch__timer_8c_aa42ee7f3aa49455d33441110cea315fa_icgraph" id="aarch__timer_8c_aa42ee7f3aa49455d33441110cea315fa_icgraph">
<area shape="rect" title=" " alt="" coords="1028,81,1180,108"/>
<area shape="rect" href="arm_8c.html#a451b50b80474a3cf090fcce753c8c642" title=" " alt="" coords="815,81,980,108"/>
<area shape="rect" href="arm_8c.html#a2dfd4facec6b758ea01c34f9789486d8" title=" " alt="" coords="649,56,767,83"/>
<area shape="rect" href="arm_8c.html#a45a99f5a1905e2b85f69a767313abfd7" title=" " alt="" coords="653,107,763,133"/>
<area shape="rect" href="arm_8c.html#a0769d67e6376c5081aac75ea3783df2f" title=" " alt="" coords="458,56,562,83"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="204,5,332,32"/>
<area shape="rect" href="arm_8c.html#ac1582780a8801f86aa06da8b95cbcfe9" title=" " alt="" coords="165,56,371,83"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="5,56,117,83"/>
<area shape="rect" href="arm_8c.html#a3c73ef13f7491129779b02da5a9a7442" title=" " alt="" coords="419,107,601,133"/>
<area shape="rect" href="arm_8c.html#a289457d5cabd2e7e2cda634bc6277311" title=" " alt="" coords="209,107,327,133"/>
</map>
</div>

</div>
</div>
<a id="a7b851d39d19bcc70062d97e0a24e1290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b851d39d19bcc70062d97e0a24e1290">&#9670;&nbsp;</a></span>kvm_timer_init_vm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_init_vm </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01028">1028</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;{</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NR_KVM_TIMERS; i++)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        kvm-&gt;arch.timer_data.ppi[i] = <a class="code" href="arch__timer_8c.html#a2f0fe0305f0fed5e43fa92387f3de4b3">default_ppi</a>[i];</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a2f0fe0305f0fed5e43fa92387f3de4b3"><div class="ttname"><a href="arch__timer_8c.html#a2f0fe0305f0fed5e43fa92387f3de4b3">default_ppi</a></div><div class="ttdeci">static const u8 default_ppi[]</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00034">arch_timer.c:34</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a7b851d39d19bcc70062d97e0a24e1290_icgraph.png" border="0" usemap="#aarch__timer_8c_a7b851d39d19bcc70062d97e0a24e1290_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a7b851d39d19bcc70062d97e0a24e1290_icgraph" id="aarch__timer_8c_a7b851d39d19bcc70062d97e0a24e1290_icgraph">
<area shape="rect" title=" " alt="" coords="612,5,761,32"/>
<area shape="rect" href="arm_8c.html#a78b266c18dac3b9edbea80941c96e2cd" title=" " alt="" coords="421,5,564,32"/>
<area shape="rect" href="kvm__main_8c.html#a54b22e6be98d31db1a83e7993fbcf4bc" title=" " alt="" coords="247,5,373,32"/>
<area shape="rect" href="kvm__main_8c.html#a955de4f2a1b3371438636eccab732b27" title=" " alt="" coords="5,5,199,32"/>
</map>
</div>

</div>
</div>
<a id="ae722c5e3eba2098c012b2cdc4d74bf9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae722c5e3eba2098c012b2cdc4d74bf9f">&#9670;&nbsp;</a></span>kvm_timer_irq_can_fire()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool kvm_timer_irq_can_fire </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>timer_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00279">279</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    WARN_ON(timer_ctx &amp;&amp; timer_ctx-&gt;loaded);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span> timer_ctx &amp;&amp;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        ((<a class="code" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13">timer_get_ctl</a>(timer_ctx) &amp;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          (ARCH_TIMER_CTRL_IT_MASK | ARCH_TIMER_CTRL_ENABLE)) == ARCH_TIMER_CTRL_ENABLE);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_ad7dab91af9f69654aa27010f96125c13"><div class="ttname"><a href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13">timer_get_ctl</a></div><div class="ttdeci">u32 timer_get_ctl(struct arch_timer_context *ctxt)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00066">arch_timer.c:66</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ae722c5e3eba2098c012b2cdc4d74bf9f_cgraph.png" border="0" usemap="#aarch__timer_8c_ae722c5e3eba2098c012b2cdc4d74bf9f_cgraph" alt=""/></div>
<map name="aarch__timer_8c_ae722c5e3eba2098c012b2cdc4d74bf9f_cgraph" id="aarch__timer_8c_ae722c5e3eba2098c012b2cdc4d74bf9f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="228,5,336,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ae722c5e3eba2098c012b2cdc4d74bf9f_icgraph.png" border="0" usemap="#aarch__timer_8c_ae722c5e3eba2098c012b2cdc4d74bf9f_icgraph" alt=""/></div>
<map name="aarch__timer_8c_ae722c5e3eba2098c012b2cdc4d74bf9f_icgraph" id="aarch__timer_8c_ae722c5e3eba2098c012b2cdc4d74bf9f_icgraph">
<area shape="rect" title=" " alt="" coords="2257,256,2432,283"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="2042,175,2206,201"/>
<area shape="rect" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041" title=" " alt="" coords="2047,227,2201,253"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="2039,457,2209,484"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1820,283,1939,309"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="1800,173,1959,200"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="1548,173,1720,200"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="1300,173,1500,200"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1555,224,1713,251"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1324,227,1476,253"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="1056,129,1252,156"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1081,180,1227,207"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1089,231,1219,257"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1092,281,1216,308"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="876,415,957,441"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="825,107,1008,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="829,161,1005,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="836,313,997,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,389,129,416"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,516,777,543"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="877,364,956,391"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
<area shape="rect" href="arch__timer_8c.html#a25b09c8d95a2582f37a1a2719920e59c" title=" " alt="" coords="1801,385,1957,426"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1787,516,1971,543"/>
<area shape="rect" href="arch__timer_8c.html#a939939efd4c7eb8c054ca12e04623358" title=" " alt="" coords="1768,567,1991,593"/>
<area shape="rect" href="arch__timer_8c.html#a629de40452a9be84148e3c8442a80db6" title=" " alt="" coords="830,668,1003,695"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1783,333,1975,360"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1796,450,1963,491"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1788,617,1971,644"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="1558,501,1710,528"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="1336,492,1464,519"/>
<area shape="rect" href="arm_8c.html#a545524d72330cd45dae4f51a686943c0" title=" " alt="" coords="1311,567,1489,593"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1551,341,1717,368"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1321,332,1479,359"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1097,332,1211,359"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1110,433,1198,460"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1551,275,1717,317"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1329,281,1471,308"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="834,617,999,644"/>
</map>
</div>

</div>
</div>
<a id="a64a4d2f3d2a9b83524edda4b27246092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64a4d2f3d2a9b83524edda4b27246092">&#9670;&nbsp;</a></span>kvm_timer_should_fire()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool kvm_timer_should_fire </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>timer_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00380">380</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">enum</span> kvm_arch_timers index;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    u64 cval, now;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (!timer_ctx)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    index = arch_timer_ctx_index(timer_ctx);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (timer_ctx-&gt;loaded) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        u32 cnt_ctl = 0;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">switch</span> (index) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">case</span> TIMER_VTIMER:</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">case</span> TIMER_HVTIMER:</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            cnt_ctl = read_sysreg_el0(SYS_CNTV_CTL);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">case</span> TIMER_PTIMER:</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">case</span> TIMER_HPTIMER:</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            cnt_ctl = read_sysreg_el0(SYS_CNTP_CTL);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">case</span> NR_KVM_TIMERS:</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="comment">/* GCC is braindead */</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            cnt_ctl = 0;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">return</span>  (cnt_ctl &amp; ARCH_TIMER_CTRL_ENABLE) &amp;&amp;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                (cnt_ctl &amp; ARCH_TIMER_CTRL_IT_STAT) &amp;&amp;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;               !(cnt_ctl &amp; ARCH_TIMER_CTRL_IT_MASK);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f">kvm_timer_irq_can_fire</a>(timer_ctx))</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    cval = <a class="code" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd">timer_get_cval</a>(timer_ctx);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    now = <a class="code" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98">kvm_phys_timer_read</a>() - <a class="code" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a>(timer_ctx);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">return</span> cval &lt;= now;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a64a4d2f3d2a9b83524edda4b27246092_cgraph.png" border="0" usemap="#aarch__timer_8c_a64a4d2f3d2a9b83524edda4b27246092_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a64a4d2f3d2a9b83524edda4b27246092_cgraph" id="aarch__timer_8c_a64a4d2f3d2a9b83524edda4b27246092_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,176,108"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="228,5,395,32"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="224,56,399,83"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="252,107,371,133"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="247,157,376,184"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="447,56,555,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a64a4d2f3d2a9b83524edda4b27246092_icgraph.png" border="0" usemap="#aarch__timer_8c_a64a4d2f3d2a9b83524edda4b27246092_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a64a4d2f3d2a9b83524edda4b27246092_icgraph" id="aarch__timer_8c_a64a4d2f3d2a9b83524edda4b27246092_icgraph">
<area shape="rect" title=" " alt="" coords="2011,379,2181,405"/>
<area shape="rect" href="arch__timer_8c.html#a25b09c8d95a2582f37a1a2719920e59c" title=" " alt="" coords="1773,174,1929,215"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1759,240,1943,267"/>
<area shape="rect" href="arch__timer_8c.html#a939939efd4c7eb8c054ca12e04623358" title=" " alt="" coords="1740,463,1963,489"/>
<area shape="rect" href="arch__timer_8c.html#a629de40452a9be84148e3c8442a80db6" title=" " alt="" coords="1302,516,1475,543"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1755,291,1947,317"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1768,342,1935,383"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1792,408,1911,435"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1760,567,1943,593"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="1533,124,1685,151"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="853,5,981,32"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,5,740,32"/>
<area shape="rect" href="arm_8c.html#a545524d72330cd45dae4f51a686943c0" title=" " alt="" coords="1300,465,1477,492"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,444,777,471"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,389,129,416"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1525,319,1692,345"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1309,224,1468,251"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="1056,121,1252,148"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1081,185,1227,212"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1089,263,1219,289"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1097,64,1211,91"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1110,364,1198,391"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,56,751,83"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="825,157,1008,184"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,208,771,235"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,107,732,133"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,157,731,184"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,208,543,235"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="829,263,1005,289"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,313,765,340"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,317,336,344"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="836,364,997,391"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,310,543,351"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="877,56,956,83"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1525,399,1692,441"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1317,407,1460,433"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="1526,567,1691,593"/>
</map>
</div>

</div>
</div>
<a id="a939939efd4c7eb8c054ca12e04623358"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939939efd4c7eb8c054ca12e04623358">&#9670;&nbsp;</a></span>kvm_timer_should_notify_user()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kvm_timer_should_notify_user </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00860">860</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;{</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keyword">struct </span>arch_timer_context *vtimer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keyword">struct </span>arch_timer_context *ptimer = vcpu_ptimer(vcpu);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keyword">struct </span>kvm_sync_regs *sregs = &amp;vcpu-&gt;run-&gt;s.regs;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordtype">bool</span> vlevel, plevel;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">if</span> (likely(irqchip_in_kernel(vcpu-&gt;kvm)))</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    vlevel = sregs-&gt;device_irq_level &amp; KVM_ARM_DEV_EL1_VTIMER;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    plevel = sregs-&gt;device_irq_level &amp; KVM_ARM_DEV_EL1_PTIMER;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a>(vtimer) != vlevel ||</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;           <a class="code" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a>(ptimer) != plevel;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a939939efd4c7eb8c054ca12e04623358_cgraph.png" border="0" usemap="#aarch__timer_8c_a939939efd4c7eb8c054ca12e04623358_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a939939efd4c7eb8c054ca12e04623358_cgraph" id="aarch__timer_8c_a939939efd4c7eb8c054ca12e04623358_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,228,108"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="276,81,447,108"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="499,5,665,32"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="495,56,669,83"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="523,107,641,133"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="517,157,647,184"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="717,56,825,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a939939efd4c7eb8c054ca12e04623358_icgraph.png" border="0" usemap="#aarch__timer_8c_a939939efd4c7eb8c054ca12e04623358_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a939939efd4c7eb8c054ca12e04623358_icgraph" id="aarch__timer_8c_a939939efd4c7eb8c054ca12e04623358_icgraph">
<area shape="rect" title=" " alt="" coords="637,5,860,32"/>
<area shape="rect" href="arm_8c.html#a545524d72330cd45dae4f51a686943c0" title=" " alt="" coords="412,5,589,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a6ae73bff466fcdc60319f9726d53b571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ae73bff466fcdc60319f9726d53b571">&#9670;&nbsp;</a></span>kvm_timer_sync_user()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_sync_user </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00927">927</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;{</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(vcpu);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">if</span> (unlikely(!timer-&gt;enabled))</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span> (unlikely(!irqchip_in_kernel(vcpu-&gt;kvm)))</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <a class="code" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0">unmask_vtimer_irq_user</a>(vcpu);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a7af96c32754607120bf365569aac71c0"><div class="ttname"><a href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0">unmask_vtimer_irq_user</a></div><div class="ttdeci">static void unmask_vtimer_irq_user(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00914">arch_timer.c:914</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a6ae73bff466fcdc60319f9726d53b571_cgraph.png" border="0" usemap="#aarch__timer_8c_a6ae73bff466fcdc60319f9726d53b571_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a6ae73bff466fcdc60319f9726d53b571_cgraph" id="aarch__timer_8c_a6ae73bff466fcdc60319f9726d53b571_cgraph">
<area shape="rect" title=" " alt="" coords="5,259,171,285"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="219,259,401,285"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="449,107,620,133"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="450,259,619,285"/>
<area shape="rect" href="arch__timer_8c.html#ae906d98d68ae56770507afe2e63ade68" title=" " alt="" coords="461,310,608,351"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="672,107,839,133"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="668,157,843,184"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="696,5,815,32"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="691,56,820,83"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="923,107,1031,133"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="679,259,831,285"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="686,309,825,336"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="926,208,1027,235"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="921,389,1032,416"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="2833,769,2935,796"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="2799,549,2969,576"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="891,157,1063,184"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1957,208,2057,235"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="3031,368,3166,395"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="1111,469,1188,496"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1255,645,1399,672"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1236,579,1417,621"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="2410,528,2513,555"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="1239,360,1414,387"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1265,411,1389,437"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1252,462,1401,503"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1909,351,2104,377"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="1277,696,1377,723"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1479,587,1634,613"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="1696,583,1861,609"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1703,633,1855,660"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1921,633,2093,660"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="2191,605,2301,632"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="2177,745,2315,772"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="2388,633,2535,660"/>
<area shape="rect" href="vgic-its_8c.html#a53bf66e96dae9553e637fa69e8835365" title=" " alt="" coords="2388,583,2535,609"/>
<area shape="rect" href="vgic-its_8c.html#a352c8627ccf81a8154ae2275c7d50659" title=" " alt="" coords="2583,601,2751,642"/>
<area shape="rect" href="vgic-its_8c.html#ad62375be0591178764e98b79cd7217bf" title=" " alt="" coords="2590,549,2743,576"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="3017,769,3180,796"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="3268,769,3396,796"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="3037,692,3160,719"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="3027,549,3170,576"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="3228,692,3436,719"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="3255,641,3409,668"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="3274,549,3390,576"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1495,411,1618,437"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1495,360,1618,387"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="1465,696,1648,723"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="1487,645,1627,672"/>
<area shape="rect" href="vgic-v4_8c.html#ac22161596c9858cc700bab08c03fc422" title=" " alt="" coords="2152,693,2340,720"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a6ae73bff466fcdc60319f9726d53b571_icgraph.png" border="0" usemap="#aarch__timer_8c_a6ae73bff466fcdc60319f9726d53b571_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a6ae73bff466fcdc60319f9726d53b571_icgraph" id="aarch__timer_8c_a6ae73bff466fcdc60319f9726d53b571_icgraph">
<area shape="rect" title=" " alt="" coords="412,5,577,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="aabed21346a0fc6b04d9fc11ee754d19a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabed21346a0fc6b04d9fc11ee754d19a">&#9670;&nbsp;</a></span>kvm_timer_unblocking()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_timer_unblocking </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00596">596</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;{</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(vcpu);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710">soft_timer_cancel</a>(&amp;timer-&gt;bg_timer);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aabed21346a0fc6b04d9fc11ee754d19a_cgraph.png" border="0" usemap="#aarch__timer_8c_aabed21346a0fc6b04d9fc11ee754d19a_cgraph" alt=""/></div>
<map name="aarch__timer_8c_aabed21346a0fc6b04d9fc11ee754d19a_cgraph" id="aarch__timer_8c_aabed21346a0fc6b04d9fc11ee754d19a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,176,32"/>
<area shape="rect" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710" title=" " alt="" coords="224,5,361,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aabed21346a0fc6b04d9fc11ee754d19a_icgraph.png" border="0" usemap="#aarch__timer_8c_aabed21346a0fc6b04d9fc11ee754d19a_icgraph" alt=""/></div>
<map name="aarch__timer_8c_aabed21346a0fc6b04d9fc11ee754d19a_icgraph" id="aarch__timer_8c_aabed21346a0fc6b04d9fc11ee754d19a_icgraph">
<area shape="rect" title=" " alt="" coords="1684,237,1855,264"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a5abc04b494763cd0814855753e56671f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5abc04b494763cd0814855753e56671f">&#9670;&nbsp;</a></span>kvm_timer_update_irq()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_timer_update_irq </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>new_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>timer_ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00445">445</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;{</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    timer_ctx-&gt;irq.level = new_level;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    trace_kvm_timer_update_irq(vcpu-&gt;vcpu_id, timer_irq(timer_ctx),</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                   timer_ctx-&gt;irq.level);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0">userspace_irqchip</a>(vcpu-&gt;kvm)) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        ret = <a class="code" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4">kvm_vgic_inject_irq</a>(vcpu-&gt;kvm, vcpu,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                      timer_irq(timer_ctx),</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                      timer_ctx-&gt;irq.level,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                      timer_ctx);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        WARN_ON(ret);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
<div class="ttc" id="avgic_8c_html_a87038ce452e0054b853c10ccbbcc78a4"><div class="ttname"><a href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4">kvm_vgic_inject_irq</a></div><div class="ttdeci">int kvm_vgic_inject_irq(struct kvm *kvm, struct kvm_vcpu *vcpu, unsigned int intid, bool level, void *owner)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00439">vgic.c:439</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a5abc04b494763cd0814855753e56671f_cgraph.png" border="0" usemap="#aarch__timer_8c_a5abc04b494763cd0814855753e56671f_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a5abc04b494763cd0814855753e56671f_cgraph" id="aarch__timer_8c_a5abc04b494763cd0814855753e56671f_cgraph">
<area shape="rect" title=" " alt="" coords="5,553,175,580"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="223,528,375,554"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="229,578,368,605"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="458,645,559,672"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="453,460,564,486"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="2365,122,2467,149"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="2331,173,2501,200"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="423,696,595,722"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1489,645,1589,672"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="2829,325,2963,352"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="643,376,720,402"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="787,325,931,352"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="768,478,949,519"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="2365,376,2467,402"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="771,426,946,453"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="797,544,921,570"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="784,208,933,250"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1441,376,1636,402"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="809,157,909,184"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1011,528,1166,554"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="1228,477,1393,504"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1235,528,1387,554"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1453,528,1625,554"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="1723,452,1833,478"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="1709,528,1847,554"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="1920,426,2067,453"/>
<area shape="rect" href="vgic-its_8c.html#a53bf66e96dae9553e637fa69e8835365" title=" " alt="" coords="1920,249,2067,276"/>
<area shape="rect" href="vgic-its_8c.html#a352c8627ccf81a8154ae2275c7d50659" title=" " alt="" coords="2115,158,2283,199"/>
<area shape="rect" href="vgic-its_8c.html#ad62375be0591178764e98b79cd7217bf" title=" " alt="" coords="2122,224,2275,250"/>
<area shape="rect" href="vgic-its_8c.html#a94bbb30efc49ad5494a7f4b1410dbe01" title=" " alt="" coords="2137,274,2260,301"/>
<area shape="rect" href="vgic-its_8c.html#ab8e3bef933af0cc51b05259d801be26d" title=" " alt="" coords="2565,274,2728,301"/>
<area shape="rect" href="vgic-its_8c.html#aa5825fcbd841b62853870d25976d018b" title=" " alt="" coords="2808,274,2984,301"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="2815,224,2977,250"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="3048,224,3176,250"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="2585,72,2708,98"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="2575,173,2718,200"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="2792,97,3000,124"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="2819,46,2973,73"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="2838,173,2954,200"/>
<area shape="rect" href="vgic-its_8c.html#a3fe23d687675cef46a95e36cf14d04e1" title=" " alt="" coords="2341,274,2491,301"/>
<area shape="rect" href="vgic-its_8c.html#a0fb230e293b92c9fb746ad7b97ac68d5" title=" " alt="" coords="2575,477,2718,504"/>
<area shape="rect" href="vgic-its_8c.html#ae32cde43818922d2ecf800a3de102b75" title=" " alt="" coords="2611,376,2682,402"/>
<area shape="rect" href="vgic-its_8c.html#ad9756268e1c22946f868e3255f916aa6" title=" " alt="" coords="2549,224,2744,250"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#aa37f9ed0ed7921675bc4167d4a9d9261" title=" " alt="" coords="2577,426,2716,453"/>
<area shape="rect" href="kvm__main_8c.html#acb4d46ae6cc918253046320805f63a95" title=" " alt="" coords="2337,325,2495,352"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1027,477,1150,504"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1027,426,1150,453"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="997,106,1180,133"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="1019,157,1159,184"/>
<area shape="rect" href="vgic-v4_8c.html#ac22161596c9858cc700bab08c03fc422" title=" " alt="" coords="1684,106,1872,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a5abc04b494763cd0814855753e56671f_icgraph.png" border="0" usemap="#aarch__timer_8c_a5abc04b494763cd0814855753e56671f_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a5abc04b494763cd0814855753e56671f_icgraph" id="aarch__timer_8c_a5abc04b494763cd0814855753e56671f_icgraph">
<area shape="rect" title=" " alt="" coords="1936,173,2105,200"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1700,17,1884,44"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1696,85,1888,112"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1709,137,1875,178"/>
<area shape="rect" href="arch__timer_8c.html#a11b9b6e6338bbec6085332661c934e91" title=" " alt="" coords="1263,339,1433,365"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1733,203,1851,229"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1701,257,1883,284"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="1489,9,1641,36"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="1284,5,1412,32"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,25,740,52"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1481,144,1648,171"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1269,148,1427,175"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,101,1021,128"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,152,1215,179"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,349,1207,376"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,51,1199,77"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,203,1186,229"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,101,751,128"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,152,1015,179"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,152,771,179"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,203,732,229"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,253,731,280"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,152,543,179"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,405,1011,432"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,413,765,440"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,355,336,381"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,304,1004,331"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,406,543,447"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,329,129,356"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,304,777,331"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,51,963,77"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1481,195,1648,237"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1277,203,1419,229"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="1482,261,1647,288"/>
</map>
</div>

</div>
</div>
<a id="a629de40452a9be84148e3c8442a80db6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a629de40452a9be84148e3c8442a80db6">&#9670;&nbsp;</a></span>kvm_timer_update_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_update_run </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00430">430</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;{</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keyword">struct </span>arch_timer_context *vtimer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keyword">struct </span>arch_timer_context *ptimer = vcpu_ptimer(vcpu);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keyword">struct </span>kvm_sync_regs *regs = &amp;vcpu-&gt;run-&gt;s.regs;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">/* Populate the device bitmap with the timer states */</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    regs-&gt;device_irq_level &amp;= ~(KVM_ARM_DEV_EL1_VTIMER |</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    KVM_ARM_DEV_EL1_PTIMER);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a>(vtimer))</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        regs-&gt;device_irq_level |= KVM_ARM_DEV_EL1_VTIMER;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    if (<a class="code" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a>(ptimer))</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        regs-&gt;device_irq_level |= KVM_ARM_DEV_EL1_PTIMER;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a629de40452a9be84148e3c8442a80db6_cgraph.png" border="0" usemap="#aarch__timer_8c_a629de40452a9be84148e3c8442a80db6_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a629de40452a9be84148e3c8442a80db6_cgraph" id="aarch__timer_8c_a629de40452a9be84148e3c8442a80db6_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,179,108"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="227,81,397,108"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="449,5,616,32"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="445,56,620,83"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="473,107,592,133"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="468,157,597,184"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="668,56,776,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a629de40452a9be84148e3c8442a80db6_icgraph.png" border="0" usemap="#aarch__timer_8c_a629de40452a9be84148e3c8442a80db6_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a629de40452a9be84148e3c8442a80db6_icgraph" id="aarch__timer_8c_a629de40452a9be84148e3c8442a80db6_icgraph">
<area shape="rect" title=" " alt="" coords="412,5,585,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ab7dc50f59c235841d864ef598f814247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7dc50f59c235841d864ef598f814247">&#9670;&nbsp;</a></span>kvm_timer_vcpu_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_vcpu_init </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01011">1011</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;{</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(vcpu);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NR_KVM_TIMERS; i++)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <a class="code" href="arch__timer_8c.html#a277ad23da04b884fe1d588984e372943">timer_context_init</a>(vcpu, i);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">/* Synchronize offsets across timers of a VM if not already provided */</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span> (!test_bit(KVM_ARCH_FLAG_VM_COUNTER_OFFSET, &amp;vcpu-&gt;kvm-&gt;arch.flags)) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <a class="code" href="arch__timer_8c.html#aafe1b11938ff5abb30a790c16eb77c77">timer_set_offset</a>(vcpu_vtimer(vcpu), <a class="code" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98">kvm_phys_timer_read</a>());</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <a class="code" href="arch__timer_8c.html#aafe1b11938ff5abb30a790c16eb77c77">timer_set_offset</a>(vcpu_ptimer(vcpu), 0);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    hrtimer_init(&amp;timer-&gt;bg_timer, CLOCK_MONOTONIC, HRTIMER_MODE_ABS_HARD);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    timer-&gt;bg_timer.function = <a class="code" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e">kvm_bg_timer_expire</a>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a277ad23da04b884fe1d588984e372943"><div class="ttname"><a href="arch__timer_8c.html#a277ad23da04b884fe1d588984e372943">timer_context_init</a></div><div class="ttdeci">static void timer_context_init(struct kvm_vcpu *vcpu, int timerid)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00984">arch_timer.c:984</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_aa5109f58e0ef877d3f053d0593359c1e"><div class="ttname"><a href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e">kvm_bg_timer_expire</a></div><div class="ttdeci">static enum hrtimer_restart kvm_bg_timer_expire(struct hrtimer *hrt)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00307">arch_timer.c:330</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ab7dc50f59c235841d864ef598f814247_cgraph.png" border="0" usemap="#aarch__timer_8c_ab7dc50f59c235841d864ef598f814247_cgraph" alt=""/></div>
<map name="aarch__timer_8c_ab7dc50f59c235841d864ef598f814247_cgraph" id="aarch__timer_8c_ab7dc50f59c235841d864ef598f814247_cgraph">
<area shape="rect" title=" " alt="" coords="5,284,164,311"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="212,132,376,159"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="888,183,1055,209"/>
<area shape="rect" href="arch__timer_8c.html#a277ad23da04b884fe1d588984e372943" title=" " alt="" coords="223,309,365,336"/>
<area shape="rect" href="arch__timer_8c.html#aafe1b11938ff5abb30a790c16eb77c77" title=" " alt="" coords="230,360,358,387"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="424,107,621,133"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="435,157,610,184"/>
<area shape="rect" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913" title=" " alt="" coords="481,208,565,235"/>
<area shape="rect" href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518" title=" " alt="" coords="442,5,603,32"/>
<area shape="rect" href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b" title=" " alt="" coords="467,56,578,83"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="669,49,840,90"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="695,115,814,141"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="907,56,1036,83"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="701,165,809,192"/>
<area shape="rect" href="arch__timer_8c.html#abc4d9a1d61348137665ab9a6b18cfa5b" title=" " alt="" coords="445,309,600,336"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ab7dc50f59c235841d864ef598f814247_icgraph.png" border="0" usemap="#aarch__timer_8c_ab7dc50f59c235841d864ef598f814247_icgraph" alt=""/></div>
<map name="aarch__timer_8c_ab7dc50f59c235841d864ef598f814247_icgraph" id="aarch__timer_8c_ab7dc50f59c235841d864ef598f814247_icgraph">
<area shape="rect" title=" " alt="" coords="473,5,632,32"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="253,5,425,32"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="5,5,205,32"/>
</map>
</div>

</div>
</div>
<a id="a4bf6ac76380146820b45b06feb3eab27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bf6ac76380146820b45b06feb3eab27">&#9670;&nbsp;</a></span>kvm_timer_vcpu_load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_vcpu_load </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00826">826</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;{</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(vcpu);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keyword">struct </span>timer_map map;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">if</span> (unlikely(!timer-&gt;enabled))</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <a class="code" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21">get_timer_map</a>(vcpu, &amp;map);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">if</span> (static_branch_likely(&amp;has_gic_active_state)) {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">if</span> (vcpu_has_nv(vcpu))</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <a class="code" href="arch__timer_8c.html#a9f34b892b5c9b1e79065006b4353c76e">kvm_timer_vcpu_load_nested_switch</a>(vcpu, &amp;map);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <a class="code" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf">kvm_timer_vcpu_load_gic</a>(map.direct_vtimer);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">if</span> (map.direct_ptimer)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <a class="code" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf">kvm_timer_vcpu_load_gic</a>(map.direct_ptimer);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <a class="code" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520">kvm_timer_vcpu_load_nogic</a>(vcpu);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <a class="code" href="arch__timer_8c.html#aabed21346a0fc6b04d9fc11ee754d19a">kvm_timer_unblocking</a>(vcpu);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <a class="code" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301">timer_restore_state</a>(map.direct_vtimer);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">if</span> (map.direct_ptimer)</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <a class="code" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301">timer_restore_state</a>(map.direct_ptimer);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">if</span> (map.emul_vtimer)</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <a class="code" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a">timer_emulate</a>(map.emul_vtimer);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">if</span> (map.emul_ptimer)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <a class="code" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a">timer_emulate</a>(map.emul_ptimer);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="arch__timer_8c.html#af19caca81734fff66363042c1e8e2181">timer_set_traps</a>(vcpu, &amp;map);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a1c4f03de391e27f5ba91d10b6dfab0bf"><div class="ttname"><a href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf">kvm_timer_vcpu_load_gic</a></div><div class="ttdeci">static void kvm_timer_vcpu_load_gic(struct arch_timer_context *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00655">arch_timer.c:655</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a8fb06d125602c5b00fa9c213aa7e2520"><div class="ttname"><a href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520">kvm_timer_vcpu_load_nogic</a></div><div class="ttdeci">static void kvm_timer_vcpu_load_nogic(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00676">arch_timer.c:676</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a9f34b892b5c9b1e79065006b4353c76e"><div class="ttname"><a href="arch__timer_8c.html#a9f34b892b5c9b1e79065006b4353c76e">kvm_timer_vcpu_load_nested_switch</a></div><div class="ttdeci">static void kvm_timer_vcpu_load_nested_switch(struct kvm_vcpu *vcpu, struct timer_map *map)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00713">arch_timer.c:713</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_aabed21346a0fc6b04d9fc11ee754d19a"><div class="ttname"><a href="arch__timer_8c.html#aabed21346a0fc6b04d9fc11ee754d19a">kvm_timer_unblocking</a></div><div class="ttdeci">static void kvm_timer_unblocking(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00596">arch_timer.c:596</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_af19caca81734fff66363042c1e8e2181"><div class="ttname"><a href="arch__timer_8c.html#af19caca81734fff66363042c1e8e2181">timer_set_traps</a></div><div class="ttdeci">static void timer_set_traps(struct kvm_vcpu *vcpu, struct timer_map *map)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00764">arch_timer.c:764</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a4bf6ac76380146820b45b06feb3eab27_cgraph.png" border="0" usemap="#aarch__timer_8c_a4bf6ac76380146820b45b06feb3eab27_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a4bf6ac76380146820b45b06feb3eab27_cgraph" id="aarch__timer_8c_a4bf6ac76380146820b45b06feb3eab27_cgraph">
<area shape="rect" title=" " alt="" coords="5,368,172,395"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="255,191,377,217"/>
<area shape="rect" href="arch__timer_8c.html#aabed21346a0fc6b04d9fc11ee754d19a" title=" " alt="" coords="231,241,401,268"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="220,511,412,537"/>
<area shape="rect" href="arch__timer_8c.html#a9f34b892b5c9b1e79065006b4353c76e" title=" " alt="" coords="475,691,642,733"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="233,445,399,486"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="257,393,375,420"/>
<area shape="rect" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301" title=" " alt="" coords="483,183,634,209"/>
<area shape="rect" href="arch__timer_8c.html#af19caca81734fff66363042c1e8e2181" title=" " alt="" coords="254,292,378,319"/>
<area shape="rect" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710" title=" " alt="" coords="490,5,627,32"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="473,452,644,479"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="474,507,643,533"/>
<area shape="rect" href="vgic_8c.html#a1273f536f3d378a0b259e76591471f7b" title=" " alt="" coords="711,629,898,656"/>
<area shape="rect" href="arch__timer_8c.html#ae906d98d68ae56770507afe2e63ade68" title=" " alt="" coords="485,609,632,650"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="962,396,1129,423"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="717,427,892,453"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="745,259,864,285"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="981,283,1110,309"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="991,337,1099,364"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="729,579,881,605"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="735,528,874,555"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="995,655,1096,681"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="990,471,1101,497"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="995,705,1096,732"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="960,579,1131,605"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="959,528,1131,555"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1218,668,1318,695"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="1421,651,1555,677"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="1229,465,1307,492"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1416,307,1560,333"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1397,358,1579,399"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="1401,424,1575,451"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1426,475,1550,501"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="1437,525,1539,552"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1413,577,1563,618"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="1187,719,1349,745"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="1424,719,1552,745"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="1207,617,1329,644"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="1197,516,1339,543"/>
<area shape="rect" href="vgic_8c.html#a0a11de94338771a6d53dd409d4f4c49d" title=" " alt="" coords="730,680,879,707"/>
<area shape="rect" href="vgic_8c.html#ab4243e0ac375259b39c04a6cc6266a9f" title=" " alt="" coords="713,731,896,757"/>
<area shape="rect" href="vgic_8c.html#a4199ace0bb639bc69d06a2ce1ee0d1ff" title=" " alt="" coords="705,781,904,808"/>
<area shape="rect" href="vgic_8c.html#a727bab6843a2191df705d005fa7f764f" title=" " alt="" coords="973,756,1118,783"/>
<area shape="rect" href="vgic_8c.html#aeaf2d7fa188efb40aab886a1e19f14d8" title=" " alt="" coords="965,807,1126,833"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="460,351,657,377"/>
<area shape="rect" href="arch__timer_8c.html#a00de950346bea7137e0f06522d67ab2b" title=" " alt="" coords="496,300,621,327"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="719,361,890,402"/>
<area shape="rect" href="arch__timer_8c.html#a6fcfce8307e73b5ae888edca334508aa" title=" " alt="" coords="757,107,852,133"/>
<area shape="rect" href="arch__timer_8c.html#a207ce56a4fe08e050e49e49334548e15" title=" " alt="" coords="757,5,852,32"/>
<area shape="rect" href="nvhe_2timer-sr_8c.html#a73539c3eaa37749e44c40351913b9efb" title=" " alt="" coords="952,5,1139,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a4bf6ac76380146820b45b06feb3eab27_icgraph.png" border="0" usemap="#aarch__timer_8c_a4bf6ac76380146820b45b06feb3eab27_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a4bf6ac76380146820b45b06feb3eab27_icgraph" id="aarch__timer_8c_a4bf6ac76380146820b45b06feb3eab27_icgraph">
<area shape="rect" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a1c4f03de391e27f5ba91d10b6dfab0bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c4f03de391e27f5ba91d10b6dfab0bf">&#9670;&nbsp;</a></span>kvm_timer_vcpu_load_gic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_timer_vcpu_load_gic </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00655">655</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;{</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = ctx-&gt;vcpu;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordtype">bool</span> phys_active = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">     * Update the timer output so that it is likely to match the</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">     * state we&#39;re about to restore. If the timer expires between</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">     * this point and the register restoration, we&#39;ll take the</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">     * interrupt anyway.</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f">kvm_timer_update_irq</a>(ctx-&gt;vcpu, <a class="code" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a>(ctx), ctx);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">if</span> (irqchip_in_kernel(vcpu-&gt;kvm))</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        phys_active = <a class="code" href="vgic_8c.html#a1273f536f3d378a0b259e76591471f7b">kvm_vgic_map_is_active</a>(vcpu, timer_irq(ctx));</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    phys_active |= ctx-&gt;irq.level;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="arch__timer_8c.html#ae906d98d68ae56770507afe2e63ade68">set_timer_irq_phys_active</a>(ctx, phys_active);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_ae906d98d68ae56770507afe2e63ade68"><div class="ttname"><a href="arch__timer_8c.html#ae906d98d68ae56770507afe2e63ade68">set_timer_irq_phys_active</a></div><div class="ttdeci">static void set_timer_irq_phys_active(struct arch_timer_context *ctx, bool active)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00648">arch_timer.c:648</a></div></div>
<div class="ttc" id="avgic_8c_html_a1273f536f3d378a0b259e76591471f7b"><div class="ttname"><a href="vgic_8c.html#a1273f536f3d378a0b259e76591471f7b">kvm_vgic_map_is_active</a></div><div class="ttdeci">bool kvm_vgic_map_is_active(struct kvm_vcpu *vcpu, unsigned int vintid)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l01022">vgic.c:1022</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a1c4f03de391e27f5ba91d10b6dfab0bf_cgraph.png" border="0" usemap="#aarch__timer_8c_a1c4f03de391e27f5ba91d10b6dfab0bf_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a1c4f03de391e27f5ba91d10b6dfab0bf_cgraph" id="aarch__timer_8c_a1c4f03de391e27f5ba91d10b6dfab0bf_cgraph">
<area shape="rect" title=" " alt="" coords="5,324,197,351"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="245,132,416,159"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="246,299,415,325"/>
<area shape="rect" href="vgic_8c.html#a1273f536f3d378a0b259e76591471f7b" title=" " alt="" coords="464,644,651,671"/>
<area shape="rect" href="arch__timer_8c.html#ae906d98d68ae56770507afe2e63ade68" title=" " alt="" coords="257,401,404,442"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="474,183,641,209"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="470,11,645,37"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="498,81,617,108"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="493,132,622,159"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="731,5,839,32"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="481,324,633,351"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="488,273,627,300"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="734,644,835,671"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="729,335,840,361"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="2641,593,2743,620"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="2607,287,2777,313"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="699,107,871,133"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1765,644,1865,671"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="2839,669,2974,696"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="919,340,996,367"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1063,340,1207,367"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1044,274,1225,315"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="2218,391,2321,417"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="1047,492,1222,519"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1073,543,1197,569"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1060,209,1209,250"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1717,441,1912,468"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="1085,157,1185,184"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1287,281,1442,308"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="1504,307,1669,333"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1511,256,1663,283"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1729,256,1901,283"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="1999,285,2109,312"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="1985,107,2123,133"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="2196,260,2343,287"/>
<area shape="rect" href="vgic-its_8c.html#a53bf66e96dae9553e637fa69e8835365" title=" " alt="" coords="2196,311,2343,337"/>
<area shape="rect" href="vgic-its_8c.html#a352c8627ccf81a8154ae2275c7d50659" title=" " alt="" coords="2391,338,2559,379"/>
<area shape="rect" href="vgic-its_8c.html#ad62375be0591178764e98b79cd7217bf" title=" " alt="" coords="2398,287,2551,313"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="2825,593,2988,620"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="3076,593,3204,620"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="2845,131,2968,157"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="2835,287,2978,313"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="3036,105,3244,132"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="3063,156,3217,183"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="3082,287,3198,313"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1303,543,1426,569"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1303,492,1426,519"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="1273,157,1456,184"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="1295,208,1435,235"/>
<area shape="rect" href="vgic-v4_8c.html#ac22161596c9858cc700bab08c03fc422" title=" " alt="" coords="1960,157,2148,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a1c4f03de391e27f5ba91d10b6dfab0bf_icgraph.png" border="0" usemap="#aarch__timer_8c_a1c4f03de391e27f5ba91d10b6dfab0bf_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a1c4f03de391e27f5ba91d10b6dfab0bf_icgraph" id="aarch__timer_8c_a1c4f03de391e27f5ba91d10b6dfab0bf_icgraph">
<area shape="rect" title=" " alt="" coords="1684,237,1876,264"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a9f34b892b5c9b1e79065006b4353c76e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f34b892b5c9b1e79065006b4353c76e">&#9670;&nbsp;</a></span>kvm_timer_vcpu_load_nested_switch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_timer_vcpu_load_nested_switch </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timer_map *&#160;</td>
          <td class="paramname"><em>map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00713">713</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;{</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordtype">int</span> hw, ret;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">if</span> (!irqchip_in_kernel(vcpu-&gt;kvm))</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">     * We only ever unmap the vtimer irq on a VHE system that runs nested</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">     * virtualization, in which case we have both a valid emul_vtimer,</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">     * emul_ptimer, direct_vtimer, and direct_ptimer.</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">     * Since this is called from kvm_timer_vcpu_load(), a change between</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">     * vEL2 and vEL1/0 will have just happened, and the timer_map will</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">     * represent this, and therefore we switch the emul/direct mappings</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">     * below.</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    hw = <a class="code" href="vgic_8c.html#a0a11de94338771a6d53dd409d4f4c49d">kvm_vgic_get_map</a>(vcpu, timer_irq(map-&gt;direct_vtimer));</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">if</span> (hw &lt; 0) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <a class="code" href="vgic_8c.html#a4199ace0bb639bc69d06a2ce1ee0d1ff">kvm_vgic_unmap_phys_irq</a>(vcpu, timer_irq(map-&gt;emul_vtimer));</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <a class="code" href="vgic_8c.html#a4199ace0bb639bc69d06a2ce1ee0d1ff">kvm_vgic_unmap_phys_irq</a>(vcpu, timer_irq(map-&gt;emul_ptimer));</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        ret = <a class="code" href="vgic_8c.html#ab4243e0ac375259b39c04a6cc6266a9f">kvm_vgic_map_phys_irq</a>(vcpu,</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                        map-&gt;direct_vtimer-&gt;host_timer_irq,</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                        timer_irq(map-&gt;direct_vtimer),</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                        &amp;<a class="code" href="arch__timer_8c.html#a3ea143fc77aa4520f032211fd9487ae5">arch_timer_irq_ops</a>);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        WARN_ON_ONCE(ret);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        ret = <a class="code" href="vgic_8c.html#ab4243e0ac375259b39c04a6cc6266a9f">kvm_vgic_map_phys_irq</a>(vcpu,</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                        map-&gt;direct_ptimer-&gt;host_timer_irq,</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                        timer_irq(map-&gt;direct_ptimer),</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                        &amp;<a class="code" href="arch__timer_8c.html#a3ea143fc77aa4520f032211fd9487ae5">arch_timer_irq_ops</a>);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        WARN_ON_ONCE(ret);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">         * The virtual offset behaviour is &quot;interresting&quot;, as it</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">         * always applies when HCR_EL2.E2H==0, but only when</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">         * accessed from EL1 when HCR_EL2.E2H==1. So make sure we</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">         * track E2H when putting the HV timer in &quot;direct&quot; mode.</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">if</span> (map-&gt;direct_vtimer == vcpu_hvtimer(vcpu)) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="keyword">struct </span>arch_timer_offset *offs = &amp;map-&gt;direct_vtimer-&gt;offset;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keywordflow">if</span> (vcpu_el2_e2h_is_set(vcpu))</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                offs-&gt;vcpu_offset = NULL;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                offs-&gt;vcpu_offset = &amp;__vcpu_sys_reg(vcpu, CNTVOFF_EL2);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;}</div>
<div class="ttc" id="avgic_8c_html_a0a11de94338771a6d53dd409d4f4c49d"><div class="ttname"><a href="vgic_8c.html#a0a11de94338771a6d53dd409d4f4c49d">kvm_vgic_get_map</a></div><div class="ttdeci">int kvm_vgic_get_map(struct kvm_vcpu *vcpu, unsigned int vintid)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00576">vgic.c:576</a></div></div>
<div class="ttc" id="avgic_8c_html_a4199ace0bb639bc69d06a2ce1ee0d1ff"><div class="ttname"><a href="vgic_8c.html#a4199ace0bb639bc69d06a2ce1ee0d1ff">kvm_vgic_unmap_phys_irq</a></div><div class="ttdeci">int kvm_vgic_unmap_phys_irq(struct kvm_vcpu *vcpu, unsigned int vintid)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00557">vgic.c:557</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a9f34b892b5c9b1e79065006b4353c76e_cgraph.png" border="0" usemap="#aarch__timer_8c_a9f34b892b5c9b1e79065006b4353c76e_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a9f34b892b5c9b1e79065006b4353c76e_cgraph" id="aarch__timer_8c_a9f34b892b5c9b1e79065006b4353c76e_cgraph">
<area shape="rect" title=" " alt="" coords="5,74,172,115"/>
<area shape="rect" href="vgic_8c.html#a0a11de94338771a6d53dd409d4f4c49d" title=" " alt="" coords="245,81,394,108"/>
<area shape="rect" href="vgic_8c.html#ab4243e0ac375259b39c04a6cc6266a9f" title=" " alt="" coords="228,132,411,159"/>
<area shape="rect" href="vgic_8c.html#a4199ace0bb639bc69d06a2ce1ee0d1ff" title=" " alt="" coords="220,31,419,57"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="497,56,598,83"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="497,107,598,133"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="707,56,807,83"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="887,56,1021,83"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="676,107,839,133"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="890,107,1018,133"/>
<area shape="rect" href="vgic_8c.html#a727bab6843a2191df705d005fa7f764f" title=" " alt="" coords="475,157,620,184"/>
<area shape="rect" href="vgic_8c.html#aeaf2d7fa188efb40aab886a1e19f14d8" title=" " alt="" coords="467,5,628,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a9f34b892b5c9b1e79065006b4353c76e_icgraph.png" border="0" usemap="#aarch__timer_8c_a9f34b892b5c9b1e79065006b4353c76e_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a9f34b892b5c9b1e79065006b4353c76e_icgraph" id="aarch__timer_8c_a9f34b892b5c9b1e79065006b4353c76e_icgraph">
<area shape="rect" title=" " alt="" coords="1684,230,1851,271"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a8fb06d125602c5b00fa9c213aa7e2520"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fb06d125602c5b00fa9c213aa7e2520">&#9670;&nbsp;</a></span>kvm_timer_vcpu_load_nogic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_timer_vcpu_load_nogic </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00676">676</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;{</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keyword">struct </span>arch_timer_context *vtimer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">     * Update the timer output so that it is likely to match the</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">     * state we&#39;re about to restore. If the timer expires between</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">     * this point and the register restoration, we&#39;ll take the</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">     * interrupt anyway.</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <a class="code" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f">kvm_timer_update_irq</a>(vcpu, <a class="code" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a>(vtimer), vtimer);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">     * When using a userspace irqchip with the architected timers and a</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">     * host interrupt controller that doesn&#39;t support an active state, we</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">     * must still prevent continuously exiting from the guest, and</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">     * therefore mask the physical interrupt by disabling it on the host</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">     * interrupt controller when the virtual level is high, such that the</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">     * guest can make forward progress.  Once we detect the output level</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">     * being de-asserted, we unmask the interrupt again so that we exit</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">     * from the guest when the timer fires.</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">if</span> (vtimer-&gt;irq.level)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        disable_percpu_irq(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        enable_percpu_irq(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>, <a class="code" href="arch__timer_8c.html#ad0df8fd11369dad2ecb88bca05586a2a">host_vtimer_irq_flags</a>);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a8fb06d125602c5b00fa9c213aa7e2520_cgraph.png" border="0" usemap="#aarch__timer_8c_a8fb06d125602c5b00fa9c213aa7e2520_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a8fb06d125602c5b00fa9c213aa7e2520_cgraph" id="aarch__timer_8c_a8fb06d125602c5b00fa9c213aa7e2520_cgraph">
<area shape="rect" title=" " alt="" coords="5,521,172,562"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="220,427,391,453"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="221,579,390,605"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="443,427,609,453"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="439,477,613,504"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="467,325,585,352"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="461,376,591,403"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="693,427,801,453"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="450,579,602,605"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="457,629,595,656"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="697,688,798,715"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="692,477,803,504"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="2604,747,2705,773"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="2569,579,2740,605"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="661,579,833,605"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1727,695,1827,721"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="2802,637,2937,664"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="881,275,959,301"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1025,325,1169,352"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1007,427,1188,469"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="2603,401,2706,428"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="1010,56,1185,83"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1035,157,1159,184"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1023,209,1172,250"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1680,376,1875,403"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="1047,275,1147,301"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1250,435,1405,461"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="1467,427,1632,453"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1473,477,1625,504"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1691,477,1863,504"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="1962,477,2071,504"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="1948,528,2085,555"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="2159,528,2305,555"/>
<area shape="rect" href="vgic-its_8c.html#a53bf66e96dae9553e637fa69e8835365" title=" " alt="" coords="2159,477,2305,504"/>
<area shape="rect" href="vgic-its_8c.html#a352c8627ccf81a8154ae2275c7d50659" title=" " alt="" coords="2353,630,2521,671"/>
<area shape="rect" href="vgic-its_8c.html#ad62375be0591178764e98b79cd7217bf" title=" " alt="" coords="2361,528,2514,555"/>
<area shape="rect" href="vgic-its_8c.html#a94bbb30efc49ad5494a7f4b1410dbe01" title=" " alt="" coords="2376,477,2499,504"/>
<area shape="rect" href="vgic-its_8c.html#ab8e3bef933af0cc51b05259d801be26d" title=" " alt="" coords="2573,637,2736,664"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="2788,747,2951,773"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="3039,747,3167,773"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="2808,415,2931,441"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="2798,579,2941,605"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="2999,440,3207,467"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="3026,389,3179,416"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="3045,579,3161,605"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1266,56,1389,83"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1266,5,1389,32"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="1236,275,1419,301"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="1257,325,1397,352"/>
<area shape="rect" href="vgic-v4_8c.html#ac22161596c9858cc700bab08c03fc422" title=" " alt="" coords="1923,293,2111,320"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a8fb06d125602c5b00fa9c213aa7e2520_icgraph.png" border="0" usemap="#aarch__timer_8c_a8fb06d125602c5b00fa9c213aa7e2520_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a8fb06d125602c5b00fa9c213aa7e2520_icgraph" id="aarch__timer_8c_a8fb06d125602c5b00fa9c213aa7e2520_icgraph">
<area shape="rect" title=" " alt="" coords="1684,230,1851,271"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a0006e1b52ff819dd99be6dca260e52d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0006e1b52ff819dd99be6dca260e52d6">&#9670;&nbsp;</a></span>kvm_timer_vcpu_put()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_vcpu_put </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00877">877</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;{</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(vcpu);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keyword">struct </span>timer_map map;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">if</span> (unlikely(!timer-&gt;enabled))</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21">get_timer_map</a>(vcpu, &amp;map);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af">timer_save_state</a>(map.direct_vtimer);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">if</span> (map.direct_ptimer)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <a class="code" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af">timer_save_state</a>(map.direct_ptimer);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">     * Cancel soft timer emulation, because the only case where we</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">     * need it after a vcpu_put is in the context of a sleeping VCPU, and</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">     * in that case we already factor in the deadline for the physical</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">     * timer when scheduling the bg_timer.</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">     * In any case, we re-schedule the hrtimer for the physical timer when</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">     * coming back to the VCPU thread in kvm_timer_vcpu_load().</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">if</span> (map.emul_vtimer)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <a class="code" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710">soft_timer_cancel</a>(&amp;map.emul_vtimer-&gt;hrtimer);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">if</span> (map.emul_ptimer)</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <a class="code" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710">soft_timer_cancel</a>(&amp;map.emul_ptimer-&gt;hrtimer);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">if</span> (kvm_vcpu_is_blocking(vcpu))</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <a class="code" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041">kvm_timer_blocking</a>(vcpu);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a0abce4d3df0f10be896c5ff0cb489041"><div class="ttname"><a href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041">kvm_timer_blocking</a></div><div class="ttdeci">static void kvm_timer_blocking(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00571">arch_timer.c:571</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a0006e1b52ff819dd99be6dca260e52d6_cgraph.png" border="0" usemap="#aarch__timer_8c_a0006e1b52ff819dd99be6dca260e52d6_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a0006e1b52ff819dd99be6dca260e52d6_cgraph" id="aarch__timer_8c_a0006e1b52ff819dd99be6dca260e52d6_cgraph">
<area shape="rect" title=" " alt="" coords="5,132,164,159"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="444,5,565,32"/>
<area shape="rect" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041" title=" " alt="" coords="212,107,367,133"/>
<area shape="rect" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710" title=" " alt="" coords="221,157,358,184"/>
<area shape="rect" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af" title=" " alt="" coords="222,335,357,361"/>
<area shape="rect" href="arch__timer_8c.html#adbe9b97af2fe25eb9d48e231bba23fcf" title=" " alt="" coords="415,56,595,83"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="417,107,592,133"/>
<area shape="rect" href="arch__timer_8c.html#a00de950346bea7137e0f06522d67ab2b" title=" " alt="" coords="442,157,567,184"/>
<area shape="rect" href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518" title=" " alt="" coords="424,208,585,235"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="682,107,790,133"/>
<area shape="rect" href="arch__timer_8c.html#a6fcfce8307e73b5ae888edca334508aa" title=" " alt="" coords="457,259,552,285"/>
<area shape="rect" href="arch__timer_8c.html#a207ce56a4fe08e050e49e49334548e15" title=" " alt="" coords="457,309,552,336"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="440,360,569,387"/>
<area shape="rect" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac" title=" " alt="" coords="451,411,558,437"/>
<area shape="rect" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7" title=" " alt="" coords="445,461,564,488"/>
<area shape="rect" href="nvhe_2timer-sr_8c.html#a73539c3eaa37749e44c40351913b9efb" title=" " alt="" coords="643,309,829,336"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a0006e1b52ff819dd99be6dca260e52d6_icgraph.png" border="0" usemap="#aarch__timer_8c_a0006e1b52ff819dd99be6dca260e52d6_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a0006e1b52ff819dd99be6dca260e52d6_icgraph" id="aarch__timer_8c_a0006e1b52ff819dd99be6dca260e52d6_icgraph">
<area shape="rect" title=" " alt="" coords="1463,237,1621,264"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1263,237,1415,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1080,376,1204,403"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="1101,300,1183,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a11b9b6e6338bbec6085332661c934e91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11b9b6e6338bbec6085332661c934e91">&#9670;&nbsp;</a></span>kvm_timer_vcpu_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_vcpu_reset </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00938">938</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;{</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(vcpu);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keyword">struct </span>timer_map map;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <a class="code" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21">get_timer_map</a>(vcpu, &amp;map);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">     * The bits in CNTV_CTL are architecturally reset to UNKNOWN for ARMv8</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">     * and to 0 for ARMv7.  We provide an implementation that always</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">     * resets the timer to be disabled and unmasked and is compliant with</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">     * the ARMv7 architecture.</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913">nr_timers</a>(vcpu); i++)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <a class="code" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac">timer_set_ctl</a>(vcpu_get_timer(vcpu, i), 0);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">     * A vcpu running at EL2 is in charge of the offset applied to</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">     * the virtual timer, so use the physical VM offset, and point</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">     * the vcpu offset to CNTVOFF_EL2.</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">if</span> (vcpu_has_nv(vcpu)) {</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="keyword">struct </span>arch_timer_offset *offs = &amp;vcpu_vtimer(vcpu)-&gt;offset;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        offs-&gt;vcpu_offset = &amp;__vcpu_sys_reg(vcpu, CNTVOFF_EL2);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        offs-&gt;vm_offset = &amp;vcpu-&gt;kvm-&gt;arch.timer_data.poffset;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    }</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">if</span> (timer-&gt;enabled) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913">nr_timers</a>(vcpu); i++)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <a class="code" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f">kvm_timer_update_irq</a>(vcpu, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                         vcpu_get_timer(vcpu, i));</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordflow">if</span> (irqchip_in_kernel(vcpu-&gt;kvm)) {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <a class="code" href="vgic_8c.html#a37d0e0f4c579bc38afe8d5f91529a772">kvm_vgic_reset_mapped_irq</a>(vcpu, timer_irq(map.direct_vtimer));</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            <span class="keywordflow">if</span> (map.direct_ptimer)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <a class="code" href="vgic_8c.html#a37d0e0f4c579bc38afe8d5f91529a772">kvm_vgic_reset_mapped_irq</a>(vcpu, timer_irq(map.direct_ptimer));</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">if</span> (map.emul_vtimer)</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <a class="code" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710">soft_timer_cancel</a>(&amp;map.emul_vtimer-&gt;hrtimer);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">if</span> (map.emul_ptimer)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710">soft_timer_cancel</a>(&amp;map.emul_ptimer-&gt;hrtimer);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;}</div>
<div class="ttc" id="avgic_8c_html_a37d0e0f4c579bc38afe8d5f91529a772"><div class="ttname"><a href="vgic_8c.html#a37d0e0f4c579bc38afe8d5f91529a772">kvm_vgic_reset_mapped_irq</a></div><div class="ttdeci">void kvm_vgic_reset_mapped_irq(struct kvm_vcpu *vcpu, u32 vintid)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00540">vgic.c:540</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a11b9b6e6338bbec6085332661c934e91_cgraph.png" border="0" usemap="#aarch__timer_8c_a11b9b6e6338bbec6085332661c934e91_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a11b9b6e6338bbec6085332661c934e91_cgraph" id="aarch__timer_8c_a11b9b6e6338bbec6085332661c934e91_cgraph">
<area shape="rect" title=" " alt="" coords="5,620,176,647"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="248,493,369,520"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="224,544,393,571"/>
<area shape="rect" href="vgic_8c.html#a37d0e0f4c579bc38afe8d5f91529a772" title=" " alt="" coords="441,712,651,739"/>
<area shape="rect" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913" title=" " alt="" coords="267,645,351,672"/>
<area shape="rect" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710" title=" " alt="" coords="240,696,377,723"/>
<area shape="rect" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac" title=" " alt="" coords="255,747,362,773"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="470,544,622,571"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="477,493,615,520"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="734,712,835,739"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="729,409,840,436"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="2641,661,2743,688"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="2607,544,2777,571"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="699,107,871,133"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1765,712,1865,739"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="2839,603,2974,629"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="919,325,996,352"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1063,325,1207,352"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1044,377,1225,418"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="2641,341,2743,368"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="1047,493,1222,520"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1073,208,1197,235"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1060,259,1209,301"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1717,107,1912,133"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="1085,56,1185,83"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1287,341,1442,368"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="1504,341,1669,368"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1511,291,1663,317"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1729,291,1901,317"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="1999,333,2109,360"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="1985,275,2123,301"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="2196,341,2343,368"/>
<area shape="rect" href="vgic-its_8c.html#a53bf66e96dae9553e637fa69e8835365" title=" " alt="" coords="2196,468,2343,495"/>
<area shape="rect" href="vgic-its_8c.html#a352c8627ccf81a8154ae2275c7d50659" title=" " alt="" coords="2391,595,2559,637"/>
<area shape="rect" href="vgic-its_8c.html#ad62375be0591178764e98b79cd7217bf" title=" " alt="" coords="2398,493,2551,520"/>
<area shape="rect" href="vgic-its_8c.html#a94bbb30efc49ad5494a7f4b1410dbe01" title=" " alt="" coords="2413,443,2536,469"/>
<area shape="rect" href="vgic-its_8c.html#ab8e3bef933af0cc51b05259d801be26d" title=" " alt="" coords="2611,603,2773,629"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="2825,661,2988,688"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="3076,661,3204,688"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="2845,288,2968,315"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="2835,544,2978,571"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="3036,263,3244,289"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="3063,313,3217,340"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="3082,544,3198,571"/>
<area shape="rect" href="vgic-its_8c.html#a3fe23d687675cef46a95e36cf14d04e1" title=" " alt="" coords="2617,493,2767,520"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1303,443,1426,469"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1303,493,1426,520"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="1273,5,1456,32"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="1295,56,1435,83"/>
<area shape="rect" href="vgic-v4_8c.html#ac22161596c9858cc700bab08c03fc422" title=" " alt="" coords="1960,73,2148,100"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a11b9b6e6338bbec6085332661c934e91_icgraph.png" border="0" usemap="#aarch__timer_8c_a11b9b6e6338bbec6085332661c934e91_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a11b9b6e6338bbec6085332661c934e91_icgraph" id="aarch__timer_8c_a11b9b6e6338bbec6085332661c934e91_icgraph">
<area shape="rect" title=" " alt="" coords="1231,81,1401,108"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1053,81,1183,108"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="829,5,1005,32"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="619,48,781,75"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,107,336,133"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="837,157,998,184"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="398,41,557,82"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,132,129,159"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="384,157,571,184"/>
</map>
</div>

</div>
</div>
<a id="a1910c992141ccc5e0753c9440f66292e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1910c992141ccc5e0753c9440f66292e">&#9670;&nbsp;</a></span>kvm_timer_vcpu_terminate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_timer_vcpu_terminate </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01445">1445</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;{</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(vcpu);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710">soft_timer_cancel</a>(&amp;timer-&gt;bg_timer);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a1910c992141ccc5e0753c9440f66292e_cgraph.png" border="0" usemap="#aarch__timer_8c_a1910c992141ccc5e0753c9440f66292e_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a1910c992141ccc5e0753c9440f66292e_cgraph" id="aarch__timer_8c_a1910c992141ccc5e0753c9440f66292e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,208,32"/>
<area shape="rect" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710" title=" " alt="" coords="256,5,393,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a1910c992141ccc5e0753c9440f66292e_icgraph.png" border="0" usemap="#aarch__timer_8c_a1910c992141ccc5e0753c9440f66292e_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a1910c992141ccc5e0753c9440f66292e_icgraph" id="aarch__timer_8c_a1910c992141ccc5e0753c9440f66292e_icgraph">
<area shape="rect" title=" " alt="" coords="1705,79,1908,105"/>
<area shape="rect" href="arm_8c.html#a25d188e4f0871968b9f428c79720a502" title=" " alt="" coords="1477,79,1657,105"/>
<area shape="rect" href="kvm__main_8c.html#a7218df747387e4034ab8442f187306b1" title=" " alt="" coords="1257,53,1402,80"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="1229,104,1429,131"/>
<area shape="rect" href="kvm__main_8c.html#a0fcd9f7671bee7debec1bc05dcd9557b" title=" " alt="" coords="1029,53,1181,80"/>
<area shape="rect" href="arm_8c.html#ad84dda268db5d48c48f3ef2f438c62a7" title=" " alt="" coords="811,53,981,80"/>
<area shape="rect" href="kvm__main_8c.html#a54b22e6be98d31db1a83e7993fbcf4bc" title=" " alt="" coords="453,9,580,36"/>
<area shape="rect" href="kvm__main_8c.html#afd922c538c448ab1248cdb9dccae9410" title=" " alt="" coords="628,79,763,105"/>
<area shape="rect" href="kvm__main_8c.html#a955de4f2a1b3371438636eccab732b27" title=" " alt="" coords="212,5,405,32"/>
<area shape="rect" href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241" title=" " alt="" coords="459,104,574,131"/>
<area shape="rect" href="kvm__main_8c.html#a37fa7805021941c56fe174eae4c8c377" title=" " alt="" coords="234,56,383,83"/>
<area shape="rect" href="kvm__main_8c.html#af19040bdcea372f13eab66499d99201c" title=" " alt="" coords="226,107,391,133"/>
<area shape="rect" href="guest__memfd_8c.html#ad8912fbda61cdcb6d9e5a3c0f839e001" title=" " alt="" coords="231,157,386,184"/>
<area shape="rect" href="kvm__main_8c.html#af67afbdcee89641f21573ac643d8e693" title=" " alt="" coords="241,208,376,235"/>
<area shape="rect" href="kvm__main_8c.html#a87bcafdc42ee32aedb84df5e564f9872" title=" " alt="" coords="5,56,164,83"/>
</map>
</div>

</div>
</div>
<a id="a971e3b70c1ab3b3d6eab6188d8734cc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a971e3b70c1ab3b3d6eab6188d8734cc2">&#9670;&nbsp;</a></span>kvm_vm_ioctl_set_counter_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vm_ioctl_set_counter_offset </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_arm_counter_offset *&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01651">1651</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;{</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordflow">if</span> (offset-&gt;reserved)</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    mutex_lock(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arm_8c.html#a02feef111fec875eb6382835eb2fb620">lock_all_vcpus</a>(kvm)) {</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        set_bit(KVM_ARCH_FLAG_VM_COUNTER_OFFSET, &amp;kvm-&gt;arch.flags);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160; </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment">         * If userspace decides to set the offset using this</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment">         * API rather than merely restoring the counter</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment">         * values, the offset applies to both the virtual and</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment">         * physical views.</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        kvm-&gt;arch.timer_data.voffset = offset-&gt;counter_offset;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        kvm-&gt;arch.timer_data.poffset = offset-&gt;counter_offset;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160; </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        <a class="code" href="arm_8c.html#a29e56a77bf87bcd1b20ed8a14d9b2778">unlock_all_vcpus</a>(kvm);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        ret = -EBUSY;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    }</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    mutex_unlock(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; </div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;}</div>
<div class="ttc" id="aarm_8c_html_a02feef111fec875eb6382835eb2fb620"><div class="ttname"><a href="arm_8c.html#a02feef111fec875eb6382835eb2fb620">lock_all_vcpus</a></div><div class="ttdeci">bool lock_all_vcpus(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="arm_8c_source.html#l01773">arm.c:1773</a></div></div>
<div class="ttc" id="aarm_8c_html_a29e56a77bf87bcd1b20ed8a14d9b2778"><div class="ttname"><a href="arm_8c.html#a29e56a77bf87bcd1b20ed8a14d9b2778">unlock_all_vcpus</a></div><div class="ttdeci">void unlock_all_vcpus(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="arm_8c_source.html#l01765">arm.c:1765</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a971e3b70c1ab3b3d6eab6188d8734cc2_cgraph.png" border="0" usemap="#aarch__timer_8c_a971e3b70c1ab3b3d6eab6188d8734cc2_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a971e3b70c1ab3b3d6eab6188d8734cc2_cgraph" id="aarch__timer_8c_a971e3b70c1ab3b3d6eab6188d8734cc2_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,203,65"/>
<area shape="rect" href="arm_8c.html#a02feef111fec875eb6382835eb2fb620" title=" " alt="" coords="259,5,376,32"/>
<area shape="rect" href="arm_8c.html#a29e56a77bf87bcd1b20ed8a14d9b2778" title=" " alt="" coords="251,56,384,83"/>
<area shape="rect" href="arm_8c.html#ac85c173d1f7208735e68f95eec2aac14" title=" " alt="" coords="432,31,543,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a971e3b70c1ab3b3d6eab6188d8734cc2_icgraph.png" border="0" usemap="#aarch__timer_8c_a971e3b70c1ab3b3d6eab6188d8734cc2_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a971e3b70c1ab3b3d6eab6188d8734cc2_icgraph" id="aarch__timer_8c_a971e3b70c1ab3b3d6eab6188d8734cc2_icgraph">
<area shape="rect" title=" " alt="" coords="203,5,400,47"/>
<area shape="rect" href="arm_8c.html#a10224987f77e7370dd9f2b80352544ab" title=" " alt="" coords="5,13,155,39"/>
</map>
</div>

</div>
</div>
<a id="ad2a704b646b65309708c3a7f6ab70913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2a704b646b65309708c3a7f6ab70913">&#9670;&nbsp;</a></span>nr_timers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int nr_timers </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00058">58</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (!vcpu_has_nv(vcpu))</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">return</span> NR_KVM_EL0_TIMERS;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">return</span> NR_KVM_TIMERS;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ad2a704b646b65309708c3a7f6ab70913_icgraph.png" border="0" usemap="#aarch__timer_8c_ad2a704b646b65309708c3a7f6ab70913_icgraph" alt=""/></div>
<map name="aarch__timer_8c_ad2a704b646b65309708c3a7f6ab70913_icgraph" id="aarch__timer_8c_ad2a704b646b65309708c3a7f6ab70913_icgraph">
<area shape="rect" title=" " alt="" coords="1536,107,1620,133"/>
<area shape="rect" href="arch__timer_8c.html#a25b09c8d95a2582f37a1a2719920e59c" title=" " alt="" coords="1325,15,1481,57"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="1321,81,1485,108"/>
<area shape="rect" href="arch__timer_8c.html#a11b9b6e6338bbec6085332661c934e91" title=" " alt="" coords="1317,132,1488,159"/>
<area shape="rect" href="arch__timer_8c.html#a7a37a6f350a857f42fe872aeebc8e2e4" title=" " alt="" coords="1325,183,1480,209"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="1111,31,1269,57"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="889,5,1061,32"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="639,5,839,32"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1125,132,1255,159"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="887,56,1063,83"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="657,99,820,125"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="191,157,350,184"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="894,208,1055,235"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="422,91,581,133"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,208,129,235"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,208,364,235"/>
<area shape="rect" href="arch__timer_8c.html#a6eb7255c40d5b43938e99918b3d9d06a" title=" " alt="" coords="1118,209,1262,236"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="412,259,591,301"/>
</map>
</div>

</div>
</div>
<a id="a2fb3bc59ad8d869dc692674f2db4bfe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fb3bc59ad8d869dc692674f2db4bfe9">&#9670;&nbsp;</a></span>read_timer_ctl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 read_timer_ctl </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>timer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01091">1091</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;{</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">     * Set ISTATUS bit if it&#39;s expired.</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">     * Note that according to ARMv8 ARM Issue A.k, ISTATUS bit is</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">     * UNKNOWN when ENABLE bit is 0, so we chose to set ISTATUS bit</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">     * regardless of ENABLE bit for our implementation convenience.</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    u32 ctl = <a class="code" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13">timer_get_ctl</a>(timer);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3">kvm_timer_compute_delta</a>(timer))</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        ctl |= ARCH_TIMER_CTRL_IT_STAT;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">return</span> ctl;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a2fb3bc59ad8d869dc692674f2db4bfe9_cgraph.png" border="0" usemap="#aarch__timer_8c_a2fb3bc59ad8d869dc692674f2db4bfe9_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a2fb3bc59ad8d869dc692674f2db4bfe9_cgraph" id="aarch__timer_8c_a2fb3bc59ad8d869dc692674f2db4bfe9_cgraph">
<area shape="rect" title=" " alt="" coords="5,85,121,112"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="169,60,367,87"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="214,111,322,137"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="415,23,585,65"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="441,89,559,116"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="633,5,800,32"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="652,56,781,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a2fb3bc59ad8d869dc692674f2db4bfe9_icgraph.png" border="0" usemap="#aarch__timer_8c_a2fb3bc59ad8d869dc692674f2db4bfe9_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a2fb3bc59ad8d869dc692674f2db4bfe9_icgraph" id="aarch__timer_8c_a2fb3bc59ad8d869dc692674f2db4bfe9_icgraph">
<area shape="rect" title=" " alt="" coords="1204,81,1320,108"/>
<area shape="rect" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894" title=" " alt="" coords="993,81,1156,108"/>
<area shape="rect" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc" title=" " alt="" coords="763,52,945,79"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="773,103,935,145"/>
<area shape="rect" href="guest_8c.html#a91e885a78ebf3a7c410b4b8ffa443729" title=" " alt="" coords="587,5,700,32"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="577,56,710,83"/>
<area shape="rect" href="guest_8c.html#ad1a71190592cc60155333934b84d1d11" title=" " alt="" coords="384,5,524,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,5,336,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="572,111,715,137"/>
</map>
</div>

</div>
</div>
<a id="a6fcfce8307e73b5ae888edca334508aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fcfce8307e73b5ae888edca334508aa">&#9670;&nbsp;</a></span>set_cntpoff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_cntpoff </td>
          <td>(</td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>cntpoff</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00491">491</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;{</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">if</span> (has_cntpoff())</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        write_sysreg_s(cntpoff, SYS_CNTPOFF_EL2);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a6fcfce8307e73b5ae888edca334508aa_icgraph.png" border="0" usemap="#aarch__timer_8c_a6fcfce8307e73b5ae888edca334508aa_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a6fcfce8307e73b5ae888edca334508aa_icgraph" id="aarch__timer_8c_a6fcfce8307e73b5ae888edca334508aa_icgraph">
<area shape="rect" title=" " alt="" coords="1920,289,2015,316"/>
<area shape="rect" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301" title=" " alt="" coords="1721,315,1872,341"/>
<area shape="rect" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af" title=" " alt="" coords="1729,260,1864,287"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1509,249,1671,290"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1507,314,1673,355"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1507,380,1673,407"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1308,289,1451,316"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1300,360,1459,387"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="1056,411,1252,437"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1081,360,1227,387"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1089,208,1219,235"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1097,309,1211,336"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="873,56,961,83"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,512,751,539"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="825,411,1008,437"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,411,771,437"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,461,732,488"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,360,731,387"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,411,543,437"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="829,157,1005,184"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,179,765,205"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,179,336,205"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="836,107,997,133"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,171,543,213"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,149,129,176"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,77,777,104"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="877,309,956,336"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,309,740,336"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1511,197,1669,224"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1303,239,1455,265"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1092,259,1216,285"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="876,5,957,32"/>
</map>
</div>

</div>
</div>
<a id="a207ce56a4fe08e050e49e49334548e15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a207ce56a4fe08e050e49e49334548e15">&#9670;&nbsp;</a></span>set_cntvoff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_cntvoff </td>
          <td>(</td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>cntvoff</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00486">486</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;{</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    kvm_call_hyp(<a class="code" href="nvhe_2timer-sr_8c.html#a73539c3eaa37749e44c40351913b9efb">__kvm_timer_set_cntvoff</a>, cntvoff);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div>
<div class="ttc" id="anvhe_2timer-sr_8c_html_a73539c3eaa37749e44c40351913b9efb"><div class="ttname"><a href="nvhe_2timer-sr_8c.html#a73539c3eaa37749e44c40351913b9efb">__kvm_timer_set_cntvoff</a></div><div class="ttdeci">void __kvm_timer_set_cntvoff(u64 cntvoff)</div><div class="ttdef"><b>Definition:</b> <a href="nvhe_2timer-sr_8c_source.html#l00014">timer-sr.c:14</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a207ce56a4fe08e050e49e49334548e15_cgraph.png" border="0" usemap="#aarch__timer_8c_a207ce56a4fe08e050e49e49334548e15_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a207ce56a4fe08e050e49e49334548e15_cgraph" id="aarch__timer_8c_a207ce56a4fe08e050e49e49334548e15_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,100,32"/>
<area shape="rect" href="nvhe_2timer-sr_8c.html#a73539c3eaa37749e44c40351913b9efb" title=" " alt="" coords="148,5,335,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a207ce56a4fe08e050e49e49334548e15_icgraph.png" border="0" usemap="#aarch__timer_8c_a207ce56a4fe08e050e49e49334548e15_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a207ce56a4fe08e050e49e49334548e15_icgraph" id="aarch__timer_8c_a207ce56a4fe08e050e49e49334548e15_icgraph">
<area shape="rect" title=" " alt="" coords="1920,289,2015,316"/>
<area shape="rect" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301" title=" " alt="" coords="1721,315,1872,341"/>
<area shape="rect" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af" title=" " alt="" coords="1729,260,1864,287"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1509,249,1671,290"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1507,314,1673,355"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1507,380,1673,407"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1308,289,1451,316"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1300,360,1459,387"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="1056,411,1252,437"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1081,360,1227,387"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1089,208,1219,235"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1097,309,1211,336"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="873,56,961,83"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,512,751,539"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="825,411,1008,437"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,411,771,437"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,461,732,488"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,360,731,387"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,411,543,437"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="829,157,1005,184"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,179,765,205"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,179,336,205"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="836,107,997,133"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,171,543,213"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,149,129,176"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,77,777,104"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="877,309,956,336"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,309,740,336"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1511,197,1669,224"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1303,239,1455,265"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1092,259,1216,285"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="876,5,957,32"/>
</map>
</div>

</div>
</div>
<a id="ae906d98d68ae56770507afe2e63ade68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae906d98d68ae56770507afe2e63ade68">&#9670;&nbsp;</a></span>set_timer_irq_phys_active()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_timer_irq_phys_active </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>active</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00648">648</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;{</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    r = irq_set_irqchip_state(ctx-&gt;host_timer_irq, IRQCHIP_STATE_ACTIVE, active);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    WARN_ON(r);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ae906d98d68ae56770507afe2e63ade68_icgraph.png" border="0" usemap="#aarch__timer_8c_ae906d98d68ae56770507afe2e63ade68_icgraph" alt=""/></div>
<map name="aarch__timer_8c_ae906d98d68ae56770507afe2e63ade68_icgraph" id="aarch__timer_8c_ae906d98d68ae56770507afe2e63ade68_icgraph">
<area shape="rect" title=" " alt="" coords="1931,347,2077,389"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1691,329,1883,356"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1695,380,1878,407"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1476,292,1643,319"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1266,253,1425,280"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,93,1021,120"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,208,1215,235"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,299,1207,325"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,45,1199,72"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,400,1186,427"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,56,751,83"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,157,1015,184"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,208,732,235"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,157,543,184"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,349,1011,376"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,339,765,365"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,339,336,365"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,400,1004,427"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,331,543,373"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,389,129,416"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,440,777,467"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,17,963,44"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,5,740,32"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="1263,380,1428,407"/>
</map>
</div>

</div>
</div>
<a id="ad19b9cbace853dd534bf572a35f83710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad19b9cbace853dd534bf572a35f83710">&#9670;&nbsp;</a></span>soft_timer_cancel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void soft_timer_cancel </td>
          <td>(</td>
          <td class="paramtype">struct hrtimer *&#160;</td>
          <td class="paramname"><em>hrt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00219">219</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    hrtimer_cancel(hrt);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ad19b9cbace853dd534bf572a35f83710_icgraph.png" border="0" usemap="#aarch__timer_8c_ad19b9cbace853dd534bf572a35f83710_icgraph" alt=""/></div>
<map name="aarch__timer_8c_ad19b9cbace853dd534bf572a35f83710_icgraph" id="aarch__timer_8c_ad19b9cbace853dd534bf572a35f83710_icgraph">
<area shape="rect" title=" " alt="" coords="2096,281,2233,308"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1863,165,2030,206"/>
<area shape="rect" href="arch__timer_8c.html#aabed21346a0fc6b04d9fc11ee754d19a" title=" " alt="" coords="1861,281,2032,308"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1867,231,2026,257"/>
<area shape="rect" href="arch__timer_8c.html#a11b9b6e6338bbec6085332661c934e91" title=" " alt="" coords="1861,343,2032,369"/>
<area shape="rect" href="arch__timer_8c.html#a1910c992141ccc5e0753c9440f66292e" title=" " alt="" coords="1845,393,2048,420"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1636,172,1779,199"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1624,279,1791,305"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1390,265,1549,292"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="1125,208,1321,235"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1151,157,1296,184"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1159,360,1288,387"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1166,259,1281,285"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="942,259,1030,285"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="686,157,821,184"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="895,56,1077,83"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="667,56,840,83"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="705,107,801,133"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="706,5,801,32"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="453,56,612,83"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="898,411,1074,437"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="672,419,835,445"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="229,360,388,387"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="905,309,1067,336"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="453,411,612,453"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="23,323,147,349"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="660,284,847,311"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="947,208,1025,235"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="697,208,809,235"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1393,203,1545,229"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1161,107,1285,133"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="945,107,1027,133"/>
<area shape="rect" href="arm_8c.html#a25d188e4f0871968b9f428c79720a502" title=" " alt="" coords="1617,432,1797,459"/>
<area shape="rect" href="kvm__main_8c.html#a7218df747387e4034ab8442f187306b1" title=" " alt="" coords="1397,432,1542,459"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="1369,483,1569,509"/>
<area shape="rect" href="kvm__main_8c.html#a0fcd9f7671bee7debec1bc05dcd9557b" title=" " alt="" coords="1147,461,1299,488"/>
<area shape="rect" href="arm_8c.html#ad84dda268db5d48c48f3ef2f438c62a7" title=" " alt="" coords="901,512,1071,539"/>
<area shape="rect" href="kvm__main_8c.html#a54b22e6be98d31db1a83e7993fbcf4bc" title=" " alt="" coords="469,495,596,521"/>
<area shape="rect" href="kvm__main_8c.html#afd922c538c448ab1248cdb9dccae9410" title=" " alt="" coords="686,545,821,572"/>
<area shape="rect" href="kvm__main_8c.html#a955de4f2a1b3371438636eccab732b27" title=" " alt="" coords="212,481,405,508"/>
<area shape="rect" href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241" title=" " alt="" coords="475,557,590,584"/>
<area shape="rect" href="kvm__main_8c.html#a37fa7805021941c56fe174eae4c8c377" title=" " alt="" coords="234,633,383,660"/>
<area shape="rect" href="kvm__main_8c.html#af19040bdcea372f13eab66499d99201c" title=" " alt="" coords="226,684,391,711"/>
<area shape="rect" href="guest__memfd_8c.html#ad8912fbda61cdcb6d9e5a3c0f839e001" title=" " alt="" coords="231,532,386,559"/>
<area shape="rect" href="kvm__main_8c.html#af67afbdcee89641f21573ac643d8e693" title=" " alt="" coords="241,583,376,609"/>
<area shape="rect" href="kvm__main_8c.html#a87bcafdc42ee32aedb84df5e564f9872" title=" " alt="" coords="5,633,164,660"/>
</map>
</div>

</div>
</div>
<a id="a00de950346bea7137e0f06522d67ab2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00de950346bea7137e0f06522d67ab2b">&#9670;&nbsp;</a></span>soft_timer_start()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void soft_timer_start </td>
          <td>(</td>
          <td class="paramtype">struct hrtimer *&#160;</td>
          <td class="paramname"><em>hrt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00213">213</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;{</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    hrtimer_start(hrt, ktime_add_ns(ktime_get(), ns),</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;              HRTIMER_MODE_ABS_HARD);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a00de950346bea7137e0f06522d67ab2b_icgraph.png" border="0" usemap="#aarch__timer_8c_a00de950346bea7137e0f06522d67ab2b_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a00de950346bea7137e0f06522d67ab2b_icgraph" id="aarch__timer_8c_a00de950346bea7137e0f06522d67ab2b_icgraph">
<area shape="rect" title=" " alt="" coords="1924,335,2049,361"/>
<area shape="rect" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041" title=" " alt="" coords="1721,360,1876,387"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1739,305,1858,332"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1511,364,1669,391"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1303,360,1455,387"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="1056,411,1252,437"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1081,360,1227,387"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1089,208,1219,235"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1092,309,1216,336"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="876,56,957,83"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,512,751,539"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="825,411,1008,437"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,411,771,437"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,461,732,488"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,360,731,387"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,411,543,437"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="829,157,1005,184"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,179,765,205"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,179,336,205"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="836,107,997,133"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,171,543,213"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,149,129,176"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,77,777,104"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="877,309,956,336"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,309,740,336"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1507,298,1673,339"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1507,247,1673,273"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1308,305,1451,332"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1300,255,1459,281"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1097,259,1211,285"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="873,5,961,32"/>
</map>
</div>

</div>
</div>
<a id="a277ad23da04b884fe1d588984e372943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a277ad23da04b884fe1d588984e372943">&#9670;&nbsp;</a></span>timer_context_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_context_init </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timerid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00984">984</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;{</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keyword">struct </span>arch_timer_context *ctxt = vcpu_get_timer(vcpu, timerid);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keyword">struct </span>kvm *kvm = vcpu-&gt;kvm;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    ctxt-&gt;vcpu = vcpu;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordflow">if</span> (timerid == TIMER_VTIMER)</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        ctxt-&gt;offset.vm_offset = &amp;kvm-&gt;arch.timer_data.voffset;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        ctxt-&gt;offset.vm_offset = &amp;kvm-&gt;arch.timer_data.poffset;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    hrtimer_init(&amp;ctxt-&gt;hrtimer, CLOCK_MONOTONIC, HRTIMER_MODE_ABS_HARD);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    ctxt-&gt;hrtimer.function = <a class="code" href="arch__timer_8c.html#abc4d9a1d61348137665ab9a6b18cfa5b">kvm_hrtimer_expire</a>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">switch</span> (timerid) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">case</span> TIMER_PTIMER:</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">case</span> TIMER_HPTIMER:</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        ctxt-&gt;host_timer_irq = <a class="code" href="arch__timer_8c.html#a20d4a341dfd2af12f6b5b19bfde475c1">host_ptimer_irq</a>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">case</span> TIMER_VTIMER:</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordflow">case</span> TIMER_HVTIMER:</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        ctxt-&gt;host_timer_irq = <a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_abc4d9a1d61348137665ab9a6b18cfa5b"><div class="ttname"><a href="arch__timer_8c.html#abc4d9a1d61348137665ab9a6b18cfa5b">kvm_hrtimer_expire</a></div><div class="ttdeci">static enum hrtimer_restart kvm_hrtimer_expire(struct hrtimer *hrt)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00307">arch_timer.c:354</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a277ad23da04b884fe1d588984e372943_cgraph.png" border="0" usemap="#aarch__timer_8c_a277ad23da04b884fe1d588984e372943_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a277ad23da04b884fe1d588984e372943_cgraph" id="aarch__timer_8c_a277ad23da04b884fe1d588984e372943_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,147,32"/>
<area shape="rect" href="arch__timer_8c.html#abc4d9a1d61348137665ab9a6b18cfa5b" title=" " alt="" coords="195,5,349,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a277ad23da04b884fe1d588984e372943_icgraph.png" border="0" usemap="#aarch__timer_8c_a277ad23da04b884fe1d588984e372943_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a277ad23da04b884fe1d588984e372943_icgraph" id="aarch__timer_8c_a277ad23da04b884fe1d588984e372943_icgraph">
<area shape="rect" title=" " alt="" coords="680,5,821,32"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="473,5,632,32"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="253,5,425,32"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="5,5,205,32"/>
</map>
</div>

</div>
</div>
<a id="acea899fae895cedf39458ed51af3cb1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acea899fae895cedf39458ed51af3cb1a">&#9670;&nbsp;</a></span>timer_emulate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_emulate </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00464">464</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;{</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordtype">bool</span> should_fire = <a class="code" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a>(ctx);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    trace_kvm_timer_emulate(ctx, should_fire);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (should_fire != ctx-&gt;irq.level) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f">kvm_timer_update_irq</a>(ctx-&gt;vcpu, should_fire, ctx);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">     * If the timer can fire now, we don&#39;t need to have a soft timer</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">     * scheduled for the future.  If the timer cannot fire at all,</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">     * then we also don&#39;t need a soft timer.</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span> (should_fire || !<a class="code" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f">kvm_timer_irq_can_fire</a>(ctx))</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="arch__timer_8c.html#a00de950346bea7137e0f06522d67ab2b">soft_timer_start</a>(&amp;ctx-&gt;hrtimer, <a class="code" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3">kvm_timer_compute_delta</a>(ctx));</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_acea899fae895cedf39458ed51af3cb1a_cgraph.png" border="0" usemap="#aarch__timer_8c_acea899fae895cedf39458ed51af3cb1a_cgraph" alt=""/></div>
<map name="aarch__timer_8c_acea899fae895cedf39458ed51af3cb1a_cgraph" id="aarch__timer_8c_acea899fae895cedf39458ed51af3cb1a_cgraph">
<area shape="rect" title=" " alt="" coords="5,223,124,250"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="172,71,369,98"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="417,223,592,250"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="185,173,356,199"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="186,274,355,301"/>
<area shape="rect" href="arch__timer_8c.html#a00de950346bea7137e0f06522d67ab2b" title=" " alt="" coords="208,325,333,351"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="419,5,590,47"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="445,71,564,98"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="643,106,809,133"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="661,34,791,61"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="672,198,780,225"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="429,350,581,377"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="435,274,574,301"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="675,299,777,326"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="671,603,781,630"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="2552,249,2653,275"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="2517,394,2688,421"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="640,350,812,377"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1706,299,1806,326"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="2750,333,2885,359"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="860,705,937,731"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1004,755,1148,782"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="985,520,1167,561"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="2109,654,2211,681"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="989,923,1163,950"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1014,806,1138,833"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1001,857,1151,899"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1659,705,1853,731"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="1026,603,1126,630"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1229,502,1383,529"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="1445,502,1611,529"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1452,553,1604,579"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1670,527,1842,554"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="1915,527,2025,554"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="1901,451,2039,478"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="2087,527,2233,554"/>
<area shape="rect" href="vgic-its_8c.html#a53bf66e96dae9553e637fa69e8835365" title=" " alt="" coords="2087,361,2233,387"/>
<area shape="rect" href="vgic-its_8c.html#a352c8627ccf81a8154ae2275c7d50659" title=" " alt="" coords="2291,351,2459,392"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="2736,249,2899,275"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="2987,249,3115,275"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="2756,483,2879,510"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="2746,394,2889,421"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="2947,509,3155,535"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="2974,458,3127,485"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="2993,394,3109,421"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1245,898,1367,925"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1245,949,1367,975"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="1215,603,1397,630"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="1236,553,1376,579"/>
<area shape="rect" href="vgic-v4_8c.html#ac22161596c9858cc700bab08c03fc422" title=" " alt="" coords="2281,489,2469,515"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_acea899fae895cedf39458ed51af3cb1a_icgraph.png" border="0" usemap="#aarch__timer_8c_acea899fae895cedf39458ed51af3cb1a_icgraph" alt=""/></div>
<map name="aarch__timer_8c_acea899fae895cedf39458ed51af3cb1a_icgraph" id="aarch__timer_8c_acea899fae895cedf39458ed51af3cb1a_icgraph">
<area shape="rect" title=" " alt="" coords="1684,208,1803,235"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1469,171,1636,213"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1271,179,1413,205"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="ad7dab91af9f69654aa27010f96125c13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7dab91af9f69654aa27010f96125c13">&#9670;&nbsp;</a></span>timer_get_ctl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u32 timer_get_ctl </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctxt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00066">66</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = ctxt-&gt;vcpu;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">switch</span>(arch_timer_ctx_index(ctxt)) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">case</span> TIMER_VTIMER:</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">return</span> __vcpu_sys_reg(vcpu, CNTV_CTL_EL0);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">case</span> TIMER_PTIMER:</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">return</span> __vcpu_sys_reg(vcpu, CNTP_CTL_EL0);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">case</span> TIMER_HVTIMER:</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">return</span> __vcpu_sys_reg(vcpu, CNTHV_CTL_EL2);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">case</span> TIMER_HPTIMER:</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">return</span> __vcpu_sys_reg(vcpu, CNTHP_CTL_EL2);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        WARN_ON(1);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ad7dab91af9f69654aa27010f96125c13_icgraph.png" border="0" usemap="#aarch__timer_8c_ad7dab91af9f69654aa27010f96125c13_icgraph" alt=""/></div>
<map name="aarch__timer_8c_ad7dab91af9f69654aa27010f96125c13_icgraph" id="aarch__timer_8c_ad7dab91af9f69654aa27010f96125c13_icgraph">
<area shape="rect" title=" " alt="" coords="2077,557,2185,584"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="1855,456,2029,483"/>
<area shape="rect" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9" title=" " alt="" coords="1884,608,2000,635"/>
<area shape="rect" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301" title=" " alt="" coords="1401,507,1552,533"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="1639,456,1803,483"/>
<area shape="rect" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041" title=" " alt="" coords="1644,507,1799,533"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="1636,237,1807,264"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1417,405,1536,432"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="1397,456,1556,483"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="1140,375,1312,401"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="887,375,1087,401"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1147,557,1305,584"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="911,476,1063,503"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="643,273,839,300"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="668,425,813,452"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="676,476,805,503"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="679,324,803,351"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="463,324,544,351"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="203,324,338,351"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="412,425,595,452"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="415,527,591,553"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="189,488,352,515"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="423,375,584,401"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="424,577,583,604"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,172,364,199"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,387,129,413"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="464,273,543,300"/>
<area shape="rect" href="arch__timer_8c.html#a25b09c8d95a2582f37a1a2719920e59c" title=" " alt="" coords="1399,289,1555,330"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1385,355,1569,381"/>
<area shape="rect" href="arch__timer_8c.html#a939939efd4c7eb8c054ca12e04623358" title=" " alt="" coords="1365,69,1588,96"/>
<area shape="rect" href="arch__timer_8c.html#a629de40452a9be84148e3c8442a80db6" title=" " alt="" coords="417,120,590,147"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1381,237,1573,264"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1393,171,1560,213"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1385,19,1568,45"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="1150,324,1302,351"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="923,324,1051,351"/>
<area shape="rect" href="arm_8c.html#a545524d72330cd45dae4f51a686943c0" title=" " alt="" coords="415,69,592,96"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1143,273,1309,300"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="907,273,1066,300"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="683,223,798,249"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="697,172,785,199"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1143,426,1309,467"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="915,425,1058,452"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="904,19,1069,45"/>
<area shape="rect" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894" title=" " alt="" coords="1395,608,1558,635"/>
<area shape="rect" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc" title=" " alt="" coords="1135,608,1317,635"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1145,491,1307,533"/>
<area shape="rect" href="guest_8c.html#a91e885a78ebf3a7c410b4b8ffa443729" title=" " alt="" coords="930,577,1043,604"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="920,628,1053,655"/>
<area shape="rect" href="guest_8c.html#ad1a71190592cc60155333934b84d1d11" title=" " alt="" coords="671,577,811,604"/>
</map>
</div>

</div>
</div>
<a id="a848ba80b4ffee7a071e37abb241262cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a848ba80b4ffee7a071e37abb241262cd">&#9670;&nbsp;</a></span>timer_get_cval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u64 timer_get_cval </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctxt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00085">85</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = ctxt-&gt;vcpu;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">switch</span>(arch_timer_ctx_index(ctxt)) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">case</span> TIMER_VTIMER:</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">return</span> __vcpu_sys_reg(vcpu, CNTV_CVAL_EL0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">case</span> TIMER_PTIMER:</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">return</span> __vcpu_sys_reg(vcpu, CNTP_CVAL_EL0);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">case</span> TIMER_HVTIMER:</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">return</span> __vcpu_sys_reg(vcpu, CNTHV_CVAL_EL2);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">case</span> TIMER_HPTIMER:</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">return</span> __vcpu_sys_reg(vcpu, CNTHP_CVAL_EL2);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        WARN_ON(1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a848ba80b4ffee7a071e37abb241262cd_icgraph.png" border="0" usemap="#aarch__timer_8c_a848ba80b4ffee7a071e37abb241262cd_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a848ba80b4ffee7a071e37abb241262cd_icgraph" id="aarch__timer_8c_a848ba80b4ffee7a071e37abb241262cd_icgraph">
<area shape="rect" title=" " alt="" coords="2279,234,2397,260"/>
<area shape="rect" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894" title=" " alt="" coords="1550,158,1713,184"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="2033,158,2231,184"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="2047,492,2217,519"/>
<area shape="rect" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301" title=" " alt="" coords="1799,259,1949,286"/>
<area shape="rect" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc" title=" " alt="" coords="1317,136,1500,163"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1327,188,1490,229"/>
<area shape="rect" href="guest_8c.html#a91e885a78ebf3a7c410b4b8ffa443729" title=" " alt="" coords="1113,139,1226,166"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="1103,88,1236,115"/>
<area shape="rect" href="guest_8c.html#ad1a71190592cc60155333934b84d1d11" title=" " alt="" coords="393,108,533,135"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,290,336,316"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,420,129,447"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1098,194,1241,220"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="1792,96,1956,123"/>
<area shape="rect" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9" title=" " alt="" coords="1816,158,1932,184"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1815,310,1933,336"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="1552,87,1711,114"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="1323,63,1495,90"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="1069,38,1269,64"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1548,260,1715,301"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1548,346,1715,372"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1329,346,1488,372"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,83,1021,110"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1097,295,1242,322"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1105,346,1234,372"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1112,470,1227,496"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="879,442,967,468"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,58,751,84"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,159,1015,186"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,159,771,186"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,210,732,236"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,108,731,135"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,340,1011,367"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,319,765,346"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,391,1004,418"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,312,543,353"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,496,777,523"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,492,963,519"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,598,740,624"/>
<area shape="rect" href="arch__timer_8c.html#a25b09c8d95a2582f37a1a2719920e59c" title=" " alt="" coords="1796,426,1952,468"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1782,695,1966,722"/>
<area shape="rect" href="arch__timer_8c.html#a939939efd4c7eb8c054ca12e04623358" title=" " alt="" coords="1763,594,1985,620"/>
<area shape="rect" href="arch__timer_8c.html#a629de40452a9be84148e3c8442a80db6" title=" " alt="" coords="1322,543,1495,570"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1778,492,1970,519"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1791,361,1957,402"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1783,644,1965,671"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="1555,695,1707,722"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="1345,695,1473,722"/>
<area shape="rect" href="arm_8c.html#a545524d72330cd45dae4f51a686943c0" title=" " alt="" coords="835,594,1012,620"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="1549,644,1714,671"/>
</map>
</div>

</div>
</div>
<a id="a7f5f777b74b5c9ec6e13d4f7576d7f43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f5f777b74b5c9ec6e13d4f7576d7f43">&#9670;&nbsp;</a></span>timer_get_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 timer_get_offset </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctxt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00104">104</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    u64 offset = 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (!ctxt)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span> (ctxt-&gt;offset.vm_offset)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        offset += *ctxt-&gt;offset.vm_offset;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> (ctxt-&gt;offset.vcpu_offset)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        offset += *ctxt-&gt;offset.vcpu_offset;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> offset;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a7f5f777b74b5c9ec6e13d4f7576d7f43_icgraph.png" border="0" usemap="#aarch__timer_8c_a7f5f777b74b5c9ec6e13d4f7576d7f43_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a7f5f777b74b5c9ec6e13d4f7576d7f43_icgraph" id="aarch__timer_8c_a7f5f777b74b5c9ec6e13d4f7576d7f43_icgraph">
<area shape="rect" title=" " alt="" coords="1845,325,1975,351"/>
<area shape="rect" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894" title=" " alt="" coords="893,147,1056,174"/>
<area shape="rect" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771" title=" " alt="" coords="1629,325,1795,351"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="1627,107,1797,148"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="1395,645,1565,671"/>
<area shape="rect" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301" title=" " alt="" coords="1147,375,1297,402"/>
<area shape="rect" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af" title=" " alt="" coords="1155,274,1289,301"/>
<area shape="rect" href="arch__timer_8c.html#af19caca81734fff66363042c1e8e2181" title=" " alt="" coords="1650,451,1774,478"/>
<area shape="rect" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc" title=" " alt="" coords="656,147,839,174"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="666,241,829,283"/>
<area shape="rect" href="guest_8c.html#a91e885a78ebf3a7c410b4b8ffa443729" title=" " alt="" coords="453,173,567,199"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="443,122,577,149"/>
<area shape="rect" href="guest_8c.html#ad1a71190592cc60155333934b84d1d11" title=" " alt="" coords="201,173,341,199"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="439,249,581,275"/>
<area shape="rect" href="arch__timer_8c.html#aaab6e45ec6d5188b23d96695db532140" title=" " alt="" coords="1389,223,1571,250"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="891,351,1058,392"/>
<area shape="rect" href="guest_8c.html#acd7401987c2e84cad89f08207d34bf3f" title=" " alt="" coords="1166,223,1278,250"/>
<area shape="rect" href="guest_8c.html#a8ee5ced2d0c0d538319888057bc58b4a" title=" " alt="" coords="905,198,1044,225"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="1381,122,1579,149"/>
<area shape="rect" href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b" title=" " alt="" coords="1425,71,1535,98"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="1140,71,1304,98"/>
<area shape="rect" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9" title=" " alt="" coords="1164,122,1280,149"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1163,426,1281,453"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="895,71,1054,98"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="891,483,1058,510"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="668,490,827,517"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="412,451,608,478"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="437,502,583,529"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="445,401,575,427"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="453,553,567,579"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="466,603,554,630"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,654,364,681"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,654,129,681"/>
<area shape="rect" href="arch__timer_8c.html#a78e23e83bece8c269268f3a263fbb114" title=" " alt="" coords="1137,5,1307,47"/>
<area shape="rect" href="kvm__main_8c.html#a3de4d6991bdd1a714e8afa6a55136cdd" title=" " alt="" coords="887,13,1063,39"/>
<area shape="rect" href="arch__timer_8c.html#a25b09c8d95a2582f37a1a2719920e59c" title=" " alt="" coords="1144,848,1300,889"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1130,695,1314,722"/>
<area shape="rect" href="arch__timer_8c.html#a939939efd4c7eb8c054ca12e04623358" title=" " alt="" coords="1111,645,1333,671"/>
<area shape="rect" href="arch__timer_8c.html#a629de40452a9be84148e3c8442a80db6" title=" " alt="" coords="661,746,834,773"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1126,527,1318,554"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1139,579,1305,620"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1131,797,1313,823"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="899,695,1051,722"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="683,695,811,722"/>
<area shape="rect" href="arm_8c.html#a545524d72330cd45dae4f51a686943c0" title=" " alt="" coords="659,645,836,671"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="665,797,830,823"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="895,299,1054,326"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="671,390,823,417"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="448,299,572,326"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="469,350,551,377"/>
</map>
</div>

</div>
</div>
<a id="a819b2da5a7c1a98ae423f604167c48d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a819b2da5a7c1a98ae423f604167c48d5">&#9670;&nbsp;</a></span>timer_irq_ack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_irq_ack </td>
          <td>(</td>
          <td class="paramtype">struct irq_data *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01272">1272</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;{</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    d = d-&gt;parent_data;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">if</span> (d-&gt;chip-&gt;irq_ack)</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        d-&gt;chip-&gt;irq_ack(d);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6bfbd5fe414719c1e7b6b39ffc7d82c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bfbd5fe414719c1e7b6b39ffc7d82c8">&#9670;&nbsp;</a></span>timer_irq_domain_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int timer_irq_domain_alloc </td>
          <td>(</td>
          <td class="paramtype">struct irq_domain *&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>virq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>nr_irqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01290">1290</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;{</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    irq_hw_number_t hwirq = (uintptr_t)arg;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">return</span> irq_domain_set_hwirq_and_chip(domain, virq, hwirq,</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                         &amp;<a class="code" href="arch__timer_8c.html#ad045572494d147b468245ef231e4d69b">timer_chip</a>, NULL);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_ad045572494d147b468245ef231e4d69b"><div class="ttname"><a href="arch__timer_8c.html#ad045572494d147b468245ef231e4d69b">timer_chip</a></div><div class="ttdeci">static struct irq_chip timer_chip</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01272">arch_timer.c:1279</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3215639ad183676bc549f2d755f645b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3215639ad183676bc549f2d755f645b9">&#9670;&nbsp;</a></span>timer_irq_domain_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_irq_domain_free </td>
          <td>(</td>
          <td class="paramtype">struct irq_domain *&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>virq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>nr_irqs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01299">1299</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;{</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5f3e6a118389a4e8a5a4aa1bb62c2fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5f3e6a118389a4e8a5a4aa1bb62c2fb">&#9670;&nbsp;</a></span>timer_irq_eoi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_irq_eoi </td>
          <td>(</td>
          <td class="paramtype">struct irq_data *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01266">1266</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;{</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordflow">if</span> (!irqd_is_forwarded_to_vcpu(d))</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        irq_chip_eoi_parent(d);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a40c01efaf9201aebf595f9123e46fcc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40c01efaf9201aebf595f9123e46fcc7">&#9670;&nbsp;</a></span>timer_irq_set_irqchip_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int timer_irq_set_irqchip_state </td>
          <td>(</td>
          <td class="paramtype">struct irq_data *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum irqchip_irq_state&#160;</td>
          <td class="paramname"><em>which</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01252">1252</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;{</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordflow">if</span> (which != IRQCHIP_STATE_ACTIVE || !irqd_is_forwarded_to_vcpu(d))</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="keywordflow">return</span> irq_chip_set_parent_state(d, which, val);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">if</span> (val)</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        irq_chip_mask_parent(d);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        irq_chip_unmask_parent(d);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b276b958e6b737660bc24559f657468"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b276b958e6b737660bc24559f657468">&#9670;&nbsp;</a></span>timer_irq_set_vcpu_affinity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int timer_irq_set_vcpu_affinity </td>
          <td>(</td>
          <td class="paramtype">struct irq_data *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vcpu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01242">1242</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;{</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">if</span> (vcpu)</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        irqd_set_forwarded_to_vcpu(d);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        irqd_clr_forwarded_to_vcpu(d);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; </div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a37a6f350a857f42fe872aeebc8e2e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a37a6f350a857f42fe872aeebc8e2e4">&#9670;&nbsp;</a></span>timer_irqs_are_valid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool timer_irqs_are_valid </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01452">1452</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;{</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    u32 ppis = 0;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordtype">bool</span> valid;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    mutex_lock(&amp;vcpu-&gt;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913">nr_timers</a>(vcpu); i++) {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="keyword">struct </span>arch_timer_context *ctx;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keywordtype">int</span> irq;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        ctx = vcpu_get_timer(vcpu, i);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        irq = timer_irq(ctx);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="vgic_8c.html#a99527df04c2db316d7f8c1733c18d99e">kvm_vgic_set_owner</a>(vcpu, irq, ctx))</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160; </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">         * We know by construction that we only have PPIs, so</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">         * all values are less than 32.</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        ppis |= BIT(irq);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    valid = hweight32(ppis) == <a class="code" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913">nr_timers</a>(vcpu);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">if</span> (valid)</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        set_bit(KVM_ARCH_FLAG_TIMER_PPIS_IMMUTABLE, &amp;vcpu-&gt;kvm-&gt;arch.flags);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    mutex_unlock(&amp;vcpu-&gt;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">return</span> valid;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;}</div>
<div class="ttc" id="avgic_8c_html_a99527df04c2db316d7f8c1733c18d99e"><div class="ttname"><a href="vgic_8c.html#a99527df04c2db316d7f8c1733c18d99e">kvm_vgic_set_owner</a></div><div class="ttdeci">int kvm_vgic_set_owner(struct kvm_vcpu *vcpu, unsigned int intid, void *owner)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00601">vgic.c:601</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a7a37a6f350a857f42fe872aeebc8e2e4_cgraph.png" border="0" usemap="#aarch__timer_8c_a7a37a6f350a857f42fe872aeebc8e2e4_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a7a37a6f350a857f42fe872aeebc8e2e4_cgraph" id="aarch__timer_8c_a7a37a6f350a857f42fe872aeebc8e2e4_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,160,57"/>
<area shape="rect" href="vgic_8c.html#a99527df04c2db316d7f8c1733c18d99e" title=" " alt="" coords="208,5,367,32"/>
<area shape="rect" href="arch__timer_8c.html#ad2a704b646b65309708c3a7f6ab70913" title=" " alt="" coords="245,56,329,83"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="415,5,516,32"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="564,5,664,32"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="712,5,847,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a7a37a6f350a857f42fe872aeebc8e2e4_icgraph.png" border="0" usemap="#aarch__timer_8c_a7a37a6f350a857f42fe872aeebc8e2e4_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a7a37a6f350a857f42fe872aeebc8e2e4_icgraph" id="aarch__timer_8c_a7a37a6f350a857f42fe872aeebc8e2e4_icgraph">
<area shape="rect" title=" " alt="" coords="596,13,751,39"/>
<area shape="rect" href="arch__timer_8c.html#a6eb7255c40d5b43938e99918b3d9d06a" title=" " alt="" coords="404,13,548,39"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="177,5,356,47"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,13,129,39"/>
</map>
</div>

</div>
</div>
<a id="a7e1e1c3a85e2d375519e32f57a54e301"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e1e1c3a85e2d375519e32f57a54e301">&#9670;&nbsp;</a></span>timer_restore_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_restore_state </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00603">603</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;{</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(ctx-&gt;vcpu);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keyword">enum</span> kvm_arch_timers index = arch_timer_ctx_index(ctx);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">if</span> (!timer-&gt;enabled)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    local_irq_save(flags);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">if</span> (ctx-&gt;loaded)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">switch</span> (index) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        u64 cval, offset;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">case</span> TIMER_VTIMER:</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">case</span> TIMER_HVTIMER:</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <a class="code" href="arch__timer_8c.html#a207ce56a4fe08e050e49e49334548e15">set_cntvoff</a>(<a class="code" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a>(ctx));</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        write_sysreg_el0(<a class="code" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd">timer_get_cval</a>(ctx), SYS_CNTV_CVAL);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        isb();</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        write_sysreg_el0(<a class="code" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13">timer_get_ctl</a>(ctx), SYS_CNTV_CTL);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">case</span> TIMER_PTIMER:</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">case</span> TIMER_HPTIMER:</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        cval = <a class="code" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd">timer_get_cval</a>(ctx);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        offset = <a class="code" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a>(ctx);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <a class="code" href="arch__timer_8c.html#a6fcfce8307e73b5ae888edca334508aa">set_cntpoff</a>(offset);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        cval += offset;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        write_sysreg_el0(cval, SYS_CNTP_CVAL);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        isb();</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        write_sysreg_el0(<a class="code" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13">timer_get_ctl</a>(ctx), SYS_CNTP_CTL);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">case</span> NR_KVM_TIMERS:</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        BUG();</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    trace_kvm_timer_restore_state(ctx);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    ctx-&gt;loaded = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;out:</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    local_irq_restore(flags);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_a207ce56a4fe08e050e49e49334548e15"><div class="ttname"><a href="arch__timer_8c.html#a207ce56a4fe08e050e49e49334548e15">set_cntvoff</a></div><div class="ttdeci">static void set_cntvoff(u64 cntvoff)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00486">arch_timer.c:486</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a6fcfce8307e73b5ae888edca334508aa"><div class="ttname"><a href="arch__timer_8c.html#a6fcfce8307e73b5ae888edca334508aa">set_cntpoff</a></div><div class="ttdeci">static void set_cntpoff(u64 cntpoff)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00491">arch_timer.c:491</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a7e1e1c3a85e2d375519e32f57a54e301_cgraph.png" border="0" usemap="#aarch__timer_8c_a7e1e1c3a85e2d375519e32f57a54e301_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a7e1e1c3a85e2d375519e32f57a54e301_cgraph" id="aarch__timer_8c_a7e1e1c3a85e2d375519e32f57a54e301_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,156,133"/>
<area shape="rect" href="arch__timer_8c.html#a6fcfce8307e73b5ae888edca334508aa" title=" " alt="" coords="221,5,316,32"/>
<area shape="rect" href="arch__timer_8c.html#a207ce56a4fe08e050e49e49334548e15" title=" " alt="" coords="221,56,316,83"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="215,107,323,133"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="209,157,328,184"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="204,208,333,235"/>
<area shape="rect" href="nvhe_2timer-sr_8c.html#a73539c3eaa37749e44c40351913b9efb" title=" " alt="" coords="381,56,568,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a7e1e1c3a85e2d375519e32f57a54e301_icgraph.png" border="0" usemap="#aarch__timer_8c_a7e1e1c3a85e2d375519e32f57a54e301_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a7e1e1c3a85e2d375519e32f57a54e301_icgraph" id="aarch__timer_8c_a7e1e1c3a85e2d375519e32f57a54e301_icgraph">
<area shape="rect" title=" " alt="" coords="1684,179,1835,205"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1471,171,1634,213"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1469,106,1636,147"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1271,147,1413,173"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a08b7dad9cb511eeaec5ab08e2a2ae1af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08b7dad9cb511eeaec5ab08e2a2ae1af">&#9670;&nbsp;</a></span>timer_save_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_save_state </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00497">497</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;{</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keyword">struct </span>arch_timer_cpu *timer = vcpu_timer(ctx-&gt;vcpu);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keyword">enum</span> kvm_arch_timers index = arch_timer_ctx_index(ctx);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">if</span> (!timer-&gt;enabled)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    local_irq_save(flags);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">if</span> (!ctx-&gt;loaded)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">switch</span> (index) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        u64 cval;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">case</span> TIMER_VTIMER:</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">case</span> TIMER_HVTIMER:</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac">timer_set_ctl</a>(ctx, read_sysreg_el0(SYS_CNTV_CTL));</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7">timer_set_cval</a>(ctx, read_sysreg_el0(SYS_CNTV_CVAL));</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">/* Disable the timer */</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        write_sysreg_el0(0, SYS_CNTV_CTL);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        isb();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">         * The kernel may decide to run userspace after</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">         * calling vcpu_put, so we reset cntvoff to 0 to</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">         * ensure a consistent read between user accesses to</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">         * the virtual counter and kernel access to the</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">         * physical counter of non-VHE case.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">         * For VHE, the virtual counter uses a fixed virtual</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">         * offset of zero, so no need to zero CNTVOFF_EL2</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">         * register, but this is actually useful when switching</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">         * between EL1/vEL2 with NV.</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">         * Do it unconditionally, as this is either unavoidable</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">         * or dirt cheap.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="arch__timer_8c.html#a207ce56a4fe08e050e49e49334548e15">set_cntvoff</a>(0);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">case</span> TIMER_PTIMER:</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">case</span> TIMER_HPTIMER:</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac">timer_set_ctl</a>(ctx, read_sysreg_el0(SYS_CNTP_CTL));</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        cval = read_sysreg_el0(SYS_CNTP_CVAL);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        cval -= <a class="code" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a>(ctx);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7">timer_set_cval</a>(ctx, cval);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="comment">/* Disable the timer */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        write_sysreg_el0(0, SYS_CNTP_CTL);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        isb();</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="arch__timer_8c.html#a6fcfce8307e73b5ae888edca334508aa">set_cntpoff</a>(0);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">case</span> NR_KVM_TIMERS:</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        BUG();</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    trace_kvm_timer_save_state(ctx);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    ctx-&gt;loaded = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;out:</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    local_irq_restore(flags);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a08b7dad9cb511eeaec5ab08e2a2ae1af_cgraph.png" border="0" usemap="#aarch__timer_8c_a08b7dad9cb511eeaec5ab08e2a2ae1af_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a08b7dad9cb511eeaec5ab08e2a2ae1af_cgraph" id="aarch__timer_8c_a08b7dad9cb511eeaec5ab08e2a2ae1af_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,140,133"/>
<area shape="rect" href="arch__timer_8c.html#a6fcfce8307e73b5ae888edca334508aa" title=" " alt="" coords="205,5,300,32"/>
<area shape="rect" href="arch__timer_8c.html#a207ce56a4fe08e050e49e49334548e15" title=" " alt="" coords="205,56,300,83"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="188,107,317,133"/>
<area shape="rect" href="arch__timer_8c.html#a2e57f3714ec062699e29ae4e13d80dac" title=" " alt="" coords="199,157,306,184"/>
<area shape="rect" href="arch__timer_8c.html#ab50c2af796cc5134fa3942c857dd4fb7" title=" " alt="" coords="193,208,312,235"/>
<area shape="rect" href="nvhe_2timer-sr_8c.html#a73539c3eaa37749e44c40351913b9efb" title=" " alt="" coords="365,56,552,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a08b7dad9cb511eeaec5ab08e2a2ae1af_icgraph.png" border="0" usemap="#aarch__timer_8c_a08b7dad9cb511eeaec5ab08e2a2ae1af_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a08b7dad9cb511eeaec5ab08e2a2ae1af_icgraph" id="aarch__timer_8c_a08b7dad9cb511eeaec5ab08e2a2ae1af_icgraph">
<area shape="rect" title=" " alt="" coords="1677,179,1812,205"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1465,171,1627,213"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1463,106,1629,147"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1467,237,1625,264"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1267,147,1410,173"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1263,237,1415,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1080,376,1204,403"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="1101,300,1183,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a2e57f3714ec062699e29ae4e13d80dac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e57f3714ec062699e29ae4e13d80dac">&#9670;&nbsp;</a></span>timer_set_ctl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_set_ctl </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctxt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>ctl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00119">119</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = ctxt-&gt;vcpu;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">switch</span>(arch_timer_ctx_index(ctxt)) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">case</span> TIMER_VTIMER:</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        __vcpu_sys_reg(vcpu, CNTV_CTL_EL0) = ctl;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">case</span> TIMER_PTIMER:</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        __vcpu_sys_reg(vcpu, CNTP_CTL_EL0) = ctl;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">case</span> TIMER_HVTIMER:</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        __vcpu_sys_reg(vcpu, CNTHV_CTL_EL2) = ctl;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">case</span> TIMER_HPTIMER:</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        __vcpu_sys_reg(vcpu, CNTHP_CTL_EL2) = ctl;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        WARN_ON(1);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a2e57f3714ec062699e29ae4e13d80dac_icgraph.png" border="0" usemap="#aarch__timer_8c_a2e57f3714ec062699e29ae4e13d80dac_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a2e57f3714ec062699e29ae4e13d80dac_icgraph" id="aarch__timer_8c_a2e57f3714ec062699e29ae4e13d80dac_icgraph">
<area shape="rect" title=" " alt="" coords="1911,148,2017,175"/>
<area shape="rect" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771" title=" " alt="" coords="1694,97,1861,124"/>
<area shape="rect" href="arch__timer_8c.html#a11b9b6e6338bbec6085332661c934e91" title=" " alt="" coords="1692,148,1863,175"/>
<area shape="rect" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af" title=" " alt="" coords="1710,219,1845,245"/>
<area shape="rect" href="arch__timer_8c.html#aaab6e45ec6d5188b23d96695db532140" title=" " alt="" coords="1463,59,1644,85"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1470,178,1637,219"/>
<area shape="rect" href="guest_8c.html#acd7401987c2e84cad89f08207d34bf3f" title=" " alt="" coords="1283,41,1395,68"/>
<area shape="rect" href="guest_8c.html#a8ee5ced2d0c0d538319888057bc58b4a" title=" " alt="" coords="394,5,533,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,85,336,112"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,153,129,180"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1267,219,1410,245"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,141,1207,168"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,107,1011,133"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,115,765,141"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,208,1004,235"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,107,543,149"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,208,777,235"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1472,243,1635,285"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1474,309,1633,336"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1263,309,1415,336"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,309,1021,336"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,360,1215,387"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1080,448,1204,475"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="1101,259,1183,285"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,284,751,311"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,360,1015,387"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,385,771,412"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,436,732,463"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,335,731,361"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,385,543,412"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,467,963,493"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,487,740,513"/>
</map>
</div>

</div>
</div>
<a id="ab50c2af796cc5134fa3942c857dd4fb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab50c2af796cc5134fa3942c857dd4fb7">&#9670;&nbsp;</a></span>timer_set_cval()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_set_cval </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctxt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>cval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00141">141</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = ctxt-&gt;vcpu;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">switch</span>(arch_timer_ctx_index(ctxt)) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">case</span> TIMER_VTIMER:</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        __vcpu_sys_reg(vcpu, CNTV_CVAL_EL0) = cval;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">case</span> TIMER_PTIMER:</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        __vcpu_sys_reg(vcpu, CNTP_CVAL_EL0) = cval;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">case</span> TIMER_HVTIMER:</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        __vcpu_sys_reg(vcpu, CNTHV_CVAL_EL2) = cval;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">case</span> TIMER_HPTIMER:</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        __vcpu_sys_reg(vcpu, CNTHP_CVAL_EL2) = cval;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        WARN_ON(1);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ab50c2af796cc5134fa3942c857dd4fb7_icgraph.png" border="0" usemap="#aarch__timer_8c_ab50c2af796cc5134fa3942c857dd4fb7_icgraph" alt=""/></div>
<map name="aarch__timer_8c_ab50c2af796cc5134fa3942c857dd4fb7_icgraph" id="aarch__timer_8c_ab50c2af796cc5134fa3942c857dd4fb7_icgraph">
<area shape="rect" title=" " alt="" coords="1907,108,2025,135"/>
<area shape="rect" href="arch__timer_8c.html#affb5181064df0b30b53f567189e15771" title=" " alt="" coords="1692,76,1859,103"/>
<area shape="rect" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af" title=" " alt="" coords="1708,133,1843,160"/>
<area shape="rect" href="arch__timer_8c.html#aaab6e45ec6d5188b23d96695db532140" title=" " alt="" coords="1463,9,1644,36"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1470,69,1637,110"/>
<area shape="rect" href="guest_8c.html#acd7401987c2e84cad89f08207d34bf3f" title=" " alt="" coords="1283,5,1395,32"/>
<area shape="rect" href="guest_8c.html#a8ee5ced2d0c0d538319888057bc58b4a" title=" " alt="" coords="394,28,533,55"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,133,336,160"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,201,129,228"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1267,109,1410,136"/>
<area shape="rect" href="arch__timer_8c.html#a4b6d62f10023e1b1effbf51b28d46d3c" title=" " alt="" coords="1472,134,1635,175"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="1474,215,1633,241"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1263,275,1415,301"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,357,1021,384"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,407,1215,433"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,205,1207,232"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1080,104,1204,131"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="1101,305,1183,332"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,357,751,384"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,408,1015,435"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,509,771,536"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,408,732,435"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,459,731,485"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,509,543,536"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,205,1011,232"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,163,765,189"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,256,1004,283"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,155,543,197"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,256,777,283"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,53,963,80"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,53,740,80"/>
</map>
</div>

</div>
</div>
<a id="aafe1b11938ff5abb30a790c16eb77c77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafe1b11938ff5abb30a790c16eb77c77">&#9670;&nbsp;</a></span>timer_set_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_set_offset </td>
          <td>(</td>
          <td class="paramtype">struct arch_timer_context *&#160;</td>
          <td class="paramname"><em>ctxt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00163">163</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (!ctxt-&gt;offset.vm_offset) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        WARN(offset, <span class="stringliteral">&quot;timer %ld\n&quot;</span>, arch_timer_ctx_index(ctxt));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    WRITE_ONCE(*ctxt-&gt;offset.vm_offset, offset);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_aafe1b11938ff5abb30a790c16eb77c77_icgraph.png" border="0" usemap="#aarch__timer_8c_aafe1b11938ff5abb30a790c16eb77c77_icgraph" alt=""/></div>
<map name="aarch__timer_8c_aafe1b11938ff5abb30a790c16eb77c77_icgraph" id="aarch__timer_8c_aafe1b11938ff5abb30a790c16eb77c77_icgraph">
<area shape="rect" title=" " alt="" coords="1081,31,1209,57"/>
<area shape="rect" href="arch__timer_8c.html#aaab6e45ec6d5188b23d96695db532140" title=" " alt="" coords="852,5,1033,32"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="863,56,1022,83"/>
<area shape="rect" href="guest_8c.html#acd7401987c2e84cad89f08207d34bf3f" title=" " alt="" coords="662,5,774,32"/>
<area shape="rect" href="guest_8c.html#a8ee5ced2d0c0d538319888057bc58b4a" title=" " alt="" coords="415,5,553,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,5,336,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="632,56,804,83"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="384,56,584,83"/>
</map>
</div>

</div>
</div>
<a id="af19caca81734fff66363042c1e8e2181"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af19caca81734fff66363042c1e8e2181">&#9670;&nbsp;</a></span>timer_set_traps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_set_traps </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timer_map *&#160;</td>
          <td class="paramname"><em>map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00764">764</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;{</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordtype">bool</span> tpt, tpc;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    u64 clr, set;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">     * No trapping gets configured here with nVHE. See</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">     * __timer_enable_traps(), which is where the stuff happens.</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">if</span> (!has_vhe())</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">     * Our default policy is not to trap anything. As we progress</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">     * within this function, reality kicks in and we start adding</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">     * traps based on emulation requirements.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    tpt = tpc = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">     * We have two possibility to deal with a physical offset:</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">     * - Either we have CNTPOFF (yay!) or the offset is 0:</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">     *   we let the guest freely access the HW</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">     * - or neither of these condition apply:</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">     *   we trap accesses to the HW, but still use it</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">     *   after correcting the physical offset</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span> (!has_cntpoff() &amp;&amp; <a class="code" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43">timer_get_offset</a>(map-&gt;direct_ptimer))</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        tpt = tpc = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">     * Apply the enable bits that the guest hypervisor has requested for</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">     * its own guest. We can only add traps that wouldn&#39;t have been set</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">     * above.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">if</span> (vcpu_has_nv(vcpu) &amp;&amp; !is_hyp_ctxt(vcpu)) {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        u64 val = __vcpu_sys_reg(vcpu, CNTHCTL_EL2);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="comment">/* Use the VHE format for mental sanity */</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordflow">if</span> (!vcpu_el2_e2h_is_set(vcpu))</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            val = (val &amp; (CNTHCTL_EL1PCEN | CNTHCTL_EL1PCTEN)) &lt;&lt; 10;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        tpt |= !(val &amp; (CNTHCTL_EL1PCEN &lt;&lt; 10));</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        tpc |= !(val &amp; (CNTHCTL_EL1PCTEN &lt;&lt; 10));</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">     * Now that we have collected our requirements, compute the</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">     * trap and enable bits.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    set = 0;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    clr = 0;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <a class="code" href="arch__timer_8c.html#aea983e592b69df371a4501567756dbe4">assign_clear_set_bit</a>(tpt, CNTHCTL_EL1PCEN &lt;&lt; 10, set, clr);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <a class="code" href="arch__timer_8c.html#aea983e592b69df371a4501567756dbe4">assign_clear_set_bit</a>(tpc, CNTHCTL_EL1PCTEN &lt;&lt; 10, set, clr);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="comment">/* This only happens on VHE, so use the CNTHCTL_EL2 accessor. */</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    sysreg_clear_set(cnthctl_el2, clr, set);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_aea983e592b69df371a4501567756dbe4"><div class="ttname"><a href="arch__timer_8c.html#aea983e592b69df371a4501567756dbe4">assign_clear_set_bit</a></div><div class="ttdeci">#define assign_clear_set_bit(_pred, _bit, _clr, _set)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l00705">arch_timer.c:705</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_af19caca81734fff66363042c1e8e2181_cgraph.png" border="0" usemap="#aarch__timer_8c_af19caca81734fff66363042c1e8e2181_cgraph" alt=""/></div>
<map name="aarch__timer_8c_af19caca81734fff66363042c1e8e2181_cgraph" id="aarch__timer_8c_af19caca81734fff66363042c1e8e2181_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,129,32"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="177,5,307,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_af19caca81734fff66363042c1e8e2181_icgraph.png" border="0" usemap="#aarch__timer_8c_af19caca81734fff66363042c1e8e2181_icgraph" alt=""/></div>
<map name="aarch__timer_8c_af19caca81734fff66363042c1e8e2181_icgraph" id="aarch__timer_8c_af19caca81734fff66363042c1e8e2181_icgraph">
<area shape="rect" title=" " alt="" coords="1684,237,1808,264"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a7af96c32754607120bf365569aac71c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7af96c32754607120bf365569aac71c0">&#9670;&nbsp;</a></span>unmask_vtimer_irq_user()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void unmask_vtimer_irq_user </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00914">914</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;{</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keyword">struct </span>arch_timer_context *vtimer = vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092">kvm_timer_should_fire</a>(vtimer)) {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <a class="code" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f">kvm_timer_update_irq</a>(vcpu, <span class="keyword">false</span>, vtimer);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordflow">if</span> (static_branch_likely(&amp;has_gic_active_state))</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <a class="code" href="arch__timer_8c.html#ae906d98d68ae56770507afe2e63ade68">set_timer_irq_phys_active</a>(vtimer, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            enable_percpu_irq(<a class="code" href="arch__timer_8c.html#af1df41cdaba1d42a2fd8a5b75c763f16">host_vtimer_irq</a>, <a class="code" href="arch__timer_8c.html#ad0df8fd11369dad2ecb88bca05586a2a">host_vtimer_irq_flags</a>);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a7af96c32754607120bf365569aac71c0_cgraph.png" border="0" usemap="#aarch__timer_8c_a7af96c32754607120bf365569aac71c0_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a7af96c32754607120bf365569aac71c0_cgraph" id="aarch__timer_8c_a7af96c32754607120bf365569aac71c0_cgraph">
<area shape="rect" title=" " alt="" coords="5,441,188,468"/>
<area shape="rect" href="arch__timer_8c.html#a64a4d2f3d2a9b83524edda4b27246092" title=" " alt="" coords="236,289,407,316"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="237,441,406,468"/>
<area shape="rect" href="arch__timer_8c.html#ae906d98d68ae56770507afe2e63ade68" title=" " alt="" coords="248,493,395,534"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="459,289,625,316"/>
<area shape="rect" href="arch__timer_8c.html#ae722c5e3eba2098c012b2cdc4d74bf9f" title=" " alt="" coords="455,340,629,367"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="483,188,601,215"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="477,239,607,265"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="709,289,817,316"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="466,441,618,468"/>
<area shape="rect" href="arch__timer_8c.html#a4f7db088b5aab3a8a6013b7f6fd12fa0" title=" " alt="" coords="473,492,611,519"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="713,391,814,417"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="708,441,819,468"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="2620,601,2721,628"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="2585,433,2756,460"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="677,340,849,367"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1743,5,1843,32"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="2818,199,2953,225"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="897,267,975,293"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1041,391,1185,417"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1023,325,1204,366"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="2619,215,2722,241"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="1026,157,1201,184"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1051,208,1175,235"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1039,259,1188,301"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1696,128,1891,155"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="1063,441,1163,468"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1266,332,1421,359"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="1483,307,1648,333"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1489,357,1641,384"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1707,357,1879,384"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="1978,316,2087,343"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="1964,383,2101,409"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="2175,231,2321,257"/>
<area shape="rect" href="vgic-its_8c.html#a53bf66e96dae9553e637fa69e8835365" title=" " alt="" coords="2175,357,2321,384"/>
<area shape="rect" href="vgic-its_8c.html#a352c8627ccf81a8154ae2275c7d50659" title=" " alt="" coords="2369,485,2537,526"/>
<area shape="rect" href="vgic-its_8c.html#ad62375be0591178764e98b79cd7217bf" title=" " alt="" coords="2377,383,2530,409"/>
<area shape="rect" href="vgic-its_8c.html#a94bbb30efc49ad5494a7f4b1410dbe01" title=" " alt="" coords="2392,332,2515,359"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="2804,601,2967,628"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="3055,601,3183,628"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="2824,517,2947,544"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="2814,433,2957,460"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="3015,492,3223,519"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="3042,543,3195,569"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="3061,433,3177,460"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1282,208,1405,235"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1282,157,1405,184"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="1252,441,1435,468"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="1273,391,1413,417"/>
<area shape="rect" href="vgic-v4_8c.html#ac22161596c9858cc700bab08c03fc422" title=" " alt="" coords="1939,460,2127,487"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a7af96c32754607120bf365569aac71c0_icgraph.png" border="0" usemap="#aarch__timer_8c_a7af96c32754607120bf365569aac71c0_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a7af96c32754607120bf365569aac71c0_icgraph" id="aarch__timer_8c_a7af96c32754607120bf365569aac71c0_icgraph">
<area shape="rect" title=" " alt="" coords="625,5,808,32"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="412,5,577,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a4f7db088b5aab3a8a6013b7f6fd12fa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f7db088b5aab3a8a6013b7f6fd12fa0">&#9670;&nbsp;</a></span>userspace_irqchip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool userspace_irqchip </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00207">207</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">return</span> static_branch_unlikely(&amp;userspace_irqchip_in_use) &amp;&amp;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        unlikely(!irqchip_in_kernel(kvm));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a4f7db088b5aab3a8a6013b7f6fd12fa0_icgraph.png" border="0" usemap="#aarch__timer_8c_a4f7db088b5aab3a8a6013b7f6fd12fa0_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a4f7db088b5aab3a8a6013b7f6fd12fa0_icgraph" id="aarch__timer_8c_a4f7db088b5aab3a8a6013b7f6fd12fa0_icgraph">
<area shape="rect" title=" " alt="" coords="2153,120,2292,147"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1700,36,1884,63"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="1936,145,2105,172"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="1489,21,1641,48"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="1284,13,1412,40"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,5,740,32"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1696,87,1888,113"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1709,138,1875,179"/>
<area shape="rect" href="arch__timer_8c.html#a11b9b6e6338bbec6085332661c934e91" title=" " alt="" coords="1263,313,1433,340"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1733,204,1851,231"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1701,259,1883,285"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1481,145,1648,172"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1269,149,1427,176"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,157,1021,184"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,107,1215,133"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,313,1207,340"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,56,1199,83"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,208,1186,235"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,208,751,235"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,56,771,83"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,107,732,133"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,157,731,184"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,56,543,83"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,461,1011,488"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,419,765,445"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,360,336,387"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,309,1004,336"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,411,543,453"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,309,129,336"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,284,777,311"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,56,963,83"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1481,197,1648,238"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1277,204,1419,231"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="1482,263,1647,289"/>
</map>
</div>

</div>
</div>
<a id="ad210f5f7b0361777290f8b36f023a518"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad210f5f7b0361777290f8b36f023a518">&#9670;&nbsp;</a></span>vcpu_has_wfit_active()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool vcpu_has_wfit_active </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00287">287</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> (cpus_have_final_cap(ARM64_HAS_WFXT) &amp;&amp;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        vcpu_get_flag(vcpu, IN_WFIT));</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_ad210f5f7b0361777290f8b36f023a518_icgraph.png" border="0" usemap="#aarch__timer_8c_ad210f5f7b0361777290f8b36f023a518_icgraph" alt=""/></div>
<map name="aarch__timer_8c_ad210f5f7b0361777290f8b36f023a518_icgraph" id="aarch__timer_8c_ad210f5f7b0361777290f8b36f023a518_icgraph">
<area shape="rect" title=" " alt="" coords="2437,147,2599,173"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="2222,84,2386,111"/>
<area shape="rect" href="arch__timer_8c.html#a78e23e83bece8c269268f3a263fbb114" title=" " alt="" coords="2219,139,2389,181"/>
<area shape="rect" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041" title=" " alt="" coords="2227,213,2381,240"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="2003,80,2162,107"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="1775,75,1947,101"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="1527,75,1727,101"/>
<area shape="rect" href="kvm__main_8c.html#a3de4d6991bdd1a714e8afa6a55136cdd" title=" " alt="" coords="1995,147,2171,173"/>
<area shape="rect" href="kvm__main_8c.html#a8e18df0287ddedfd516454aeeb669807" title=" " alt="" coords="1795,176,1926,203"/>
<area shape="rect" href="kvm__main_8c.html#a7256a8615584a9ae83a46c071f6aa0e9" title=" " alt="" coords="1566,125,1687,152"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="1345,113,1460,140"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="1121,107,1254,133"/>
<area shape="rect" href="psci_8c.html#abe7d85200e79143f87dab785a204fb3a" title=" " alt="" coords="1096,31,1279,57"/>
<area shape="rect" href="arm_8c.html#ad33fe3df0e24d8ff8cb0a7f4657ec3fa" title=" " alt="" coords="1112,208,1263,235"/>
<area shape="rect" href="psci_8c.html#ac7522f6e0d1805f44a3e932397de4582" title=" " alt="" coords="878,5,1022,32"/>
<area shape="rect" href="psci_8c.html#a8f59d47a1b54f561b8c42f509798142e" title=" " alt="" coords="639,44,783,71"/>
<area shape="rect" href="psci_8c.html#a3daa8000eb9717dde07d817c306b052b" title=" " alt="" coords="433,40,547,67"/>
<area shape="rect" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4" title=" " alt="" coords="177,81,363,108"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="19,151,115,177"/>
<area shape="rect" href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746" title=" " alt="" coords="17,81,117,108"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="869,208,1031,235"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="617,208,804,235"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,239,129,265"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="2003,231,2162,257"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1327,284,1479,311"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="852,436,1048,463"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1115,360,1260,387"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1123,157,1252,184"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1125,309,1249,336"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="909,259,991,285"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="643,461,778,488"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="859,360,1041,387"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="624,360,797,387"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="663,411,758,437"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="411,360,569,387"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="862,107,1038,133"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="629,99,792,125"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="191,157,349,184"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="411,91,569,133"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="911,309,989,336"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="655,259,767,285"/>
</map>
</div>

</div>
</div>
<a id="a9d0120f96e99b20be8023dad5c6a7f0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d0120f96e99b20be8023dad5c6a7f0b">&#9670;&nbsp;</a></span>wfit_delay_ns()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u64 wfit_delay_ns </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00293">293</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    u64 val = vcpu_get_reg(vcpu, kvm_vcpu_sys_get_rt(vcpu));</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keyword">struct </span>arch_timer_context *ctx;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    ctx = is_hyp_ctxt(vcpu) ? vcpu_hvtimer(vcpu) : vcpu_vtimer(vcpu);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228">kvm_counter_compute_delta</a>(ctx, val);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a9d0120f96e99b20be8023dad5c6a7f0b_cgraph.png" border="0" usemap="#aarch__timer_8c_a9d0120f96e99b20be8023dad5c6a7f0b_cgraph" alt=""/></div>
<map name="aarch__timer_8c_a9d0120f96e99b20be8023dad5c6a7f0b_cgraph" id="aarch__timer_8c_a9d0120f96e99b20be8023dad5c6a7f0b_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,116,57"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="164,23,335,65"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="383,5,549,32"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="401,56,531,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arch__timer_8c_a9d0120f96e99b20be8023dad5c6a7f0b_icgraph.png" border="0" usemap="#aarch__timer_8c_a9d0120f96e99b20be8023dad5c6a7f0b_icgraph" alt=""/></div>
<map name="aarch__timer_8c_a9d0120f96e99b20be8023dad5c6a7f0b_icgraph" id="aarch__timer_8c_a9d0120f96e99b20be8023dad5c6a7f0b_icgraph">
<area shape="rect" title=" " alt="" coords="2307,35,2417,61"/>
<area shape="rect" href="arch__timer_8c.html#aa5109f58e0ef877d3f053d0593359c1e" title=" " alt="" coords="2091,5,2255,32"/>
<area shape="rect" href="arch__timer_8c.html#a78e23e83bece8c269268f3a263fbb114" title=" " alt="" coords="2088,57,2259,98"/>
<area shape="rect" href="arch__timer_8c.html#ab7dc50f59c235841d864ef598f814247" title=" " alt="" coords="1873,5,2031,32"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="1644,5,1816,32"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="1396,5,1596,32"/>
<area shape="rect" href="kvm__main_8c.html#a3de4d6991bdd1a714e8afa6a55136cdd" title=" " alt="" coords="1864,64,2040,91"/>
<area shape="rect" href="kvm__main_8c.html#a8e18df0287ddedfd516454aeeb669807" title=" " alt="" coords="1665,56,1795,83"/>
<area shape="rect" href="kvm__main_8c.html#a7256a8615584a9ae83a46c071f6aa0e9" title=" " alt="" coords="1435,81,1557,108"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="1233,81,1348,108"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="1027,31,1161,57"/>
<area shape="rect" href="psci_8c.html#abe7d85200e79143f87dab785a204fb3a" title=" " alt="" coords="1003,81,1185,108"/>
<area shape="rect" href="arm_8c.html#ad33fe3df0e24d8ff8cb0a7f4657ec3fa" title=" " alt="" coords="1019,132,1169,159"/>
<area shape="rect" href="psci_8c.html#ac7522f6e0d1805f44a3e932397de4582" title=" " alt="" coords="802,81,946,108"/>
<area shape="rect" href="psci_8c.html#a8f59d47a1b54f561b8c42f509798142e" title=" " alt="" coords="580,31,724,57"/>
<area shape="rect" href="psci_8c.html#a3daa8000eb9717dde07d817c306b052b" title=" " alt="" coords="391,56,506,83"/>
<area shape="rect" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4" title=" " alt="" coords="153,56,339,83"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="7,31,103,57"/>
<area shape="rect" href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746" title=" " alt="" coords="5,81,105,108"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="793,132,955,159"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="559,132,745,159"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="387,132,511,159"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3ea143fc77aa4520f032211fd9487ae5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ea143fc77aa4520f032211fd9487ae5">&#9670;&nbsp;</a></span>arch_timer_irq_ops</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct irq_ops arch_timer_irq_ops</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .get_input_level = <a class="code" href="arch__timer_8c.html#a25b09c8d95a2582f37a1a2719920e59c">kvm_arch_timer_get_input_level</a>,</div>
<div class="line">}</div>
<div class="ttc" id="aarch__timer_8c_html_a25b09c8d95a2582f37a1a2719920e59c"><div class="ttname"><a href="arch__timer_8c.html#a25b09c8d95a2582f37a1a2719920e59c">kvm_arch_timer_get_input_level</a></div><div class="ttdeci">static bool kvm_arch_timer_get_input_level(int vintid)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01485">arch_timer.c:1485</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00052">52</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>

</div>
</div>
<a id="a2f0fe0305f0fed5e43fa92387f3de4b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f0fe0305f0fed5e43fa92387f3de4b3">&#9670;&nbsp;</a></span>default_ppi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const u8 default_ppi[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [TIMER_PTIMER]  = 30,</div>
<div class="line">    [TIMER_VTIMER]  = 27,</div>
<div class="line">    [TIMER_HPTIMER] = 26,</div>
<div class="line">    [TIMER_HVTIMER] = 28,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00034">34</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>

</div>
</div>
<a id="a20d4a341dfd2af12f6b5b19bfde475c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20d4a341dfd2af12f6b5b19bfde475c1">&#9670;&nbsp;</a></span>host_ptimer_irq</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int host_ptimer_irq</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00028">28</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>

</div>
</div>
<a id="ade5cd660147808f96da12823ae71454a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade5cd660147808f96da12823ae71454a">&#9670;&nbsp;</a></span>host_ptimer_irq_flags</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">u32 host_ptimer_irq_flags</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00030">30</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>

</div>
</div>
<a id="af1df41cdaba1d42a2fd8a5b75c763f16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1df41cdaba1d42a2fd8a5b75c763f16">&#9670;&nbsp;</a></span>host_vtimer_irq</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int host_vtimer_irq</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00027">27</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>

</div>
</div>
<a id="ad0df8fd11369dad2ecb88bca05586a2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0df8fd11369dad2ecb88bca05586a2a">&#9670;&nbsp;</a></span>host_vtimer_irq_flags</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">u32 host_vtimer_irq_flags</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00029">29</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>

</div>
</div>
<a id="a35098fc91b751950a191213b1c2e5853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35098fc91b751950a191213b1c2e5853">&#9670;&nbsp;</a></span>timecounter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct timecounter* timecounter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l00026">26</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>

</div>
</div>
<a id="ad045572494d147b468245ef231e4d69b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad045572494d147b468245ef231e4d69b">&#9670;&nbsp;</a></span>timer_chip</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct irq_chip timer_chip</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .name           = <span class="stringliteral">&quot;KVM&quot;</span>,</div>
<div class="line">    .irq_ack        = <a class="code" href="arch__timer_8c.html#a819b2da5a7c1a98ae423f604167c48d5">timer_irq_ack</a>,</div>
<div class="line">    .irq_mask       = irq_chip_mask_parent,</div>
<div class="line">    .irq_unmask     = irq_chip_unmask_parent,</div>
<div class="line">    .irq_eoi        = <a class="code" href="arch__timer_8c.html#af5f3e6a118389a4e8a5a4aa1bb62c2fb">timer_irq_eoi</a>,</div>
<div class="line">    .irq_set_type       = irq_chip_set_type_parent,</div>
<div class="line">    .irq_set_vcpu_affinity  = <a class="code" href="arch__timer_8c.html#a8b276b958e6b737660bc24559f657468">timer_irq_set_vcpu_affinity</a>,</div>
<div class="line">    .irq_set_irqchip_state  = <a class="code" href="arch__timer_8c.html#a40c01efaf9201aebf595f9123e46fcc7">timer_irq_set_irqchip_state</a>,</div>
<div class="line">}</div>
<div class="ttc" id="aarch__timer_8c_html_a40c01efaf9201aebf595f9123e46fcc7"><div class="ttname"><a href="arch__timer_8c.html#a40c01efaf9201aebf595f9123e46fcc7">timer_irq_set_irqchip_state</a></div><div class="ttdeci">static int timer_irq_set_irqchip_state(struct irq_data *d, enum irqchip_irq_state which, bool val)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01252">arch_timer.c:1252</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a819b2da5a7c1a98ae423f604167c48d5"><div class="ttname"><a href="arch__timer_8c.html#a819b2da5a7c1a98ae423f604167c48d5">timer_irq_ack</a></div><div class="ttdeci">static void timer_irq_ack(struct irq_data *d)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01272">arch_timer.c:1272</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a8b276b958e6b737660bc24559f657468"><div class="ttname"><a href="arch__timer_8c.html#a8b276b958e6b737660bc24559f657468">timer_irq_set_vcpu_affinity</a></div><div class="ttdeci">static int timer_irq_set_vcpu_affinity(struct irq_data *d, void *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01242">arch_timer.c:1242</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_af5f3e6a118389a4e8a5a4aa1bb62c2fb"><div class="ttname"><a href="arch__timer_8c.html#af5f3e6a118389a4e8a5a4aa1bb62c2fb">timer_irq_eoi</a></div><div class="ttdeci">static void timer_irq_eoi(struct irq_data *d)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01266">arch_timer.c:1266</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01272">1272</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>

</div>
</div>
<a id="ae4e307d79fe80f37b11012a68ed27295"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4e307d79fe80f37b11012a68ed27295">&#9670;&nbsp;</a></span>timer_domain_ops</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct irq_domain_ops timer_domain_ops</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .alloc  = <a class="code" href="arch__timer_8c.html#a6bfbd5fe414719c1e7b6b39ffc7d82c8">timer_irq_domain_alloc</a>,</div>
<div class="line">    .free   = <a class="code" href="arch__timer_8c.html#a3215639ad183676bc549f2d755f645b9">timer_irq_domain_free</a>,</div>
<div class="line">}</div>
<div class="ttc" id="aarch__timer_8c_html_a3215639ad183676bc549f2d755f645b9"><div class="ttname"><a href="arch__timer_8c.html#a3215639ad183676bc549f2d755f645b9">timer_irq_domain_free</a></div><div class="ttdeci">static void timer_irq_domain_free(struct irq_domain *domain, unsigned int virq, unsigned int nr_irqs)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01299">arch_timer.c:1299</a></div></div>
<div class="ttc" id="aarch__timer_8c_html_a6bfbd5fe414719c1e7b6b39ffc7d82c8"><div class="ttname"><a href="arch__timer_8c.html#a6bfbd5fe414719c1e7b6b39ffc7d82c8">timer_irq_domain_alloc</a></div><div class="ttdeci">static int timer_irq_domain_alloc(struct irq_domain *domain, unsigned int virq, unsigned int nr_irqs, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01290">arch_timer.c:1290</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="arch__timer_8c_source.html#l01299">1299</a> of file <a class="el" href="arch__timer_8c_source.html">arch_timer.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
