<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KVM: arch/arm64/kvm/pkvm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ea9599923402ca8ab47fc3e495999dea.html">arch</a></li><li class="navelem"><a class="el" href="dir_67a9e021ce8db5d46236c6154ee454bc.html">arm64</a></li><li class="navelem"><a class="el" href="dir_42f87ef63ac4150166bf7887f68288e2.html">kvm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pkvm.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/init.h&gt;</code><br />
<code>#include &lt;linux/kmemleak.h&gt;</code><br />
<code>#include &lt;linux/kvm_host.h&gt;</code><br />
<code>#include &lt;linux/memblock.h&gt;</code><br />
<code>#include &lt;linux/mutex.h&gt;</code><br />
<code>#include &lt;linux/sort.h&gt;</code><br />
<code>#include &lt;asm/kvm_pkvm.h&gt;</code><br />
<code>#include &quot;hyp_constants.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pkvm.c:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c__incl.png" border="0" usemap="#aarch_2arm64_2kvm_2pkvm_8c" alt=""/></div>
<map name="aarch_2arm64_2kvm_2pkvm_8c" id="aarch_2arm64_2kvm_2pkvm_8c">
<area shape="rect" title=" " alt="" coords="497,5,679,32"/>
<area shape="rect" title=" " alt="" coords="5,80,96,107"/>
<area shape="rect" title=" " alt="" coords="121,80,261,107"/>
<area shape="rect" title=" " alt="" coords="285,80,419,107"/>
<area shape="rect" title=" " alt="" coords="444,80,583,107"/>
<area shape="rect" title=" " alt="" coords="607,80,719,107"/>
<area shape="rect" title=" " alt="" coords="743,80,838,107"/>
<area shape="rect" title=" " alt="" coords="863,80,1001,107"/>
<area shape="rect" title=" " alt="" coords="1025,80,1153,107"/>
</map>
</div>
</div>
<p><a href="pkvm_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad15ed0ef56c928b8860efa1b49b557d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#ad15ed0ef56c928b8860efa1b49b557d9">DEFINE_STATIC_KEY_FALSE</a> (kvm_protected_mode_initialized)</td></tr>
<tr class="separator:ad15ed0ef56c928b8860efa1b49b557d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5204c5b48a08d6ab6a2805782377d807"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#a5204c5b48a08d6ab6a2805782377d807">cmp_hyp_memblock</a> (const void *p1, const void *p2)</td></tr>
<tr class="separator:a5204c5b48a08d6ab6a2805782377d807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a702d5384d853263899dc182035154875"><td class="memItemLeft" align="right" valign="top">static void __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#a702d5384d853263899dc182035154875">sort_memblock_regions</a> (void)</td></tr>
<tr class="separator:a702d5384d853263899dc182035154875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa66e101cb9571b2a50b83cb3bc173d5"><td class="memItemLeft" align="right" valign="top">static int __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#aaa66e101cb9571b2a50b83cb3bc173d5">register_memblock_regions</a> (void)</td></tr>
<tr class="separator:aaa66e101cb9571b2a50b83cb3bc173d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2596eb2ca4793a98586d311f7ffe615f"><td class="memItemLeft" align="right" valign="top">void __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#a2596eb2ca4793a98586d311f7ffe615f">kvm_hyp_reserve</a> (void)</td></tr>
<tr class="separator:a2596eb2ca4793a98586d311f7ffe615f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd259bb0db17ae7c75a8940360667c32"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#abd259bb0db17ae7c75a8940360667c32">__pkvm_destroy_hyp_vm</a> (struct kvm *host_kvm)</td></tr>
<tr class="separator:abd259bb0db17ae7c75a8940360667c32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6f8b05fc1474ed8f561ddb8f7fa3a96"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#ac6f8b05fc1474ed8f561ddb8f7fa3a96">__pkvm_create_hyp_vm</a> (struct kvm *host_kvm)</td></tr>
<tr class="separator:ac6f8b05fc1474ed8f561ddb8f7fa3a96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c8ae8a0a845f44545cd6b7819f3430e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#a9c8ae8a0a845f44545cd6b7819f3430e">pkvm_create_hyp_vm</a> (struct kvm *host_kvm)</td></tr>
<tr class="separator:a9c8ae8a0a845f44545cd6b7819f3430e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de2dfe512399e7f17c01091bc3e8ae8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#a0de2dfe512399e7f17c01091bc3e8ae8">pkvm_destroy_hyp_vm</a> (struct kvm *host_kvm)</td></tr>
<tr class="separator:a0de2dfe512399e7f17c01091bc3e8ae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ee42a2f7eb38a1293f06e36ac81465"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#ae7ee42a2f7eb38a1293f06e36ac81465">pkvm_init_host_vm</a> (struct kvm *host_kvm)</td></tr>
<tr class="separator:ae7ee42a2f7eb38a1293f06e36ac81465"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bbccfa61581daa041ae3d760f1c4594"><td class="memItemLeft" align="right" valign="top">static void __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#a4bbccfa61581daa041ae3d760f1c4594">_kvm_host_prot_finalize</a> (void *arg)</td></tr>
<tr class="separator:a4bbccfa61581daa041ae3d760f1c4594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa20f2bcf96aa18cc24b66929b28fd83f"><td class="memItemLeft" align="right" valign="top">static int __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#aa20f2bcf96aa18cc24b66929b28fd83f">pkvm_drop_host_privileges</a> (void)</td></tr>
<tr class="separator:aa20f2bcf96aa18cc24b66929b28fd83f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3e5bdb9bef69af06b3ef46b15b3a095"><td class="memItemLeft" align="right" valign="top">static int __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#ac3e5bdb9bef69af06b3ef46b15b3a095">finalize_pkvm</a> (void)</td></tr>
<tr class="separator:ac3e5bdb9bef69af06b3ef46b15b3a095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a391a0084904c990af560162d0dcacfd9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#a391a0084904c990af560162d0dcacfd9">device_initcall_sync</a> (<a class="el" href="pkvm_8c.html#ac3e5bdb9bef69af06b3ef46b15b3a095">finalize_pkvm</a>)</td></tr>
<tr class="separator:a391a0084904c990af560162d0dcacfd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af9d3a851e6a48fd74de91530882c3737"><td class="memItemLeft" align="right" valign="top">static struct memblock_region *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#af9d3a851e6a48fd74de91530882c3737">hyp_memory</a> = kvm_nvhe_sym(hyp_memory)</td></tr>
<tr class="separator:af9d3a851e6a48fd74de91530882c3737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4428242d6d030363fbe16f95d226cdb2"><td class="memItemLeft" align="right" valign="top">static unsigned int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#a4428242d6d030363fbe16f95d226cdb2">hyp_memblock_nr_ptr</a> = &amp;kvm_nvhe_sym(<a class="el" href="mm_8c.html#ae067f6ae4aa2f9ac9e94557ee956ed60">hyp_memblock_nr</a>)</td></tr>
<tr class="separator:a4428242d6d030363fbe16f95d226cdb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4acdeed5ab024194953e8f589edd493b"><td class="memItemLeft" align="right" valign="top">phys_addr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#a4acdeed5ab024194953e8f589edd493b">hyp_mem_base</a></td></tr>
<tr class="separator:a4acdeed5ab024194953e8f589edd493b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34f70fd9cdbf312a994c8cd96284caee"><td class="memItemLeft" align="right" valign="top">phys_addr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkvm_8c.html#a34f70fd9cdbf312a994c8cd96284caee">hyp_mem_size</a></td></tr>
<tr class="separator:a34f70fd9cdbf312a994c8cd96284caee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac6f8b05fc1474ed8f561ddb8f7fa3a96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6f8b05fc1474ed8f561ddb8f7fa3a96">&#9670;&nbsp;</a></span>__pkvm_create_hyp_vm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __pkvm_create_hyp_vm </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>host_kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00125">125</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">size_t</span> pgd_sz, hyp_vm_sz, hyp_vcpu_sz;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *host_vcpu;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    pkvm_handle_t handle;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">void</span> *pgd, *hyp_vm;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> idx;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (host_kvm-&gt;created_vcpus &lt; 1)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    pgd_sz = <a class="code" href="pgtable_8c.html#ac79c497e1cec1ab3d0b89e4ce87e5f51">kvm_pgtable_stage2_pgd_size</a>(host_kvm-&gt;arch.mmu.vtcr);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">     * The PGD pages will be reclaimed using a hyp_memcache which implies</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">     * page granularity. So, use alloc_pages_exact() to get individual</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">     * refcounts.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    pgd = alloc_pages_exact(pgd_sz, GFP_KERNEL_ACCOUNT);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (!pgd)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">/* Allocate memory to donate to hyp for vm and vcpu pointers. */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    hyp_vm_sz = PAGE_ALIGN(size_add(PKVM_HYP_VM_SIZE,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    size_mul(<span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                         host_kvm-&gt;created_vcpus)));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    hyp_vm = alloc_pages_exact(hyp_vm_sz, GFP_KERNEL_ACCOUNT);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (!hyp_vm) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        ret = -ENOMEM;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">goto</span> free_pgd;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">/* Donate the VM memory to hyp and let hyp initialize it. */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    ret = kvm_call_hyp_nvhe(<a class="code" href="hyp_2nvhe_2pkvm_8c.html#a284d0118156922a170aff08dae02356c">__pkvm_init_vm</a>, host_kvm, hyp_vm, pgd);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">goto</span> free_vm;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    handle = ret;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    host_kvm-&gt;arch.pkvm.handle = handle;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">/* Donate memory for the vcpus at hyp and initialize it. */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    hyp_vcpu_sz = PAGE_ALIGN(PKVM_HYP_VCPU_SIZE);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    kvm_for_each_vcpu(idx, host_vcpu, host_kvm) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordtype">void</span> *hyp_vcpu;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">/* Indexing of the vcpus to be sequential starting at 0. */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span> (WARN_ON(host_vcpu-&gt;vcpu_idx != idx)) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            ret = -EINVAL;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">goto</span> destroy_vm;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        hyp_vcpu = alloc_pages_exact(hyp_vcpu_sz, GFP_KERNEL_ACCOUNT);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> (!hyp_vcpu) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            ret = -ENOMEM;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">goto</span> destroy_vm;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        ret = kvm_call_hyp_nvhe(<a class="code" href="hyp_2nvhe_2pkvm_8c.html#a7216bb296fb7f7480fbc91d0fa389b21">__pkvm_init_vcpu</a>, handle, host_vcpu,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    hyp_vcpu);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (ret) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            free_pages_exact(hyp_vcpu, hyp_vcpu_sz);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keywordflow">goto</span> destroy_vm;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;destroy_vm:</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="pkvm_8c.html#abd259bb0db17ae7c75a8940360667c32">__pkvm_destroy_hyp_vm</a>(host_kvm);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;free_vm:</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    free_pages_exact(hyp_vm, hyp_vm_sz);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;free_pgd:</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    free_pages_exact(pgd, pgd_sz);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div>
<div class="ttc" id="ahyp_2nvhe_2pkvm_8c_html_a284d0118156922a170aff08dae02356c"><div class="ttname"><a href="hyp_2nvhe_2pkvm_8c.html#a284d0118156922a170aff08dae02356c">__pkvm_init_vm</a></div><div class="ttdeci">int __pkvm_init_vm(struct kvm *host_kvm, unsigned long vm_hva, unsigned long pgd_hva)</div><div class="ttdef"><b>Definition:</b> <a href="hyp_2nvhe_2pkvm_8c_source.html#l00470">pkvm.c:470</a></div></div>
<div class="ttc" id="ahyp_2nvhe_2pkvm_8c_html_a7216bb296fb7f7480fbc91d0fa389b21"><div class="ttname"><a href="hyp_2nvhe_2pkvm_8c.html#a7216bb296fb7f7480fbc91d0fa389b21">__pkvm_init_vcpu</a></div><div class="ttdeci">int __pkvm_init_vcpu(pkvm_handle_t handle, struct kvm_vcpu *host_vcpu, unsigned long vcpu_hva)</div><div class="ttdef"><b>Definition:</b> <a href="hyp_2nvhe_2pkvm_8c_source.html#l00539">pkvm.c:539</a></div></div>
<div class="ttc" id="apgtable_8c_html_ac79c497e1cec1ab3d0b89e4ce87e5f51"><div class="ttname"><a href="pgtable_8c.html#ac79c497e1cec1ab3d0b89e4ce87e5f51">kvm_pgtable_stage2_pgd_size</a></div><div class="ttdeci">size_t kvm_pgtable_stage2_pgd_size(u64 vtcr)</div><div class="ttdef"><b>Definition:</b> <a href="pgtable_8c_source.html#l01561">pgtable.c:1561</a></div></div>
<div class="ttc" id="apkvm_8c_html_abd259bb0db17ae7c75a8940360667c32"><div class="ttname"><a href="pkvm_8c.html#abd259bb0db17ae7c75a8940360667c32">__pkvm_destroy_hyp_vm</a></div><div class="ttdeci">static void __pkvm_destroy_hyp_vm(struct kvm *host_kvm)</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00104">pkvm.c:104</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_ac6f8b05fc1474ed8f561ddb8f7fa3a96_cgraph.png" border="0" usemap="#apkvm_8c_ac6f8b05fc1474ed8f561ddb8f7fa3a96_cgraph" alt=""/></div>
<map name="apkvm_8c_ac6f8b05fc1474ed8f561ddb8f7fa3a96_cgraph" id="apkvm_8c_ac6f8b05fc1474ed8f561ddb8f7fa3a96_cgraph">
<area shape="rect" title=" " alt="" coords="5,740,185,767"/>
<area shape="rect" href="pkvm_8c.html#abd259bb0db17ae7c75a8940360667c32" title=" " alt="" coords="233,411,421,437"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a7216bb296fb7f7480fbc91d0fa389b21" title=" " alt="" coords="485,664,623,691"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a284d0118156922a170aff08dae02356c" title=" " alt="" coords="489,993,619,1020"/>
<area shape="rect" href="pgtable_8c.html#ac79c497e1cec1ab3d0b89e4ce87e5f51" title=" " alt="" coords="962,1591,1121,1633"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#adedaa2ebee60585a9aab7d80293a5ad2" title=" " alt="" coords="469,411,639,437"/>
<area shape="rect" href="mmu_8c.html#aee4de5a2c1110217af2d89d21e21a216" title=" " alt="" coords="475,56,633,83"/>
<area shape="rect" href="nvhe_2tlb_8c.html#acd12cf2005a2acf1ce92ff165096726a" title=" " alt="" coords="706,157,873,184"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#af3a9f8da5f6f1ac6c51d8b4cf7be26ca" title=" " alt="" coords="717,411,862,437"/>
<area shape="rect" href="memory_8h.html#a3858889abb828afd54e20be3a55947d8" title=" " alt="" coords="977,681,1105,708"/>
<area shape="rect" href="spinlock_8h.html#ae942ff0e878cb0f4d55ddc4cc6275ec9" title=" " alt="" coords="1663,781,1777,808"/>
<area shape="rect" href="spinlock_8h.html#a2c6e9db70599188dbe031e2ce8ec6b08" title=" " alt="" coords="1655,411,1785,437"/>
<area shape="rect" href="mem__protect_8h.html#a16fa0918fd8f50705e15341038d58fd8" title=" " alt="" coords="1194,461,1375,488"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a424af5862f022dc4c7a63b34219cd0f8" title=" " alt="" coords="700,765,879,792"/>
<area shape="rect" href="mem__protect_8h.html#af31ab34b10dfe2d918b3d0aedaaefc90" title=" " alt="" coords="709,715,869,741"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a296892c18e515626259e369403a4d3d0" title=" " alt="" coords="699,512,880,539"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a315a65a066329bcea7b74d4eb11c963c" title=" " alt="" coords="687,107,892,133"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a9fb5ca8500d8ba2e1c140f3dd549d832" title=" " alt="" coords="720,461,859,488"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a44f3b33f9c9af29ae5def49898ff81dd" title=" " alt="" coords="971,411,1112,437"/>
<area shape="rect" href="mem__protect_8c.html#aa70b12df63f9379efa7fe11ade510b7c" title=" " alt="" coords="1435,613,1599,640"/>
<area shape="rect" href="mem__protect_8c.html#a21f32ced99ed31332ac532029100e42d" title=" " alt="" coords="1427,512,1607,539"/>
<area shape="rect" href="mem__protect_8c.html#abbc50e372d72deb41a021219c35e3589" title=" " alt="" coords="1437,664,1597,691"/>
<area shape="rect" href="memory_8h.html#a3cc326fe973add2b2ea91f6b04dd8fde" title=" " alt="" coords="1447,461,1587,488"/>
<area shape="rect" href="mem__protect_8c.html#a024de911d90c8e8d57cc96c87fecb4d3" title=" " alt="" coords="1429,411,1605,437"/>
<area shape="rect" href="mem__protect_8c.html#a908466d681d5e97d3703f5cdbb74195d" title=" " alt="" coords="955,1169,1127,1196"/>
<area shape="rect" href="spinlock_8h.html#ae92c9f4a09d239d6060880c35d12a48b" title=" " alt="" coords="1435,760,1598,787"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a9503b9e29dd4b2337feef252f5a57103" title=" " alt="" coords="976,461,1107,488"/>
<area shape="rect" href="mmu_8c.html#ace8dc778dfd3f12f9944cb1f6cc1d40d" title=" " alt="" coords="726,5,853,32"/>
<area shape="rect" href="mmu_8c.html#a2a7af09cc56dc8cd69de6c8d2acacd12" title=" " alt="" coords="735,56,844,83"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a62e6bc810202341dfe789a22d676a469" title=" " alt="" coords="711,563,867,589"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a12992d9e43e154429da5e2a85cf12dd8" title=" " alt="" coords="703,867,876,893"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a5f7ab23a4eb39c09d0a5b9f461a6cb9b" title=" " alt="" coords="695,816,884,843"/>
<area shape="rect" href="mem__protect_8h.html#a8d93d64c69622f186ce841ed9b1c608b" title=" " alt="" coords="959,631,1124,657"/>
<area shape="rect" href="mem__protect_8c.html#ab45dbaed102ffbf3ccda18c0cc20a6dc" title=" " alt="" coords="1191,833,1379,874"/>
<area shape="rect" href="mem__protect_8c.html#a4ee4815f49f2d2a8397d1e2430193a3e" title=" " alt="" coords="1193,715,1377,757"/>
<area shape="rect" href="memory_8h.html#a52854ece4f50a52b454b91f1a144b189" title=" " alt="" coords="1217,781,1353,808"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a9ac0a95585deaa45106e201ede7a21ec" title=" " alt="" coords="955,834,1128,875"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a57ca4bd54f074772ac03c6401856d122" title=" " alt="" coords="940,783,1143,809"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#ad91b8ef9f472d054091ac0d0c7f1d249" title=" " alt="" coords="716,1423,863,1449"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a5c0b7226654c586286248bea9b106540" title=" " alt="" coords="705,1120,873,1147"/>
<area shape="rect" href="mem__protect_8h.html#aede5343a98d17e8fdc0146e1908c69dd" title=" " alt="" coords="688,1321,891,1348"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a29d3fa50cc8ae1d0b023ca30ab0ceffc" title=" " alt="" coords="968,1002,1115,1043"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a5d9f0046f5027226ee083947e55ef151" title=" " alt="" coords="971,1068,1112,1095"/>
<area shape="rect" href="pgtable_8c.html#a9588301531fc2cca84ebf22bd7e9fd1f" title=" " alt="" coords="941,1372,1141,1399"/>
<area shape="rect" href="mem__protect_8c.html#a7b75c96fdca4f9e2423274d19539732e" title=" " alt="" coords="945,1423,1137,1449"/>
<area shape="rect" href="mem__protect_8c.html#ae8436f4ddcbf41ee699d5ad641d8b7a1" title=" " alt="" coords="962,1474,1121,1515"/>
<area shape="rect" href="mem__protect_8c.html#a49ffb76aced02bafea21c2db094875f9" title=" " alt="" coords="968,1540,1115,1567"/>
<area shape="rect" href="mem__protect_8c.html#aec2e458217e1cf49169b545e7753ff13" title=" " alt="" coords="968,1271,1115,1297"/>
<area shape="rect" href="mem__protect_8c.html#a5b200ee75f7323df4f3906ae2c88ab9f" title=" " alt="" coords="959,1321,1123,1348"/>
<area shape="rect" href="pgtable_8c.html#ab68001fdf94eab0c95183a0d99df3576" title=" " alt="" coords="1221,1485,1349,1512"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_ac6f8b05fc1474ed8f561ddb8f7fa3a96_icgraph.png" border="0" usemap="#apkvm_8c_ac6f8b05fc1474ed8f561ddb8f7fa3a96_icgraph" alt=""/></div>
<map name="apkvm_8c_ac6f8b05fc1474ed8f561ddb8f7fa3a96_icgraph" id="apkvm_8c_ac6f8b05fc1474ed8f561ddb8f7fa3a96_icgraph">
<area shape="rect" title=" " alt="" coords="619,13,799,39"/>
<area shape="rect" href="pkvm_8c.html#a9c8ae8a0a845f44545cd6b7819f3430e" title=" " alt="" coords="404,13,571,39"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="177,5,356,47"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,13,129,39"/>
</map>
</div>

</div>
</div>
<a id="abd259bb0db17ae7c75a8940360667c32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd259bb0db17ae7c75a8940360667c32">&#9670;&nbsp;</a></span>__pkvm_destroy_hyp_vm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __pkvm_destroy_hyp_vm </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>host_kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00104">104</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (host_kvm-&gt;arch.pkvm.handle) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        WARN_ON(kvm_call_hyp_nvhe(<a class="code" href="hyp_2nvhe_2pkvm_8c.html#adedaa2ebee60585a9aab7d80293a5ad2">__pkvm_teardown_vm</a>,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                      host_kvm-&gt;arch.pkvm.handle));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    host_kvm-&gt;arch.pkvm.handle = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="mmu_8c.html#aee4de5a2c1110217af2d89d21e21a216">free_hyp_memcache</a>(&amp;host_kvm-&gt;arch.pkvm.teardown_mc);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
<div class="ttc" id="ahyp_2nvhe_2pkvm_8c_html_adedaa2ebee60585a9aab7d80293a5ad2"><div class="ttname"><a href="hyp_2nvhe_2pkvm_8c.html#adedaa2ebee60585a9aab7d80293a5ad2">__pkvm_teardown_vm</a></div><div class="ttdeci">int __pkvm_teardown_vm(pkvm_handle_t handle)</div><div class="ttdef"><b>Definition:</b> <a href="hyp_2nvhe_2pkvm_8c_source.html#l00592">pkvm.c:592</a></div></div>
<div class="ttc" id="ammu_8c_html_aee4de5a2c1110217af2d89d21e21a216"><div class="ttname"><a href="mmu_8c.html#aee4de5a2c1110217af2d89d21e21a216">free_hyp_memcache</a></div><div class="ttdeci">void free_hyp_memcache(struct kvm_hyp_memcache *mc)</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8c_source.html#l01041">mmu.c:1041</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_abd259bb0db17ae7c75a8940360667c32_cgraph.png" border="0" usemap="#apkvm_8c_abd259bb0db17ae7c75a8940360667c32_cgraph" alt=""/></div>
<map name="apkvm_8c_abd259bb0db17ae7c75a8940360667c32_cgraph" id="apkvm_8c_abd259bb0db17ae7c75a8940360667c32_cgraph">
<area shape="rect" title=" " alt="" coords="5,533,193,560"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#adedaa2ebee60585a9aab7d80293a5ad2" title=" " alt="" coords="241,335,411,361"/>
<area shape="rect" href="mmu_8c.html#aee4de5a2c1110217af2d89d21e21a216" title=" " alt="" coords="247,685,405,712"/>
<area shape="rect" href="nvhe_2tlb_8c.html#acd12cf2005a2acf1ce92ff165096726a" title=" " alt="" coords="466,56,633,83"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#af3a9f8da5f6f1ac6c51d8b4cf7be26ca" title=" " alt="" coords="477,107,622,133"/>
<area shape="rect" href="memory_8h.html#a3858889abb828afd54e20be3a55947d8" title=" " alt="" coords="485,208,613,235"/>
<area shape="rect" href="spinlock_8h.html#ae942ff0e878cb0f4d55ddc4cc6275ec9" title=" " alt="" coords="1468,309,1583,336"/>
<area shape="rect" href="spinlock_8h.html#a2c6e9db70599188dbe031e2ce8ec6b08" title=" " alt="" coords="1460,512,1591,539"/>
<area shape="rect" href="mem__protect_8h.html#a16fa0918fd8f50705e15341038d58fd8" title=" " alt="" coords="946,309,1127,336"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a424af5862f022dc4c7a63b34219cd0f8" title=" " alt="" coords="460,635,639,661"/>
<area shape="rect" href="mem__protect_8h.html#af31ab34b10dfe2d918b3d0aedaaefc90" title=" " alt="" coords="711,461,871,488"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a296892c18e515626259e369403a4d3d0" title=" " alt="" coords="459,157,640,184"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a315a65a066329bcea7b74d4eb11c963c" title=" " alt="" coords="688,635,893,661"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a9fb5ca8500d8ba2e1c140f3dd549d832" title=" " alt="" coords="480,360,619,387"/>
<area shape="rect" href="nvhe_2tlb_8c.html#ac4dc226b1ecb9bca38c3096eb27c4c1d" title=" " alt="" coords="708,5,873,32"/>
<area shape="rect" href="nvhe_2tlb_8c.html#afffa64d5f9de2ef7a026837a2b9a0629" title=" " alt="" coords="712,56,869,83"/>
<area shape="rect" href="mem__protect_8h.html#a30e07c8d8daaddaecfb787562883f88d" title=" " alt="" coords="961,56,1112,83"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a44f3b33f9c9af29ae5def49898ff81dd" title=" " alt="" coords="720,107,861,133"/>
<area shape="rect" href="mem__protect_8c.html#aa70b12df63f9379efa7fe11ade510b7c" title=" " alt="" coords="1199,259,1363,285"/>
<area shape="rect" href="mem__protect_8c.html#a21f32ced99ed31332ac532029100e42d" title=" " alt="" coords="1191,461,1371,488"/>
<area shape="rect" href="mem__protect_8c.html#abbc50e372d72deb41a021219c35e3589" title=" " alt="" coords="1201,309,1361,336"/>
<area shape="rect" href="memory_8h.html#a3cc326fe973add2b2ea91f6b04dd8fde" title=" " alt="" coords="1211,208,1351,235"/>
<area shape="rect" href="mem__protect_8c.html#a024de911d90c8e8d57cc96c87fecb4d3" title=" " alt="" coords="1193,512,1369,539"/>
<area shape="rect" href="mem__protect_8c.html#ac46723bcc56baf1618eacb213151c926" title=" " alt="" coords="941,461,1132,488"/>
<area shape="rect" href="mem__protect_8c.html#a908466d681d5e97d3703f5cdbb74195d" title=" " alt="" coords="951,360,1123,387"/>
<area shape="rect" href="mem__protect_8c.html#ab39943fa5a8f70eca9309055e9a0e46d" title=" " alt="" coords="943,584,1131,611"/>
<area shape="rect" href="gfp_8h.html#a7a740bb58e275f0307a86b02008f751a" title=" " alt="" coords="1216,411,1347,437"/>
<area shape="rect" href="memory_8h.html#aae436fb2b3f13c0954cde727104e80ac" title=" " alt="" coords="970,635,1103,661"/>
<area shape="rect" href="pgtable_8c.html#ab0ed17e7108aa47fbba6cbdfea0b6606" title=" " alt="" coords="957,779,1116,821"/>
<area shape="rect" href="mem__protect_8c.html#a7e4a0c65211d20b4e8adc2d323699489" title=" " alt="" coords="1236,664,1327,691"/>
<area shape="rect" href="mem__protect_8c.html#a09511b2fc9e756f5849a9a10c21946f2" title=" " alt="" coords="1473,639,1577,665"/>
<area shape="rect" href="mem__protect_8c.html#a4738d2842abcf74309391d6e6c677537" title=" " alt="" coords="1463,689,1587,716"/>
<area shape="rect" href="page__alloc_8c.html#a8ac88fa38a81f4de49d9e80665b1ffc0" title=" " alt="" coords="1449,360,1601,387"/>
<area shape="rect" href="memory_8h.html#af9e2f139c35baaaccb3e11cfe21cf182" title=" " alt="" coords="1431,411,1620,437"/>
<area shape="rect" href="page__alloc_8c.html#ab41323251ac55b72defe671d568dcce7" title=" " alt="" coords="1469,461,1582,488"/>
<area shape="rect" href="page__alloc_8c.html#ae518629a69c1b296e4ade7f9bd7041b8" title=" " alt="" coords="1672,309,1840,336"/>
<area shape="rect" href="page__alloc_8c.html#a02f9a2f04d282f7c4026c60bc2c8d81c" title=" " alt="" coords="1690,360,1822,387"/>
<area shape="rect" href="page__alloc_8c.html#ab55ed9a753f81792da659a3b165fefee" title=" " alt="" coords="1668,411,1844,437"/>
<area shape="rect" href="pgtable_8c.html#ab68001fdf94eab0c95183a0d99df3576" title=" " alt="" coords="1461,765,1589,792"/>
<area shape="rect" href="pgtable_8c.html#a2a6ed7242e033a1f32360cbe0e5c2281" title=" " alt="" coords="1209,816,1354,843"/>
<area shape="rect" href="pgtable_8c.html#a28c492866ecf19d7caee51ffa130c6cb" title=" " alt="" coords="1207,867,1356,893"/>
<area shape="rect" href="pgtable_8c.html#af01e17f60125c9e093e082e70a43f362" title=" " alt="" coords="1682,791,1830,817"/>
<area shape="rect" href="pgtable_8c.html#ac74b17e065ba3e68a10f28b594d21e40" title=" " alt="" coords="1449,816,1601,843"/>
<area shape="rect" href="pgtable_8c.html#a2f4269267d0718905af8540821a6de3d" title=" " alt="" coords="1462,867,1589,893"/>
<area shape="rect" href="spinlock_8h.html#ae92c9f4a09d239d6060880c35d12a48b" title=" " alt="" coords="709,157,872,184"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#ae0206a7c88d213b1ff24538337468249" title=" " alt="" coords="942,697,1131,738"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a57ca4bd54f074772ac03c6401856d122" title=" " alt="" coords="1180,715,1383,741"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a9503b9e29dd4b2337feef252f5a57103" title=" " alt="" coords="725,360,856,387"/>
<area shape="rect" href="mmu_8c.html#ace8dc778dfd3f12f9944cb1f6cc1d40d" title=" " alt="" coords="486,685,613,712"/>
<area shape="rect" href="mmu_8c.html#a2a7af09cc56dc8cd69de6c8d2acacd12" title=" " alt="" coords="495,736,604,763"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_abd259bb0db17ae7c75a8940360667c32_icgraph.png" border="0" usemap="#apkvm_8c_abd259bb0db17ae7c75a8940360667c32_icgraph" alt=""/></div>
<map name="apkvm_8c_abd259bb0db17ae7c75a8940360667c32_icgraph" id="apkvm_8c_abd259bb0db17ae7c75a8940360667c32_icgraph">
<area shape="rect" title=" " alt="" coords="1301,46,1489,73"/>
<area shape="rect" href="pkvm_8c.html#ac6f8b05fc1474ed8f561ddb8f7fa3a96" title=" " alt="" coords="1073,21,1253,47"/>
<area shape="rect" href="pkvm_8c.html#a0de2dfe512399e7f17c01091bc3e8ae8" title=" " alt="" coords="1076,71,1251,98"/>
<area shape="rect" href="pkvm_8c.html#a9c8ae8a0a845f44545cd6b7819f3430e" title=" " alt="" coords="857,17,1023,43"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="628,5,807,47"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="455,13,579,39"/>
<area shape="rect" href="arm_8c.html#ad84dda268db5d48c48f3ef2f438c62a7" title=" " alt="" coords="855,71,1025,98"/>
<area shape="rect" href="kvm__main_8c.html#a54b22e6be98d31db1a83e7993fbcf4bc" title=" " alt="" coords="453,67,580,94"/>
<area shape="rect" href="kvm__main_8c.html#afd922c538c448ab1248cdb9dccae9410" title=" " alt="" coords="650,133,785,159"/>
<area shape="rect" href="kvm__main_8c.html#a955de4f2a1b3371438636eccab732b27" title=" " alt="" coords="212,58,405,85"/>
<area shape="rect" href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241" title=" " alt="" coords="459,154,574,181"/>
<area shape="rect" href="kvm__main_8c.html#a37fa7805021941c56fe174eae4c8c377" title=" " alt="" coords="234,109,383,135"/>
<area shape="rect" href="kvm__main_8c.html#af19040bdcea372f13eab66499d99201c" title=" " alt="" coords="226,159,391,186"/>
<area shape="rect" href="guest__memfd_8c.html#ad8912fbda61cdcb6d9e5a3c0f839e001" title=" " alt="" coords="231,210,386,237"/>
<area shape="rect" href="kvm__main_8c.html#af67afbdcee89641f21573ac643d8e693" title=" " alt="" coords="241,261,376,287"/>
<area shape="rect" href="kvm__main_8c.html#a87bcafdc42ee32aedb84df5e564f9872" title=" " alt="" coords="5,109,164,135"/>
</map>
</div>

</div>
</div>
<a id="a4bbccfa61581daa041ae3d760f1c4594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bbccfa61581daa041ae3d760f1c4594">&#9670;&nbsp;</a></span>_kvm_host_prot_finalize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __init _kvm_host_prot_finalize </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00229">229</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;{</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordtype">int</span> *err = arg;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (WARN_ON(kvm_call_hyp_nvhe(<a class="code" href="mem__protect_8h.html#a9a57b30f2fad6430b6af09466c0c57f0">__pkvm_prot_finalize</a>)))</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        WRITE_ONCE(*err, -EINVAL);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
<div class="ttc" id="amem__protect_8h_html_a9a57b30f2fad6430b6af09466c0c57f0"><div class="ttname"><a href="mem__protect_8h.html#a9a57b30f2fad6430b6af09466c0c57f0">__pkvm_prot_finalize</a></div><div class="ttdeci">int __pkvm_prot_finalize(void)</div><div class="ttdef"><b>Definition:</b> <a href="mem__protect_8c_source.html#l00289">mem_protect.c:289</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_a4bbccfa61581daa041ae3d760f1c4594_cgraph.png" border="0" usemap="#apkvm_8c_a4bbccfa61581daa041ae3d760f1c4594_cgraph" alt=""/></div>
<map name="apkvm_8c_a4bbccfa61581daa041ae3d760f1c4594_cgraph" id="apkvm_8c_a4bbccfa61581daa041ae3d760f1c4594_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,185,32"/>
<area shape="rect" href="mem__protect_8h.html#a9a57b30f2fad6430b6af09466c0c57f0" title=" " alt="" coords="233,5,393,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_a4bbccfa61581daa041ae3d760f1c4594_icgraph.png" border="0" usemap="#apkvm_8c_a4bbccfa61581daa041ae3d760f1c4594_icgraph" alt=""/></div>
<map name="apkvm_8c_a4bbccfa61581daa041ae3d760f1c4594_icgraph" id="apkvm_8c_a4bbccfa61581daa041ae3d760f1c4594_icgraph">
<area shape="rect" title=" " alt="" coords="416,5,596,32"/>
<area shape="rect" href="pkvm_8c.html#aa20f2bcf96aa18cc24b66929b28fd83f" title=" " alt="" coords="167,5,368,32"/>
<area shape="rect" href="pkvm_8c.html#ac3e5bdb9bef69af06b3ef46b15b3a095" title=" " alt="" coords="5,5,119,32"/>
</map>
</div>

</div>
</div>
<a id="a5204c5b48a08d6ab6a2805782377d807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5204c5b48a08d6ab6a2805782377d807">&#9670;&nbsp;</a></span>cmp_hyp_memblock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cmp_hyp_memblock </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00026">26</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span>memblock_region *r1 = p1;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span>memblock_region *r2 = p2;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">return</span> r1-&gt;base &lt; r2-&gt;base ? -1 : (r1-&gt;base &gt; r2-&gt;base);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_a5204c5b48a08d6ab6a2805782377d807_icgraph.png" border="0" usemap="#apkvm_8c_a5204c5b48a08d6ab6a2805782377d807_icgraph" alt=""/></div>
<map name="apkvm_8c_a5204c5b48a08d6ab6a2805782377d807_icgraph" id="apkvm_8c_a5204c5b48a08d6ab6a2805782377d807_icgraph">
<area shape="rect" title=" " alt="" coords="669,5,827,32"/>
<area shape="rect" href="pkvm_8c.html#a702d5384d853263899dc182035154875" title=" " alt="" coords="443,5,621,32"/>
<area shape="rect" href="pkvm_8c.html#aaa66e101cb9571b2a50b83cb3bc173d5" title=" " alt="" coords="192,5,395,32"/>
<area shape="rect" href="pkvm_8c.html#a2596eb2ca4793a98586d311f7ffe615f" title=" " alt="" coords="5,5,144,32"/>
</map>
</div>

</div>
</div>
<a id="ad15ed0ef56c928b8860efa1b49b557d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad15ed0ef56c928b8860efa1b49b557d9">&#9670;&nbsp;</a></span>DEFINE_STATIC_KEY_FALSE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_STATIC_KEY_FALSE </td>
          <td>(</td>
          <td class="paramtype">kvm_protected_mode_initialized&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a391a0084904c990af560162d0dcacfd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a391a0084904c990af560162d0dcacfd9">&#9670;&nbsp;</a></span>device_initcall_sync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">device_initcall_sync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pkvm_8c.html#ac3e5bdb9bef69af06b3ef46b15b3a095">finalize_pkvm</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac3e5bdb9bef69af06b3ef46b15b3a095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3e5bdb9bef69af06b3ef46b15b3a095">&#9670;&nbsp;</a></span>finalize_pkvm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __init finalize_pkvm </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00250">250</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">if</span> (!is_protected_kvm_enabled() || !<a class="code" href="arm_8c.html#a5c57540a9920335727ff11db0c48980b">is_kvm_arm_initialised</a>())</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">     * Exclude HYP sections from kmemleak so that they don&#39;t get peeked</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">     * at, which would end badly once inaccessible.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    kmemleak_free_part(__hyp_bss_start, __hyp_bss_end - __hyp_bss_start);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    kmemleak_free_part_phys(<a class="code" href="pkvm_8c.html#a4acdeed5ab024194953e8f589edd493b">hyp_mem_base</a>, <a class="code" href="pkvm_8c.html#a34f70fd9cdbf312a994c8cd96284caee">hyp_mem_size</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    ret = <a class="code" href="pkvm_8c.html#aa20f2bcf96aa18cc24b66929b28fd83f">pkvm_drop_host_privileges</a>();</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        pr_err(<span class="stringliteral">&quot;Failed to finalize Hyp protection: %d\n&quot;</span>, ret);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div>
<div class="ttc" id="aarm_8c_html_a5c57540a9920335727ff11db0c48980b"><div class="ttname"><a href="arm_8c.html#a5c57540a9920335727ff11db0c48980b">is_kvm_arm_initialised</a></div><div class="ttdeci">bool is_kvm_arm_initialised(void)</div><div class="ttdef"><b>Definition:</b> <a href="arm_8c_source.html#l00062">arm.c:62</a></div></div>
<div class="ttc" id="apkvm_8c_html_a34f70fd9cdbf312a994c8cd96284caee"><div class="ttname"><a href="pkvm_8c.html#a34f70fd9cdbf312a994c8cd96284caee">hyp_mem_size</a></div><div class="ttdeci">phys_addr_t hyp_mem_size</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00024">pkvm.c:24</a></div></div>
<div class="ttc" id="apkvm_8c_html_a4acdeed5ab024194953e8f589edd493b"><div class="ttname"><a href="pkvm_8c.html#a4acdeed5ab024194953e8f589edd493b">hyp_mem_base</a></div><div class="ttdeci">phys_addr_t hyp_mem_base</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00023">pkvm.c:23</a></div></div>
<div class="ttc" id="apkvm_8c_html_aa20f2bcf96aa18cc24b66929b28fd83f"><div class="ttname"><a href="pkvm_8c.html#aa20f2bcf96aa18cc24b66929b28fd83f">pkvm_drop_host_privileges</a></div><div class="ttdeci">static int __init pkvm_drop_host_privileges(void)</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00237">pkvm.c:237</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_ac3e5bdb9bef69af06b3ef46b15b3a095_cgraph.png" border="0" usemap="#apkvm_8c_ac3e5bdb9bef69af06b3ef46b15b3a095_cgraph" alt=""/></div>
<map name="apkvm_8c_ac3e5bdb9bef69af06b3ef46b15b3a095_cgraph" id="apkvm_8c_ac3e5bdb9bef69af06b3ef46b15b3a095_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,119,57"/>
<area shape="rect" href="arm_8c.html#a5c57540a9920335727ff11db0c48980b" title=" " alt="" coords="181,5,354,32"/>
<area shape="rect" href="pkvm_8c.html#aa20f2bcf96aa18cc24b66929b28fd83f" title=" " alt="" coords="167,56,368,83"/>
<area shape="rect" href="pkvm_8c.html#a4bbccfa61581daa041ae3d760f1c4594" title=" " alt="" coords="416,56,596,83"/>
<area shape="rect" href="mem__protect_8h.html#a9a57b30f2fad6430b6af09466c0c57f0" title=" " alt="" coords="644,56,804,83"/>
</map>
</div>

</div>
</div>
<a id="a2596eb2ca4793a98586d311f7ffe615f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2596eb2ca4793a98586d311f7ffe615f">&#9670;&nbsp;</a></span>kvm_hyp_reserve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __init kvm_hyp_reserve </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00059">59</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    u64 hyp_mem_pages = 0;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (!is_hyp_mode_available() || is_kernel_in_hyp_mode())</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arm_8c.html#ade8fdddf9949d1e1fcc2cea2dc5a7133">kvm_get_mode</a>() != KVM_MODE_PROTECTED)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    ret = <a class="code" href="pkvm_8c.html#aaa66e101cb9571b2a50b83cb3bc173d5">register_memblock_regions</a>();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (ret) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        *<a class="code" href="pkvm_8c.html#a4428242d6d030363fbe16f95d226cdb2">hyp_memblock_nr_ptr</a> = 0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        kvm_err(<span class="stringliteral">&quot;Failed to register hyp memblocks: %d\n&quot;</span>, ret);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    hyp_mem_pages += hyp_s1_pgtable_pages();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    hyp_mem_pages += host_s2_pgtable_pages();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    hyp_mem_pages += hyp_vm_table_pages();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    hyp_mem_pages += hyp_vmemmap_pages(STRUCT_HYP_PAGE_SIZE);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    hyp_mem_pages += hyp_ffa_proxy_pages();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">     * Try to allocate a PMD-aligned region to reduce TLB pressure once</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">     * this is unmapped from the host stage-2, and fallback to PAGE_SIZE.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="pkvm_8c.html#a34f70fd9cdbf312a994c8cd96284caee">hyp_mem_size</a> = hyp_mem_pages &lt;&lt; PAGE_SHIFT;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="pkvm_8c.html#a4acdeed5ab024194953e8f589edd493b">hyp_mem_base</a> = memblock_phys_alloc(ALIGN(<a class="code" href="pkvm_8c.html#a34f70fd9cdbf312a994c8cd96284caee">hyp_mem_size</a>, PMD_SIZE),</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                       PMD_SIZE);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="pkvm_8c.html#a4acdeed5ab024194953e8f589edd493b">hyp_mem_base</a>)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="pkvm_8c.html#a4acdeed5ab024194953e8f589edd493b">hyp_mem_base</a> = memblock_phys_alloc(<a class="code" href="pkvm_8c.html#a34f70fd9cdbf312a994c8cd96284caee">hyp_mem_size</a>, PAGE_SIZE);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="pkvm_8c.html#a34f70fd9cdbf312a994c8cd96284caee">hyp_mem_size</a> = ALIGN(<a class="code" href="pkvm_8c.html#a34f70fd9cdbf312a994c8cd96284caee">hyp_mem_size</a>, PMD_SIZE);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="pkvm_8c.html#a4acdeed5ab024194953e8f589edd493b">hyp_mem_base</a>) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        kvm_err(<span class="stringliteral">&quot;Failed to reserve hyp memory\n&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    kvm_info(<span class="stringliteral">&quot;Reserved %lld MiB at 0x%llx\n&quot;</span>, <a class="code" href="pkvm_8c.html#a34f70fd9cdbf312a994c8cd96284caee">hyp_mem_size</a> &gt;&gt; 20,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;         <a class="code" href="pkvm_8c.html#a4acdeed5ab024194953e8f589edd493b">hyp_mem_base</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div>
<div class="ttc" id="aarm_8c_html_ade8fdddf9949d1e1fcc2cea2dc5a7133"><div class="ttname"><a href="arm_8c.html#ade8fdddf9949d1e1fcc2cea2dc5a7133">kvm_get_mode</a></div><div class="ttdeci">enum kvm_mode kvm_get_mode(void)</div><div class="ttdef"><b>Definition:</b> <a href="arm_8c_source.html#l02655">arm.c:2657</a></div></div>
<div class="ttc" id="apkvm_8c_html_a4428242d6d030363fbe16f95d226cdb2"><div class="ttname"><a href="pkvm_8c.html#a4428242d6d030363fbe16f95d226cdb2">hyp_memblock_nr_ptr</a></div><div class="ttdeci">static unsigned int * hyp_memblock_nr_ptr</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00021">pkvm.c:21</a></div></div>
<div class="ttc" id="apkvm_8c_html_aaa66e101cb9571b2a50b83cb3bc173d5"><div class="ttname"><a href="pkvm_8c.html#aaa66e101cb9571b2a50b83cb3bc173d5">register_memblock_regions</a></div><div class="ttdeci">static int __init register_memblock_regions(void)</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00043">pkvm.c:43</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_a2596eb2ca4793a98586d311f7ffe615f_cgraph.png" border="0" usemap="#apkvm_8c_a2596eb2ca4793a98586d311f7ffe615f_cgraph" alt=""/></div>
<map name="apkvm_8c_a2596eb2ca4793a98586d311f7ffe615f_cgraph" id="apkvm_8c_a2596eb2ca4793a98586d311f7ffe615f_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,144,57"/>
<area shape="rect" href="arm_8c.html#ade8fdddf9949d1e1fcc2cea2dc5a7133" title=" " alt="" coords="232,5,355,32"/>
<area shape="rect" href="pkvm_8c.html#aaa66e101cb9571b2a50b83cb3bc173d5" title=" " alt="" coords="192,56,395,83"/>
<area shape="rect" href="pkvm_8c.html#a702d5384d853263899dc182035154875" title=" " alt="" coords="443,56,621,83"/>
<area shape="rect" href="pkvm_8c.html#a5204c5b48a08d6ab6a2805782377d807" title=" " alt="" coords="669,56,827,83"/>
</map>
</div>

</div>
</div>
<a id="a9c8ae8a0a845f44545cd6b7819f3430e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c8ae8a0a845f44545cd6b7819f3430e">&#9670;&nbsp;</a></span>pkvm_create_hyp_vm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pkvm_create_hyp_vm </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>host_kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00204">204</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    mutex_lock(&amp;host_kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (!host_kvm-&gt;arch.pkvm.handle)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        ret = <a class="code" href="pkvm_8c.html#ac6f8b05fc1474ed8f561ddb8f7fa3a96">__pkvm_create_hyp_vm</a>(host_kvm);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    mutex_unlock(&amp;host_kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div>
<div class="ttc" id="apkvm_8c_html_ac6f8b05fc1474ed8f561ddb8f7fa3a96"><div class="ttname"><a href="pkvm_8c.html#ac6f8b05fc1474ed8f561ddb8f7fa3a96">__pkvm_create_hyp_vm</a></div><div class="ttdeci">static int __pkvm_create_hyp_vm(struct kvm *host_kvm)</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00125">pkvm.c:125</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_a9c8ae8a0a845f44545cd6b7819f3430e_cgraph.png" border="0" usemap="#apkvm_8c_a9c8ae8a0a845f44545cd6b7819f3430e_cgraph" alt=""/></div>
<map name="apkvm_8c_a9c8ae8a0a845f44545cd6b7819f3430e_cgraph" id="apkvm_8c_a9c8ae8a0a845f44545cd6b7819f3430e_cgraph">
<area shape="rect" title=" " alt="" coords="5,703,172,729"/>
<area shape="rect" href="pkvm_8c.html#ac6f8b05fc1474ed8f561ddb8f7fa3a96" title=" " alt="" coords="220,703,400,729"/>
<area shape="rect" href="pkvm_8c.html#abd259bb0db17ae7c75a8940360667c32" title=" " alt="" coords="448,411,636,437"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a7216bb296fb7f7480fbc91d0fa389b21" title=" " alt="" coords="699,613,838,640"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a284d0118156922a170aff08dae02356c" title=" " alt="" coords="704,993,833,1020"/>
<area shape="rect" href="pgtable_8c.html#ac79c497e1cec1ab3d0b89e4ce87e5f51" title=" " alt="" coords="1177,1541,1335,1582"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#adedaa2ebee60585a9aab7d80293a5ad2" title=" " alt="" coords="684,411,853,437"/>
<area shape="rect" href="mmu_8c.html#aee4de5a2c1110217af2d89d21e21a216" title=" " alt="" coords="689,56,848,83"/>
<area shape="rect" href="nvhe_2tlb_8c.html#acd12cf2005a2acf1ce92ff165096726a" title=" " alt="" coords="921,208,1087,235"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#af3a9f8da5f6f1ac6c51d8b4cf7be26ca" title=" " alt="" coords="931,461,1077,488"/>
<area shape="rect" href="memory_8h.html#a3858889abb828afd54e20be3a55947d8" title=" " alt="" coords="1192,1019,1320,1045"/>
<area shape="rect" href="spinlock_8h.html#ae942ff0e878cb0f4d55ddc4cc6275ec9" title=" " alt="" coords="1877,689,1992,716"/>
<area shape="rect" href="spinlock_8h.html#a2c6e9db70599188dbe031e2ce8ec6b08" title=" " alt="" coords="1869,360,2000,387"/>
<area shape="rect" href="mem__protect_8h.html#a16fa0918fd8f50705e15341038d58fd8" title=" " alt="" coords="1409,411,1590,437"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a424af5862f022dc4c7a63b34219cd0f8" title=" " alt="" coords="915,765,1093,792"/>
<area shape="rect" href="mem__protect_8h.html#af31ab34b10dfe2d918b3d0aedaaefc90" title=" " alt="" coords="924,715,1084,741"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a296892c18e515626259e369403a4d3d0" title=" " alt="" coords="913,563,1095,589"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a315a65a066329bcea7b74d4eb11c963c" title=" " alt="" coords="901,157,1107,184"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a9fb5ca8500d8ba2e1c140f3dd549d832" title=" " alt="" coords="935,360,1073,387"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a44f3b33f9c9af29ae5def49898ff81dd" title=" " alt="" coords="1185,461,1327,488"/>
<area shape="rect" href="mem__protect_8c.html#aa70b12df63f9379efa7fe11ade510b7c" title=" " alt="" coords="1649,715,1813,741"/>
<area shape="rect" href="mem__protect_8c.html#a21f32ced99ed31332ac532029100e42d" title=" " alt="" coords="1641,360,1821,387"/>
<area shape="rect" href="mem__protect_8c.html#abbc50e372d72deb41a021219c35e3589" title=" " alt="" coords="1651,613,1811,640"/>
<area shape="rect" href="memory_8h.html#a3cc326fe973add2b2ea91f6b04dd8fde" title=" " alt="" coords="1661,411,1801,437"/>
<area shape="rect" href="mem__protect_8c.html#a024de911d90c8e8d57cc96c87fecb4d3" title=" " alt="" coords="1643,461,1819,488"/>
<area shape="rect" href="mem__protect_8c.html#a908466d681d5e97d3703f5cdbb74195d" title=" " alt="" coords="1170,1069,1342,1096"/>
<area shape="rect" href="spinlock_8h.html#ae92c9f4a09d239d6060880c35d12a48b" title=" " alt="" coords="1650,919,1813,945"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a9503b9e29dd4b2337feef252f5a57103" title=" " alt="" coords="1191,360,1321,387"/>
<area shape="rect" href="mmu_8c.html#ace8dc778dfd3f12f9944cb1f6cc1d40d" title=" " alt="" coords="941,56,1067,83"/>
<area shape="rect" href="mmu_8c.html#a2a7af09cc56dc8cd69de6c8d2acacd12" title=" " alt="" coords="949,5,1059,32"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a62e6bc810202341dfe789a22d676a469" title=" " alt="" coords="926,512,1082,539"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a12992d9e43e154429da5e2a85cf12dd8" title=" " alt="" coords="917,1019,1091,1045"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a5f7ab23a4eb39c09d0a5b9f461a6cb9b" title=" " alt="" coords="909,968,1099,995"/>
<area shape="rect" href="mem__protect_8h.html#a8d93d64c69622f186ce841ed9b1c608b" title=" " alt="" coords="1173,715,1339,741"/>
<area shape="rect" href="mem__protect_8c.html#ab45dbaed102ffbf3ccda18c0cc20a6dc" title=" " alt="" coords="1405,882,1593,923"/>
<area shape="rect" href="mem__protect_8c.html#a4ee4815f49f2d2a8397d1e2430193a3e" title=" " alt="" coords="1407,817,1591,858"/>
<area shape="rect" href="memory_8h.html#a52854ece4f50a52b454b91f1a144b189" title=" " alt="" coords="1431,765,1567,792"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a9ac0a95585deaa45106e201ede7a21ec" title=" " alt="" coords="1169,887,1343,929"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a57ca4bd54f074772ac03c6401856d122" title=" " alt="" coords="1155,836,1357,863"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#ad91b8ef9f472d054091ac0d0c7f1d249" title=" " alt="" coords="931,1069,1077,1096"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a5c0b7226654c586286248bea9b106540" title=" " alt="" coords="920,1171,1088,1197"/>
<area shape="rect" href="mem__protect_8h.html#aede5343a98d17e8fdc0146e1908c69dd" title=" " alt="" coords="903,1323,1105,1349"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a29d3fa50cc8ae1d0b023ca30ab0ceffc" title=" " alt="" coords="1183,953,1329,994"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a5d9f0046f5027226ee083947e55ef151" title=" " alt="" coords="1185,1171,1327,1197"/>
<area shape="rect" href="pgtable_8c.html#a9588301531fc2cca84ebf22bd7e9fd1f" title=" " alt="" coords="1156,1272,1356,1299"/>
<area shape="rect" href="mem__protect_8c.html#a7b75c96fdca4f9e2423274d19539732e" title=" " alt="" coords="1160,1424,1352,1451"/>
<area shape="rect" href="mem__protect_8c.html#ae8436f4ddcbf41ee699d5ad641d8b7a1" title=" " alt="" coords="1177,1475,1335,1517"/>
<area shape="rect" href="mem__protect_8c.html#a49ffb76aced02bafea21c2db094875f9" title=" " alt="" coords="1183,1323,1329,1349"/>
<area shape="rect" href="mem__protect_8c.html#aec2e458217e1cf49169b545e7753ff13" title=" " alt="" coords="1183,1373,1329,1400"/>
<area shape="rect" href="pgtable_8c.html#ab68001fdf94eab0c95183a0d99df3576" title=" " alt="" coords="1435,1409,1563,1436"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_a9c8ae8a0a845f44545cd6b7819f3430e_icgraph.png" border="0" usemap="#apkvm_8c_a9c8ae8a0a845f44545cd6b7819f3430e_icgraph" alt=""/></div>
<map name="apkvm_8c_a9c8ae8a0a845f44545cd6b7819f3430e_icgraph" id="apkvm_8c_a9c8ae8a0a845f44545cd6b7819f3430e_icgraph">
<area shape="rect" title=" " alt="" coords="404,13,571,39"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="177,5,356,47"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,13,129,39"/>
</map>
</div>

</div>
</div>
<a id="a0de2dfe512399e7f17c01091bc3e8ae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0de2dfe512399e7f17c01091bc3e8ae8">&#9670;&nbsp;</a></span>pkvm_destroy_hyp_vm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pkvm_destroy_hyp_vm </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>host_kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00216">216</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    mutex_lock(&amp;host_kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="pkvm_8c.html#abd259bb0db17ae7c75a8940360667c32">__pkvm_destroy_hyp_vm</a>(host_kvm);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    mutex_unlock(&amp;host_kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_a0de2dfe512399e7f17c01091bc3e8ae8_cgraph.png" border="0" usemap="#apkvm_8c_a0de2dfe512399e7f17c01091bc3e8ae8_cgraph" alt=""/></div>
<map name="apkvm_8c_a0de2dfe512399e7f17c01091bc3e8ae8_cgraph" id="apkvm_8c_a0de2dfe512399e7f17c01091bc3e8ae8_cgraph">
<area shape="rect" title=" " alt="" coords="5,639,180,666"/>
<area shape="rect" href="pkvm_8c.html#abd259bb0db17ae7c75a8940360667c32" title=" " alt="" coords="228,639,416,666"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#adedaa2ebee60585a9aab7d80293a5ad2" title=" " alt="" coords="464,482,633,509"/>
<area shape="rect" href="mmu_8c.html#aee4de5a2c1110217af2d89d21e21a216" title=" " alt="" coords="469,766,628,793"/>
<area shape="rect" href="nvhe_2tlb_8c.html#acd12cf2005a2acf1ce92ff165096726a" title=" " alt="" coords="689,187,855,214"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#af3a9f8da5f6f1ac6c51d8b4cf7be26ca" title=" " alt="" coords="699,558,845,585"/>
<area shape="rect" href="memory_8h.html#a3858889abb828afd54e20be3a55947d8" title=" " alt="" coords="708,659,836,686"/>
<area shape="rect" href="spinlock_8h.html#ae942ff0e878cb0f4d55ddc4cc6275ec9" title=" " alt="" coords="1691,563,1805,590"/>
<area shape="rect" href="spinlock_8h.html#a2c6e9db70599188dbe031e2ce8ec6b08" title=" " alt="" coords="1683,361,1813,387"/>
<area shape="rect" href="mem__protect_8h.html#a16fa0918fd8f50705e15341038d58fd8" title=" " alt="" coords="1169,507,1350,534"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a424af5862f022dc4c7a63b34219cd0f8" title=" " alt="" coords="683,457,861,483"/>
<area shape="rect" href="mem__protect_8h.html#af31ab34b10dfe2d918b3d0aedaaefc90" title=" " alt="" coords="933,355,1093,382"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a296892c18e515626259e369403a4d3d0" title=" " alt="" coords="681,609,863,635"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a315a65a066329bcea7b74d4eb11c963c" title=" " alt="" coords="911,78,1116,105"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a9fb5ca8500d8ba2e1c140f3dd549d832" title=" " alt="" coords="703,406,841,433"/>
<area shape="rect" href="nvhe_2tlb_8c.html#ac4dc226b1ecb9bca38c3096eb27c4c1d" title=" " alt="" coords="931,137,1096,163"/>
<area shape="rect" href="nvhe_2tlb_8c.html#afffa64d5f9de2ef7a026837a2b9a0629" title=" " alt="" coords="935,187,1092,214"/>
<area shape="rect" href="mem__protect_8h.html#a30e07c8d8daaddaecfb787562883f88d" title=" " alt="" coords="1184,129,1335,155"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a44f3b33f9c9af29ae5def49898ff81dd" title=" " alt="" coords="943,558,1084,585"/>
<area shape="rect" href="mem__protect_8c.html#aa70b12df63f9379efa7fe11ade510b7c" title=" " alt="" coords="1422,513,1586,539"/>
<area shape="rect" href="mem__protect_8c.html#a21f32ced99ed31332ac532029100e42d" title=" " alt="" coords="1414,411,1594,438"/>
<area shape="rect" href="mem__protect_8c.html#abbc50e372d72deb41a021219c35e3589" title=" " alt="" coords="1424,563,1584,590"/>
<area shape="rect" href="memory_8h.html#a3cc326fe973add2b2ea91f6b04dd8fde" title=" " alt="" coords="1434,614,1574,641"/>
<area shape="rect" href="mem__protect_8c.html#a024de911d90c8e8d57cc96c87fecb4d3" title=" " alt="" coords="1416,361,1592,387"/>
<area shape="rect" href="mem__protect_8c.html#ac46723bcc56baf1618eacb213151c926" title=" " alt="" coords="1164,399,1355,426"/>
<area shape="rect" href="mem__protect_8c.html#a908466d681d5e97d3703f5cdbb74195d" title=" " alt="" coords="1173,614,1345,641"/>
<area shape="rect" href="mem__protect_8c.html#ab39943fa5a8f70eca9309055e9a0e46d" title=" " alt="" coords="1165,335,1353,362"/>
<area shape="rect" href="gfp_8h.html#a7a740bb58e275f0307a86b02008f751a" title=" " alt="" coords="1439,462,1569,489"/>
<area shape="rect" href="memory_8h.html#aae436fb2b3f13c0954cde727104e80ac" title=" " alt="" coords="1193,78,1326,105"/>
<area shape="rect" href="pgtable_8c.html#ab0ed17e7108aa47fbba6cbdfea0b6606" title=" " alt="" coords="1180,180,1339,221"/>
<area shape="rect" href="mem__protect_8c.html#a7e4a0c65211d20b4e8adc2d323699489" title=" " alt="" coords="1459,209,1549,235"/>
<area shape="rect" href="mem__protect_8c.html#a09511b2fc9e756f5849a9a10c21946f2" title=" " alt="" coords="1696,234,1800,261"/>
<area shape="rect" href="mem__protect_8c.html#a4738d2842abcf74309391d6e6c677537" title=" " alt="" coords="1686,183,1810,210"/>
<area shape="rect" href="page__alloc_8c.html#a8ac88fa38a81f4de49d9e80665b1ffc0" title=" " alt="" coords="1672,513,1824,539"/>
<area shape="rect" href="memory_8h.html#af9e2f139c35baaaccb3e11cfe21cf182" title=" " alt="" coords="1653,411,1843,438"/>
<area shape="rect" href="page__alloc_8c.html#ab41323251ac55b72defe671d568dcce7" title=" " alt="" coords="1691,462,1805,489"/>
<area shape="rect" href="page__alloc_8c.html#ae518629a69c1b296e4ade7f9bd7041b8" title=" " alt="" coords="1895,563,2063,590"/>
<area shape="rect" href="page__alloc_8c.html#a02f9a2f04d282f7c4026c60bc2c8d81c" title=" " alt="" coords="1913,462,2045,489"/>
<area shape="rect" href="page__alloc_8c.html#ab55ed9a753f81792da659a3b165fefee" title=" " alt="" coords="1891,513,2067,539"/>
<area shape="rect" href="pgtable_8c.html#ab68001fdf94eab0c95183a0d99df3576" title=" " alt="" coords="1684,57,1812,83"/>
<area shape="rect" href="pgtable_8c.html#a2a6ed7242e033a1f32360cbe0e5c2281" title=" " alt="" coords="1431,107,1577,134"/>
<area shape="rect" href="pgtable_8c.html#a28c492866ecf19d7caee51ffa130c6cb" title=" " alt="" coords="1429,158,1579,185"/>
<area shape="rect" href="pgtable_8c.html#af01e17f60125c9e093e082e70a43f362" title=" " alt="" coords="1905,82,2053,109"/>
<area shape="rect" href="pgtable_8c.html#ac74b17e065ba3e68a10f28b594d21e40" title=" " alt="" coords="1672,107,1824,134"/>
<area shape="rect" href="spinlock_8h.html#ae92c9f4a09d239d6060880c35d12a48b" title=" " alt="" coords="932,609,1095,635"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#ae0206a7c88d213b1ff24538337468249" title=" " alt="" coords="1165,5,1354,47"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a57ca4bd54f074772ac03c6401856d122" title=" " alt="" coords="1403,6,1605,33"/>
<area shape="rect" href="hyp_2nvhe_2pkvm_8c.html#a9503b9e29dd4b2337feef252f5a57103" title=" " alt="" coords="948,431,1079,458"/>
<area shape="rect" href="mmu_8c.html#ace8dc778dfd3f12f9944cb1f6cc1d40d" title=" " alt="" coords="709,817,835,843"/>
<area shape="rect" href="mmu_8c.html#a2a7af09cc56dc8cd69de6c8d2acacd12" title=" " alt="" coords="717,766,827,793"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_a0de2dfe512399e7f17c01091bc3e8ae8_icgraph.png" border="0" usemap="#apkvm_8c_a0de2dfe512399e7f17c01091bc3e8ae8_icgraph" alt=""/></div>
<map name="apkvm_8c_a0de2dfe512399e7f17c01091bc3e8ae8_icgraph" id="apkvm_8c_a0de2dfe512399e7f17c01091bc3e8ae8_icgraph">
<area shape="rect" title=" " alt="" coords="1029,53,1204,80"/>
<area shape="rect" href="arm_8c.html#ad84dda268db5d48c48f3ef2f438c62a7" title=" " alt="" coords="811,53,981,80"/>
<area shape="rect" href="kvm__main_8c.html#a54b22e6be98d31db1a83e7993fbcf4bc" title=" " alt="" coords="453,9,580,36"/>
<area shape="rect" href="kvm__main_8c.html#afd922c538c448ab1248cdb9dccae9410" title=" " alt="" coords="628,79,763,105"/>
<area shape="rect" href="kvm__main_8c.html#a955de4f2a1b3371438636eccab732b27" title=" " alt="" coords="212,5,405,32"/>
<area shape="rect" href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241" title=" " alt="" coords="459,104,574,131"/>
<area shape="rect" href="kvm__main_8c.html#a37fa7805021941c56fe174eae4c8c377" title=" " alt="" coords="234,56,383,83"/>
<area shape="rect" href="kvm__main_8c.html#af19040bdcea372f13eab66499d99201c" title=" " alt="" coords="226,107,391,133"/>
<area shape="rect" href="guest__memfd_8c.html#ad8912fbda61cdcb6d9e5a3c0f839e001" title=" " alt="" coords="231,157,386,184"/>
<area shape="rect" href="kvm__main_8c.html#af67afbdcee89641f21573ac643d8e693" title=" " alt="" coords="241,208,376,235"/>
<area shape="rect" href="kvm__main_8c.html#a87bcafdc42ee32aedb84df5e564f9872" title=" " alt="" coords="5,56,164,83"/>
</map>
</div>

</div>
</div>
<a id="aa20f2bcf96aa18cc24b66929b28fd83f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa20f2bcf96aa18cc24b66929b28fd83f">&#9670;&nbsp;</a></span>pkvm_drop_host_privileges()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __init pkvm_drop_host_privileges </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00237">237</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;{</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">     * Flip the static key upfront as that may no longer be possible</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">     * once the host stage 2 is installed.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    static_branch_enable(&amp;kvm_protected_mode_initialized);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    on_each_cpu(<a class="code" href="pkvm_8c.html#a4bbccfa61581daa041ae3d760f1c4594">_kvm_host_prot_finalize</a>, &amp;ret, 1);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="ttc" id="apkvm_8c_html_a4bbccfa61581daa041ae3d760f1c4594"><div class="ttname"><a href="pkvm_8c.html#a4bbccfa61581daa041ae3d760f1c4594">_kvm_host_prot_finalize</a></div><div class="ttdeci">static void __init _kvm_host_prot_finalize(void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00229">pkvm.c:229</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_aa20f2bcf96aa18cc24b66929b28fd83f_cgraph.png" border="0" usemap="#apkvm_8c_aa20f2bcf96aa18cc24b66929b28fd83f_cgraph" alt=""/></div>
<map name="apkvm_8c_aa20f2bcf96aa18cc24b66929b28fd83f_cgraph" id="apkvm_8c_aa20f2bcf96aa18cc24b66929b28fd83f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,207,32"/>
<area shape="rect" href="pkvm_8c.html#a4bbccfa61581daa041ae3d760f1c4594" title=" " alt="" coords="255,5,435,32"/>
<area shape="rect" href="mem__protect_8h.html#a9a57b30f2fad6430b6af09466c0c57f0" title=" " alt="" coords="483,5,643,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_aa20f2bcf96aa18cc24b66929b28fd83f_icgraph.png" border="0" usemap="#apkvm_8c_aa20f2bcf96aa18cc24b66929b28fd83f_icgraph" alt=""/></div>
<map name="apkvm_8c_aa20f2bcf96aa18cc24b66929b28fd83f_icgraph" id="apkvm_8c_aa20f2bcf96aa18cc24b66929b28fd83f_icgraph">
<area shape="rect" title=" " alt="" coords="167,5,368,32"/>
<area shape="rect" href="pkvm_8c.html#ac3e5bdb9bef69af06b3ef46b15b3a095" title=" " alt="" coords="5,5,119,32"/>
</map>
</div>

</div>
</div>
<a id="ae7ee42a2f7eb38a1293f06e36ac81465"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ee42a2f7eb38a1293f06e36ac81465">&#9670;&nbsp;</a></span>pkvm_init_host_vm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pkvm_init_host_vm </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>host_kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00223">223</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;{</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    mutex_init(&amp;host_kvm-&gt;lock);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_ae7ee42a2f7eb38a1293f06e36ac81465_icgraph.png" border="0" usemap="#apkvm_8c_ae7ee42a2f7eb38a1293f06e36ac81465_icgraph" alt=""/></div>
<map name="apkvm_8c_ae7ee42a2f7eb38a1293f06e36ac81465_icgraph" id="apkvm_8c_ae7ee42a2f7eb38a1293f06e36ac81465_icgraph">
<area shape="rect" title=" " alt="" coords="612,5,763,32"/>
<area shape="rect" href="arm_8c.html#a78b266c18dac3b9edbea80941c96e2cd" title=" " alt="" coords="421,5,564,32"/>
<area shape="rect" href="kvm__main_8c.html#a54b22e6be98d31db1a83e7993fbcf4bc" title=" " alt="" coords="247,5,373,32"/>
<area shape="rect" href="kvm__main_8c.html#a955de4f2a1b3371438636eccab732b27" title=" " alt="" coords="5,5,199,32"/>
</map>
</div>

</div>
</div>
<a id="aaa66e101cb9571b2a50b83cb3bc173d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa66e101cb9571b2a50b83cb3bc173d5">&#9670;&nbsp;</a></span>register_memblock_regions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __init register_memblock_regions </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00043">43</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">struct </span>memblock_region *reg;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    for_each_mem_region(reg) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">if</span> (*<a class="code" href="pkvm_8c.html#a4428242d6d030363fbe16f95d226cdb2">hyp_memblock_nr_ptr</a> &gt;= HYP_MEMBLOCK_REGIONS)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="pkvm_8c.html#af9d3a851e6a48fd74de91530882c3737">hyp_memory</a>[*<a class="code" href="pkvm_8c.html#a4428242d6d030363fbe16f95d226cdb2">hyp_memblock_nr_ptr</a>] = *reg;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        (*hyp_memblock_nr_ptr)++;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="pkvm_8c.html#a702d5384d853263899dc182035154875">sort_memblock_regions</a>();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
<div class="ttc" id="apkvm_8c_html_a702d5384d853263899dc182035154875"><div class="ttname"><a href="pkvm_8c.html#a702d5384d853263899dc182035154875">sort_memblock_regions</a></div><div class="ttdeci">static void __init sort_memblock_regions(void)</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00034">pkvm.c:34</a></div></div>
<div class="ttc" id="apkvm_8c_html_af9d3a851e6a48fd74de91530882c3737"><div class="ttname"><a href="pkvm_8c.html#af9d3a851e6a48fd74de91530882c3737">hyp_memory</a></div><div class="ttdeci">static struct memblock_region * hyp_memory</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00020">pkvm.c:20</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_aaa66e101cb9571b2a50b83cb3bc173d5_cgraph.png" border="0" usemap="#apkvm_8c_aaa66e101cb9571b2a50b83cb3bc173d5_cgraph" alt=""/></div>
<map name="apkvm_8c_aaa66e101cb9571b2a50b83cb3bc173d5_cgraph" id="apkvm_8c_aaa66e101cb9571b2a50b83cb3bc173d5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,208,32"/>
<area shape="rect" href="pkvm_8c.html#a702d5384d853263899dc182035154875" title=" " alt="" coords="256,5,435,32"/>
<area shape="rect" href="pkvm_8c.html#a5204c5b48a08d6ab6a2805782377d807" title=" " alt="" coords="483,5,640,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_aaa66e101cb9571b2a50b83cb3bc173d5_icgraph.png" border="0" usemap="#apkvm_8c_aaa66e101cb9571b2a50b83cb3bc173d5_icgraph" alt=""/></div>
<map name="apkvm_8c_aaa66e101cb9571b2a50b83cb3bc173d5_icgraph" id="apkvm_8c_aaa66e101cb9571b2a50b83cb3bc173d5_icgraph">
<area shape="rect" title=" " alt="" coords="192,5,395,32"/>
<area shape="rect" href="pkvm_8c.html#a2596eb2ca4793a98586d311f7ffe615f" title=" " alt="" coords="5,5,144,32"/>
</map>
</div>

</div>
</div>
<a id="a702d5384d853263899dc182035154875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a702d5384d853263899dc182035154875">&#9670;&nbsp;</a></span>sort_memblock_regions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __init sort_memblock_regions </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00034">34</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    sort(<a class="code" href="pkvm_8c.html#af9d3a851e6a48fd74de91530882c3737">hyp_memory</a>,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;         *<a class="code" href="pkvm_8c.html#a4428242d6d030363fbe16f95d226cdb2">hyp_memblock_nr_ptr</a>,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;         <span class="keyword">sizeof</span>(<span class="keyword">struct</span> memblock_region),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;         <a class="code" href="pkvm_8c.html#a5204c5b48a08d6ab6a2805782377d807">cmp_hyp_memblock</a>,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;         NULL);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
<div class="ttc" id="apkvm_8c_html_a5204c5b48a08d6ab6a2805782377d807"><div class="ttname"><a href="pkvm_8c.html#a5204c5b48a08d6ab6a2805782377d807">cmp_hyp_memblock</a></div><div class="ttdeci">static int cmp_hyp_memblock(const void *p1, const void *p2)</div><div class="ttdef"><b>Definition:</b> <a href="pkvm_8c_source.html#l00026">pkvm.c:26</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_a702d5384d853263899dc182035154875_cgraph.png" border="0" usemap="#apkvm_8c_a702d5384d853263899dc182035154875_cgraph" alt=""/></div>
<map name="apkvm_8c_a702d5384d853263899dc182035154875_cgraph" id="apkvm_8c_a702d5384d853263899dc182035154875_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,184,32"/>
<area shape="rect" href="pkvm_8c.html#a5204c5b48a08d6ab6a2805782377d807" title=" " alt="" coords="232,5,389,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pkvm_8c_a702d5384d853263899dc182035154875_icgraph.png" border="0" usemap="#apkvm_8c_a702d5384d853263899dc182035154875_icgraph" alt=""/></div>
<map name="apkvm_8c_a702d5384d853263899dc182035154875_icgraph" id="apkvm_8c_a702d5384d853263899dc182035154875_icgraph">
<area shape="rect" title=" " alt="" coords="443,5,621,32"/>
<area shape="rect" href="pkvm_8c.html#aaa66e101cb9571b2a50b83cb3bc173d5" title=" " alt="" coords="192,5,395,32"/>
<area shape="rect" href="pkvm_8c.html#a2596eb2ca4793a98586d311f7ffe615f" title=" " alt="" coords="5,5,144,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4acdeed5ab024194953e8f589edd493b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4acdeed5ab024194953e8f589edd493b">&#9670;&nbsp;</a></span>hyp_mem_base</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">phys_addr_t hyp_mem_base</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00023">23</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>

</div>
</div>
<a id="a34f70fd9cdbf312a994c8cd96284caee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34f70fd9cdbf312a994c8cd96284caee">&#9670;&nbsp;</a></span>hyp_mem_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">phys_addr_t hyp_mem_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00024">24</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>

</div>
</div>
<a id="a4428242d6d030363fbe16f95d226cdb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4428242d6d030363fbe16f95d226cdb2">&#9670;&nbsp;</a></span>hyp_memblock_nr_ptr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int* hyp_memblock_nr_ptr = &amp;kvm_nvhe_sym(<a class="el" href="mm_8c.html#ae067f6ae4aa2f9ac9e94557ee956ed60">hyp_memblock_nr</a>)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00021">21</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>

</div>
</div>
<a id="af9d3a851e6a48fd74de91530882c3737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9d3a851e6a48fd74de91530882c3737">&#9670;&nbsp;</a></span>hyp_memory</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct memblock_region* hyp_memory = kvm_nvhe_sym(hyp_memory)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkvm_8c_source.html#l00020">20</a> of file <a class="el" href="pkvm_8c_source.html">pkvm.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
