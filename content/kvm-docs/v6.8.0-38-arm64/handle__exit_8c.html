<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KVM: arch/arm64/kvm/handle_exit.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ea9599923402ca8ab47fc3e495999dea.html">arch</a></li><li class="navelem"><a class="el" href="dir_67a9e021ce8db5d46236c6154ee454bc.html">arm64</a></li><li class="navelem"><a class="el" href="dir_42f87ef63ac4150166bf7887f68288e2.html">kvm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">handle_exit.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/kvm.h&gt;</code><br />
<code>#include &lt;linux/kvm_host.h&gt;</code><br />
<code>#include &lt;asm/esr.h&gt;</code><br />
<code>#include &lt;asm/exception.h&gt;</code><br />
<code>#include &lt;asm/kvm_asm.h&gt;</code><br />
<code>#include &lt;asm/kvm_emulate.h&gt;</code><br />
<code>#include &lt;asm/kvm_mmu.h&gt;</code><br />
<code>#include &lt;asm/kvm_nested.h&gt;</code><br />
<code>#include &lt;asm/debug-monitors.h&gt;</code><br />
<code>#include &lt;asm/stacktrace/nvhe.h&gt;</code><br />
<code>#include &lt;asm/traps.h&gt;</code><br />
<code>#include &lt;<a class="el" href="arm__hypercalls_8h_source.html">kvm/arm_hypercalls.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="trace__handle__exit_8h_source.html">trace_handle_exit.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for handle_exit.c:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c__incl.png" border="0" usemap="#aarch_2arm64_2kvm_2handle__exit_8c" alt=""/></div>
<map name="aarch_2arm64_2kvm_2handle__exit_8c" id="aarch_2arm64_2kvm_2handle__exit_8c">
<area shape="rect" title=" " alt="" coords="737,5,914,47"/>
<area shape="rect" title=" " alt="" coords="5,95,104,121"/>
<area shape="rect" title=" " alt="" coords="129,95,263,121"/>
<area shape="rect" title=" " alt="" coords="288,95,373,121"/>
<area shape="rect" title=" " alt="" coords="397,95,528,121"/>
<area shape="rect" title=" " alt="" coords="552,95,683,121"/>
<area shape="rect" title=" " alt="" coords="1062,169,1218,196"/>
<area shape="rect" title=" " alt="" coords="757,95,893,121"/>
<area shape="rect" title=" " alt="" coords="917,95,1064,121"/>
<area shape="rect" title=" " alt="" coords="1089,95,1258,121"/>
<area shape="rect" title=" " alt="" coords="1283,95,1453,121"/>
<area shape="rect" title=" " alt="" coords="1477,95,1576,121"/>
<area shape="rect" href="arm__hypercalls_8h.html" title=" " alt="" coords="1601,95,1767,121"/>
<area shape="rect" href="trace__handle__exit_8h.html" title=" " alt="" coords="1791,95,1942,121"/>
<area shape="rect" title=" " alt="" coords="1661,169,1797,196"/>
<area shape="rect" href="sys__regs_8h.html" title=" " alt="" coords="1821,169,1912,196"/>
<area shape="rect" title=" " alt="" coords="1937,169,2087,196"/>
<area shape="rect" title=" " alt="" coords="1806,244,1927,271"/>
</map>
</div>
</div>
<p><a href="handle__exit_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a40473b47b4871fa538a0fa131f94e774"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#a40473b47b4871fa538a0fa131f94e774">CREATE_TRACE_POINTS</a></td></tr>
<tr class="separator:a40473b47b4871fa538a0fa131f94e774"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a339387f2d97c45b60a2741cb3d6ffc23"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#a339387f2d97c45b60a2741cb3d6ffc23">exit_handle_fn</a>) (struct kvm_vcpu *)</td></tr>
<tr class="separator:a339387f2d97c45b60a2741cb3d6ffc23"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abb699db7254ba704ba98fbe5ffcff950"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#abb699db7254ba704ba98fbe5ffcff950">kvm_handle_guest_serror</a> (struct kvm_vcpu *vcpu, u64 esr)</td></tr>
<tr class="separator:abb699db7254ba704ba98fbe5ffcff950"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c24d46393da9651d3133e2377fd7a69"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69">handle_hvc</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a5c24d46393da9651d3133e2377fd7a69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2545fb9f7329ef0604715b9af4a1746"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746">handle_smc</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad2545fb9f7329ef0604715b9af4a1746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba3cb2b15ab0fafd0ac45b621d3bb6b3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#aba3cb2b15ab0fafd0ac45b621d3bb6b3">handle_no_fpsimd</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aba3cb2b15ab0fafd0ac45b621d3bb6b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b391fc62c2250ecc0bfcdbe1b0a6788"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788">kvm_handle_wfx</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a0b391fc62c2250ecc0bfcdbe1b0a6788"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcce6bad48b6a9769e594aeba3f73717"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#afcce6bad48b6a9769e594aeba3f73717">kvm_handle_guest_debug</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:afcce6bad48b6a9769e594aeba3f73717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a313f5469836166a2b9b9e2164fd00cdb"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#a313f5469836166a2b9b9e2164fd00cdb">kvm_handle_unknown_ec</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a313f5469836166a2b9b9e2164fd00cdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e3ab5fffb73f5ca9700a79f510dcf8f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#a3e3ab5fffb73f5ca9700a79f510dcf8f">handle_sve</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a3e3ab5fffb73f5ca9700a79f510dcf8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a50407175f0512dcb278e198ce16254"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#a0a50407175f0512dcb278e198ce16254">kvm_handle_ptrauth</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a0a50407175f0512dcb278e198ce16254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae96aab7918301d55b908034db5855e3d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d">kvm_handle_eret</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ae96aab7918301d55b908034db5855e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf983f5c40202edc8b07a76603330cd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd">handle_svc</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aeaf983f5c40202edc8b07a76603330cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a610aaf7e46afbe6c5972ecf6136ed3f4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="handle__exit_8c.html#a339387f2d97c45b60a2741cb3d6ffc23">exit_handle_fn</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#a610aaf7e46afbe6c5972ecf6136ed3f4">kvm_get_exit_handler</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a610aaf7e46afbe6c5972ecf6136ed3f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e4b30e6e0a029e045b0799b6ff8c09"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#af5e4b30e6e0a029e045b0799b6ff8c09">handle_trap_exceptions</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:af5e4b30e6e0a029e045b0799b6ff8c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff5e40f09d30605ee752ff88fcd86dec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#aff5e40f09d30605ee752ff88fcd86dec">handle_exit</a> (struct kvm_vcpu *vcpu, int exception_index)</td></tr>
<tr class="separator:aff5e40f09d30605ee752ff88fcd86dec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af079d930452619eae7b05217368cd2a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#af079d930452619eae7b05217368cd2a3">handle_exit_early</a> (struct kvm_vcpu *vcpu, int exception_index)</td></tr>
<tr class="separator:af079d930452619eae7b05217368cd2a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4178b53f163a01d027c13d2a1248771"><td class="memItemLeft" align="right" valign="top">void __noreturn __cold&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#ab4178b53f163a01d027c13d2a1248771">nvhe_hyp_panic_handler</a> (u64 esr, u64 spsr, u64 elr_virt, u64 elr_phys, u64 par, uintptr_t vcpu, u64 far, u64 hpfar)</td></tr>
<tr class="separator:ab4178b53f163a01d027c13d2a1248771"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:acb2ef35f12aad0be19cdf8d484746961"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="handle__exit_8c.html#a339387f2d97c45b60a2741cb3d6ffc23">exit_handle_fn</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="handle__exit_8c.html#acb2ef35f12aad0be19cdf8d484746961">arm_exit_handlers</a> []</td></tr>
<tr class="separator:acb2ef35f12aad0be19cdf8d484746961"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a40473b47b4871fa538a0fa131f94e774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40473b47b4871fa538a0fa131f94e774">&#9670;&nbsp;</a></span>CREATE_TRACE_POINTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CREATE_TRACE_POINTS</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00026">26</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a339387f2d97c45b60a2741cb3d6ffc23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a339387f2d97c45b60a2741cb3d6ffc23">&#9670;&nbsp;</a></span>exit_handle_fn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* exit_handle_fn) (struct kvm_vcpu *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00029">29</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aff5e40f09d30605ee752ff88fcd86dec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff5e40f09d30605ee752ff88fcd86dec">&#9670;&nbsp;</a></span>handle_exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_exit </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exception_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00322">322</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keyword">struct </span>kvm_run *run = vcpu-&gt;run;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span> (ARM_SERROR_PENDING(exception_index)) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">         * The SError is handled by handle_exit_early(). If the guest</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">         * survives it will re-execute the original instruction.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    exception_index = ARM_EXCEPTION_CODE(exception_index);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">switch</span> (exception_index) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">case</span> ARM_EXCEPTION_IRQ:</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">case</span> ARM_EXCEPTION_EL1_SERROR:</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">case</span> ARM_EXCEPTION_TRAP:</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="handle__exit_8c.html#af5e4b30e6e0a029e045b0799b6ff8c09">handle_trap_exceptions</a>(vcpu);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">case</span> ARM_EXCEPTION_HYP_GONE:</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">         * EL2 has been reset to the hyp-stub. This happens when a guest</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">         * is pre-emptied by kvm_reboot()&#39;s shutdown call.</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        run-&gt;exit_reason = KVM_EXIT_FAIL_ENTRY;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">case</span> ARM_EXCEPTION_IL:</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">         * We attempted an illegal exception return.  Guest state must</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">         * have been corrupted somehow.  Give up.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        run-&gt;exit_reason = KVM_EXIT_FAIL_ENTRY;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <a class="code" href="sys__regs_8h.html#ac51d3b33e33ecf2bd1086119c1d55546">kvm_pr_unimpl</a>(<span class="stringliteral">&quot;Unsupported exception type: %d&quot;</span>,</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                  exception_index);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        run-&gt;exit_reason = KVM_EXIT_INTERNAL_ERROR;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div>
<div class="ttc" id="ahandle__exit_8c_html_af5e4b30e6e0a029e045b0799b6ff8c09"><div class="ttname"><a href="handle__exit_8c.html#af5e4b30e6e0a029e045b0799b6ff8c09">handle_trap_exceptions</a></div><div class="ttdeci">static int handle_trap_exceptions(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00297">handle_exit.c:297</a></div></div>
<div class="ttc" id="asys__regs_8h_html_ac51d3b33e33ecf2bd1086119c1d55546"><div class="ttname"><a href="sys__regs_8h.html#ac51d3b33e33ecf2bd1086119c1d55546">kvm_pr_unimpl</a></div><div class="ttdeci">kvm_pr_unimpl(&quot;%pV { Op0(%2u), Op1(%2u), CRn(%2u), CRm(%2u), Op2(%2u), func_%s },\n&quot;, &amp;(struct va_format){ fmt, &amp;va }, p-&gt;Op0, p-&gt;Op1, p-&gt;CRn, p-&gt;CRm, p-&gt;Op2, p-&gt;is_write ? &quot;write&quot; :&quot;read&quot;)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_aff5e40f09d30605ee752ff88fcd86dec_cgraph.png" border="0" usemap="#ahandle__exit_8c_aff5e40f09d30605ee752ff88fcd86dec_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_aff5e40f09d30605ee752ff88fcd86dec_cgraph" id="ahandle__exit_8c_aff5e40f09d30605ee752ff88fcd86dec_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,104,57"/>
<area shape="rect" href="handle__exit_8c.html#af5e4b30e6e0a029e045b0799b6ff8c09" title=" " alt="" coords="152,5,329,32"/>
<area shape="rect" href="sys__regs_8h.html#ac51d3b33e33ecf2bd1086119c1d55546" title=" " alt="" coords="179,56,302,83"/>
<area shape="rect" href="handle__exit_8c.html#a610aaf7e46afbe6c5972ecf6136ed3f4" title=" " alt="" coords="377,5,544,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_aff5e40f09d30605ee752ff88fcd86dec_icgraph.png" border="0" usemap="#ahandle__exit_8c_aff5e40f09d30605ee752ff88fcd86dec_icgraph" alt=""/></div>
<map name="ahandle__exit_8c_aff5e40f09d30605ee752ff88fcd86dec_icgraph" id="ahandle__exit_8c_aff5e40f09d30605ee752ff88fcd86dec_icgraph">
<area shape="rect" title=" " alt="" coords="412,5,511,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="af079d930452619eae7b05217368cd2a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af079d930452619eae7b05217368cd2a3">&#9670;&nbsp;</a></span>handle_exit_early()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void handle_exit_early </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exception_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00366">366</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;{</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span> (ARM_SERROR_PENDING(exception_index)) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span> (this_cpu_has_cap(ARM64_HAS_RAS_EXTN)) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            u64 disr = kvm_vcpu_get_disr(vcpu);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <a class="code" href="handle__exit_8c.html#abb699db7254ba704ba98fbe5ffcff950">kvm_handle_guest_serror</a>(vcpu, disr_to_esr(disr));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <a class="code" href="inject__fault_8c.html#a22de1c7e33612b2212ecdf333a228340">kvm_inject_vabt</a>(vcpu);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    exception_index = ARM_EXCEPTION_CODE(exception_index);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (exception_index == ARM_EXCEPTION_EL1_SERROR)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="handle__exit_8c.html#abb699db7254ba704ba98fbe5ffcff950">kvm_handle_guest_serror</a>(vcpu, kvm_vcpu_get_esr(vcpu));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="ttc" id="ahandle__exit_8c_html_abb699db7254ba704ba98fbe5ffcff950"><div class="ttname"><a href="handle__exit_8c.html#abb699db7254ba704ba98fbe5ffcff950">kvm_handle_guest_serror</a></div><div class="ttdeci">static void kvm_handle_guest_serror(struct kvm_vcpu *vcpu, u64 esr)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00031">handle_exit.c:31</a></div></div>
<div class="ttc" id="ainject__fault_8c_html_a22de1c7e33612b2212ecdf333a228340"><div class="ttname"><a href="inject__fault_8c.html#a22de1c7e33612b2212ecdf333a228340">kvm_inject_vabt</a></div><div class="ttdeci">void kvm_inject_vabt(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="inject__fault_8c_source.html#l00251">inject_fault.c:251</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_af079d930452619eae7b05217368cd2a3_cgraph.png" border="0" usemap="#ahandle__exit_8c_af079d930452619eae7b05217368cd2a3_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_af079d930452619eae7b05217368cd2a3_cgraph" id="ahandle__exit_8c_af079d930452619eae7b05217368cd2a3_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,144,57"/>
<area shape="rect" href="handle__exit_8c.html#abb699db7254ba704ba98fbe5ffcff950" title=" " alt="" coords="192,5,383,32"/>
<area shape="rect" href="inject__fault_8c.html#a22de1c7e33612b2212ecdf333a228340" title=" " alt="" coords="431,31,561,57"/>
<area shape="rect" href="inject__fault_8c.html#add5913f66290fa09779d83f20800e7f1" title=" " alt="" coords="609,31,740,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_af079d930452619eae7b05217368cd2a3_icgraph.png" border="0" usemap="#ahandle__exit_8c_af079d930452619eae7b05217368cd2a3_icgraph" alt=""/></div>
<map name="ahandle__exit_8c_af079d930452619eae7b05217368cd2a3_icgraph" id="ahandle__exit_8c_af079d930452619eae7b05217368cd2a3_icgraph">
<area shape="rect" title=" " alt="" coords="412,5,551,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a5c24d46393da9651d3133e2377fd7a69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c24d46393da9651d3133e2377fd7a69">&#9670;&nbsp;</a></span>handle_hvc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_hvc </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00037">37</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    trace_kvm_hvc_arm64(*vcpu_pc(vcpu), vcpu_get_reg(vcpu, 0),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                kvm_vcpu_hvc_get_imm(vcpu));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    vcpu-&gt;stat.hvc_exit_stat++;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">/* Forward hvc instructions to the virtual EL2 if the guest has EL2. */</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (vcpu_has_nv(vcpu)) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="sys__regs_8c.html#a79848758fc91bd6081326514833ffafa">vcpu_read_sys_reg</a>(vcpu, HCR_EL2) &amp; HCR_HCD)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <a class="code" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb">kvm_inject_undefined</a>(vcpu);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <a class="code" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d">kvm_inject_nested_sync</a>(vcpu, kvm_vcpu_get_esr(vcpu));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4">kvm_smccc_call_handler</a>(vcpu);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="aemulate-nested_8c_html_af5e2eb745d8ac6415fe941ebe754171d"><div class="ttname"><a href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d">kvm_inject_nested_sync</a></div><div class="ttdeci">int kvm_inject_nested_sync(struct kvm_vcpu *vcpu, u64 esr_el2)</div><div class="ttdef"><b>Definition:</b> <a href="emulate-nested_8c_source.html#l02162">emulate-nested.c:2162</a></div></div>
<div class="ttc" id="ahypercalls_8c_html_a62d0b161cae45d4a2f865203301f7ac4"><div class="ttname"><a href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4">kvm_smccc_call_handler</a></div><div class="ttdeci">int kvm_smccc_call_handler(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="hypercalls_8c_source.html#l00263">hypercalls.c:263</a></div></div>
<div class="ttc" id="ainject__fault_8c_html_aece14f61701021b17e9cf5521f7946fb"><div class="ttname"><a href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb">kvm_inject_undefined</a></div><div class="ttdeci">void kvm_inject_undefined(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="inject__fault_8c_source.html#l00225">inject_fault.c:225</a></div></div>
<div class="ttc" id="asys__regs_8c_html_a79848758fc91bd6081326514833ffafa"><div class="ttname"><a href="sys__regs_8c.html#a79848758fc91bd6081326514833ffafa">vcpu_read_sys_reg</a></div><div class="ttdeci">u64 vcpu_read_sys_reg(const struct kvm_vcpu *vcpu, int reg)</div><div class="ttdef"><b>Definition:</b> <a href="sys__regs_8c_source.html#l00128">sys_regs.c:128</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_a5c24d46393da9651d3133e2377fd7a69_cgraph.png" border="0" usemap="#ahandle__exit_8c_a5c24d46393da9651d3133e2377fd7a69_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_a5c24d46393da9651d3133e2377fd7a69_cgraph" id="ahandle__exit_8c_a5c24d46393da9651d3133e2377fd7a69_cgraph">
<area shape="rect" title=" " alt="" coords="5,855,101,881"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="151,703,333,729"/>
<area shape="rect" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb" title=" " alt="" coords="159,829,325,856"/>
<area shape="rect" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4" title=" " alt="" coords="149,1336,335,1363"/>
<area shape="rect" href="sys__regs_8c.html#a79848758fc91bd6081326514833ffafa" title=" " alt="" coords="169,880,315,907"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="413,621,559,648"/>
<area shape="rect" href="exception_8c.html#a69b40cbdae816f5cb612962c0f5da592" title=" " alt="" coords="675,56,810,83"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="663,300,822,327"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="667,621,819,648"/>
<area shape="rect" href="emulate-nested_8c.html#a5c0ef76a2f1feaeb264f0d4957c8f527" title=" " alt="" coords="647,673,839,700"/>
<area shape="rect" href="exception_8c.html#a5951865f1186392f5e4f0bc260c3b840" title=" " alt="" coords="920,5,1085,32"/>
<area shape="rect" href="adjust__pc_8h.html#a3a6ebd94aaf8bbd3c8461a2ca19a0d0d" title=" " alt="" coords="942,56,1063,83"/>
<area shape="rect" href="nvhe_2tlb_8c.html#ae52fe3c4f97b5b56e65233015785a6ec" title=" " alt="" coords="908,325,1097,352"/>
<area shape="rect" href="debug_8c.html#aae61f6ee77424b3eb0cb727586a694eb" title=" " alt="" coords="923,377,1082,418"/>
<area shape="rect" href="fpsimd_8c.html#a6d3b97095b4e6a0d7799fe50eb3fb762" title=" " alt="" coords="913,443,1092,469"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="919,107,1086,133"/>
<area shape="rect" href="vhe_2switch_8c.html#ae2827f745640cc27776384fbe890f8e4" title=" " alt="" coords="925,157,1080,184"/>
<area shape="rect" href="pmu_8c.html#a928d4df1b401e9b41f92dd2aa2744529" title=" " alt="" coords="913,209,1092,250"/>
<area shape="rect" href="vgic_8c.html#a54d5d884ac662357df5661d80f5160e3" title=" " alt="" coords="943,275,1063,301"/>
<area shape="rect" href="debug_8c.html#a40ab178c06775c17444821f2b88d89c9" title=" " alt="" coords="903,494,1102,535"/>
<area shape="rect" href="fpsimd_8c.html#a315297a309db16c8cbbe1ab46c7413ba" title=" " alt="" coords="917,560,1089,587"/>
<area shape="rect" href="vmid_8c.html#a2de0128c579224dac8d0964d383122cf" title=" " alt="" coords="921,611,1084,653"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="923,677,1082,704"/>
<area shape="rect" href="pmu_8c.html#a4e027f0c751f9cc01fa6d3c3f082216b" title=" " alt="" coords="896,728,1109,755"/>
<area shape="rect" href="vhe_2switch_8c.html#acecfb29f871562a6288b28ba84a8150e" title=" " alt="" coords="929,779,1077,805"/>
<area shape="rect" href="sys__regs_8c.html#adf66277e472bdae2cc839d450085bc4b" title=" " alt="" coords="927,829,1078,856"/>
<area shape="rect" href="sys__regs_8c.html#a8f5bcf4d21c4d9b1881dd3fec5bd6178" title=" " alt="" coords="1157,855,1339,881"/>
<area shape="rect" href="inject__fault_8c.html#ae6fc8db83ad0518fddd2e485687e0f7d" title=" " alt="" coords="427,829,545,856"/>
<area shape="rect" href="inject__fault_8c.html#a846082def00d9a7db3f28b1b7fb2a07a" title=" " alt="" coords="427,779,545,805"/>
<area shape="rect" href="inject__fault_8c.html#a326fe690ce371beb7496d3ed3cbe1a6e" title=" " alt="" coords="679,779,807,805"/>
<area shape="rect" href="inject__fault_8c.html#a887586bbc6bac834ae37cbf84711288c" title=" " alt="" coords="661,829,824,856"/>
<area shape="rect" href="pvtime_8c.html#a0a13c651b49c43a6139569798311764c" title=" " alt="" coords="385,1387,587,1413"/>
<area shape="rect" href="arm__hypercalls_8h.html#aab3de177147e0efb70c732a1ad3706dd" title=" " alt="" coords="939,1463,1066,1489"/>
<area shape="rect" href="pvtime_8c.html#a816827bb2ed919f4679817bc707665f8" title=" " alt="" coords="405,1108,567,1135"/>
<area shape="rect" href="hypercalls_8c.html#aeee8a70cfdf2a25b0f80f785fdf449c6" title=" " alt="" coords="383,1159,589,1185"/>
<area shape="rect" href="psci_8c.html#a3daa8000eb9717dde07d817c306b052b" title=" " alt="" coords="429,1209,543,1236"/>
<area shape="rect" href="arm__hypercalls_8h.html#a8baef8e49dbce7b140c519845a20611f" title=" " alt="" coords="1173,1091,1323,1117"/>
<area shape="rect" href="arm__hypercalls_8h.html#ae543f09c1c7681cec4e5d2dfa0e728a1" title=" " alt="" coords="1181,1301,1315,1328"/>
<area shape="rect" href="hypercalls_8c.html#a74c79c1b9740674575ae30970f11fcfa" title=" " alt="" coords="414,1437,558,1464"/>
<area shape="rect" href="hypercalls_8c.html#a33c0affb2c4abb0f0012206bb7e3d378" title=" " alt="" coords="399,1779,573,1805"/>
<area shape="rect" href="trng_8c.html#a77478bf42ec810a0e55387bf3a7997c2" title=" " alt="" coords="429,1589,543,1616"/>
<area shape="rect" href="psci_8c.html#af18cf22560595f1da5e34ea244b0b51b" title=" " alt="" coords="931,1032,1075,1059"/>
<area shape="rect" href="psci_8c.html#ac7522f6e0d1805f44a3e932397de4582" title=" " alt="" coords="931,1200,1075,1227"/>
<area shape="rect" href="psci_8c.html#a8f59d47a1b54f561b8c42f509798142e" title=" " alt="" coords="671,1235,815,1261"/>
<area shape="rect" href="psci_8c.html#a3b9f15ff62c952f20de3ed44aaf4edbc" title=" " alt="" coords="909,1083,1096,1125"/>
<area shape="rect" href="arm__psci_8h.html#ae8e32b0627b1dc8c12a32d279c1a3bf4" title=" " alt="" coords="673,1032,812,1059"/>
<area shape="rect" href="hypercalls_8c.html#ac9f33ca9d642c7231be25e02e9da450a" title=" " alt="" coords="637,1859,848,1885"/>
<area shape="rect" href="hypercalls_8c.html#af93c35a0fd5825a99b62189ae5024a45" title=" " alt="" coords="661,1742,825,1783"/>
<area shape="rect" href="hypercalls_8c.html#aa8aa7ec82883c6c825b0373750c779a2" title=" " alt="" coords="644,1808,841,1835"/>
<area shape="rect" href="trng_8c.html#a3d1ac492ec1515ed0864e4e9b44e4221" title=" " alt="" coords="675,1589,810,1616"/>
</map>
</div>

</div>
</div>
<a id="aba3cb2b15ab0fafd0ac45b621d3bb6b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba3cb2b15ab0fafd0ac45b621d3bb6b3">&#9670;&nbsp;</a></span>handle_no_fpsimd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_no_fpsimd </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00093">93</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb">kvm_inject_undefined</a>(vcpu);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_aba3cb2b15ab0fafd0ac45b621d3bb6b3_cgraph.png" border="0" usemap="#ahandle__exit_8c_aba3cb2b15ab0fafd0ac45b621d3bb6b3_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_aba3cb2b15ab0fafd0ac45b621d3bb6b3_cgraph" id="ahandle__exit_8c_aba3cb2b15ab0fafd0ac45b621d3bb6b3_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,147,57"/>
<area shape="rect" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb" title=" " alt="" coords="195,31,360,57"/>
<area shape="rect" href="inject__fault_8c.html#ae6fc8db83ad0518fddd2e485687e0f7d" title=" " alt="" coords="408,5,527,32"/>
<area shape="rect" href="inject__fault_8c.html#a846082def00d9a7db3f28b1b7fb2a07a" title=" " alt="" coords="408,56,527,83"/>
<area shape="rect" href="inject__fault_8c.html#a326fe690ce371beb7496d3ed3cbe1a6e" title=" " alt="" coords="592,5,720,32"/>
<area shape="rect" href="inject__fault_8c.html#a887586bbc6bac834ae37cbf84711288c" title=" " alt="" coords="575,56,737,83"/>
<area shape="rect" href="sys__regs_8c.html#adf66277e472bdae2cc839d450085bc4b" title=" " alt="" coords="581,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a8f5bcf4d21c4d9b1881dd3fec5bd6178" title=" " alt="" coords="785,107,967,133"/>
</map>
</div>

</div>
</div>
<a id="ad2545fb9f7329ef0604715b9af4a1746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2545fb9f7329ef0604715b9af4a1746">&#9670;&nbsp;</a></span>handle_smc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_smc </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00056">56</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">     * &quot;If an SMC instruction executed at Non-secure EL1 is</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">     * trapped to EL2 because HCR_EL2.TSC is 1, the exception is a</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">     * Trap exception, not a Secure Monitor Call exception [...]&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">     * We need to advance the PC after the trap, as it would</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">     * otherwise return to the same address. Furthermore, pre-incrementing</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">     * the PC before potentially exiting to userspace maintains the same</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">     * abstraction for both SMCs and HVCs.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    kvm_incr_pc(vcpu);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">     * SMCs with a nonzero immediate are reserved according to DEN0028E 2.9</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">     * &quot;SMC and HVC immediate value&quot;.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> (kvm_vcpu_hvc_get_imm(vcpu)) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        vcpu_set_reg(vcpu, 0, ~0UL);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">     * If imm is zero then it is likely an SMCCC call.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">     * Note that on ARMv8.3, even if EL3 is not implemented, SMC executed</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">     * at Non-secure EL1 is trapped to EL2 if HCR_EL2.TSC==1, rather than</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">     * being treated as UNDEFINED.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4">kvm_smccc_call_handler</a>(vcpu);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_ad2545fb9f7329ef0604715b9af4a1746_cgraph.png" border="0" usemap="#ahandle__exit_8c_ad2545fb9f7329ef0604715b9af4a1746_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_ad2545fb9f7329ef0604715b9af4a1746_cgraph" id="ahandle__exit_8c_ad2545fb9f7329ef0604715b9af4a1746_cgraph">
<area shape="rect" title=" " alt="" coords="5,1009,105,1036"/>
<area shape="rect" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4" title=" " alt="" coords="153,1009,339,1036"/>
<area shape="rect" href="pvtime_8c.html#a0a13c651b49c43a6139569798311764c" title=" " alt="" coords="645,1136,848,1163"/>
<area shape="rect" href="arm__hypercalls_8h.html#aab3de177147e0efb70c732a1ad3706dd" title=" " alt="" coords="1453,1111,1580,1137"/>
<area shape="rect" href="pvtime_8c.html#a816827bb2ed919f4679817bc707665f8" title=" " alt="" coords="409,883,571,909"/>
<area shape="rect" href="hypercalls_8c.html#aeee8a70cfdf2a25b0f80f785fdf449c6" title=" " alt="" coords="387,933,593,960"/>
<area shape="rect" href="psci_8c.html#a3daa8000eb9717dde07d817c306b052b" title=" " alt="" coords="433,488,547,515"/>
<area shape="rect" href="arm__hypercalls_8h.html#a8baef8e49dbce7b140c519845a20611f" title=" " alt="" coords="1187,705,1337,732"/>
<area shape="rect" href="arm__hypercalls_8h.html#ae543f09c1c7681cec4e5d2dfa0e728a1" title=" " alt="" coords="1195,933,1329,960"/>
<area shape="rect" href="hypercalls_8c.html#a74c79c1b9740674575ae30970f11fcfa" title=" " alt="" coords="418,1288,562,1315"/>
<area shape="rect" href="hypercalls_8c.html#a33c0affb2c4abb0f0012206bb7e3d378" title=" " alt="" coords="403,1364,577,1391"/>
<area shape="rect" href="trng_8c.html#a77478bf42ec810a0e55387bf3a7997c2" title=" " alt="" coords="689,1035,804,1061"/>
<area shape="rect" href="psci_8c.html#af18cf22560595f1da5e34ea244b0b51b" title=" " alt="" coords="933,309,1077,336"/>
<area shape="rect" href="arm__psci_8h.html#ae8e32b0627b1dc8c12a32d279c1a3bf4" title=" " alt="" coords="1447,56,1586,83"/>
<area shape="rect" href="psci_8c.html#ac7522f6e0d1805f44a3e932397de4582" title=" " alt="" coords="933,360,1077,387"/>
<area shape="rect" href="psci_8c.html#a8f59d47a1b54f561b8c42f509798142e" title=" " alt="" coords="675,528,819,555"/>
<area shape="rect" href="psci_8c.html#a3b9f15ff62c952f20de3ed44aaf4edbc" title=" " alt="" coords="912,411,1099,453"/>
<area shape="rect" href="arm_8c.html#a8a5659b8fc302d5b435957306e3541b4" title=" " alt="" coords="1165,208,1359,235"/>
<area shape="rect" href="psci_8c.html#a092eeee0e7b54c50ebc3d0cf66ea8ef5" title=" " alt="" coords="1189,259,1335,285"/>
<area shape="rect" href="arm_8c.html#afc3949baef2cd8a5749b2d0095959de1" title=" " alt="" coords="1413,5,1620,32"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="1712,44,1835,71"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="1928,44,2136,71"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="1955,171,2109,197"/>
<area shape="rect" href="arm_8c.html#a371c5c68ee659e4815a4af50d0161c8a" title=" " alt="" coords="1426,360,1607,387"/>
<area shape="rect" href="arm_8c.html#a0be215e1642483c65818bd994b13a421" title=" " alt="" coords="1439,107,1594,133"/>
<area shape="rect" href="psci_8c.html#ac9f7ca89512ea60ace6ea961a60354a4" title=" " alt="" coords="1429,259,1605,285"/>
<area shape="rect" href="arm__hypercalls_8h.html#a0d87528a8f6002c42509bd1280a00eaa" title=" " alt="" coords="1453,309,1580,336"/>
<area shape="rect" href="arm__hypercalls_8h.html#a365000fe74829ee0bdc59b28c8b8802f" title=" " alt="" coords="1453,157,1580,184"/>
<area shape="rect" href="psci_8c.html#a6fe2f9e365c9a9948351f718015ce651" title=" " alt="" coords="1184,513,1340,554"/>
<area shape="rect" href="psci_8c.html#a9119f27fea8a008787ddbc93e8b1bded" title=" " alt="" coords="1181,411,1343,437"/>
<area shape="rect" href="psci_8c.html#ad8f7f33f1397e347a67599f67ac2f39c" title=" " alt="" coords="1173,461,1351,488"/>
<area shape="rect" href="psci_8c.html#afd3d020adc6118dbd290a2770d897439" title=" " alt="" coords="1159,309,1365,336"/>
<area shape="rect" href="psci_8c.html#abe7d85200e79143f87dab785a204fb3a" title=" " alt="" coords="1171,360,1353,387"/>
<area shape="rect" href="psci_8c.html#a44cba757038eb3abdf93db5dc6c7ae3e" title=" " alt="" coords="1435,534,1598,575"/>
<area shape="rect" href="kvm__main_8c.html#abaa3f5ff00150487b52dd21c1617bab6" title=" " alt="" coords="1668,563,1879,589"/>
<area shape="rect" href="kvm__main_8c.html#ac46e1a0e43c0784194a451a7e7394c02" title=" " alt="" coords="1927,555,2137,597"/>
<area shape="rect" href="psci_8c.html#aa30b461609a71770efab6a5045274e5e" title=" " alt="" coords="1445,411,1589,437"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="1459,461,1574,488"/>
<area shape="rect" href="kvm__main_8c.html#a7256a8615584a9ae83a46c071f6aa0e9" title=" " alt="" coords="1713,360,1834,387"/>
<area shape="rect" href="vgic_8c.html#a751661541b39c02532a54736db22a929" title=" " alt="" coords="1692,411,1855,437"/>
<area shape="rect" href="vgic-v4_8c.html#ac2966fbf90610bb8a0525cbd903f7477" title=" " alt="" coords="1720,461,1827,488"/>
<area shape="rect" href="vgic-v4_8c.html#aeafcb3e6b67ea32ed8e59d009252e565" title=" " alt="" coords="1723,512,1823,539"/>
<area shape="rect" href="kvm__main_8c.html#a1045a615093ccd8e87dcd6f6a0e03e9e" title=" " alt="" coords="1963,360,2101,387"/>
<area shape="rect" href="psci_8c.html#a340319ef6e70b6396954990199f5dfd2" title=" " alt="" coords="912,528,1099,555"/>
<area shape="rect" href="psci_8c.html#a203f6ca47f969e84b5ce50a61f08e9ae" title=" " alt="" coords="905,579,1105,605"/>
<area shape="rect" href="hypercalls_8c.html#ac9f33ca9d642c7231be25e02e9da450a" title=" " alt="" coords="641,1389,852,1416"/>
<area shape="rect" href="hypercalls_8c.html#af93c35a0fd5825a99b62189ae5024a45" title=" " alt="" coords="665,1441,829,1482"/>
<area shape="rect" href="hypercalls_8c.html#aa8aa7ec82883c6c825b0373750c779a2" title=" " alt="" coords="648,1339,845,1365"/>
<area shape="rect" href="hypercalls_8c.html#a85e917257bf25c8f6d66f031cd79cbca" title=" " alt="" coords="900,1448,1111,1475"/>
<area shape="rect" href="trng_8c.html#a3d1ac492ec1515ed0864e4e9b44e4221" title=" " alt="" coords="938,1085,1073,1112"/>
</map>
</div>

</div>
</div>
<a id="aeaf983f5c40202edc8b07a76603330cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaf983f5c40202edc8b07a76603330cd">&#9670;&nbsp;</a></span>handle_svc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_svc </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00244">244</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">     * So far, SVC traps only for NV via HFGITR_EL2. A SVC from a</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">     * 32bit guest would be caught by vpcu_mode_is_bad_32bit(), so</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">     * we should only have to deal with a 64 bit exception.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d">kvm_inject_nested_sync</a>(vcpu, kvm_vcpu_get_esr(vcpu));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_aeaf983f5c40202edc8b07a76603330cd_cgraph.png" border="0" usemap="#ahandle__exit_8c_aeaf983f5c40202edc8b07a76603330cd_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_aeaf983f5c40202edc8b07a76603330cd_cgraph" id="ahandle__exit_8c_aeaf983f5c40202edc8b07a76603330cd_cgraph">
<area shape="rect" title=" " alt="" coords="5,957,100,984"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="148,957,331,984"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="379,957,524,984"/>
<area shape="rect" href="exception_8c.html#a69b40cbdae816f5cb612962c0f5da592" title=" " alt="" coords="601,95,735,121"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="589,704,747,731"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="592,1211,744,1237"/>
<area shape="rect" href="emulate-nested_8c.html#a5c0ef76a2f1feaeb264f0d4957c8f527" title=" " alt="" coords="572,1349,764,1376"/>
<area shape="rect" href="exception_8c.html#a5951865f1186392f5e4f0bc260c3b840" title=" " alt="" coords="836,95,1001,121"/>
<area shape="rect" href="adjust__pc_8h.html#a3a6ebd94aaf8bbd3c8461a2ca19a0d0d" title=" " alt="" coords="858,19,979,45"/>
<area shape="rect" href="exception_8c.html#a915e81f46f11cc1767049dbbf071923f" title=" " alt="" coords="1105,56,1248,83"/>
<area shape="rect" href="exception_8c.html#a0bd428ba7b098cc3417dca2f3f3bc9bf" title=" " alt="" coords="1105,107,1248,133"/>
<area shape="rect" href="aarch32_8c.html#a1b8e30a6e24795d6b69e6ff5f0e50563" title=" " alt="" coords="1108,5,1245,32"/>
<area shape="rect" href="nvhe_2tlb_8c.html#ae52fe3c4f97b5b56e65233015785a6ec" title=" " alt="" coords="824,441,1013,468"/>
<area shape="rect" href="debug_8c.html#aae61f6ee77424b3eb0cb727586a694eb" title=" " alt="" coords="839,726,998,767"/>
<area shape="rect" href="fpsimd_8c.html#a6d3b97095b4e6a0d7799fe50eb3fb762" title=" " alt="" coords="829,792,1008,819"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="835,675,1002,701"/>
<area shape="rect" href="vhe_2switch_8c.html#ae2827f745640cc27776384fbe890f8e4" title=" " alt="" coords="841,231,996,257"/>
<area shape="rect" href="pmu_8c.html#a928d4df1b401e9b41f92dd2aa2744529" title=" " alt="" coords="829,967,1008,1009"/>
<area shape="rect" href="vgic_8c.html#a54d5d884ac662357df5661d80f5160e3" title=" " alt="" coords="859,340,979,367"/>
<area shape="rect" href="nvhe_2tlb_8c.html#ac4dc226b1ecb9bca38c3096eb27c4c1d" title=" " alt="" coords="1094,441,1259,468"/>
<area shape="rect" href="nvhe_2tlb_8c.html#afffa64d5f9de2ef7a026837a2b9a0629" title=" " alt="" coords="1098,391,1255,417"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="1336,1181,1457,1208"/>
<area shape="rect" href="arch__timer_8c.html#aabed21346a0fc6b04d9fc11ee754d19a" title=" " alt="" coords="1091,827,1262,853"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1081,492,1273,519"/>
<area shape="rect" href="arch__timer_8c.html#a9f34b892b5c9b1e79065006b4353c76e" title=" " alt="" coords="1093,543,1260,585"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1093,609,1260,650"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1117,675,1236,701"/>
<area shape="rect" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301" title=" " alt="" coords="1101,725,1252,752"/>
<area shape="rect" href="arch__timer_8c.html#af19caca81734fff66363042c1e8e2181" title=" " alt="" coords="1115,776,1239,803"/>
<area shape="rect" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710" title=" " alt="" coords="1328,979,1465,1005"/>
<area shape="rect" href="vhe_2switch_8c.html#a4195df34813c51f5d20656ca62d92086" title=" " alt="" coords="1095,223,1258,265"/>
<area shape="rect" href="vhe_2sysreg-sr_8c.html#ab64a6924327aef108d280fb973db4fea" title=" " alt="" coords="1101,158,1252,199"/>
<area shape="rect" href="arm__pmu_8h.html#a7a4fb2cf1fb48c203893224b94564f63" title=" " alt="" coords="1077,1029,1276,1056"/>
<area shape="rect" href="pmu_8c.html#abf97c7a6b0768cbe660dea1a404bc79b" title=" " alt="" coords="1093,1080,1260,1107"/>
<area shape="rect" href="pmu_8c.html#ad4ce451e7a40f149ed26e7ce8d9700d4" title=" " alt="" coords="1073,928,1280,955"/>
<area shape="rect" href="pmu_8c.html#a98e21a6fa41b3490e6b1356884b18d5f" title=" " alt="" coords="1075,979,1278,1005"/>
<area shape="rect" href="vgic-v2_8c.html#a8321cd156f283292cc531c7ca6358193" title=" " alt="" coords="1123,340,1230,367"/>
<area shape="rect" href="vgic-v3_8c.html#aec2311d8e88bcd485c7baf083b65876e" title=" " alt="" coords="1123,289,1230,316"/>
<area shape="rect" href="debug_8c.html#a40ab178c06775c17444821f2b88d89c9" title=" " alt="" coords="819,1233,1018,1274"/>
<area shape="rect" href="fpsimd_8c.html#a315297a309db16c8cbbe1ab46c7413ba" title=" " alt="" coords="833,1299,1005,1325"/>
<area shape="rect" href="vmid_8c.html#a2de0128c579224dac8d0964d383122cf" title=" " alt="" coords="837,1350,1000,1391"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="839,1131,998,1157"/>
<area shape="rect" href="pmu_8c.html#a4e027f0c751f9cc01fa6d3c3f082216b" title=" " alt="" coords="812,1033,1025,1060"/>
<area shape="rect" href="vhe_2switch_8c.html#acecfb29f871562a6288b28ba84a8150e" title=" " alt="" coords="845,1416,993,1443"/>
<area shape="rect" href="vgic_8c.html#a96f93a2405989082e3693577b6b2eb5d" title=" " alt="" coords="862,1181,975,1208"/>
<area shape="rect" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041" title=" " alt="" coords="1099,1181,1254,1208"/>
<area shape="rect" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af" title=" " alt="" coords="1109,1283,1244,1309"/>
<area shape="rect" href="vhe_2switch_8c.html#ac68d88b7ec01728bde4737ec693bfe56" title=" " alt="" coords="1091,1438,1262,1479"/>
<area shape="rect" href="vhe_2sysreg-sr_8c.html#af72c2efce509dabaacec4aa926055c81" title=" " alt="" coords="1076,1387,1277,1413"/>
<area shape="rect" href="sys__regs_8c.html#adf66277e472bdae2cc839d450085bc4b" title=" " alt="" coords="843,1467,994,1493"/>
</map>
</div>

</div>
</div>
<a id="a3e3ab5fffb73f5ca9700a79f510dcf8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e3ab5fffb73f5ca9700a79f510dcf8f">&#9670;&nbsp;</a></span>handle_sve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_sve </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00203">203</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb">kvm_inject_undefined</a>(vcpu);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_a3e3ab5fffb73f5ca9700a79f510dcf8f_cgraph.png" border="0" usemap="#ahandle__exit_8c_a3e3ab5fffb73f5ca9700a79f510dcf8f_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_a3e3ab5fffb73f5ca9700a79f510dcf8f_cgraph" id="ahandle__exit_8c_a3e3ab5fffb73f5ca9700a79f510dcf8f_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,101,57"/>
<area shape="rect" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb" title=" " alt="" coords="149,31,315,57"/>
<area shape="rect" href="inject__fault_8c.html#ae6fc8db83ad0518fddd2e485687e0f7d" title=" " alt="" coords="363,5,481,32"/>
<area shape="rect" href="inject__fault_8c.html#a846082def00d9a7db3f28b1b7fb2a07a" title=" " alt="" coords="363,56,481,83"/>
<area shape="rect" href="inject__fault_8c.html#a326fe690ce371beb7496d3ed3cbe1a6e" title=" " alt="" coords="547,5,675,32"/>
<area shape="rect" href="inject__fault_8c.html#a887586bbc6bac834ae37cbf84711288c" title=" " alt="" coords="529,56,692,83"/>
<area shape="rect" href="sys__regs_8c.html#adf66277e472bdae2cc839d450085bc4b" title=" " alt="" coords="535,107,686,133"/>
<area shape="rect" href="sys__regs_8c.html#a8f5bcf4d21c4d9b1881dd3fec5bd6178" title=" " alt="" coords="740,107,921,133"/>
</map>
</div>

</div>
</div>
<a id="af5e4b30e6e0a029e045b0799b6ff8c09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5e4b30e6e0a029e045b0799b6ff8c09">&#9670;&nbsp;</a></span>handle_trap_exceptions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_trap_exceptions </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00297">297</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">int</span> handled;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">     * See ARM ARM B1.14.1: &quot;Hyp traps on instructions</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">     * that fail their condition code check&quot;</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (!kvm_condition_valid(vcpu)) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        kvm_incr_pc(vcpu);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        handled = 1;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <a class="code" href="handle__exit_8c.html#a339387f2d97c45b60a2741cb3d6ffc23">exit_handle_fn</a> exit_handler;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        exit_handler = <a class="code" href="handle__exit_8c.html#a610aaf7e46afbe6c5972ecf6136ed3f4">kvm_get_exit_handler</a>(vcpu);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        handled = exit_handler(vcpu);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">return</span> handled;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div>
<div class="ttc" id="ahandle__exit_8c_html_a339387f2d97c45b60a2741cb3d6ffc23"><div class="ttname"><a href="handle__exit_8c.html#a339387f2d97c45b60a2741cb3d6ffc23">exit_handle_fn</a></div><div class="ttdeci">int(* exit_handle_fn)(struct kvm_vcpu *)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00029">handle_exit.c:29</a></div></div>
<div class="ttc" id="ahandle__exit_8c_html_a610aaf7e46afbe6c5972ecf6136ed3f4"><div class="ttname"><a href="handle__exit_8c.html#a610aaf7e46afbe6c5972ecf6136ed3f4">kvm_get_exit_handler</a></div><div class="ttdeci">static exit_handle_fn kvm_get_exit_handler(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00283">handle_exit.c:283</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_af5e4b30e6e0a029e045b0799b6ff8c09_cgraph.png" border="0" usemap="#ahandle__exit_8c_af5e4b30e6e0a029e045b0799b6ff8c09_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_af5e4b30e6e0a029e045b0799b6ff8c09_cgraph" id="ahandle__exit_8c_af5e4b30e6e0a029e045b0799b6ff8c09_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,183,32"/>
<area shape="rect" href="handle__exit_8c.html#a610aaf7e46afbe6c5972ecf6136ed3f4" title=" " alt="" coords="231,5,397,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_af5e4b30e6e0a029e045b0799b6ff8c09_icgraph.png" border="0" usemap="#ahandle__exit_8c_af5e4b30e6e0a029e045b0799b6ff8c09_icgraph" alt=""/></div>
<map name="ahandle__exit_8c_af5e4b30e6e0a029e045b0799b6ff8c09_icgraph" id="ahandle__exit_8c_af5e4b30e6e0a029e045b0799b6ff8c09_icgraph">
<area shape="rect" title=" " alt="" coords="559,5,736,32"/>
<area shape="rect" href="handle__exit_8c.html#aff5e40f09d30605ee752ff88fcd86dec" title=" " alt="" coords="412,5,511,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a610aaf7e46afbe6c5972ecf6136ed3f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a610aaf7e46afbe6c5972ecf6136ed3f4">&#9670;&nbsp;</a></span>kvm_get_exit_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="handle__exit_8c.html#a339387f2d97c45b60a2741cb3d6ffc23">exit_handle_fn</a> kvm_get_exit_handler </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00283">283</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    u64 esr = kvm_vcpu_get_esr(vcpu);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    u8 esr_ec = ESR_ELx_EC(esr);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="handle__exit_8c.html#acb2ef35f12aad0be19cdf8d484746961">arm_exit_handlers</a>[esr_ec];</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
<div class="ttc" id="ahandle__exit_8c_html_acb2ef35f12aad0be19cdf8d484746961"><div class="ttname"><a href="handle__exit_8c.html#acb2ef35f12aad0be19cdf8d484746961">arm_exit_handlers</a></div><div class="ttdeci">static exit_handle_fn arm_exit_handlers[]</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00255">handle_exit.c:255</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_a610aaf7e46afbe6c5972ecf6136ed3f4_icgraph.png" border="0" usemap="#ahandle__exit_8c_a610aaf7e46afbe6c5972ecf6136ed3f4_icgraph" alt=""/></div>
<map name="ahandle__exit_8c_a610aaf7e46afbe6c5972ecf6136ed3f4_icgraph" id="ahandle__exit_8c_a610aaf7e46afbe6c5972ecf6136ed3f4_icgraph">
<area shape="rect" title=" " alt="" coords="784,5,951,32"/>
<area shape="rect" href="handle__exit_8c.html#af5e4b30e6e0a029e045b0799b6ff8c09" title=" " alt="" coords="559,5,736,32"/>
<area shape="rect" href="handle__exit_8c.html#aff5e40f09d30605ee752ff88fcd86dec" title=" " alt="" coords="412,5,511,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ae96aab7918301d55b908034db5855e3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae96aab7918301d55b908034db5855e3d">&#9670;&nbsp;</a></span>kvm_handle_eret()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int kvm_handle_eret </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00220">220</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;{</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (kvm_vcpu_get_esr(vcpu) &amp; ESR_ELx_ERET_ISS_ERET)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="handle__exit_8c.html#a0a50407175f0512dcb278e198ce16254">kvm_handle_ptrauth</a>(vcpu);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">     * If we got here, two possibilities:</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">     * - the guest is in EL2, and we need to fully emulate ERET</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">     * - the guest is in EL1, and we need to reinject the</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">         *   exception into the L1 hypervisor.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">     * If KVM ever traps ERET for its own use, we&#39;ll have to</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">     * revisit this.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (is_hyp_ctxt(vcpu))</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4">kvm_emulate_nested_eret</a>(vcpu);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d">kvm_inject_nested_sync</a>(vcpu, kvm_vcpu_get_esr(vcpu));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="ttc" id="aemulate-nested_8c_html_a1920c02a997dd9975bec0ee02f6ae2c4"><div class="ttname"><a href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4">kvm_emulate_nested_eret</a></div><div class="ttdeci">void kvm_emulate_nested_eret(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="emulate-nested_8c_source.html#l02032">emulate-nested.c:2032</a></div></div>
<div class="ttc" id="ahandle__exit_8c_html_a0a50407175f0512dcb278e198ce16254"><div class="ttname"><a href="handle__exit_8c.html#a0a50407175f0512dcb278e198ce16254">kvm_handle_ptrauth</a></div><div class="ttdeci">static int kvm_handle_ptrauth(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00214">handle_exit.c:214</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_ae96aab7918301d55b908034db5855e3d_cgraph.png" border="0" usemap="#ahandle__exit_8c_ae96aab7918301d55b908034db5855e3d_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_ae96aab7918301d55b908034db5855e3d_cgraph" id="ahandle__exit_8c_ae96aab7918301d55b908034db5855e3d_cgraph">
<area shape="rect" title=" " alt="" coords="5,931,140,958"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="419,931,615,958"/>
<area shape="rect" href="handle__exit_8c.html#a0a50407175f0512dcb278e198ce16254" title=" " alt="" coords="201,1011,357,1038"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="188,714,371,741"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="691,525,849,551"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="694,902,846,929"/>
<area shape="rect" href="emulate-nested_8c.html#af25f30062c2caed4964ca9e442162772" title=" " alt="" coords="663,953,877,995"/>
<area shape="rect" href="sys__regs_8c.html#a79848758fc91bd6081326514833ffafa" title=" " alt="" coords="697,1019,843,1046"/>
<area shape="rect" href="nvhe_2tlb_8c.html#ae52fe3c4f97b5b56e65233015785a6ec" title=" " alt="" coords="937,289,1127,315"/>
<area shape="rect" href="debug_8c.html#aae61f6ee77424b3eb0cb727586a694eb" title=" " alt="" coords="953,433,1111,475"/>
<area shape="rect" href="fpsimd_8c.html#a6d3b97095b4e6a0d7799fe50eb3fb762" title=" " alt="" coords="943,499,1121,526"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="949,550,1115,577"/>
<area shape="rect" href="vhe_2switch_8c.html#ae2827f745640cc27776384fbe890f8e4" title=" " alt="" coords="955,78,1109,105"/>
<area shape="rect" href="pmu_8c.html#a928d4df1b401e9b41f92dd2aa2744529" title=" " alt="" coords="943,735,1121,776"/>
<area shape="rect" href="vgic_8c.html#a54d5d884ac662357df5661d80f5160e3" title=" " alt="" coords="972,187,1092,214"/>
<area shape="rect" href="nvhe_2tlb_8c.html#ac4dc226b1ecb9bca38c3096eb27c4c1d" title=" " alt="" coords="1207,238,1373,265"/>
<area shape="rect" href="nvhe_2tlb_8c.html#afffa64d5f9de2ef7a026837a2b9a0629" title=" " alt="" coords="1211,289,1369,315"/>
<area shape="rect" href="arch__timer_8c.html#ad7e756ea5077e85e2a10bfe35543ce21" title=" " alt="" coords="1449,1074,1571,1101"/>
<area shape="rect" href="arch__timer_8c.html#aabed21346a0fc6b04d9fc11ee754d19a" title=" " alt="" coords="1205,491,1375,518"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1194,441,1386,467"/>
<area shape="rect" href="arch__timer_8c.html#a9f34b892b5c9b1e79065006b4353c76e" title=" " alt="" coords="1207,543,1373,584"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1207,608,1373,649"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1231,674,1349,701"/>
<area shape="rect" href="arch__timer_8c.html#a7e1e1c3a85e2d375519e32f57a54e301" title=" " alt="" coords="1215,339,1365,366"/>
<area shape="rect" href="arch__timer_8c.html#af19caca81734fff66363042c1e8e2181" title=" " alt="" coords="1228,390,1352,417"/>
<area shape="rect" href="arch__timer_8c.html#ad19b9cbace853dd534bf572a35f83710" title=" " alt="" coords="1441,1007,1579,1034"/>
<area shape="rect" href="vhe_2switch_8c.html#a4195df34813c51f5d20656ca62d92086" title=" " alt="" coords="1209,5,1371,47"/>
<area shape="rect" href="vhe_2sysreg-sr_8c.html#ab64a6924327aef108d280fb973db4fea" title=" " alt="" coords="1215,71,1365,112"/>
<area shape="rect" href="arm__pmu_8h.html#a7a4fb2cf1fb48c203893224b94564f63" title=" " alt="" coords="1191,877,1389,903"/>
<area shape="rect" href="pmu_8c.html#abf97c7a6b0768cbe660dea1a404bc79b" title=" " alt="" coords="1207,927,1373,954"/>
<area shape="rect" href="pmu_8c.html#ad4ce451e7a40f149ed26e7ce8d9700d4" title=" " alt="" coords="1187,775,1393,802"/>
<area shape="rect" href="pmu_8c.html#a98e21a6fa41b3490e6b1356884b18d5f" title=" " alt="" coords="1189,826,1391,853"/>
<area shape="rect" href="vgic-v2_8c.html#a8321cd156f283292cc531c7ca6358193" title=" " alt="" coords="1237,137,1343,163"/>
<area shape="rect" href="vgic-v3_8c.html#aec2311d8e88bcd485c7baf083b65876e" title=" " alt="" coords="1237,187,1343,214"/>
<area shape="rect" href="debug_8c.html#a40ab178c06775c17444821f2b88d89c9" title=" " alt="" coords="933,953,1131,995"/>
<area shape="rect" href="fpsimd_8c.html#a315297a309db16c8cbbe1ab46c7413ba" title=" " alt="" coords="946,1019,1118,1046"/>
<area shape="rect" href="vmid_8c.html#a2de0128c579224dac8d0964d383122cf" title=" " alt="" coords="951,1071,1113,1112"/>
<area shape="rect" href="arch__timer_8c.html#a0006e1b52ff819dd99be6dca260e52d6" title=" " alt="" coords="953,1137,1111,1163"/>
<area shape="rect" href="pmu_8c.html#a4e027f0c751f9cc01fa6d3c3f082216b" title=" " alt="" coords="925,801,1139,827"/>
<area shape="rect" href="vhe_2switch_8c.html#acecfb29f871562a6288b28ba84a8150e" title=" " alt="" coords="958,851,1106,878"/>
<area shape="rect" href="vgic_8c.html#a96f93a2405989082e3693577b6b2eb5d" title=" " alt="" coords="975,902,1089,929"/>
<area shape="rect" href="arch__timer_8c.html#a0abce4d3df0f10be896c5ff0cb489041" title=" " alt="" coords="1213,1074,1367,1101"/>
<area shape="rect" href="arch__timer_8c.html#a08b7dad9cb511eeaec5ab08e2a2ae1af" title=" " alt="" coords="1223,1125,1357,1151"/>
<area shape="rect" href="sys__regs_8c.html#a8f5bcf4d21c4d9b1881dd3fec5bd6178" title=" " alt="" coords="941,1187,1123,1214"/>
<area shape="rect" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb" title=" " alt="" coords="434,1070,599,1097"/>
<area shape="rect" href="inject__fault_8c.html#ae6fc8db83ad0518fddd2e485687e0f7d" title=" " alt="" coords="711,1070,829,1097"/>
<area shape="rect" href="inject__fault_8c.html#a846082def00d9a7db3f28b1b7fb2a07a" title=" " alt="" coords="711,1121,829,1147"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="444,525,589,551"/>
<area shape="rect" href="exception_8c.html#a69b40cbdae816f5cb612962c0f5da592" title=" " alt="" coords="703,423,837,450"/>
<area shape="rect" href="emulate-nested_8c.html#a5c0ef76a2f1feaeb264f0d4957c8f527" title=" " alt="" coords="674,474,866,501"/>
</map>
</div>

</div>
</div>
<a id="afcce6bad48b6a9769e594aeba3f73717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcce6bad48b6a9769e594aeba3f73717">&#9670;&nbsp;</a></span>kvm_handle_guest_debug()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int kvm_handle_guest_debug </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>kvm_handle_guest_debug - handle a debug exception instruction</p>
<p>@vcpu: the vcpu pointer</p>
<p>We route all debug exceptions through the same handler. If both the guest and host are using the same debug facilities it will be up to userspace to re-inject the correct exception for guest delivery.</p>
<dl class="section return"><dt>Returns</dt><dd>: 0 (while setting vcpu-&gt;run-&gt;exit_reason) </dd></dl>

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00166">166</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;{</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keyword">struct </span>kvm_run *run = vcpu-&gt;run;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    u64 esr = kvm_vcpu_get_esr(vcpu);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    run-&gt;exit_reason = KVM_EXIT_DEBUG;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    run-&gt;debug.arch.hsr = lower_32_bits(esr);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    run-&gt;debug.arch.hsr_high = upper_32_bits(esr);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    run-&gt;flags = KVM_DEBUG_ARCH_HSR_HIGH_VALID;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">switch</span> (ESR_ELx_EC(esr)) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">case</span> ESR_ELx_EC_WATCHPT_LOW:</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        run-&gt;debug.arch.far = vcpu-&gt;arch.fault.far_el2;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">case</span> ESR_ELx_EC_SOFTSTP_LOW:</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        vcpu_clear_flag(vcpu, DBG_SS_ACTIVE_PENDING);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abb699db7254ba704ba98fbe5ffcff950"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb699db7254ba704ba98fbe5ffcff950">&#9670;&nbsp;</a></span>kvm_handle_guest_serror()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kvm_handle_guest_serror </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>esr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00031">31</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (!arm64_is_ras_serror(esr) || arm64_is_fatal_ras_serror(NULL, esr))</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <a class="code" href="inject__fault_8c.html#a22de1c7e33612b2212ecdf333a228340">kvm_inject_vabt</a>(vcpu);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_abb699db7254ba704ba98fbe5ffcff950_cgraph.png" border="0" usemap="#ahandle__exit_8c_abb699db7254ba704ba98fbe5ffcff950_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_abb699db7254ba704ba98fbe5ffcff950_cgraph" id="ahandle__exit_8c_abb699db7254ba704ba98fbe5ffcff950_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,196,32"/>
<area shape="rect" href="inject__fault_8c.html#a22de1c7e33612b2212ecdf333a228340" title=" " alt="" coords="244,5,375,32"/>
<area shape="rect" href="inject__fault_8c.html#add5913f66290fa09779d83f20800e7f1" title=" " alt="" coords="423,5,553,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_abb699db7254ba704ba98fbe5ffcff950_icgraph.png" border="0" usemap="#ahandle__exit_8c_abb699db7254ba704ba98fbe5ffcff950_icgraph" alt=""/></div>
<map name="ahandle__exit_8c_abb699db7254ba704ba98fbe5ffcff950_icgraph" id="ahandle__exit_8c_abb699db7254ba704ba98fbe5ffcff950_icgraph">
<area shape="rect" title=" " alt="" coords="599,5,789,32"/>
<area shape="rect" href="handle__exit_8c.html#af079d930452619eae7b05217368cd2a3" title=" " alt="" coords="412,5,551,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a0a50407175f0512dcb278e198ce16254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a50407175f0512dcb278e198ce16254">&#9670;&nbsp;</a></span>kvm_handle_ptrauth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int kvm_handle_ptrauth </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00214">214</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb">kvm_inject_undefined</a>(vcpu);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_a0a50407175f0512dcb278e198ce16254_cgraph.png" border="0" usemap="#ahandle__exit_8c_a0a50407175f0512dcb278e198ce16254_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_a0a50407175f0512dcb278e198ce16254_cgraph" id="ahandle__exit_8c_a0a50407175f0512dcb278e198ce16254_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,161,57"/>
<area shape="rect" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb" title=" " alt="" coords="209,31,375,57"/>
<area shape="rect" href="inject__fault_8c.html#ae6fc8db83ad0518fddd2e485687e0f7d" title=" " alt="" coords="423,5,541,32"/>
<area shape="rect" href="inject__fault_8c.html#a846082def00d9a7db3f28b1b7fb2a07a" title=" " alt="" coords="423,56,541,83"/>
<area shape="rect" href="inject__fault_8c.html#a326fe690ce371beb7496d3ed3cbe1a6e" title=" " alt="" coords="607,5,735,32"/>
<area shape="rect" href="inject__fault_8c.html#a887586bbc6bac834ae37cbf84711288c" title=" " alt="" coords="589,56,752,83"/>
<area shape="rect" href="sys__regs_8c.html#adf66277e472bdae2cc839d450085bc4b" title=" " alt="" coords="595,107,746,133"/>
<area shape="rect" href="sys__regs_8c.html#a8f5bcf4d21c4d9b1881dd3fec5bd6178" title=" " alt="" coords="800,107,981,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_a0a50407175f0512dcb278e198ce16254_icgraph.png" border="0" usemap="#ahandle__exit_8c_a0a50407175f0512dcb278e198ce16254_icgraph" alt=""/></div>
<map name="ahandle__exit_8c_a0a50407175f0512dcb278e198ce16254_icgraph" id="ahandle__exit_8c_a0a50407175f0512dcb278e198ce16254_icgraph">
<area shape="rect" title=" " alt="" coords="188,5,344,32"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="5,5,140,32"/>
</map>
</div>

</div>
</div>
<a id="a313f5469836166a2b9b9e2164fd00cdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a313f5469836166a2b9b9e2164fd00cdb">&#9670;&nbsp;</a></span>kvm_handle_unknown_ec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int kvm_handle_unknown_ec </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00188">188</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;{</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    u64 esr = kvm_vcpu_get_esr(vcpu);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="sys__regs_8h.html#ac51d3b33e33ecf2bd1086119c1d55546">kvm_pr_unimpl</a>(<span class="stringliteral">&quot;Unknown exception class: esr: %#016llx -- %s\n&quot;</span>,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;              esr, esr_get_class_string(esr));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb">kvm_inject_undefined</a>(vcpu);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_a313f5469836166a2b9b9e2164fd00cdb_cgraph.png" border="0" usemap="#ahandle__exit_8c_a313f5469836166a2b9b9e2164fd00cdb_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_a313f5469836166a2b9b9e2164fd00cdb_cgraph" id="ahandle__exit_8c_a313f5469836166a2b9b9e2164fd00cdb_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,196,83"/>
<area shape="rect" href="inject__fault_8c.html#aece14f61701021b17e9cf5521f7946fb" title=" " alt="" coords="244,31,409,57"/>
<area shape="rect" href="sys__regs_8h.html#ac51d3b33e33ecf2bd1086119c1d55546" title=" " alt="" coords="265,81,388,108"/>
<area shape="rect" href="inject__fault_8c.html#ae6fc8db83ad0518fddd2e485687e0f7d" title=" " alt="" coords="457,5,576,32"/>
<area shape="rect" href="inject__fault_8c.html#a846082def00d9a7db3f28b1b7fb2a07a" title=" " alt="" coords="457,56,576,83"/>
<area shape="rect" href="inject__fault_8c.html#a326fe690ce371beb7496d3ed3cbe1a6e" title=" " alt="" coords="641,5,769,32"/>
<area shape="rect" href="inject__fault_8c.html#a887586bbc6bac834ae37cbf84711288c" title=" " alt="" coords="624,56,787,83"/>
<area shape="rect" href="sys__regs_8c.html#adf66277e472bdae2cc839d450085bc4b" title=" " alt="" coords="630,107,781,133"/>
<area shape="rect" href="sys__regs_8c.html#a8f5bcf4d21c4d9b1881dd3fec5bd6178" title=" " alt="" coords="835,107,1016,133"/>
</map>
</div>

</div>
</div>
<a id="a0b391fc62c2250ecc0bfcdbe1b0a6788"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b391fc62c2250ecc0bfcdbe1b0a6788">&#9670;&nbsp;</a></span>kvm_handle_wfx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int kvm_handle_wfx </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>kvm_handle_wfx - handle a wait-for-interrupts or wait-for-event instruction executed by a guest</p>
<p>@vcpu: the vcpu pointer</p>
<p>WFE[T]: Yield the CPU and come back to this vcpu when the scheduler decides to. WFI: Simply call <a class="el" href="kvm__main_8c.html#a7256a8615584a9ae83a46c071f6aa0e9">kvm_vcpu_halt()</a>, which will halt execution of world-switches and schedule other host processes until there is an incoming IRQ or FIQ to the VM. WFIT: Same as WFI, with a timed wakeup implemented as a background timer</p>
<p>WF{I,E}T can immediately return if the deadline has already expired. </p>

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00114">114</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    u64 esr = kvm_vcpu_get_esr(vcpu);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (esr &amp; ESR_ELx_WFx_ISS_WFE) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        trace_kvm_wfx_arm64(*vcpu_pc(vcpu), <span class="keyword">true</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        vcpu-&gt;stat.wfe_exit_stat++;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        trace_kvm_wfx_arm64(*vcpu_pc(vcpu), <span class="keyword">false</span>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        vcpu-&gt;stat.wfi_exit_stat++;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span> (esr &amp; ESR_ELx_WFx_ISS_WFxT) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (esr &amp; ESR_ELx_WFx_ISS_RV) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            u64 val, now;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            now = <a class="code" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc">kvm_arm_timer_get_reg</a>(vcpu, KVM_REG_ARM_TIMER_CNT);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            val = vcpu_get_reg(vcpu, kvm_vcpu_sys_get_rt(vcpu));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">if</span> (now &gt;= val)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="comment">/* Treat WFxT as WFx if RN is invalid */</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            esr &amp;= ~ESR_ELx_WFx_ISS_WFxT;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (esr &amp; ESR_ELx_WFx_ISS_WFE) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="kvm__main_8c.html#a7373edb7b1c787b14e657cd691e64d20">kvm_vcpu_on_spin</a>(vcpu, vcpu_mode_priv(vcpu));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">if</span> (esr &amp; ESR_ELx_WFx_ISS_WFxT)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            vcpu_set_flag(vcpu, IN_WFIT);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056">kvm_vcpu_wfi</a>(vcpu);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;out:</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    kvm_incr_pc(vcpu);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="ttc" id="aarch__timer_8c_html_aa832b704b06a4b6109f7f3a71f6755cc"><div class="ttname"><a href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc">kvm_arm_timer_get_reg</a></div><div class="ttdeci">u64 kvm_arm_timer_get_reg(struct kvm_vcpu *vcpu, u64 regid)</div><div class="ttdef"><b>Definition:</b> <a href="arch__timer_8c_source.html#l01107">arch_timer.c:1107</a></div></div>
<div class="ttc" id="aarm_8c_html_a68df8c6f1b7134e9f23857f092d50056"><div class="ttname"><a href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056">kvm_vcpu_wfi</a></div><div class="ttdeci">void kvm_vcpu_wfi(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="arm_8c_source.html#l00769">arm.c:769</a></div></div>
<div class="ttc" id="akvm__main_8c_html_a7373edb7b1c787b14e657cd691e64d20"><div class="ttname"><a href="kvm__main_8c.html#a7373edb7b1c787b14e657cd691e64d20">kvm_vcpu_on_spin</a></div><div class="ttdeci">void kvm_vcpu_on_spin(struct kvm_vcpu *me, bool yield_to_kernel_mode)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l04056">kvm_main.c:4056</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_a0b391fc62c2250ecc0bfcdbe1b0a6788_cgraph.png" border="0" usemap="#ahandle__exit_8c_a0b391fc62c2250ecc0bfcdbe1b0a6788_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_a0b391fc62c2250ecc0bfcdbe1b0a6788_cgraph" id="ahandle__exit_8c_a0b391fc62c2250ecc0bfcdbe1b0a6788_cgraph">
<area shape="rect" title=" " alt="" coords="5,196,139,223"/>
<area shape="rect" href="arch__timer_8c.html#aa832b704b06a4b6109f7f3a71f6755cc" title=" " alt="" coords="187,83,369,109"/>
<area shape="rect" href="kvm__main_8c.html#a7373edb7b1c787b14e657cd691e64d20" title=" " alt="" coords="205,196,351,223"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="221,407,335,433"/>
<area shape="rect" href="arch__timer_8c.html#a3873c5e4f0eb8a0fa2a466d8e2b9a894" title=" " alt="" coords="943,28,1105,55"/>
<area shape="rect" href="arch__timer_8c.html#ac9f7917175f1d6031a77dcbc82f9ee98" title=" " alt="" coords="1883,41,2049,68"/>
<area shape="rect" href="arch__timer_8c.html#a2fb3bc59ad8d869dc692674f2db4bfe9" title=" " alt="" coords="1209,79,1325,105"/>
<area shape="rect" href="arch__timer_8c.html#a7f5f777b74b5c9ec6e13d4f7576d7f43" title=" " alt="" coords="1901,143,2031,169"/>
<area shape="rect" href="arch__timer_8c.html#a848ba80b4ffee7a071e37abb241262cd" title=" " alt="" coords="1690,36,1809,63"/>
<area shape="rect" href="arch__timer_8c.html#aeed64583773b01dafc949df326d17db3" title=" " alt="" coords="1414,79,1611,105"/>
<area shape="rect" href="arch__timer_8c.html#ad7dab91af9f69654aa27010f96125c13" title=" " alt="" coords="1459,129,1567,156"/>
<area shape="rect" href="arch__timer_8c.html#a6c290bf8212ea1388cdb4a839eae7228" title=" " alt="" coords="1664,97,1835,138"/>
<area shape="rect" href="kvm__main_8c.html#a51faeec43f0c1f5fe8a68cd44f7ff046" title=" " alt="" coords="417,71,616,113"/>
<area shape="rect" href="arm_8c.html#a81fd299a20cbefe3205c4524e9c90e7e" title=" " alt="" coords="421,137,612,164"/>
<area shape="rect" href="kvm__main_8c.html#a6c41937c88f6e58c4c2cc8b235921b8e" title=" " alt="" coords="432,189,601,230"/>
<area shape="rect" href="kvm__main_8c.html#a9bf210089ca6fb3f4b38293588ab53c5" title=" " alt="" coords="443,255,591,281"/>
<area shape="rect" href="kvm__main_8c.html#a06ed191cebec13ce2c4a7d15fdeb5a60" title=" " alt="" coords="447,305,587,332"/>
<area shape="rect" href="kvm__main_8c.html#aac20f0d987f71a47c6701c7e93a0e261" title=" " alt="" coords="937,303,1111,329"/>
<area shape="rect" href="arm_8c.html#ac412fb0d81a53e66d8ac4146e4202f92" title=" " alt="" coords="1173,316,1361,343"/>
<area shape="rect" href="arm_8c.html#a371c5c68ee659e4815a4af50d0161c8a" title=" " alt="" coords="1422,232,1603,259"/>
<area shape="rect" href="vgic_8c.html#a3059bfcee1ad30f581150d06c07d68e8" title=" " alt="" coords="1409,333,1616,360"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="1691,359,1807,385"/>
<area shape="rect" href="vgic-mmio_8c.html#ad275c2ef6d5f7f0d79f101a7dd6dda3a" title=" " alt="" coords="1691,308,1808,335"/>
<area shape="rect" href="vgic-v2_8c.html#aa825011d5b7d02e6b8f6c21746a5af39" title=" " alt="" coords="1896,333,2036,360"/>
<area shape="rect" href="vgic-v3_8c.html#a20f69ea757569fa58158ed4f097c1987" title=" " alt="" coords="1896,283,2036,309"/>
<area shape="rect" href="kvm__main_8c.html#a7256a8615584a9ae83a46c071f6aa0e9" title=" " alt="" coords="456,505,577,532"/>
<area shape="rect" href="vgic_8c.html#a751661541b39c02532a54736db22a929" title=" " alt="" coords="435,708,598,735"/>
<area shape="rect" href="vgic-v4_8c.html#ac2966fbf90610bb8a0525cbd903f7477" title=" " alt="" coords="463,356,570,383"/>
<area shape="rect" href="vgic-v4_8c.html#aeafcb3e6b67ea32ed8e59d009252e565" title=" " alt="" coords="467,407,567,433"/>
<area shape="rect" href="kvm__main_8c.html#a1045a615093ccd8e87dcd6f6a0e03e9e" title=" " alt="" coords="700,657,839,684"/>
<area shape="rect" href="kvm__main_8c.html#a8e18df0287ddedfd516454aeeb669807" title=" " alt="" coords="704,607,835,633"/>
<area shape="rect" href="kvm__main_8c.html#a3de4d6991bdd1a714e8afa6a55136cdd" title=" " alt="" coords="936,404,1112,431"/>
<area shape="rect" href="kvm__main_8c.html#afc3c9c56d305921c317259e18c9c8a59" title=" " alt="" coords="664,455,875,481"/>
<area shape="rect" href="kvm__main_8c.html#a22600b8a76a84f58d97f1a465293e63c" title=" " alt="" coords="696,505,843,532"/>
<area shape="rect" href="kvm__main_8c.html#aaa76576c021037e516218db81c147ca0" title=" " alt="" coords="685,556,854,583"/>
<area shape="rect" href="arm_8c.html#aa48cc7e76c49933c4fb44eda2ecec1ab" title=" " alt="" coords="931,632,1117,659"/>
<area shape="rect" href="arm_8c.html#a6416d8550a44ef31c85f11d80d6efcc2" title=" " alt="" coords="923,581,1125,608"/>
<area shape="rect" href="arch__timer_8c.html#a78e23e83bece8c269268f3a263fbb114" title=" " alt="" coords="1182,381,1353,422"/>
<area shape="rect" href="arch__timer_8c.html#ad210f5f7b0361777290f8b36f023a518" title=" " alt="" coords="1432,388,1593,415"/>
<area shape="rect" href="arch__timer_8c.html#a9d0120f96e99b20be8023dad5c6a7f0b" title=" " alt="" coords="1457,283,1568,309"/>
<area shape="rect" href="vgic-v2_8c.html#aa92110fc4f1e453fde0e8e720845854f" title=" " alt="" coords="695,759,844,785"/>
<area shape="rect" href="vgic-v3_8c.html#aa3f97179d90d3ed6a8920d1c57496380" title=" " alt="" coords="695,708,844,735"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a4c7049da2b551848d3e39293c881f329" title=" " alt="" coords="943,708,1105,735"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="672,353,867,380"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="973,353,1075,380"/>
</map>
</div>

</div>
</div>
<a id="ab4178b53f163a01d027c13d2a1248771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4178b53f163a01d027c13d2a1248771">&#9670;&nbsp;</a></span>nvhe_hyp_panic_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __noreturn __cold nvhe_hyp_panic_handler </td>
          <td>(</td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>esr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>spsr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>elr_virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>elr_phys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>far</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>hpfar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00386">386</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                              {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    u64 elr_in_kimg = __phys_to_kimg(elr_phys);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    u64 hyp_offset = elr_in_kimg - kaslr_offset() - elr_virt;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    u64 mode = spsr &amp; PSR_MODE_MASK;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    u64 panic_addr = elr_virt + hyp_offset;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (mode != PSR_MODE_EL2t &amp;&amp; mode != PSR_MODE_EL2h) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        kvm_err(<span class="stringliteral">&quot;Invalid host exception to nVHE hyp!\n&quot;</span>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ESR_ELx_EC(esr) == ESR_ELx_EC_BRK64 &amp;&amp;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;           (esr &amp; ESR_ELx_BRK64_ISS_COMMENT_MASK) == BUG_BRK_IMM) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *file = NULL;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> line = 0;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment">/* All hyp bugs, including warnings, are treated as fatal. */</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">if</span> (!is_protected_kvm_enabled() ||</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            IS_ENABLED(CONFIG_NVHE_EL2_DEBUG)) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keyword">struct </span>bug_entry *bug = find_bug(elr_in_kimg);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">if</span> (bug)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                bug_get_file_line(bug, &amp;file, &amp;line);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">if</span> (file)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            kvm_err(<span class="stringliteral">&quot;nVHE hyp BUG at: %s:%u!\n&quot;</span>, file, line);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            kvm_err(<span class="stringliteral">&quot;nVHE hyp BUG at: [&lt;%016llx&gt;] %pB!\n&quot;</span>, panic_addr,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    (<span class="keywordtype">void</span> *)(panic_addr + kaslr_offset()));</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        kvm_err(<span class="stringliteral">&quot;nVHE hyp panic at: [&lt;%016llx&gt;] %pB!\n&quot;</span>, panic_addr,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                (<span class="keywordtype">void</span> *)(panic_addr + kaslr_offset()));</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">/* Dump the nVHE hypervisor backtrace */</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="stacktrace_8c.html#a949ff19262717bb53aea90ee2f0d9589">kvm_nvhe_dump_backtrace</a>(hyp_offset);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">     * Hyp has panicked and we&#39;re going to handle that by panicking the</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">     * kernel. The kernel offset will be revealed in the panic so we&#39;re</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">     * also safe to reveal the hyp offset as a debugging aid for translating</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">     * hyp VAs to vmlinux addresses.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    kvm_err(<span class="stringliteral">&quot;Hyp Offset: 0x%llx\n&quot;</span>, hyp_offset);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    panic(<span class="stringliteral">&quot;HYP panic:\nPS:%08llx PC:%016llx ESR:%016llx\nFAR:%016llx HPFAR:%016llx PAR:%016llx\nVCPU:%016lx\n&quot;</span>,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          spsr, elr_virt, esr, far, hpfar, par, vcpu);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div>
<div class="ttc" id="astacktrace_8c_html_a949ff19262717bb53aea90ee2f0d9589"><div class="ttname"><a href="stacktrace_8c.html#a949ff19262717bb53aea90ee2f0d9589">kvm_nvhe_dump_backtrace</a></div><div class="ttdeci">void kvm_nvhe_dump_backtrace(unsigned long hyp_offset)</div><div class="ttdef"><b>Definition:</b> <a href="stacktrace_8c_source.html#l00239">stacktrace.c:239</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="handle__exit_8c_ab4178b53f163a01d027c13d2a1248771_cgraph.png" border="0" usemap="#ahandle__exit_8c_ab4178b53f163a01d027c13d2a1248771_cgraph" alt=""/></div>
<map name="ahandle__exit_8c_ab4178b53f163a01d027c13d2a1248771_cgraph" id="ahandle__exit_8c_ab4178b53f163a01d027c13d2a1248771_cgraph">
<area shape="rect" title=" " alt="" coords="5,184,188,211"/>
<area shape="rect" href="stacktrace_8c.html#a949ff19262717bb53aea90ee2f0d9589" title=" " alt="" coords="236,184,441,211"/>
<area shape="rect" href="stacktrace_8c.html#a2c620a2ddb439e8eed59cdd280f86712" title=" " alt="" coords="496,159,657,185"/>
<area shape="rect" href="stacktrace_8c.html#aac096a622afbed8bd8bf4054a2d7d480" title=" " alt="" coords="489,209,664,236"/>
<area shape="rect" href="stacktrace_8c.html#aafa459e56832d37727032fcede699d51" title=" " alt="" coords="712,5,948,32"/>
<area shape="rect" href="stacktrace_8c.html#a56c413740fa516ee678eb9a7d5c6c8eb" title=" " alt="" coords="727,57,933,98"/>
<area shape="rect" href="stacktrace_8c.html#a641c9c2f82090ee4a74b81e3a6cba168" title=" " alt="" coords="727,122,933,163"/>
<area shape="rect" href="stacktrace_8c.html#a16c8dd2eed1e3b98471820b689f4c6ec" title=" " alt="" coords="1603,177,1801,204"/>
<area shape="rect" href="stacktrace_8c.html#af699614b3fa742d6f5e0822be255edec" title=" " alt="" coords="1615,330,1789,371"/>
<area shape="rect" href="stacktrace_8c.html#a44789bd2a4a13f4be2b8681d476608c3" title=" " alt="" coords="795,243,865,269"/>
<area shape="rect" href="stacktrace_8c.html#a752432263bba248ca12e86119ea37417" title=" " alt="" coords="996,245,1101,272"/>
<area shape="rect" href="stacktrace_8c.html#a7bb100e1abd79fc03a0a96d19ddbde38" title=" " alt="" coords="1149,239,1316,281"/>
<area shape="rect" href="stacktrace_8c.html#a1693565800c9b4fe9a7d561de311d91f" title=" " alt="" coords="1364,247,1555,273"/>
<area shape="rect" href="stacktrace_8c.html#a4ddd759f6b0b51c08506ea0b496cc183" title=" " alt="" coords="1631,228,1773,255"/>
<area shape="rect" href="stacktrace_8c.html#a0e98bbaa6d6467b01a60fd727f838fcb" title=" " alt="" coords="1615,279,1789,305"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="acb2ef35f12aad0be19cdf8d484746961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb2ef35f12aad0be19cdf8d484746961">&#9670;&nbsp;</a></span>arm_exit_handlers</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="handle__exit_8c.html#a339387f2d97c45b60a2741cb3d6ffc23">exit_handle_fn</a> arm_exit_handlers[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [0 ... ESR_ELx_EC_MAX]  = <a class="code" href="handle__exit_8c.html#a313f5469836166a2b9b9e2164fd00cdb">kvm_handle_unknown_ec</a>,</div>
<div class="line">    [ESR_ELx_EC_WFx]    = <a class="code" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788">kvm_handle_wfx</a>,</div>
<div class="line">    [ESR_ELx_EC_CP15_32]    = <a class="code" href="sys__regs_8c.html#aabfd3c696cf28ee58eb8d7e421e12310">kvm_handle_cp15_32</a>,</div>
<div class="line">    [ESR_ELx_EC_CP15_64]    = <a class="code" href="sys__regs_8c.html#ae031a976c6888fa3fb7ac85e9ffa4ce1">kvm_handle_cp15_64</a>,</div>
<div class="line">    [ESR_ELx_EC_CP14_MR]    = <a class="code" href="sys__regs_8c.html#a3fc2578a70449007d0bac463e2d66d05">kvm_handle_cp14_32</a>,</div>
<div class="line">    [ESR_ELx_EC_CP14_LS]    = <a class="code" href="sys__regs_8c.html#a66819aed8acf3d9c6daa1c73afd5e8f7">kvm_handle_cp14_load_store</a>,</div>
<div class="line">    [ESR_ELx_EC_CP10_ID]    = <a class="code" href="sys__regs_8c.html#a1a4cee9d7be58e2317c540e1f87eea20">kvm_handle_cp10_id</a>,</div>
<div class="line">    [ESR_ELx_EC_CP14_64]    = <a class="code" href="sys__regs_8c.html#a5f660f6a9a4de1cfc8af20da24cdad94">kvm_handle_cp14_64</a>,</div>
<div class="line">    [ESR_ELx_EC_HVC32]  = <a class="code" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69">handle_hvc</a>,</div>
<div class="line">    [ESR_ELx_EC_SMC32]  = <a class="code" href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746">handle_smc</a>,</div>
<div class="line">    [ESR_ELx_EC_HVC64]  = <a class="code" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69">handle_hvc</a>,</div>
<div class="line">    [ESR_ELx_EC_SMC64]  = <a class="code" href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746">handle_smc</a>,</div>
<div class="line">    [ESR_ELx_EC_SVC64]  = <a class="code" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd">handle_svc</a>,</div>
<div class="line">    [ESR_ELx_EC_SYS64]  = <a class="code" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac">kvm_handle_sys_reg</a>,</div>
<div class="line">    [ESR_ELx_EC_SVE]    = <a class="code" href="handle__exit_8c.html#a3e3ab5fffb73f5ca9700a79f510dcf8f">handle_sve</a>,</div>
<div class="line">    [ESR_ELx_EC_ERET]   = <a class="code" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d">kvm_handle_eret</a>,</div>
<div class="line">    [ESR_ELx_EC_IABT_LOW]   = <a class="code" href="mmu_8c.html#a2c7559bf16232daf5d3187255f1cb70e">kvm_handle_guest_abort</a>,</div>
<div class="line">    [ESR_ELx_EC_DABT_LOW]   = <a class="code" href="mmu_8c.html#a2c7559bf16232daf5d3187255f1cb70e">kvm_handle_guest_abort</a>,</div>
<div class="line">    [ESR_ELx_EC_SOFTSTP_LOW]= <a class="code" href="handle__exit_8c.html#afcce6bad48b6a9769e594aeba3f73717">kvm_handle_guest_debug</a>,</div>
<div class="line">    [ESR_ELx_EC_WATCHPT_LOW]= <a class="code" href="handle__exit_8c.html#afcce6bad48b6a9769e594aeba3f73717">kvm_handle_guest_debug</a>,</div>
<div class="line">    [ESR_ELx_EC_BREAKPT_LOW]= <a class="code" href="handle__exit_8c.html#afcce6bad48b6a9769e594aeba3f73717">kvm_handle_guest_debug</a>,</div>
<div class="line">    [ESR_ELx_EC_BKPT32] = <a class="code" href="handle__exit_8c.html#afcce6bad48b6a9769e594aeba3f73717">kvm_handle_guest_debug</a>,</div>
<div class="line">    [ESR_ELx_EC_BRK64]  = <a class="code" href="handle__exit_8c.html#afcce6bad48b6a9769e594aeba3f73717">kvm_handle_guest_debug</a>,</div>
<div class="line">    [ESR_ELx_EC_FP_ASIMD]   = <a class="code" href="handle__exit_8c.html#aba3cb2b15ab0fafd0ac45b621d3bb6b3">handle_no_fpsimd</a>,</div>
<div class="line">    [ESR_ELx_EC_PAC]    = <a class="code" href="handle__exit_8c.html#a0a50407175f0512dcb278e198ce16254">kvm_handle_ptrauth</a>,</div>
<div class="line">}</div>
<div class="ttc" id="ahandle__exit_8c_html_a0b391fc62c2250ecc0bfcdbe1b0a6788"><div class="ttname"><a href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788">kvm_handle_wfx</a></div><div class="ttdeci">static int kvm_handle_wfx(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00114">handle_exit.c:114</a></div></div>
<div class="ttc" id="ahandle__exit_8c_html_a313f5469836166a2b9b9e2164fd00cdb"><div class="ttname"><a href="handle__exit_8c.html#a313f5469836166a2b9b9e2164fd00cdb">kvm_handle_unknown_ec</a></div><div class="ttdeci">static int kvm_handle_unknown_ec(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00188">handle_exit.c:188</a></div></div>
<div class="ttc" id="ahandle__exit_8c_html_a3e3ab5fffb73f5ca9700a79f510dcf8f"><div class="ttname"><a href="handle__exit_8c.html#a3e3ab5fffb73f5ca9700a79f510dcf8f">handle_sve</a></div><div class="ttdeci">static int handle_sve(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00203">handle_exit.c:203</a></div></div>
<div class="ttc" id="ahandle__exit_8c_html_a5c24d46393da9651d3133e2377fd7a69"><div class="ttname"><a href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69">handle_hvc</a></div><div class="ttdeci">static int handle_hvc(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00037">handle_exit.c:37</a></div></div>
<div class="ttc" id="ahandle__exit_8c_html_aba3cb2b15ab0fafd0ac45b621d3bb6b3"><div class="ttname"><a href="handle__exit_8c.html#aba3cb2b15ab0fafd0ac45b621d3bb6b3">handle_no_fpsimd</a></div><div class="ttdeci">static int handle_no_fpsimd(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00093">handle_exit.c:93</a></div></div>
<div class="ttc" id="ahandle__exit_8c_html_ad2545fb9f7329ef0604715b9af4a1746"><div class="ttname"><a href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746">handle_smc</a></div><div class="ttdeci">static int handle_smc(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00056">handle_exit.c:56</a></div></div>
<div class="ttc" id="ahandle__exit_8c_html_ae96aab7918301d55b908034db5855e3d"><div class="ttname"><a href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d">kvm_handle_eret</a></div><div class="ttdeci">static int kvm_handle_eret(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00220">handle_exit.c:220</a></div></div>
<div class="ttc" id="ahandle__exit_8c_html_aeaf983f5c40202edc8b07a76603330cd"><div class="ttname"><a href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd">handle_svc</a></div><div class="ttdeci">static int handle_svc(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00244">handle_exit.c:244</a></div></div>
<div class="ttc" id="ahandle__exit_8c_html_afcce6bad48b6a9769e594aeba3f73717"><div class="ttname"><a href="handle__exit_8c.html#afcce6bad48b6a9769e594aeba3f73717">kvm_handle_guest_debug</a></div><div class="ttdeci">static int kvm_handle_guest_debug(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="handle__exit_8c_source.html#l00166">handle_exit.c:166</a></div></div>
<div class="ttc" id="ammu_8c_html_a2c7559bf16232daf5d3187255f1cb70e"><div class="ttname"><a href="mmu_8c.html#a2c7559bf16232daf5d3187255f1cb70e">kvm_handle_guest_abort</a></div><div class="ttdeci">int kvm_handle_guest_abort(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="mmu_8c_source.html#l01619">mmu.c:1619</a></div></div>
<div class="ttc" id="asys__regs_8c_html_a1a4cee9d7be58e2317c540e1f87eea20"><div class="ttname"><a href="sys__regs_8c.html#a1a4cee9d7be58e2317c540e1f87eea20">kvm_handle_cp10_id</a></div><div class="ttdeci">int kvm_handle_cp10_id(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="sys__regs_8c_source.html#l03264">sys_regs.c:3264</a></div></div>
<div class="ttc" id="asys__regs_8c_html_a315e661b6f1cb224596267000909a1ac"><div class="ttname"><a href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac">kvm_handle_sys_reg</a></div><div class="ttdeci">int kvm_handle_sys_reg(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="sys__regs_8c_source.html#l03473">sys_regs.c:3473</a></div></div>
<div class="ttc" id="asys__regs_8c_html_a3fc2578a70449007d0bac463e2d66d05"><div class="ttname"><a href="sys__regs_8c.html#a3fc2578a70449007d0bac463e2d66d05">kvm_handle_cp14_32</a></div><div class="ttdeci">int kvm_handle_cp14_32(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="sys__regs_8c_source.html#l03378">sys_regs.c:3378</a></div></div>
<div class="ttc" id="asys__regs_8c_html_a5f660f6a9a4de1cfc8af20da24cdad94"><div class="ttname"><a href="sys__regs_8c.html#a5f660f6a9a4de1cfc8af20da24cdad94">kvm_handle_cp14_64</a></div><div class="ttdeci">int kvm_handle_cp14_64(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="sys__regs_8c_source.html#l03373">sys_regs.c:3373</a></div></div>
<div class="ttc" id="asys__regs_8c_html_a66819aed8acf3d9c6daa1c73afd5e8f7"><div class="ttname"><a href="sys__regs_8c.html#a66819aed8acf3d9c6daa1c73afd5e8f7">kvm_handle_cp14_load_store</a></div><div class="ttdeci">int kvm_handle_cp14_load_store(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="sys__regs_8c_source.html#l03073">sys_regs.c:3073</a></div></div>
<div class="ttc" id="asys__regs_8c_html_aabfd3c696cf28ee58eb8d7e421e12310"><div class="ttname"><a href="sys__regs_8c.html#aabfd3c696cf28ee58eb8d7e421e12310">kvm_handle_cp15_32</a></div><div class="ttdeci">int kvm_handle_cp15_32(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="sys__regs_8c_source.html#l03355">sys_regs.c:3355</a></div></div>
<div class="ttc" id="asys__regs_8c_html_ae031a976c6888fa3fb7ac85e9ffa4ce1"><div class="ttname"><a href="sys__regs_8c.html#ae031a976c6888fa3fb7ac85e9ffa4ce1">kvm_handle_cp15_64</a></div><div class="ttdeci">int kvm_handle_cp15_64(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="sys__regs_8c_source.html#l03350">sys_regs.c:3350</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="handle__exit_8c_source.html#l00255">255</a> of file <a class="el" href="handle__exit_8c_source.html">handle_exit.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
