<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KVM: include/kvm/arm_vgic.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_58f50ad22074a1980bc3b7d56b15b27e.html">kvm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">arm_vgic.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/bits.h&gt;</code><br />
<code>#include &lt;linux/kvm.h&gt;</code><br />
<code>#include &lt;linux/irqreturn.h&gt;</code><br />
<code>#include &lt;linux/kref.h&gt;</code><br />
<code>#include &lt;linux/mutex.h&gt;</code><br />
<code>#include &lt;linux/spinlock.h&gt;</code><br />
<code>#include &lt;linux/static_key.h&gt;</code><br />
<code>#include &lt;linux/types.h&gt;</code><br />
<code>#include &lt;<a class="el" href="iodev_8h_source.html">kvm/iodev.h</a>&gt;</code><br />
<code>#include &lt;linux/list.h&gt;</code><br />
<code>#include &lt;linux/jump_label.h&gt;</code><br />
<code>#include &lt;linux/irqchip/arm-gic-v4.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for arm_vgic.h:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h__incl.png" border="0" usemap="#ainclude_2kvm_2arm__vgic_8h" alt=""/></div>
<map name="ainclude_2kvm_2arm__vgic_8h" id="ainclude_2kvm_2arm__vgic_8h">
<area shape="rect" title=" " alt="" coords="702,5,881,32"/>
<area shape="rect" title=" " alt="" coords="5,80,100,107"/>
<area shape="rect" title=" " alt="" coords="125,80,223,107"/>
<area shape="rect" title=" " alt="" coords="248,80,375,107"/>
<area shape="rect" title=" " alt="" coords="399,80,493,107"/>
<area shape="rect" title=" " alt="" coords="518,80,630,107"/>
<area shape="rect" title=" " alt="" coords="653,80,777,107"/>
<area shape="rect" title=" " alt="" coords="801,80,936,107"/>
<area shape="rect" title=" " alt="" coords="961,80,1067,107"/>
<area shape="rect" href="iodev_8h.html" title=" " alt="" coords="1092,80,1195,107"/>
<area shape="rect" title=" " alt="" coords="1219,80,1310,107"/>
<area shape="rect" title=" " alt="" coords="1335,80,1477,107"/>
<area shape="rect" title=" " alt="" coords="1501,80,1689,107"/>
<area shape="rect" title=" " alt="" coords="997,155,1140,181"/>
<area shape="rect" title=" " alt="" coords="1165,155,1269,181"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h__dep__incl.png" border="0" usemap="#ainclude_2kvm_2arm__vgic_8hdep" alt=""/></div>
<map name="ainclude_2kvm_2arm__vgic_8hdep" id="ainclude_2kvm_2arm__vgic_8hdep">
<area shape="rect" title=" " alt="" coords="921,5,1099,32"/>
<area shape="rect" href="arch__timer_8c.html" title=" " alt="" coords="5,80,167,121"/>
<area shape="rect" href="pmu-emul_8c.html" title=" " alt="" coords="191,80,354,121"/>
<area shape="rect" href="vgic-irqfd_8c.html" title=" " alt="" coords="378,80,538,121"/>
<area shape="rect" href="vgic-debug_8c.html" title=" " alt="" coords="562,80,722,121"/>
<area shape="rect" href="vgic-init_8c.html" title=" " alt="" coords="746,80,906,121"/>
<area shape="rect" href="vgic-mmio-v3_8c.html" title=" " alt="" coords="930,80,1090,121"/>
<area shape="rect" href="vgic-mmio-v2_8c.html" title=" " alt="" coords="1114,80,1274,121"/>
<area shape="rect" href="vgic-kvm-device_8c.html" title=" " alt="" coords="1298,80,1458,121"/>
<area shape="rect" href="vgic-mmio_8c.html" title=" " alt="" coords="1482,80,1642,121"/>
<area shape="rect" href="vgic-v2_8c.html" title=" " alt="" coords="1666,80,1826,121"/>
<area shape="rect" href="vgic-v3_8c.html" title=" " alt="" coords="1850,80,2010,121"/>
</map>
</div>
</div>
<p><a href="arm__vgic_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvgic__global.html">vgic_global</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structirq__ops.html">irq_ops</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvgic__irq.html">vgic_irq</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvgic__io__device.html">vgic_io_device</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvgic__its.html">vgic_its</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvgic__redist__region.html">vgic_redist_region</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvgic__dist.html">vgic_dist</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvgic__v2__cpu__if.html">vgic_v2_cpu_if</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvgic__v3__cpu__if.html">vgic_v3_cpu_if</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvgic__cpu.html">vgic_cpu</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a068e6ffdc2074e5125c730fb51f9f2ca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a068e6ffdc2074e5125c730fb51f9f2ca">VGIC_V3_MAX_CPUS</a>&#160;&#160;&#160;512</td></tr>
<tr class="separator:a068e6ffdc2074e5125c730fb51f9f2ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919dfd28be18085c0df4a1e66f3663f5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a919dfd28be18085c0df4a1e66f3663f5">VGIC_V2_MAX_CPUS</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a919dfd28be18085c0df4a1e66f3663f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00cb0b5b22477a7cc824de820da0934a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a00cb0b5b22477a7cc824de820da0934a">VGIC_NR_IRQS_LEGACY</a>&#160;&#160;&#160;256</td></tr>
<tr class="separator:a00cb0b5b22477a7cc824de820da0934a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8143b35cbc0236b1f9fd65b9062ae523"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a8143b35cbc0236b1f9fd65b9062ae523">VGIC_NR_SGIS</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a8143b35cbc0236b1f9fd65b9062ae523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0030e1d724372943f190b24f0150b223"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a0030e1d724372943f190b24f0150b223">VGIC_NR_PPIS</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a0030e1d724372943f190b24f0150b223"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9d406cdd3eafd831ee41ecf0e48011e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a>&#160;&#160;&#160;(<a class="el" href="arm__vgic_8h.html#a8143b35cbc0236b1f9fd65b9062ae523">VGIC_NR_SGIS</a> + <a class="el" href="arm__vgic_8h.html#a0030e1d724372943f190b24f0150b223">VGIC_NR_PPIS</a>)</td></tr>
<tr class="separator:ae9d406cdd3eafd831ee41ecf0e48011e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add3f1f00371cf528cb8ffac2642d4ee3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#add3f1f00371cf528cb8ffac2642d4ee3">VGIC_MAX_PRIVATE</a>&#160;&#160;&#160;(<a class="el" href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a> - 1)</td></tr>
<tr class="separator:add3f1f00371cf528cb8ffac2642d4ee3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafd3fd440e6d69c6d2649cfe0023e34c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#aafd3fd440e6d69c6d2649cfe0023e34c">VGIC_MAX_SPI</a>&#160;&#160;&#160;1019</td></tr>
<tr class="separator:aafd3fd440e6d69c6d2649cfe0023e34c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7342134b684299f69395eee1e4fbc05"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#ad7342134b684299f69395eee1e4fbc05">VGIC_MAX_RESERVED</a>&#160;&#160;&#160;1023</td></tr>
<tr class="separator:ad7342134b684299f69395eee1e4fbc05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34000cd3b6c53a8b7848df48d97271cb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a34000cd3b6c53a8b7848df48d97271cb">VGIC_MIN_LPI</a>&#160;&#160;&#160;8192</td></tr>
<tr class="separator:a34000cd3b6c53a8b7848df48d97271cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51fde4189b74866c5fa5f3c77ee815a1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a51fde4189b74866c5fa5f3c77ee815a1">KVM_IRQCHIP_NUM_PINS</a>&#160;&#160;&#160;(1020 - 32)</td></tr>
<tr class="separator:a51fde4189b74866c5fa5f3c77ee815a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86535c3eff6bfc9d2e4224c73ebfa57d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a86535c3eff6bfc9d2e4224c73ebfa57d">irq_is_ppi</a>(irq)&#160;&#160;&#160;((irq) &gt;= <a class="el" href="arm__vgic_8h.html#a8143b35cbc0236b1f9fd65b9062ae523">VGIC_NR_SGIS</a> &amp;&amp; (irq) &lt; <a class="el" href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a>)</td></tr>
<tr class="separator:a86535c3eff6bfc9d2e4224c73ebfa57d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f86b03933762973e4decbba9b873d0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#ab1f86b03933762973e4decbba9b873d0">irq_is_spi</a>(irq)</td></tr>
<tr class="separator:ab1f86b03933762973e4decbba9b873d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbc743cbfefbb1b95655e63b7505b48f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#abbc743cbfefbb1b95655e63b7505b48f">VGIC_V2_MAX_LRS</a>&#160;&#160;&#160;(1 &lt;&lt; 6)</td></tr>
<tr class="separator:abbc743cbfefbb1b95655e63b7505b48f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7bff1a16cbcc734e62caae7ec19b36e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#ab7bff1a16cbcc734e62caae7ec19b36e">VGIC_V3_MAX_LRS</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:ab7bff1a16cbcc734e62caae7ec19b36e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5272f1910695fe8e411dc283b72faabc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a5272f1910695fe8e411dc283b72faabc">VGIC_V3_LR_INDEX</a>(lr)&#160;&#160;&#160;(<a class="el" href="arm__vgic_8h.html#ab7bff1a16cbcc734e62caae7ec19b36e">VGIC_V3_MAX_LRS</a> - 1 - lr)</td></tr>
<tr class="separator:a5272f1910695fe8e411dc283b72faabc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c3e9820ba029d65cf7800d0cb4964be"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a9c3e9820ba029d65cf7800d0cb4964be">VGIC_IRQ_SW_RESAMPLE</a>&#160;&#160;&#160;BIT(0)	/* Clear the active state for resampling */</td></tr>
<tr class="separator:a9c3e9820ba029d65cf7800d0cb4964be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6daa21682a97a3422d97c115dd1007df"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a6daa21682a97a3422d97c115dd1007df">KVM_VGIC_IMP_REV_2</a>&#160;&#160;&#160;2 /* GICv2 restorable groups */</td></tr>
<tr class="separator:a6daa21682a97a3422d97c115dd1007df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a293e90343d1998f9cc3af273e62caa8a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a293e90343d1998f9cc3af273e62caa8a">KVM_VGIC_IMP_REV_3</a>&#160;&#160;&#160;3 /* GICv3 GICR_CTLR.{IW,CES,RWP} */</td></tr>
<tr class="separator:a293e90343d1998f9cc3af273e62caa8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bd5ea551d855097a6f0bd86e46dbfb2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a3bd5ea551d855097a6f0bd86e46dbfb2">KVM_VGIC_IMP_REV_LATEST</a>&#160;&#160;&#160;<a class="el" href="arm__vgic_8h.html#a293e90343d1998f9cc3af273e62caa8a">KVM_VGIC_IMP_REV_3</a></td></tr>
<tr class="separator:a3bd5ea551d855097a6f0bd86e46dbfb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28961fa9a6313f335b274e0fac503bcf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a28961fa9a6313f335b274e0fac503bcf">irqchip_in_kernel</a>(k)&#160;&#160;&#160;(!!((k)-&gt;arch.vgic.in_kernel))</td></tr>
<tr class="separator:a28961fa9a6313f335b274e0fac503bcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92f7a5b2fbbd6b57aaed08e61ba34d43"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a92f7a5b2fbbd6b57aaed08e61ba34d43">vgic_initialized</a>(k)&#160;&#160;&#160;((k)-&gt;arch.vgic.initialized)</td></tr>
<tr class="separator:a92f7a5b2fbbd6b57aaed08e61ba34d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a1cb81c34b893dec2bef262c6fafb15"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a8a1cb81c34b893dec2bef262c6fafb15">vgic_ready</a>(k)&#160;&#160;&#160;((k)-&gt;arch.vgic.ready)</td></tr>
<tr class="separator:a8a1cb81c34b893dec2bef262c6fafb15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea629c518405f94a45bbe647ef71fcc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#adea629c518405f94a45bbe647ef71fcc">vgic_valid_spi</a>(k,  i)</td></tr>
<tr class="separator:adea629c518405f94a45bbe647ef71fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a6e40915cc9873f08ca702678ce237ff1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1">vgic_type</a> { <a class="el" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a9516eb794b5e9d2d4817bb361c699a60">VGIC_V2</a>
, <a class="el" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a6556967af9084ab2c8d36e7faf368d1e">VGIC_V3</a>
 }</td></tr>
<tr class="separator:a6e40915cc9873f08ca702678ce237ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23952420a7fea6ce35df942e6b0783e7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7">vgic_irq_config</a> { <a class="el" href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7adc1b4a2895063d95a6a3aef89da15915">VGIC_CONFIG_EDGE</a> = 0
, <a class="el" href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7aff766918bb2eff9dbb94c4edea188a2a">VGIC_CONFIG_LEVEL</a>
 }</td></tr>
<tr class="separator:a23952420a7fea6ce35df942e6b0783e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d55542a11eb56d7d2c093ce5e75e885"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885">iodev_type</a> { <a class="el" href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885ac67dc30122cf1e2ff45ce17ead4d71db">IODEV_CPUIF</a>
, <a class="el" href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885ac68240095de34962ed690f571683d0df">IODEV_DIST</a>
, <a class="el" href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885a34e159d88b4995a38067b96166de01e3">IODEV_REDIST</a>
, <a class="el" href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885a3c8e2fe20770015f7d22a9a666e3a8fd">IODEV_ITS</a>
 }</td></tr>
<tr class="separator:a7d55542a11eb56d7d2c093ce5e75e885"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad8001fedb7a2cb065c38833241e86b5c"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#ad8001fedb7a2cb065c38833241e86b5c">vgic_irq_needs_resampling</a> (struct <a class="el" href="structvgic__irq.html">vgic_irq</a> *irq)</td></tr>
<tr class="separator:ad8001fedb7a2cb065c38833241e86b5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7808d55ba83902bd478febfc33334d5d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a7808d55ba83902bd478febfc33334d5d">kvm_set_legacy_vgic_v2_addr</a> (struct kvm *kvm, struct kvm_arm_device_addr *dev_addr)</td></tr>
<tr class="separator:a7808d55ba83902bd478febfc33334d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab923d47040c4f3c9e6cae619d7abf78a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#ab923d47040c4f3c9e6cae619d7abf78a">kvm_vgic_early_init</a> (struct kvm *kvm)</td></tr>
<tr class="separator:ab923d47040c4f3c9e6cae619d7abf78a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad052e8c724bfbb39c34281df23166a28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#ad052e8c724bfbb39c34281df23166a28">kvm_vgic_vcpu_init</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad052e8c724bfbb39c34281df23166a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ce1b5a14cd479b726e5451691380615"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a4ce1b5a14cd479b726e5451691380615">kvm_vgic_create</a> (struct kvm *kvm, u32 type)</td></tr>
<tr class="separator:a4ce1b5a14cd479b726e5451691380615"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af08e0c3b0309dbe4472ed185cd2b9e72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#af08e0c3b0309dbe4472ed185cd2b9e72">kvm_vgic_destroy</a> (struct kvm *kvm)</td></tr>
<tr class="separator:af08e0c3b0309dbe4472ed185cd2b9e72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05d84155ac79f812932547367b4445e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a05d84155ac79f812932547367b4445e4">kvm_vgic_vcpu_destroy</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a05d84155ac79f812932547367b4445e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8411f235847aa56055a7a2fefce226c6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a8411f235847aa56055a7a2fefce226c6">kvm_vgic_map_resources</a> (struct kvm *kvm)</td></tr>
<tr class="separator:a8411f235847aa56055a7a2fefce226c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba3547aa220ca50b1eabca1a39c92943"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#aba3547aa220ca50b1eabca1a39c92943">kvm_vgic_hyp_init</a> (void)</td></tr>
<tr class="separator:aba3547aa220ca50b1eabca1a39c92943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefd1e0e9cd080919b043406251dfa0b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#aefd1e0e9cd080919b043406251dfa0b8">kvm_vgic_init_cpu_hardware</a> (void)</td></tr>
<tr class="separator:aefd1e0e9cd080919b043406251dfa0b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87038ce452e0054b853c10ccbbcc78a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a87038ce452e0054b853c10ccbbcc78a4">kvm_vgic_inject_irq</a> (struct kvm *kvm, struct kvm_vcpu *vcpu, unsigned int intid, bool level, void *owner)</td></tr>
<tr class="separator:a87038ce452e0054b853c10ccbbcc78a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4243e0ac375259b39c04a6cc6266a9f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#ab4243e0ac375259b39c04a6cc6266a9f">kvm_vgic_map_phys_irq</a> (struct kvm_vcpu *vcpu, unsigned int host_irq, u32 vintid, struct <a class="el" href="structirq__ops.html">irq_ops</a> *ops)</td></tr>
<tr class="separator:ab4243e0ac375259b39c04a6cc6266a9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4199ace0bb639bc69d06a2ce1ee0d1ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a4199ace0bb639bc69d06a2ce1ee0d1ff">kvm_vgic_unmap_phys_irq</a> (struct kvm_vcpu *vcpu, unsigned int vintid)</td></tr>
<tr class="separator:a4199ace0bb639bc69d06a2ce1ee0d1ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a11de94338771a6d53dd409d4f4c49d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a0a11de94338771a6d53dd409d4f4c49d">kvm_vgic_get_map</a> (struct kvm_vcpu *vcpu, unsigned int vintid)</td></tr>
<tr class="separator:a0a11de94338771a6d53dd409d4f4c49d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1273f536f3d378a0b259e76591471f7b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a1273f536f3d378a0b259e76591471f7b">kvm_vgic_map_is_active</a> (struct kvm_vcpu *vcpu, unsigned int vintid)</td></tr>
<tr class="separator:a1273f536f3d378a0b259e76591471f7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3059bfcee1ad30f581150d06c07d68e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a3059bfcee1ad30f581150d06c07d68e8">kvm_vgic_vcpu_pending_irq</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a3059bfcee1ad30f581150d06c07d68e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54d5d884ac662357df5661d80f5160e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a54d5d884ac662357df5661d80f5160e3">kvm_vgic_load</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a54d5d884ac662357df5661d80f5160e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96f93a2405989082e3693577b6b2eb5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a96f93a2405989082e3693577b6b2eb5d">kvm_vgic_put</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a96f93a2405989082e3693577b6b2eb5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a751661541b39c02532a54736db22a929"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a751661541b39c02532a54736db22a929">kvm_vgic_vmcr_sync</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a751661541b39c02532a54736db22a929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15be17d3a67e2b955c81aca0a2c20708"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a15be17d3a67e2b955c81aca0a2c20708">kvm_vcpu_has_pending_irqs</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a15be17d3a67e2b955c81aca0a2c20708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76c600af416fb73e40611d80115edc03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a76c600af416fb73e40611d80115edc03">kvm_vgic_sync_hwstate</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a76c600af416fb73e40611d80115edc03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fb6266a1f361c1945f5feb862c1cf31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a5fb6266a1f361c1945f5feb862c1cf31">kvm_vgic_flush_hwstate</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a5fb6266a1f361c1945f5feb862c1cf31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37d0e0f4c579bc38afe8d5f91529a772"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a37d0e0f4c579bc38afe8d5f91529a772">kvm_vgic_reset_mapped_irq</a> (struct kvm_vcpu *vcpu, u32 vintid)</td></tr>
<tr class="separator:a37d0e0f4c579bc38afe8d5f91529a772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7df84da3229db55762dde7ac4e1b3e96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a7df84da3229db55762dde7ac4e1b3e96">vgic_v3_dispatch_sgi</a> (struct kvm_vcpu *vcpu, u64 reg, bool allow_group1)</td></tr>
<tr class="separator:a7df84da3229db55762dde7ac4e1b3e96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5bae87fbacf924b25a9944b4f99e87"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a3e5bae87fbacf924b25a9944b4f99e87">kvm_vgic_get_max_vcpus</a> (void)</td></tr>
<tr class="separator:a3e5bae87fbacf924b25a9944b4f99e87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5dcaa98f287aec5083bd60daf115d71"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#ab5dcaa98f287aec5083bd60daf115d71">kvm_vgic_setup_default_irq_routing</a> (struct kvm *kvm)</td></tr>
<tr class="separator:ab5dcaa98f287aec5083bd60daf115d71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99527df04c2db316d7f8c1733c18d99e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a99527df04c2db316d7f8c1733c18d99e">kvm_vgic_set_owner</a> (struct kvm_vcpu *vcpu, unsigned int intid, void *owner)</td></tr>
<tr class="separator:a99527df04c2db316d7f8c1733c18d99e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90f479062f56d4785922e5dfb0113838"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a90f479062f56d4785922e5dfb0113838">kvm_vgic_v4_set_forwarding</a> (struct kvm *kvm, int irq, struct kvm_kernel_irq_routing_entry *irq_entry)</td></tr>
<tr class="separator:a90f479062f56d4785922e5dfb0113838"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de18f527930f927b7fedc3807929f9c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a2de18f527930f927b7fedc3807929f9c">kvm_vgic_v4_unset_forwarding</a> (struct kvm *kvm, int irq, struct kvm_kernel_irq_routing_entry *irq_entry)</td></tr>
<tr class="separator:a2de18f527930f927b7fedc3807929f9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2966fbf90610bb8a0525cbd903f7477"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#ac2966fbf90610bb8a0525cbd903f7477">vgic_v4_load</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ac2966fbf90610bb8a0525cbd903f7477"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a043911fe4b149ad2ca234282ce4e67df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a043911fe4b149ad2ca234282ce4e67df">vgic_v4_commit</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a043911fe4b149ad2ca234282ce4e67df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeafcb3e6b67ea32ed8e59d009252e565"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#aeafcb3e6b67ea32ed8e59d009252e565">vgic_v4_put</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aeafcb3e6b67ea32ed8e59d009252e565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a575388855c33993ba44e8e4bd2511fb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a575388855c33993ba44e8e4bd2511fb6">kvm_vgic_cpu_up</a> (void)</td></tr>
<tr class="separator:a575388855c33993ba44e8e4bd2511fb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17cbfdbbcbf19c731724a5e5cb9583d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a17cbfdbbcbf19c731724a5e5cb9583d8">kvm_vgic_cpu_down</a> (void)</td></tr>
<tr class="separator:a17cbfdbbcbf19c731724a5e5cb9583d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a53b0ff890074ba3dc4b1bed11a236394"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structvgic__global.html">vgic_global</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a></td></tr>
<tr class="separator:a53b0ff890074ba3dc4b1bed11a236394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f46deb903409e1ea643f0072ae1552e"><td class="memItemLeft" align="right" valign="top">struct static_key_false&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a8f46deb903409e1ea643f0072ae1552e">vgic_v2_cpuif_trap</a></td></tr>
<tr class="separator:a8f46deb903409e1ea643f0072ae1552e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6659017e8f125c9d04cbef018aebf2be"><td class="memItemLeft" align="right" valign="top">struct static_key_false&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arm__vgic_8h.html#a6659017e8f125c9d04cbef018aebf2be">vgic_v3_cpuif_trap</a></td></tr>
<tr class="separator:a6659017e8f125c9d04cbef018aebf2be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a86535c3eff6bfc9d2e4224c73ebfa57d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86535c3eff6bfc9d2e4224c73ebfa57d">&#9670;&nbsp;</a></span>irq_is_ppi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define irq_is_ppi</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">irq</td><td>)</td>
          <td>&#160;&#160;&#160;((irq) &gt;= <a class="el" href="arm__vgic_8h.html#a8143b35cbc0236b1f9fd65b9062ae523">VGIC_NR_SGIS</a> &amp;&amp; (irq) &lt; <a class="el" href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00034">34</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="ab1f86b03933762973e4decbba9b873d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1f86b03933762973e4decbba9b873d0">&#9670;&nbsp;</a></span>irq_is_spi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define irq_is_spi</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">irq</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">             ((irq) &gt;= <a class="code" href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a> &amp;&amp; \</div>
<div class="line">             (irq) &lt;= <a class="code" href="arm__vgic_8h.html#aafd3fd440e6d69c6d2649cfe0023e34c">VGIC_MAX_SPI</a>)</div>
<div class="ttc" id="aarm__vgic_8h_html_aafd3fd440e6d69c6d2649cfe0023e34c"><div class="ttname"><a href="arm__vgic_8h.html#aafd3fd440e6d69c6d2649cfe0023e34c">VGIC_MAX_SPI</a></div><div class="ttdeci">#define VGIC_MAX_SPI</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00029">arm_vgic.h:29</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_ae9d406cdd3eafd831ee41ecf0e48011e"><div class="ttname"><a href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a></div><div class="ttdeci">#define VGIC_NR_PRIVATE_IRQS</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00027">arm_vgic.h:27</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00035">35</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a28961fa9a6313f335b274e0fac503bcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28961fa9a6313f335b274e0fac503bcf">&#9670;&nbsp;</a></span>irqchip_in_kernel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define irqchip_in_kernel</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">k</td><td>)</td>
          <td>&#160;&#160;&#160;(!!((k)-&gt;arch.vgic.in_kernel))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00392">392</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a51fde4189b74866c5fa5f3c77ee815a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51fde4189b74866c5fa5f3c77ee815a1">&#9670;&nbsp;</a></span>KVM_IRQCHIP_NUM_PINS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KVM_IRQCHIP_NUM_PINS&#160;&#160;&#160;(1020 - 32)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00032">32</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a6daa21682a97a3422d97c115dd1007df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6daa21682a97a3422d97c115dd1007df">&#9670;&nbsp;</a></span>KVM_VGIC_IMP_REV_2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KVM_VGIC_IMP_REV_2&#160;&#160;&#160;2 /* GICv2 restorable groups */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00234">234</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a293e90343d1998f9cc3af273e62caa8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a293e90343d1998f9cc3af273e62caa8a">&#9670;&nbsp;</a></span>KVM_VGIC_IMP_REV_3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KVM_VGIC_IMP_REV_3&#160;&#160;&#160;3 /* GICv3 GICR_CTLR.{IW,CES,RWP} */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00235">235</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a3bd5ea551d855097a6f0bd86e46dbfb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bd5ea551d855097a6f0bd86e46dbfb2">&#9670;&nbsp;</a></span>KVM_VGIC_IMP_REV_LATEST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KVM_VGIC_IMP_REV_LATEST&#160;&#160;&#160;<a class="el" href="arm__vgic_8h.html#a293e90343d1998f9cc3af273e62caa8a">KVM_VGIC_IMP_REV_3</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00236">236</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a92f7a5b2fbbd6b57aaed08e61ba34d43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92f7a5b2fbbd6b57aaed08e61ba34d43">&#9670;&nbsp;</a></span>vgic_initialized</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define vgic_initialized</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">k</td><td>)</td>
          <td>&#160;&#160;&#160;((k)-&gt;arch.vgic.initialized)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00393">393</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a9c3e9820ba029d65cf7800d0cb4964be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c3e9820ba029d65cf7800d0cb4964be">&#9670;&nbsp;</a></span>VGIC_IRQ_SW_RESAMPLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_IRQ_SW_RESAMPLE&#160;&#160;&#160;BIT(0)	/* Clear the active state for resampling */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00107">107</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="add3f1f00371cf528cb8ffac2642d4ee3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add3f1f00371cf528cb8ffac2642d4ee3">&#9670;&nbsp;</a></span>VGIC_MAX_PRIVATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_MAX_PRIVATE&#160;&#160;&#160;(<a class="el" href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a> - 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00028">28</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="ad7342134b684299f69395eee1e4fbc05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7342134b684299f69395eee1e4fbc05">&#9670;&nbsp;</a></span>VGIC_MAX_RESERVED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_MAX_RESERVED&#160;&#160;&#160;1023</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00030">30</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="aafd3fd440e6d69c6d2649cfe0023e34c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafd3fd440e6d69c6d2649cfe0023e34c">&#9670;&nbsp;</a></span>VGIC_MAX_SPI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_MAX_SPI&#160;&#160;&#160;1019</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00029">29</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a34000cd3b6c53a8b7848df48d97271cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34000cd3b6c53a8b7848df48d97271cb">&#9670;&nbsp;</a></span>VGIC_MIN_LPI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_MIN_LPI&#160;&#160;&#160;8192</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00031">31</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a00cb0b5b22477a7cc824de820da0934a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00cb0b5b22477a7cc824de820da0934a">&#9670;&nbsp;</a></span>VGIC_NR_IRQS_LEGACY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_NR_IRQS_LEGACY&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00024">24</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a0030e1d724372943f190b24f0150b223"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0030e1d724372943f190b24f0150b223">&#9670;&nbsp;</a></span>VGIC_NR_PPIS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_NR_PPIS&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00026">26</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="ae9d406cdd3eafd831ee41ecf0e48011e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9d406cdd3eafd831ee41ecf0e48011e">&#9670;&nbsp;</a></span>VGIC_NR_PRIVATE_IRQS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_NR_PRIVATE_IRQS&#160;&#160;&#160;(<a class="el" href="arm__vgic_8h.html#a8143b35cbc0236b1f9fd65b9062ae523">VGIC_NR_SGIS</a> + <a class="el" href="arm__vgic_8h.html#a0030e1d724372943f190b24f0150b223">VGIC_NR_PPIS</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00027">27</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a8143b35cbc0236b1f9fd65b9062ae523"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8143b35cbc0236b1f9fd65b9062ae523">&#9670;&nbsp;</a></span>VGIC_NR_SGIS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_NR_SGIS&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00025">25</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a8a1cb81c34b893dec2bef262c6fafb15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a1cb81c34b893dec2bef262c6fafb15">&#9670;&nbsp;</a></span>vgic_ready</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define vgic_ready</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">k</td><td>)</td>
          <td>&#160;&#160;&#160;((k)-&gt;arch.vgic.ready)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00394">394</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a919dfd28be18085c0df4a1e66f3663f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a919dfd28be18085c0df4a1e66f3663f5">&#9670;&nbsp;</a></span>VGIC_V2_MAX_CPUS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_V2_MAX_CPUS&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00023">23</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="abbc743cbfefbb1b95655e63b7505b48f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbc743cbfefbb1b95655e63b7505b48f">&#9670;&nbsp;</a></span>VGIC_V2_MAX_LRS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_V2_MAX_LRS&#160;&#160;&#160;(1 &lt;&lt; 6)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00088">88</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a5272f1910695fe8e411dc283b72faabc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5272f1910695fe8e411dc283b72faabc">&#9670;&nbsp;</a></span>VGIC_V3_LR_INDEX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_V3_LR_INDEX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lr</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="arm__vgic_8h.html#ab7bff1a16cbcc734e62caae7ec19b36e">VGIC_V3_MAX_LRS</a> - 1 - lr)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00090">90</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="a068e6ffdc2074e5125c730fb51f9f2ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a068e6ffdc2074e5125c730fb51f9f2ca">&#9670;&nbsp;</a></span>VGIC_V3_MAX_CPUS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_V3_MAX_CPUS&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00022">22</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="ab7bff1a16cbcc734e62caae7ec19b36e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7bff1a16cbcc734e62caae7ec19b36e">&#9670;&nbsp;</a></span>VGIC_V3_MAX_LRS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VGIC_V3_MAX_LRS&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00089">89</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<a id="adea629c518405f94a45bbe647ef71fcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea629c518405f94a45bbe647ef71fcc">&#9670;&nbsp;</a></span>vgic_valid_spi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define vgic_valid_spi</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">k, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">            (((i) &gt;= <a class="code" href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a>) &amp;&amp; \</div>
<div class="line">            ((i) &lt; (k)-&gt;arch.vgic.nr_spis + <a class="code" href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a>))</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00395">395</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a7d55542a11eb56d7d2c093ce5e75e885"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d55542a11eb56d7d2c093ce5e75e885">&#9670;&nbsp;</a></span>iodev_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885">iodev_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a7d55542a11eb56d7d2c093ce5e75e885ac67dc30122cf1e2ff45ce17ead4d71db"></a>IODEV_CPUIF&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7d55542a11eb56d7d2c093ce5e75e885ac68240095de34962ed690f571683d0df"></a>IODEV_DIST&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7d55542a11eb56d7d2c093ce5e75e885a34e159d88b4995a38067b96166de01e3"></a>IODEV_REDIST&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7d55542a11eb56d7d2c093ce5e75e885a3c8e2fe20770015f7d22a9a666e3a8fd"></a>IODEV_ITS&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00168">168</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885ac67dc30122cf1e2ff45ce17ead4d71db">IODEV_CPUIF</a>,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885ac68240095de34962ed690f571683d0df">IODEV_DIST</a>,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885a34e159d88b4995a38067b96166de01e3">IODEV_REDIST</a>,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885a3c8e2fe20770015f7d22a9a666e3a8fd">IODEV_ITS</a></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;};</div>
<div class="ttc" id="aarm__vgic_8h_html_a7d55542a11eb56d7d2c093ce5e75e885a34e159d88b4995a38067b96166de01e3"><div class="ttname"><a href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885a34e159d88b4995a38067b96166de01e3">IODEV_REDIST</a></div><div class="ttdeci">@ IODEV_REDIST</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00171">arm_vgic.h:171</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_a7d55542a11eb56d7d2c093ce5e75e885a3c8e2fe20770015f7d22a9a666e3a8fd"><div class="ttname"><a href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885a3c8e2fe20770015f7d22a9a666e3a8fd">IODEV_ITS</a></div><div class="ttdeci">@ IODEV_ITS</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00173">arm_vgic.h:172</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_a7d55542a11eb56d7d2c093ce5e75e885ac67dc30122cf1e2ff45ce17ead4d71db"><div class="ttname"><a href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885ac67dc30122cf1e2ff45ce17ead4d71db">IODEV_CPUIF</a></div><div class="ttdeci">@ IODEV_CPUIF</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00169">arm_vgic.h:169</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_a7d55542a11eb56d7d2c093ce5e75e885ac68240095de34962ed690f571683d0df"><div class="ttname"><a href="arm__vgic_8h.html#a7d55542a11eb56d7d2c093ce5e75e885ac68240095de34962ed690f571683d0df">IODEV_DIST</a></div><div class="ttdeci">@ IODEV_DIST</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00170">arm_vgic.h:170</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a23952420a7fea6ce35df942e6b0783e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23952420a7fea6ce35df942e6b0783e7">&#9670;&nbsp;</a></span>vgic_irq_config</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7">vgic_irq_config</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a23952420a7fea6ce35df942e6b0783e7adc1b4a2895063d95a6a3aef89da15915"></a>VGIC_CONFIG_EDGE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a23952420a7fea6ce35df942e6b0783e7aff766918bb2eff9dbb94c4edea188a2a"></a>VGIC_CONFIG_LEVEL&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00092">92</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                     {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7adc1b4a2895063d95a6a3aef89da15915">VGIC_CONFIG_EDGE</a> = 0,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7aff766918bb2eff9dbb94c4edea188a2a">VGIC_CONFIG_LEVEL</a></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;};</div>
<div class="ttc" id="aarm__vgic_8h_html_a23952420a7fea6ce35df942e6b0783e7adc1b4a2895063d95a6a3aef89da15915"><div class="ttname"><a href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7adc1b4a2895063d95a6a3aef89da15915">VGIC_CONFIG_EDGE</a></div><div class="ttdeci">@ VGIC_CONFIG_EDGE</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00093">arm_vgic.h:93</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_a23952420a7fea6ce35df942e6b0783e7aff766918bb2eff9dbb94c4edea188a2a"><div class="ttname"><a href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7aff766918bb2eff9dbb94c4edea188a2a">VGIC_CONFIG_LEVEL</a></div><div class="ttdeci">@ VGIC_CONFIG_LEVEL</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00095">arm_vgic.h:94</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e40915cc9873f08ca702678ce237ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e40915cc9873f08ca702678ce237ff1">&#9670;&nbsp;</a></span>vgic_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1">vgic_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a6e40915cc9873f08ca702678ce237ff1a9516eb794b5e9d2d4817bb361c699a60"></a>VGIC_V2&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a6e40915cc9873f08ca702678ce237ff1a6556967af9084ab2c8d36e7faf368d1e"></a>VGIC_V3&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00038">38</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;               {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a9516eb794b5e9d2d4817bb361c699a60">VGIC_V2</a>,        <span class="comment">/* Good ol&#39; GICv2 */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a6556967af9084ab2c8d36e7faf368d1e">VGIC_V3</a>,        <span class="comment">/* New fancy GICv3 */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;};</div>
<div class="ttc" id="aarm__vgic_8h_html_a6e40915cc9873f08ca702678ce237ff1a6556967af9084ab2c8d36e7faf368d1e"><div class="ttname"><a href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a6556967af9084ab2c8d36e7faf368d1e">VGIC_V3</a></div><div class="ttdeci">@ VGIC_V3</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00040">arm_vgic.h:40</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_a6e40915cc9873f08ca702678ce237ff1a9516eb794b5e9d2d4817bb361c699a60"><div class="ttname"><a href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a9516eb794b5e9d2d4817bb361c699a60">VGIC_V2</a></div><div class="ttdeci">@ VGIC_V2</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00039">arm_vgic.h:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7808d55ba83902bd478febfc33334d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7808d55ba83902bd478febfc33334d5d">&#9670;&nbsp;</a></span>kvm_set_legacy_vgic_v2_addr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_set_legacy_vgic_v2_addr </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_arm_device_addr *&#160;</td>
          <td class="paramname"><em>dev_addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic-kvm-device_8c_source.html#l00045">45</a> of file <a class="el" href="vgic-kvm-device_8c_source.html">vgic-kvm-device.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__dist.html">vgic_dist</a> *vgic = &amp;kvm-&gt;arch.vgic;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    mutex_lock(&amp;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">switch</span> (FIELD_GET(KVM_ARM_DEVICE_TYPE_MASK, dev_addr-&gt;id)) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">case</span> KVM_VGIC_V2_ADDR_TYPE_DIST:</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        r = <a class="code" href="vgic-kvm-device_8c.html#aabe1882d024943ea3d42bd37678f437f">vgic_check_type</a>(kvm, KVM_DEV_TYPE_ARM_VGIC_V2);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span> (!r)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            r = <a class="code" href="vgic-kvm-device_8c.html#af0cfcc44a93abc13df9a7e364c21cf32">vgic_check_iorange</a>(kvm, vgic-&gt;<a class="code" href="structvgic__dist.html#a64889fb78fa1c835d635165bdc9dbe6e">vgic_dist_base</a>, dev_addr-&gt;addr,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                           SZ_4K, KVM_VGIC_V2_DIST_SIZE);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">if</span> (!r)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            vgic-&gt;<a class="code" href="structvgic__dist.html#a64889fb78fa1c835d635165bdc9dbe6e">vgic_dist_base</a> = dev_addr-&gt;addr;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">case</span> KVM_VGIC_V2_ADDR_TYPE_CPU:</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        r = <a class="code" href="vgic-kvm-device_8c.html#aabe1882d024943ea3d42bd37678f437f">vgic_check_type</a>(kvm, KVM_DEV_TYPE_ARM_VGIC_V2);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">if</span> (!r)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            r = <a class="code" href="vgic-kvm-device_8c.html#af0cfcc44a93abc13df9a7e364c21cf32">vgic_check_iorange</a>(kvm, vgic-&gt;<a class="code" href="structvgic__dist.html#adfde4e406677fb7d0457aa686d4dfe86">vgic_cpu_base</a>, dev_addr-&gt;addr,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                           SZ_4K, KVM_VGIC_V2_CPU_SIZE);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">if</span> (!r)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            vgic-&gt;<a class="code" href="structvgic__dist.html#adfde4e406677fb7d0457aa686d4dfe86">vgic_cpu_base</a> = dev_addr-&gt;addr;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        r = -ENODEV;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    mutex_unlock(&amp;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
<div class="ttc" id="astructvgic__dist_html"><div class="ttname"><a href="structvgic__dist.html">vgic_dist</a></div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00224">arm_vgic.h:224</a></div></div>
<div class="ttc" id="astructvgic__dist_html_a64889fb78fa1c835d635165bdc9dbe6e"><div class="ttname"><a href="structvgic__dist.html#a64889fb78fa1c835d635165bdc9dbe6e">vgic_dist::vgic_dist_base</a></div><div class="ttdeci">gpa_t vgic_dist_base</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00247">arm_vgic.h:247</a></div></div>
<div class="ttc" id="astructvgic__dist_html_adfde4e406677fb7d0457aa686d4dfe86"><div class="ttname"><a href="structvgic__dist.html#adfde4e406677fb7d0457aa686d4dfe86">vgic_dist::vgic_cpu_base</a></div><div class="ttdeci">gpa_t vgic_cpu_base</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00250">arm_vgic.h:250</a></div></div>
<div class="ttc" id="avgic-kvm-device_8c_html_aabe1882d024943ea3d42bd37678f437f"><div class="ttname"><a href="vgic-kvm-device_8c.html#aabe1882d024943ea3d42bd37678f437f">vgic_check_type</a></div><div class="ttdeci">static int vgic_check_type(struct kvm *kvm, int type_needed)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-kvm-device_8c_source.html#l00037">vgic-kvm-device.c:37</a></div></div>
<div class="ttc" id="avgic-kvm-device_8c_html_af0cfcc44a93abc13df9a7e364c21cf32"><div class="ttname"><a href="vgic-kvm-device_8c.html#af0cfcc44a93abc13df9a7e364c21cf32">vgic_check_iorange</a></div><div class="ttdeci">int vgic_check_iorange(struct kvm *kvm, phys_addr_t ioaddr, phys_addr_t addr, phys_addr_t alignment, phys_addr_t size)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-kvm-device_8c_source.html#l00017">vgic-kvm-device.c:17</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a7808d55ba83902bd478febfc33334d5d_cgraph.png" border="0" usemap="#aarm__vgic_8h_a7808d55ba83902bd478febfc33334d5d_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a7808d55ba83902bd478febfc33334d5d_cgraph" id="aarm__vgic_8h_a7808d55ba83902bd478febfc33334d5d_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,168,65"/>
<area shape="rect" href="vgic-kvm-device_8c.html#af0cfcc44a93abc13df9a7e364c21cf32" title=" " alt="" coords="216,5,367,32"/>
<area shape="rect" href="vgic-kvm-device_8c.html#aabe1882d024943ea3d42bd37678f437f" title=" " alt="" coords="226,56,357,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a7808d55ba83902bd478febfc33334d5d_icgraph.png" border="0" usemap="#aarm__vgic_8h_a7808d55ba83902bd478febfc33334d5d_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a7808d55ba83902bd478febfc33334d5d_icgraph" id="aarm__vgic_8h_a7808d55ba83902bd478febfc33334d5d_icgraph">
<area shape="rect" title=" " alt="" coords="477,5,640,47"/>
<area shape="rect" href="arm_8c.html#a18aad074e49e8bedf16bff2daee6fc5d" title=" " alt="" coords="203,13,429,39"/>
<area shape="rect" href="arm_8c.html#a10224987f77e7370dd9f2b80352544ab" title=" " alt="" coords="5,13,155,39"/>
</map>
</div>

</div>
</div>
<a id="a15be17d3a67e2b955c81aca0a2c20708"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15be17d3a67e2b955c81aca0a2c20708">&#9670;&nbsp;</a></span>kvm_vcpu_has_pending_irqs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kvm_vcpu_has_pending_irqs </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a17cbfdbbcbf19c731724a5e5cb9583d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17cbfdbbcbf19c731724a5e5cb9583d8">&#9670;&nbsp;</a></span>kvm_vgic_cpu_down()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_cpu_down </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic-init_8c_source.html#l00513">513</a> of file <a class="el" href="vgic-init_8c_source.html">vgic-init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;{</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    disable_percpu_irq(<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a6b6542d30feaef74e3cf49f50783f942">maint_irq</a>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div>
<div class="ttc" id="aarm__vgic_8h_html_a53b0ff890074ba3dc4b1bed11a236394"><div class="ttname"><a href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a></div><div class="ttdeci">struct vgic_global kvm_vgic_global_state</div></div>
<div class="ttc" id="astructvgic__global_html_a6b6542d30feaef74e3cf49f50783f942"><div class="ttname"><a href="structvgic__global.html#a6b6542d30feaef74e3cf49f50783f942">vgic_global::maint_irq</a></div><div class="ttdeci">unsigned int maint_irq</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00065">arm_vgic.h:65</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a17cbfdbbcbf19c731724a5e5cb9583d8_icgraph.png" border="0" usemap="#aarm__vgic_8h_a17cbfdbbcbf19c731724a5e5cb9583d8_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a17cbfdbbcbf19c731724a5e5cb9583d8_icgraph" id="aarm__vgic_8h_a17cbfdbbcbf19c731724a5e5cb9583d8_icgraph">
<area shape="rect" title=" " alt="" coords="261,5,419,32"/>
<area shape="rect" href="arm_8c.html#ad6968510b101877130dc9494f5dc4d4b" title=" " alt="" coords="5,5,213,32"/>
</map>
</div>

</div>
</div>
<a id="a575388855c33993ba44e8e4bd2511fb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a575388855c33993ba44e8e4bd2511fb6">&#9670;&nbsp;</a></span>kvm_vgic_cpu_up()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_cpu_up </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic-init_8c_source.html#l00507">507</a> of file <a class="el" href="vgic-init_8c_source.html">vgic-init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;{</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    enable_percpu_irq(<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a6b6542d30feaef74e3cf49f50783f942">maint_irq</a>, 0);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a575388855c33993ba44e8e4bd2511fb6_icgraph.png" border="0" usemap="#aarm__vgic_8h_a575388855c33993ba44e8e4bd2511fb6_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a575388855c33993ba44e8e4bd2511fb6_icgraph" id="aarm__vgic_8h_a575388855c33993ba44e8e4bd2511fb6_icgraph">
<area shape="rect" title=" " alt="" coords="259,5,397,32"/>
<area shape="rect" href="arm_8c.html#ac1582780a8801f86aa06da8b95cbcfe9" title=" " alt="" coords="5,5,211,32"/>
</map>
</div>

</div>
</div>
<a id="a4ce1b5a14cd479b726e5451691380615"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ce1b5a14cd479b726e5451691380615">&#9670;&nbsp;</a></span>kvm_vgic_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_create </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>kvm_vgic_create: triggered by the instantiation of the VGIC device by user space, either through the legacy KVM_CREATE_IRQCHIP ioctl (v2 only) or through the generic KVM_CREATE_DEVICE API ioctl. <a class="el" href="arm__vgic_8h.html#a28961fa9a6313f335b274e0fac503bcf">irqchip_in_kernel()</a> tells you if this function succeeded or not. @kvm: kvm struct pointer @type: KVM_DEV_TYPE_ARM_VGIC_V[23] </p>

<p class="definition">Definition at line <a class="el" href="vgic-init_8c_source.html#l00071">71</a> of file <a class="el" href="vgic-init_8c_source.html">vgic-init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">     * This function is also called by the KVM_CREATE_IRQCHIP handler,</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">     * which had no chance yet to check the availability of the GICv2</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">     * emulation. So check this here again. KVM_CREATE_DEVICE does</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">     * the proper checks already.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> (type == KVM_DEV_TYPE_ARM_VGIC_V2 &amp;&amp;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        !<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a16b442a8086577a9f8ecae193f016e62">can_emulate_gicv2</a>)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">return</span> -ENODEV;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">/* Must be held to avoid race with vCPU creation */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    lockdep_assert_held(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    ret = -EBUSY;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arm_8c.html#a02feef111fec875eb6382835eb2fb620">lock_all_vcpus</a>(kvm))</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    mutex_lock(&amp;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arm__vgic_8h.html#a28961fa9a6313f335b274e0fac503bcf">irqchip_in_kernel</a>(kvm)) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        ret = -EEXIST;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">goto</span> out_unlock;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    kvm_for_each_vcpu(i, vcpu, kvm) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">if</span> (vcpu_has_run_once(vcpu))</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">goto</span> out_unlock;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    ret = 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span> (type == KVM_DEV_TYPE_ARM_VGIC_V2)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        kvm-&gt;max_vcpus = <a class="code" href="arm__vgic_8h.html#a919dfd28be18085c0df4a1e66f3663f5">VGIC_V2_MAX_CPUS</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        kvm-&gt;max_vcpus = <a class="code" href="arm__vgic_8h.html#a068e6ffdc2074e5125c730fb51f9f2ca">VGIC_V3_MAX_CPUS</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (atomic_read(&amp;kvm-&gt;online_vcpus) &gt; kvm-&gt;max_vcpus) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        ret = -E2BIG;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">goto</span> out_unlock;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    kvm-&gt;arch.vgic.in_kernel = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    kvm-&gt;arch.vgic.vgic_model = type;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    kvm-&gt;arch.vgic.vgic_dist_base = <a class="code" href="vgic_8h.html#ac91699b3ab8faf4d5222d998fb64b033">VGIC_ADDR_UNDEF</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (type == KVM_DEV_TYPE_ARM_VGIC_V2)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        kvm-&gt;arch.vgic.vgic_cpu_base = <a class="code" href="vgic_8h.html#ac91699b3ab8faf4d5222d998fb64b033">VGIC_ADDR_UNDEF</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        INIT_LIST_HEAD(&amp;kvm-&gt;arch.vgic.rd_regions);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;out_unlock:</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    mutex_unlock(&amp;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="arm_8c.html#a29e56a77bf87bcd1b20ed8a14d9b2778">unlock_all_vcpus</a>(kvm);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="ttc" id="aarm_8c_html_a02feef111fec875eb6382835eb2fb620"><div class="ttname"><a href="arm_8c.html#a02feef111fec875eb6382835eb2fb620">lock_all_vcpus</a></div><div class="ttdeci">bool lock_all_vcpus(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="arm_8c_source.html#l01773">arm.c:1773</a></div></div>
<div class="ttc" id="aarm_8c_html_a29e56a77bf87bcd1b20ed8a14d9b2778"><div class="ttname"><a href="arm_8c.html#a29e56a77bf87bcd1b20ed8a14d9b2778">unlock_all_vcpus</a></div><div class="ttdeci">void unlock_all_vcpus(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="arm_8c_source.html#l01765">arm.c:1765</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_a068e6ffdc2074e5125c730fb51f9f2ca"><div class="ttname"><a href="arm__vgic_8h.html#a068e6ffdc2074e5125c730fb51f9f2ca">VGIC_V3_MAX_CPUS</a></div><div class="ttdeci">#define VGIC_V3_MAX_CPUS</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00022">arm_vgic.h:22</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_a28961fa9a6313f335b274e0fac503bcf"><div class="ttname"><a href="arm__vgic_8h.html#a28961fa9a6313f335b274e0fac503bcf">irqchip_in_kernel</a></div><div class="ttdeci">#define irqchip_in_kernel(k)</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00392">arm_vgic.h:392</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_a919dfd28be18085c0df4a1e66f3663f5"><div class="ttname"><a href="arm__vgic_8h.html#a919dfd28be18085c0df4a1e66f3663f5">VGIC_V2_MAX_CPUS</a></div><div class="ttdeci">#define VGIC_V2_MAX_CPUS</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00023">arm_vgic.h:23</a></div></div>
<div class="ttc" id="astructvgic__global_html_a16b442a8086577a9f8ecae193f016e62"><div class="ttname"><a href="structvgic__global.html#a16b442a8086577a9f8ecae193f016e62">vgic_global::can_emulate_gicv2</a></div><div class="ttdeci">bool can_emulate_gicv2</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00071">arm_vgic.h:71</a></div></div>
<div class="ttc" id="avgic_8h_html_ac91699b3ab8faf4d5222d998fb64b033"><div class="ttname"><a href="vgic_8h.html#ac91699b3ab8faf4d5222d998fb64b033">VGIC_ADDR_UNDEF</a></div><div class="ttdeci">#define VGIC_ADDR_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8h_source.html#l00014">vgic.h:14</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a4ce1b5a14cd479b726e5451691380615_cgraph.png" border="0" usemap="#aarm__vgic_8h_a4ce1b5a14cd479b726e5451691380615_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a4ce1b5a14cd479b726e5451691380615_cgraph" id="aarm__vgic_8h_a4ce1b5a14cd479b726e5451691380615_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,139,57"/>
<area shape="rect" href="arm_8c.html#a02feef111fec875eb6382835eb2fb620" title=" " alt="" coords="195,5,312,32"/>
<area shape="rect" href="arm_8c.html#a29e56a77bf87bcd1b20ed8a14d9b2778" title=" " alt="" coords="187,56,320,83"/>
<area shape="rect" href="arm_8c.html#ac85c173d1f7208735e68f95eec2aac14" title=" " alt="" coords="368,31,479,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a4ce1b5a14cd479b726e5451691380615_icgraph.png" border="0" usemap="#aarm__vgic_8h_a4ce1b5a14cd479b726e5451691380615_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a4ce1b5a14cd479b726e5451691380615_icgraph" id="aarm__vgic_8h_a4ce1b5a14cd479b726e5451691380615_icgraph">
<area shape="rect" title=" " alt="" coords="203,31,336,57"/>
<area shape="rect" href="arm_8c.html#a10224987f77e7370dd9f2b80352544ab" title=" " alt="" coords="5,5,155,32"/>
<area shape="rect" href="vgic-kvm-device_8c.html#a4a03bcf8c61b3397194a8fba37f06f1c" title=" " alt="" coords="31,56,129,83"/>
</map>
</div>

</div>
</div>
<a id="af08e0c3b0309dbe4472ed185cd2b9e72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af08e0c3b0309dbe4472ed185cd2b9e72">&#9670;&nbsp;</a></span>kvm_vgic_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_destroy </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic-init_8c_source.html#l00397">397</a> of file <a class="el" href="vgic-init_8c_source.html">vgic-init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;{</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    mutex_lock(&amp;kvm-&gt;slots_lock);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="vgic-debug_8c.html#a09b8e6f769f95e9667a93dde826b0e1e">vgic_debug_destroy</a>(kvm);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    kvm_for_each_vcpu(i, vcpu, kvm)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="vgic-init_8c.html#a1002af084b5fbafca1dab97541383180">__kvm_vgic_vcpu_destroy</a>(vcpu);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    mutex_lock(&amp;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="vgic-init_8c.html#a814da4f59c826266ad54a8b5aa870de6">kvm_vgic_dist_destroy</a>(kvm);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    mutex_unlock(&amp;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    mutex_unlock(&amp;kvm-&gt;slots_lock);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="ttc" id="avgic-debug_8c_html_a09b8e6f769f95e9667a93dde826b0e1e"><div class="ttname"><a href="vgic-debug_8c.html#a09b8e6f769f95e9667a93dde826b0e1e">vgic_debug_destroy</a></div><div class="ttdeci">void vgic_debug_destroy(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-debug_8c_source.html#l00278">vgic-debug.c:278</a></div></div>
<div class="ttc" id="avgic-init_8c_html_a1002af084b5fbafca1dab97541383180"><div class="ttname"><a href="vgic-init_8c.html#a1002af084b5fbafca1dab97541383180">__kvm_vgic_vcpu_destroy</a></div><div class="ttdeci">static void __kvm_vgic_vcpu_destroy(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-init_8c_source.html#l00371">vgic-init.c:371</a></div></div>
<div class="ttc" id="avgic-init_8c_html_a814da4f59c826266ad54a8b5aa870de6"><div class="ttname"><a href="vgic-init_8c.html#a814da4f59c826266ad54a8b5aa870de6">kvm_vgic_dist_destroy</a></div><div class="ttdeci">static void kvm_vgic_dist_destroy(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-init_8c_source.html#l00343">vgic-init.c:343</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_af08e0c3b0309dbe4472ed185cd2b9e72_cgraph.png" border="0" usemap="#aarm__vgic_8h_af08e0c3b0309dbe4472ed185cd2b9e72_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_af08e0c3b0309dbe4472ed185cd2b9e72_cgraph" id="aarm__vgic_8h_af08e0c3b0309dbe4472ed185cd2b9e72_cgraph">
<area shape="rect" title=" " alt="" coords="5,214,147,241"/>
<area shape="rect" href="vgic-init_8c.html#a1002af084b5fbafca1dab97541383180" title=" " alt="" coords="195,71,388,98"/>
<area shape="rect" href="vgic-init_8c.html#a814da4f59c826266ad54a8b5aa870de6" title=" " alt="" coords="205,214,377,241"/>
<area shape="rect" href="vgic-debug_8c.html#a09b8e6f769f95e9667a93dde826b0e1e" title=" " alt="" coords="215,265,367,291"/>
<area shape="rect" href="vgic_8c.html#a573eb768a56ea0b73e234771e0013ffc" title=" " alt="" coords="445,71,621,98"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a4bfec769cd9fe2bddb14200a6147fccd" title=" " alt="" coords="450,5,617,47"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="730,142,831,169"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="931,193,1093,219"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="1171,193,1299,219"/>
<area shape="rect" href="kvm__main_8c.html#a103c02eb7ca545106f3130776c2a8897" title=" " alt="" coords="679,13,883,39"/>
<area shape="rect" href="kvm__main_8c.html#a3089edf2c0e5790aab7e8ed723f34b5b" title=" " alt="" coords="934,38,1090,65"/>
<area shape="rect" href="kvm__main_8c.html#aa6d7dea09a0b657f29e92f424e5d0633" title=" " alt="" coords="1141,13,1328,39"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="729,265,832,291"/>
<area shape="rect" href="vgic-its_8c.html#a58207180090221f6c6529d3c4acad96b" title=" " alt="" coords="459,341,608,383"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="436,290,631,317"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#ac2164da472839a705dfb81d3a3c477c5" title=" " alt="" coords="459,123,608,164"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="463,189,603,215"/>
<area shape="rect" href="vgic-its_8c.html#a922a99eb2d73f90e4fcb4cf7c52f0518" title=" " alt="" coords="709,328,853,369"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_af08e0c3b0309dbe4472ed185cd2b9e72_icgraph.png" border="0" usemap="#aarm__vgic_8h_af08e0c3b0309dbe4472ed185cd2b9e72_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_af08e0c3b0309dbe4472ed185cd2b9e72_icgraph" id="aarm__vgic_8h_af08e0c3b0309dbe4472ed185cd2b9e72_icgraph">
<area shape="rect" title=" " alt="" coords="1093,111,1235,137"/>
<area shape="rect" href="arm_8c.html#ad84dda268db5d48c48f3ef2f438c62a7" title=" " alt="" coords="865,81,1035,108"/>
<area shape="rect" href="vgic-init_8c.html#a8411f235847aa56055a7a2fefce226c6" title=" " alt="" coords="855,136,1045,163"/>
<area shape="rect" href="kvm__main_8c.html#a54b22e6be98d31db1a83e7993fbcf4bc" title=" " alt="" coords="453,29,580,56"/>
<area shape="rect" href="kvm__main_8c.html#afd922c538c448ab1248cdb9dccae9410" title=" " alt="" coords="650,81,785,108"/>
<area shape="rect" href="kvm__main_8c.html#a955de4f2a1b3371438636eccab732b27" title=" " alt="" coords="212,5,405,32"/>
<area shape="rect" href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241" title=" " alt="" coords="459,84,574,111"/>
<area shape="rect" href="kvm__main_8c.html#a37fa7805021941c56fe174eae4c8c377" title=" " alt="" coords="234,56,383,83"/>
<area shape="rect" href="kvm__main_8c.html#af19040bdcea372f13eab66499d99201c" title=" " alt="" coords="226,107,391,133"/>
<area shape="rect" href="guest__memfd_8c.html#ad8912fbda61cdcb6d9e5a3c0f839e001" title=" " alt="" coords="231,157,386,184"/>
<area shape="rect" href="kvm__main_8c.html#af67afbdcee89641f21573ac643d8e693" title=" " alt="" coords="241,208,376,235"/>
<area shape="rect" href="kvm__main_8c.html#a87bcafdc42ee32aedb84df5e564f9872" title=" " alt="" coords="5,56,164,83"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="628,133,807,174"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="455,140,579,167"/>
</map>
</div>

</div>
</div>
<a id="ab923d47040c4f3c9e6cae619d7abf78a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab923d47040c4f3c9e6cae619d7abf78a">&#9670;&nbsp;</a></span>kvm_vgic_early_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_early_init </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="vgic-init_8c.html#ab923d47040c4f3c9e6cae619d7abf78a">kvm_vgic_early_init()</a> - Initialize static VGIC VCPU data structures @kvm: The VM whose VGIC districutor should be initialized</p>
<p>Only do initialization of static structures that don't require any allocation or sizing information from userspace. <a class="el" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57">vgic_init()</a> called <a class="el" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b">kvm_vgic_dist_init()</a> which takes care of the rest. </p>

<p class="definition">Definition at line <a class="el" href="vgic-init_8c_source.html#l00052">52</a> of file <a class="el" href="vgic-init_8c_source.html">vgic-init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__dist.html">vgic_dist</a> *dist = &amp;kvm-&gt;arch.vgic;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    INIT_LIST_HEAD(&amp;dist-&gt;<a class="code" href="structvgic__dist.html#a41b71b86155517bd43be90dedcd8aa9b">lpi_list_head</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    INIT_LIST_HEAD(&amp;dist-&gt;<a class="code" href="structvgic__dist.html#a3cbde77e1197df9fecb11c6792b84e31">lpi_translation_cache</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    raw_spin_lock_init(&amp;dist-&gt;<a class="code" href="structvgic__dist.html#aab5196ec6b7714bd2ce8628070a7c0cb">lpi_list_lock</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div>
<div class="ttc" id="astructvgic__dist_html_a3cbde77e1197df9fecb11c6792b84e31"><div class="ttname"><a href="structvgic__dist.html#a3cbde77e1197df9fecb11c6792b84e31">vgic_dist::lpi_translation_cache</a></div><div class="ttdeci">struct list_head lpi_translation_cache</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00279">arm_vgic.h:282</a></div></div>
<div class="ttc" id="astructvgic__dist_html_a41b71b86155517bd43be90dedcd8aa9b"><div class="ttname"><a href="structvgic__dist.html#a41b71b86155517bd43be90dedcd8aa9b">vgic_dist::lpi_list_head</a></div><div class="ttdeci">struct list_head lpi_list_head</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00277">arm_vgic.h:278</a></div></div>
<div class="ttc" id="astructvgic__dist_html_aab5196ec6b7714bd2ce8628070a7c0cb"><div class="ttname"><a href="structvgic__dist.html#aab5196ec6b7714bd2ce8628070a7c0cb">vgic_dist::lpi_list_lock</a></div><div class="ttdeci">raw_spinlock_t lpi_list_lock</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00277">arm_vgic.h:277</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_ab923d47040c4f3c9e6cae619d7abf78a_icgraph.png" border="0" usemap="#aarm__vgic_8h_ab923d47040c4f3c9e6cae619d7abf78a_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_ab923d47040c4f3c9e6cae619d7abf78a_icgraph" id="aarm__vgic_8h_ab923d47040c4f3c9e6cae619d7abf78a_icgraph">
<area shape="rect" title=" " alt="" coords="612,5,765,32"/>
<area shape="rect" href="arm_8c.html#a78b266c18dac3b9edbea80941c96e2cd" title=" " alt="" coords="421,5,564,32"/>
<area shape="rect" href="kvm__main_8c.html#a54b22e6be98d31db1a83e7993fbcf4bc" title=" " alt="" coords="247,5,373,32"/>
<area shape="rect" href="kvm__main_8c.html#a955de4f2a1b3371438636eccab732b27" title=" " alt="" coords="5,5,199,32"/>
</map>
</div>

</div>
</div>
<a id="a5fb6266a1f361c1945f5feb862c1cf31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fb6266a1f361c1945f5feb862c1cf31">&#9670;&nbsp;</a></span>kvm_vgic_flush_hwstate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_flush_hwstate </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00905">905</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;{</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">     * If there are no virtual interrupts active or pending for this</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">     * VCPU, then there is no work to do and we can bail out without</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">     * taking any lock.  There is a potential race with someone injecting</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">     * interrupts to the VCPU, but it is a benign race as the VCPU will</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">     * either observe the new interrupt before or after doing this check,</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">     * and introducing additional synchronization mechanism doesn&#39;t change</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">     * this.</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">     * Note that we still need to go through the whole thing if anything</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">     * can be directly injected (GICv4).</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (list_empty(&amp;vcpu-&gt;arch.vgic_cpu.ap_list_head) &amp;&amp;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        !<a class="code" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f">vgic_supports_direct_msis</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <a class="code" href="vgic_8h.html#a0e2b76dd7108772ed1441b1e64f0be4b">DEBUG_SPINLOCK_BUG_ON</a>(!irqs_disabled());</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">if</span> (!list_empty(&amp;vcpu-&gt;arch.vgic_cpu.ap_list_head)) {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        raw_spin_lock(&amp;vcpu-&gt;arch.vgic_cpu.ap_list_lock);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <a class="code" href="vgic_8c.html#a498227d2a82836ba11a046b68857e3a3">vgic_flush_lr_state</a>(vcpu);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        raw_spin_unlock(&amp;vcpu-&gt;arch.vgic_cpu.ap_list_lock);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="vgic_8c.html#a84556e1b8dbc13c53d1f5ac99eb68bfa">can_access_vgic_from_kernel</a>())</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <a class="code" href="vgic_8c.html#a2c03235bdb8dabad2ac5a43b15b501db">vgic_restore_state</a>(vcpu);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f">vgic_supports_direct_msis</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <a class="code" href="vgic-v4_8c.html#a043911fe4b149ad2ca234282ce4e67df">vgic_v4_commit</a>(vcpu);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;}</div>
<div class="ttc" id="avgic-mmio-v3_8c_html_a839b15883ba8f9de35a03ffce32fdf7f"><div class="ttname"><a href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f">vgic_supports_direct_msis</a></div><div class="ttdeci">bool vgic_supports_direct_msis(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-mmio-v3_8c_source.html#l00051">vgic-mmio-v3.c:51</a></div></div>
<div class="ttc" id="avgic-v4_8c_html_a043911fe4b149ad2ca234282ce4e67df"><div class="ttname"><a href="vgic-v4_8c.html#a043911fe4b149ad2ca234282ce4e67df">vgic_v4_commit</a></div><div class="ttdeci">void vgic_v4_commit(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v4_8c_source.html#l00385">vgic-v4.c:385</a></div></div>
<div class="ttc" id="avgic_8c_html_a2c03235bdb8dabad2ac5a43b15b501db"><div class="ttname"><a href="vgic_8c.html#a2c03235bdb8dabad2ac5a43b15b501db">vgic_restore_state</a></div><div class="ttdeci">static void vgic_restore_state(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00896">vgic.c:896</a></div></div>
<div class="ttc" id="avgic_8c_html_a498227d2a82836ba11a046b68857e3a3"><div class="ttname"><a href="vgic_8c.html#a498227d2a82836ba11a046b68857e3a3">vgic_flush_lr_state</a></div><div class="ttdeci">static void vgic_flush_lr_state(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00797">vgic.c:797</a></div></div>
<div class="ttc" id="avgic_8c_html_a84556e1b8dbc13c53d1f5ac99eb68bfa"><div class="ttname"><a href="vgic_8c.html#a84556e1b8dbc13c53d1f5ac99eb68bfa">can_access_vgic_from_kernel</a></div><div class="ttdeci">static bool can_access_vgic_from_kernel(void)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00856">vgic.c:856</a></div></div>
<div class="ttc" id="avgic_8h_html_a0e2b76dd7108772ed1441b1e64f0be4b"><div class="ttname"><a href="vgic_8h.html#a0e2b76dd7108772ed1441b1e64f0be4b">DEBUG_SPINLOCK_BUG_ON</a></div><div class="ttdeci">#define DEBUG_SPINLOCK_BUG_ON(p)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8h_source.html#l00099">vgic.h:99</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a5fb6266a1f361c1945f5feb862c1cf31_cgraph.png" border="0" usemap="#aarm__vgic_8h_a5fb6266a1f361c1945f5feb862c1cf31_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a5fb6266a1f361c1945f5feb862c1cf31_cgraph" id="aarm__vgic_8h_a5fb6266a1f361c1945f5feb862c1cf31_cgraph">
<area shape="rect" title=" " alt="" coords="5,490,188,517"/>
<area shape="rect" href="vgic_8c.html#a84556e1b8dbc13c53d1f5ac99eb68bfa" title=" " alt="" coords="249,298,417,339"/>
<area shape="rect" href="vgic_8c.html#a498227d2a82836ba11a046b68857e3a3" title=" " alt="" coords="262,364,405,390"/>
<area shape="rect" href="vgic_8c.html#a2c03235bdb8dabad2ac5a43b15b501db" title=" " alt="" coords="262,490,405,517"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="236,541,431,568"/>
<area shape="rect" href="vgic-v4_8c.html#a043911fe4b149ad2ca234282ce4e67df" title=" " alt="" coords="269,592,398,618"/>
<area shape="rect" href="vgic_8c.html#a5d8388f7026d04d501f7188b0b470812" title=" " alt="" coords="937,440,1110,466"/>
<area shape="rect" href="vgic_8c.html#ae96881aedd2816f45a65d54bf223562d" title=" " alt="" coords="516,136,620,162"/>
<area shape="rect" href="vgic_8c.html#a1d440ccc621cee03cf929f67f1fc5f6a" title=" " alt="" coords="503,338,633,365"/>
<area shape="rect" href="vgic_8c.html#a8f6bc92a21e40c3c63b10a95cabfcad3" title=" " alt="" coords="495,237,641,264"/>
<area shape="rect" href="vgic_8c.html#a33608d0aa45c2f10d84571ecf4475c5d" title=" " alt="" coords="503,440,633,466"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="1179,77,1322,104"/>
<area shape="rect" href="vgic_8h.html#a9bdd8f789c7055ff9681448eecde7072" title=" " alt="" coords="1171,440,1331,466"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="1379,389,1495,416"/>
<area shape="rect" href="vgic-v2_8c.html#a1bc90abf0cc897ed6f7aeadae6b0d518" title=" " alt="" coords="727,85,854,112"/>
<area shape="rect" href="vgic-v3_8c.html#a09a87047453ae4405f560fa3191a05fa" title=" " alt="" coords="727,136,854,162"/>
<area shape="rect" href="vgic-v2_8c.html#a9b6956f55b0732bd8aa6e5cce3b51b34" title=" " alt="" coords="715,288,867,314"/>
<area shape="rect" href="vgic-v3_8c.html#ad978c7773b6b8a81c108e35926ce6f86" title=" " alt="" coords="715,338,867,365"/>
<area shape="rect" href="vgic_8h.html#a9c8f3a32a17b2384ea1cc0c6e0340ad7" title=" " alt="" coords="948,222,1099,263"/>
<area shape="rect" href="vgic_8h.html#a03246bc81a56f8f77c3ee4ea6e27047d" title=" " alt="" coords="944,288,1103,314"/>
<area shape="rect" href="arm__vgic_8h.html#ad8001fedb7a2cb065c38833241e86b5c" title=" " alt="" coords="924,338,1123,365"/>
<area shape="rect" href="vgic-v2_8c.html#a1bc5185e55ce4c03c9eb43a7c4170f42" title=" " alt="" coords="705,186,876,213"/>
<area shape="rect" href="vgic-v3_8c.html#afd14cba7fa93011850c703921e02002b" title=" " alt="" coords="705,237,876,264"/>
<area shape="rect" href="vgic_8c.html#a74a26281729460bffc169b74551c50ad" title=" " alt="" coords="1197,490,1305,517"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a55c72c4122799415c59c381fd2740719" title=" " alt="" coords="479,541,657,568"/>
<area shape="rect" href="vgic-v2_8c.html#aaed5294c86b04a383f712fbf355f8b35" title=" " alt="" coords="485,490,651,517"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a161e7bd7fc63e0a7fdb5fab98711d711" title=" " alt="" coords="730,541,851,568"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="517,592,619,618"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a5fb6266a1f361c1945f5feb862c1cf31_icgraph.png" border="0" usemap="#aarm__vgic_8h_a5fb6266a1f361c1945f5feb862c1cf31_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a5fb6266a1f361c1945f5feb862c1cf31_icgraph" id="aarm__vgic_8h_a5fb6266a1f361c1945f5feb862c1cf31_icgraph">
<area shape="rect" title=" " alt="" coords="412,5,595,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a0a11de94338771a6d53dd409d4f4c49d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a11de94338771a6d53dd409d4f4c49d">&#9670;&nbsp;</a></span>kvm_vgic_get_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_get_map </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>vintid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00576">576</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;{</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq = <a class="code" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516">vgic_get_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, <a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>, vintid);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordtype">int</span> ret = -1;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    raw_spin_lock_irqsave(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">if</span> (irq-&gt;<a class="code" href="structvgic__irq.html#ac7e3ed05f0fea2733e1db86963e697e1">hw</a>)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        ret = irq-&gt;<a class="code" href="structvgic__irq.html#ad11f263e988788a2524c9c71d45ff472">hwintid</a>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    raw_spin_unlock_irqrestore(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <a class="code" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5">vgic_put_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, irq);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div>
<div class="ttc" id="astructvgic__irq_html"><div class="ttname"><a href="structvgic__irq.html">vgic_irq</a></div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00117">arm_vgic.h:117</a></div></div>
<div class="ttc" id="astructvgic__irq_html_a86c5cfe30a81ea5690f075fb2fcd9af1"><div class="ttname"><a href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vgic_irq::vcpu</a></div><div class="ttdeci">struct kvm_vcpu * vcpu</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00122">arm_vgic.h:122</a></div></div>
<div class="ttc" id="astructvgic__irq_html_ac7e3ed05f0fea2733e1db86963e697e1"><div class="ttname"><a href="structvgic__irq.html#ac7e3ed05f0fea2733e1db86963e697e1">vgic_irq::hw</a></div><div class="ttdeci">bool hw</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00140">arm_vgic.h:140</a></div></div>
<div class="ttc" id="astructvgic__irq_html_ad11f263e988788a2524c9c71d45ff472"><div class="ttname"><a href="structvgic__irq.html#ad11f263e988788a2524c9c71d45ff472">vgic_irq::hwintid</a></div><div class="ttdeci">u32 hwintid</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00142">arm_vgic.h:142</a></div></div>
<div class="ttc" id="astructvgic__irq_html_af1912aedc19eddddbe24a26fe5814a27"><div class="ttname"><a href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">vgic_irq::irq_lock</a></div><div class="ttdeci">raw_spinlock_t irq_lock</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00118">arm_vgic.h:118</a></div></div>
<div class="ttc" id="avgic_8c_html_a7f38a266ef3def3202e7e04aa40fd516"><div class="ttname"><a href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516">vgic_get_irq</a></div><div class="ttdeci">struct vgic_irq * vgic_get_irq(struct kvm *kvm, struct kvm_vcpu *vcpu, u32 intid)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00092">vgic.c:92</a></div></div>
<div class="ttc" id="avgic_8c_html_ac055f2fa0d463d3d287ee975bb80a9c5"><div class="ttname"><a href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5">vgic_put_irq</a></div><div class="ttdeci">void vgic_put_irq(struct kvm *kvm, struct vgic_irq *irq)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00139">vgic.c:139</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a0a11de94338771a6d53dd409d4f4c49d_cgraph.png" border="0" usemap="#aarm__vgic_8h_a0a11de94338771a6d53dd409d4f4c49d_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a0a11de94338771a6d53dd409d4f4c49d_cgraph" id="aarm__vgic_8h_a0a11de94338771a6d53dd409d4f4c49d_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,155,57"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="203,5,304,32"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="203,56,304,83"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="383,5,483,32"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="563,5,697,32"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="352,56,515,83"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="566,56,694,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a0a11de94338771a6d53dd409d4f4c49d_icgraph.png" border="0" usemap="#aarm__vgic_8h_a0a11de94338771a6d53dd409d4f4c49d_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a0a11de94338771a6d53dd409d4f4c49d_icgraph" id="aarm__vgic_8h_a0a11de94338771a6d53dd409d4f4c49d_icgraph">
<area shape="rect" title=" " alt="" coords="1899,237,2048,264"/>
<area shape="rect" href="arch__timer_8c.html#a9f34b892b5c9b1e79065006b4353c76e" title=" " alt="" coords="1684,230,1851,271"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a3e5bae87fbacf924b25a9944b4f99e87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e5bae87fbacf924b25a9944b4f99e87">&#9670;&nbsp;</a></span>kvm_vgic_get_max_vcpus()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int kvm_vgic_get_max_vcpus </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>kvm_vgic_get_max_vcpus - Get the maximum number of VCPUs allowed by HW</p>
<p>The host's GIC naturally limits the maximum amount of VCPUs a guest can use. </p>

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00411">411</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;{</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a7572ffe11d0f4c19a8d8c4ca102f4600">max_gic_vcpus</a>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
<div class="ttc" id="astructvgic__global_html_a7572ffe11d0f4c19a8d8c4ca102f4600"><div class="ttname"><a href="structvgic__global.html#a7572ffe11d0f4c19a8d8c4ca102f4600">vgic_global::max_gic_vcpus</a></div><div class="ttdeci">int max_gic_vcpus</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00068">arm_vgic.h:68</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a3e5bae87fbacf924b25a9944b4f99e87_icgraph.png" border="0" usemap="#aarm__vgic_8h_a3e5bae87fbacf924b25a9944b4f99e87_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a3e5bae87fbacf924b25a9944b4f99e87_icgraph" id="aarm__vgic_8h_a3e5bae87fbacf924b25a9944b4f99e87_icgraph">
<area shape="rect" title=" " alt="" coords="881,35,1076,61"/>
<area shape="rect" href="arm_8c.html#a66d677aa2122d322c1bc69e20531cf58" title=" " alt="" coords="660,27,833,69"/>
<area shape="rect" href="arm_8c.html#a78b266c18dac3b9edbea80941c96e2cd" title=" " alt="" coords="461,5,604,32"/>
<area shape="rect" href="arm_8c.html#a18efe0d4e70bef9cae70344f31f47cff" title=" " alt="" coords="453,57,612,98"/>
<area shape="rect" href="kvm__main_8c.html#a54b22e6be98d31db1a83e7993fbcf4bc" title=" " alt="" coords="263,5,389,32"/>
<area shape="rect" href="kvm__main_8c.html#a955de4f2a1b3371438636eccab732b27" title=" " alt="" coords="5,5,199,32"/>
<area shape="rect" href="kvm__main_8c.html#af05b1274e9e33570d11f7f98bee8b839" title=" " alt="" coords="247,57,405,98"/>
<area shape="rect" href="kvm__main_8c.html#aaeec02d207c8ce5ca12b1ef2ac36fae0" title=" " alt="" coords="19,57,185,98"/>
</map>
</div>

</div>
</div>
<a id="aba3547aa220ca50b1eabca1a39c92943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba3547aa220ca50b1eabca1a39c92943">&#9670;&nbsp;</a></span>kvm_vgic_hyp_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_hyp_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>kvm_vgic_hyp_init: populates the kvm_vgic_global_state variable according to the host GIC model. Accordingly calls either vgic_v2/v3_probe which registers the KVM_DEVICE that can be instantiated by a guest later on . </p>

<p class="definition">Definition at line <a class="el" href="vgic-init_8c_source.html#l00564">564</a> of file <a class="el" href="vgic-init_8c_source.html">vgic-init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;{</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordtype">bool</span> has_mask;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a>)</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">return</span> -ENODEV;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    has_mask = !<a class="code" href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a>-&gt;no_maint_irq_mask;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">if</span> (has_mask &amp;&amp; !<a class="code" href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a>-&gt;maint_irq) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        kvm_err(<span class="stringliteral">&quot;No vgic maintenance irq\n&quot;</span>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">return</span> -ENXIO;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">     * If we get one of these oddball non-GICs, taint the kernel,</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">     * as we have no idea of how they *really* behave.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a>-&gt;no_hw_deactivation) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        kvm_info(<span class="stringliteral">&quot;Non-architectural vgic, tainting kernel\n&quot;</span>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        add_taint(TAINT_CPU_OUT_OF_SPEC, LOCKDEP_STILL_OK);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a6a97bb7eea3c0167e31f98c29fe09019">no_hw_deactivation</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a>-&gt;type) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">case</span> GIC_V2:</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        ret = <a class="code" href="vgic-v2_8c.html#aa3e64817232a1ce5658b7f3147f7f554">vgic_v2_probe</a>(<a class="code" href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a>);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">case</span> GIC_V3:</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        ret = <a class="code" href="vgic-v3_8c.html#ac418c84cff9542559c426a575c403136">vgic_v3_probe</a>(<a class="code" href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a>);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">if</span> (!ret) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            static_branch_enable(&amp;<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a37d2313a81427d89abba1c628f603890">gicv3_cpuif</a>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            kvm_info(<span class="stringliteral">&quot;GIC system register CPU interface enabled\n&quot;</span>);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        ret = -ENODEV;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a6b6542d30feaef74e3cf49f50783f942">maint_irq</a> = <a class="code" href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a>-&gt;maint_irq;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    kfree(<a class="code" href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a> = NULL;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">if</span> (!has_mask &amp;&amp; !<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a6b6542d30feaef74e3cf49f50783f942">maint_irq</a>)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    ret = request_percpu_irq(<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a6b6542d30feaef74e3cf49f50783f942">maint_irq</a>,</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                 <a class="code" href="vgic-init_8c.html#a489028c2499bdfbe87388b96a832b3ed">vgic_maintenance_handler</a>,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                 <span class="stringliteral">&quot;vgic&quot;</span>, <a class="code" href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f">kvm_get_running_vcpus</a>());</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">if</span> (ret) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        kvm_err(<span class="stringliteral">&quot;Cannot register interrupt %d\n&quot;</span>,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a6b6542d30feaef74e3cf49f50783f942">maint_irq</a>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    kvm_info(<span class="stringliteral">&quot;vgic interrupt IRQ%d\n&quot;</span>, <a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a6b6542d30feaef74e3cf49f50783f942">maint_irq</a>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;}</div>
<div class="ttc" id="akvm__main_8c_html_a1798daf88e30c60711caf936851d823f"><div class="ttname"><a href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f">kvm_get_running_vcpus</a></div><div class="ttdeci">struct kvm_vcpu *__percpu * kvm_get_running_vcpus(void)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l06353">kvm_main.c:6353</a></div></div>
<div class="ttc" id="astructvgic__global_html_a37d2313a81427d89abba1c628f603890"><div class="ttname"><a href="structvgic__global.html#a37d2313a81427d89abba1c628f603890">vgic_global::gicv3_cpuif</a></div><div class="ttdeci">struct static_key_false gicv3_cpuif</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00078">arm_vgic.h:81</a></div></div>
<div class="ttc" id="astructvgic__global_html_a6a97bb7eea3c0167e31f98c29fe09019"><div class="ttname"><a href="structvgic__global.html#a6a97bb7eea3c0167e31f98c29fe09019">vgic_global::no_hw_deactivation</a></div><div class="ttdeci">bool no_hw_deactivation</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00078">arm_vgic.h:78</a></div></div>
<div class="ttc" id="avgic-init_8c_html_a489028c2499bdfbe87388b96a832b3ed"><div class="ttname"><a href="vgic-init_8c.html#a489028c2499bdfbe87388b96a832b3ed">vgic_maintenance_handler</a></div><div class="ttdeci">static irqreturn_t vgic_maintenance_handler(int irq, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-init_8c_source.html#l00518">vgic-init.c:518</a></div></div>
<div class="ttc" id="avgic-init_8c_html_a7b7c49d17fa603aa8433b0d402f9efe1"><div class="ttname"><a href="vgic-init_8c.html#a7b7c49d17fa603aa8433b0d402f9efe1">gic_kvm_info</a></div><div class="ttdeci">static struct gic_kvm_info * gic_kvm_info</div><div class="ttdef"><b>Definition:</b> <a href="vgic-init_8c_source.html#l00529">vgic-init.c:529</a></div></div>
<div class="ttc" id="avgic-v2_8c_html_aa3e64817232a1ce5658b7f3147f7f554"><div class="ttname"><a href="vgic-v2_8c.html#aa3e64817232a1ce5658b7f3147f7f554">vgic_v2_probe</a></div><div class="ttdeci">int vgic_v2_probe(const struct gic_kvm_info *info)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v2_8c_source.html#l00337">vgic-v2.c:337</a></div></div>
<div class="ttc" id="avgic-v3_8c_html_ac418c84cff9542559c426a575c403136"><div class="ttname"><a href="vgic-v3_8c.html#ac418c84cff9542559c426a575c403136">vgic_v3_probe</a></div><div class="ttdeci">int vgic_v3_probe(const struct gic_kvm_info *info)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v3_8c_source.html#l00632">vgic-v3.c:632</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_aba3547aa220ca50b1eabca1a39c92943_cgraph.png" border="0" usemap="#aarm__vgic_8h_aba3547aa220ca50b1eabca1a39c92943_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_aba3547aa220ca50b1eabca1a39c92943_cgraph" id="aarm__vgic_8h_aba3547aa220ca50b1eabca1a39c92943_cgraph">
<area shape="rect" title=" " alt="" coords="5,164,149,191"/>
<area shape="rect" href="kvm__main_8c.html#a1798daf88e30c60711caf936851d823f" title=" " alt="" coords="206,88,386,115"/>
<area shape="rect" href="vgic-init_8c.html#a489028c2499bdfbe87388b96a832b3ed" title=" " alt="" coords="197,139,395,165"/>
<area shape="rect" href="vgic-v2_8c.html#aa3e64817232a1ce5658b7f3147f7f554" title=" " alt="" coords="238,189,354,216"/>
<area shape="rect" href="vgic-v3_8c.html#ac418c84cff9542559c426a575c403136" title=" " alt="" coords="238,265,354,292"/>
<area shape="rect" href="mmu_8c.html#af062326f5ca9b42e66721620681afc52" title=" " alt="" coords="453,132,637,159"/>
<area shape="rect" href="vgic-kvm-device_8c.html#aa01e5dcf80e608f64f5428d054d17a84" title=" " alt="" coords="449,189,641,216"/>
<area shape="rect" href="mmu_8c.html#ae887a1611ab69f37917bb0f05530e62d" title=" " alt="" coords="708,117,869,158"/>
<area shape="rect" href="mmu_8c.html#a528a37af3e2c56c76872b4113cff0877" title=" " alt="" coords="931,95,1109,121"/>
<area shape="rect" href="mmu_8c.html#af214df14aaaac0cc598374356bc3bc5b" title=" " alt="" coords="1157,44,1387,71"/>
<area shape="rect" href="mm_8h.html#ae155403ed30abe044479dec517afc378" title=" " alt="" coords="933,146,1107,187"/>
<area shape="rect" href="mmu_8c.html#a1a724954ee942f0f1223e75cd475c8e7" title=" " alt="" coords="940,237,1100,278"/>
<area shape="rect" href="pgtable_8c.html#ad1a61b3aa251ca1150e9359c5c31a173" title=" " alt="" coords="1435,95,1609,121"/>
<area shape="rect" href="pgtable_8c.html#a06c1f113f067476605d118dffebef6a8" title=" " alt="" coords="1673,44,1805,71"/>
<area shape="rect" href="pgtable_8c.html#ab93223f59cefdfdd0abfb060e97f7b45" title=" " alt="" coords="1671,95,1807,121"/>
<area shape="rect" href="pgtable_8c.html#a2a6ed7242e033a1f32360cbe0e5c2281" title=" " alt="" coords="1666,145,1811,172"/>
<area shape="rect" href="pgtable_8c.html#ae28010caa0eb1b8a51d07679e9d08daa" title=" " alt="" coords="1868,44,2057,71"/>
<area shape="rect" href="pgtable_8c.html#acdca989573ec9ed02b9b43a7014140c8" title=" " alt="" coords="1889,95,2036,121"/>
<area shape="rect" href="pgtable_8c.html#ad78e3b5f65ff7e25e23a1fbb89e39a24" title=" " alt="" coords="2105,5,2335,32"/>
<area shape="rect" href="pgtable_8c.html#adec3d8cce63231d14b6d3d9e635abf8e" title=" " alt="" coords="2131,56,2309,83"/>
<area shape="rect" href="pgtable_8c.html#aa480a93c3d8dd6fd53b1105fd604766c" title=" " alt="" coords="2387,5,2534,32"/>
<area shape="rect" href="pgtable_8c.html#ac74b17e065ba3e68a10f28b594d21e40" title=" " alt="" coords="1887,145,2039,172"/>
<area shape="rect" href="pgtable_8c.html#a4819ac158aa1b43844c3a3b5e5a82ac3" title=" " alt="" coords="2141,132,2299,159"/>
<area shape="rect" href="pgtable_8c.html#af01e17f60125c9e093e082e70a43f362" title=" " alt="" coords="2146,183,2294,209"/>
<area shape="rect" href="pgtable_8c.html#a5aa0f5d1f7f2540fea515eb0b198caba" title=" " alt="" coords="2383,132,2539,159"/>
<area shape="rect" href="pgtable_8c.html#ac1a7f01d8f40491309c052bdea628e06" title=" " alt="" coords="2393,183,2528,209"/>
<area shape="rect" href="pgtable_8c.html#a98293d8aa53e4ee188e8dc42f3dc17e9" title=" " alt="" coords="2602,56,2779,83"/>
<area shape="rect" href="pgtable_8c.html#abfea9e86c1a7e719b3d9e35bb045d795" title=" " alt="" coords="2587,107,2795,133"/>
<area shape="rect" href="pgtable_8c.html#a2f4269267d0718905af8540821a6de3d" title=" " alt="" coords="2627,157,2754,184"/>
<area shape="rect" href="pgtable_8c.html#a6e3f339456d5a01daa47962cc12f080e" title=" " alt="" coords="2631,208,2750,235"/>
<area shape="rect" href="mm_8c.html#a74d2915c3948e76518d945f16a1ede94" title=" " alt="" coords="1176,145,1368,172"/>
<area shape="rect" href="mm_8c.html#ac26a679af9d176b079755c60fa2e1ce1" title=" " alt="" coords="1197,197,1347,238"/>
<area shape="rect" href="spinlock_8h.html#ae942ff0e878cb0f4d55ddc4cc6275ec9" title=" " alt="" coords="1465,196,1579,223"/>
<area shape="rect" href="spinlock_8h.html#a2c6e9db70599188dbe031e2ce8ec6b08" title=" " alt="" coords="1457,145,1587,172"/>
<area shape="rect" href="mm_8c.html#aa76ffe9cd77a903ae9b6e5de1617f3a5" title=" " alt="" coords="1440,247,1604,289"/>
<area shape="rect" href="spinlock_8h.html#ae92c9f4a09d239d6060880c35d12a48b" title=" " alt="" coords="1657,255,1820,281"/>
<area shape="rect" href="mmu_8c.html#a3d84d21823759c9e6d2cd3bbcc5b8f48" title=" " alt="" coords="1197,262,1347,303"/>
<area shape="rect" href="kvm__main_8c.html#a04cec4716182d98b08f008f317aaf698" title=" " alt="" coords="695,248,883,275"/>
<area shape="rect" href="vgic-its_8c.html#a50d09aacec778677eb4fb2c550a3bea4" title=" " alt="" coords="706,182,871,223"/>
<area shape="rect" href="vgic-v3-sr_8c.html#ab2ac0bafd09093cb3c702166b2615c31" title=" " alt="" coords="451,341,638,368"/>
<area shape="rect" href="arm_8c.html#ade8fdddf9949d1e1fcc2cea2dc5a7133" title=" " alt="" coords="483,392,606,419"/>
<area shape="rect" href="kvm__main_8c.html#a9a59affaa1c06f4ea56e33679ba52ae2" title=" " alt="" coords="443,240,647,267"/>
<area shape="rect" href="vgic-v3_8c.html#a723b88e9568c712a3b969224cda48a8c" title=" " alt="" coords="467,291,623,317"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_aba3547aa220ca50b1eabca1a39c92943_icgraph.png" border="0" usemap="#aarm__vgic_8h_aba3547aa220ca50b1eabca1a39c92943_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_aba3547aa220ca50b1eabca1a39c92943_icgraph" id="aarm__vgic_8h_aba3547aa220ca50b1eabca1a39c92943_icgraph">
<area shape="rect" title=" " alt="" coords="341,5,485,32"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="165,5,293,32"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="5,5,117,32"/>
</map>
</div>

</div>
</div>
<a id="aefd1e0e9cd080919b043406251dfa0b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefd1e0e9cd080919b043406251dfa0b8">&#9670;&nbsp;</a></span>kvm_vgic_init_cpu_hardware()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_init_cpu_hardware </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>kvm_vgic_init_cpu_hardware - initialize the GIC VE hardware</p>
<p>For a specific CPU, initialize the GIC VE hardware. </p>

<p class="definition">Definition at line <a class="el" href="vgic-init_8c_source.html#l00544">544</a> of file <a class="el" href="vgic-init_8c_source.html">vgic-init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    BUG_ON(preemptible());</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">     * We want to make sure the list registers start out clear so that we</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">     * only have the program the used registers.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#ae7d700dc38bbca3ed33730267652d87f">type</a> == <a class="code" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a9516eb794b5e9d2d4817bb361c699a60">VGIC_V2</a>)</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="vgic-v2_8c.html#a1e2191b7a20d4cf12614106efac5ced2">vgic_v2_init_lrs</a>();</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        kvm_call_hyp(<a class="code" href="vgic-v3-sr_8c.html#a412786aabffbbfab73264334c0a45f1d">__vgic_v3_init_lrs</a>);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;}</div>
<div class="ttc" id="astructvgic__global_html_ae7d700dc38bbca3ed33730267652d87f"><div class="ttname"><a href="structvgic__global.html#ae7d700dc38bbca3ed33730267652d87f">vgic_global::type</a></div><div class="ttdeci">enum vgic_type type</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00438">arm_vgic.h:46</a></div></div>
<div class="ttc" id="avgic-v2_8c_html_a1e2191b7a20d4cf12614106efac5ced2"><div class="ttname"><a href="vgic-v2_8c.html#a1e2191b7a20d4cf12614106efac5ced2">vgic_v2_init_lrs</a></div><div class="ttdeci">void vgic_v2_init_lrs(void)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v2_8c_source.html#l00021">vgic-v2.c:21</a></div></div>
<div class="ttc" id="avgic-v3-sr_8c_html_a412786aabffbbfab73264334c0a45f1d"><div class="ttname"><a href="vgic-v3-sr_8c.html#a412786aabffbbfab73264334c0a45f1d">__vgic_v3_init_lrs</a></div><div class="ttdeci">void __vgic_v3_init_lrs(void)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v3-sr_8c_source.html#l00399">vgic-v3-sr.c:399</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_aefd1e0e9cd080919b043406251dfa0b8_cgraph.png" border="0" usemap="#aarm__vgic_8h_aefd1e0e9cd080919b043406251dfa0b8_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_aefd1e0e9cd080919b043406251dfa0b8_cgraph" id="aarm__vgic_8h_aefd1e0e9cd080919b043406251dfa0b8_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,216,57"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a412786aabffbbfab73264334c0a45f1d" title=" " alt="" coords="264,5,401,32"/>
<area shape="rect" href="vgic-v2_8c.html#a1e2191b7a20d4cf12614106efac5ced2" title=" " alt="" coords="271,56,394,83"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a161e7bd7fc63e0a7fdb5fab98711d711" title=" " alt="" coords="453,5,574,32"/>
<area shape="rect" href="vgic-v2_8c.html#ad8c03dce2e41ca3c35de3897603bb9e0" title=" " alt="" coords="449,56,577,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_aefd1e0e9cd080919b043406251dfa0b8_icgraph.png" border="0" usemap="#aarm__vgic_8h_aefd1e0e9cd080919b043406251dfa0b8_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_aefd1e0e9cd080919b043406251dfa0b8_icgraph" id="aarm__vgic_8h_aefd1e0e9cd080919b043406251dfa0b8_icgraph">
<area shape="rect" title=" " alt="" coords="1028,81,1239,108"/>
<area shape="rect" href="arm_8c.html#a451b50b80474a3cf090fcce753c8c642" title=" " alt="" coords="815,81,980,108"/>
<area shape="rect" href="arm_8c.html#a2dfd4facec6b758ea01c34f9789486d8" title=" " alt="" coords="649,56,767,83"/>
<area shape="rect" href="arm_8c.html#a45a99f5a1905e2b85f69a767313abfd7" title=" " alt="" coords="653,107,763,133"/>
<area shape="rect" href="arm_8c.html#a0769d67e6376c5081aac75ea3783df2f" title=" " alt="" coords="458,56,562,83"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="204,5,332,32"/>
<area shape="rect" href="arm_8c.html#ac1582780a8801f86aa06da8b95cbcfe9" title=" " alt="" coords="165,56,371,83"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="5,56,117,83"/>
<area shape="rect" href="arm_8c.html#a3c73ef13f7491129779b02da5a9a7442" title=" " alt="" coords="419,107,601,133"/>
<area shape="rect" href="arm_8c.html#a289457d5cabd2e7e2cda634bc6277311" title=" " alt="" coords="209,107,327,133"/>
</map>
</div>

</div>
</div>
<a id="a87038ce452e0054b853c10ccbbcc78a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87038ce452e0054b853c10ccbbcc78a4">&#9670;&nbsp;</a></span>kvm_vgic_inject_irq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_inject_irq </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>intid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>owner</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>kvm_vgic_inject_irq - Inject an IRQ from a device to the vgic @kvm: The VM structure pointer @vcpu: The CPU for PPIs or NULL for global interrupts @intid: The INTID to inject a new state to. @level: Edge-triggered: true: to trigger the interrupt false: to ignore the call Level-sensitive true: raise the input signal false: lower the input signal @owner: The opaque pointer to the owner of the IRQ being raised to verify that the caller is allowed to inject this IRQ. Userspace injections will have owner == NULL.</p>
<p>The VGIC is not concerned with devices being active-LOW or active-HIGH for level-sensitive interrupts. You can think of the level parameter as 1 being HIGH and 0 being LOW and all devices being active-HIGH. </p>

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00439">439</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;{</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    ret = <a class="code" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6">vgic_lazy_init</a>(kvm);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a> &amp;&amp; <a class="code" href="structvgic__irq.html#a52b9a2e701d89765fc16feb0323ef277">intid</a> &lt; <a class="code" href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a>)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    trace_vgic_update_irq_pending(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a> ? <a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;vcpu_idx : 0, <a class="code" href="structvgic__irq.html#a52b9a2e701d89765fc16feb0323ef277">intid</a>, level);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    irq = <a class="code" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516">vgic_get_irq</a>(kvm, <a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>, <a class="code" href="structvgic__irq.html#a52b9a2e701d89765fc16feb0323ef277">intid</a>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (!irq)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    raw_spin_lock_irqsave(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08">vgic_validate_injection</a>(irq, level, <a class="code" href="structvgic__irq.html#a59f5d7d46d7a0d6fa38e6514d8264422">owner</a>)) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="comment">/* Nothing to see here, move along... */</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        raw_spin_unlock_irqrestore(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5">vgic_put_irq</a>(kvm, irq);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span> (irq-&gt;<a class="code" href="structvgic__irq.html#afb2bd15c9dd315e5617a243d13eb5f79">config</a> == <a class="code" href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7aff766918bb2eff9dbb94c4edea188a2a">VGIC_CONFIG_LEVEL</a>)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        irq-&gt;<a class="code" href="structvgic__irq.html#a7dfb2c22e8a6c749facfdf07c70e7cf3">line_level</a> = level;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        irq-&gt;<a class="code" href="structvgic__irq.html#a91bd325ff1822b894b2a7c6930128083">pending_latch</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c">vgic_queue_irq_unlock</a>(kvm, irq, flags);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5">vgic_put_irq</a>(kvm, irq);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;}</div>
<div class="ttc" id="astructvgic__irq_html_a52b9a2e701d89765fc16feb0323ef277"><div class="ttname"><a href="structvgic__irq.html#a52b9a2e701d89765fc16feb0323ef277">vgic_irq::intid</a></div><div class="ttdeci">u32 intid</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00133">arm_vgic.h:133</a></div></div>
<div class="ttc" id="astructvgic__irq_html_a59f5d7d46d7a0d6fa38e6514d8264422"><div class="ttname"><a href="structvgic__irq.html#a59f5d7d46d7a0d6fa38e6514d8264422">vgic_irq::owner</a></div><div class="ttdeci">void * owner</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00156">arm_vgic.h:156</a></div></div>
<div class="ttc" id="astructvgic__irq_html_a7dfb2c22e8a6c749facfdf07c70e7cf3"><div class="ttname"><a href="structvgic__irq.html#a7dfb2c22e8a6c749facfdf07c70e7cf3">vgic_irq::line_level</a></div><div class="ttdeci">bool line_level</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00134">arm_vgic.h:134</a></div></div>
<div class="ttc" id="astructvgic__irq_html_a91bd325ff1822b894b2a7c6930128083"><div class="ttname"><a href="structvgic__irq.html#a91bd325ff1822b894b2a7c6930128083">vgic_irq::pending_latch</a></div><div class="ttdeci">bool pending_latch</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00135">arm_vgic.h:135</a></div></div>
<div class="ttc" id="astructvgic__irq_html_afb2bd15c9dd315e5617a243d13eb5f79"><div class="ttname"><a href="structvgic__irq.html#afb2bd15c9dd315e5617a243d13eb5f79">vgic_irq::config</a></div><div class="ttdeci">enum vgic_irq_config config</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00151">arm_vgic.h:152</a></div></div>
<div class="ttc" id="avgic-init_8c_html_a3c860e1d043352d9a02f4780b58e5af6"><div class="ttname"><a href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6">vgic_lazy_init</a></div><div class="ttdeci">int vgic_lazy_init(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-init_8c_source.html#l00423">vgic-init.c:423</a></div></div>
<div class="ttc" id="avgic_8c_html_a19d9c44a40cc76ccbd25bd8e0ec38a08"><div class="ttname"><a href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08">vgic_validate_injection</a></div><div class="ttdeci">static bool vgic_validate_injection(struct vgic_irq *irq, bool level, void *owner)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00313">vgic.c:313</a></div></div>
<div class="ttc" id="avgic_8c_html_a1e208ac24f54fa95ba74797758c5b84c"><div class="ttname"><a href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c">vgic_queue_irq_unlock</a></div><div class="ttdeci">bool vgic_queue_irq_unlock(struct kvm *kvm, struct vgic_irq *irq, unsigned long flags)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00336">vgic.c:336</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a87038ce452e0054b853c10ccbbcc78a4_cgraph.png" border="0" usemap="#aarm__vgic_8h_a87038ce452e0054b853c10ccbbcc78a4_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a87038ce452e0054b853c10ccbbcc78a4_cgraph" id="aarm__vgic_8h_a87038ce452e0054b853c10ccbbcc78a4_cgraph">
<area shape="rect" title=" " alt="" coords="5,649,157,676"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="1826,329,1927,356"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="205,548,316,574"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="2045,638,2147,665"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="2011,537,2181,564"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="1791,598,1963,625"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="2046,329,2146,356"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="2509,373,2643,400"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="364,244,441,270"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="508,193,652,220"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="489,295,671,336"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="2045,190,2147,217"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="493,361,667,388"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="518,25,642,52"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="505,76,655,118"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1163,230,1357,257"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="530,446,630,473"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="733,294,887,321"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="949,294,1115,321"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="956,345,1108,372"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1174,345,1346,372"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="1419,337,1529,364"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="1405,442,1543,469"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="1593,278,1740,305"/>
<area shape="rect" href="vgic-its_8c.html#a53bf66e96dae9553e637fa69e8835365" title=" " alt="" coords="1593,380,1740,406"/>
<area shape="rect" href="vgic-its_8c.html#a352c8627ccf81a8154ae2275c7d50659" title=" " alt="" coords="1793,431,1961,472"/>
<area shape="rect" href="vgic-its_8c.html#ad62375be0591178764e98b79cd7217bf" title=" " alt="" coords="1800,380,1953,406"/>
<area shape="rect" href="vgic-its_8c.html#a94bbb30efc49ad5494a7f4b1410dbe01" title=" " alt="" coords="1815,278,1938,305"/>
<area shape="rect" href="vgic-its_8c.html#ab8e3bef933af0cc51b05259d801be26d" title=" " alt="" coords="2245,334,2408,361"/>
<area shape="rect" href="vgic-its_8c.html#aa5825fcbd841b62853870d25976d018b" title=" " alt="" coords="2488,461,2664,488"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="2495,588,2657,614"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="2728,588,2856,614"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="2265,748,2388,774"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="2255,638,2398,665"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="2472,697,2680,724"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="2499,748,2653,774"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="2518,638,2634,665"/>
<area shape="rect" href="vgic-its_8c.html#a3fe23d687675cef46a95e36cf14d04e1" title=" " alt="" coords="2021,436,2171,462"/>
<area shape="rect" href="vgic-its_8c.html#a0fb230e293b92c9fb746ad7b97ac68d5" title=" " alt="" coords="2255,385,2398,412"/>
<area shape="rect" href="vgic-its_8c.html#ae32cde43818922d2ecf800a3de102b75" title=" " alt="" coords="2291,436,2362,462"/>
<area shape="rect" href="vgic-its_8c.html#ad9756268e1c22946f868e3255f916aa6" title=" " alt="" coords="2229,588,2424,614"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#aa37f9ed0ed7921675bc4167d4a9d9261" title=" " alt="" coords="2257,486,2396,513"/>
<area shape="rect" href="kvm__main_8c.html#acb4d46ae6cc918253046320805f63a95" title=" " alt="" coords="2017,266,2175,293"/>
<area shape="rect" href="kvm__main_8c.html#a94bf2e0af8d9af8807a6a92ffb01cc1c" title=" " alt="" coords="2231,233,2422,260"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="1591,522,1743,549"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="749,345,871,372"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="749,396,871,422"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="719,497,901,524"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="740,446,880,473"/>
<area shape="rect" href="vgic-v4_8c.html#ac22161596c9858cc700bab08c03fc422" title=" " alt="" coords="1166,598,1354,625"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a87038ce452e0054b853c10ccbbcc78a4_icgraph.png" border="0" usemap="#aarm__vgic_8h_a87038ce452e0054b853c10ccbbcc78a4_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a87038ce452e0054b853c10ccbbcc78a4_icgraph" id="aarm__vgic_8h_a87038ce452e0054b853c10ccbbcc78a4_icgraph">
<area shape="rect" title=" " alt="" coords="2203,417,2355,444"/>
<area shape="rect" href="pmu-emul_8c.html#ac79256eb94d7599687d3294cd40d10b4" title=" " alt="" coords="1067,56,1246,83"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="1985,392,2155,419"/>
<area shape="rect" href="arm_8c.html#a1cc94da0709805c40af7785f8c5811bf" title=" " alt="" coords="1985,443,2155,469"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="2001,619,2139,645"/>
<area shape="rect" href="pmu-emul_8c.html#ab0f1f020b6774de3fb4ff4c8b4e45a5c" title=" " alt="" coords="827,56,1011,83"/>
<area shape="rect" href="pmu-emul_8c.html#ae6434d5e6ad74c608886c368e56d67bc" title=" " alt="" coords="827,5,1010,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,129,778,156"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,207,129,233"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1745,543,1929,569"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1741,480,1933,507"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1753,414,1920,455"/>
<area shape="rect" href="arch__timer_8c.html#a11b9b6e6338bbec6085332661c934e91" title=" " alt="" coords="1303,308,1473,335"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1777,363,1896,389"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1745,216,1928,243"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="1529,551,1681,577"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="1324,557,1452,584"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="629,572,741,599"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1521,421,1688,448"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1309,420,1467,447"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="1059,471,1255,497"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1084,420,1229,447"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1092,308,1221,335"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1099,521,1214,548"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1113,207,1201,233"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,521,752,548"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="827,420,1010,447"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="598,420,771,447"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="637,471,733,497"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,369,732,396"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,420,543,447"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="831,259,1007,285"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,259,766,285"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,259,336,285"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="838,208,999,235"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,251,543,293"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="879,521,958,548"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1521,355,1688,397"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1317,363,1459,389"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="1522,143,1687,169"/>
<area shape="rect" href="vgic-irqfd_8c.html#ae7b7837b6e17bc60af3f4d81e9a4147e" title=" " alt="" coords="1736,669,1937,696"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1751,619,1923,645"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1529,631,1681,657"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1311,637,1465,664"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1066,645,1247,686"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="880,673,957,700"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="629,623,740,649"/>
<area shape="rect" href="vgic-kvm-device_8c.html#a6aadc4684bf7ca54e4a3d91f9e10310c" title=" " alt="" coords="599,673,770,700"/>
<area shape="rect" href="vgic-kvm-device_8c.html#a78d5c53181a4adf55a58d8277fb751af" title=" " alt="" coords="591,724,779,751"/>
<area shape="rect" href="vgic-v2_8c.html#ac8de91a1f816dcd3b3edba1d074a1aca" title=" " alt="" coords="595,775,774,801"/>
</map>
</div>

</div>
</div>
<a id="a54d5d884ac662357df5661d80f5160e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54d5d884ac662357df5661d80f5160e3">&#9670;&nbsp;</a></span>kvm_vgic_load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_load </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00938">938</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;{</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">if</span> (unlikely(!<a class="code" href="arm__vgic_8h.html#a92f7a5b2fbbd6b57aaed08e61ba34d43">vgic_initialized</a>(vcpu-&gt;kvm)))</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#ae7d700dc38bbca3ed33730267652d87f">type</a> == <a class="code" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a9516eb794b5e9d2d4817bb361c699a60">VGIC_V2</a>)</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <a class="code" href="vgic-v2_8c.html#a8321cd156f283292cc531c7ca6358193">vgic_v2_load</a>(vcpu);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <a class="code" href="vgic-v3_8c.html#aec2311d8e88bcd485c7baf083b65876e">vgic_v3_load</a>(vcpu);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;}</div>
<div class="ttc" id="aarm__vgic_8h_html_a92f7a5b2fbbd6b57aaed08e61ba34d43"><div class="ttname"><a href="arm__vgic_8h.html#a92f7a5b2fbbd6b57aaed08e61ba34d43">vgic_initialized</a></div><div class="ttdeci">#define vgic_initialized(k)</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00393">arm_vgic.h:393</a></div></div>
<div class="ttc" id="avgic-v2_8c_html_a8321cd156f283292cc531c7ca6358193"><div class="ttname"><a href="vgic-v2_8c.html#a8321cd156f283292cc531c7ca6358193">vgic_v2_load</a></div><div class="ttdeci">void vgic_v2_load(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v2_8c_source.html#l00457">vgic-v2.c:457</a></div></div>
<div class="ttc" id="avgic-v3_8c_html_aec2311d8e88bcd485c7baf083b65876e"><div class="ttname"><a href="vgic-v3_8c.html#aec2311d8e88bcd485c7baf083b65876e">vgic_v3_load</a></div><div class="ttdeci">void vgic_v3_load(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v3_8c_source.html#l00720">vgic-v3.c:720</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a54d5d884ac662357df5661d80f5160e3_cgraph.png" border="0" usemap="#aarm__vgic_8h_a54d5d884ac662357df5661d80f5160e3_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a54d5d884ac662357df5661d80f5160e3_cgraph" id="aarm__vgic_8h_a54d5d884ac662357df5661d80f5160e3_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,125,98"/>
<area shape="rect" href="vgic-v2_8c.html#a8321cd156f283292cc531c7ca6358193" title=" " alt="" coords="173,46,280,73"/>
<area shape="rect" href="vgic-v3_8c.html#aec2311d8e88bcd485c7baf083b65876e" title=" " alt="" coords="173,97,280,123"/>
<area shape="rect" href="vgic-v3-sr_8c.html#acd3f57089d359ed44e778793fe5aeef0" title=" " alt="" coords="342,5,489,47"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a1f2bd7ee89ce38236b148eed5aaffbe3" title=" " alt="" coords="328,71,503,98"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a6a35b1067c29b8d7f96ed309bfc06fd6" title=" " alt="" coords="332,122,499,149"/>
<area shape="rect" href="vgic-v4_8c.html#ac2966fbf90610bb8a0525cbd903f7477" title=" " alt="" coords="362,173,469,199"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a44c5fd3a3265bb4f95b52804ed0c3380" title=" " alt="" coords="563,46,733,73"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a7cc50aa837f3ea2e35953e2e5c48e83a" title=" " alt="" coords="563,97,733,123"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="551,173,745,199"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="793,173,896,199"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a54d5d884ac662357df5661d80f5160e3_icgraph.png" border="0" usemap="#aarm__vgic_8h_a54d5d884ac662357df5661d80f5160e3_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a54d5d884ac662357df5661d80f5160e3_icgraph" id="aarm__vgic_8h_a54d5d884ac662357df5661d80f5160e3_icgraph">
<area shape="rect" title=" " alt="" coords="1469,237,1589,264"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a1273f536f3d378a0b259e76591471f7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1273f536f3d378a0b259e76591471f7b">&#9670;&nbsp;</a></span>kvm_vgic_map_is_active()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kvm_vgic_map_is_active </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>vintid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l01022">1022</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;{</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordtype">bool</span> map_is_active;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arm__vgic_8h.html#a92f7a5b2fbbd6b57aaed08e61ba34d43">vgic_initialized</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    irq = <a class="code" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516">vgic_get_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, <a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>, vintid);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    raw_spin_lock_irqsave(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    map_is_active = irq-&gt;<a class="code" href="structvgic__irq.html#ac7e3ed05f0fea2733e1db86963e697e1">hw</a> &amp;&amp; irq-&gt;<a class="code" href="structvgic__irq.html#af53995a2a87457dedc6950c3143cfa05">active</a>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    raw_spin_unlock_irqrestore(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <a class="code" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5">vgic_put_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, irq);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">return</span> map_is_active;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;}</div>
<div class="ttc" id="astructvgic__irq_html_af53995a2a87457dedc6950c3143cfa05"><div class="ttname"><a href="structvgic__irq.html#af53995a2a87457dedc6950c3143cfa05">vgic_irq::active</a></div><div class="ttdeci">bool active</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00138">arm_vgic.h:138</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a1273f536f3d378a0b259e76591471f7b_cgraph.png" border="0" usemap="#aarm__vgic_8h_a1273f536f3d378a0b259e76591471f7b_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a1273f536f3d378a0b259e76591471f7b_cgraph" id="aarm__vgic_8h_a1273f536f3d378a0b259e76591471f7b_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,192,57"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="240,5,341,32"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="240,56,341,83"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="421,5,521,32"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="600,5,735,32"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="389,56,552,83"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="603,56,731,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a1273f536f3d378a0b259e76591471f7b_icgraph.png" border="0" usemap="#aarm__vgic_8h_a1273f536f3d378a0b259e76591471f7b_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a1273f536f3d378a0b259e76591471f7b_icgraph" id="aarm__vgic_8h_a1273f536f3d378a0b259e76591471f7b_icgraph">
<area shape="rect" title=" " alt="" coords="1924,237,2111,264"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1684,237,1876,264"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="ab4243e0ac375259b39c04a6cc6266a9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4243e0ac375259b39c04a6cc6266a9f">&#9670;&nbsp;</a></span>kvm_vgic_map_phys_irq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_map_phys_irq </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>host_irq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>vintid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structirq__ops.html">irq_ops</a> *&#160;</td>
          <td class="paramname"><em>ops</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00514">514</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;{</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq = <a class="code" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516">vgic_get_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, <a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>, vintid);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    BUG_ON(!irq);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    raw_spin_lock_irqsave(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    ret = <a class="code" href="vgic_8c.html#a727bab6843a2191df705d005fa7f764f">kvm_vgic_map_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>, irq, <a class="code" href="structvgic__irq.html#a73308ba335a3372d0ca5cbe918b95622">host_irq</a>, <a class="code" href="structvgic__irq.html#a2986d4afc4ccd4e704cb3f2c9aa2c0a9">ops</a>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    raw_spin_unlock_irqrestore(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5">vgic_put_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, irq);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div>
<div class="ttc" id="astructvgic__irq_html_a2986d4afc4ccd4e704cb3f2c9aa2c0a9"><div class="ttname"><a href="structvgic__irq.html#a2986d4afc4ccd4e704cb3f2c9aa2c0a9">vgic_irq::ops</a></div><div class="ttdeci">struct irq_ops * ops</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00154">arm_vgic.h:154</a></div></div>
<div class="ttc" id="astructvgic__irq_html_a73308ba335a3372d0ca5cbe918b95622"><div class="ttname"><a href="structvgic__irq.html#a73308ba335a3372d0ca5cbe918b95622">vgic_irq::host_irq</a></div><div class="ttdeci">unsigned int host_irq</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00143">arm_vgic.h:143</a></div></div>
<div class="ttc" id="avgic_8c_html_a727bab6843a2191df705d005fa7f764f"><div class="ttname"><a href="vgic_8c.html#a727bab6843a2191df705d005fa7f764f">kvm_vgic_map_irq</a></div><div class="ttdeci">static int kvm_vgic_map_irq(struct kvm_vcpu *vcpu, struct vgic_irq *irq, unsigned int host_irq, struct irq_ops *ops)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00480">vgic.c:480</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_ab4243e0ac375259b39c04a6cc6266a9f_cgraph.png" border="0" usemap="#aarm__vgic_8h_ab4243e0ac375259b39c04a6cc6266a9f_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_ab4243e0ac375259b39c04a6cc6266a9f_cgraph" id="aarm__vgic_8h_ab4243e0ac375259b39c04a6cc6266a9f_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,188,83"/>
<area shape="rect" href="vgic_8c.html#a727bab6843a2191df705d005fa7f764f" title=" " alt="" coords="236,5,381,32"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="258,56,359,83"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="258,107,359,133"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="461,56,561,83"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="640,56,775,83"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="429,107,592,133"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="643,107,771,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_ab4243e0ac375259b39c04a6cc6266a9f_icgraph.png" border="0" usemap="#aarm__vgic_8h_ab4243e0ac375259b39c04a6cc6266a9f_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_ab4243e0ac375259b39c04a6cc6266a9f_icgraph" id="aarm__vgic_8h_ab4243e0ac375259b39c04a6cc6266a9f_icgraph">
<area shape="rect" title=" " alt="" coords="1956,140,2139,167"/>
<area shape="rect" href="arch__timer_8c.html#a6eb7255c40d5b43938e99918b3d9d06a" title=" " alt="" coords="1753,111,1897,137"/>
<area shape="rect" href="arch__timer_8c.html#a9f34b892b5c9b1e79065006b4353c76e" title=" " alt="" coords="1741,162,1908,203"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="1300,45,1479,86"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,245,129,272"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1527,169,1693,196"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1310,169,1469,196"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="1056,68,1252,95"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1081,144,1227,171"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1089,296,1219,323"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1097,397,1211,424"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="873,195,961,221"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,43,751,69"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="825,144,1008,171"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,93,771,120"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,144,732,171"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,195,731,221"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,93,543,120"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="829,347,1005,373"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,355,765,381"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,296,336,323"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="836,245,997,272"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,347,543,389"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,245,777,272"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="877,448,956,475"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,448,740,475"/>
</map>
</div>

</div>
</div>
<a id="a8411f235847aa56055a7a2fefce226c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8411f235847aa56055a7a2fefce226c6">&#9670;&nbsp;</a></span>kvm_vgic_map_resources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_map_resources </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Map the MMIO regions depending on the VGIC model exposed to the guest called on the first VCPU run. Also map the virtual CPU interface into the VM. v2 calls <a class="el" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57">vgic_init()</a> if not already done. v3 and derivatives return an error if the VGIC is not initialized. <a class="el" href="arm__vgic_8h.html#a8a1cb81c34b893dec2bef262c6fafb15">vgic_ready()</a> returns true if this function has succeeded. @kvm: kvm struct pointer </p>

<p class="definition">Definition at line <a class="el" href="vgic-init_8c_source.html#l00456">456</a> of file <a class="el" href="vgic-init_8c_source.html">vgic-init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__dist.html">vgic_dist</a> *dist = &amp;kvm-&gt;arch.vgic;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keyword">enum</span> <a class="code" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1">vgic_type</a> type;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    gpa_t dist_base;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">if</span> (likely(<a class="code" href="arm__vgic_8h.html#a8a1cb81c34b893dec2bef262c6fafb15">vgic_ready</a>(kvm)))</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    mutex_lock(&amp;kvm-&gt;slots_lock);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    mutex_lock(&amp;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arm__vgic_8h.html#a8a1cb81c34b893dec2bef262c6fafb15">vgic_ready</a>(kvm))</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arm__vgic_8h.html#a28961fa9a6313f335b274e0fac503bcf">irqchip_in_kernel</a>(kvm))</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (dist-&gt;<a class="code" href="structvgic__dist.html#a5d26cafc0800ef58cd37f4ab1c83dae7">vgic_model</a> == KVM_DEV_TYPE_ARM_VGIC_V2) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        ret = <a class="code" href="vgic-v2_8c.html#ac8de91a1f816dcd3b3edba1d074a1aca">vgic_v2_map_resources</a>(kvm);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        type = <a class="code" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a9516eb794b5e9d2d4817bb361c699a60">VGIC_V2</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        ret = <a class="code" href="vgic-v3_8c.html#a8c2e4753883533516b45a2bbf9dad1ce">vgic_v3_map_resources</a>(kvm);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        type = <a class="code" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a6556967af9084ab2c8d36e7faf368d1e">VGIC_V3</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    dist-&gt;<a class="code" href="structvgic__dist.html#ad56bf6744cb38822b878d1ab23e524af">ready</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    dist_base = dist-&gt;<a class="code" href="structvgic__dist.html#a64889fb78fa1c835d635165bdc9dbe6e">vgic_dist_base</a>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    mutex_unlock(&amp;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    ret = <a class="code" href="vgic-mmio_8c.html#a8911c23be28d228d12a6b010b8133524">vgic_register_dist_iodev</a>(kvm, dist_base, type);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        kvm_err(<span class="stringliteral">&quot;Unable to register VGIC dist MMIO regions\n&quot;</span>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">goto</span> out_slots;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;out:</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    mutex_unlock(&amp;kvm-&gt;arch.config_lock);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;out_slots:</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    mutex_unlock(&amp;kvm-&gt;slots_lock);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <a class="code" href="vgic-init_8c.html#af08e0c3b0309dbe4472ed185cd2b9e72">kvm_vgic_destroy</a>(kvm);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div>
<div class="ttc" id="aarm__vgic_8h_html_a6e40915cc9873f08ca702678ce237ff1"><div class="ttname"><a href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1">vgic_type</a></div><div class="ttdeci">vgic_type</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00038">arm_vgic.h:38</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_a8a1cb81c34b893dec2bef262c6fafb15"><div class="ttname"><a href="arm__vgic_8h.html#a8a1cb81c34b893dec2bef262c6fafb15">vgic_ready</a></div><div class="ttdeci">#define vgic_ready(k)</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00394">arm_vgic.h:394</a></div></div>
<div class="ttc" id="astructvgic__dist_html_a5d26cafc0800ef58cd37f4ab1c83dae7"><div class="ttname"><a href="structvgic__dist.html#a5d26cafc0800ef58cd37f4ab1c83dae7">vgic_dist::vgic_model</a></div><div class="ttdeci">u32 vgic_model</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00230">arm_vgic.h:230</a></div></div>
<div class="ttc" id="astructvgic__dist_html_ad56bf6744cb38822b878d1ab23e524af"><div class="ttname"><a href="structvgic__dist.html#ad56bf6744cb38822b878d1ab23e524af">vgic_dist::ready</a></div><div class="ttdeci">bool ready</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00226">arm_vgic.h:226</a></div></div>
<div class="ttc" id="avgic-init_8c_html_af08e0c3b0309dbe4472ed185cd2b9e72"><div class="ttname"><a href="vgic-init_8c.html#af08e0c3b0309dbe4472ed185cd2b9e72">kvm_vgic_destroy</a></div><div class="ttdeci">void kvm_vgic_destroy(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-init_8c_source.html#l00397">vgic-init.c:397</a></div></div>
<div class="ttc" id="avgic-mmio_8c_html_a8911c23be28d228d12a6b010b8133524"><div class="ttname"><a href="vgic-mmio_8c.html#a8911c23be28d228d12a6b010b8133524">vgic_register_dist_iodev</a></div><div class="ttdeci">int vgic_register_dist_iodev(struct kvm *kvm, gpa_t dist_base_address, enum vgic_type type)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-mmio_8c_source.html#l01080">vgic-mmio.c:1080</a></div></div>
<div class="ttc" id="avgic-v2_8c_html_ac8de91a1f816dcd3b3edba1d074a1aca"><div class="ttname"><a href="vgic-v2_8c.html#ac8de91a1f816dcd3b3edba1d074a1aca">vgic_v2_map_resources</a></div><div class="ttdeci">int vgic_v2_map_resources(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v2_8c_source.html#l00289">vgic-v2.c:289</a></div></div>
<div class="ttc" id="avgic-v3_8c_html_a8c2e4753883533516b45a2bbf9dad1ce"><div class="ttname"><a href="vgic-v3_8c.html#a8c2e4753883533516b45a2bbf9dad1ce">vgic_v3_map_resources</a></div><div class="ttdeci">int vgic_v3_map_resources(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v3_8c_source.html#l00538">vgic-v3.c:538</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a8411f235847aa56055a7a2fefce226c6_cgraph.png" border="0" usemap="#aarm__vgic_8h_a8411f235847aa56055a7a2fefce226c6_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a8411f235847aa56055a7a2fefce226c6_cgraph" id="aarm__vgic_8h_a8411f235847aa56055a7a2fefce226c6_cgraph">
<area shape="rect" title=" " alt="" coords="5,631,196,657"/>
<area shape="rect" href="vgic-init_8c.html#af08e0c3b0309dbe4472ed185cd2b9e72" title=" " alt="" coords="263,580,404,607"/>
<area shape="rect" href="vgic-mmio_8c.html#a8911c23be28d228d12a6b010b8133524" title=" " alt="" coords="265,1166,402,1207"/>
<area shape="rect" href="vgic-v2_8c.html#ac8de91a1f816dcd3b3edba1d074a1aca" title=" " alt="" coords="244,656,423,683"/>
<area shape="rect" href="vgic-v3_8c.html#a8c2e4753883533516b45a2bbf9dad1ce" title=" " alt="" coords="244,233,423,260"/>
<area shape="rect" href="vgic-init_8c.html#a1002af084b5fbafca1dab97541383180" title=" " alt="" coords="471,419,664,445"/>
<area shape="rect" href="vgic-init_8c.html#a814da4f59c826266ad54a8b5aa870de6" title=" " alt="" coords="481,631,653,657"/>
<area shape="rect" href="vgic-debug_8c.html#a09b8e6f769f95e9667a93dde826b0e1e" title=" " alt="" coords="491,529,643,556"/>
<area shape="rect" href="vgic_8c.html#a573eb768a56ea0b73e234771e0013ffc" title=" " alt="" coords="721,360,897,387"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a4bfec769cd9fe2bddb14200a6147fccd" title=" " alt="" coords="726,411,893,453"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="1009,259,1111,285"/>
<area shape="rect" href="kvm__main_8c.html#a103c02eb7ca545106f3130776c2a8897" title=" " alt="" coords="958,419,1162,445"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="1009,761,1111,788"/>
<area shape="rect" href="vgic-its_8c.html#a58207180090221f6c6529d3c4acad96b" title=" " alt="" coords="735,477,884,518"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="712,761,907,788"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#ac2164da472839a705dfb81d3a3c477c5" title=" " alt="" coords="735,594,884,635"/>
<area shape="rect" href="vgic-v4_8c.html#ac805e466fa8f454112c11904ef8d41ce" title=" " alt="" coords="990,837,1130,864"/>
<area shape="rect" href="vgic-its_8c.html#a922a99eb2d73f90e4fcb4cf7c52f0518" title=" " alt="" coords="988,474,1132,515"/>
<area shape="rect" href="kvm__main_8c.html#a0afe5ce3e9ff1105328b06ec985e3374" title=" " alt="" coords="473,1249,661,1276"/>
<area shape="rect" href="vgic-mmio-v2_8c.html#a99781f95ebe917fea2537d762dded6e9" title=" " alt="" coords="480,1199,655,1225"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#ab423a52c4f34cfe2d13a8da61cba66cb" title=" " alt="" coords="480,1148,655,1175"/>
<area shape="rect" href="kvm__main_8c.html#a75ccec7a81fef145fb3c3a3b5479a86f" title=" " alt="" coords="742,1249,877,1276"/>
<area shape="rect" href="iodev_8h.html#a8999defe529eb3e3870197ef8e39fad5" title=" " alt="" coords="739,1199,880,1225"/>
<area shape="rect" href="mmu_8c.html#aceb0aaa6f23e8883c4fe0b6ef8001f04" title=" " alt="" coords="474,580,661,607"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="529,913,606,940"/>
<area shape="rect" href="vgic-v2_8c.html#a264fb134741ac9d0b075dff21880d8f1" title=" " alt="" coords="490,681,645,708"/>
<area shape="rect" href="pgtable_8c.html#aa6720ffb7274162e966c1995acefe084" title=" " alt="" coords="712,543,907,569"/>
<area shape="rect" href="pgtable_8c.html#a2a6ed7242e033a1f32360cbe0e5c2281" title=" " alt="" coords="987,591,1133,617"/>
<area shape="rect" href="pgtable_8c.html#a239db42e3530e785e70ec04460752a87" title=" " alt="" coords="984,641,1136,668"/>
<area shape="rect" href="pgtable_8c.html#a0368ee3109cb5510bb12fe6b56e0c7f5" title=" " alt="" coords="982,540,1138,567"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="737,863,881,889"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="719,965,900,1006"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="722,1148,897,1175"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="747,1031,871,1057"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="735,1082,884,1123"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="759,913,859,940"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="983,972,1137,999"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="999,1173,1121,1200"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="999,1123,1121,1149"/>
<area shape="rect" href="vgic-v4_8c.html#af99c2f70dd91a57879b3a2f583e49a4a" title=" " alt="" coords="969,913,1151,940"/>
<area shape="rect" href="vgic-v3_8c.html#a98c28ff2dc6b6965cef76e1be35233b1" title=" " alt="" coords="490,81,645,108"/>
<area shape="rect" href="vgic-v4_8c.html#a822de9f2b97fbc48164c88a7c0ac68f1" title=" " alt="" coords="477,233,657,260"/>
<area shape="rect" href="vgic-kvm-device_8c.html#af0cfcc44a93abc13df9a7e364c21cf32" title=" " alt="" coords="734,5,885,32"/>
<area shape="rect" href="vgic_8h.html#a01a6c3c40680e43017d7ba8ec7aadbac" title=" " alt="" coords="973,81,1147,108"/>
<area shape="rect" href="vgic-v3_8c.html#a8bd03445507515b9722165814955f6fa" title=" " alt="" coords="727,107,891,133"/>
<area shape="rect" href="arm_8c.html#a9cb9c824750594d8a51e8501bf5ad239" title=" " alt="" coords="730,309,889,336"/>
<area shape="rect" href="arm_8c.html#a19ccb22603ed9366d148065038f59de3" title=" " alt="" coords="718,157,901,184"/>
<area shape="rect" href="vgic-v4_8c.html#a84caa8431645d33bab1cc210aeb17801" title=" " alt="" coords="726,208,893,235"/>
<area shape="rect" href="vgic-v4_8c.html#aaa920282fd67f50873ceb0030afafc6a" title=" " alt="" coords="727,259,891,285"/>
<area shape="rect" href="kvm__main_8c.html#abaa3f5ff00150487b52dd21c1617bab6" title=" " alt="" coords="955,309,1165,336"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a8411f235847aa56055a7a2fefce226c6_icgraph.png" border="0" usemap="#aarm__vgic_8h_a8411f235847aa56055a7a2fefce226c6_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a8411f235847aa56055a7a2fefce226c6_icgraph" id="aarm__vgic_8h_a8411f235847aa56055a7a2fefce226c6_icgraph">
<area shape="rect" title=" " alt="" coords="404,13,595,39"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="177,5,356,47"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,13,129,39"/>
</map>
</div>

</div>
</div>
<a id="a96f93a2405989082e3693577b6b2eb5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96f93a2405989082e3693577b6b2eb5d">&#9670;&nbsp;</a></span>kvm_vgic_put()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_put </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00949">949</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;{</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">if</span> (unlikely(!<a class="code" href="arm__vgic_8h.html#a92f7a5b2fbbd6b57aaed08e61ba34d43">vgic_initialized</a>(vcpu-&gt;kvm)))</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#ae7d700dc38bbca3ed33730267652d87f">type</a> == <a class="code" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a9516eb794b5e9d2d4817bb361c699a60">VGIC_V2</a>)</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="vgic-v2_8c.html#a7c82d0c75692973442f9002861867d9c">vgic_v2_put</a>(vcpu);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <a class="code" href="vgic-v3_8c.html#a6a9931a18504090acd3d559ba25374ff">vgic_v3_put</a>(vcpu);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;}</div>
<div class="ttc" id="avgic-v2_8c_html_a7c82d0c75692973442f9002861867d9c"><div class="ttname"><a href="vgic-v2_8c.html#a7c82d0c75692973442f9002861867d9c">vgic_v2_put</a></div><div class="ttdeci">void vgic_v2_put(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v2_8c_source.html#l00474">vgic-v2.c:474</a></div></div>
<div class="ttc" id="avgic-v3_8c_html_a6a9931a18504090acd3d559ba25374ff"><div class="ttname"><a href="vgic-v3_8c.html#a6a9931a18504090acd3d559ba25374ff">vgic_v3_put</a></div><div class="ttdeci">void vgic_v3_put(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v3_8c_source.html#l00748">vgic-v3.c:748</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a96f93a2405989082e3693577b6b2eb5d_cgraph.png" border="0" usemap="#aarm__vgic_8h_a96f93a2405989082e3693577b6b2eb5d_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a96f93a2405989082e3693577b6b2eb5d_cgraph" id="aarm__vgic_8h_a96f93a2405989082e3693577b6b2eb5d_cgraph">
<area shape="rect" title=" " alt="" coords="5,97,119,124"/>
<area shape="rect" href="vgic-v2_8c.html#a7c82d0c75692973442f9002861867d9c" title=" " alt="" coords="167,39,267,65"/>
<area shape="rect" href="vgic-v3_8c.html#a6a9931a18504090acd3d559ba25374ff" title=" " alt="" coords="167,123,267,149"/>
<area shape="rect" href="vgic-v2_8c.html#aa92110fc4f1e453fde0e8e720845854f" title=" " alt="" coords="321,5,471,32"/>
<area shape="rect" href="vgic-v3-sr_8c.html#ab70e80f7429729196f62308bdcdb9825" title=" " alt="" coords="315,57,477,98"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a6809b3241d8a98933f3df9eec4948e8b" title=" " alt="" coords="317,123,475,149"/>
<area shape="rect" href="vgic-v3_8c.html#aa3f97179d90d3ed6a8920d1c57496380" title=" " alt="" coords="321,173,471,200"/>
<area shape="rect" href="vgic-v4_8c.html#aeafcb3e6b67ea32ed8e59d009252e565" title=" " alt="" coords="346,224,446,251"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a2a8d56dbda4d0bbd01772b003db6e8cf" title=" " alt="" coords="539,72,706,99"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a0ef2cefc965498ba77c24811c45723be" title=" " alt="" coords="539,123,706,149"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a4c7049da2b551848d3e39293c881f329" title=" " alt="" coords="541,173,704,200"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="525,224,720,251"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="768,224,871,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a96f93a2405989082e3693577b6b2eb5d_icgraph.png" border="0" usemap="#aarm__vgic_8h_a96f93a2405989082e3693577b6b2eb5d_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a96f93a2405989082e3693577b6b2eb5d_icgraph" id="aarm__vgic_8h_a96f93a2405989082e3693577b6b2eb5d_icgraph">
<area shape="rect" title=" " alt="" coords="1463,237,1576,264"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1263,237,1415,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1080,376,1204,403"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="1101,300,1183,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a37d0e0f4c579bc38afe8d5f91529a772"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37d0e0f4c579bc38afe8d5f91529a772">&#9670;&nbsp;</a></span>kvm_vgic_reset_mapped_irq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_reset_mapped_irq </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>vintid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>kvm_vgic_reset_mapped_irq - Reset a mapped IRQ @vcpu: The VCPU pointer @vintid: The INTID of the interrupt</p>
<p>Reset the active and pending states of a mapped interrupt. Kernel subsystems injecting mapped interrupts should reset their interrupt lines when we are doing a reset of the VM. </p>

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00540">540</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;{</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq = <a class="code" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516">vgic_get_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, <a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>, vintid);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">if</span> (!irq-&gt;<a class="code" href="structvgic__irq.html#ac7e3ed05f0fea2733e1db86963e697e1">hw</a>)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    raw_spin_lock_irqsave(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    irq-&gt;<a class="code" href="structvgic__irq.html#af53995a2a87457dedc6950c3143cfa05">active</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    irq-&gt;<a class="code" href="structvgic__irq.html#a91bd325ff1822b894b2a7c6930128083">pending_latch</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    irq-&gt;<a class="code" href="structvgic__irq.html#a7dfb2c22e8a6c749facfdf07c70e7cf3">line_level</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    raw_spin_unlock_irqrestore(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;out:</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5">vgic_put_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, irq);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a37d0e0f4c579bc38afe8d5f91529a772_cgraph.png" border="0" usemap="#aarm__vgic_8h_a37d0e0f4c579bc38afe8d5f91529a772_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a37d0e0f4c579bc38afe8d5f91529a772_cgraph" id="aarm__vgic_8h_a37d0e0f4c579bc38afe8d5f91529a772_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,215,57"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="263,5,364,32"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="263,56,364,83"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="443,5,543,32"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="623,5,757,32"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="412,56,575,83"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="626,56,754,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a37d0e0f4c579bc38afe8d5f91529a772_icgraph.png" border="0" usemap="#aarm__vgic_8h_a37d0e0f4c579bc38afe8d5f91529a772_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a37d0e0f4c579bc38afe8d5f91529a772_icgraph" id="aarm__vgic_8h_a37d0e0f4c579bc38afe8d5f91529a772_icgraph">
<area shape="rect" title=" " alt="" coords="1449,81,1659,108"/>
<area shape="rect" href="arch__timer_8c.html#a11b9b6e6338bbec6085332661c934e91" title=" " alt="" coords="1231,81,1401,108"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1053,81,1183,108"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="829,5,1005,32"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="619,48,781,75"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,107,336,133"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="837,157,998,184"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="398,41,557,82"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,132,129,159"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="384,157,571,184"/>
</map>
</div>

</div>
</div>
<a id="a99527df04c2db316d7f8c1733c18d99e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99527df04c2db316d7f8c1733c18d99e">&#9670;&nbsp;</a></span>kvm_vgic_set_owner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_set_owner </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>intid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>owner</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>kvm_vgic_set_owner - Set the owner of an interrupt for a VM</p>
<p>@vcpu: Pointer to the VCPU (used for PPIs) @intid: The virtual INTID identifying the interrupt (PPI or SPI) @owner: Opaque pointer to the owner</p>
<p>Returns 0 if intid is not already used by another in-kernel device and the owner is set, otherwise returns an error code. </p>

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00601">601</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;{</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arm__vgic_8h.html#a92f7a5b2fbbd6b57aaed08e61ba34d43">vgic_initialized</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">return</span> -EAGAIN;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">/* SGIs and LPIs cannot be wired up to any device */</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arm__vgic_8h.html#a86535c3eff6bfc9d2e4224c73ebfa57d">irq_is_ppi</a>(<a class="code" href="structvgic__irq.html#a52b9a2e701d89765fc16feb0323ef277">intid</a>) &amp;&amp; !<a class="code" href="arm__vgic_8h.html#adea629c518405f94a45bbe647ef71fcc">vgic_valid_spi</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, <a class="code" href="structvgic__irq.html#a52b9a2e701d89765fc16feb0323ef277">intid</a>))</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    irq = <a class="code" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516">vgic_get_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, <a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>, <a class="code" href="structvgic__irq.html#a52b9a2e701d89765fc16feb0323ef277">intid</a>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    raw_spin_lock_irqsave(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">if</span> (irq-&gt;<a class="code" href="structvgic__irq.html#a59f5d7d46d7a0d6fa38e6514d8264422">owner</a> &amp;&amp; irq-&gt;<a class="code" href="structvgic__irq.html#a59f5d7d46d7a0d6fa38e6514d8264422">owner</a> != <a class="code" href="structvgic__irq.html#a59f5d7d46d7a0d6fa38e6514d8264422">owner</a>)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        ret = -EEXIST;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        irq-&gt;<a class="code" href="structvgic__irq.html#a59f5d7d46d7a0d6fa38e6514d8264422">owner</a> = <a class="code" href="structvgic__irq.html#a59f5d7d46d7a0d6fa38e6514d8264422">owner</a>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    raw_spin_unlock_irqrestore(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;}</div>
<div class="ttc" id="aarm__vgic_8h_html_a86535c3eff6bfc9d2e4224c73ebfa57d"><div class="ttname"><a href="arm__vgic_8h.html#a86535c3eff6bfc9d2e4224c73ebfa57d">irq_is_ppi</a></div><div class="ttdeci">#define irq_is_ppi(irq)</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00034">arm_vgic.h:34</a></div></div>
<div class="ttc" id="aarm__vgic_8h_html_adea629c518405f94a45bbe647ef71fcc"><div class="ttname"><a href="arm__vgic_8h.html#adea629c518405f94a45bbe647ef71fcc">vgic_valid_spi</a></div><div class="ttdeci">#define vgic_valid_spi(k, i)</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00395">arm_vgic.h:395</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a99527df04c2db316d7f8c1733c18d99e_cgraph.png" border="0" usemap="#aarm__vgic_8h_a99527df04c2db316d7f8c1733c18d99e_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a99527df04c2db316d7f8c1733c18d99e_cgraph" id="aarm__vgic_8h_a99527df04c2db316d7f8c1733c18d99e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,164,32"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="212,5,313,32"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="361,5,461,32"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="509,5,644,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a99527df04c2db316d7f8c1733c18d99e_icgraph.png" border="0" usemap="#aarm__vgic_8h_a99527df04c2db316d7f8c1733c18d99e_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a99527df04c2db316d7f8c1733c18d99e_icgraph" id="aarm__vgic_8h_a99527df04c2db316d7f8c1733c18d99e_icgraph">
<area shape="rect" title=" " alt="" coords="1340,35,1499,61"/>
<area shape="rect" href="pmu-emul_8c.html#a711e10b6fe664801230c4856c3840e90" title=" " alt="" coords="1121,9,1292,36"/>
<area shape="rect" href="arch__timer_8c.html#a7a37a6f350a857f42fe872aeebc8e2e4" title=" " alt="" coords="1129,60,1284,87"/>
<area shape="rect" href="pmu-emul_8c.html#af3085467d010c2e9c3abfcfbf086156a" title=" " alt="" coords="873,9,1073,36"/>
<area shape="rect" href="guest_8c.html#a932910ec1cc3b5a552da035d4d74a4eb" title=" " alt="" coords="611,8,825,35"/>
<area shape="rect" href="arm_8c.html#adcf63ac6c9c7383fcf0dcb2ce097afbe" title=" " alt="" coords="384,5,563,32"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,8,336,35"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,35,129,61"/>
<area shape="rect" href="arch__timer_8c.html#a6eb7255c40d5b43938e99918b3d9d06a" title=" " alt="" coords="901,60,1045,87"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="384,57,563,98"/>
</map>
</div>

</div>
</div>
<a id="ab5dcaa98f287aec5083bd60daf115d71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5dcaa98f287aec5083bd60daf115d71">&#9670;&nbsp;</a></span>kvm_vgic_setup_default_irq_routing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_setup_default_irq_routing </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>kvm_vgic_setup_default_irq_routing: Setup a default flat gsi routing table mapping all SPIs </p>

<p class="definition">Definition at line <a class="el" href="vgic-irqfd_8c_source.html#l00135">135</a> of file <a class="el" href="vgic-irqfd_8c_source.html">vgic-irqfd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keyword">struct </span>kvm_irq_routing_entry *entries;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__dist.html">vgic_dist</a> *dist = &amp;kvm-&gt;arch.vgic;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    u32 nr = dist-&gt;<a class="code" href="structvgic__dist.html#a27c507dee00888a89811be38e7ac727e">nr_spis</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">int</span> i, ret;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    entries = kcalloc(nr, <span class="keyword">sizeof</span>(*entries), GFP_KERNEL_ACCOUNT);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span> (!entries)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nr; i++) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        entries[i].gsi = i;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        entries[i].type = KVM_IRQ_ROUTING_IRQCHIP;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        entries[i].u.irqchip.irqchip = 0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        entries[i].u.irqchip.pin = i;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    ret = <a class="code" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a">kvm_set_irq_routing</a>(kvm, entries, nr, 0);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    kfree(entries);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
<div class="ttc" id="airqchip_8c_html_a2c54cf3c324c7d2b9190fffcf4a1f20a"><div class="ttname"><a href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a">kvm_set_irq_routing</a></div><div class="ttdeci">int kvm_set_irq_routing(struct kvm *kvm, const struct kvm_irq_routing_entry *ue, unsigned nr, unsigned flags)</div><div class="ttdef"><b>Definition:</b> <a href="irqchip_8c_source.html#l00168">irqchip.c:168</a></div></div>
<div class="ttc" id="astructvgic__dist_html_a27c507dee00888a89811be38e7ac727e"><div class="ttname"><a href="structvgic__dist.html#a27c507dee00888a89811be38e7ac727e">vgic_dist::nr_spis</a></div><div class="ttdeci">int nr_spis</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00244">arm_vgic.h:244</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_ab5dcaa98f287aec5083bd60daf115d71_cgraph.png" border="0" usemap="#aarm__vgic_8h_ab5dcaa98f287aec5083bd60daf115d71_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_ab5dcaa98f287aec5083bd60daf115d71_cgraph" id="aarm__vgic_8h_ab5dcaa98f287aec5083bd60daf115d71_cgraph">
<area shape="rect" title=" " alt="" coords="5,795,187,837"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="235,803,389,829"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="437,752,603,779"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="444,803,596,829"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="651,512,823,539"/>
<area shape="rect" href="vgic-irqfd_8c.html#affb5599a3efafc186b72e78e4b31e904" title=" " alt="" coords="885,461,994,488"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="871,512,1008,539"/>
<area shape="rect" href="vgic-irqfd_8c.html#a93415dbe2d5c7166c8f3f91be7c5d5da" title=" " alt="" coords="1059,411,1205,437"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="1990,689,2093,716"/>
<area shape="rect" href="vgic-its_8c.html#a53bf66e96dae9553e637fa69e8835365" title=" " alt="" coords="1059,461,1205,488"/>
<area shape="rect" href="vgic-its_8c.html#a352c8627ccf81a8154ae2275c7d50659" title=" " alt="" coords="1258,345,1426,386"/>
<area shape="rect" href="vgic-its_8c.html#ad62375be0591178764e98b79cd7217bf" title=" " alt="" coords="1265,243,1419,269"/>
<area shape="rect" href="vgic-its_8c.html#a94bbb30efc49ad5494a7f4b1410dbe01" title=" " alt="" coords="1281,512,1403,539"/>
<area shape="rect" href="vgic-its_8c.html#ab8e3bef933af0cc51b05259d801be26d" title=" " alt="" coords="1711,360,1873,387"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="1511,411,1612,437"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="1476,268,1647,295"/>
<area shape="rect" href="vgic-its_8c.html#aa5825fcbd841b62853870d25976d018b" title=" " alt="" coords="1953,259,2129,285"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="1974,360,2109,387"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="1960,309,2123,336"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="2197,309,2325,336"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="1731,157,1853,184"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="1721,208,1863,235"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="1937,157,2145,184"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="1965,107,2118,133"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="1983,208,2099,235"/>
<area shape="rect" href="vgic-its_8c.html#a3fe23d687675cef46a95e36cf14d04e1" title=" " alt="" coords="1486,107,1637,133"/>
<area shape="rect" href="vgic-its_8c.html#a0fb230e293b92c9fb746ad7b97ac68d5" title=" " alt="" coords="1721,107,1863,133"/>
<area shape="rect" href="vgic-its_8c.html#ae32cde43818922d2ecf800a3de102b75" title=" " alt="" coords="1757,5,1827,32"/>
<area shape="rect" href="vgic-its_8c.html#ad9756268e1c22946f868e3255f916aa6" title=" " alt="" coords="1695,259,1889,285"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#aa37f9ed0ed7921675bc4167d4a9d9261" title=" " alt="" coords="1723,56,1861,83"/>
<area shape="rect" href="vgic-its_8c.html#aeb2ca1f1a8fef2826c3c7e466dad2cb7" title=" " alt="" coords="1982,5,2101,32"/>
<area shape="rect" href="kvm__main_8c.html#acb4d46ae6cc918253046320805f63a95" title=" " alt="" coords="1482,512,1641,539"/>
<area shape="rect" href="kvm__main_8c.html#a94bf2e0af8d9af8807a6a92ffb01cc1c" title=" " alt="" coords="1697,512,1887,539"/>
<area shape="rect" href="kvm__main_8c.html#a75ccec7a81fef145fb3c3a3b5479a86f" title=" " alt="" coords="2193,512,2328,539"/>
<area shape="rect" href="kvm__main_8c.html#aa52366417ec3708a05183231a3227d9d" title=" " alt="" coords="1958,487,2125,513"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="1056,512,1208,539"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="1291,461,1393,488"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="1287,613,1397,640"/>
<area shape="rect" href="vgic_8c.html#a19d9c44a40cc76ccbd25bd8e0ec38a08" title=" " alt="" coords="1256,563,1428,589"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="1511,461,1611,488"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="1523,867,1600,893"/>
<area shape="rect" href="vgic-init_8c.html#a0f9be5cc88c88f6c0180c53b72818d3b" title=" " alt="" coords="1720,816,1864,843"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1701,1086,1883,1127"/>
<area shape="rect" href="vgic-init_8c.html#a2eee0060a3bdcd2a9e8fe1451a3a3fc2" title=" " alt="" coords="1705,1035,1879,1061"/>
<area shape="rect" href="vgic-debug_8c.html#a42534d23071b4f3c441c5f82f9e5c1ce" title=" " alt="" coords="1730,867,1854,893"/>
<area shape="rect" href="vgic-its_8c.html#afd97b5d03d2b30ae4481443cdea2e739" title=" " alt="" coords="1717,918,1867,959"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="1695,765,1889,792"/>
<area shape="rect" href="vgic-v4_8c.html#a802a906ad744a75b5af33bbd6b31237c" title=" " alt="" coords="1742,984,1842,1011"/>
<area shape="rect" href="vgic-v2_8c.html#a4e8ee3d5f7c8fadbf0a645df67a1c5a2" title=" " alt="" coords="1980,1009,2103,1036"/>
<area shape="rect" href="vgic-v3_8c.html#abe9a2245dfa0d76d61c99b60f714a513" title=" " alt="" coords="1980,1060,2103,1087"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_ab5dcaa98f287aec5083bd60daf115d71_icgraph.png" border="0" usemap="#aarm__vgic_8h_ab5dcaa98f287aec5083bd60daf115d71_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_ab5dcaa98f287aec5083bd60daf115d71_icgraph" id="aarm__vgic_8h_ab5dcaa98f287aec5083bd60daf115d71_icgraph">
<area shape="rect" title=" " alt="" coords="2821,485,3003,526"/>
<area shape="rect" href="vgic-init_8c.html#a39a12fe5ed5534efda33bb215a320a57" title=" " alt="" coords="2696,492,2773,519"/>
<area shape="rect" href="vgic-init_8c.html#a3c860e1d043352d9a02f4780b58e5af6" title=" " alt="" coords="2499,365,2609,392"/>
<area shape="rect" href="vgic-kvm-device_8c.html#a6aadc4684bf7ca54e4a3d91f9e10310c" title=" " alt="" coords="2469,441,2639,468"/>
<area shape="rect" href="vgic-kvm-device_8c.html#a78d5c53181a4adf55a58d8277fb751af" title=" " alt="" coords="2460,492,2648,519"/>
<area shape="rect" href="vgic-v2_8c.html#ac8de91a1f816dcd3b3edba1d074a1aca" title=" " alt="" coords="2465,593,2643,620"/>
<area shape="rect" href="vgic_8c.html#a87038ce452e0054b853c10ccbbcc78a4" title=" " alt="" coords="2241,340,2393,367"/>
<area shape="rect" href="pmu-emul_8c.html#ac79256eb94d7599687d3294cd40d10b4" title=" " alt="" coords="1086,411,1265,437"/>
<area shape="rect" href="arch__timer_8c.html#a5abc04b494763cd0814855753e56671f" title=" " alt="" coords="2004,213,2173,240"/>
<area shape="rect" href="arm_8c.html#a1cc94da0709805c40af7785f8c5811bf" title=" " alt="" coords="2004,163,2173,189"/>
<area shape="rect" href="vgic-irqfd_8c.html#aaba342a8b6308d37735bc46dbf9a6828" title=" " alt="" coords="2020,340,2157,367"/>
<area shape="rect" href="pmu-emul_8c.html#ab0f1f020b6774de3fb4ff4c8b4e45a5c" title=" " alt="" coords="845,411,1029,437"/>
<area shape="rect" href="pmu-emul_8c.html#ae6434d5e6ad74c608886c368e56d67bc" title=" " alt="" coords="846,360,1029,387"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="611,309,797,336"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,309,129,336"/>
<area shape="rect" href="arch__timer_8c.html#a7d59bcd17bdbce3017dbc041cd6e9629" title=" " alt="" coords="1763,239,1947,265"/>
<area shape="rect" href="arch__timer_8c.html#a1c4f03de391e27f5ba91d10b6dfab0bf" title=" " alt="" coords="1759,20,1951,47"/>
<area shape="rect" href="arch__timer_8c.html#a8fb06d125602c5b00fa9c213aa7e2520" title=" " alt="" coords="1772,71,1939,113"/>
<area shape="rect" href="arch__timer_8c.html#a11b9b6e6338bbec6085332661c934e91" title=" " alt="" coords="1321,184,1492,211"/>
<area shape="rect" href="arch__timer_8c.html#acea899fae895cedf39458ed51af3cb1a" title=" " alt="" coords="1796,137,1915,164"/>
<area shape="rect" href="arch__timer_8c.html#a7af96c32754607120bf365569aac71c0" title=" " alt="" coords="1764,289,1947,316"/>
<area shape="rect" href="arch__timer_8c.html#a27c9feb35e6d7126c054c3325fea59b0" title=" " alt="" coords="1547,249,1699,276"/>
<area shape="rect" href="arm_8c.html#a040f9b021372ae855b2cc25a0c07da7a" title=" " alt="" coords="1343,259,1471,285"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="1119,259,1231,285"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1540,71,1707,97"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1327,75,1486,101"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="1077,5,1273,32"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1103,56,1248,83"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1111,157,1240,184"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1118,107,1233,133"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="893,259,981,285"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="870,5,1005,32"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="849,107,1025,133"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="623,99,785,125"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,157,336,184"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="857,208,1018,235"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="394,91,553,133"/>
<area shape="rect" href="arch__timer_8c.html#a0209ad4256c7a1fd5ea70b6abe030954" title=" " alt="" coords="1540,122,1707,163"/>
<area shape="rect" href="sys__regs_8c.html#a9457451d95fa776f653cff6c2a8d31f9" title=" " alt="" coords="1335,129,1478,156"/>
<area shape="rect" href="arch__timer_8c.html#a6ae73bff466fcdc60319f9726d53b571" title=" " alt="" coords="1541,305,1706,332"/>
<area shape="rect" href="vgic-irqfd_8c.html#ae7b7837b6e17bc60af3f4d81e9a4147e" title=" " alt="" coords="1755,340,1956,367"/>
<area shape="rect" href="vgic-irqfd_8c.html#aceb0f3f9718caf022b2ff6f982fee020" title=" " alt="" coords="1769,391,1941,417"/>
<area shape="rect" href="irqchip_8c.html#ab06caa34c3a7189a433815036dd3ebb3" title=" " alt="" coords="1547,391,1699,417"/>
<area shape="rect" href="irqchip_8c.html#a2c54cf3c324c7d2b9190fffcf4a1f20a" title=" " alt="" coords="1329,492,1484,519"/>
<area shape="rect" href="vgic-irqfd_8c.html#ab5dcaa98f287aec5083bd60daf115d71" title=" " alt="" coords="1085,506,1266,547"/>
<area shape="rect" href="vgic-kvm-device_8c.html#a37a5c9125b0504633553497ae8c7ce9c" title=" " alt="" coords="2252,441,2381,468"/>
<area shape="rect" href="vgic-kvm-device_8c.html#aee48777d58c65e5b91c0f85e2eae843e" title=" " alt="" coords="2252,391,2381,417"/>
<area shape="rect" href="vgic-kvm-device_8c.html#a3bb10b83ef8325ecaa3671e9fe9c528c" title=" " alt="" coords="2251,492,2382,519"/>
<area shape="rect" href="vgic-init_8c.html#a8411f235847aa56055a7a2fefce226c6" title=" " alt="" coords="2221,593,2412,620"/>
<area shape="rect" href="arm_8c.html#a163f3db5fe1d973be2855f4a479a5c8c" title=" " alt="" coords="384,462,563,503"/>
</map>
</div>

</div>
</div>
<a id="a76c600af416fb73e40611d80115edc03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76c600af416fb73e40611d80115edc03">&#9670;&nbsp;</a></span>kvm_vgic_sync_hwstate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_sync_hwstate </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00875">875</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;{</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordtype">int</span> used_lrs;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">/* An empty ap_list_head implies used_lrs == 0 */</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">if</span> (list_empty(&amp;vcpu-&gt;arch.vgic_cpu.ap_list_head))</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="vgic_8c.html#a84556e1b8dbc13c53d1f5ac99eb68bfa">can_access_vgic_from_kernel</a>())</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <a class="code" href="vgic_8c.html#a452e7612799aa3bf3f7819ca4c202ef7">vgic_save_state</a>(vcpu);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">if</span> (!static_branch_unlikely(&amp;<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a37d2313a81427d89abba1c628f603890">gicv3_cpuif</a>))</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        used_lrs = vcpu-&gt;arch.vgic_cpu.vgic_v2.used_lrs;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        used_lrs = vcpu-&gt;arch.vgic_cpu.vgic_v3.used_lrs;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">if</span> (used_lrs)</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <a class="code" href="vgic_8c.html#ad42413b2202ba95d0b76067b240b9c52">vgic_fold_lr_state</a>(vcpu);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <a class="code" href="vgic_8c.html#ae8f3490d589fa019869fe67839e3c748">vgic_prune_ap_list</a>(vcpu);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;}</div>
<div class="ttc" id="avgic_8c_html_a452e7612799aa3bf3f7819ca4c202ef7"><div class="ttname"><a href="vgic_8c.html#a452e7612799aa3bf3f7819ca4c202ef7">vgic_save_state</a></div><div class="ttdeci">static void vgic_save_state(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00866">vgic.c:866</a></div></div>
<div class="ttc" id="avgic_8c_html_ad42413b2202ba95d0b76067b240b9c52"><div class="ttname"><a href="vgic_8c.html#ad42413b2202ba95d0b76067b240b9c52">vgic_fold_lr_state</a></div><div class="ttdeci">static void vgic_fold_lr_state(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00734">vgic.c:734</a></div></div>
<div class="ttc" id="avgic_8c_html_ae8f3490d589fa019869fe67839e3c748"><div class="ttname"><a href="vgic_8c.html#ae8f3490d589fa019869fe67839e3c748">vgic_prune_ap_list</a></div><div class="ttdeci">static void vgic_prune_ap_list(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00633">vgic.c:633</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a76c600af416fb73e40611d80115edc03_cgraph.png" border="0" usemap="#aarm__vgic_8h_a76c600af416fb73e40611d80115edc03_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a76c600af416fb73e40611d80115edc03_cgraph" id="aarm__vgic_8h_a76c600af416fb73e40611d80115edc03_cgraph">
<area shape="rect" title=" " alt="" coords="5,251,187,277"/>
<area shape="rect" href="vgic_8c.html#a84556e1b8dbc13c53d1f5ac99eb68bfa" title=" " alt="" coords="235,134,403,175"/>
<area shape="rect" href="vgic_8c.html#ad42413b2202ba95d0b76067b240b9c52" title=" " alt="" coords="250,200,387,227"/>
<area shape="rect" href="vgic_8c.html#ae8f3490d589fa019869fe67839e3c748" title=" " alt="" coords="247,276,390,303"/>
<area shape="rect" href="vgic_8c.html#a452e7612799aa3bf3f7819ca4c202ef7" title=" " alt="" coords="255,440,382,467"/>
<area shape="rect" href="vgic-v2_8c.html#a7627ef75f37a19085dece7f4d26ad898" title=" " alt="" coords="453,187,613,213"/>
<area shape="rect" href="vgic-v3_8c.html#a3d53ba6e7f70704effc37ea2c4b0c04b" title=" " alt="" coords="453,136,613,163"/>
<area shape="rect" href="vgic-v2_8c.html#adda8c091cf8da54207b9f8e27ddcade7" title=" " alt="" coords="699,187,834,213"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="716,85,817,112"/>
<area shape="rect" href="vgic_8c.html#a19d27bba8dd17f9ae9c8284444df030b" title=" " alt="" coords="665,136,869,163"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="716,237,817,264"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="968,5,1068,32"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="1165,5,1300,32"/>
<area shape="rect" href="vgic_8c.html#a44a31fe53851677c742d5b2a340e2f56" title=" " alt="" coords="945,158,1091,199"/>
<area shape="rect" href="vgic_8h.html#a9c8f3a32a17b2384ea1cc0c6e0340ad7" title=" " alt="" coords="943,223,1093,265"/>
<area shape="rect" href="arm__vgic_8h.html#ad8001fedb7a2cb065c38833241e86b5c" title=" " alt="" coords="919,56,1117,83"/>
<area shape="rect" href="vgic_8c.html#a6daedd3eec82ca8b68db82b750a24f67" title=" " alt="" coords="925,107,1111,133"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="937,289,1099,316"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="1169,289,1297,316"/>
<area shape="rect" href="vgic-v3_8c.html#af06b2ebdf897b8d96928fd86e3bca056" title=" " alt="" coords="699,35,834,61"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="471,339,594,365"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="461,288,604,315"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="663,389,871,416"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="690,339,843,365"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="709,288,825,315"/>
<area shape="rect" href="vgic-v3-sr_8c.html#aa2ba3aae7f56d0a80723db01139371f5" title=" " alt="" coords="451,491,615,517"/>
<area shape="rect" href="vgic-v2_8c.html#abaef53794d924f0f73627a2b8d3c5b5c" title=" " alt="" coords="457,440,608,467"/>
<area shape="rect" href="vgic-v3-sr_8c.html#ac20010d5e6c0f8ad7d2ef87d429954b1" title=" " alt="" coords="705,541,828,568"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a161e7bd7fc63e0a7fdb5fab98711d711" title=" " alt="" coords="706,491,827,517"/>
<area shape="rect" href="vgic-v2_8c.html#acfae48b44d62ba6209e60eb041a96b3b" title=" " alt="" coords="729,440,805,467"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a76c600af416fb73e40611d80115edc03_icgraph.png" border="0" usemap="#aarm__vgic_8h_a76c600af416fb73e40611d80115edc03_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a76c600af416fb73e40611d80115edc03_icgraph" id="aarm__vgic_8h_a76c600af416fb73e40611d80115edc03_icgraph">
<area shape="rect" title=" " alt="" coords="412,5,593,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a4199ace0bb639bc69d06a2ce1ee0d1ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4199ace0bb639bc69d06a2ce1ee0d1ff">&#9670;&nbsp;</a></span>kvm_vgic_unmap_phys_irq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_unmap_phys_irq </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>vintid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00557">557</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;{</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arm__vgic_8h.html#a92f7a5b2fbbd6b57aaed08e61ba34d43">vgic_initialized</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordflow">return</span> -EAGAIN;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    irq = <a class="code" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516">vgic_get_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, <a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>, vintid);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    BUG_ON(!irq);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    raw_spin_lock_irqsave(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="vgic_8c.html#aeaf2d7fa188efb40aab886a1e19f14d8">kvm_vgic_unmap_irq</a>(irq);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    raw_spin_unlock_irqrestore(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5">vgic_put_irq</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm, irq);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="ttc" id="avgic_8c_html_aeaf2d7fa188efb40aab886a1e19f14d8"><div class="ttname"><a href="vgic_8c.html#aeaf2d7fa188efb40aab886a1e19f14d8">kvm_vgic_unmap_irq</a></div><div class="ttdeci">static void kvm_vgic_unmap_irq(struct vgic_irq *irq)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8c_source.html#l00507">vgic.c:507</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a4199ace0bb639bc69d06a2ce1ee0d1ff_cgraph.png" border="0" usemap="#aarm__vgic_8h_a4199ace0bb639bc69d06a2ce1ee0d1ff_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a4199ace0bb639bc69d06a2ce1ee0d1ff_cgraph" id="aarm__vgic_8h_a4199ace0bb639bc69d06a2ce1ee0d1ff_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,204,83"/>
<area shape="rect" href="vgic_8c.html#aeaf2d7fa188efb40aab886a1e19f14d8" title=" " alt="" coords="252,5,413,32"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="282,56,383,83"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="282,107,383,133"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="493,56,593,83"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="672,56,807,83"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="461,107,624,133"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="675,107,803,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a4199ace0bb639bc69d06a2ce1ee0d1ff_icgraph.png" border="0" usemap="#aarm__vgic_8h_a4199ace0bb639bc69d06a2ce1ee0d1ff_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a4199ace0bb639bc69d06a2ce1ee0d1ff_icgraph" id="aarm__vgic_8h_a4199ace0bb639bc69d06a2ce1ee0d1ff_icgraph">
<area shape="rect" title=" " alt="" coords="1899,237,2097,264"/>
<area shape="rect" href="arch__timer_8c.html#a9f34b892b5c9b1e79065006b4353c76e" title=" " alt="" coords="1684,230,1851,271"/>
<area shape="rect" href="arch__timer_8c.html#a4bf6ac76380146820b45b06feb3eab27" title=" " alt="" coords="1469,237,1636,264"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,237,1421,264"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,31,1021,57"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,136,1215,163"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,237,1207,264"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,376,1199,403"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,300,1186,327"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,5,751,32"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,107,1015,133"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,157,771,184"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="636,56,732,83"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,107,731,133"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,145,543,172"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,161,1011,188"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,208,765,235"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,263,336,289"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,313,1004,340"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,197,543,238"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,288,129,315"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,313,777,340"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,415,963,441"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,415,740,441"/>
</map>
</div>

</div>
</div>
<a id="a90f479062f56d4785922e5dfb0113838"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90f479062f56d4785922e5dfb0113838">&#9670;&nbsp;</a></span>kvm_vgic_v4_set_forwarding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_v4_set_forwarding </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>irq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_kernel_irq_routing_entry *&#160;</td>
          <td class="paramname"><em>irq_entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic-v4_8c_source.html#l00411">411</a> of file <a class="el" href="vgic-v4_8c_source.html">vgic-v4.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;{</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__its.html">vgic_its</a> *its;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keyword">struct </span>its_vlpi_map map;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f">vgic_supports_direct_msis</a>(kvm))</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">     * Get the ITS, and escape early on error (not a valid</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">     * doorbell for any of our vITSs).</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    its = <a class="code" href="vgic-v4_8c.html#a563a18a1e67555a71cb46e17f0abe770">vgic_get_its</a>(kvm, irq_entry);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (IS_ERR(its))</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    mutex_lock(&amp;its-&gt;<a class="code" href="structvgic__its.html#aeba8b31468953402f9b095454f9dca33">its_lock</a>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">/* Perform the actual DevID/EventID -&gt; LPI translation. */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    ret = <a class="code" href="vgic-its_8c.html#a3fe23d687675cef46a95e36cf14d04e1">vgic_its_resolve_lpi</a>(kvm, its, irq_entry-&gt;msi.devid,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                   irq_entry-&gt;msi.data, &amp;irq);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">/* Silently exit if the vLPI is already mapped */</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">if</span> (irq-&gt;<a class="code" href="structvgic__irq.html#ac7e3ed05f0fea2733e1db86963e697e1">hw</a>)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">     * Emit the mapping request. If it fails, the ITS probably</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">     * isn&#39;t v4 compatible, so let&#39;s silently bail out. Holding</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">     * the ITS lock should ensure that nothing can modify the</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">     * target vcpu.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    map = (<span class="keyword">struct </span>its_vlpi_map) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        .vm     = &amp;kvm-&gt;arch.vgic.its_vm,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        .vpe        = &amp;irq-&gt;<a class="code" href="structvgic__irq.html#ad9e41922c26541e90bdfe7cd9a1fa6c5">target_vcpu</a>-&gt;arch.vgic_cpu.vgic_v3.its_vpe,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        .vintid     = irq-&gt;<a class="code" href="structvgic__irq.html#a52b9a2e701d89765fc16feb0323ef277">intid</a>,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        .properties = ((irq-&gt;<a class="code" href="structvgic__irq.html#a32b80991e10a1755a169bb40892ad26b">priority</a> &amp; 0xfc) |</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                   (irq-&gt;<a class="code" href="structvgic__irq.html#a95ddef5ecf585bc624234ce4c9f13102">enabled</a> ? LPI_PROP_ENABLED : 0) |</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                   LPI_PROP_GROUP1),</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        .db_enabled = <span class="keyword">true</span>,</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    };</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    ret = its_map_vlpi(virq, &amp;map);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    irq-&gt;<a class="code" href="structvgic__irq.html#ac7e3ed05f0fea2733e1db86963e697e1">hw</a>     = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    irq-&gt;<a class="code" href="structvgic__irq.html#a73308ba335a3372d0ca5cbe918b95622">host_irq</a>   = virq;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    atomic_inc(&amp;map.vpe-&gt;vlpi_count);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">/* Transfer pending state */</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    raw_spin_lock_irqsave(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (irq-&gt;<a class="code" href="structvgic__irq.html#a91bd325ff1822b894b2a7c6930128083">pending_latch</a>) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        ret = irq_set_irqchip_state(irq-&gt;<a class="code" href="structvgic__irq.html#a73308ba335a3372d0ca5cbe918b95622">host_irq</a>,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        IRQCHIP_STATE_PENDING,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                        irq-&gt;<a class="code" href="structvgic__irq.html#a91bd325ff1822b894b2a7c6930128083">pending_latch</a>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        WARN_RATELIMIT(ret, <span class="stringliteral">&quot;IRQ %d&quot;</span>, irq-&gt;<a class="code" href="structvgic__irq.html#a73308ba335a3372d0ca5cbe918b95622">host_irq</a>);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">         * Clear pending_latch and communicate this state</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">         * change via vgic_queue_irq_unlock.</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        irq-&gt;<a class="code" href="structvgic__irq.html#a91bd325ff1822b894b2a7c6930128083">pending_latch</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c">vgic_queue_irq_unlock</a>(kvm, irq, flags);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        raw_spin_unlock_irqrestore(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>, flags);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;out:</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    mutex_unlock(&amp;its-&gt;<a class="code" href="structvgic__its.html#aeba8b31468953402f9b095454f9dca33">its_lock</a>);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div>
<div class="ttc" id="astructvgic__irq_html_a32b80991e10a1755a169bb40892ad26b"><div class="ttname"><a href="structvgic__irq.html#a32b80991e10a1755a169bb40892ad26b">vgic_irq::priority</a></div><div class="ttdeci">u8 priority</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00150">arm_vgic.h:150</a></div></div>
<div class="ttc" id="astructvgic__irq_html_a95ddef5ecf585bc624234ce4c9f13102"><div class="ttname"><a href="structvgic__irq.html#a95ddef5ecf585bc624234ce4c9f13102">vgic_irq::enabled</a></div><div class="ttdeci">bool enabled</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00139">arm_vgic.h:139</a></div></div>
<div class="ttc" id="astructvgic__irq_html_ad9e41922c26541e90bdfe7cd9a1fa6c5"><div class="ttname"><a href="structvgic__irq.html#ad9e41922c26541e90bdfe7cd9a1fa6c5">vgic_irq::target_vcpu</a></div><div class="ttdeci">struct kvm_vcpu * target_vcpu</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00127">arm_vgic.h:127</a></div></div>
<div class="ttc" id="astructvgic__its_html"><div class="ttname"><a href="structvgic__its.html">vgic_its</a></div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00187">arm_vgic.h:187</a></div></div>
<div class="ttc" id="astructvgic__its_html_aeba8b31468953402f9b095454f9dca33"><div class="ttname"><a href="structvgic__its.html#aeba8b31468953402f9b095454f9dca33">vgic_its::its_lock</a></div><div class="ttdeci">struct mutex its_lock</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00206">arm_vgic.h:209</a></div></div>
<div class="ttc" id="avgic-its_8c_html_a3fe23d687675cef46a95e36cf14d04e1"><div class="ttname"><a href="vgic-its_8c.html#a3fe23d687675cef46a95e36cf14d04e1">vgic_its_resolve_lpi</a></div><div class="ttdeci">int vgic_its_resolve_lpi(struct kvm *kvm, struct vgic_its *its, u32 devid, u32 eventid, struct vgic_irq **irq)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-its_8c_source.html#l00682">vgic-its.c:682</a></div></div>
<div class="ttc" id="avgic-v4_8c_html_a563a18a1e67555a71cb46e17f0abe770"><div class="ttname"><a href="vgic-v4_8c.html#a563a18a1e67555a71cb46e17f0abe770">vgic_get_its</a></div><div class="ttdeci">static struct vgic_its * vgic_get_its(struct kvm *kvm, struct kvm_kernel_irq_routing_entry *irq_entry)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v4_8c_source.html#l00397">vgic-v4.c:397</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a90f479062f56d4785922e5dfb0113838_cgraph.png" border="0" usemap="#aarm__vgic_8h_a90f479062f56d4785922e5dfb0113838_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a90f479062f56d4785922e5dfb0113838_cgraph" id="aarm__vgic_8h_a90f479062f56d4785922e5dfb0113838_cgraph">
<area shape="rect" title=" " alt="" coords="5,132,217,159"/>
<area shape="rect" href="vgic-v4_8c.html#a563a18a1e67555a71cb46e17f0abe770" title=" " alt="" coords="313,19,413,45"/>
<area shape="rect" href="vgic-its_8c.html#a3fe23d687675cef46a95e36cf14d04e1" title=" " alt="" coords="287,157,438,184"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="277,335,448,361"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="265,81,460,108"/>
<area shape="rect" href="vgic-its_8c.html#a94bbb30efc49ad5494a7f4b1410dbe01" title=" " alt="" coords="544,5,667,32"/>
<area shape="rect" href="kvm__main_8c.html#acb4d46ae6cc918253046320805f63a95" title=" " alt="" coords="775,5,934,32"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="803,56,906,83"/>
<area shape="rect" href="kvm__main_8c.html#a94bf2e0af8d9af8807a6a92ffb01cc1c" title=" " alt="" coords="1007,5,1197,32"/>
<area shape="rect" href="kvm__main_8c.html#a75ccec7a81fef145fb3c3a3b5479a86f" title=" " alt="" coords="1460,5,1595,32"/>
<area shape="rect" href="kvm__main_8c.html#aa52366417ec3708a05183231a3227d9d" title=" " alt="" coords="1245,31,1412,57"/>
<area shape="rect" href="vgic-its_8c.html#a0fb230e293b92c9fb746ad7b97ac68d5" title=" " alt="" coords="534,107,677,133"/>
<area shape="rect" href="vgic-its_8c.html#ae32cde43818922d2ecf800a3de102b75" title=" " alt="" coords="570,157,641,184"/>
<area shape="rect" href="vgic-its_8c.html#ad9756268e1c22946f868e3255f916aa6" title=" " alt="" coords="508,208,703,235"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#aa37f9ed0ed7921675bc4167d4a9d9261" title=" " alt="" coords="536,259,675,285"/>
<area shape="rect" href="vgic-its_8c.html#aeb2ca1f1a8fef2826c3c7e466dad2cb7" title=" " alt="" coords="795,132,914,159"/>
<area shape="rect" href="vgic-its_8c.html#aa5825fcbd841b62853870d25976d018b" title=" " alt="" coords="767,183,943,209"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="773,233,936,260"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="787,284,922,311"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="1038,233,1166,260"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="544,360,667,387"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="534,411,677,437"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="751,335,959,361"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="778,385,931,412"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="797,436,913,463"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a90f479062f56d4785922e5dfb0113838_icgraph.png" border="0" usemap="#aarm__vgic_8h_a90f479062f56d4785922e5dfb0113838_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a90f479062f56d4785922e5dfb0113838_icgraph" id="aarm__vgic_8h_a90f479062f56d4785922e5dfb0113838_icgraph">
<area shape="rect" title=" " alt="" coords="216,13,428,39"/>
<area shape="rect" href="arm_8c.html#ad039be44476ba96d282643b616303b79" title=" " alt="" coords="5,5,168,47"/>
</map>
</div>

</div>
</div>
<a id="a2de18f527930f927b7fedc3807929f9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2de18f527930f927b7fedc3807929f9c">&#9670;&nbsp;</a></span>kvm_vgic_v4_unset_forwarding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_v4_unset_forwarding </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>irq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_kernel_irq_routing_entry *&#160;</td>
          <td class="paramname"><em>irq_entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic-v4_8c_source.html#l00490">490</a> of file <a class="el" href="vgic-v4_8c_source.html">vgic-v4.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;{</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__its.html">vgic_its</a> *its;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f">vgic_supports_direct_msis</a>(kvm))</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">     * Get the ITS, and escape early on error (not a valid</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">     * doorbell for any of our vITSs).</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    its = <a class="code" href="vgic-v4_8c.html#a563a18a1e67555a71cb46e17f0abe770">vgic_get_its</a>(kvm, irq_entry);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">if</span> (IS_ERR(its))</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    mutex_lock(&amp;its-&gt;<a class="code" href="structvgic__its.html#aeba8b31468953402f9b095454f9dca33">its_lock</a>);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    ret = <a class="code" href="vgic-its_8c.html#a3fe23d687675cef46a95e36cf14d04e1">vgic_its_resolve_lpi</a>(kvm, its, irq_entry-&gt;msi.devid,</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                   irq_entry-&gt;msi.data, &amp;irq);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    WARN_ON(!(irq-&gt;<a class="code" href="structvgic__irq.html#ac7e3ed05f0fea2733e1db86963e697e1">hw</a> &amp;&amp; irq-&gt;<a class="code" href="structvgic__irq.html#a73308ba335a3372d0ca5cbe918b95622">host_irq</a> == virq));</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span> (irq-&gt;<a class="code" href="structvgic__irq.html#ac7e3ed05f0fea2733e1db86963e697e1">hw</a>) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        atomic_dec(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#ad9e41922c26541e90bdfe7cd9a1fa6c5">target_vcpu</a>-&gt;arch.vgic_cpu.vgic_v3.its_vpe.vlpi_count);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        irq-&gt;<a class="code" href="structvgic__irq.html#ac7e3ed05f0fea2733e1db86963e697e1">hw</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        ret = its_unmap_vlpi(virq);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;out:</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    mutex_unlock(&amp;its-&gt;<a class="code" href="structvgic__its.html#aeba8b31468953402f9b095454f9dca33">its_lock</a>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a2de18f527930f927b7fedc3807929f9c_cgraph.png" border="0" usemap="#aarm__vgic_8h_a2de18f527930f927b7fedc3807929f9c_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a2de18f527930f927b7fedc3807929f9c_cgraph" id="aarm__vgic_8h_a2de18f527930f927b7fedc3807929f9c_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,233,83"/>
<area shape="rect" href="vgic-v4_8c.html#a563a18a1e67555a71cb46e17f0abe770" title=" " alt="" coords="329,5,429,32"/>
<area shape="rect" href="vgic-its_8c.html#a3fe23d687675cef46a95e36cf14d04e1" title=" " alt="" coords="303,157,454,184"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="281,56,476,83"/>
<area shape="rect" href="vgic-its_8c.html#a94bbb30efc49ad5494a7f4b1410dbe01" title=" " alt="" coords="560,5,683,32"/>
<area shape="rect" href="kvm__main_8c.html#acb4d46ae6cc918253046320805f63a95" title=" " alt="" coords="775,5,934,32"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="803,56,906,83"/>
<area shape="rect" href="kvm__main_8c.html#a94bf2e0af8d9af8807a6a92ffb01cc1c" title=" " alt="" coords="991,5,1181,32"/>
<area shape="rect" href="kvm__main_8c.html#a75ccec7a81fef145fb3c3a3b5479a86f" title=" " alt="" coords="1444,5,1579,32"/>
<area shape="rect" href="kvm__main_8c.html#aa52366417ec3708a05183231a3227d9d" title=" " alt="" coords="1229,31,1396,57"/>
<area shape="rect" href="vgic-its_8c.html#a0fb230e293b92c9fb746ad7b97ac68d5" title=" " alt="" coords="550,157,693,184"/>
<area shape="rect" href="vgic-its_8c.html#ae32cde43818922d2ecf800a3de102b75" title=" " alt="" coords="586,271,657,297"/>
<area shape="rect" href="vgic-its_8c.html#ad9756268e1c22946f868e3255f916aa6" title=" " alt="" coords="524,208,719,235"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#aa37f9ed0ed7921675bc4167d4a9d9261" title=" " alt="" coords="552,107,691,133"/>
<area shape="rect" href="vgic-its_8c.html#aeb2ca1f1a8fef2826c3c7e466dad2cb7" title=" " alt="" coords="795,284,914,311"/>
<area shape="rect" href="vgic-its_8c.html#aa5825fcbd841b62853870d25976d018b" title=" " alt="" coords="767,132,943,159"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="773,183,936,209"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="787,233,922,260"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="1022,183,1150,209"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a2de18f527930f927b7fedc3807929f9c_icgraph.png" border="0" usemap="#aarm__vgic_8h_a2de18f527930f927b7fedc3807929f9c_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a2de18f527930f927b7fedc3807929f9c_icgraph" id="aarm__vgic_8h_a2de18f527930f927b7fedc3807929f9c_icgraph">
<area shape="rect" title=" " alt="" coords="216,13,444,39"/>
<area shape="rect" href="arm_8c.html#af9eeefc9a16f01b4a563c4e7164bb242" title=" " alt="" coords="5,5,168,47"/>
</map>
</div>

</div>
</div>
<a id="a05d84155ac79f812932547367b4445e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05d84155ac79f812932547367b4445e4">&#9670;&nbsp;</a></span>kvm_vgic_vcpu_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_vcpu_destroy </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic-init_8c_source.html#l00388">388</a> of file <a class="el" href="vgic-init_8c_source.html">vgic-init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;{</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keyword">struct </span>kvm *kvm = vcpu-&gt;kvm;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    mutex_lock(&amp;kvm-&gt;slots_lock);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <a class="code" href="vgic-init_8c.html#a1002af084b5fbafca1dab97541383180">__kvm_vgic_vcpu_destroy</a>(vcpu);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    mutex_unlock(&amp;kvm-&gt;slots_lock);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a05d84155ac79f812932547367b4445e4_cgraph.png" border="0" usemap="#aarm__vgic_8h_a05d84155ac79f812932547367b4445e4_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a05d84155ac79f812932547367b4445e4_cgraph" id="aarm__vgic_8h_a05d84155ac79f812932547367b4445e4_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,184,61"/>
<area shape="rect" href="vgic-init_8c.html#a1002af084b5fbafca1dab97541383180" title=" " alt="" coords="232,35,425,61"/>
<area shape="rect" href="vgic_8c.html#a573eb768a56ea0b73e234771e0013ffc" title=" " alt="" coords="473,5,649,32"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a4bfec769cd9fe2bddb14200a6147fccd" title=" " alt="" coords="478,57,645,98"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="749,5,850,32"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="949,5,1112,32"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="1189,5,1317,32"/>
<area shape="rect" href="kvm__main_8c.html#a103c02eb7ca545106f3130776c2a8897" title=" " alt="" coords="697,64,901,91"/>
<area shape="rect" href="kvm__main_8c.html#a3089edf2c0e5790aab7e8ed723f34b5b" title=" " alt="" coords="953,56,1109,83"/>
<area shape="rect" href="kvm__main_8c.html#aa6d7dea09a0b657f29e92f424e5d0633" title=" " alt="" coords="1160,81,1347,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a05d84155ac79f812932547367b4445e4_icgraph.png" border="0" usemap="#aarm__vgic_8h_a05d84155ac79f812932547367b4445e4_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a05d84155ac79f812932547367b4445e4_icgraph" id="aarm__vgic_8h_a05d84155ac79f812932547367b4445e4_icgraph">
<area shape="rect" title=" " alt="" coords="1705,79,1884,105"/>
<area shape="rect" href="arm_8c.html#a25d188e4f0871968b9f428c79720a502" title=" " alt="" coords="1477,79,1657,105"/>
<area shape="rect" href="kvm__main_8c.html#a7218df747387e4034ab8442f187306b1" title=" " alt="" coords="1257,53,1402,80"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="1229,104,1429,131"/>
<area shape="rect" href="kvm__main_8c.html#a0fcd9f7671bee7debec1bc05dcd9557b" title=" " alt="" coords="1029,53,1181,80"/>
<area shape="rect" href="arm_8c.html#ad84dda268db5d48c48f3ef2f438c62a7" title=" " alt="" coords="811,53,981,80"/>
<area shape="rect" href="kvm__main_8c.html#a54b22e6be98d31db1a83e7993fbcf4bc" title=" " alt="" coords="453,9,580,36"/>
<area shape="rect" href="kvm__main_8c.html#afd922c538c448ab1248cdb9dccae9410" title=" " alt="" coords="628,79,763,105"/>
<area shape="rect" href="kvm__main_8c.html#a955de4f2a1b3371438636eccab732b27" title=" " alt="" coords="212,5,405,32"/>
<area shape="rect" href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241" title=" " alt="" coords="459,104,574,131"/>
<area shape="rect" href="kvm__main_8c.html#a37fa7805021941c56fe174eae4c8c377" title=" " alt="" coords="234,56,383,83"/>
<area shape="rect" href="kvm__main_8c.html#af19040bdcea372f13eab66499d99201c" title=" " alt="" coords="226,107,391,133"/>
<area shape="rect" href="guest__memfd_8c.html#ad8912fbda61cdcb6d9e5a3c0f839e001" title=" " alt="" coords="231,157,386,184"/>
<area shape="rect" href="kvm__main_8c.html#af67afbdcee89641f21573ac643d8e693" title=" " alt="" coords="241,208,376,235"/>
<area shape="rect" href="kvm__main_8c.html#a87bcafdc42ee32aedb84df5e564f9872" title=" " alt="" coords="5,56,164,83"/>
</map>
</div>

</div>
</div>
<a id="ad052e8c724bfbb39c34281df23166a28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad052e8c724bfbb39c34281df23166a28">&#9670;&nbsp;</a></span>kvm_vgic_vcpu_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_vcpu_init </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="vgic-init_8c.html#ad052e8c724bfbb39c34281df23166a28">kvm_vgic_vcpu_init()</a> - Initialize static VGIC VCPU data structures and register VCPU-specific KVM iodevs</p>
<p>@vcpu: pointer to the VCPU being created and initialized</p>
<p>Only do initialization, but do not actually enable the VGIC CPU interface </p>

<p class="definition">Definition at line <a class="el" href="vgic-init_8c_source.html#l00194">194</a> of file <a class="el" href="vgic-init_8c_source.html">vgic-init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__cpu.html">vgic_cpu</a> *<a class="code" href="structvgic__cpu.html">vgic_cpu</a> = &amp;vcpu-&gt;arch.vgic_cpu;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__dist.html">vgic_dist</a> *dist = &amp;vcpu-&gt;kvm-&gt;arch.vgic;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="structvgic__cpu.html">vgic_cpu</a>-&gt;<a class="code" href="structvgic__cpu.html#a37a107871b55af4314e702d1a3ba7d0c">rd_iodev</a>.<a class="code" href="structvgic__io__device.html#ab9cb4231943460308105cd0df5842287">base_addr</a> = <a class="code" href="vgic_8h.html#ac91699b3ab8faf4d5222d998fb64b033">VGIC_ADDR_UNDEF</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    INIT_LIST_HEAD(&amp;<a class="code" href="structvgic__cpu.html">vgic_cpu</a>-&gt;<a class="code" href="structvgic__cpu.html#af1c80092259f3eaf1ea83f72113f0a59">ap_list_head</a>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    raw_spin_lock_init(&amp;<a class="code" href="structvgic__cpu.html">vgic_cpu</a>-&gt;<a class="code" href="structvgic__cpu.html#a97e24d80da0d6838231289122bd940e0">ap_list_lock</a>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    atomic_set(&amp;<a class="code" href="structvgic__cpu.html">vgic_cpu</a>-&gt;<a class="code" href="structvgic__cpu.html#acc770517cfb635a8149f0183c5c65451">vgic_v3</a>.<a class="code" href="structvgic__v3__cpu__if.html#a34878ae3e06f860e118eb4059a36a390">its_vpe</a>.vlpi_count, 0);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">     * Enable and configure all SGIs to be edge-triggered and</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">     * configure all PPIs as level-triggered.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="arm__vgic_8h.html#ae9d406cdd3eafd831ee41ecf0e48011e">VGIC_NR_PRIVATE_IRQS</a>; i++) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq = &amp;<a class="code" href="structvgic__cpu.html">vgic_cpu</a>-&gt;<a class="code" href="structvgic__cpu.html#a830a8bdc5ba9af3dd1696ca9dc109c53">private_irqs</a>[i];</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        INIT_LIST_HEAD(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#a62347c7af9c9908c79e668330b231162">ap_list</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        raw_spin_lock_init(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        irq-&gt;<a class="code" href="structvgic__irq.html#a52b9a2e701d89765fc16feb0323ef277">intid</a> = i;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        irq-&gt;<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a> = NULL;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        irq-&gt;<a class="code" href="structvgic__irq.html#ad9e41922c26541e90bdfe7cd9a1fa6c5">target_vcpu</a> = <a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        kref_init(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af5cc9e3844ac37c0764dea80fbc23439">refcount</a>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="vgic_8h.html#a67cef97460e9a4080ae437e5a30113a7">vgic_irq_is_sgi</a>(i)) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="comment">/* SGIs */</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            irq-&gt;<a class="code" href="structvgic__irq.html#a95ddef5ecf585bc624234ce4c9f13102">enabled</a> = 1;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            irq-&gt;<a class="code" href="structvgic__irq.html#afb2bd15c9dd315e5617a243d13eb5f79">config</a> = <a class="code" href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7adc1b4a2895063d95a6a3aef89da15915">VGIC_CONFIG_EDGE</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="comment">/* PPIs */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            irq-&gt;<a class="code" href="structvgic__irq.html#afb2bd15c9dd315e5617a243d13eb5f79">config</a> = <a class="code" href="arm__vgic_8h.html#a23952420a7fea6ce35df942e6b0783e7aff766918bb2eff9dbb94c4edea188a2a">VGIC_CONFIG_LEVEL</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arm__vgic_8h.html#a28961fa9a6313f335b274e0fac503bcf">irqchip_in_kernel</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">     * If we are creating a VCPU with a GICv3 we must also register the</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">     * KVM io device for the redistributor that belongs to this VCPU.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">if</span> (dist-&gt;<a class="code" href="structvgic__dist.html#a5d26cafc0800ef58cd37f4ab1c83dae7">vgic_model</a> == KVM_DEV_TYPE_ARM_VGIC_V3) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        mutex_lock(&amp;<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm-&gt;slots_lock);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        ret = <a class="code" href="vgic-mmio-v3_8c.html#a7c5d9bcbf29cb46bac8622d8bcc145b2">vgic_register_redist_iodev</a>(<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        mutex_unlock(&amp;<a class="code" href="structvgic__irq.html#a86c5cfe30a81ea5690f075fb2fcd9af1">vcpu</a>-&gt;kvm-&gt;slots_lock);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="ttc" id="astructvgic__cpu_html"><div class="ttname"><a href="structvgic__cpu.html">vgic_cpu</a></div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00325">arm_vgic.h:325</a></div></div>
<div class="ttc" id="astructvgic__cpu_html_a37a107871b55af4314e702d1a3ba7d0c"><div class="ttname"><a href="structvgic__cpu.html#a37a107871b55af4314e702d1a3ba7d0c">vgic_cpu::rd_iodev</a></div><div class="ttdeci">struct vgic_io_device rd_iodev</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00334">arm_vgic.h:348</a></div></div>
<div class="ttc" id="astructvgic__cpu_html_a830a8bdc5ba9af3dd1696ca9dc109c53"><div class="ttname"><a href="structvgic__cpu.html#a830a8bdc5ba9af3dd1696ca9dc109c53">vgic_cpu::private_irqs</a></div><div class="ttdeci">struct vgic_irq private_irqs[VGIC_NR_PRIVATE_IRQS]</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00322">arm_vgic.h:332</a></div></div>
<div class="ttc" id="astructvgic__cpu_html_a97e24d80da0d6838231289122bd940e0"><div class="ttname"><a href="structvgic__cpu.html#a97e24d80da0d6838231289122bd940e0">vgic_cpu::ap_list_lock</a></div><div class="ttdeci">raw_spinlock_t ap_list_lock</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00334">arm_vgic.h:334</a></div></div>
<div class="ttc" id="astructvgic__cpu_html_acc770517cfb635a8149f0183c5c65451"><div class="ttname"><a href="structvgic__cpu.html#acc770517cfb635a8149f0183c5c65451">vgic_cpu::vgic_v3</a></div><div class="ttdeci">struct vgic_v3_cpu_if vgic_v3</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00362">arm_vgic.h:329</a></div></div>
<div class="ttc" id="astructvgic__cpu_html_af1c80092259f3eaf1ea83f72113f0a59"><div class="ttname"><a href="structvgic__cpu.html#af1c80092259f3eaf1ea83f72113f0a59">vgic_cpu::ap_list_head</a></div><div class="ttdeci">struct list_head ap_list_head</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00334">arm_vgic.h:342</a></div></div>
<div class="ttc" id="astructvgic__io__device_html_ab9cb4231943460308105cd0df5842287"><div class="ttname"><a href="structvgic__io__device.html#ab9cb4231943460308105cd0df5842287">vgic_io_device::base_addr</a></div><div class="ttdeci">gpa_t base_addr</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00176">arm_vgic.h:176</a></div></div>
<div class="ttc" id="astructvgic__irq_html_a62347c7af9c9908c79e668330b231162"><div class="ttname"><a href="structvgic__irq.html#a62347c7af9c9908c79e668330b231162">vgic_irq::ap_list</a></div><div class="ttdeci">struct list_head ap_list</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00118">arm_vgic.h:120</a></div></div>
<div class="ttc" id="astructvgic__irq_html_af5cc9e3844ac37c0764dea80fbc23439"><div class="ttname"><a href="structvgic__irq.html#af5cc9e3844ac37c0764dea80fbc23439">vgic_irq::refcount</a></div><div class="ttdeci">struct kref refcount</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00140">arm_vgic.h:141</a></div></div>
<div class="ttc" id="astructvgic__v3__cpu__if_html_a34878ae3e06f860e118eb4059a36a390"><div class="ttname"><a href="structvgic__v3__cpu__if.html#a34878ae3e06f860e118eb4059a36a390">vgic_v3_cpu_if::its_vpe</a></div><div class="ttdeci">struct its_vpe its_vpe</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00312">arm_vgic.h:320</a></div></div>
<div class="ttc" id="avgic-mmio-v3_8c_html_a7c5d9bcbf29cb46bac8622d8bcc145b2"><div class="ttname"><a href="vgic-mmio-v3_8c.html#a7c5d9bcbf29cb46bac8622d8bcc145b2">vgic_register_redist_iodev</a></div><div class="ttdeci">int vgic_register_redist_iodev(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-mmio-v3_8c_source.html#l00746">vgic-mmio-v3.c:746</a></div></div>
<div class="ttc" id="avgic_8h_html_a67cef97460e9a4080ae437e5a30113a7"><div class="ttname"><a href="vgic_8h.html#a67cef97460e9a4080ae437e5a30113a7">vgic_irq_is_sgi</a></div><div class="ttdeci">#define vgic_irq_is_sgi(intid)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8h_source.html#l00021">vgic.h:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_ad052e8c724bfbb39c34281df23166a28_cgraph.png" border="0" usemap="#aarm__vgic_8h_ad052e8c724bfbb39c34281df23166a28_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_ad052e8c724bfbb39c34281df23166a28_cgraph" id="aarm__vgic_8h_ad052e8c724bfbb39c34281df23166a28_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,156,108"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a7c5d9bcbf29cb46bac8622d8bcc145b2" title=" " alt="" coords="204,74,355,115"/>
<area shape="rect" href="kvm__main_8c.html#a0afe5ce3e9ff1105328b06ec985e3374" title=" " alt="" coords="403,5,591,32"/>
<area shape="rect" href="iodev_8h.html#a8999defe529eb3e3870197ef8e39fad5" title=" " alt="" coords="426,56,567,83"/>
<area shape="rect" href="vgic-v3_8c.html#a98c28ff2dc6b6965cef76e1be35233b1" title=" " alt="" coords="419,107,574,133"/>
<area shape="rect" href="vgic-v3_8c.html#a481ec0006dfd5a7ea125b9913de7ba47" title=" " alt="" coords="411,183,583,209"/>
<area shape="rect" href="kvm__main_8c.html#a75ccec7a81fef145fb3c3a3b5479a86f" title=" " alt="" coords="667,5,802,32"/>
<area shape="rect" href="vgic-kvm-device_8c.html#af0cfcc44a93abc13df9a7e364c21cf32" title=" " alt="" coords="659,56,810,83"/>
<area shape="rect" href="vgic_8h.html#a01a6c3c40680e43017d7ba8ec7aadbac" title=" " alt="" coords="879,132,1052,159"/>
<area shape="rect" href="vgic-v3_8c.html#a8bd03445507515b9722165814955f6fa" title=" " alt="" coords="653,157,817,184"/>
<area shape="rect" href="vgic_8h.html#ab5518fe56ac149d185ee8dc4f1cbedcb" title=" " alt="" coords="639,208,831,235"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_ad052e8c724bfbb39c34281df23166a28_icgraph.png" border="0" usemap="#aarm__vgic_8h_ad052e8c724bfbb39c34281df23166a28_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_ad052e8c724bfbb39c34281df23166a28_icgraph" id="aarm__vgic_8h_ad052e8c724bfbb39c34281df23166a28_icgraph">
<area shape="rect" title=" " alt="" coords="473,5,624,32"/>
<area shape="rect" href="arm_8c.html#ae2ebf37d8daf1a8b43a9823bae4ab32b" title=" " alt="" coords="253,5,425,32"/>
<area shape="rect" href="kvm__main_8c.html#ab8870469dadfadf9a204346c62016293" title=" " alt="" coords="5,5,205,32"/>
</map>
</div>

</div>
</div>
<a id="a3059bfcee1ad30f581150d06c07d68e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3059bfcee1ad30f581150d06c07d68e8">&#9670;&nbsp;</a></span>kvm_vgic_vcpu_pending_irq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kvm_vgic_vcpu_pending_irq </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00971">971</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;{</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__cpu.html">vgic_cpu</a> *<a class="code" href="structvgic__cpu.html">vgic_cpu</a> = &amp;vcpu-&gt;arch.vgic_cpu;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__irq.html">vgic_irq</a> *irq;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordtype">bool</span> pending = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvgic__vmcr.html">vgic_vmcr</a> vmcr;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">if</span> (!vcpu-&gt;kvm-&gt;arch.vgic.enabled)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">if</span> (vcpu-&gt;arch.vgic_cpu.vgic_v3.its_vpe.pending_last)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <a class="code" href="vgic-mmio_8c.html#ad275c2ef6d5f7f0d79f101a7dd6dda3a">vgic_get_vmcr</a>(vcpu, &amp;vmcr);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    raw_spin_lock_irqsave(&amp;<a class="code" href="structvgic__cpu.html">vgic_cpu</a>-&gt;<a class="code" href="structvgic__cpu.html#a97e24d80da0d6838231289122bd940e0">ap_list_lock</a>, flags);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    list_for_each_entry(irq, &amp;<a class="code" href="structvgic__cpu.html">vgic_cpu</a>-&gt;<a class="code" href="structvgic__cpu.html#af1c80092259f3eaf1ea83f72113f0a59">ap_list_head</a>, ap_list) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        raw_spin_lock(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        pending = <a class="code" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45">irq_is_pending</a>(irq) &amp;&amp; irq-&gt;<a class="code" href="structvgic__irq.html#a95ddef5ecf585bc624234ce4c9f13102">enabled</a> &amp;&amp;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;              !irq-&gt;<a class="code" href="structvgic__irq.html#af53995a2a87457dedc6950c3143cfa05">active</a> &amp;&amp;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;              irq-&gt;<a class="code" href="structvgic__irq.html#a32b80991e10a1755a169bb40892ad26b">priority</a> &lt; vmcr.pmr;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        raw_spin_unlock(&amp;irq-&gt;<a class="code" href="structvgic__irq.html#af1912aedc19eddddbe24a26fe5814a27">irq_lock</a>);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keywordflow">if</span> (pending)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    raw_spin_unlock_irqrestore(&amp;<a class="code" href="structvgic__cpu.html">vgic_cpu</a>-&gt;<a class="code" href="structvgic__cpu.html#a97e24d80da0d6838231289122bd940e0">ap_list_lock</a>, flags);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">return</span> pending;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;}</div>
<div class="ttc" id="astructvgic__vmcr_html"><div class="ttname"><a href="structvgic__vmcr.html">vgic_vmcr</a></div><div class="ttdef"><b>Definition:</b> <a href="vgic_8h_source.html#l00154">vgic.h:154</a></div></div>
<div class="ttc" id="avgic-mmio_8c_html_ad275c2ef6d5f7f0d79f101a7dd6dda3a"><div class="ttname"><a href="vgic-mmio_8c.html#ad275c2ef6d5f7f0d79f101a7dd6dda3a">vgic_get_vmcr</a></div><div class="ttdeci">void vgic_get_vmcr(struct kvm_vcpu *vcpu, struct vgic_vmcr *vmcr)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-mmio_8c_source.html#l00851">vgic-mmio.c:851</a></div></div>
<div class="ttc" id="avgic_8h_html_a1109d873011f89a4acb4fd461f9f0a45"><div class="ttname"><a href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45">irq_is_pending</a></div><div class="ttdeci">static bool irq_is_pending(struct vgic_irq *irq)</div><div class="ttdef"><b>Definition:</b> <a href="vgic_8h_source.html#l00108">vgic.h:108</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a3059bfcee1ad30f581150d06c07d68e8_cgraph.png" border="0" usemap="#aarm__vgic_8h_a3059bfcee1ad30f581150d06c07d68e8_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a3059bfcee1ad30f581150d06c07d68e8_cgraph" id="aarm__vgic_8h_a3059bfcee1ad30f581150d06c07d68e8_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,212,57"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="261,5,377,32"/>
<area shape="rect" href="vgic-mmio_8c.html#ad275c2ef6d5f7f0d79f101a7dd6dda3a" title=" " alt="" coords="260,56,377,83"/>
<area shape="rect" href="vgic-v2_8c.html#aa825011d5b7d02e6b8f6c21746a5af39" title=" " alt="" coords="425,31,565,57"/>
<area shape="rect" href="vgic-v3_8c.html#a20f69ea757569fa58158ed4f097c1987" title=" " alt="" coords="425,81,565,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a3059bfcee1ad30f581150d06c07d68e8_icgraph.png" border="0" usemap="#aarm__vgic_8h_a3059bfcee1ad30f581150d06c07d68e8_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a3059bfcee1ad30f581150d06c07d68e8_icgraph" id="aarm__vgic_8h_a3059bfcee1ad30f581150d06c07d68e8_icgraph">
<area shape="rect" title=" " alt="" coords="2317,187,2524,213"/>
<area shape="rect" href="arm_8c.html#ac412fb0d81a53e66d8ac4146e4202f92" title=" " alt="" coords="2081,132,2269,159"/>
<area shape="rect" href="vgic_8c.html#afd47a938061d223b085c0ca0bed6aa71" title=" " alt="" coords="2111,216,2239,243"/>
<area shape="rect" href="kvm__main_8c.html#aac20f0d987f71a47c6701c7e93a0e261" title=" " alt="" coords="1849,31,2023,57"/>
<area shape="rect" href="kvm__main_8c.html#a3de4d6991bdd1a714e8afa6a55136cdd" title=" " alt="" coords="1848,107,2024,133"/>
<area shape="rect" href="arm_8c.html#ad33fe3df0e24d8ff8cb0a7f4657ec3fa" title=" " alt="" coords="1019,132,1169,159"/>
<area shape="rect" href="kvm__main_8c.html#a06ed191cebec13ce2c4a7d15fdeb5a60" title=" " alt="" coords="1624,5,1764,32"/>
<area shape="rect" href="kvm__main_8c.html#a7373edb7b1c787b14e657cd691e64d20" title=" " alt="" coords="1233,12,1380,39"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="1027,13,1161,40"/>
<area shape="rect" href="kvm__main_8c.html#a8e18df0287ddedfd516454aeeb669807" title=" " alt="" coords="1629,56,1759,83"/>
<area shape="rect" href="kvm__main_8c.html#a7256a8615584a9ae83a46c071f6aa0e9" title=" " alt="" coords="1428,67,1549,93"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="1249,67,1364,93"/>
<area shape="rect" href="psci_8c.html#abe7d85200e79143f87dab785a204fb3a" title=" " alt="" coords="1003,67,1185,93"/>
<area shape="rect" href="psci_8c.html#ac7522f6e0d1805f44a3e932397de4582" title=" " alt="" coords="802,67,946,93"/>
<area shape="rect" href="psci_8c.html#a8f59d47a1b54f561b8c42f509798142e" title=" " alt="" coords="580,19,724,45"/>
<area shape="rect" href="psci_8c.html#a3daa8000eb9717dde07d817c306b052b" title=" " alt="" coords="391,56,506,83"/>
<area shape="rect" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4" title=" " alt="" coords="153,56,339,83"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="7,31,103,57"/>
<area shape="rect" href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746" title=" " alt="" coords="5,81,105,108"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="793,132,955,159"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="559,132,745,159"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="387,132,511,159"/>
<area shape="rect" href="vgic-mmio-v2_8c.html#a2acb707aa37dccb7a4d021632629f994" title=" " alt="" coords="1839,216,2033,243"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a496b87a9bc8e2c1a5aa2d9ba2e13cc10" title=" " alt="" coords="1839,273,2033,300"/>
<area shape="rect" href="vgic-mmio-v2_8c.html#a86125023f5d85776a3857a2b82dfd2ca" title=" " alt="" coords="1597,209,1791,250"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a566ddfae78ebf930568f0dcc4a1bea21" title=" " alt="" coords="1597,274,1791,315"/>
</map>
</div>

</div>
</div>
<a id="a751661541b39c02532a54736db22a929"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a751661541b39c02532a54736db22a929">&#9670;&nbsp;</a></span>kvm_vgic_vmcr_sync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kvm_vgic_vmcr_sync </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic_8c_source.html#l00960">960</a> of file <a class="el" href="vgic_8c_source.html">vgic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;{</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">if</span> (unlikely(!<a class="code" href="arm__vgic_8h.html#a28961fa9a6313f335b274e0fac503bcf">irqchip_in_kernel</a>(vcpu-&gt;kvm)))</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#ae7d700dc38bbca3ed33730267652d87f">type</a> == <a class="code" href="arm__vgic_8h.html#a6e40915cc9873f08ca702678ce237ff1a9516eb794b5e9d2d4817bb361c699a60">VGIC_V2</a>)</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <a class="code" href="vgic-v2_8c.html#aa92110fc4f1e453fde0e8e720845854f">vgic_v2_vmcr_sync</a>(vcpu);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="vgic-v3_8c.html#aa3f97179d90d3ed6a8920d1c57496380">vgic_v3_vmcr_sync</a>(vcpu);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;}</div>
<div class="ttc" id="avgic-v2_8c_html_aa92110fc4f1e453fde0e8e720845854f"><div class="ttname"><a href="vgic-v2_8c.html#aa92110fc4f1e453fde0e8e720845854f">vgic_v2_vmcr_sync</a></div><div class="ttdeci">void vgic_v2_vmcr_sync(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v2_8c_source.html#l00467">vgic-v2.c:467</a></div></div>
<div class="ttc" id="avgic-v3_8c_html_aa3f97179d90d3ed6a8920d1c57496380"><div class="ttname"><a href="vgic-v3_8c.html#aa3f97179d90d3ed6a8920d1c57496380">vgic_v3_vmcr_sync</a></div><div class="ttdeci">void vgic_v3_vmcr_sync(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-v3_8c_source.html#l00740">vgic-v3.c:740</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a751661541b39c02532a54736db22a929_cgraph.png" border="0" usemap="#aarm__vgic_8h_a751661541b39c02532a54736db22a929_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a751661541b39c02532a54736db22a929_cgraph" id="aarm__vgic_8h_a751661541b39c02532a54736db22a929_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,168,57"/>
<area shape="rect" href="vgic-v2_8c.html#aa92110fc4f1e453fde0e8e720845854f" title=" " alt="" coords="216,5,365,32"/>
<area shape="rect" href="vgic-v3_8c.html#aa3f97179d90d3ed6a8920d1c57496380" title=" " alt="" coords="216,56,365,83"/>
<area shape="rect" href="vgic-v3-sr_8c.html#a4c7049da2b551848d3e39293c881f329" title=" " alt="" coords="413,56,576,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a751661541b39c02532a54736db22a929_icgraph.png" border="0" usemap="#aarm__vgic_8h_a751661541b39c02532a54736db22a929_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a751661541b39c02532a54736db22a929_icgraph" id="aarm__vgic_8h_a751661541b39c02532a54736db22a929_icgraph">
<area shape="rect" title=" " alt="" coords="1396,56,1559,83"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="1233,56,1348,83"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="1027,5,1161,32"/>
<area shape="rect" href="psci_8c.html#abe7d85200e79143f87dab785a204fb3a" title=" " alt="" coords="1003,56,1185,83"/>
<area shape="rect" href="arm_8c.html#ad33fe3df0e24d8ff8cb0a7f4657ec3fa" title=" " alt="" coords="1019,107,1169,133"/>
<area shape="rect" href="psci_8c.html#ac7522f6e0d1805f44a3e932397de4582" title=" " alt="" coords="802,56,946,83"/>
<area shape="rect" href="psci_8c.html#a8f59d47a1b54f561b8c42f509798142e" title=" " alt="" coords="580,5,724,32"/>
<area shape="rect" href="psci_8c.html#a3daa8000eb9717dde07d817c306b052b" title=" " alt="" coords="391,31,506,57"/>
<area shape="rect" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4" title=" " alt="" coords="153,31,339,57"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="7,5,103,32"/>
<area shape="rect" href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746" title=" " alt="" coords="5,56,105,83"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="793,107,955,133"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="559,107,745,133"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="387,107,511,133"/>
</map>
</div>

</div>
</div>
<a id="ad8001fedb7a2cb065c38833241e86b5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8001fedb7a2cb065c38833241e86b5c">&#9670;&nbsp;</a></span>vgic_irq_needs_resampling()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool vgic_irq_needs_resampling </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvgic__irq.html">vgic_irq</a> *&#160;</td>
          <td class="paramname"><em>irq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arm__vgic_8h_source.html#l00160">160</a> of file <a class="el" href="arm__vgic_8h_source.html">arm_vgic.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> irq-&gt;<a class="code" href="structvgic__irq.html#a2986d4afc4ccd4e704cb3f2c9aa2c0a9">ops</a> &amp;&amp; (irq-&gt;<a class="code" href="structvgic__irq.html#a2986d4afc4ccd4e704cb3f2c9aa2c0a9">ops</a>-&gt;<a class="code" href="structirq__ops.html#a20919f281027ed3a16ee0099595b6144">flags</a> &amp; <a class="code" href="arm__vgic_8h.html#a9c3e9820ba029d65cf7800d0cb4964be">VGIC_IRQ_SW_RESAMPLE</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="ttc" id="aarm__vgic_8h_html_a9c3e9820ba029d65cf7800d0cb4964be"><div class="ttname"><a href="arm__vgic_8h.html#a9c3e9820ba029d65cf7800d0cb4964be">VGIC_IRQ_SW_RESAMPLE</a></div><div class="ttdeci">#define VGIC_IRQ_SW_RESAMPLE</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00107">arm_vgic.h:107</a></div></div>
<div class="ttc" id="astructirq__ops_html_a20919f281027ed3a16ee0099595b6144"><div class="ttname"><a href="structirq__ops.html#a20919f281027ed3a16ee0099595b6144">irq_ops::flags</a></div><div class="ttdeci">unsigned long flags</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00105">arm_vgic.h:105</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_ad8001fedb7a2cb065c38833241e86b5c_icgraph.png" border="0" usemap="#aarm__vgic_8h_ad8001fedb7a2cb065c38833241e86b5c_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_ad8001fedb7a2cb065c38833241e86b5c_icgraph" id="aarm__vgic_8h_ad8001fedb7a2cb065c38833241e86b5c_icgraph">
<area shape="rect" title=" " alt="" coords="1293,81,1492,108"/>
<area shape="rect" href="vgic_8c.html#a19d27bba8dd17f9ae9c8284444df030b" title=" " alt="" coords="1041,31,1245,57"/>
<area shape="rect" href="vgic-v2_8c.html#a9b6956f55b0732bd8aa6e5cce3b51b34" title=" " alt="" coords="1067,81,1219,108"/>
<area shape="rect" href="vgic-v3_8c.html#ad978c7773b6b8a81c108e35926ce6f86" title=" " alt="" coords="1067,132,1219,159"/>
<area shape="rect" href="vgic-v2_8c.html#a7627ef75f37a19085dece7f4d26ad898" title=" " alt="" coords="833,5,993,32"/>
<area shape="rect" href="vgic-v3_8c.html#a3d53ba6e7f70704effc37ea2c4b0c04b" title=" " alt="" coords="833,56,993,83"/>
<area shape="rect" href="vgic_8c.html#ad42413b2202ba95d0b76067b240b9c52" title=" " alt="" coords="645,56,783,83"/>
<area shape="rect" href="vgic_8c.html#a76c600af416fb73e40611d80115edc03" title=" " alt="" coords="413,56,594,83"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,81,364,108"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,81,129,108"/>
<area shape="rect" href="vgic_8c.html#a1d440ccc621cee03cf929f67f1fc5f6a" title=" " alt="" coords="849,107,978,133"/>
<area shape="rect" href="vgic_8c.html#a498227d2a82836ba11a046b68857e3a3" title=" " alt="" coords="643,107,785,133"/>
<area shape="rect" href="vgic_8c.html#a5fb6266a1f361c1945f5feb862c1cf31" title=" " alt="" coords="412,107,595,133"/>
</map>
</div>

</div>
</div>
<a id="a7df84da3229db55762dde7ac4e1b3e96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7df84da3229db55762dde7ac4e1b3e96">&#9670;&nbsp;</a></span>vgic_v3_dispatch_sgi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vgic_v3_dispatch_sgi </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>allow_group1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>vgic_v3_dispatch_sgi - handle SGI requests from VCPUs @vcpu: The VCPU requesting a SGI @reg: The value written into ICC_{ASGI1,SGI0,SGI1}R by that VCPU @allow_group1: Does the sysreg access allow generation of G1 SGIs</p>
<p>With GICv3 (and ARE=1) CPUs trigger SGIs by writing to a system register. This will trap in sys_regs.c and call this function. This ICC_SGI1R_EL1 register contains the upper three affinity levels of the target processors as well as a bitmask of 16 Aff0 CPUs.</p>
<p>If the interrupt routing mode bit is not set, we iterate over the Aff0 bits and signal the VCPUs matching the provided Aff{3,2,1}.</p>
<p>If this bit is set, we signal all, but not the calling VCPU. </p>

<p class="definition">Definition at line <a class="el" href="vgic-mmio-v3_8c_source.html#l01058">1058</a> of file <a class="el" href="vgic-mmio-v3_8c_source.html">vgic-mmio-v3.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;{</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keyword">struct </span>kvm *kvm = vcpu-&gt;kvm;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *c_vcpu;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> target_cpus;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    u64 mpidr;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    u32 sgi, aff0;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> c;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    sgi = FIELD_GET(ICC_SGI1R_SGI_ID_MASK, reg);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="comment">/* Broadcast */</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">if</span> (unlikely(reg &amp; BIT_ULL(ICC_SGI1R_IRQ_ROUTING_MODE_BIT))) {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        kvm_for_each_vcpu(c, c_vcpu, kvm) {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <span class="comment">/* Don&#39;t signal the calling VCPU */</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="keywordflow">if</span> (c_vcpu == vcpu)</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <a class="code" href="vgic-mmio-v3_8c.html#a5039defeee267f93839f5359d7534ff7">vgic_v3_queue_sgi</a>(c_vcpu, sgi, allow_group1);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">/* We iterate over affinities to find the corresponding vcpus */</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    mpidr = <a class="code" href="vgic-mmio-v3_8c.html#a562c2938a95cda741508233a075bc29f">SGI_AFFINITY_LEVEL</a>(reg, 3);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    mpidr |= <a class="code" href="vgic-mmio-v3_8c.html#a562c2938a95cda741508233a075bc29f">SGI_AFFINITY_LEVEL</a>(reg, 2);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    mpidr |= <a class="code" href="vgic-mmio-v3_8c.html#a562c2938a95cda741508233a075bc29f">SGI_AFFINITY_LEVEL</a>(reg, 1);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    target_cpus = FIELD_GET(ICC_SGI1R_TARGET_LIST_MASK, reg);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    for_each_set_bit(aff0, &amp;target_cpus, hweight_long(ICC_SGI1R_TARGET_LIST_MASK)) {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        c_vcpu = <a class="code" href="arm_8c.html#a0be215e1642483c65818bd994b13a421">kvm_mpidr_to_vcpu</a>(kvm, mpidr | aff0);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="keywordflow">if</span> (c_vcpu)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <a class="code" href="vgic-mmio-v3_8c.html#a5039defeee267f93839f5359d7534ff7">vgic_v3_queue_sgi</a>(c_vcpu, sgi, allow_group1);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;}</div>
<div class="ttc" id="aarm_8c_html_a0be215e1642483c65818bd994b13a421"><div class="ttname"><a href="arm_8c.html#a0be215e1642483c65818bd994b13a421">kvm_mpidr_to_vcpu</a></div><div class="ttdeci">struct kvm_vcpu * kvm_mpidr_to_vcpu(struct kvm *kvm, unsigned long mpidr)</div><div class="ttdef"><b>Definition:</b> <a href="arm_8c_source.html#l02460">arm.c:2460</a></div></div>
<div class="ttc" id="avgic-mmio-v3_8c_html_a5039defeee267f93839f5359d7534ff7"><div class="ttname"><a href="vgic-mmio-v3_8c.html#a5039defeee267f93839f5359d7534ff7">vgic_v3_queue_sgi</a></div><div class="ttdeci">static void vgic_v3_queue_sgi(struct kvm_vcpu *vcpu, u32 sgi, bool allow_group1)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-mmio-v3_8c_source.html#l01010">vgic-mmio-v3.c:1010</a></div></div>
<div class="ttc" id="avgic-mmio-v3_8c_html_a562c2938a95cda741508233a075bc29f"><div class="ttname"><a href="vgic-mmio-v3_8c.html#a562c2938a95cda741508233a075bc29f">SGI_AFFINITY_LEVEL</a></div><div class="ttdeci">#define SGI_AFFINITY_LEVEL(reg, level)</div><div class="ttdef"><b>Definition:</b> <a href="vgic-mmio-v3_8c_source.html#l01006">vgic-mmio-v3.c:1006</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a7df84da3229db55762dde7ac4e1b3e96_cgraph.png" border="0" usemap="#aarm__vgic_8h_a7df84da3229db55762dde7ac4e1b3e96_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_a7df84da3229db55762dde7ac4e1b3e96_cgraph" id="aarm__vgic_8h_a7df84da3229db55762dde7ac4e1b3e96_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,165,57"/>
<area shape="rect" href="arm_8c.html#a0be215e1642483c65818bd994b13a421" title=" " alt="" coords="213,5,368,32"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a5039defeee267f93839f5359d7534ff7" title=" " alt="" coords="218,56,363,83"/>
<area shape="rect" href="vgic_8c.html#a7f38a266ef3def3202e7e04aa40fd516" title=" " alt="" coords="451,56,552,83"/>
<area shape="rect" href="vgic_8c.html#ac055f2fa0d463d3d287ee975bb80a9c5" title=" " alt="" coords="451,5,552,32"/>
<area shape="rect" href="vgic_8c.html#a1e208ac24f54fa95ba74797758c5b84c" title=" " alt="" coords="416,132,587,159"/>
<area shape="rect" href="vgic_8c.html#afeaf79de85450ed5fb52dbd7bd8c6617" title=" " alt="" coords="666,56,766,83"/>
<area shape="rect" href="vgic_8h.html#a43d39599f0fd2d973c5af8d6045e0f91" title=" " alt="" coords="882,56,1017,83"/>
<area shape="rect" href="vgic_8c.html#affa1a20a5bd9d67dc546c1ccaace3406" title=" " alt="" coords="635,5,797,32"/>
<area shape="rect" href="vgic_8c.html#a7d513558f0ea4ecbc012c98b3522f797" title=" " alt="" coords="885,5,1013,32"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="655,157,777,184"/>
<area shape="rect" href="vgic_8c.html#a10a21280f37c620b743df86980f6d247" title=" " alt="" coords="645,208,787,235"/>
<area shape="rect" href="arm_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="845,107,1053,133"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="873,157,1026,184"/>
<area shape="rect" href="vgic_8h.html#a1109d873011f89a4acb4fd461f9f0a45" title=" " alt="" coords="891,208,1007,235"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a7df84da3229db55762dde7ac4e1b3e96_icgraph.png" border="0" usemap="#aarm__vgic_8h_a7df84da3229db55762dde7ac4e1b3e96_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a7df84da3229db55762dde7ac4e1b3e96_icgraph" id="aarm__vgic_8h_a7df84da3229db55762dde7ac4e1b3e96_icgraph">
<area shape="rect" title=" " alt="" coords="172,5,332,32"/>
<area shape="rect" href="sys__regs_8c.html#a972b4ec406e774f520055637a47f6421" title=" " alt="" coords="5,5,124,32"/>
</map>
</div>

</div>
</div>
<a id="a043911fe4b149ad2ca234282ce4e67df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a043911fe4b149ad2ca234282ce4e67df">&#9670;&nbsp;</a></span>vgic_v4_commit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vgic_v4_commit </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic-v4_8c_source.html#l00385">385</a> of file <a class="el" href="vgic-v4_8c_source.html">vgic-v4.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;{</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">struct </span>its_vpe *vpe = &amp;vcpu-&gt;arch.vgic_cpu.vgic_v3.its_vpe;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">     * No need to wait for the vPE to be ready across a shallow guest</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">     * exit, as only a vcpu_put will invalidate it.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">if</span> (!vpe-&gt;ready)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        its_commit_vpe(vpe);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_a043911fe4b149ad2ca234282ce4e67df_icgraph.png" border="0" usemap="#aarm__vgic_8h_a043911fe4b149ad2ca234282ce4e67df_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_a043911fe4b149ad2ca234282ce4e67df_icgraph" id="aarm__vgic_8h_a043911fe4b149ad2ca234282ce4e67df_icgraph">
<area shape="rect" title=" " alt="" coords="643,5,772,32"/>
<area shape="rect" href="vgic_8c.html#a5fb6266a1f361c1945f5feb862c1cf31" title=" " alt="" coords="412,5,595,32"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="177,5,364,32"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ac2966fbf90610bb8a0525cbd903f7477"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2966fbf90610bb8a0525cbd903f7477">&#9670;&nbsp;</a></span>vgic_v4_load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vgic_v4_load </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic-v4_8c_source.html#l00349">349</a> of file <a class="el" href="vgic-v4_8c_source.html">vgic-v4.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;{</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keyword">struct </span>its_vpe *vpe = &amp;vcpu-&gt;arch.vgic_cpu.vgic_v3.its_vpe;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f">vgic_supports_direct_msis</a>(vcpu-&gt;kvm) || vpe-&gt;resident)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">if</span> (vcpu_get_flag(vcpu, IN_WFI))</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">     * Before making the VPE resident, make sure the redistributor</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">     * corresponding to our current CPU expects us here. See the</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">     * doc in drivers/irqchip/irq-gic-v4.c to understand how this</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">     * turns into a VMOVP command at the ITS level.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    err = irq_set_affinity(vpe-&gt;irq, cpumask_of(smp_processor_id()));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> (err)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    err = its_make_vpe_resident(vpe, <span class="keyword">false</span>, vcpu-&gt;kvm-&gt;arch.vgic.enabled);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span> (err)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">     * Now that the VPE is resident, let&#39;s get rid of a potential</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">     * doorbell interrupt that would still be pending. This is a</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">     * GICv4.0 only &quot;feature&quot;...</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="arm__vgic_8h.html#a53b0ff890074ba3dc4b1bed11a236394">kvm_vgic_global_state</a>.<a class="code" href="structvgic__global.html#a03678dde8c67f99ceb1db5c9a9b3ae15">has_gicv4_1</a>)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        err = irq_set_irqchip_state(vpe-&gt;irq, IRQCHIP_STATE_PENDING, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
<div class="ttc" id="astructvgic__global_html_a03678dde8c67f99ceb1db5c9a9b3ae15"><div class="ttname"><a href="structvgic__global.html#a03678dde8c67f99ceb1db5c9a9b3ae15">vgic_global::has_gicv4_1</a></div><div class="ttdeci">bool has_gicv4_1</div><div class="ttdef"><b>Definition:</b> <a href="arm__vgic_8h_source.html#l00075">arm_vgic.h:75</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_ac2966fbf90610bb8a0525cbd903f7477_cgraph.png" border="0" usemap="#aarm__vgic_8h_ac2966fbf90610bb8a0525cbd903f7477_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_ac2966fbf90610bb8a0525cbd903f7477_cgraph" id="aarm__vgic_8h_ac2966fbf90610bb8a0525cbd903f7477_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,112,32"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="160,5,355,32"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="403,5,505,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_ac2966fbf90610bb8a0525cbd903f7477_icgraph.png" border="0" usemap="#aarm__vgic_8h_ac2966fbf90610bb8a0525cbd903f7477_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_ac2966fbf90610bb8a0525cbd903f7477_icgraph" id="aarm__vgic_8h_ac2966fbf90610bb8a0525cbd903f7477_icgraph">
<area shape="rect" title=" " alt="" coords="1863,175,1969,202"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,125,1004,151"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="1700,251,1815,278"/>
<area shape="rect" href="vgic-v3_8c.html#aec2311d8e88bcd485c7baf083b65876e" title=" " alt="" coords="1704,175,1811,202"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,125,777,151"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,99,129,126"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="1494,327,1627,354"/>
<area shape="rect" href="psci_8c.html#abe7d85200e79143f87dab785a204fb3a" title=" " alt="" coords="1469,277,1652,303"/>
<area shape="rect" href="arm_8c.html#ad33fe3df0e24d8ff8cb0a7f4657ec3fa" title=" " alt="" coords="1267,150,1417,177"/>
<area shape="rect" href="psci_8c.html#ac7522f6e0d1805f44a3e932397de4582" title=" " alt="" coords="1270,378,1414,405"/>
<area shape="rect" href="psci_8c.html#a8f59d47a1b54f561b8c42f509798142e" title=" " alt="" coords="1070,429,1214,455"/>
<area shape="rect" href="psci_8c.html#a3daa8000eb9717dde07d817c306b052b" title=" " alt="" coords="866,429,981,455"/>
<area shape="rect" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4" title=" " alt="" coords="591,429,777,455"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="415,327,511,354"/>
<area shape="rect" href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746" title=" " alt="" coords="413,429,513,455"/>
<area shape="rect" href="vgic_8c.html#a54d5d884ac662357df5661d80f5160e3" title=" " alt="" coords="1501,175,1621,202"/>
<area shape="rect" href="arm_8c.html#aaa51abf3d06fdaa95794b27f273278fb" title=" " alt="" coords="1263,214,1421,241"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,226,1021,253"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,277,1215,303"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,23,1207,50"/>
<area shape="rect" href="kvm__main_8c.html#a31b6c41ce8eacbbdc56a276018989253" title=" " alt="" coords="1085,327,1199,354"/>
<area shape="rect" href="kvm__main_8c.html#a5dde35c5b74ce68a7dbb2f2006ce3e9e" title=" " alt="" coords="1098,175,1186,202"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,175,751,202"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,277,1015,303"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,226,771,253"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,327,731,354"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,226,543,253"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,23,1011,50"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,15,765,42"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,74,336,101"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,8,543,49"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,353,963,379"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,378,740,405"/>
</map>
</div>

</div>
</div>
<a id="aeafcb3e6b67ea32ed8e59d009252e565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeafcb3e6b67ea32ed8e59d009252e565">&#9670;&nbsp;</a></span>vgic_v4_put()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vgic_v4_put </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vgic-v4_8c_source.html#l00339">339</a> of file <a class="el" href="vgic-v4_8c_source.html">vgic-v4.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">struct </span>its_vpe *vpe = &amp;vcpu-&gt;arch.vgic_cpu.vgic_v3.its_vpe;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f">vgic_supports_direct_msis</a>(vcpu-&gt;kvm) || !vpe-&gt;resident)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">return</span> its_make_vpe_non_resident(vpe, !!vcpu_get_flag(vcpu, IN_WFI));</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_aeafcb3e6b67ea32ed8e59d009252e565_cgraph.png" border="0" usemap="#aarm__vgic_8h_aeafcb3e6b67ea32ed8e59d009252e565_cgraph" alt=""/></div>
<map name="aarm__vgic_8h_aeafcb3e6b67ea32ed8e59d009252e565_cgraph" id="aarm__vgic_8h_aeafcb3e6b67ea32ed8e59d009252e565_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,105,32"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a839b15883ba8f9de35a03ffce32fdf7f" title=" " alt="" coords="153,5,348,32"/>
<area shape="rect" href="vgic-mmio-v3_8c.html#a47708b59ddd94e03880996def466067e" title=" " alt="" coords="396,5,499,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="arm__vgic_8h_aeafcb3e6b67ea32ed8e59d009252e565_icgraph.png" border="0" usemap="#aarm__vgic_8h_aeafcb3e6b67ea32ed8e59d009252e565_icgraph" alt=""/></div>
<map name="aarm__vgic_8h_aeafcb3e6b67ea32ed8e59d009252e565_icgraph" id="aarm__vgic_8h_aeafcb3e6b67ea32ed8e59d009252e565_icgraph">
<area shape="rect" title=" " alt="" coords="1856,175,1956,202"/>
<area shape="rect" href="arm_8c.html#a05fa4e97677ca3190089071bfce82825" title=" " alt="" coords="843,125,1004,151"/>
<area shape="rect" href="arm_8c.html#a68df8c6f1b7134e9f23857f092d50056" title=" " alt="" coords="1693,251,1808,278"/>
<area shape="rect" href="vgic-v3_8c.html#a6a9931a18504090acd3d559ba25374ff" title=" " alt="" coords="1701,175,1801,202"/>
<area shape="rect" href="arm_8c.html#adbabb8b4e50c9c51eec6373fcbc833aa" title=" " alt="" coords="591,125,777,151"/>
<area shape="rect" href="kvm__main_8c.html#a2f2d3734c4cf61a1f4f94e9d47c37d55" title=" " alt="" coords="5,99,129,126"/>
<area shape="rect" href="handle__exit_8c.html#a0b391fc62c2250ecc0bfcdbe1b0a6788" title=" " alt="" coords="1487,327,1621,354"/>
<area shape="rect" href="psci_8c.html#abe7d85200e79143f87dab785a204fb3a" title=" " alt="" coords="1463,277,1645,303"/>
<area shape="rect" href="arm_8c.html#ad33fe3df0e24d8ff8cb0a7f4657ec3fa" title=" " alt="" coords="1263,150,1414,177"/>
<area shape="rect" href="psci_8c.html#ac7522f6e0d1805f44a3e932397de4582" title=" " alt="" coords="1267,378,1411,405"/>
<area shape="rect" href="psci_8c.html#a8f59d47a1b54f561b8c42f509798142e" title=" " alt="" coords="1070,429,1214,455"/>
<area shape="rect" href="psci_8c.html#a3daa8000eb9717dde07d817c306b052b" title=" " alt="" coords="866,429,981,455"/>
<area shape="rect" href="hypercalls_8c.html#a62d0b161cae45d4a2f865203301f7ac4" title=" " alt="" coords="591,429,777,455"/>
<area shape="rect" href="handle__exit_8c.html#a5c24d46393da9651d3133e2377fd7a69" title=" " alt="" coords="415,327,511,354"/>
<area shape="rect" href="handle__exit_8c.html#ad2545fb9f7329ef0604715b9af4a1746" title=" " alt="" coords="413,429,513,455"/>
<area shape="rect" href="vgic_8c.html#a96f93a2405989082e3693577b6b2eb5d" title=" " alt="" coords="1497,175,1611,202"/>
<area shape="rect" href="arm_8c.html#a9235365ce64f215b1e024f26d96537cc" title=" " alt="" coords="1263,214,1415,241"/>
<area shape="rect" href="emulate-nested_8c.html#a1920c02a997dd9975bec0ee02f6ae2c4" title=" " alt="" coords="825,226,1021,253"/>
<area shape="rect" href="emulate-nested_8c.html#a1c3e31bd85e9c0590a018ada20a5e4bf" title=" " alt="" coords="1069,277,1215,303"/>
<area shape="rect" href="reset_8c.html#a124698ccde953ff74d270ddd091fc3a9" title=" " alt="" coords="1077,23,1207,50"/>
<area shape="rect" href="kvm__main_8c.html#a5f5097640155787fc088aa47b94da0a7" title=" " alt="" coords="1080,327,1204,354"/>
<area shape="rect" href="kvm__main_8c.html#a16e0f63dd5f0d556ed1c9c9999256f85" title=" " alt="" coords="1101,175,1183,202"/>
<area shape="rect" href="handle__exit_8c.html#ae96aab7918301d55b908034db5855e3d" title=" " alt="" coords="617,175,751,202"/>
<area shape="rect" href="emulate-nested_8c.html#af5e2eb745d8ac6415fe941ebe754171d" title=" " alt="" coords="832,277,1015,303"/>
<area shape="rect" href="emulate-nested_8c.html#a5759b383dbf067b5e90235d5fd032ab5" title=" " alt="" coords="597,226,771,253"/>
<area shape="rect" href="handle__exit_8c.html#aeaf983f5c40202edc8b07a76603330cd" title=" " alt="" coords="637,327,731,354"/>
<area shape="rect" href="sys__regs_8c.html#a315e661b6f1cb224596267000909a1ac" title=" " alt="" coords="384,226,543,253"/>
<area shape="rect" href="arm_8c.html#ae1c5fe27678796057c4ea914a9a6897b" title=" " alt="" coords="835,23,1011,50"/>
<area shape="rect" href="arm_8c.html#a91790a6a024c83b103717f37a8f0f504" title=" " alt="" coords="603,15,765,42"/>
<area shape="rect" href="arm_8c.html#ab4ac4d44dfa1ed8985130249d6a8385e" title=" " alt="" coords="177,74,336,101"/>
<area shape="rect" href="arm_8c.html#ad66c8d00e8adc8315c45170fa270304b" title=" " alt="" coords="384,8,543,49"/>
<area shape="rect" href="kvm__main_8c.html#a2372c616bc55bc4cd3446660cb7322fc" title=" " alt="" coords="884,353,963,379"/>
<area shape="rect" href="arm_8c.html#a625df4221f73b13d9f23aa818f60e547" title=" " alt="" coords="628,378,740,405"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a53b0ff890074ba3dc4b1bed11a236394"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53b0ff890074ba3dc4b1bed11a236394">&#9670;&nbsp;</a></span>kvm_vgic_global_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structvgic__global.html">vgic_global</a> kvm_vgic_global_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8f46deb903409e1ea643f0072ae1552e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f46deb903409e1ea643f0072ae1552e">&#9670;&nbsp;</a></span>vgic_v2_cpuif_trap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct static_key_false vgic_v2_cpuif_trap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6659017e8f125c9d04cbef018aebf2be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6659017e8f125c9d04cbef018aebf2be">&#9670;&nbsp;</a></span>vgic_v3_cpuif_trap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct static_key_false vgic_v3_cpuif_trap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
