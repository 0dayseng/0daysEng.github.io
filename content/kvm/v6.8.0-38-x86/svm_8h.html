<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KVM: arch/x86/kvm/svm/svm.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ea9599923402ca8ab47fc3e495999dea.html">arch</a></li><li class="navelem"><a class="el" href="dir_c21774f8bc9f0de15163573e5f5fa2b5.html">x86</a></li><li class="navelem"><a class="el" href="dir_fde450fd4b58e2560c53a1e73bfa4d6d.html">kvm</a></li><li class="navelem"><a class="el" href="dir_59e270fee840b69a56de99d30906df9d.html">svm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">svm.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/kvm_types.h&gt;</code><br />
<code>#include &lt;linux/kvm_host.h&gt;</code><br />
<code>#include &lt;linux/bits.h&gt;</code><br />
<code>#include &lt;asm/svm.h&gt;</code><br />
<code>#include &lt;asm/sev-common.h&gt;</code><br />
<code>#include &quot;<a class="el" href="cpuid_8h_source.html">cpuid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="kvm__cache__regs_8h_source.html">kvm_cache_regs.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for svm.h:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h__incl.png" border="0" usemap="#aarch_2x86_2kvm_2svm_2svm_8h" alt=""/></div>
<map name="aarch_2x86_2kvm_2svm_2svm_8h" id="aarch_2x86_2kvm_2svm_2svm_8h">
<area shape="rect" title=" " alt="" coords="599,5,786,32"/>
<area shape="rect" title=" " alt="" coords="5,80,148,107"/>
<area shape="rect" title=" " alt="" coords="228,304,363,331"/>
<area shape="rect" title=" " alt="" coords="752,80,847,107"/>
<area shape="rect" title=" " alt="" coords="871,80,965,107"/>
<area shape="rect" title=" " alt="" coords="989,80,1140,107"/>
<area shape="rect" href="cpuid_8h.html" title=" " alt="" coords="658,80,727,107"/>
<area shape="rect" href="kvm__cache__regs_8h.html" title=" " alt="" coords="224,229,367,256"/>
<area shape="rect" href="x86_8h.html" title=" " alt="" coords="547,155,606,181"/>
<area shape="rect" href="reverse__cpuid_8h.html" title=" " alt="" coords="630,155,755,181"/>
<area shape="rect" title=" " alt="" coords="780,155,869,181"/>
<area shape="rect" title=" " alt="" coords="894,155,1022,181"/>
<area shape="rect" title=" " alt="" coords="1046,155,1209,181"/>
<area shape="rect" href="governed__features_8h.html" title=" " alt="" coords="1233,155,1389,181"/>
<area shape="rect" title=" " alt="" coords="443,229,575,256"/>
<area shape="rect" title=" " alt="" coords="599,229,693,256"/>
<area shape="rect" title=" " alt="" coords="717,229,833,256"/>
<area shape="rect" href="kvm__emulate_8h.html" title=" " alt="" coords="857,229,981,256"/>
<area shape="rect" title=" " alt="" coords="795,304,926,331"/>
<area shape="rect" href="fpu_8h.html" title=" " alt="" coords="951,304,1005,331"/>
<area shape="rect" title=" " alt="" coords="923,379,1033,405"/>
<area shape="rect" title=" " alt="" coords="1005,229,1132,256"/>
<area shape="rect" title=" " alt="" coords="1157,229,1293,256"/>
<area shape="rect" title=" " alt="" coords="1317,229,1460,256"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h__dep__incl.png" border="0" usemap="#aarch_2x86_2kvm_2svm_2svm_8hdep" alt=""/></div>
<map name="aarch_2x86_2kvm_2svm_2svm_8hdep" id="aarch_2x86_2kvm_2svm_2svm_8hdep">
<area shape="rect" title=" " alt="" coords="470,5,657,32"/>
<area shape="rect" href="kvm-asm-offsets_8c.html" title=" " alt="" coords="5,80,183,121"/>
<area shape="rect" href="svm_2hyperv_8h.html" title=" " alt="" coords="258,87,461,114"/>
<area shape="rect" href="svm__onhyperv_8c.html" title=" " alt="" coords="59,169,233,211"/>
<area shape="rect" href="svm_2nested_8c.html" title=" " alt="" coords="485,177,687,203"/>
<area shape="rect" href="svm_2pmu_8c.html" title=" " alt="" coords="535,87,722,114"/>
<area shape="rect" href="avic_8c.html" title=" " alt="" coords="747,87,932,114"/>
<area shape="rect" href="sev_8c.html" title=" " alt="" coords="956,87,1136,114"/>
<area shape="rect" href="svm_8c.html" title=" " alt="" coords="1161,87,1347,114"/>
<area shape="rect" href="svm_2hyperv_8c.html" title=" " alt="" coords="258,177,461,203"/>
</map>
</div>
</div>
<p><a href="svm_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkvm__sev__info.html">kvm_sev_info</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkvm__svm.html">kvm_svm</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkvm__vmcb__info.html">kvm_vmcb_info</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvmcb__save__area__cached.html">vmcb_save_area_cached</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvmcb__ctrl__area__cached.html">vmcb_ctrl_area_cached</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsvm__nested__state.html">svm_nested_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvcpu__sev__es__state.html">vcpu_sev_es_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvcpu__svm.html">vcpu_svm</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsvm__cpu__data.html">svm_cpu_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a006ecae20fd705ed2184ec4e6f0f5dd9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a006ecae20fd705ed2184ec4e6f0f5dd9">__sme_page_pa</a>(x)&#160;&#160;&#160;__sme_set(page_to_pfn(x) &lt;&lt; PAGE_SHIFT)</td></tr>
<tr class="separator:a006ecae20fd705ed2184ec4e6f0f5dd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3db0df1165fd78ebd0af2184562f090c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a3db0df1165fd78ebd0af2184562f090c">IOPM_SIZE</a>&#160;&#160;&#160;PAGE_SIZE * 3</td></tr>
<tr class="separator:a3db0df1165fd78ebd0af2184562f090c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a106125dd7b1447fe5e6cb6f08240137b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a106125dd7b1447fe5e6cb6f08240137b">MSRPM_SIZE</a>&#160;&#160;&#160;PAGE_SIZE * 2</td></tr>
<tr class="separator:a106125dd7b1447fe5e6cb6f08240137b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5da6b86ca5c95c3562c7d03dcbefe138"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">MAX_DIRECT_ACCESS_MSRS</a>&#160;&#160;&#160;47</td></tr>
<tr class="separator:a5da6b86ca5c95c3562c7d03dcbefe138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecb0b82114f9d516a3ee502c0054e0c0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aecb0b82114f9d516a3ee502c0054e0c0">MSRPM_OFFSETS</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:aecb0b82114f9d516a3ee502c0054e0c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a317277564d2351c6695a358504311483"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a317277564d2351c6695a358504311483">VMCB_ALL_CLEAN_MASK</a></td></tr>
<tr class="separator:a317277564d2351c6695a358504311483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a987416bb1857b96f97af2391d1008c5a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a987416bb1857b96f97af2391d1008c5a">VMCB_ALWAYS_DIRTY_MASK</a>&#160;&#160;&#160;((1U &lt;&lt; <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a>) | (1U &lt;&lt; <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1">VMCB_CR2</a>))</td></tr>
<tr class="separator:a987416bb1857b96f97af2391d1008c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45c751b4204124bee221bec64ada4d72"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a45c751b4204124bee221bec64ada4d72">SVM_REGS_LAZY_LOAD_SET</a>&#160;&#160;&#160;(1 &lt;&lt; VCPU_EXREG_PDPTR)</td></tr>
<tr class="separator:a45c751b4204124bee221bec64ada4d72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9836254c789e1e9f8d62939ff44ff36"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>&#160;&#160;&#160;0xffffffffU</td></tr>
<tr class="separator:ae9836254c789e1e9f8d62939ff44ff36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfd26afe0ecab7e00defb0b34eb0a94a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#acfd26afe0ecab7e00defb0b34eb0a94a">DEBUGCTL_RESERVED_BITS</a>&#160;&#160;&#160;(~(0x3fULL))</td></tr>
<tr class="separator:acfd26afe0ecab7e00defb0b34eb0a94a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d1cfc3512b22eae96df1b679e87a92e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a5d1cfc3512b22eae96df1b679e87a92e">NESTED_EXIT_HOST</a>&#160;&#160;&#160;0	/* Exit handled <a class="el" href="posted__intr_8h.html#af49c2456e8fb34a117ca382ecb643aca">on</a> host level */</td></tr>
<tr class="separator:a5d1cfc3512b22eae96df1b679e87a92e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c953f5ab9b400e9a1c5232515ec6293"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a9c953f5ab9b400e9a1c5232515ec6293">NESTED_EXIT_DONE</a>&#160;&#160;&#160;1	/* Exit caused <a class="el" href="vmx_8c.html#a97d7564e1b5ae8c0173e53f859ac17e1">nested</a> vmexit  */</td></tr>
<tr class="separator:a9c953f5ab9b400e9a1c5232515ec6293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac75660e3dace3bef9ab0d76dedf2034e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ac75660e3dace3bef9ab0d76dedf2034e">NESTED_EXIT_CONTINUE</a>&#160;&#160;&#160;2	/* Further checks needed      */</td></tr>
<tr class="separator:ac75660e3dace3bef9ab0d76dedf2034e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3af5258a6c47113ee5b5898437dd7df"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#af3af5258a6c47113ee5b5898437dd7df">AVIC_REQUIRED_APICV_INHIBITS</a></td></tr>
<tr class="separator:af3af5258a6c47113ee5b5898437dd7df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4810b27551dd12e44459d9444873eb0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#af4810b27551dd12e44459d9444873eb0">GHCB_VERSION_MAX</a>&#160;&#160;&#160;1ULL</td></tr>
<tr class="separator:af4810b27551dd12e44459d9444873eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab146f6f540f9544ae3b4efaceae107c8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ab146f6f540f9544ae3b4efaceae107c8">GHCB_VERSION_MIN</a>&#160;&#160;&#160;1ULL</td></tr>
<tr class="separator:ab146f6f540f9544ae3b4efaceae107c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad919ef3ad8475b1cc85b683ad7b33f95"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ad919ef3ad8475b1cc85b683ad7b33f95">DEFINE_KVM_GHCB_ACCESSORS</a>(field)</td></tr>
<tr class="separator:ad919ef3ad8475b1cc85b683ad7b33f95"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a39fca1837c5ce7715cbf571669660c13"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a>
, <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a0b96a6cb7dc2eb2f1e2471f9fdfa6972">VMCB_PERM_MAP</a>
, <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64">VMCB_ASID</a>
, <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a>
, <br />
&#160;&#160;<a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7c9727e792c945164c49fbd9793c4e97">VMCB_NPT</a>
, <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>
, <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac7c020c96383ecc6a3d358e1fdd99be7">VMCB_DR</a>
, <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a1c1bbe2afa896e3b5fc2f2d850eb41b3">VMCB_DT</a>
, <br />
&#160;&#160;<a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ab13d3c949ef62a4213fe70e2ed836b91">VMCB_SEG</a>
, <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1">VMCB_CR2</a>
, <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a">VMCB_LBR</a>
, <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f">VMCB_AVIC</a>
, <br />
&#160;&#160;<a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aadb6ebcdeea82b3c1ad950e8e2433d8c">VMCB_SW</a> = 31
<br />
 }</td></tr>
<tr class="separator:a39fca1837c5ce7715cbf571669660c13"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7c74743aeff41a938e6e8d1018bf871c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a7c74743aeff41a938e6e8d1018bf871c">DECLARE_PER_CPU</a> (struct <a class="el" href="structsvm__cpu__data.html">svm_cpu_data</a>, svm_data)</td></tr>
<tr class="separator:a7c74743aeff41a938e6e8d1018bf871c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb2a01596415bf77bd9a3f22ff165a14"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:adb2a01596415bf77bd9a3f22ff165a14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac27f6fe2ff4beeb5ad1b11681d0386fd"><td class="memItemLeft" align="right" valign="top">static __always_inline struct <a class="el" href="structkvm__svm.html">kvm_svm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a> (struct kvm *kvm)</td></tr>
<tr class="separator:ac27f6fe2ff4beeb5ad1b11681d0386fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a371c2a615dd0d893b557b4c0742ab5c6"><td class="memItemLeft" align="right" valign="top">static __always_inline bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a> (struct kvm *kvm)</td></tr>
<tr class="separator:a371c2a615dd0d893b557b4c0742ab5c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14877439e9d41030cb21612eecc8f3f9"><td class="memItemLeft" align="right" valign="top">static __always_inline bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a> (struct kvm *kvm)</td></tr>
<tr class="separator:a14877439e9d41030cb21612eecc8f3f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5980ebd310893869bc4c059f110a13cb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb">vmcb_mark_all_dirty</a> (struct vmcb *vmcb)</td></tr>
<tr class="separator:a5980ebd310893869bc4c059f110a13cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64fd8d98c29189b4f4e47f96958aeeca"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a64fd8d98c29189b4f4e47f96958aeeca">vmcb_mark_all_clean</a> (struct vmcb *vmcb)</td></tr>
<tr class="separator:a64fd8d98c29189b4f4e47f96958aeeca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab83edec724698a20d66a086a1900aa27"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a> (struct vmcb *vmcb, int bit)</td></tr>
<tr class="separator:ab83edec724698a20d66a086a1900aa27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af08dd89f5ee519835337165e9060f526"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#af08dd89f5ee519835337165e9060f526">vmcb_is_dirty</a> (struct vmcb *vmcb, int bit)</td></tr>
<tr class="separator:af08dd89f5ee519835337165e9060f526"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e420c88631faf9613ea3caa72c63b7"><td class="memItemLeft" align="right" valign="top">static __always_inline struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a83e420c88631faf9613ea3caa72c63b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdbe781b81d2ae90e81d9bb9e9750789"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a> (struct vmcb_control_area *<a class="el" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>, u32 bit)</td></tr>
<tr class="separator:afdbe781b81d2ae90e81d9bb9e9750789"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e4cd1b591935133506abf6724051c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a> (struct vmcb_control_area *<a class="el" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>, u32 bit)</td></tr>
<tr class="separator:a83e4cd1b591935133506abf6724051c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eb37bb9efc32f45f75055de8ba4fc79"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79">vmcb_is_intercept</a> (struct vmcb_control_area *<a class="el" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>, u32 bit)</td></tr>
<tr class="separator:a6eb37bb9efc32f45f75055de8ba4fc79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5deff43556f8c807c64def073cd548e4"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a> (struct <a class="el" href="structvmcb__ctrl__area__cached.html">vmcb_ctrl_area_cached</a> *<a class="el" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>, u32 bit)</td></tr>
<tr class="separator:a5deff43556f8c807c64def073cd548e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af04356b0b53ece1f631f1cfa12521642"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, u32 bit)</td></tr>
<tr class="separator:af04356b0b53ece1f631f1cfa12521642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e9d1e1a7652ad926236f0f44891293c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, u32 bit)</td></tr>
<tr class="separator:a0e9d1e1a7652ad926236f0f44891293c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6e4bba26808541629dd240a782f1d05"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, int bit)</td></tr>
<tr class="separator:af6e4bba26808541629dd240a782f1d05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c285d86fd94954273295b317242c500"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, int bit)</td></tr>
<tr class="separator:a4c285d86fd94954273295b317242c500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a397a88cd5af0b0bb8a9ef4a5e6bc849d"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, int bit)</td></tr>
<tr class="separator:a397a88cd5af0b0bb8a9ef4a5e6bc849d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6d8c993934e650cf5366b9883c3628e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e">nested_vgif_enabled</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:ad6d8c993934e650cf5366b9883c3628e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69e061ab353251d82ff01f587be58c96"><td class="memItemLeft" align="right" valign="top">static struct vmcb *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">get_vgif_vmcb</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a69e061ab353251d82ff01f587be58c96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0ea8a68927599c2120f37f4f48b0a64"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64">enable_gif</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:ad0ea8a68927599c2120f37f4f48b0a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a711d42f525aa791008754514284a556c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a711d42f525aa791008754514284a556c">disable_gif</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a711d42f525aa791008754514284a556c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea7fbac9a0652dc113c81593522e47ca"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:aea7fbac9a0652dc113c81593522e47ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96264b6618fa3987f55ba2054a1f12bc"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc">nested_npt_enabled</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a96264b6618fa3987f55ba2054a1f12bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab452fafde694bb5dfd7c6dfc5707ae12"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ab452fafde694bb5dfd7c6dfc5707ae12">nested_vnmi_enabled</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:ab452fafde694bb5dfd7c6dfc5707ae12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7787ebf653e664e7dda7c3b0a8dfa84b"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a7787ebf653e664e7dda7c3b0a8dfa84b">is_x2apic_msrpm_offset</a> (u32 offset)</td></tr>
<tr class="separator:a7787ebf653e664e7dda7c3b0a8dfa84b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b60c96a4d7eed837bb38ed5e03153c8"><td class="memItemLeft" align="right" valign="top">static struct vmcb *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8">get_vnmi_vmcb_l1</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a4b60c96a4d7eed837bb38ed5e03153c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66eedd855edb50a1b78c2ac2c48a4d5d"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d">is_vnmi_enabled</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a66eedd855edb50a1b78c2ac2c48a4d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35438091c40e77c617ce2ec9d521cc1f"><td class="memItemLeft" align="right" valign="top">u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a35438091c40e77c617ce2ec9d521cc1f">svm_msrpm_offset</a> (u32 msr)</td></tr>
<tr class="separator:a35438091c40e77c617ce2ec9d521cc1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf821ba71761474726fdfb616796a0c8"><td class="memItemLeft" align="right" valign="top">u32 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aaf821ba71761474726fdfb616796a0c8">svm_vcpu_alloc_msrpm</a> (void)</td></tr>
<tr class="separator:aaf821ba71761474726fdfb616796a0c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee43a83fe8c444128a4d22b2d5d5c21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aaee43a83fe8c444128a4d22b2d5d5c21">svm_vcpu_init_msrpm</a> (struct kvm_vcpu *vcpu, u32 *msrpm)</td></tr>
<tr class="separator:aaee43a83fe8c444128a4d22b2d5d5c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67937d45023d92583b0bd363c73b6c2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a67937d45023d92583b0bd363c73b6c2b">svm_vcpu_free_msrpm</a> (u32 *msrpm)</td></tr>
<tr class="separator:a67937d45023d92583b0bd363c73b6c2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06d8a6a899d49f3235ec1294d1943c84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a06d8a6a899d49f3235ec1294d1943c84">svm_copy_lbrs</a> (struct vmcb *to_vmcb, struct vmcb *from_vmcb)</td></tr>
<tr class="separator:a06d8a6a899d49f3235ec1294d1943c84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5aa214e23ea9ec9418bebbe889d41ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ad5aa214e23ea9ec9418bebbe889d41ef">svm_update_lbrv</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad5aa214e23ea9ec9418bebbe889d41ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5df90c8772700a60441f2ba19472f726"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a5df90c8772700a60441f2ba19472f726">svm_set_efer</a> (struct kvm_vcpu *vcpu, u64 efer)</td></tr>
<tr class="separator:a5df90c8772700a60441f2ba19472f726"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9474f1273be079ac4f3c1320093c3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a1a9474f1273be079ac4f3c1320093c3d">svm_set_cr0</a> (struct kvm_vcpu *vcpu, unsigned long cr0)</td></tr>
<tr class="separator:a1a9474f1273be079ac4f3c1320093c3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec23ca96447aab4ff19f594a297bc109"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aec23ca96447aab4ff19f594a297bc109">svm_set_cr4</a> (struct kvm_vcpu *vcpu, unsigned long cr4)</td></tr>
<tr class="separator:aec23ca96447aab4ff19f594a297bc109"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ff4c846a46f6bb2e429d79bbc18f052"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a7ff4c846a46f6bb2e429d79bbc18f052">disable_nmi_singlestep</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a7ff4c846a46f6bb2e429d79bbc18f052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88b3351baf8190bdefb4b8a113159deb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a88b3351baf8190bdefb4b8a113159deb">svm_smi_blocked</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a88b3351baf8190bdefb4b8a113159deb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37477553ea45acae098350e7d572ae2e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a37477553ea45acae098350e7d572ae2e">svm_nmi_blocked</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a37477553ea45acae098350e7d572ae2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67762809a8b14687a3bffdd5a4cd03aa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a67762809a8b14687a3bffdd5a4cd03aa">svm_interrupt_blocked</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a67762809a8b14687a3bffdd5a4cd03aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c26f1ceaa6cc778d986bd33629dc539"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, bool value)</td></tr>
<tr class="separator:a5c26f1ceaa6cc778d986bd33629dc539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8afafecae406016532810194f187fe2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a8afafecae406016532810194f187fe2c">svm_invoke_exit_handler</a> (struct kvm_vcpu *vcpu, u64 exit_code)</td></tr>
<tr class="separator:a8afafecae406016532810194f187fe2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7cebb5bd1d0e7eadb2b7df90cca0c74"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a> (struct kvm_vcpu *vcpu, u32 *msrpm, u32 msr, int read, int write)</td></tr>
<tr class="separator:ae7cebb5bd1d0e7eadb2b7df90cca0c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addc2bf7bff76340928f122fbde134c2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#addc2bf7bff76340928f122fbde134c2a">svm_set_x2apic_msr_interception</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, bool disable)</td></tr>
<tr class="separator:addc2bf7bff76340928f122fbde134c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affe9512dad96b228e24b8cc7175db04c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#affe9512dad96b228e24b8cc7175db04c">svm_complete_interrupt_delivery</a> (struct kvm_vcpu *vcpu, int delivery_mode, int trig_mode, int vec)</td></tr>
<tr class="separator:affe9512dad96b228e24b8cc7175db04c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0040cee9c1580bba0c7d61a63494c04a"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a0040cee9c1580bba0c7d61a63494c04a">nested_svm_virtualize_tpr</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a0040cee9c1580bba0c7d61a63494c04a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61ac82c942842848fab805e84fc70189"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a61ac82c942842848fab805e84fc70189">nested_exit_on_smi</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a61ac82c942842848fab805e84fc70189"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13cbed806a9638fcaab4d01cb926d141"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141">nested_exit_on_intr</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a13cbed806a9638fcaab4d01cb926d141"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa7c9e670f5a86519f40b06f5277346"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346">nested_exit_on_nmi</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:aefa7c9e670f5a86519f40b06f5277346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb7dae2607f5d00a49d6baae5747d57a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#afb7dae2607f5d00a49d6baae5747d57a">enter_svm_guest_mode</a> (struct kvm_vcpu *vcpu, u64 vmcb_gpa, struct vmcb *vmcb12, bool from_vmrun)</td></tr>
<tr class="separator:afb7dae2607f5d00a49d6baae5747d57a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea614d490148481c96faf7c1b5ecb11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#afea614d490148481c96faf7c1b5ecb11">svm_leave_nested</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:afea614d490148481c96faf7c1b5ecb11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a690337312a648d2948b22540da6f031e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a690337312a648d2948b22540da6f031e">svm_free_nested</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a690337312a648d2948b22540da6f031e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeebe6cee9f13a0540cbd9b696648a1d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aaeebe6cee9f13a0540cbd9b696648a1d">svm_allocate_nested</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:aaeebe6cee9f13a0540cbd9b696648a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ec7e878f6af209e74dd84285ee0198f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a4ec7e878f6af209e74dd84285ee0198f">nested_svm_vmrun</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a4ec7e878f6af209e74dd84285ee0198f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefe90b7232034ee5f45a41f108ffb891"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aefe90b7232034ee5f45a41f108ffb891">svm_copy_vmrun_state</a> (struct vmcb_save_area *to_save, struct vmcb_save_area *from_save)</td></tr>
<tr class="separator:aefe90b7232034ee5f45a41f108ffb891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2a559173016267c3c1ef55be6571c0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ae2a559173016267c3c1ef55be6571c0c">svm_copy_vmloadsave_state</a> (struct vmcb *to_vmcb, struct vmcb *from_vmcb)</td></tr>
<tr class="separator:ae2a559173016267c3c1ef55be6571c0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73d1cb9b9fcfa112138681d9080a1c05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a73d1cb9b9fcfa112138681d9080a1c05">nested_svm_vmexit</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a73d1cb9b9fcfa112138681d9080a1c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b2d87885eea1b11b1bf1045c21c5a8b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b">nested_svm_simple_vmexit</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, u32 exit_code)</td></tr>
<tr class="separator:a7b2d87885eea1b11b1bf1045c21c5a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a777240cb9ab00451d21a1b204e19c5a6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a777240cb9ab00451d21a1b204e19c5a6">nested_svm_exit_handled</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a777240cb9ab00451d21a1b204e19c5a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8907fcb136a33618dbbc1c2b7d3872f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a8907fcb136a33618dbbc1c2b7d3872f8">nested_svm_check_permissions</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a8907fcb136a33618dbbc1c2b7d3872f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a869cefc2d0dabd5e6c07940e88a4acfe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a869cefc2d0dabd5e6c07940e88a4acfe">nested_svm_check_exception</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, unsigned nr, bool has_error_code, u32 error_code)</td></tr>
<tr class="separator:a869cefc2d0dabd5e6c07940e88a4acfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfe06c5436ae4d724c3c4495f8af136d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#abfe06c5436ae4d724c3c4495f8af136d">nested_svm_exit_special</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:abfe06c5436ae4d724c3c4495f8af136d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae003d7b6aae84aa9b70d64f464e70dfc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ae003d7b6aae84aa9b70d64f464e70dfc">nested_svm_update_tsc_ratio_msr</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ae003d7b6aae84aa9b70d64f464e70dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a1b45b05505f9435cc2d1dd1c37943"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ad9a1b45b05505f9435cc2d1dd1c37943">svm_write_tsc_multiplier</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ad9a1b45b05505f9435cc2d1dd1c37943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add5ee1e85234f2457480494694865c21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#add5ee1e85234f2457480494694865c21">nested_copy_vmcb_control_to_cache</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, struct vmcb_control_area *<a class="el" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>)</td></tr>
<tr class="separator:add5ee1e85234f2457480494694865c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae052404bed168cf69c578a697ce25526"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ae052404bed168cf69c578a697ce25526">nested_copy_vmcb_save_to_cache</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, struct vmcb_save_area *save)</td></tr>
<tr class="separator:ae052404bed168cf69c578a697ce25526"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a232d9e4f1731f0d495e3b4f9d530d0ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a232d9e4f1731f0d495e3b4f9d530d0ee">nested_sync_control_from_vmcb02</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a232d9e4f1731f0d495e3b4f9d530d0ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5124cfade7c6ad2a6e136fdd0391f0a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a5124cfade7c6ad2a6e136fdd0391f0a2">nested_vmcb02_compute_g_pat</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a5124cfade7c6ad2a6e136fdd0391f0a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a051d09f3fa8790388364ac3f69ed3e53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, struct <a class="el" href="structkvm__vmcb__info.html">kvm_vmcb_info</a> *target_vmcb)</td></tr>
<tr class="separator:a051d09f3fa8790388364ac3f69ed3e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada833d2b35b3e565a6900b25d1cce7c7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ada833d2b35b3e565a6900b25d1cce7c7">avic_hardware_setup</a> (void)</td></tr>
<tr class="separator:ada833d2b35b3e565a6900b25d1cce7c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af75098185942f8eb5703b2b65bf9257d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#af75098185942f8eb5703b2b65bf9257d">avic_ga_log_notifier</a> (u32 ga_tag)</td></tr>
<tr class="separator:af75098185942f8eb5703b2b65bf9257d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bb736e8688ecfaa3696b347764fd37d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a3bb736e8688ecfaa3696b347764fd37d">avic_vm_destroy</a> (struct kvm *kvm)</td></tr>
<tr class="separator:a3bb736e8688ecfaa3696b347764fd37d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddedac4b0b428928fae6bc9fe902e2a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a0ddedac4b0b428928fae6bc9fe902e2a">avic_vm_init</a> (struct kvm *kvm)</td></tr>
<tr class="separator:a0ddedac4b0b428928fae6bc9fe902e2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40f16bbe281410ac02865ea25c26bf12"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a40f16bbe281410ac02865ea25c26bf12">avic_init_vmcb</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, struct vmcb *vmcb)</td></tr>
<tr class="separator:a40f16bbe281410ac02865ea25c26bf12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a11c0014568405b90307ef68285e4ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a4a11c0014568405b90307ef68285e4ff">avic_incomplete_ipi_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a4a11c0014568405b90307ef68285e4ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299de3990a5ce5ce873df7afe2b3338f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a299de3990a5ce5ce873df7afe2b3338f">avic_unaccelerated_access_interception</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a299de3990a5ce5ce873df7afe2b3338f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e0a22138080054f4ac064064402f74a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a8e0a22138080054f4ac064064402f74a">avic_init_vcpu</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a8e0a22138080054f4ac064064402f74a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7decdbafc7d47b2241e68ce3c90a9779"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a7decdbafc7d47b2241e68ce3c90a9779">avic_vcpu_load</a> (struct kvm_vcpu *vcpu, int cpu)</td></tr>
<tr class="separator:a7decdbafc7d47b2241e68ce3c90a9779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a461f968598a11484e76a07fb87221bf2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a461f968598a11484e76a07fb87221bf2">avic_vcpu_put</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a461f968598a11484e76a07fb87221bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9f162404fdb37bba372d0c9cdc043ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ae9f162404fdb37bba372d0c9cdc043ee">avic_apicv_post_state_restore</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ae9f162404fdb37bba372d0c9cdc043ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affcdeac6765016e970e33d6ecff3eebb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#affcdeac6765016e970e33d6ecff3eebb">avic_refresh_apicv_exec_ctrl</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:affcdeac6765016e970e33d6ecff3eebb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8b145ddec7a3dc1367a4e4e0df397e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a3a8b145ddec7a3dc1367a4e4e0df397e">avic_pi_update_irte</a> (struct kvm *kvm, unsigned int host_irq, uint32_t guest_irq, bool set)</td></tr>
<tr class="separator:a3a8b145ddec7a3dc1367a4e4e0df397e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a056e12caaf24f044fce8545a863dbbce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a056e12caaf24f044fce8545a863dbbce">avic_vcpu_blocking</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a056e12caaf24f044fce8545a863dbbce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e341d7f17b2f611aca180217cfc6ad3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a7e341d7f17b2f611aca180217cfc6ad3">avic_vcpu_unblocking</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a7e341d7f17b2f611aca180217cfc6ad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c9ded2546dccf6e4b561e633d22e7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ac8c9ded2546dccf6e4b561e633d22e7e">avic_ring_doorbell</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:ac8c9ded2546dccf6e4b561e633d22e7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed65a2dabdad6a421b487e1e7b106277"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aed65a2dabdad6a421b487e1e7b106277">avic_vcpu_get_apicv_inhibit_reasons</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aed65a2dabdad6a421b487e1e7b106277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51356c24441683c197e1d4c2555da06d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a51356c24441683c197e1d4c2555da06d">avic_refresh_virtual_apic_mode</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:a51356c24441683c197e1d4c2555da06d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1eb77eac84f085b0a943b87f783e30d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#af1eb77eac84f085b0a943b87f783e30d">sev_vm_destroy</a> (struct kvm *kvm)</td></tr>
<tr class="separator:af1eb77eac84f085b0a943b87f783e30d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2039644d359270872404c4664a25d951"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a2039644d359270872404c4664a25d951">sev_mem_enc_ioctl</a> (struct kvm *kvm, void __user *argp)</td></tr>
<tr class="separator:a2039644d359270872404c4664a25d951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37c3ce91ad0ad98fb7d5676a318cde4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ab37c3ce91ad0ad98fb7d5676a318cde4">sev_mem_enc_register_region</a> (struct kvm *kvm, struct kvm_enc_region *range)</td></tr>
<tr class="separator:ab37c3ce91ad0ad98fb7d5676a318cde4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ed6164c0df5d13f87bce2be5a83e0d8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a8ed6164c0df5d13f87bce2be5a83e0d8">sev_mem_enc_unregister_region</a> (struct kvm *kvm, struct kvm_enc_region *range)</td></tr>
<tr class="separator:a8ed6164c0df5d13f87bce2be5a83e0d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b1ae3550c1b7c9973532d08d167ce2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a3b1ae3550c1b7c9973532d08d167ce2c">sev_vm_copy_enc_context_from</a> (struct kvm *kvm, unsigned int source_fd)</td></tr>
<tr class="separator:a3b1ae3550c1b7c9973532d08d167ce2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe3c569b297da3b78824074b8c08f9a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#abe3c569b297da3b78824074b8c08f9a7">sev_vm_move_enc_context_from</a> (struct kvm *kvm, unsigned int source_fd)</td></tr>
<tr class="separator:abe3c569b297da3b78824074b8c08f9a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad965a231dbcd0eb9eacac28848a143a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ad965a231dbcd0eb9eacac28848a143a8">sev_guest_memory_reclaimed</a> (struct kvm *kvm)</td></tr>
<tr class="separator:ad965a231dbcd0eb9eacac28848a143a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0a040a48a04ab47d0af3385ad214cd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ad0a040a48a04ab47d0af3385ad214cd4">pre_sev_run</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, int cpu)</td></tr>
<tr class="separator:ad0a040a48a04ab47d0af3385ad214cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaff9c624af59b36fd36d1c25e279a50"><td class="memItemLeft" align="right" valign="top">void __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aeaff9c624af59b36fd36d1c25e279a50">sev_set_cpu_caps</a> (void)</td></tr>
<tr class="separator:aeaff9c624af59b36fd36d1c25e279a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9afc6299b4f92c15a93b02db0318ad79"><td class="memItemLeft" align="right" valign="top">void __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a9afc6299b4f92c15a93b02db0318ad79">sev_hardware_setup</a> (void)</td></tr>
<tr class="separator:a9afc6299b4f92c15a93b02db0318ad79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bc306a80e6f2622f2c58d1271dcc05b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a0bc306a80e6f2622f2c58d1271dcc05b">sev_hardware_unsetup</a> (void)</td></tr>
<tr class="separator:a0bc306a80e6f2622f2c58d1271dcc05b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87f63ae4bc207e3d5a5d80e34243cf50"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a87f63ae4bc207e3d5a5d80e34243cf50">sev_cpu_init</a> (struct <a class="el" href="structsvm__cpu__data.html">svm_cpu_data</a> *sd)</td></tr>
<tr class="separator:a87f63ae4bc207e3d5a5d80e34243cf50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe289006ed99e36825065ad80cf7480f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#abe289006ed99e36825065ad80cf7480f">sev_init_vmcb</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:abe289006ed99e36825065ad80cf7480f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00c492279a529b66b80ed039ae6de23b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a00c492279a529b66b80ed039ae6de23b">sev_vcpu_after_set_cpuid</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:a00c492279a529b66b80ed039ae6de23b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af343f7dd067883e0f81017a68e854c09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#af343f7dd067883e0f81017a68e854c09">sev_free_vcpu</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:af343f7dd067883e0f81017a68e854c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac550422551b71c0afe8efe176e0b55d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aac550422551b71c0afe8efe176e0b55d">sev_handle_vmgexit</a> (struct kvm_vcpu *vcpu)</td></tr>
<tr class="separator:aac550422551b71c0afe8efe176e0b55d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8381dc2e2d38fd331490bbb2fd097d0a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a8381dc2e2d38fd331490bbb2fd097d0a">sev_es_string_io</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, int size, unsigned int port, int in)</td></tr>
<tr class="separator:a8381dc2e2d38fd331490bbb2fd097d0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa924db70d759d98124ad13172de1f0c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aa924db70d759d98124ad13172de1f0c5">sev_es_vcpu_reset</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:aa924db70d759d98124ad13172de1f0c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9809425cf0d198f1c65811a4716ceecf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a9809425cf0d198f1c65811a4716ceecf">sev_vcpu_deliver_sipi_vector</a> (struct kvm_vcpu *vcpu, u8 vector)</td></tr>
<tr class="separator:a9809425cf0d198f1c65811a4716ceecf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4655e18a7969aeb0228ecbbc011f546"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ad4655e18a7969aeb0228ecbbc011f546">sev_es_prepare_switch_to_guest</a> (struct sev_es_save_area *hostsa)</td></tr>
<tr class="separator:ad4655e18a7969aeb0228ecbbc011f546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba11fc99cad465d138aeb5c2cb3508e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aba11fc99cad465d138aeb5c2cb3508e2">sev_es_unmap_ghcb</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm)</td></tr>
<tr class="separator:aba11fc99cad465d138aeb5c2cb3508e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba6feca2fbeab5686eaf28f921a819f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aba6feca2fbeab5686eaf28f921a819f7">__svm_sev_es_vcpu_run</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, bool spec_ctrl_intercepted)</td></tr>
<tr class="separator:aba6feca2fbeab5686eaf28f921a819f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abedd386d3abba4edb2cf133ab91c57f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#abedd386d3abba4edb2cf133ab91c57f3">__svm_vcpu_run</a> (struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *svm, bool spec_ctrl_intercepted)</td></tr>
<tr class="separator:abedd386d3abba4edb2cf133ab91c57f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a036567d678fc3315196c7e4a5fa42cd3"><td class="memItemLeft" align="right" valign="top">u32 msrpm_offsets[<a class="el" href="svm_8h.html#aecb0b82114f9d516a3ee502c0054e0c0">MSRPM_OFFSETS</a>]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a036567d678fc3315196c7e4a5fa42cd3">__read_mostly</a></td></tr>
<tr class="separator:a036567d678fc3315196c7e4a5fa42cd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17a219d0651f1db709a3af0fc5527aa0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a></td></tr>
<tr class="separator:a17a219d0651f1db709a3af0fc5527aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea86d846f25c8a44402d3bc2d176130b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a></td></tr>
<tr class="separator:aea86d846f25c8a44402d3bc2d176130b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0a8ab91829811c7705c6455fb294bbc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a></td></tr>
<tr class="separator:ab0a8ab91829811c7705c6455fb294bbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8812d5d875ec9a2bf431790db71cfb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#adc8812d5d875ec9a2bf431790db71cfb">intercept_smi</a></td></tr>
<tr class="separator:adc8812d5d875ec9a2bf431790db71cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c0ba70ab315cedbb11f259b1d7ae08"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#ad4c0ba70ab315cedbb11f259b1d7ae08">x2avic_enabled</a></td></tr>
<tr class="separator:ad4c0ba70ab315cedbb11f259b1d7ae08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d0afd60cabe4ff8b40d7099f49a1bb8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a></td></tr>
<tr class="separator:a8d0afd60cabe4ff8b40d7099f49a1bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8be79ef0522e29a602517b51ff51f509"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a8be79ef0522e29a602517b51ff51f509">dump_invalid_vmcb</a></td></tr>
<tr class="separator:a8be79ef0522e29a602517b51ff51f509"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02e1632739fc6a1f76c81a50cc4a97ac"><td class="memItemLeft" align="right" valign="top">struct kvm_x86_nested_ops&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a02e1632739fc6a1f76c81a50cc4a97ac">svm_nested_ops</a></td></tr>
<tr class="separator:a02e1632739fc6a1f76c81a50cc4a97ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37d57b174f959f39f30e8f0796dc3afb"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="svm_8h.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a></td></tr>
<tr class="separator:a37d57b174f959f39f30e8f0796dc3afb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a006ecae20fd705ed2184ec4e6f0f5dd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a006ecae20fd705ed2184ec4e6f0f5dd9">&#9670;&nbsp;</a></span>__sme_page_pa</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __sme_page_pa</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;__sme_set(page_to_pfn(x) &lt;&lt; PAGE_SHIFT)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00028">28</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="af3af5258a6c47113ee5b5898437dd7df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3af5258a6c47113ee5b5898437dd7df">&#9670;&nbsp;</a></span>AVIC_REQUIRED_APICV_INHIBITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AVIC_REQUIRED_APICV_INHIBITS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(                           \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_DISABLE) |     \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_ABSENT) |      \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_HYPERV) |      \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_NESTED) |      \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_IRQWIN) |      \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_PIT_REINJ) |       \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_BLOCKIRQ) |        \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_SEV)      |        \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_PHYSICAL_ID_ALIASED) | \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_APIC_ID_MODIFIED) |    \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_APIC_BASE_MODIFIED) |  \</div>
<div class="line">    BIT(APICV_INHIBIT_REASON_LOGICAL_ID_ALIASED)    \</div>
<div class="line">)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00628">628</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="acfd26afe0ecab7e00defb0b34eb0a94a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfd26afe0ecab7e00defb0b34eb0a94a">&#9670;&nbsp;</a></span>DEBUGCTL_RESERVED_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUGCTL_RESERVED_BITS&#160;&#160;&#160;(~(0x3fULL))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00537">537</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="ad919ef3ad8475b1cc85b683ad7b33f95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad919ef3ad8475b1cc85b683ad7b33f95">&#9670;&nbsp;</a></span>DEFINE_KVM_GHCB_ACCESSORS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFINE_KVM_GHCB_ACCESSORS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">field</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keyword">static</span> __always_inline <span class="keywordtype">bool</span> kvm_ghcb_##field##_is_valid(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm) \</div>
<div class="line">    {                                   \</div>
<div class="line">        return test_bit(GHCB_BITMAP_IDX(field),             \</div>
<div class="line">                (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;svm-&gt;sev_es.valid_bitmap);    \</div>
<div class="line">    }                                   \</div>
<div class="line">                                        \</div>
<div class="line">    static __always_inline u64 kvm_ghcb_get_##field##_if_valid(<span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm, <span class="keyword">struct</span> ghcb *ghcb) \</div>
<div class="line">    {                                   \</div>
<div class="line">        return kvm_ghcb_##field##_is_valid(svm) ? ghcb-&gt;save.field : 0; \</div>
<div class="line">    }                                   \</div>
<div class="ttc" id="astructvcpu__svm_html"><div class="ttname"><a href="structvcpu__svm.html">vcpu_svm</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00209">svm.h:209</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00703">703</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="af4810b27551dd12e44459d9444873eb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4810b27551dd12e44459d9444873eb0">&#9670;&nbsp;</a></span>GHCB_VERSION_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GHCB_VERSION_MAX&#160;&#160;&#160;1ULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00667">667</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="ab146f6f540f9544ae3b4efaceae107c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab146f6f540f9544ae3b4efaceae107c8">&#9670;&nbsp;</a></span>GHCB_VERSION_MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GHCB_VERSION_MIN&#160;&#160;&#160;1ULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00668">668</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="a3db0df1165fd78ebd0af2184562f090c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3db0df1165fd78ebd0af2184562f090c">&#9670;&nbsp;</a></span>IOPM_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IOPM_SIZE&#160;&#160;&#160;PAGE_SIZE * 3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00030">30</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="a5da6b86ca5c95c3562c7d03dcbefe138"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5da6b86ca5c95c3562c7d03dcbefe138">&#9670;&nbsp;</a></span>MAX_DIRECT_ACCESS_MSRS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_DIRECT_ACCESS_MSRS&#160;&#160;&#160;47</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00033">33</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="ae9836254c789e1e9f8d62939ff44ff36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9836254c789e1e9f8d62939ff44ff36">&#9670;&nbsp;</a></span>MSR_INVALID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSR_INVALID&#160;&#160;&#160;0xffffffffU</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00535">535</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="aecb0b82114f9d516a3ee502c0054e0c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecb0b82114f9d516a3ee502c0054e0c0">&#9670;&nbsp;</a></span>MSRPM_OFFSETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSRPM_OFFSETS&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00034">34</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="a106125dd7b1447fe5e6cb6f08240137b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a106125dd7b1447fe5e6cb6f08240137b">&#9670;&nbsp;</a></span>MSRPM_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSRPM_SIZE&#160;&#160;&#160;PAGE_SIZE * 2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00031">31</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="ac75660e3dace3bef9ab0d76dedf2034e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac75660e3dace3bef9ab0d76dedf2034e">&#9670;&nbsp;</a></span>NESTED_EXIT_CONTINUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NESTED_EXIT_CONTINUE&#160;&#160;&#160;2	/* Further checks needed      */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00567">567</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="a9c953f5ab9b400e9a1c5232515ec6293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c953f5ab9b400e9a1c5232515ec6293">&#9670;&nbsp;</a></span>NESTED_EXIT_DONE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NESTED_EXIT_DONE&#160;&#160;&#160;1	/* Exit caused <a class="el" href="vmx_8c.html#a97d7564e1b5ae8c0173e53f859ac17e1">nested</a> vmexit  */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00566">566</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="a5d1cfc3512b22eae96df1b679e87a92e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d1cfc3512b22eae96df1b679e87a92e">&#9670;&nbsp;</a></span>NESTED_EXIT_HOST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NESTED_EXIT_HOST&#160;&#160;&#160;0	/* Exit handled <a class="el" href="posted__intr_8h.html#af49c2456e8fb34a117ca382ecb643aca">on</a> host level */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00565">565</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="a45c751b4204124bee221bec64ada4d72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45c751b4204124bee221bec64ada4d72">&#9670;&nbsp;</a></span>SVM_REGS_LAZY_LOAD_SET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SVM_REGS_LAZY_LOAD_SET&#160;&#160;&#160;(1 &lt;&lt; VCPU_EXREG_PDPTR)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00377">377</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="a317277564d2351c6695a358504311483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a317277564d2351c6695a358504311483">&#9670;&nbsp;</a></span>VMCB_ALL_CLEAN_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMCB_ALL_CLEAN_MASK</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    (                   \</div>
<div class="line">    (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a>) | (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a0b96a6cb7dc2eb2f1e2471f9fdfa6972">VMCB_PERM_MAP</a>) |   \</div>
<div class="line">    (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64">VMCB_ASID</a>) | (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a>) |         \</div>
<div class="line">    (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7c9727e792c945164c49fbd9793c4e97">VMCB_NPT</a>) | (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>) | (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac7c020c96383ecc6a3d358e1fdd99be7">VMCB_DR</a>) |  \</div>
<div class="line">    (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a1c1bbe2afa896e3b5fc2f2d850eb41b3">VMCB_DT</a>) | (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ab13d3c949ef62a4213fe70e2ed836b91">VMCB_SEG</a>) | (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1">VMCB_CR2</a>) | \</div>
<div class="line">    (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a">VMCB_LBR</a>) | (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f">VMCB_AVIC</a>) |          \</div>
<div class="line">    (1U &lt;&lt; <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aadb6ebcdeea82b3c1ad950e8e2433d8c">VMCB_SW</a>))</div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a0b96a6cb7dc2eb2f1e2471f9fdfa6972"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a0b96a6cb7dc2eb2f1e2471f9fdfa6972">VMCB_PERM_MAP</a></div><div class="ttdeci">@ VMCB_PERM_MAP</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00051">svm.h:51</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a1c1bbe2afa896e3b5fc2f2d850eb41b3"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a1c1bbe2afa896e3b5fc2f2d850eb41b3">VMCB_DT</a></div><div class="ttdeci">@ VMCB_DT</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00057">svm.h:57</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f">VMCB_AVIC</a></div><div class="ttdeci">@ VMCB_AVIC</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00061">svm.h:61</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a></div><div class="ttdeci">@ VMCB_INTR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00053">svm.h:53</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a></div><div class="ttdeci">@ VMCB_CR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00055">svm.h:55</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a7c9727e792c945164c49fbd9793c4e97"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7c9727e792c945164c49fbd9793c4e97">VMCB_NPT</a></div><div class="ttdeci">@ VMCB_NPT</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00054">svm.h:54</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a">VMCB_LBR</a></div><div class="ttdeci">@ VMCB_LBR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00060">svm.h:60</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a></div><div class="ttdeci">@ VMCB_INTERCEPTS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00049">svm.h:49</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13aadb6ebcdeea82b3c1ad950e8e2433d8c"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aadb6ebcdeea82b3c1ad950e8e2433d8c">VMCB_SW</a></div><div class="ttdeci">@ VMCB_SW</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00065">svm.h:65</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13ab13d3c949ef62a4213fe70e2ed836b91"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ab13d3c949ef62a4213fe70e2ed836b91">VMCB_SEG</a></div><div class="ttdeci">@ VMCB_SEG</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00058">svm.h:58</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1">VMCB_CR2</a></div><div class="ttdeci">@ VMCB_CR2</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00059">svm.h:59</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13ac7c020c96383ecc6a3d358e1fdd99be7"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac7c020c96383ecc6a3d358e1fdd99be7">VMCB_DR</a></div><div class="ttdeci">@ VMCB_DR</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00056">svm.h:56</a></div></div>
<div class="ttc" id="asvm_8h_html_a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64"><div class="ttname"><a href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64">VMCB_ASID</a></div><div class="ttdeci">@ VMCB_ASID</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00052">svm.h:52</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00068">68</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<a id="a987416bb1857b96f97af2391d1008c5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a987416bb1857b96f97af2391d1008c5a">&#9670;&nbsp;</a></span>VMCB_ALWAYS_DIRTY_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMCB_ALWAYS_DIRTY_MASK&#160;&#160;&#160;((1U &lt;&lt; <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a>) | (1U &lt;&lt; <a class="el" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1">VMCB_CR2</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00077">77</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a39fca1837c5ce7715cbf571669660c13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39fca1837c5ce7715cbf571669660c13">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1"></a>VMCB_INTERCEPTS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a0b96a6cb7dc2eb2f1e2471f9fdfa6972"></a>VMCB_PERM_MAP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64"></a>VMCB_ASID&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e"></a>VMCB_INTR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a7c9727e792c945164c49fbd9793c4e97"></a>VMCB_NPT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975"></a>VMCB_CR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13ac7c020c96383ecc6a3d358e1fdd99be7"></a>VMCB_DR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a1c1bbe2afa896e3b5fc2f2d850eb41b3"></a>VMCB_DT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13ab13d3c949ef62a4213fe70e2ed836b91"></a>VMCB_SEG&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1"></a>VMCB_CR2&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a"></a>VMCB_LBR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f"></a>VMCB_AVIC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13aadb6ebcdeea82b3c1ad950e8e2433d8c"></a>VMCB_SW&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00048">48</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;     {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a>, <span class="comment">/* Intercept vectors, TSC offset,</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">                pause filter count */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a0b96a6cb7dc2eb2f1e2471f9fdfa6972">VMCB_PERM_MAP</a>,   <span class="comment">/* IOPM Base and MSRPM Base */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64">VMCB_ASID</a>,   <span class="comment">/* ASID */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a47e03f1935e6feea250cf3d13fa4c71e">VMCB_INTR</a>,   <span class="comment">/* int_ctl, int_vector */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7c9727e792c945164c49fbd9793c4e97">VMCB_NPT</a>,        <span class="comment">/* npt_en, nCR3, gPAT */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>,     <span class="comment">/* CR0, CR3, CR4, EFER */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac7c020c96383ecc6a3d358e1fdd99be7">VMCB_DR</a>,         <span class="comment">/* DR6, DR7 */</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a1c1bbe2afa896e3b5fc2f2d850eb41b3">VMCB_DT</a>,         <span class="comment">/* GDT, IDT */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ab13d3c949ef62a4213fe70e2ed836b91">VMCB_SEG</a>,        <span class="comment">/* CS, DS, SS, ES, CPL */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ac328b9fd73e1b9d219f9890f938509e1">VMCB_CR2</a>,        <span class="comment">/* CR2 only */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a">VMCB_LBR</a>,        <span class="comment">/* DBGCTL, BR_FROM, BR_TO, LAST_EX_FROM, LAST_EX_TO */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f">VMCB_AVIC</a>,       <span class="comment">/* AVIC APIC_BAR, AVIC APIC_BACKING_PAGE,</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">              * AVIC PHYSICAL_TABLE pointer,</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">              * AVIC LOGICAL_TABLE pointer</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">              */</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aadb6ebcdeea82b3c1ad950e8e2433d8c">VMCB_SW</a> = 31,    <span class="comment">/* Reserved for hypervisor/software use */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aba6feca2fbeab5686eaf28f921a819f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba6feca2fbeab5686eaf28f921a819f7">&#9670;&nbsp;</a></span>__svm_sev_es_vcpu_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __svm_sev_es_vcpu_run </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>spec_ctrl_intercepted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aba6feca2fbeab5686eaf28f921a819f7_icgraph.png" border="0" usemap="#asvm_8h_aba6feca2fbeab5686eaf28f921a819f7_icgraph" alt=""/></div>
<map name="asvm_8h_aba6feca2fbeab5686eaf28f921a819f7_icgraph" id="asvm_8h_aba6feca2fbeab5686eaf28f921a819f7_icgraph">
<area shape="rect" title=" " alt="" coords="379,5,561,32"/>
<area shape="rect" href="svm_8c.html#a04b96ed53c5aaf42d298205d87cd7762" title=" " alt="" coords="169,5,331,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="abedd386d3abba4edb2cf133ab91c57f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abedd386d3abba4edb2cf133ab91c57f3">&#9670;&nbsp;</a></span>__svm_vcpu_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __svm_vcpu_run </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>spec_ctrl_intercepted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_abedd386d3abba4edb2cf133ab91c57f3_icgraph.png" border="0" usemap="#asvm_8h_abedd386d3abba4edb2cf133ab91c57f3_icgraph" alt=""/></div>
<map name="asvm_8h_abedd386d3abba4edb2cf133ab91c57f3_icgraph" id="asvm_8h_abedd386d3abba4edb2cf133ab91c57f3_icgraph">
<area shape="rect" title=" " alt="" coords="379,5,509,32"/>
<area shape="rect" href="svm_8c.html#a04b96ed53c5aaf42d298205d87cd7762" title=" " alt="" coords="169,5,331,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="ae9f162404fdb37bba372d0c9cdc043ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9f162404fdb37bba372d0c9cdc043ee">&#9670;&nbsp;</a></span>avic_apicv_post_state_restore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void avic_apicv_post_state_restore </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00738">738</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;{</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="avic_8c.html#aaff9720871b696bc298d89cbb27a6dc2">avic_handle_dfr_update</a>(vcpu);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <a class="code" href="avic_8c.html#a6a9ffca6bae1adce86d4495b5caaae2e">avic_handle_ldr_update</a>(vcpu);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a6a9ffca6bae1adce86d4495b5caaae2e"><div class="ttname"><a href="avic_8c.html#a6a9ffca6bae1adce86d4495b5caaae2e">avic_handle_ldr_update</a></div><div class="ttdeci">static void avic_handle_ldr_update(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00610">avic.c:610</a></div></div>
<div class="ttc" id="aavic_8c_html_aaff9720871b696bc298d89cbb27a6dc2"><div class="ttname"><a href="avic_8c.html#aaff9720871b696bc298d89cbb27a6dc2">avic_handle_dfr_update</a></div><div class="ttdeci">static void avic_handle_dfr_update(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00629">avic.c:629</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ae9f162404fdb37bba372d0c9cdc043ee_cgraph.png" border="0" usemap="#asvm_8h_ae9f162404fdb37bba372d0c9cdc043ee_cgraph" alt=""/></div>
<map name="asvm_8h_ae9f162404fdb37bba372d0c9cdc043ee_cgraph" id="asvm_8h_ae9f162404fdb37bba372d0c9cdc043ee_cgraph">
<area shape="rect" title=" " alt="" coords="5,161,172,203"/>
<area shape="rect" href="avic_8c.html#aaff9720871b696bc298d89cbb27a6dc2" title=" " alt="" coords="220,114,397,141"/>
<area shape="rect" href="avic_8c.html#a6a9ffca6bae1adce86d4495b5caaae2e" title=" " alt="" coords="221,194,397,221"/>
<area shape="rect" href="avic_8c.html#a2ed13621ec3f14afbf47f129e43b496d" title=" " alt="" coords="445,77,616,119"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="702,26,773,53"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="665,245,810,271"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="666,106,809,133"/>
<area shape="rect" href="avic_8c.html#a5eaaa2d4a926c006359343ff29a9cdf7" title=" " alt="" coords="664,168,811,209"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="885,175,991,202"/>
<area shape="rect" href="lapic_8h.html#aa28a43e0f54449e2ec4d25e1f8ecb178" title=" " alt="" coords="859,245,1017,271"/>
<area shape="rect" href="avic_8c.html#a2650b353757b538de17a1c843f7308d2" title=" " alt="" coords="474,245,587,271"/>
<area shape="rect" href="lapic_8h.html#a4f07303d20a06eeb408d4985c5e15096" title=" " alt="" coords="475,295,587,322"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ae9f162404fdb37bba372d0c9cdc043ee_icgraph.png" border="0" usemap="#asvm_8h_ae9f162404fdb37bba372d0c9cdc043ee_icgraph" alt=""/></div>
<map name="asvm_8h_ae9f162404fdb37bba372d0c9cdc043ee_icgraph" id="asvm_8h_ae9f162404fdb37bba372d0c9cdc043ee_icgraph">
<area shape="rect" title=" " alt="" coords="396,5,563,47"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="197,5,348,47"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="5,5,149,47"/>
</map>
</div>

</div>
</div>
<a id="af75098185942f8eb5703b2b65bf9257d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af75098185942f8eb5703b2b65bf9257d">&#9670;&nbsp;</a></span>avic_ga_log_notifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int avic_ga_log_notifier </td>
          <td>(</td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>ga_tag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00143">143</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__svm.html">kvm_svm</a> *<a class="code" href="structkvm__svm.html">kvm_svm</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = NULL;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    u32 vm_id = <a class="code" href="avic_8c.html#a504afac7afffff075f42d33af8c21ef0">AVIC_GATAG_TO_VMID</a>(ga_tag);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    u32 vcpu_id = <a class="code" href="avic_8c.html#a379bb93a0924b7a44f0fa7cdd37517b1">AVIC_GATAG_TO_VCPUID</a>(ga_tag);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    pr_debug(<span class="stringliteral">&quot;SVM: %s: vm_id=%#x, vcpu_id=%#x\n&quot;</span>, __func__, vm_id, vcpu_id);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    trace_kvm_avic_ga_log(vm_id, vcpu_id);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    spin_lock_irqsave(&amp;svm_vm_data_hash_lock, <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    hash_for_each_possible(svm_vm_data_hash, <a class="code" href="structkvm__svm.html">kvm_svm</a>, hnode, vm_id) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#a06c4479d5aefb8c19b8ead15d599b324">avic_vm_id</a> != vm_id)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        vcpu = kvm_get_vcpu_by_id(&amp;<a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a>, vcpu_id);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    spin_unlock_irqrestore(&amp;svm_vm_data_hash_lock, <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">/* Note:</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">     * At this point, the IOMMU should have already set the pending</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">     * bit in the vAPIC backing page. So, we just need to schedule</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">     * in the vcpu.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">if</span> (vcpu)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5">kvm_vcpu_wake_up</a>(vcpu);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a379bb93a0924b7a44f0fa7cdd37517b1"><div class="ttname"><a href="avic_8c.html#a379bb93a0924b7a44f0fa7cdd37517b1">AVIC_GATAG_TO_VCPUID</a></div><div class="ttdeci">#define AVIC_GATAG_TO_VCPUID(x)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00047">avic.c:47</a></div></div>
<div class="ttc" id="aavic_8c_html_a504afac7afffff075f42d33af8c21ef0"><div class="ttname"><a href="avic_8c.html#a504afac7afffff075f42d33af8c21ef0">AVIC_GATAG_TO_VMID</a></div><div class="ttdeci">#define AVIC_GATAG_TO_VMID(x)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00046">avic.c:46</a></div></div>
<div class="ttc" id="akvm__main_8c_html_ad9f0140eebcdef9a9ebae54431d2fba5"><div class="ttname"><a href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5">kvm_vcpu_wake_up</a></div><div class="ttdeci">bool kvm_vcpu_wake_up(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l03915">kvm_main.c:3915</a></div></div>
<div class="ttc" id="astructkvm__svm_html"><div class="ttname"><a href="structkvm__svm.html">kvm_svm</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00095">svm.h:95</a></div></div>
<div class="ttc" id="astructkvm__svm_html_a06c4479d5aefb8c19b8ead15d599b324"><div class="ttname"><a href="structkvm__svm.html#a06c4479d5aefb8c19b8ead15d599b324">kvm_svm::avic_vm_id</a></div><div class="ttdeci">u32 avic_vm_id</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00099">svm.h:99</a></div></div>
<div class="ttc" id="astructkvm__svm_html_ade6c6ec6e820a10719c5d61e161aa8b8"><div class="ttname"><a href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm_svm::kvm</a></div><div class="ttdeci">struct kvm kvm</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00092">svm.h:96</a></div></div>
<div class="ttc" id="axen_8c_html_a773b39d480759f67926cb18ae2219281"><div class="ttname"><a href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a></div><div class="ttdeci">uint32_t flags</div><div class="ttdef"><b>Definition:</b> <a href="xen_8c_source.html#l00001">xen.c:1</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_af75098185942f8eb5703b2b65bf9257d_cgraph.png" border="0" usemap="#asvm_8h_af75098185942f8eb5703b2b65bf9257d_cgraph" alt=""/></div>
<map name="asvm_8h_af75098185942f8eb5703b2b65bf9257d_cgraph" id="asvm_8h_af75098185942f8eb5703b2b65bf9257d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,157,32"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="205,5,359,32"/>
</map>
</div>

</div>
</div>
<a id="ada833d2b35b3e565a6900b25d1cce7c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada833d2b35b3e565a6900b25d1cce7c7">&#9670;&nbsp;</a></span>avic_hardware_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool avic_hardware_setup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l01188">1188</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;{</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">/* AVIC is a prerequisite for x2AVIC. */</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_AVIC) &amp;&amp; !<a class="code" href="avic_8c.html#a969a7c5f37696d459ce0a2065a8ca97f">force_avic</a>) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_X2AVIC)) {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            pr_warn(FW_BUG <span class="stringliteral">&quot;Cannot support x2AVIC due to AVIC is disabled&quot;</span>);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            pr_warn(FW_BUG <span class="stringliteral">&quot;Try enable AVIC using force_avic option&quot;</span>);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_AVIC)) {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        pr_info(<span class="stringliteral">&quot;AVIC enabled\n&quot;</span>);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="avic_8c.html#a969a7c5f37696d459ce0a2065a8ca97f">force_avic</a>) {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">         * Some older systems does not advertise AVIC support.</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">         * See Revision Guide for specific AMD processor for more detail.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        pr_warn(<span class="stringliteral">&quot;AVIC is not supported in CPUID but force enabled&quot;</span>);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        pr_warn(<span class="stringliteral">&quot;Your system might crash and burn&quot;</span>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="comment">/* AVIC is a prerequisite for x2AVIC. */</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <a class="code" href="avic_8c.html#ad4c0ba70ab315cedbb11f259b1d7ae08">x2avic_enabled</a> = boot_cpu_has(X86_FEATURE_X2AVIC);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="avic_8c.html#ad4c0ba70ab315cedbb11f259b1d7ae08">x2avic_enabled</a>)</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        pr_info(<span class="stringliteral">&quot;x2AVIC enabled\n&quot;</span>);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    amd_iommu_register_ga_log_notifier(&amp;<a class="code" href="avic_8c.html#af75098185942f8eb5703b2b65bf9257d">avic_ga_log_notifier</a>);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a969a7c5f37696d459ce0a2065a8ca97f"><div class="ttname"><a href="avic_8c.html#a969a7c5f37696d459ce0a2065a8ca97f">force_avic</a></div><div class="ttdeci">static bool force_avic</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00062">avic.c:60</a></div></div>
<div class="ttc" id="aavic_8c_html_ad4c0ba70ab315cedbb11f259b1d7ae08"><div class="ttname"><a href="avic_8c.html#ad4c0ba70ab315cedbb11f259b1d7ae08">x2avic_enabled</a></div><div class="ttdeci">bool x2avic_enabled</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00075">avic.c:75</a></div></div>
<div class="ttc" id="aavic_8c_html_af75098185942f8eb5703b2b65bf9257d"><div class="ttname"><a href="avic_8c.html#af75098185942f8eb5703b2b65bf9257d">avic_ga_log_notifier</a></div><div class="ttdeci">int avic_ga_log_notifier(u32 ga_tag)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00143">avic.c:143</a></div></div>
<div class="ttc" id="asvm_8c_html_a17a219d0651f1db709a3af0fc5527aa0"><div class="ttname"><a href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a></div><div class="ttdeci">bool npt_enabled</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00198">svm.c:198</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ada833d2b35b3e565a6900b25d1cce7c7_icgraph.png" border="0" usemap="#asvm_8h_ada833d2b35b3e565a6900b25d1cce7c7_icgraph" alt=""/></div>
<map name="asvm_8h_ada833d2b35b3e565a6900b25d1cce7c7_icgraph" id="asvm_8h_ada833d2b35b3e565a6900b25d1cce7c7_icgraph">
<area shape="rect" title=" " alt="" coords="215,5,375,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="a4a11c0014568405b90307ef68285e4ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a11c0014568405b90307ef68285e4ff">&#9670;&nbsp;</a></span>avic_incomplete_ipi_interception()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int avic_incomplete_ipi_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00490">490</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    u32 icrh = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1 &gt;&gt; 32;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    u32 icrl = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    u32 <span class="keywordtype">id</span> = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2 &gt;&gt; 32;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    u32 index = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2 &amp; 0x1FF;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__lapic.html">kvm_lapic</a> *apic = <a class="code" href="structkvm__lapic.html#a54741597d07b2792d2da72ea301ad648">vcpu</a>-&gt;arch.apic;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    trace_kvm_avic_incomplete_ipi(<a class="code" href="structkvm__lapic.html#a54741597d07b2792d2da72ea301ad648">vcpu</a>-&gt;vcpu_id, icrh, icrl, <span class="keywordtype">id</span>, index);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">switch</span> (<span class="keywordtype">id</span>) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">case</span> AVIC_IPI_FAILURE_INVALID_TARGET:</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">case</span> AVIC_IPI_FAILURE_INVALID_INT_TYPE:</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">         * Emulate IPIs that are not handled by AVIC hardware, which</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">         * only virtualizes Fixed, Edge-Triggered INTRs, and falls over</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">         * if _any_ targets are invalid, e.g. if the logical mode mask</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">         * is a superset of running vCPUs.</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">         * The exit is a trap, e.g. ICR holds the correct value and RIP</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">         * has been advanced, KVM is responsible only for emulating the</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">         * IPI.  Sadly, hardware may sometimes leave the BUSY flag set,</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">         * in which case KVM needs to emulate the ICR write as well in</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">         * order to clear the BUSY flag.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">if</span> (icrl &amp; APIC_ICR_BUSY)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <a class="code" href="lapic_8c.html#a1b33bb5758d3dd75c7b87e537a5e729e">kvm_apic_write_nodecode</a>(<a class="code" href="structkvm__lapic.html#a54741597d07b2792d2da72ea301ad648">vcpu</a>, APIC_ICR);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <a class="code" href="lapic_8c.html#a4b7f12cb3ba68245df79bc30d938b728">kvm_apic_send_ipi</a>(apic, icrl, icrh);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">case</span> AVIC_IPI_FAILURE_TARGET_NOT_RUNNING:</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">         * At this point, we expect that the AVIC HW has already</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">         * set the appropriate IRR bits on the valid target</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">         * vcpus. So, we just need to kick the appropriate vcpu.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="avic_8c.html#ad9345a779111a59de8fa4110106c3adf">avic_kick_target_vcpus</a>(<a class="code" href="structkvm__lapic.html#a54741597d07b2792d2da72ea301ad648">vcpu</a>-&gt;kvm, apic, icrl, icrh, index);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">case</span> AVIC_IPI_FAILURE_INVALID_BACKING_PAGE:</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        WARN_ONCE(1, <span class="stringliteral">&quot;Invalid backing page\n&quot;</span>);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">case</span> AVIC_IPI_FAILURE_INVALID_IPI_VECTOR:</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="comment">/* Invalid IPI with vector &lt; 16 */</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        vcpu_unimpl(<a class="code" href="structkvm__lapic.html#a54741597d07b2792d2da72ea301ad648">vcpu</a>, <span class="stringliteral">&quot;Unknown avic incomplete IPI interception\n&quot;</span>);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_ad9345a779111a59de8fa4110106c3adf"><div class="ttname"><a href="avic_8c.html#ad9345a779111a59de8fa4110106c3adf">avic_kick_target_vcpus</a></div><div class="ttdeci">static void avic_kick_target_vcpus(struct kvm *kvm, struct kvm_lapic *source, u32 icrl, u32 icrh, u32 index)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00465">avic.c:465</a></div></div>
<div class="ttc" id="alapic_8c_html_a1b33bb5758d3dd75c7b87e537a5e729e"><div class="ttname"><a href="lapic_8c.html#a1b33bb5758d3dd75c7b87e537a5e729e">kvm_apic_write_nodecode</a></div><div class="ttdeci">void kvm_apic_write_nodecode(struct kvm_vcpu *vcpu, u32 offset)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8c_source.html#l02446">lapic.c:2446</a></div></div>
<div class="ttc" id="alapic_8c_html_a4b7f12cb3ba68245df79bc30d938b728"><div class="ttname"><a href="lapic_8c.html#a4b7f12cb3ba68245df79bc30d938b728">kvm_apic_send_ipi</a></div><div class="ttdeci">void kvm_apic_send_ipi(struct kvm_lapic *apic, u32 icr_low, u32 icr_high)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8c_source.html#l01504">lapic.c:1504</a></div></div>
<div class="ttc" id="astructkvm__lapic_html"><div class="ttname"><a href="structkvm__lapic.html">kvm_lapic</a></div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00059">lapic.h:59</a></div></div>
<div class="ttc" id="astructkvm__lapic_html_a54741597d07b2792d2da72ea301ad648"><div class="ttname"><a href="structkvm__lapic.html#a54741597d07b2792d2da72ea301ad648">kvm_lapic::vcpu</a></div><div class="ttdeci">struct kvm_vcpu * vcpu</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00064">lapic.h:64</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af095ed7bcc31c036e28e533582723a60"><div class="ttname"><a href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vcpu_svm::vmcb</a></div><div class="ttdeci">struct vmcb * vmcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00212">svm.h:212</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af164d8d741d9ea90dae6a46974d29f9e"><div class="ttname"><a href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu_svm::vcpu</a></div><div class="ttdeci">struct kvm_vcpu vcpu</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00206">svm.h:210</a></div></div>
<div class="ttc" id="asvm_8h_html_a83e420c88631faf9613ea3caa72c63b7"><div class="ttname"><a href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a></div><div class="ttdeci">static __always_inline struct vcpu_svm * to_svm(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00364">svm.h:364</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a4a11c0014568405b90307ef68285e4ff_cgraph.png" border="0" usemap="#asvm_8h_a4a11c0014568405b90307ef68285e4ff_cgraph" alt=""/></div>
<map name="asvm_8h_a4a11c0014568405b90307ef68285e4ff_cgraph" id="asvm_8h_a4a11c0014568405b90307ef68285e4ff_cgraph">
<area shape="rect" title=" " alt="" coords="5,419,157,460"/>
<area shape="rect" href="avic_8c.html#ad9345a779111a59de8fa4110106c3adf" title=" " alt="" coords="931,249,1106,276"/>
<area shape="rect" href="lapic_8c.html#a4b7f12cb3ba68245df79bc30d938b728" title=" " alt="" coords="692,452,839,478"/>
<area shape="rect" href="lapic_8c.html#a1b33bb5758d3dd75c7b87e537a5e729e" title=" " alt="" coords="205,452,400,478"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="267,502,338,529"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="1741,401,1883,428"/>
<area shape="rect" href="avic_8c.html#a7cf9fdcdf4f5f6559c099faaab0c2d29" title=" " alt="" coords="1167,173,1373,200"/>
<area shape="rect" href="avic_8c.html#a2b9e298755a0d51bb5b2dfc9dd254c64" title=" " alt="" coords="1991,21,2112,48"/>
<area shape="rect" href="lapic_8c.html#adb63e5a650d4571316b450d153a3105d" title=" " alt="" coords="1186,350,1354,377"/>
<area shape="rect" href="avic_8c.html#a1404df5f813565dd104640a6e5bfea67" title=" " alt="" coords="1430,46,1643,73"/>
<area shape="rect" href="avic_8c.html#a4b900d047f49b6cd00266aba3f4912bf" title=" " alt="" coords="1700,46,1924,73"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="1739,1294,1885,1321"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="1483,148,1590,174"/>
<area shape="rect" href="svm_8c.html#a1faf261e116f9d9481e1bd6796e32280" title=" " alt="" coords="2179,14,2360,55"/>
<area shape="rect" href="lapic_8h.html#aa28a43e0f54449e2ec4d25e1f8ecb178" title=" " alt="" coords="1972,1294,2131,1321"/>
<area shape="rect" href="lapic_8c.html#a870119cb74033f360164df90029af75a" title=" " alt="" coords="1427,553,1646,580"/>
<area shape="rect" href="lapic_8c.html#ae8c127c0d736bacbfa2cdc6b3fd5c2f6" title=" " alt="" coords="1421,300,1652,326"/>
<area shape="rect" href="lapic_8c.html#a8fb87d02d911e49b5793e391702afe7e" title=" " alt="" coords="1476,350,1597,377"/>
<area shape="rect" href="irq_8h.html#a50293a78b5c0b6715243dc7854bcb210" title=" " alt="" coords="924,684,1113,710"/>
<area shape="rect" href="lapic_8c.html#a47d52843df792ef8e7bffdfb66a3b40b" title=" " alt="" coords="1179,604,1361,630"/>
<area shape="rect" href="lapic_8h.html#ae7e74fde3e4fb01f561634e789b5eab4" title=" " alt="" coords="1199,940,1341,966"/>
<area shape="rect" href="lapic_8c.html#a3d272e1b73f22f797955e7ddea84b741" title=" " alt="" coords="1469,801,1605,828"/>
<area shape="rect" href="lapic_8h.html#a447b1b971acaf871dd62669b4aa3116f" title=" " alt="" coords="1185,889,1355,916"/>
<area shape="rect" href="lapic_8c.html#a17eee4051fa1d41b805b09a195f64045" title=" " alt="" coords="1193,823,1347,864"/>
<area shape="rect" href="lapic_8h.html#adfbea71ac96b210fb91bef47c77194f1" title=" " alt="" coords="1173,654,1367,681"/>
<area shape="rect" href="x86_8c.html#a47d88660a2a5f8ee22df1253604d1ed7" title=" " alt="" coords="1191,706,1349,747"/>
<area shape="rect" href="lapic_8c.html#ac9fecb7d9f4574931650af9abb4b9f4c" title=" " alt="" coords="1189,553,1351,580"/>
<area shape="rect" href="lapic_8c.html#a378a0961283ea67791303e70114fb10d" title=" " alt="" coords="449,350,611,377"/>
<area shape="rect" href="lapic_8c.html#acebc0ffd4530dfd1beb1254d1e4d9491" title=" " alt="" coords="451,1269,609,1296"/>
<area shape="rect" href="lapic_8c.html#adf2487dc76dace6e577b637cc357998b" title=" " alt="" coords="448,452,612,478"/>
<area shape="rect" href="lapic_8c.html#aa06cb4ebbfa40dbfa494b3b4cd9f8833" title=" " alt="" coords="678,350,853,377"/>
<area shape="rect" href="lapic_8c.html#adaceffbfc91320b193a66d974fb12ce0" title=" " alt="" coords="939,1142,1099,1169"/>
<area shape="rect" href="lapic_8c.html#afefd171448cafa66f80ecb9b9659ebb1" title=" " alt="" coords="660,1142,871,1169"/>
<area shape="rect" href="lapic_8c.html#af5602fb092ac09abc6c2bf0ad789d726" title=" " alt="" coords="714,1193,817,1220"/>
<area shape="rect" href="lapic_8c.html#aeb32a868e76d57da9fab57fce43efdbe" title=" " alt="" coords="710,1396,821,1422"/>
<area shape="rect" href="lapic_8c.html#ab2ee275fa1bc17aa0bfde435723b8f48" title=" " alt="" coords="947,1446,1091,1473"/>
<area shape="rect" href="lapic_8c.html#a02bd03bf711be3200ea2316ced434ff1" title=" " alt="" coords="715,1548,816,1574"/>
<area shape="rect" href="lapic_8c.html#ac7a03b55710bfcc78be7af0609f6f93d" title=" " alt="" coords="700,1294,831,1321"/>
<area shape="rect" href="lapic_8c.html#a8aa5f66b440e07d680f42fdaa211eac2" title=" " alt="" coords="949,1244,1089,1270"/>
<area shape="rect" href="lapic_8c.html#aec07f4595f82e14e1075beb4730b6976" title=" " alt="" coords="710,1497,821,1524"/>
<area shape="rect" href="lapic_8c.html#a54214770509be207a1c1271e8b48acf4" title=" " alt="" coords="697,1598,834,1625"/>
<area shape="rect" href="lapic_8c.html#a2a5ccc92c8b75ad6118bdc1b84a43554" title=" " alt="" coords="697,1649,833,1676"/>
<area shape="rect" href="lapic_8c.html#ab24997de83c3fd44d1cd7520a615883e" title=" " alt="" coords="679,1345,852,1372"/>
<area shape="rect" href="lapic_8c.html#a36de6235abe5d5bd2fd57bf5739c1b5f" title=" " alt="" coords="673,1700,858,1726"/>
<area shape="rect" href="lapic_8c.html#a756b707dd502680db2eed7759defde40" title=" " alt="" coords="919,990,1119,1017"/>
<area shape="rect" href="lapic_8c.html#ab18679414f6ced1b8597fc3a9b445dea" title=" " alt="" coords="697,1801,834,1828"/>
<area shape="rect" href="lapic_8c.html#ade21404bee3e5dbbe596ff391e0a23db" title=" " alt="" coords="695,788,836,814"/>
<area shape="rect" href="lapic_8c.html#a5f5c49ce8a579b59663644f0f1a6cbe3" title=" " alt="" coords="701,838,829,865"/>
<area shape="rect" href="lapic_8c.html#a946cf21407471f7a6ba449b2435055c3" title=" " alt="" coords="940,1624,1097,1650"/>
<area shape="rect" href="lapic_8c.html#a694be782d2a5e9a6ece8dd51f3da91f4" title=" " alt="" coords="1443,1737,1630,1764"/>
</map>
</div>

</div>
</div>
<a id="a8e0a22138080054f4ac064064402f74a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e0a22138080054f4ac064064402f74a">&#9670;&nbsp;</a></span>avic_init_vcpu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int avic_init_vcpu </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00719">719</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;{</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a04af9ab3eee510b54cba17a6fa94ee04">enable_apicv</a> || !<a class="code" href="irq_8h.html#a96951e3a1bfa402d8bee67713e267b39">irqchip_in_kernel</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    ret = <a class="code" href="avic_8c.html#aefc63eafb35c1efd94f6d53e7d0b20d5">avic_init_backing_page</a>(vcpu);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    INIT_LIST_HEAD(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af217181f505db1b71c48743233032539">ir_list</a>);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    spin_lock_init(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af38f3c63a81a10aae69b308aa175d618">ir_list_lock</a>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#ae08ffe38b03c1c44686c57c274553f59">dfr_reg</a> = APIC_DFR_FLAT;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_aefc63eafb35c1efd94f6d53e7d0b20d5"><div class="ttname"><a href="avic_8c.html#aefc63eafb35c1efd94f6d53e7d0b20d5">avic_init_backing_page</a></div><div class="ttdeci">static int avic_init_backing_page(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00277">avic.c:277</a></div></div>
<div class="ttc" id="airq_8h_html_a96951e3a1bfa402d8bee67713e267b39"><div class="ttname"><a href="irq_8h.html#a96951e3a1bfa402d8bee67713e267b39">irqchip_in_kernel</a></div><div class="ttdeci">static int irqchip_in_kernel(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="irq_8h_source.html#l00090">irq.h:90</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_ae08ffe38b03c1c44686c57c274553f59"><div class="ttname"><a href="structvcpu__svm.html#ae08ffe38b03c1c44686c57c274553f59">vcpu_svm::dfr_reg</a></div><div class="ttdeci">u32 dfr_reg</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00268">svm.h:268</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af217181f505db1b71c48743233032539"><div class="ttname"><a href="structvcpu__svm.html#af217181f505db1b71c48743233032539">vcpu_svm::ir_list</a></div><div class="ttdeci">struct list_head ir_list</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00270">svm.h:278</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af38f3c63a81a10aae69b308aa175d618"><div class="ttname"><a href="structvcpu__svm.html#af38f3c63a81a10aae69b308aa175d618">vcpu_svm::ir_list_lock</a></div><div class="ttdeci">spinlock_t ir_list_lock</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00279">svm.h:279</a></div></div>
<div class="ttc" id="ax86_8c_html_a04af9ab3eee510b54cba17a6fa94ee04"><div class="ttname"><a href="x86_8c.html#a04af9ab3eee510b54cba17a6fa94ee04">enable_apicv</a></div><div class="ttdeci">bool __read_mostly enable_apicv</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00235">x86.c:235</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a8e0a22138080054f4ac064064402f74a_cgraph.png" border="0" usemap="#asvm_8h_a8e0a22138080054f4ac064064402f74a_cgraph" alt=""/></div>
<map name="asvm_8h_a8e0a22138080054f4ac064064402f74a_cgraph" id="asvm_8h_a8e0a22138080054f4ac064064402f74a_cgraph">
<area shape="rect" title=" " alt="" coords="5,547,120,574"/>
<area shape="rect" href="avic_8c.html#aefc63eafb35c1efd94f6d53e7d0b20d5" title=" " alt="" coords="168,522,343,549"/>
<area shape="rect" href="irq_8h.html#a96951e3a1bfa402d8bee67713e267b39" title=" " alt="" coords="189,573,321,599"/>
<area shape="rect" href="avic_8c.html#a8cfb06497cbd5960a4a909c44e701f06" title=" " alt="" coords="419,431,576,472"/>
<area shape="rect" href="lapic_8c.html#a8c6616d2cbae35632aa5debb15b552ec" title=" " alt="" coords="391,497,604,523"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="417,547,578,574"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="462,598,533,625"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="697,438,804,465"/>
<area shape="rect" href="x86_8c.html#a0c0c5e35bc626e4140927bf15b4881f9" title=" " alt="" coords="652,493,849,519"/>
<area shape="rect" href="kvm__main_8c.html#a5132836c5be1763ca353ca2489a7fe23" title=" " alt="" coords="699,787,802,814"/>
<area shape="rect" href="kvm__main_8c.html#ac76f506181e49aa4800bb202e11cb2b3" title=" " alt="" coords="903,147,1106,174"/>
<area shape="rect" href="kvm__main_8c.html#ab790fe1e5bd86339acfc80a95efddf4c" title=" " alt="" coords="1183,5,1354,47"/>
<area shape="rect" href="kvm__main_8c.html#a8f5a06af032a1edb199b4ae393b2de8e" title=" " alt="" coords="1160,71,1377,98"/>
<area shape="rect" href="guest__memfd_8c.html#abaf64b8cb9e32ccb368d1d9c49d0bb02" title=" " alt="" coords="1201,122,1336,149"/>
<area shape="rect" href="guest__memfd_8c.html#a905ecfa162a290dceb1c7d5678e2a70f" title=" " alt="" coords="1975,198,2126,225"/>
<area shape="rect" href="kvm__main_8c.html#ac81a7d714d0668ccea6d0c2ddfd0fed5" title=" " alt="" coords="1197,610,1340,637"/>
<area shape="rect" href="guest__memfd_8c.html#a2eab57d9fb8529d3751b5c8179d881c9" title=" " alt="" coords="2232,198,2387,225"/>
<area shape="rect" href="kvm__main_8c.html#a52d56a5dc447602839375289b5bbffb2" title=" " alt="" coords="1707,610,1883,637"/>
<area shape="rect" href="kvm__main_8c.html#a05eed662dd45e4e4f7485e3158d95a3b" title=" " alt="" coords="1425,303,1644,330"/>
<area shape="rect" href="kvm__main_8c.html#a8c9bd99a64bbedb0930e29ed4dcc7897" title=" " alt="" coords="1453,610,1617,637"/>
<area shape="rect" href="kvm__main_8c.html#ac4ce014a99262ed5672a102c6d2ffdbd" title=" " alt="" coords="1453,661,1617,687"/>
<area shape="rect" href="kvm__main_8c.html#aae203bcd73cff0002aeddd37bea71323" title=" " alt="" coords="1701,863,1889,890"/>
<area shape="rect" href="kvm__main_8c.html#afdb5cea8958921b2ea9bd3a29cf9d7a6" title=" " alt="" coords="1455,711,1615,738"/>
<area shape="rect" href="kvm__main_8c.html#a6dd13a049fee9663450eebbf2ac16faa" title=" " alt="" coords="1449,493,1620,535"/>
<area shape="rect" href="kvm__main_8c.html#a192569033b972982f6b53e13666ef82b" title=" " alt="" coords="1431,762,1638,789"/>
<area shape="rect" href="kvm__main_8c.html#aa89329e461345f4a586065895ca072c6" title=" " alt="" coords="2213,610,2405,637"/>
<area shape="rect" href="kvm__main_8c.html#a115855e32d0da82706ba0bf22d90d8f1" title=" " alt="" coords="1965,711,2136,738"/>
<area shape="rect" href="kvm__main_8c.html#a6178ec8efee3ce8e53d84403b2a25401" title=" " alt="" coords="1945,661,2156,687"/>
<area shape="rect" href="kvm__main_8c.html#ada893d7e7d49d1023d23653b23944572" title=" " alt="" coords="2229,711,2390,738"/>
<area shape="rect" href="kvm__main_8c.html#a1a0266e85b304bdbde46a83f921d9606" title=" " alt="" coords="2204,661,2415,687"/>
<area shape="rect" href="kvm__main_8c.html#a578857fc65c8fabf9b425ff0b55a5fd3" title=" " alt="" coords="2228,762,2391,789"/>
<area shape="rect" href="kvm__main_8c.html#aa3b1664c58e5dab933e8659d884d56f3" title=" " alt="" coords="2223,813,2396,839"/>
<area shape="rect" href="x86_8c.html#af7325960c06aa482e6f168f881d83069" title=" " alt="" coords="1692,325,1897,367"/>
<area shape="rect" href="kvm__main_8c.html#aab592fb3a4d6204c86d8f99caa0986ba" title=" " alt="" coords="1952,274,2149,301"/>
<area shape="rect" href="kvm__main_8c.html#ae2d9291adcda0ba0f7a20350dabdd418" title=" " alt="" coords="1720,223,1869,250"/>
<area shape="rect" href="mmu_8c.html#a58fe7b43995ae8c20c597e1bb9c4c007" title=" " alt="" coords="1960,787,2141,828"/>
<area shape="rect" href="kvm__main_8c.html#a31dbd36d8363fc2e5979b3976ebc0dbb" title=" " alt="" coords="1955,852,2146,893"/>
<area shape="rect" href="kvm__main_8c.html#aa87d0b55e37a312b7291fa9b5c83634c" title=" " alt="" coords="1973,918,2128,945"/>
<area shape="rect" href="kvm__main_8c.html#a40ed7705420af10446677d1c99a0978e" title=" " alt="" coords="1705,442,1884,469"/>
<area shape="rect" href="x86_8c.html#a14568e065745512e03b3088070848289" title=" " alt="" coords="1692,493,1897,535"/>
<area shape="rect" href="dirty__ring_8c.html#a38d9bd671fa9181708075184e77eca3a" title=" " alt="" coords="1709,559,1880,586"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="959,787,1050,814"/>
<area shape="rect" href="kvm__main_8c.html#a99f99281cc81d5cd69f5825ccb8793b4" title=" " alt="" coords="897,838,1112,865"/>
<area shape="rect" href="kvm__main_8c.html#a7c20e0f654f0b4472c3833f0a563e11e" title=" " alt="" coords="1205,762,1333,789"/>
<area shape="rect" href="kvm__main_8c.html#aa77d8fc2ee9fe5965c45f1d0989eb266" title=" " alt="" coords="1191,813,1347,839"/>
<area shape="rect" href="kvm__main_8c.html#a63ec3e18db03a212e6e84391b5025689" title=" " alt="" coords="1449,943,1620,970"/>
<area shape="rect" href="kvm__main_8c.html#ab58025ccc253a102c64561fa61c2a514" title=" " alt="" coords="1719,969,1871,995"/>
<area shape="rect" href="kvm__main_8c.html#a77ec4b9140d69a05f3b4e7836cc03a96" title=" " alt="" coords="1969,969,2132,995"/>
<area shape="rect" href="kvm__main_8c.html#adfbe9f59cac426f2ff01ab4fcfd631a7" title=" " alt="" coords="1747,1019,1842,1046"/>
<area shape="rect" href="kvm__main_8c.html#a6c7165822622ebbd29159771905bd317" title=" " alt="" coords="1171,863,1367,890"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a8e0a22138080054f4ac064064402f74a_icgraph.png" border="0" usemap="#asvm_8h_a8e0a22138080054f4ac064064402f74a_icgraph" alt=""/></div>
<map name="asvm_8h_a8e0a22138080054f4ac064064402f74a_icgraph" id="asvm_8h_a8e0a22138080054f4ac064064402f74a_icgraph">
<area shape="rect" title=" " alt="" coords="189,5,304,32"/>
<area shape="rect" href="svm_8c.html#a2af2f754ca7838a0253d54c33aae7d1e" title=" " alt="" coords="5,5,141,32"/>
</map>
</div>

</div>
</div>
<a id="a40f16bbe281410ac02865ea25c26bf12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40f16bbe281410ac02865ea25c26bf12">&#9670;&nbsp;</a></span>avic_init_vmcb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void avic_init_vmcb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>vmcb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00244">244</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__svm.html">kvm_svm</a> *<a class="code" href="structkvm__svm.html">kvm_svm</a> = <a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.kvm);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    phys_addr_t bpa = __sme_set(page_to_phys(svm-&gt;<a class="code" href="structvcpu__svm.html#a2c8b33d5ae9b731a886634cd6c00165f">avic_backing_page</a>));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    phys_addr_t lpa = __sme_set(page_to_phys(<a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#a837dca12e3d1d7b768feb04c6a3c2e96">avic_logical_id_table_page</a>));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    phys_addr_t ppa = __sme_set(page_to_phys(<a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#aa05522988cc0a3ce6ad59dcec1ed0c46">avic_physical_id_table_page</a>));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    vmcb-&gt;control.avic_backing_page = bpa &amp; AVIC_HPA_MASK;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    vmcb-&gt;control.avic_logical_id = lpa &amp; AVIC_HPA_MASK;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    vmcb-&gt;control.avic_physical_id = ppa &amp; AVIC_HPA_MASK;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    vmcb-&gt;control.avic_vapic_bar = APIC_DEFAULT_PHYS_BASE &amp; VMCB_AVIC_APIC_BAR_MASK;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a">kvm_apicv_activated</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.kvm))</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa">avic_activate_vmcb</a>(svm);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3">avic_deactivate_vmcb</a>(svm);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a2af29a6a396bb757ac21f02f6aacfdfa"><div class="ttname"><a href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa">avic_activate_vmcb</a></div><div class="ttdeci">static void avic_activate_vmcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00085">avic.c:85</a></div></div>
<div class="ttc" id="aavic_8c_html_ac41a57fe4f855076b5c5718def5bd6d3"><div class="ttname"><a href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3">avic_deactivate_vmcb</a></div><div class="ttdeci">static void avic_deactivate_vmcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00120">avic.c:120</a></div></div>
<div class="ttc" id="astructkvm__svm_html_a837dca12e3d1d7b768feb04c6a3c2e96"><div class="ttname"><a href="structkvm__svm.html#a837dca12e3d1d7b768feb04c6a3c2e96">kvm_svm::avic_logical_id_table_page</a></div><div class="ttdeci">struct page * avic_logical_id_table_page</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00100">svm.h:100</a></div></div>
<div class="ttc" id="astructkvm__svm_html_aa05522988cc0a3ce6ad59dcec1ed0c46"><div class="ttname"><a href="structkvm__svm.html#aa05522988cc0a3ce6ad59dcec1ed0c46">kvm_svm::avic_physical_id_table_page</a></div><div class="ttdeci">struct page * avic_physical_id_table_page</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00101">svm.h:101</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a2c8b33d5ae9b731a886634cd6c00165f"><div class="ttname"><a href="structvcpu__svm.html#a2c8b33d5ae9b731a886634cd6c00165f">vcpu_svm::avic_backing_page</a></div><div class="ttdeci">struct page * avic_backing_page</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00269">svm.h:269</a></div></div>
<div class="ttc" id="asvm_8h_html_ac27f6fe2ff4beeb5ad1b11681d0386fd"><div class="ttname"><a href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a></div><div class="ttdeci">static __always_inline struct kvm_svm * to_kvm_svm(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00316">svm.h:316</a></div></div>
<div class="ttc" id="ax86_8c_html_a21212b8e1a82cdc8ac696137981d8d7a"><div class="ttname"><a href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a">kvm_apicv_activated</a></div><div class="ttdeci">bool kvm_apicv_activated(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09935">x86.c:9935</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a40f16bbe281410ac02865ea25c26bf12_cgraph.png" border="0" usemap="#asvm_8h_a40f16bbe281410ac02865ea25c26bf12_cgraph" alt=""/></div>
<map name="asvm_8h_a40f16bbe281410ac02865ea25c26bf12_cgraph" id="asvm_8h_a40f16bbe281410ac02865ea25c26bf12_cgraph">
<area shape="rect" title=" " alt="" coords="5,275,125,301"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="181,195,333,221"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="173,249,341,276"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="177,300,338,327"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="204,351,311,377"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="397,136,540,163"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="389,187,548,229"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="596,195,755,221"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="821,137,980,178"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="803,224,999,251"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="1078,5,1219,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="1047,57,1251,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="1075,123,1222,149"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1113,224,1184,251"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="1073,173,1224,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="1299,224,1472,251"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="409,253,529,280"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="390,304,547,331"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a40f16bbe281410ac02865ea25c26bf12_icgraph.png" border="0" usemap="#asvm_8h_a40f16bbe281410ac02865ea25c26bf12_icgraph" alt=""/></div>
<map name="asvm_8h_a40f16bbe281410ac02865ea25c26bf12_icgraph" id="asvm_8h_a40f16bbe281410ac02865ea25c26bf12_icgraph">
<area shape="rect" title=" " alt="" coords="316,5,436,32"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="181,5,268,32"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
</map>
</div>

</div>
</div>
<a id="a3a8b145ddec7a3dc1367a4e4e0df397e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a8b145ddec7a3dc1367a4e4e0df397e">&#9670;&nbsp;</a></span>avic_pi_update_irte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int avic_pi_update_irte </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>host_irq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>guest_irq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Here, we setup with legacy mode in the following cases:</p><ol type="1">
<li>When cannot target interrupt to a specific vcpu.</li>
<li>Unsetting posted interrupt.</li>
<li>APIC virtualization is disabled for the vcpu.</li>
<li>IRQ has incompatible delivery mode (SMI, INIT, etc)</li>
</ol>
<p>Here, we successfully setting up vcpu affinity in IOMMU guest mode. Now, we need to store the posted interrupt information in a per-vcpu ir_list so that we can reference to them directly when we update vcpu scheduling information in IOMMU irte.</p>
<p>Here, pi is used to:</p><ul>
<li>Tell IOMMU to use legacy mode for this interrupt.</li>
<li>Retrieve ga_tag of prior interrupt remapping data.</li>
</ul>
<p>Check if the posted interrupt was previously setup with the guest_mode by checking if the ga_tag was cached. If so, we need to clean up the per-vcpu ir_list.</p>

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00894">894</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;{</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keyword">struct </span>kvm_kernel_irq_routing_entry *e;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keyword">struct </span>kvm_irq_routing_table *irq_rt;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordtype">int</span> idx, ret = 0;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#ae63567e9b665b34f8c84fc4dc594f3c8">kvm_arch_has_assigned_device</a>(kvm) ||</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        !irq_remapping_cap(IRQ_POSTING_CAP))</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    pr_debug(<span class="stringliteral">&quot;SVM: %s: host_irq=%#x, guest_irq=%#x, set=%#x\n&quot;</span>,</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;         __func__, host_irq, guest_irq, set);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    idx = srcu_read_lock(&amp;kvm-&gt;irq_srcu);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    irq_rt = srcu_dereference(kvm-&gt;irq_routing, &amp;kvm-&gt;irq_srcu);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">if</span> (guest_irq &gt;= irq_rt-&gt;nr_rt_entries ||</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        hlist_empty(&amp;irq_rt-&gt;map[guest_irq])) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        pr_warn_once(<span class="stringliteral">&quot;no route for guest_irq %u/%u (broken user space?)\n&quot;</span>,</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                 guest_irq, irq_rt-&gt;nr_rt_entries);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    hlist_for_each_entry(e, &amp;irq_rt-&gt;map[guest_irq], link) {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keyword">struct </span>vcpu_data vcpu_info;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = NULL;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">if</span> (e-&gt;type != KVM_IRQ_ROUTING_MSI)</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">         * Here, we setup with legacy mode in the following cases:</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">         * 1. When cannot target interrupt to a specific vcpu.</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">         * 2. Unsetting posted interrupt.</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">         * 3. APIC virtualization is disabled for the vcpu.</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">         * 4. IRQ has incompatible delivery mode (SMI, INIT, etc)</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="avic_8c.html#a24f70312b475fe0e0858ee3cc7e3af71">get_pi_vcpu_info</a>(kvm, e, &amp;vcpu_info, &amp;svm) &amp;&amp; set &amp;&amp;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>)) {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <span class="keyword">struct </span>amd_iommu_pi_data pi;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <span class="comment">/* Try to enable guest_mode in IRTE */</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            pi.base = __sme_set(page_to_phys(svm-&gt;<a class="code" href="structvcpu__svm.html#a2c8b33d5ae9b731a886634cd6c00165f">avic_backing_page</a>) &amp;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        AVIC_HPA_MASK);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            pi.ga_tag = <a class="code" href="avic_8c.html#a76254d6522116c2c98b13d9342ba145a">AVIC_GATAG</a>(<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(kvm)-&gt;avic_vm_id,</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                             svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.vcpu_id);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            pi.is_guest_mode = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            pi.vcpu_data = &amp;vcpu_info;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            ret = irq_set_vcpu_affinity(host_irq, &amp;pi);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">            /**</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">             * Here, we successfully setting up vcpu affinity in</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">             * IOMMU guest mode. Now, we need to store the posted</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">             * interrupt information in a per-vcpu ir_list so that</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">             * we can reference to them directly when we update vcpu</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">             * scheduling information in IOMMU irte.</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <span class="keywordflow">if</span> (!ret &amp;&amp; pi.is_guest_mode)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                <a class="code" href="avic_8c.html#a0262c9f1d0d537dafa962ca68a873378">svm_ir_list_add</a>(svm, &amp;pi);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <span class="comment">/* Use legacy mode in IRTE */</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <span class="keyword">struct </span>amd_iommu_pi_data pi;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">            /**</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">             * Here, pi is used to:</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">             * - Tell IOMMU to use legacy mode for this interrupt.</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">             * - Retrieve ga_tag of prior interrupt remapping data.</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            pi.prev_ga_tag = 0;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            pi.is_guest_mode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            ret = irq_set_vcpu_affinity(host_irq, &amp;pi);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">            /**</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">             * Check if the posted interrupt was previously</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">             * setup with the guest_mode by checking if the ga_tag</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">             * was cached. If so, we need to clean up the per-vcpu</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">             * ir_list.</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            <span class="keywordflow">if</span> (!ret &amp;&amp; pi.prev_ga_tag) {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="avic_8c.html#a379bb93a0924b7a44f0fa7cdd37517b1">AVIC_GATAG_TO_VCPUID</a>(pi.prev_ga_tag);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <span class="keyword">struct </span>kvm_vcpu *vcpu;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                vcpu = kvm_get_vcpu_by_id(kvm, <span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                <span class="keywordflow">if</span> (vcpu)</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                    <a class="code" href="avic_8c.html#a0573329bfb8b7a1a2ba0a4e2ce438dfa">svm_ir_list_del</a>(<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu), &amp;pi);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        }</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">if</span> (!ret &amp;&amp; svm) {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            trace_kvm_pi_irte_update(host_irq, svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.vcpu_id,</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                         e-&gt;gsi, vcpu_info.vector,</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                         vcpu_info.pi_desc_addr, set);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            pr_err(<span class="stringliteral">&quot;%s: failed to update PI IRTE\n&quot;</span>, __func__);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    ret = 0;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;out:</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    srcu_read_unlock(&amp;kvm-&gt;irq_srcu, idx);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a0262c9f1d0d537dafa962ca68a873378"><div class="ttname"><a href="avic_8c.html#a0262c9f1d0d537dafa962ca68a873378">svm_ir_list_add</a></div><div class="ttdeci">static int svm_ir_list_add(struct vcpu_svm *svm, struct amd_iommu_pi_data *pi)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00792">avic.c:792</a></div></div>
<div class="ttc" id="aavic_8c_html_a0573329bfb8b7a1a2ba0a4e2ce438dfa"><div class="ttname"><a href="avic_8c.html#a0573329bfb8b7a1a2ba0a4e2ce438dfa">svm_ir_list_del</a></div><div class="ttdeci">static void svm_ir_list_del(struct vcpu_svm *svm, struct amd_iommu_pi_data *pi)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00776">avic.c:776</a></div></div>
<div class="ttc" id="aavic_8c_html_a24f70312b475fe0e0858ee3cc7e3af71"><div class="ttname"><a href="avic_8c.html#a24f70312b475fe0e0858ee3cc7e3af71">get_pi_vcpu_info</a></div><div class="ttdeci">static int get_pi_vcpu_info(struct kvm *kvm, struct kvm_kernel_irq_routing_entry *e, struct vcpu_data *vcpu_info, struct vcpu_svm **svm)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00861">avic.c:861</a></div></div>
<div class="ttc" id="aavic_8c_html_a76254d6522116c2c98b13d9342ba145a"><div class="ttname"><a href="avic_8c.html#a76254d6522116c2c98b13d9342ba145a">AVIC_GATAG</a></div><div class="ttdeci">#define AVIC_GATAG(vm_id, vcpu_id)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00051">avic.c:51</a></div></div>
<div class="ttc" id="alapic_8h_html_a3af346d02eebff16886d49d3810b5358"><div class="ttname"><a href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a></div><div class="ttdeci">static bool kvm_vcpu_apicv_active(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00226">lapic.h:226</a></div></div>
<div class="ttc" id="ax86_8c_html_ae63567e9b665b34f8c84fc4dc594f3c8"><div class="ttname"><a href="x86_8c.html#ae63567e9b665b34f8c84fc4dc594f3c8">kvm_arch_has_assigned_device</a></div><div class="ttdeci">bool noinstr kvm_arch_has_assigned_device(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13419">x86.c:13419</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a3a8b145ddec7a3dc1367a4e4e0df397e_cgraph.png" border="0" usemap="#asvm_8h_a3a8b145ddec7a3dc1367a4e4e0df397e_cgraph" alt=""/></div>
<map name="asvm_8h_a3a8b145ddec7a3dc1367a4e4e0df397e_cgraph" id="asvm_8h_a3a8b145ddec7a3dc1367a4e4e0df397e_cgraph">
<area shape="rect" title=" " alt="" coords="5,539,155,565"/>
<area shape="rect" href="avic_8c.html#a24f70312b475fe0e0858ee3cc7e3af71" title=" " alt="" coords="227,437,359,464"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="488,501,559,528"/>
<area shape="rect" href="x86_8c.html#ae63567e9b665b34f8c84fc4dc594f3c8" title=" " alt="" coords="203,641,384,682"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="663,349,841,376"/>
<area shape="rect" href="avic_8c.html#a0262c9f1d0d537dafa962ca68a873378" title=" " alt="" coords="231,539,355,565"/>
<area shape="rect" href="avic_8c.html#a0573329bfb8b7a1a2ba0a4e2ce438dfa" title=" " alt="" coords="463,564,583,591"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="240,707,347,733"/>
<area shape="rect" href="irq__comm_8c.html#a6de5d9a13302fceb034b8d75b4c787e2" title=" " alt="" coords="432,400,615,427"/>
<area shape="rect" href="irq__comm_8c.html#a6270cddb139f2ca4f42d21f8caaa1224" title=" " alt="" coords="457,451,590,477"/>
<area shape="rect" href="lapic_8c.html#adb63e5a650d4571316b450d153a3105d" title=" " alt="" coords="668,236,836,263"/>
<area shape="rect" href="lapic_8h.html#ae7e74fde3e4fb01f561634e789b5eab4" title=" " alt="" coords="681,400,823,427"/>
<area shape="rect" href="lapic_8c.html#a8620b1c89f8cf017f7827024fc95ac92" title=" " alt="" coords="680,451,824,493"/>
<area shape="rect" href="lapic_8c.html#a870119cb74033f360164df90029af75a" title=" " alt="" coords="895,81,1114,108"/>
<area shape="rect" href="lapic_8c.html#ae8c127c0d736bacbfa2cdc6b3fd5c2f6" title=" " alt="" coords="889,208,1120,235"/>
<area shape="rect" href="lapic_8c.html#a8fb87d02d911e49b5793e391702afe7e" title=" " alt="" coords="944,287,1065,313"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="1459,157,1601,184"/>
<area shape="rect" href="lapic_8c.html#a98bde25094c754b30e796357ba643ab0" title=" " alt="" coords="1207,107,1363,133"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="1213,5,1358,32"/>
<area shape="rect" href="lapic_8h.html#aa28a43e0f54449e2ec4d25e1f8ecb178" title=" " alt="" coords="1451,5,1609,32"/>
<area shape="rect" href="lapic_8c.html#a8bdd67ff70db633e45cce412fb4c7718" title=" " alt="" coords="1225,208,1345,235"/>
<area shape="rect" href="lapic_8h.html#a4f07303d20a06eeb408d4985c5e15096" title=" " alt="" coords="1229,259,1341,285"/>
<area shape="rect" href="lapic_8h.html#a1d8660ecbda996b11b10b179013e52d4" title=" " alt="" coords="919,400,1090,427"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="945,349,1064,376"/>
<area shape="rect" href="lapic_8c.html#aee815bad0e899bbf195750d2d9b5470f" title=" " alt="" coords="913,477,1097,518"/>
<area shape="rect" href="lapic_8c.html#a47d52843df792ef8e7bffdfb66a3b40b" title=" " alt="" coords="1195,461,1376,488"/>
<area shape="rect" href="lapic_8c.html#a079d589509607a9d9baa6bed3eae7fa6" title=" " alt="" coords="1193,513,1378,554"/>
<area shape="rect" href="lapic_8c.html#abbce6da431ef5f15d85b5fc741d3ef72" title=" " alt="" coords="1181,360,1390,387"/>
<area shape="rect" href="lapic_8c.html#a2381239fbfde7c282aabdd2c01f50ad3" title=" " alt="" coords="1168,579,1403,605"/>
<area shape="rect" href="lapic_8h.html#adfbea71ac96b210fb91bef47c77194f1" title=" " alt="" coords="1189,629,1382,656"/>
<area shape="rect" href="x86_8c.html#a47d88660a2a5f8ee22df1253604d1ed7" title=" " alt="" coords="1207,681,1364,722"/>
<area shape="rect" href="lapic_8c.html#ac9fecb7d9f4574931650af9abb4b9f4c" title=" " alt="" coords="1204,411,1367,437"/>
</map>
</div>

</div>
</div>
<a id="affcdeac6765016e970e33d6ecff3eebb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affcdeac6765016e970e33d6ecff3eebb">&#9670;&nbsp;</a></span>avic_refresh_apicv_exec_ctrl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void avic_refresh_apicv_exec_ctrl </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l01136">1136</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;{</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordtype">bool</span> activated = <a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(vcpu);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a04af9ab3eee510b54cba17a6fa94ee04">enable_apicv</a>)</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <a class="code" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d">avic_refresh_virtual_apic_mode</a>(vcpu);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">if</span> (activated)</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <a class="code" href="avic_8c.html#a7decdbafc7d47b2241e68ce3c90a9779">avic_vcpu_load</a>(vcpu, vcpu-&gt;cpu);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <a class="code" href="avic_8c.html#a461f968598a11484e76a07fb87221bf2">avic_vcpu_put</a>(vcpu);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <a class="code" href="avic_8c.html#a520da70652fa3f7af0d58c1ecb7d0db7">avic_set_pi_irte_mode</a>(vcpu, activated);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a461f968598a11484e76a07fb87221bf2"><div class="ttname"><a href="avic_8c.html#a461f968598a11484e76a07fb87221bf2">avic_vcpu_put</a></div><div class="ttdeci">void avic_vcpu_put(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01072">avic.c:1072</a></div></div>
<div class="ttc" id="aavic_8c_html_a51356c24441683c197e1d4c2555da06d"><div class="ttname"><a href="avic_8c.html#a51356c24441683c197e1d4c2555da06d">avic_refresh_virtual_apic_mode</a></div><div class="ttdeci">void avic_refresh_virtual_apic_mode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01112">avic.c:1112</a></div></div>
<div class="ttc" id="aavic_8c_html_a520da70652fa3f7af0d58c1ecb7d0db7"><div class="ttname"><a href="avic_8c.html#a520da70652fa3f7af0d58c1ecb7d0db7">avic_set_pi_irte_mode</a></div><div class="ttdeci">static int avic_set_pi_irte_mode(struct kvm_vcpu *vcpu, bool activate)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00744">avic.c:744</a></div></div>
<div class="ttc" id="aavic_8c_html_a7decdbafc7d47b2241e68ce3c90a9779"><div class="ttname"><a href="avic_8c.html#a7decdbafc7d47b2241e68ce3c90a9779">avic_vcpu_load</a></div><div class="ttdeci">void avic_vcpu_load(struct kvm_vcpu *vcpu, int cpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01028">avic.c:1028</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_affcdeac6765016e970e33d6ecff3eebb_cgraph.png" border="0" usemap="#asvm_8h_affcdeac6765016e970e33d6ecff3eebb_cgraph" alt=""/></div>
<map name="asvm_8h_affcdeac6765016e970e33d6ecff3eebb_cgraph" id="asvm_8h_affcdeac6765016e970e33d6ecff3eebb_cgraph">
<area shape="rect" title=" " alt="" coords="5,681,149,723"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="197,503,348,544"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="396,638,575,665"/>
<area shape="rect" href="avic_8c.html#a520da70652fa3f7af0d58c1ecb7d0db7" title=" " alt="" coords="1077,798,1245,825"/>
<area shape="rect" href="avic_8c.html#a7decdbafc7d47b2241e68ce3c90a9779" title=" " alt="" coords="865,739,987,766"/>
<area shape="rect" href="avic_8c.html#a461f968598a11484e76a07fb87221bf2" title=" " alt="" coords="869,689,983,715"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="409,426,561,453"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1373,577,1444,603"/>
<area shape="rect" href="avic_8c.html#ae9f162404fdb37bba372d0c9cdc043ee" title=" " alt="" coords="623,244,789,285"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="401,482,569,509"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="647,634,765,661"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="417,375,553,402"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="1337,251,1480,278"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="627,412,785,453"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="847,419,1005,446"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="1081,361,1240,403"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="1063,529,1259,555"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="1338,470,1479,497"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="1307,303,1511,344"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="1335,369,1482,395"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="1333,419,1484,446"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="1559,470,1732,497"/>
<area shape="rect" href="avic_8c.html#aaff9720871b696bc298d89cbb27a6dc2" title=" " alt="" coords="837,251,1015,278"/>
<area shape="rect" href="avic_8c.html#a6a9ffca6bae1adce86d4495b5caaae2e" title=" " alt="" coords="838,193,1014,219"/>
<area shape="rect" href="avic_8c.html#a2ed13621ec3f14afbf47f129e43b496d" title=" " alt="" coords="1075,244,1246,285"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="1336,91,1481,118"/>
<area shape="rect" href="avic_8c.html#a5eaaa2d4a926c006359343ff29a9cdf7" title=" " alt="" coords="1335,164,1482,205"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="1592,171,1699,198"/>
<area shape="rect" href="lapic_8h.html#aa28a43e0f54449e2ec4d25e1f8ecb178" title=" " alt="" coords="1566,91,1725,118"/>
<area shape="rect" href="avic_8c.html#a2650b353757b538de17a1c843f7308d2" title=" " alt="" coords="1104,91,1217,118"/>
<area shape="rect" href="lapic_8h.html#a4f07303d20a06eeb408d4985c5e15096" title=" " alt="" coords="1105,41,1217,67"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="646,478,766,505"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="627,529,785,555"/>
<area shape="rect" href="x86_8c.html#ae63567e9b665b34f8c84fc4dc594f3c8" title=" " alt="" coords="1318,761,1499,803"/>
<area shape="rect" href="avic_8c.html#a7b088623e16cec4875e37d8ce15231b2" title=" " alt="" coords="1065,732,1257,773"/>
</map>
</div>

</div>
</div>
<a id="a51356c24441683c197e1d4c2555da06d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51356c24441683c197e1d4c2555da06d">&#9670;&nbsp;</a></span>avic_refresh_virtual_apic_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void avic_refresh_virtual_apic_mode </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>During AVIC temporary deactivation, guest could update APIC ID, DFR and LDR registers, which would not be trapped by <a class="el" href="avic_8c.html#a299de3990a5ce5ce873df7afe2b3338f">avic_unaccelerated_access_interception()</a>. In this case, we need to check and update the AVIC logical APIC ID table accordingly before re-activating.</p>

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l01112">1112</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;{</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4">lapic_in_kernel</a>(vcpu) || !<a class="code" href="x86_8c.html#a04af9ab3eee510b54cba17a6fa94ee04">enable_apicv</a>)</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(vcpu)) {<span class="comment"></span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">         * During AVIC temporary deactivation, guest could update</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">         * APIC ID, DFR and LDR registers, which would not be trapped</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">         * by avic_unaccelerated_access_interception(). In this case,</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">         * we need to check and update the AVIC logical APIC ID table</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">         * accordingly before re-activating.</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <a class="code" href="avic_8c.html#ae9f162404fdb37bba372d0c9cdc043ee">avic_apicv_post_state_restore</a>(vcpu);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <a class="code" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa">avic_activate_vmcb</a>(svm);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <a class="code" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3">avic_deactivate_vmcb</a>(svm);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(vmcb, <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a3d33483aba8bab1af6c7a3a56141cd8f">VMCB_AVIC</a>);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_ae9f162404fdb37bba372d0c9cdc043ee"><div class="ttname"><a href="avic_8c.html#ae9f162404fdb37bba372d0c9cdc043ee">avic_apicv_post_state_restore</a></div><div class="ttdeci">void avic_apicv_post_state_restore(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00738">avic.c:738</a></div></div>
<div class="ttc" id="alapic_8h_html_a1d8c9378fcbf62390a89dc3b7f0bdbd4"><div class="ttname"><a href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4">lapic_in_kernel</a></div><div class="ttdeci">static bool lapic_in_kernel(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00186">lapic.h:186</a></div></div>
<div class="ttc" id="astructkvm__vmcb__info_html_a8076921f239564576af7af19be7f6f04"><div class="ttname"><a href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">kvm_vmcb_info::ptr</a></div><div class="ttdeci">struct vmcb * ptr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00110">svm.h:110</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_af0c24755d59a0cfca7ce9ba64f682722"><div class="ttname"><a href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vcpu_svm::vmcb01</a></div><div class="ttdeci">struct kvm_vmcb_info vmcb01</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00212">svm.h:213</a></div></div>
<div class="ttc" id="asvm_8h_html_ab83edec724698a20d66a086a1900aa27"><div class="ttname"><a href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a></div><div class="ttdeci">static void vmcb_mark_dirty(struct vmcb *vmcb, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00354">svm.h:354</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a51356c24441683c197e1d4c2555da06d_cgraph.png" border="0" usemap="#asvm_8h_a51356c24441683c197e1d4c2555da06d_cgraph" alt=""/></div>
<map name="asvm_8h_a51356c24441683c197e1d4c2555da06d_cgraph" id="asvm_8h_a51356c24441683c197e1d4c2555da06d_cgraph">
<area shape="rect" title=" " alt="" coords="5,539,156,580"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="217,491,369,518"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1181,390,1252,417"/>
<area shape="rect" href="avic_8c.html#ae9f162404fdb37bba372d0c9cdc043ee" title=" " alt="" coords="431,244,597,285"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="209,546,377,573"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="204,597,383,623"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="455,651,573,678"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="225,698,361,725"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="1145,251,1288,278"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="435,484,593,525"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="655,513,813,539"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="889,564,1048,605"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="871,513,1067,539"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="1146,571,1287,598"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="1115,623,1319,664"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="1143,689,1290,715"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="1141,521,1292,547"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="1367,495,1540,522"/>
<area shape="rect" href="avic_8c.html#aaff9720871b696bc298d89cbb27a6dc2" title=" " alt="" coords="645,251,823,278"/>
<area shape="rect" href="avic_8c.html#a6a9ffca6bae1adce86d4495b5caaae2e" title=" " alt="" coords="646,193,822,219"/>
<area shape="rect" href="avic_8c.html#a2ed13621ec3f14afbf47f129e43b496d" title=" " alt="" coords="883,244,1054,285"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="1144,91,1289,118"/>
<area shape="rect" href="avic_8c.html#a5eaaa2d4a926c006359343ff29a9cdf7" title=" " alt="" coords="1143,164,1290,205"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="1400,171,1507,198"/>
<area shape="rect" href="lapic_8h.html#aa28a43e0f54449e2ec4d25e1f8ecb178" title=" " alt="" coords="1374,91,1533,118"/>
<area shape="rect" href="avic_8c.html#a2650b353757b538de17a1c843f7308d2" title=" " alt="" coords="912,91,1025,118"/>
<area shape="rect" href="lapic_8h.html#a4f07303d20a06eeb408d4985c5e15096" title=" " alt="" coords="913,41,1025,67"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="454,601,574,627"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="435,550,593,577"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a51356c24441683c197e1d4c2555da06d_icgraph.png" border="0" usemap="#asvm_8h_a51356c24441683c197e1d4c2555da06d_icgraph" alt=""/></div>
<map name="asvm_8h_a51356c24441683c197e1d4c2555da06d_icgraph" id="asvm_8h_a51356c24441683c197e1d4c2555da06d_icgraph">
<area shape="rect" title=" " alt="" coords="197,5,348,47"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="5,5,149,47"/>
</map>
</div>

</div>
</div>
<a id="ac8c9ded2546dccf6e4b561e633d22e7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8c9ded2546dccf6e4b561e633d22e7e">&#9670;&nbsp;</a></span>avic_ring_doorbell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void avic_ring_doorbell </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00321">321</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">     * Note, the vCPU could get migrated to a different pCPU at any point,</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">     * which could result in signalling the wrong/previous pCPU.  But if</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">     * that happens the vCPU is guaranteed to do a VMRUN (after being</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">     * migrated) and thus will process pending interrupts, i.e. a doorbell</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">     * is not needed (and the spurious one is harmless).</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">int</span> cpu = READ_ONCE(vcpu-&gt;cpu);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (cpu != get_cpu()) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        wrmsrl(MSR_AMD64_SVM_AVIC_DOORBELL, kvm_cpu_get_apicid(cpu));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        trace_kvm_avic_doorbell(vcpu-&gt;vcpu_id, kvm_cpu_get_apicid(cpu));</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    put_cpu();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ac8c9ded2546dccf6e4b561e633d22e7e_icgraph.png" border="0" usemap="#asvm_8h_ac8c9ded2546dccf6e4b561e633d22e7e_icgraph" alt=""/></div>
<map name="asvm_8h_ac8c9ded2546dccf6e4b561e633d22e7e_icgraph" id="asvm_8h_ac8c9ded2546dccf6e4b561e633d22e7e_icgraph">
<area shape="rect" title=" " alt="" coords="1659,38,1800,65"/>
<area shape="rect" href="svm_8c.html#a1faf261e116f9d9481e1bd6796e32280" title=" " alt="" coords="1429,31,1611,72"/>
<area shape="rect" href="avic_8c.html#a2b9e298755a0d51bb5b2dfc9dd254c64" title=" " alt="" coords="1238,13,1359,39"/>
<area shape="rect" href="svm_8c.html#a501d86bb28fd272f1ab52b8689b5f948" title=" " alt="" coords="1216,63,1381,90"/>
<area shape="rect" href="avic_8c.html#ad9345a779111a59de8fa4110106c3adf" title=" " alt="" coords="205,13,380,39"/>
<area shape="rect" href="avic_8c.html#a4b900d047f49b6cd00266aba3f4912bf" title=" " alt="" coords="944,38,1168,65"/>
<area shape="rect" href="avic_8c.html#a4a11c0014568405b90307ef68285e4ff" title=" " alt="" coords="5,5,157,47"/>
<area shape="rect" href="avic_8c.html#a7cf9fdcdf4f5f6559c099faaab0c2d29" title=" " alt="" coords="428,38,635,65"/>
<area shape="rect" href="avic_8c.html#a1404df5f813565dd104640a6e5bfea67" title=" " alt="" coords="683,89,896,115"/>
</map>
</div>

</div>
</div>
<a id="a299de3990a5ce5ce873df7afe2b3338f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299de3990a5ce5ce873df7afe2b3338f">&#9670;&nbsp;</a></span>avic_unaccelerated_access_interception()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int avic_unaccelerated_access_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00693">693</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;{</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    u32 offset = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1 &amp;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;             AVIC_UNACCEL_ACCESS_OFFSET_MASK;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    u32 vector = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2 &amp;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;             AVIC_UNACCEL_ACCESS_VECTOR_MASK;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordtype">bool</span> write = (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1 &gt;&gt; 32) &amp;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;             AVIC_UNACCEL_ACCESS_WRITE_MASK;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordtype">bool</span> trap = <a class="code" href="avic_8c.html#a9c7db7e1cb25acd53eb51e777934c9e8">is_avic_unaccelerated_access_trap</a>(offset);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    trace_kvm_avic_unaccelerated_access(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;vcpu_id, offset,</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                        trap, write, vector);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">if</span> (trap) {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="comment">/* Handling Trap */</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        WARN_ONCE(!write, <span class="stringliteral">&quot;svm: Handling trap read.\n&quot;</span>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        ret = <a class="code" href="avic_8c.html#abf44c96047cb51680ff358ad52747b93">avic_unaccel_trap_write</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="comment">/* Handling Fault */</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        ret = <a class="code" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646">kvm_emulate_instruction</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, 0);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a9c7db7e1cb25acd53eb51e777934c9e8"><div class="ttname"><a href="avic_8c.html#a9c7db7e1cb25acd53eb51e777934c9e8">is_avic_unaccelerated_access_trap</a></div><div class="ttdeci">static bool is_avic_unaccelerated_access_trap(u32 offset)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00664">avic.c:664</a></div></div>
<div class="ttc" id="aavic_8c_html_abf44c96047cb51680ff358ad52747b93"><div class="ttname"><a href="avic_8c.html#abf44c96047cb51680ff358ad52747b93">avic_unaccel_trap_write</a></div><div class="ttdeci">static int avic_unaccel_trap_write(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00641">avic.c:641</a></div></div>
<div class="ttc" id="ax86_8c_html_a117738c7e069e71d58ab48a581bfc646"><div class="ttname"><a href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646">kvm_emulate_instruction</a></div><div class="ttdeci">int kvm_emulate_instruction(struct kvm_vcpu *vcpu, int emulation_type)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09262">x86.c:9262</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a299de3990a5ce5ce873df7afe2b3338f_cgraph.png" border="0" usemap="#asvm_8h_a299de3990a5ce5ce873df7afe2b3338f_cgraph" alt=""/></div>
<map name="asvm_8h_a299de3990a5ce5ce873df7afe2b3338f_cgraph" id="asvm_8h_a299de3990a5ce5ce873df7afe2b3338f_cgraph">
<area shape="rect" title=" " alt="" coords="5,955,164,997"/>
<area shape="rect" href="avic_8c.html#abf44c96047cb51680ff358ad52747b93" title=" " alt="" coords="217,781,395,808"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1007,832,1078,859"/>
<area shape="rect" href="avic_8c.html#a9c7db7e1cb25acd53eb51e777934c9e8" title=" " alt="" coords="223,985,389,1026"/>
<area shape="rect" href="x86_8c.html#a117738c7e069e71d58ab48a581bfc646" title=" " alt="" coords="212,1320,400,1347"/>
<area shape="rect" href="avic_8c.html#aaff9720871b696bc298d89cbb27a6dc2" title=" " alt="" coords="457,781,634,808"/>
<area shape="rect" href="avic_8c.html#a6a9ffca6bae1adce86d4495b5caaae2e" title=" " alt="" coords="457,613,633,640"/>
<area shape="rect" href="lapic_8c.html#a1b33bb5758d3dd75c7b87e537a5e729e" title=" " alt="" coords="448,335,643,361"/>
<area shape="rect" href="avic_8c.html#a2ed13621ec3f14afbf47f129e43b496d" title=" " alt="" coords="705,665,875,706"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="1203,512,1349,539"/>
<area shape="rect" href="lapic_8h.html#a07d3e1e4090a62753325dfa11d232cea" title=" " alt="" coords="971,512,1114,539"/>
<area shape="rect" href="avic_8c.html#a5eaaa2d4a926c006359343ff29a9cdf7" title=" " alt="" coords="969,665,1116,706"/>
<area shape="rect" href="lapic_8h.html#aa28a43e0f54449e2ec4d25e1f8ecb178" title=" " alt="" coords="1404,512,1563,539"/>
<area shape="rect" href="avic_8c.html#a2650b353757b538de17a1c843f7308d2" title=" " alt="" coords="733,613,847,640"/>
<area shape="rect" href="lapic_8h.html#a4f07303d20a06eeb408d4985c5e15096" title=" " alt="" coords="734,461,846,488"/>
<area shape="rect" href="lapic_8c.html#a378a0961283ea67791303e70114fb10d" title=" " alt="" coords="709,107,871,133"/>
<area shape="rect" href="lapic_8c.html#acebc0ffd4530dfd1beb1254d1e4d9491" title=" " alt="" coords="711,259,869,285"/>
<area shape="rect" href="lapic_8c.html#adf2487dc76dace6e577b637cc357998b" title=" " alt="" coords="708,360,872,387"/>
<area shape="rect" href="lapic_8c.html#aa06cb4ebbfa40dbfa494b3b4cd9f8833" title=" " alt="" coords="955,5,1130,32"/>
<area shape="rect" href="lapic_8c.html#adaceffbfc91320b193a66d974fb12ce0" title=" " alt="" coords="1196,208,1356,235"/>
<area shape="rect" href="lapic_8c.html#afefd171448cafa66f80ecb9b9659ebb1" title=" " alt="" coords="937,309,1148,336"/>
<area shape="rect" href="lapic_8c.html#af5602fb092ac09abc6c2bf0ad789d726" title=" " alt="" coords="991,360,1094,387"/>
<area shape="rect" href="lapic_8c.html#aeb32a868e76d57da9fab57fce43efdbe" title=" " alt="" coords="987,157,1098,184"/>
<area shape="rect" href="lapic_8c.html#a02bd03bf711be3200ea2316ced434ff1" title=" " alt="" coords="992,208,1093,235"/>
<area shape="rect" href="lapic_8c.html#ac7a03b55710bfcc78be7af0609f6f93d" title=" " alt="" coords="977,107,1108,133"/>
<area shape="rect" href="lapic_8c.html#a8aa5f66b440e07d680f42fdaa211eac2" title=" " alt="" coords="1206,81,1346,108"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="454,1564,637,1591"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="975,1152,1110,1179"/>
<area shape="rect" href="x86_8c.html#a3989782ad88b95fba558bd550288d551" title=" " alt="" coords="691,1859,889,1885"/>
<area shape="rect" href="x86_8c.html#a82999d0b499027dbcf226f164016c023" title=" " alt="" coords="701,1909,879,1936"/>
<area shape="rect" href="emulate_8c.html#a8e6c168c4d0660ef944366d6dd83c506" title=" " alt="" coords="713,1961,867,2002"/>
<area shape="rect" href="x86_8c.html#a673435288bc64cc9ddadb6b25c95693e" title=" " alt="" coords="729,2027,851,2053"/>
<area shape="rect" href="x86_8c.html#aa8815dc77b29b1054a9edc849d14a3b0" title=" " alt="" coords="696,2128,884,2155"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="958,2128,1127,2155"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="951,2077,1135,2104"/>
<area shape="rect" href="x86_8c.html#a031a116c2f53928292fd79cb4405352e" title=" " alt="" coords="691,2077,889,2104"/>
<area shape="rect" href="x86_8c.html#a83c65667726e87db38b0379e6de27a29" title=" " alt="" coords="710,1035,870,1077"/>
<area shape="rect" href="x86_8c.html#a5cf5556013d24428137ff2113e368db5" title=" " alt="" coords="695,1101,885,1128"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="709,1153,871,1194"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="699,1219,881,1245"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="733,1269,847,1296"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="729,984,851,1011"/>
<area shape="rect" href="x86_8c.html#a95270b039fad8dd0663cbee58f3d1cf4" title=" " alt="" coords="704,1371,876,1413"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="697,1437,883,1464"/>
<area shape="rect" href="x86_8c.html#a5559cadc9496d9f62e002e88144d5156" title=" " alt="" coords="709,1488,871,1515"/>
<area shape="rect" href="x86_8c.html#a5969d2c2ff863d86dbdd90088da52139" title=" " alt="" coords="725,1539,855,1565"/>
<area shape="rect" href="x86_8c.html#a32d57f7752f511acb821a12625ff8455" title=" " alt="" coords="709,1589,871,1616"/>
<area shape="rect" href="emulate_8c.html#a4a1d9ea50bedcf56a5ba5ca9f6e90c6a" title=" " alt="" coords="999,1699,1086,1725"/>
<area shape="rect" href="x86_8c.html#a1d439c08a5848010284827827cfcbf76" title=" " alt="" coords="705,1691,875,1733"/>
<area shape="rect" href="emulate_8c.html#a01cc7d1fe9a09ddc0941fe01271556af" title=" " alt="" coords="719,1640,861,1667"/>
</map>
</div>

</div>
</div>
<a id="a056e12caaf24f044fce8545a863dbbce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a056e12caaf24f044fce8545a863dbbce">&#9670;&nbsp;</a></span>avic_vcpu_blocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void avic_vcpu_blocking </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l01153">1153</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;{</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(vcpu))</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;       <span class="comment">/*</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">        * Unload the AVIC when the vCPU is about to block, _before_</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">        * the vCPU actually blocks.</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">        *</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">        * Any IRQs that arrive before IsRunning=0 will not cause an</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">        * incomplete IPI vmexit on the source, therefore vIRR will also</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">        * be checked by kvm_vcpu_check_block() before blocking.  The</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">        * memory barrier implicit in set_current_state orders writing</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">        * IsRunning=0 before reading the vIRR.  The processor needs a</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">        * matching memory barrier on interrupt delivery between writing</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">        * IRR and reading IsRunning; the lack of this barrier might be</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">        * the cause of errata #1235).</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <a class="code" href="avic_8c.html#a461f968598a11484e76a07fb87221bf2">avic_vcpu_put</a>(vcpu);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a056e12caaf24f044fce8545a863dbbce_cgraph.png" border="0" usemap="#asvm_8h_a056e12caaf24f044fce8545a863dbbce_cgraph" alt=""/></div>
<map name="asvm_8h_a056e12caaf24f044fce8545a863dbbce_cgraph" id="asvm_8h_a056e12caaf24f044fce8545a863dbbce_cgraph">
<area shape="rect" title=" " alt="" coords="5,97,155,123"/>
<area shape="rect" href="avic_8c.html#a461f968598a11484e76a07fb87221bf2" title=" " alt="" coords="235,71,349,98"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="203,122,381,149"/>
<area shape="rect" href="avic_8c.html#a7b088623e16cec4875e37d8ce15231b2" title=" " alt="" coords="429,5,621,47"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="725,71,795,98"/>
<area shape="rect" href="x86_8c.html#ae63567e9b665b34f8c84fc4dc594f3c8" title=" " alt="" coords="669,5,851,47"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="466,122,585,149"/>
</map>
</div>

</div>
</div>
<a id="aed65a2dabdad6a421b487e1e7b106277"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed65a2dabdad6a421b487e1e7b106277">&#9670;&nbsp;</a></span>avic_vcpu_get_apicv_inhibit_reasons()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long avic_vcpu_get_apicv_inhibit_reasons </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00542">542</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;{</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(vcpu))</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">return</span> APICV_INHIBIT_REASON_NESTED;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div>
<div class="ttc" id="akvm__cache__regs_8h_html_afbcfc413ceedb460734eb5fd7c5c4fbc"><div class="ttname"><a href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a></div><div class="ttdeci">static bool is_guest_mode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00226">kvm_cache_regs.h:226</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aed65a2dabdad6a421b487e1e7b106277_cgraph.png" border="0" usemap="#asvm_8h_aed65a2dabdad6a421b487e1e7b106277_cgraph" alt=""/></div>
<map name="asvm_8h_aed65a2dabdad6a421b487e1e7b106277_cgraph" id="asvm_8h_aed65a2dabdad6a421b487e1e7b106277_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,163,47"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="211,13,331,39"/>
</map>
</div>

</div>
</div>
<a id="a7decdbafc7d47b2241e68ce3c90a9779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7decdbafc7d47b2241e68ce3c90a9779">&#9670;&nbsp;</a></span>avic_vcpu_load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void avic_vcpu_load </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cpu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l01028">1028</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;{</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    u64 entry;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordtype">int</span> h_physical_id = kvm_cpu_get_apicid(cpu);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    lockdep_assert_preemption_disabled();</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">if</span> (WARN_ON(h_physical_id &amp; ~AVIC_PHYSICAL_ID_ENTRY_HOST_PHYSICAL_ID_MASK))</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">     * No need to update anything if the vCPU is blocking, i.e. if the vCPU</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">     * is being scheduled in after being preempted.  The CPU entries in the</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">     * Physical APIC table and IRTE are consumed iff IsRun{ning} is &#39;1&#39;.</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">     * If the vCPU was migrated, its new CPU value will be stuffed when the</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">     * vCPU unblocks.</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">if</span> (kvm_vcpu_is_blocking(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">     * Grab the per-vCPU interrupt remapping lock even if the VM doesn&#39;t</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">     * _currently_ have assigned devices, as that can change.  Holding</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">     * ir_list_lock ensures that either svm_ir_list_add() will consume</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">     * up-to-date entry information, or that this task will wait until</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">     * svm_ir_list_add() completes to set the new target pCPU.</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    spin_lock_irqsave(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af38f3c63a81a10aae69b308aa175d618">ir_list_lock</a>, <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    entry = READ_ONCE(*(svm-&gt;<a class="code" href="structvcpu__svm.html#abc377a3a5f1f42e18f8a9044321f3d5b">avic_physical_id_cache</a>));</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    WARN_ON_ONCE(entry &amp; AVIC_PHYSICAL_ID_ENTRY_IS_RUNNING_MASK);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    entry &amp;= ~AVIC_PHYSICAL_ID_ENTRY_HOST_PHYSICAL_ID_MASK;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    entry |= (h_physical_id &amp; AVIC_PHYSICAL_ID_ENTRY_HOST_PHYSICAL_ID_MASK);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    entry |= AVIC_PHYSICAL_ID_ENTRY_IS_RUNNING_MASK;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    WRITE_ONCE(*(svm-&gt;<a class="code" href="structvcpu__svm.html#abc377a3a5f1f42e18f8a9044321f3d5b">avic_physical_id_cache</a>), entry);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <a class="code" href="avic_8c.html#a7b088623e16cec4875e37d8ce15231b2">avic_update_iommu_vcpu_affinity</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, h_physical_id, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    spin_unlock_irqrestore(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af38f3c63a81a10aae69b308aa175d618">ir_list_lock</a>, <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a7b088623e16cec4875e37d8ce15231b2"><div class="ttname"><a href="avic_8c.html#a7b088623e16cec4875e37d8ce15231b2">avic_update_iommu_vcpu_affinity</a></div><div class="ttdeci">static int avic_update_iommu_vcpu_affinity(struct kvm_vcpu *vcpu, int cpu, bool r)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l01002">avic.c:1002</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_abc377a3a5f1f42e18f8a9044321f3d5b"><div class="ttname"><a href="structvcpu__svm.html#abc377a3a5f1f42e18f8a9044321f3d5b">vcpu_svm::avic_physical_id_cache</a></div><div class="ttdeci">u64 * avic_physical_id_cache</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00270">svm.h:270</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a7decdbafc7d47b2241e68ce3c90a9779_cgraph.png" border="0" usemap="#asvm_8h_a7decdbafc7d47b2241e68ce3c90a9779_cgraph" alt=""/></div>
<map name="asvm_8h_a7decdbafc7d47b2241e68ce3c90a9779_cgraph" id="asvm_8h_a7decdbafc7d47b2241e68ce3c90a9779_cgraph">
<area shape="rect" title=" " alt="" coords="5,42,128,69"/>
<area shape="rect" href="avic_8c.html#a7b088623e16cec4875e37d8ce15231b2" title=" " alt="" coords="176,5,368,47"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="471,71,542,98"/>
<area shape="rect" href="x86_8c.html#ae63567e9b665b34f8c84fc4dc594f3c8" title=" " alt="" coords="416,5,597,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a7decdbafc7d47b2241e68ce3c90a9779_icgraph.png" border="0" usemap="#asvm_8h_a7decdbafc7d47b2241e68ce3c90a9779_icgraph" alt=""/></div>
<map name="asvm_8h_a7decdbafc7d47b2241e68ce3c90a9779_icgraph" id="asvm_8h_a7decdbafc7d47b2241e68ce3c90a9779_icgraph">
<area shape="rect" title=" " alt="" coords="219,71,341,98"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="16,5,160,47"/>
<area shape="rect" href="avic_8c.html#a7e341d7f17b2f611aca180217cfc6ad3" title=" " alt="" coords="5,71,171,98"/>
<area shape="rect" href="svm_8c.html#ab9e5b464a654de732fe7b0ce81145897" title=" " alt="" coords="27,122,149,149"/>
</map>
</div>

</div>
</div>
<a id="a461f968598a11484e76a07fb87221bf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a461f968598a11484e76a07fb87221bf2">&#9670;&nbsp;</a></span>avic_vcpu_put()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void avic_vcpu_put </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l01072">1072</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;{</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    u64 entry;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    lockdep_assert_preemption_disabled();</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">     * Note, reading the Physical ID entry outside of ir_list_lock is safe</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">     * as only the pCPU that has loaded (or is loading) the vCPU is allowed</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">     * to modify the entry, and preemption is disabled.  I.e. the vCPU</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">     * can&#39;t be scheduled out and thus avic_vcpu_{put,load}() can&#39;t run</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">     * recursively.</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    entry = READ_ONCE(*(svm-&gt;<a class="code" href="structvcpu__svm.html#abc377a3a5f1f42e18f8a9044321f3d5b">avic_physical_id_cache</a>));</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="comment">/* Nothing to do if IsRunning == &#39;0&#39; due to vCPU blocking. */</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">if</span> (!(entry &amp; AVIC_PHYSICAL_ID_ENTRY_IS_RUNNING_MASK))</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">     * Take and hold the per-vCPU interrupt remapping lock while updating</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">     * the Physical ID entry even though the lock doesn&#39;t protect against</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">     * multiple writers (see above).  Holding ir_list_lock ensures that</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">     * either svm_ir_list_add() will consume up-to-date entry information,</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">     * or that this task will wait until svm_ir_list_add() completes to</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">     * mark the vCPU as not running.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    spin_lock_irqsave(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af38f3c63a81a10aae69b308aa175d618">ir_list_lock</a>, <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <a class="code" href="avic_8c.html#a7b088623e16cec4875e37d8ce15231b2">avic_update_iommu_vcpu_affinity</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, -1, 0);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    entry &amp;= ~AVIC_PHYSICAL_ID_ENTRY_IS_RUNNING_MASK;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    WRITE_ONCE(*(svm-&gt;<a class="code" href="structvcpu__svm.html#abc377a3a5f1f42e18f8a9044321f3d5b">avic_physical_id_cache</a>), entry);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    spin_unlock_irqrestore(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af38f3c63a81a10aae69b308aa175d618">ir_list_lock</a>, <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a461f968598a11484e76a07fb87221bf2_cgraph.png" border="0" usemap="#asvm_8h_a461f968598a11484e76a07fb87221bf2_cgraph" alt=""/></div>
<map name="asvm_8h_a461f968598a11484e76a07fb87221bf2_cgraph" id="asvm_8h_a461f968598a11484e76a07fb87221bf2_cgraph">
<area shape="rect" title=" " alt="" coords="5,42,120,69"/>
<area shape="rect" href="avic_8c.html#a7b088623e16cec4875e37d8ce15231b2" title=" " alt="" coords="168,5,360,47"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="463,71,534,98"/>
<area shape="rect" href="x86_8c.html#ae63567e9b665b34f8c84fc4dc594f3c8" title=" " alt="" coords="408,5,589,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a461f968598a11484e76a07fb87221bf2_icgraph.png" border="0" usemap="#asvm_8h_a461f968598a11484e76a07fb87221bf2_icgraph" alt=""/></div>
<map name="asvm_8h_a461f968598a11484e76a07fb87221bf2_icgraph" id="asvm_8h_a461f968598a11484e76a07fb87221bf2_icgraph">
<area shape="rect" title=" " alt="" coords="203,71,317,98"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="8,5,152,47"/>
<area shape="rect" href="avic_8c.html#a056e12caaf24f044fce8545a863dbbce" title=" " alt="" coords="5,71,155,98"/>
<area shape="rect" href="svm_8c.html#af102e65fa4a28844d0bd7bbb75bd4565" title=" " alt="" coords="22,122,138,149"/>
</map>
</div>

</div>
</div>
<a id="a7e341d7f17b2f611aca180217cfc6ad3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e341d7f17b2f611aca180217cfc6ad3">&#9670;&nbsp;</a></span>avic_vcpu_unblocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void avic_vcpu_unblocking </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l01174">1174</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;{</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(vcpu))</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <a class="code" href="avic_8c.html#a7decdbafc7d47b2241e68ce3c90a9779">avic_vcpu_load</a>(vcpu, vcpu-&gt;cpu);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a7e341d7f17b2f611aca180217cfc6ad3_cgraph.png" border="0" usemap="#asvm_8h_a7e341d7f17b2f611aca180217cfc6ad3_cgraph" alt=""/></div>
<map name="asvm_8h_a7e341d7f17b2f611aca180217cfc6ad3_cgraph" id="asvm_8h_a7e341d7f17b2f611aca180217cfc6ad3_cgraph">
<area shape="rect" title=" " alt="" coords="5,97,171,123"/>
<area shape="rect" href="avic_8c.html#a7decdbafc7d47b2241e68ce3c90a9779" title=" " alt="" coords="247,71,369,98"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="219,122,397,149"/>
<area shape="rect" href="avic_8c.html#a7b088623e16cec4875e37d8ce15231b2" title=" " alt="" coords="445,5,637,47"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="741,71,811,98"/>
<area shape="rect" href="x86_8c.html#ae63567e9b665b34f8c84fc4dc594f3c8" title=" " alt="" coords="685,5,867,47"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="482,122,601,149"/>
</map>
</div>

</div>
</div>
<a id="a3bb736e8688ecfaa3696b347764fd37d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bb736e8688ecfaa3696b347764fd37d">&#9670;&nbsp;</a></span>avic_vm_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void avic_vm_destroy </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00174">174</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;{</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__svm.html">kvm_svm</a> *<a class="code" href="structkvm__svm.html">kvm_svm</a> = <a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(<a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a04af9ab3eee510b54cba17a6fa94ee04">enable_apicv</a>)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#a837dca12e3d1d7b768feb04c6a3c2e96">avic_logical_id_table_page</a>)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        __free_page(<a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#a837dca12e3d1d7b768feb04c6a3c2e96">avic_logical_id_table_page</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#aa05522988cc0a3ce6ad59dcec1ed0c46">avic_physical_id_table_page</a>)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        __free_page(<a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#aa05522988cc0a3ce6ad59dcec1ed0c46">avic_physical_id_table_page</a>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    spin_lock_irqsave(&amp;svm_vm_data_hash_lock, <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    hash_del(&amp;<a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#a4f8eab5b98a43c0a7402d15663d4e032">hnode</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    spin_unlock_irqrestore(&amp;svm_vm_data_hash_lock, <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
<div class="ttc" id="astructkvm__svm_html_a4f8eab5b98a43c0a7402d15663d4e032"><div class="ttname"><a href="structkvm__svm.html#a4f8eab5b98a43c0a7402d15663d4e032">kvm_svm::hnode</a></div><div class="ttdeci">struct hlist_node hnode</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00101">svm.h:102</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a3bb736e8688ecfaa3696b347764fd37d_cgraph.png" border="0" usemap="#asvm_8h_a3bb736e8688ecfaa3696b347764fd37d_cgraph" alt=""/></div>
<map name="asvm_8h_a3bb736e8688ecfaa3696b347764fd37d_cgraph" id="asvm_8h_a3bb736e8688ecfaa3696b347764fd37d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,139,32"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="187,5,293,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a3bb736e8688ecfaa3696b347764fd37d_icgraph.png" border="0" usemap="#asvm_8h_a3bb736e8688ecfaa3696b347764fd37d_icgraph" alt=""/></div>
<map name="asvm_8h_a3bb736e8688ecfaa3696b347764fd37d_icgraph" id="asvm_8h_a3bb736e8688ecfaa3696b347764fd37d_icgraph">
<area shape="rect" title=" " alt="" coords="188,31,321,57"/>
<area shape="rect" href="avic_8c.html#a0ddedac4b0b428928fae6bc9fe902e2a" title=" " alt="" coords="20,5,125,32"/>
<area shape="rect" href="svm_8c.html#a0e69cefce46e7b11e1e8e056ea5b6561" title=" " alt="" coords="5,56,140,83"/>
</map>
</div>

</div>
</div>
<a id="a0ddedac4b0b428928fae6bc9fe902e2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddedac4b0b428928fae6bc9fe902e2a">&#9670;&nbsp;</a></span>avic_vm_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int avic_vm_init </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00192">192</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">int</span> err = -ENOMEM;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__svm.html">kvm_svm</a> *<a class="code" href="structkvm__svm.html">kvm_svm</a> = <a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(<a class="code" href="structkvm__svm.html#ade6c6ec6e820a10719c5d61e161aa8b8">kvm</a>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__svm.html">kvm_svm</a> *k2;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">struct </span>page *p_page;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">struct </span>page *l_page;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    u32 vm_id;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a04af9ab3eee510b54cba17a6fa94ee04">enable_apicv</a>)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">/* Allocating physical APIC ID table (4KB) */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    p_page = alloc_page(GFP_KERNEL_ACCOUNT | __GFP_ZERO);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (!p_page)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">goto</span> free_avic;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#aa05522988cc0a3ce6ad59dcec1ed0c46">avic_physical_id_table_page</a> = p_page;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">/* Allocating logical APIC ID table (4KB) */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    l_page = alloc_page(GFP_KERNEL_ACCOUNT | __GFP_ZERO);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (!l_page)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">goto</span> free_avic;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#a837dca12e3d1d7b768feb04c6a3c2e96">avic_logical_id_table_page</a> = l_page;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    spin_lock_irqsave(&amp;svm_vm_data_hash_lock, <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; again:</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    vm_id = <a class="code" href="avic_8c.html#aebb4737cca7862427a4b94f3f086dee3">next_vm_id</a> = (<a class="code" href="avic_8c.html#aebb4737cca7862427a4b94f3f086dee3">next_vm_id</a> + 1) &amp; <a class="code" href="avic_8c.html#aa582eb517550b4af588363963042a791">AVIC_VM_ID_MASK</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (vm_id == 0) { <span class="comment">/* id is 1-based, zero is not okay */</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="avic_8c.html#a1e123c3defad20a133e56f43373b9c44">next_vm_id_wrapped</a> = 1;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">goto</span> again;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">/* Is it still in use? Only possible if wrapped at least once */</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="avic_8c.html#a1e123c3defad20a133e56f43373b9c44">next_vm_id_wrapped</a>) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        hash_for_each_possible(svm_vm_data_hash, k2, hnode, vm_id) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordflow">if</span> (k2-&gt;<a class="code" href="structkvm__svm.html#a06c4479d5aefb8c19b8ead15d599b324">avic_vm_id</a> == vm_id)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="keywordflow">goto</span> again;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#a06c4479d5aefb8c19b8ead15d599b324">avic_vm_id</a> = vm_id;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    hash_add(svm_vm_data_hash, &amp;<a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#a4f8eab5b98a43c0a7402d15663d4e032">hnode</a>, <a class="code" href="structkvm__svm.html">kvm_svm</a>-&gt;<a class="code" href="structkvm__svm.html#a06c4479d5aefb8c19b8ead15d599b324">avic_vm_id</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    spin_unlock_irqrestore(&amp;svm_vm_data_hash_lock, <a class="code" href="xen_8c.html#a773b39d480759f67926cb18ae2219281">flags</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;free_avic:</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="avic_8c.html#a3bb736e8688ecfaa3696b347764fd37d">avic_vm_destroy</a>(kvm);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_a1e123c3defad20a133e56f43373b9c44"><div class="ttname"><a href="avic_8c.html#a1e123c3defad20a133e56f43373b9c44">next_vm_id_wrapped</a></div><div class="ttdeci">static bool next_vm_id_wrapped</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00073">avic.c:73</a></div></div>
<div class="ttc" id="aavic_8c_html_a3bb736e8688ecfaa3696b347764fd37d"><div class="ttname"><a href="avic_8c.html#a3bb736e8688ecfaa3696b347764fd37d">avic_vm_destroy</a></div><div class="ttdeci">void avic_vm_destroy(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00174">avic.c:174</a></div></div>
<div class="ttc" id="aavic_8c_html_aa582eb517550b4af588363963042a791"><div class="ttname"><a href="avic_8c.html#aa582eb517550b4af588363963042a791">AVIC_VM_ID_MASK</a></div><div class="ttdeci">#define AVIC_VM_ID_MASK</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00044">avic.c:44</a></div></div>
<div class="ttc" id="aavic_8c_html_aebb4737cca7862427a4b94f3f086dee3"><div class="ttname"><a href="avic_8c.html#aebb4737cca7862427a4b94f3f086dee3">next_vm_id</a></div><div class="ttdeci">static u32 next_vm_id</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00072">avic.c:72</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a0ddedac4b0b428928fae6bc9fe902e2a_cgraph.png" border="0" usemap="#asvm_8h_a0ddedac4b0b428928fae6bc9fe902e2a_cgraph" alt=""/></div>
<map name="asvm_8h_a0ddedac4b0b428928fae6bc9fe902e2a_cgraph" id="asvm_8h_a0ddedac4b0b428928fae6bc9fe902e2a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,111,57"/>
<area shape="rect" href="avic_8c.html#a3bb736e8688ecfaa3696b347764fd37d" title=" " alt="" coords="159,5,292,32"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="340,31,447,57"/>
</map>
</div>

</div>
</div>
<a id="a0e9d1e1a7652ad926236f0f44891293c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e9d1e1a7652ad926236f0f44891293c">&#9670;&nbsp;</a></span>clr_exception_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void clr_exception_intercept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00413">413</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;{</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    WARN_ON_ONCE(bit &gt;= 32);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_EXCEPTION_OFFSET + bit);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(svm);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a83e4cd1b591935133506abf6724051c4"><div class="ttname"><a href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a></div><div class="ttdeci">static void vmcb_clr_intercept(struct vmcb_control_area *control, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00385">svm.h:385</a></div></div>
<div class="ttc" id="asvm_8h_html_adb2a01596415bf77bd9a3f22ff165a14"><div class="ttname"><a href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a></div><div class="ttdeci">void recalc_intercepts(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00122">nested.c:122</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a0e9d1e1a7652ad926236f0f44891293c_cgraph.png" border="0" usemap="#asvm_8h_a0e9d1e1a7652ad926236f0f44891293c_cgraph" alt=""/></div>
<map name="asvm_8h_a0e9d1e1a7652ad926236f0f44891293c_cgraph" id="asvm_8h_a0e9d1e1a7652ad926236f0f44891293c_cgraph">
<area shape="rect" title=" " alt="" coords="5,239,180,265"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="228,188,361,215"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="427,289,574,316"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="441,5,561,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="409,57,592,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="410,122,591,163"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="433,188,569,215"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="425,239,576,265"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="657,104,776,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="640,155,793,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1080,97,1253,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="841,129,1032,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a0e9d1e1a7652ad926236f0f44891293c_icgraph.png" border="0" usemap="#asvm_8h_a0e9d1e1a7652ad926236f0f44891293c_icgraph" alt=""/></div>
<map name="asvm_8h_a0e9d1e1a7652ad926236f0f44891293c_icgraph" id="asvm_8h_a0e9d1e1a7652ad926236f0f44891293c_icgraph">
<area shape="rect" title=" " alt="" coords="2237,107,2412,133"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1615,5,1701,32"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="2033,107,2172,133"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="1833,56,1949,83"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2047,195,2158,221"/>
<area shape="rect" href="svm_8c.html#aeb01a3f5d5204374edbbdb185d87ffcd" title=" " alt="" coords="2016,246,2189,287"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1318,5,1446,32"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="1587,56,1729,83"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1261,56,1503,83"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1813,231,1968,257"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,559,1213,585"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1562,361,1754,388"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1551,158,1765,199"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1556,456,1760,483"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,273,719,300"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1555,107,1761,133"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1567,223,1749,265"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1305,375,1459,417"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1302,441,1462,468"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1315,324,1449,351"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,383,1163,409"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,383,939,409"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1283,208,1481,235"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1297,493,1467,534"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,493,1195,534"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,525,945,552"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,475,940,501"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,208,520,235"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,183,323,209"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,183,128,209"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1293,157,1471,184"/>
</map>
</div>

</div>
</div>
<a id="a7c74743aeff41a938e6e8d1018bf871c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c74743aeff41a938e6e8d1018bf871c">&#9670;&nbsp;</a></span>DECLARE_PER_CPU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DECLARE_PER_CPU </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structsvm__cpu__data.html">svm_cpu_data</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">svm_data&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a711d42f525aa791008754514284a556c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a711d42f525aa791008754514284a556c">&#9670;&nbsp;</a></span>disable_gif()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void disable_gif </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00473">473</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;{</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = <a class="code" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">get_vgif_vmcb</a>(svm);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (vmcb)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        vmcb-&gt;control.int_ctl &amp;= ~V_GIF_MASK;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a850f432012717e5e5be4064ae8f340ac">guest_gif</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_a850f432012717e5e5be4064ae8f340ac"><div class="ttname"><a href="structvcpu__svm.html#a850f432012717e5e5be4064ae8f340ac">vcpu_svm::guest_gif</a></div><div class="ttdeci">bool guest_gif</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00294">svm.h:294</a></div></div>
<div class="ttc" id="asvm_8h_html_a69e061ab353251d82ff01f587be58c96"><div class="ttname"><a href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">get_vgif_vmcb</a></div><div class="ttdeci">static struct vmcb * get_vgif_vmcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00452">svm.h:452</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a711d42f525aa791008754514284a556c_cgraph.png" border="0" usemap="#asvm_8h_a711d42f525aa791008754514284a556c_cgraph" alt=""/></div>
<map name="asvm_8h_a711d42f525aa791008754514284a556c_cgraph" id="asvm_8h_a711d42f525aa791008754514284a556c_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,99,57"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="147,31,265,57"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="332,5,452,32"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="313,56,471,83"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="519,56,637,83"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="924,49,1097,90"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="685,81,876,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a711d42f525aa791008754514284a556c_icgraph.png" border="0" usemap="#asvm_8h_a711d42f525aa791008754514284a556c_icgraph" alt=""/></div>
<map name="asvm_8h_a711d42f525aa791008754514284a556c_icgraph" id="asvm_8h_a711d42f525aa791008754514284a556c_icgraph">
<area shape="rect" title=" " alt="" coords="2328,256,2421,283"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="2179,256,2280,283"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="2000,5,2131,32"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,107,945,133"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,281,1919,308"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,597,940,624"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="2000,652,2131,679"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2010,231,2121,257"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,157,719,184"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,197,520,224"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,237,323,264"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,237,128,264"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,463,1673,489"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,274,1684,315"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,391,1679,417"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,340,1679,367"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,209,1668,250"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,535,1399,577"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,484,1403,511"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,433,1389,460"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,543,1144,569"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,543,939,569"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,215,1421,241"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,367,1408,409"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,367,1176,409"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,265,1412,292"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,169,1952,196"/>
</map>
</div>

</div>
</div>
<a id="a7ff4c846a46f6bb2e429d79bbc18f052"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ff4c846a46f6bb2e429d79bbc18f052">&#9670;&nbsp;</a></span>disable_nmi_singlestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void disable_nmi_singlestep </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01054">1054</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;{</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">nmi_singlestep</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">if</span> (!(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.guest_debug &amp; KVM_GUESTDBG_SINGLESTEP)) {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="comment">/* Clear our flags if they were not set by the guest */</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordflow">if</span> (!(svm-&gt;<a class="code" href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">nmi_singlestep_guest_rflags</a> &amp; X86_EFLAGS_TF))</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rflags &amp;= ~X86_EFLAGS_TF;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">if</span> (!(svm-&gt;<a class="code" href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">nmi_singlestep_guest_rflags</a> &amp; X86_EFLAGS_RF))</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rflags &amp;= ~X86_EFLAGS_RF;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    }</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_a0e952848b035cc09ad04859f6363acbf"><div class="ttname"><a href="structvcpu__svm.html#a0e952848b035cc09ad04859f6363acbf">vcpu_svm::nmi_singlestep</a></div><div class="ttdeci">bool nmi_singlestep</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00257">svm.h:257</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a87127740a2a7ad640bd9bbbdd594d7e9"><div class="ttname"><a href="structvcpu__svm.html#a87127740a2a7ad640bd9bbbdd594d7e9">vcpu_svm::nmi_singlestep_guest_rflags</a></div><div class="ttdeci">u64 nmi_singlestep_guest_rflags</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00258">svm.h:258</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a7ff4c846a46f6bb2e429d79bbc18f052_icgraph.png" border="0" usemap="#asvm_8h_a7ff4c846a46f6bb2e429d79bbc18f052_icgraph" alt=""/></div>
<map name="asvm_8h_a7ff4c846a46f6bb2e429d79bbc18f052_icgraph" id="asvm_8h_a7ff4c846a46f6bb2e429d79bbc18f052_icgraph">
<area shape="rect" title=" " alt="" coords="176,31,351,57"/>
<area shape="rect" href="svm_8c.html#ae58d4aefe6338d19f8c4c62b4e7e96e8" title=" " alt="" coords="5,5,128,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="9,56,125,83"/>
</map>
</div>

</div>
</div>
<a id="ad0ea8a68927599c2120f37f4f48b0a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0ea8a68927599c2120f37f4f48b0a64">&#9670;&nbsp;</a></span>enable_gif()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void enable_gif </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00463">463</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;{</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = <a class="code" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">get_vgif_vmcb</a>(svm);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">if</span> (vmcb)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        vmcb-&gt;control.int_ctl |= V_GIF_MASK;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a850f432012717e5e5be4064ae8f340ac">guest_gif</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad0ea8a68927599c2120f37f4f48b0a64_cgraph.png" border="0" usemap="#asvm_8h_ad0ea8a68927599c2120f37f4f48b0a64_cgraph" alt=""/></div>
<map name="asvm_8h_ad0ea8a68927599c2120f37f4f48b0a64_cgraph" id="asvm_8h_ad0ea8a68927599c2120f37f4f48b0a64_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,96,57"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="144,31,263,57"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="329,5,449,32"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="311,56,468,83"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="516,56,635,83"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="921,49,1095,90"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="683,81,873,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad0ea8a68927599c2120f37f4f48b0a64_icgraph.png" border="0" usemap="#asvm_8h_ad0ea8a68927599c2120f37f4f48b0a64_icgraph" alt=""/></div>
<map name="asvm_8h_ad0ea8a68927599c2120f37f4f48b0a64_icgraph" id="asvm_8h_ad0ea8a68927599c2120f37f4f48b0a64_icgraph">
<area shape="rect" title=" " alt="" coords="2328,132,2419,159"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="2186,56,2273,83"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="2179,157,2280,184"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="2001,5,2129,32"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="2000,107,2131,133"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,208,945,235"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,349,1919,376"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,376,940,403"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="2000,56,2131,83"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2010,208,2121,235"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,259,719,285"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,355,520,381"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,452,323,479"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,452,128,479"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,376,1673,403"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,510,1684,551"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,321,1679,348"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,585,1679,612"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,427,1668,469"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,478,1399,519"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,376,1403,403"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,427,1389,453"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,485,1144,512"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,485,939,512"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,544,1421,571"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,310,1408,351"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,310,1176,351"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,595,1412,621"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,208,1952,235"/>
</map>
</div>

</div>
</div>
<a id="afb7dae2607f5d00a49d6baae5747d57a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb7dae2607f5d00a49d6baae5747d57a">&#9670;&nbsp;</a></span>enter_svm_guest_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int enter_svm_guest_mode </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>vmcb_gpa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>vmcb12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>from_vmrun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l00785">785</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;{</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    trace_kvm_nested_vmenter(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rip,</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                 vmcb12_gpa,</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                 vmcb12-&gt;save.rip,</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                 vmcb12-&gt;control.int_ctl,</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                 vmcb12-&gt;control.event_inj,</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                 vmcb12-&gt;control.nested_ctl,</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                 vmcb12-&gt;control.nested_cr3,</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                 vmcb12-&gt;save.cr3,</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                 <a class="code" href="trace_8h.html#a4d128aa094f6d97def671922abd09d29">KVM_ISA_SVM</a>);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    trace_kvm_nested_intercepts(vmcb12-&gt;control.intercepts[INTERCEPT_CR] &amp; 0xffff,</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    vmcb12-&gt;control.intercepts[INTERCEPT_CR] &gt;&gt; 16,</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                    vmcb12-&gt;control.intercepts[INTERCEPT_EXCEPTION],</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                    vmcb12-&gt;control.intercepts[INTERCEPT_WORD3],</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                    vmcb12-&gt;control.intercepts[INTERCEPT_WORD4],</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                    vmcb12-&gt;control.intercepts[INTERCEPT_WORD5]);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a16894147af263784cff5f93602e97a54">vmcb12_gpa</a> = vmcb12_gpa;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    WARN_ON(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a> == svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f">nested_svm_copy_common_state</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a>(svm, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <a class="code" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8">nested_vmcb02_prepare_control</a>(svm, vmcb12-&gt;save.rip, vmcb12-&gt;save.cs.base);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <a class="code" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e">nested_vmcb02_prepare_save</a>(svm, vmcb12);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    ret = <a class="code" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab">nested_svm_load_cr3</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3ca397932611001996adc12f53f7247c">save</a>.<a class="code" href="structvmcb__save__area__cached.html#a716fbc4b5214710276c00f469d7d1d29">cr3</a>,</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                  <a class="code" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc">nested_npt_enabled</a>(svm), from_vmrun);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">if</span> (!from_vmrun)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        kvm_make_request(KVM_REQ_GET_NESTED_STATE_PAGES, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <a class="code" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a>(svm, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358">kvm_vcpu_apicv_active</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        kvm_make_request(KVM_REQ_APICV_UPDATE, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <a class="code" href="svm_2hyperv_8h.html#a3983896ad03a4957172ab441f7182b9d">nested_svm_hv_update_vm_vp_ids</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;}</div>
<div class="ttc" id="astructsvm__nested__state_html_a16894147af263784cff5f93602e97a54"><div class="ttname"><a href="structsvm__nested__state.html#a16894147af263784cff5f93602e97a54">svm_nested_state::vmcb12_gpa</a></div><div class="ttdeci">u64 vmcb12_gpa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00162">svm.h:162</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a3ca397932611001996adc12f53f7247c"><div class="ttname"><a href="structsvm__nested__state.html#a3ca397932611001996adc12f53f7247c">svm_nested_state::save</a></div><div class="ttdeci">struct vmcb_save_area_cached save</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00170">svm.h:179</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a53278329495133b9cb2bd06db36a92a0"><div class="ttname"><a href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">svm_nested_state::vmcb02</a></div><div class="ttdeci">struct kvm_vmcb_info vmcb02</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00154">svm.h:159</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_aa2e4d643ef957cd597e82a29f0f0a2c8"><div class="ttname"><a href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">vcpu_svm::nested</a></div><div class="ttdeci">struct svm_nested_state nested</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00236">svm.h:238</a></div></div>
<div class="ttc" id="astructvmcb__save__area__cached_html_a716fbc4b5214710276c00f469d7d1d29"><div class="ttname"><a href="structvmcb__save__area__cached.html#a716fbc4b5214710276c00f469d7d1d29">vmcb_save_area_cached::cr3</a></div><div class="ttdeci">u64 cr3</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00119">svm.h:119</a></div></div>
<div class="ttc" id="asvm_2hyperv_8h_html_a3983896ad03a4957172ab441f7182b9d"><div class="ttname"><a href="svm_2hyperv_8h.html#a3983896ad03a4957172ab441f7182b9d">nested_svm_hv_update_vm_vp_ids</a></div><div class="ttdeci">static void nested_svm_hv_update_vm_vp_ids(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2hyperv_8h_source.html#l00046">hyperv.h:46</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a2d996c5be366f0a7b21228fd18be85ab"><div class="ttname"><a href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab">nested_svm_load_cr3</a></div><div class="ttdeci">static int nested_svm_load_cr3(struct kvm_vcpu *vcpu, unsigned long cr3, bool nested_npt, bool reload_pdptrs)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00507">nested.c:507</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_ab7904bb74631114e0bd5102a52aab4c8"><div class="ttname"><a href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8">nested_vmcb02_prepare_control</a></div><div class="ttdeci">static void nested_vmcb02_prepare_control(struct vcpu_svm *svm, unsigned long vmcb12_rip, unsigned long vmcb12_csbase)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00632">nested.c:632</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_adaebb1c261df8111105ce7566e7bb79f"><div class="ttname"><a href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f">nested_svm_copy_common_state</a></div><div class="ttdeci">static void nested_svm_copy_common_state(struct vmcb *from_vmcb, struct vmcb *to_vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00773">nested.c:773</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_ae734b89c5cf3a889380d8136e2ed749e"><div class="ttname"><a href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e">nested_vmcb02_prepare_save</a></div><div class="ttdeci">static void nested_vmcb02_prepare_save(struct vcpu_svm *svm, struct vmcb *vmcb12)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00537">nested.c:537</a></div></div>
<div class="ttc" id="asvm_8c_html_a051d09f3fa8790388364ac3f69ed3e53"><div class="ttname"><a href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a></div><div class="ttdeci">void svm_switch_vmcb(struct vcpu_svm *svm, struct kvm_vmcb_info *target_vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01407">svm.c:1407</a></div></div>
<div class="ttc" id="asvm_8c_html_a5c26f1ceaa6cc778d986bd33629dc539"><div class="ttname"><a href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a></div><div class="ttdeci">void svm_set_gif(struct vcpu_svm *svm, bool value)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02406">svm.c:2406</a></div></div>
<div class="ttc" id="asvm_8h_html_a96264b6618fa3987f55ba2054a1f12bc"><div class="ttname"><a href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc">nested_npt_enabled</a></div><div class="ttdeci">static bool nested_npt_enabled(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00493">svm.h:493</a></div></div>
<div class="ttc" id="atrace_8h_html_a4d128aa094f6d97def671922abd09d29"><div class="ttname"><a href="trace_8h.html#a4d128aa094f6d97def671922abd09d29">KVM_ISA_SVM</a></div><div class="ttdeci">#define KVM_ISA_SVM</div><div class="ttdef"><b>Definition:</b> <a href="trace_8h_source.html#l00284">trace.h:284</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_afb7dae2607f5d00a49d6baae5747d57a_cgraph.png" border="0" usemap="#asvm_8h_afb7dae2607f5d00a49d6baae5747d57a_cgraph" alt=""/></div>
<map name="asvm_8h_afb7dae2607f5d00a49d6baae5747d57a_cgraph" id="asvm_8h_afb7dae2607f5d00a49d6baae5747d57a_cgraph">
<area shape="rect" title=" " alt="" coords="5,508,184,534"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="1225,1409,1404,1436"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="995,297,1149,324"/>
<area shape="rect" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f" title=" " alt="" coords="241,166,443,207"/>
<area shape="rect" href="svm_2hyperv_8h.html#a3983896ad03a4957172ab441f7182b9d" title=" " alt="" coords="254,231,430,272"/>
<area shape="rect" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab" title=" " alt="" coords="261,297,423,324"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="251,660,433,702"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1037,1190,1107,1217"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="232,1401,452,1428"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="777,1764,879,1790"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="271,1814,413,1841"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="1452,1688,1571,1714"/>
<area shape="rect" href="x86_8h.html#aaa36cdb43bbf6ed6af3b10deed46a436" title=" " alt="" coords="537,94,652,121"/>
<area shape="rect" href="mmu_8c.html#a88ade1c65bbbb9b25a78e82003a71a7c" title=" " alt="" coords="535,145,655,172"/>
<area shape="rect" href="mmu_8c.html#a40fe74f8abc723be216276bf005e4be8" title=" " alt="" coords="516,196,673,222"/>
<area shape="rect" href="cpuid_8h.html#a8f4d8ed96a58f11e51539641257987c2" title=" " alt="" coords="741,385,915,412"/>
<area shape="rect" href="x86_8c.html#ae69bdd054a70a95d99b79bae770372cf" title=" " alt="" coords="545,246,644,273"/>
<area shape="rect" href="x86_8h.html#aad3ee550e50892e0e340061479bb284d" title=" " alt="" coords="772,94,884,121"/>
<area shape="rect" href="x86_8h.html#abc2ffd79aced13c24f0c4143465d3d51" title=" " alt="" coords="796,145,860,172"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1013,642,1131,669"/>
<area shape="rect" href="kvm__cache__regs_8h.html#abebe2fb4cff5a92a299e6d242bbe8f4d" title=" " alt="" coords="523,566,666,593"/>
<area shape="rect" href="svm_2nested_8c.html#ae464eacd98e71ada736815057e8148fc" title=" " alt="" coords="540,718,649,745"/>
<area shape="rect" href="svm_2nested_8c.html#a33d50d29b9030544ff3f90dff7a6dcf5" title=" " alt="" coords="541,769,649,796"/>
<area shape="rect" href="x86_8c.html#a3cfd0f3f85283fad0681dc7607c065c5" title=" " alt="" coords="514,820,675,862"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="515,886,674,913"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="743,1023,913,1064"/>
<area shape="rect" href="svm_2nested_8c.html#af381358fd9991ce7d26d81fdb9f763a9" title=" " alt="" coords="509,450,680,491"/>
<area shape="rect" href="svm_2nested_8c.html#ae003d7b6aae84aa9b70d64f464e70dfc" title=" " alt="" coords="739,958,917,999"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="737,475,919,516"/>
<area shape="rect" href="svm_8h.html#ab452fafde694bb5dfd7c6dfc5707ae12" title=" " alt="" coords="745,617,911,644"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="528,937,661,964"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="516,516,673,542"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1247,1510,1383,1537"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="537,1241,652,1268"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633" title=" " alt="" coords="535,1292,654,1318"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="534,1342,655,1369"/>
<area shape="rect" href="svm_2nested_8c.html#a5124cfade7c6ad2a6e136fdd0391f0a2" title=" " alt="" coords="500,1394,689,1435"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="769,1662,887,1689"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="543,1510,647,1537"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="776,1384,880,1410"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="539,1713,650,1740"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="761,1140,895,1166"/>
<area shape="rect" href="svm_8h.html#af08dd89f5ee519835337165e9060f526" title=" " alt="" coords="538,1561,651,1588"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="1245,1713,1384,1740"/>
<area shape="rect" href="svm_8h.html#a711d42f525aa791008754514284a556c" title=" " alt="" coords="1025,1814,1119,1841"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="1027,1865,1117,1892"/>
<area shape="rect" href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd" title=" " alt="" coords="1227,1862,1402,1903"/>
<area shape="rect" href="irq_8c.html#a82ee83566d2724a298b67f23f481976b" title=" " alt="" coords="967,1409,1177,1436"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="1009,1713,1135,1740"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="1005,1764,1139,1790"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_afb7dae2607f5d00a49d6baae5747d57a_icgraph.png" border="0" usemap="#asvm_8h_afb7dae2607f5d00a49d6baae5747d57a_icgraph" alt=""/></div>
<map name="asvm_8h_afb7dae2607f5d00a49d6baae5747d57a_icgraph" id="asvm_8h_afb7dae2607f5d00a49d6baae5747d57a_icgraph">
<area shape="rect" title=" " alt="" coords="767,5,945,32"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,5,719,32"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,5,520,32"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="a69e061ab353251d82ff01f587be58c96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69e061ab353251d82ff01f587be58c96">&#9670;&nbsp;</a></span>get_vgif_vmcb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct vmcb* get_vgif_vmcb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00452">452</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; !<a class="code" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e">nested_vgif_enabled</a>(svm))</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_ab0a8ab91829811c7705c6455fb294bbc"><div class="ttname"><a href="svm_8h.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a></div><div class="ttdeci">int vgif</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00214">svm.c:214</a></div></div>
<div class="ttc" id="asvm_8h_html_ad6d8c993934e650cf5366b9883c3628e"><div class="ttname"><a href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e">nested_vgif_enabled</a></div><div class="ttdeci">static bool nested_vgif_enabled(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00446">svm.h:446</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a69e061ab353251d82ff01f587be58c96_cgraph.png" border="0" usemap="#asvm_8h_a69e061ab353251d82ff01f587be58c96_cgraph" alt=""/></div>
<map name="asvm_8h_a69e061ab353251d82ff01f587be58c96_cgraph" id="asvm_8h_a69e061ab353251d82ff01f587be58c96_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,124,57"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="191,5,311,32"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="172,56,329,83"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="377,56,496,83"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="783,49,956,90"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="544,81,735,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a69e061ab353251d82ff01f587be58c96_icgraph.png" border="0" usemap="#asvm_8h_a69e061ab353251d82ff01f587be58c96_icgraph" alt=""/></div>
<map name="asvm_8h_a69e061ab353251d82ff01f587be58c96_icgraph" id="asvm_8h_a69e061ab353251d82ff01f587be58c96_icgraph">
<area shape="rect" title=" " alt="" coords="2441,293,2560,319"/>
<area shape="rect" href="svm_8h.html#a711d42f525aa791008754514284a556c" title=" " alt="" coords="2300,230,2393,257"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="2301,293,2392,319"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="1813,759,1880,786"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="2151,179,2252,206"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="1972,103,2103,130"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,234,945,261"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1769,402,1924,429"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,78,940,105"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="1972,53,2103,79"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="1982,205,2093,231"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,490,719,517"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,515,520,542"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,566,323,593"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,566,128,593"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,322,1710,349"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,592,1721,633"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,373,1716,399"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,541,1717,567"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,424,1705,465"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,256,1437,297"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,322,1440,349"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,373,1427,399"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,322,1163,349"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,322,939,349"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,675,1459,702"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,424,1445,465"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,256,1195,297"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,541,1449,567"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,205,1213,231"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="2158,299,2245,326"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1973,306,2101,333"/>
<area shape="rect" href="svm_8c.html#aca7bf4b32b7e7a7cfa632783dd5e6fbf" title=" " alt="" coords="1535,912,1693,953"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="1523,658,1705,685"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="1519,709,1709,735"/>
<area shape="rect" href="svm_2nested_8c.html#a9fea5d164a414c66daa21a6514fc36d6" title=" " alt="" coords="1529,810,1699,837"/>
<area shape="rect" href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa" title=" " alt="" coords="1529,759,1699,786"/>
<area shape="rect" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e" title=" " alt="" coords="1545,861,1683,887"/>
<area shape="rect" href="svm_8c.html#a005049e4b080345fc3924233b8e33bce" title=" " alt="" coords="1275,759,1445,786"/>
<area shape="rect" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695" title=" " alt="" coords="1290,861,1430,887"/>
</map>
</div>

</div>
</div>
<a id="a4b60c96a4d7eed837bb38ed5e03153c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b60c96a4d7eed837bb38ed5e03153c8">&#9670;&nbsp;</a></span>get_vnmi_vmcb_l1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct vmcb* get_vnmi_vmcb_l1 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00513">513</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;{</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a>)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a8d0afd60cabe4ff8b40d7099f49a1bb8"><div class="ttname"><a href="svm_8h.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a></div><div class="ttdeci">bool vnmi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00238">svm.c:238</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a4b60c96a4d7eed837bb38ed5e03153c8_cgraph.png" border="0" usemap="#asvm_8h_a4b60c96a4d7eed837bb38ed5e03153c8_cgraph" alt=""/></div>
<map name="asvm_8h_a4b60c96a4d7eed837bb38ed5e03153c8_cgraph" id="asvm_8h_a4b60c96a4d7eed837bb38ed5e03153c8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="199,5,319,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a4b60c96a4d7eed837bb38ed5e03153c8_icgraph.png" border="0" usemap="#asvm_8h_a4b60c96a4d7eed837bb38ed5e03153c8_icgraph" alt=""/></div>
<map name="asvm_8h_a4b60c96a4d7eed837bb38ed5e03153c8_icgraph" id="asvm_8h_a4b60c96a4d7eed837bb38ed5e03153c8_icgraph">
<area shape="rect" title=" " alt="" coords="893,132,1039,159"/>
<area shape="rect" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d" title=" " alt="" coords="713,132,845,159"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="251,5,441,32"/>
<area shape="rect" href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3" title=" " alt="" coords="501,56,654,83"/>
<area shape="rect" href="svm_8c.html#a67bccbcbb6b439b80103663fe58cd626" title=" " alt="" coords="515,107,640,133"/>
<area shape="rect" href="svm_8c.html#a66b89ca49c9571c6ce3532b335aeed2d" title=" " alt="" coords="494,157,661,184"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="501,208,653,235"/>
<area shape="rect" href="svm_8c.html#a1b5b579e10dbea76b1e9711f1b793975" title=" " alt="" coords="489,259,665,285"/>
<area shape="rect" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e" title=" " alt="" coords="277,56,415,83"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,31,203,57"/>
<area shape="rect" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695" title=" " alt="" coords="34,81,174,108"/>
</map>
</div>

</div>
</div>
<a id="aea7fbac9a0652dc113c81593522e47ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea7fbac9a0652dc113c81593522e47ca">&#9670;&nbsp;</a></span>gif_set()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool gif_set </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00483">483</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = <a class="code" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96">get_vgif_vmcb</a>(svm);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> (vmcb)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">return</span> !!(vmcb-&gt;control.int_ctl &amp; V_GIF_MASK);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#a850f432012717e5e5be4064ae8f340ac">guest_gif</a>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aea7fbac9a0652dc113c81593522e47ca_cgraph.png" border="0" usemap="#asvm_8h_aea7fbac9a0652dc113c81593522e47ca_cgraph" alt=""/></div>
<map name="asvm_8h_aea7fbac9a0652dc113c81593522e47ca_cgraph" id="asvm_8h_aea7fbac9a0652dc113c81593522e47ca_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,72,57"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="120,31,239,57"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="305,5,425,32"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="287,56,444,83"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="492,56,611,83"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="897,49,1071,90"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="659,81,849,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aea7fbac9a0652dc113c81593522e47ca_icgraph.png" border="0" usemap="#asvm_8h_aea7fbac9a0652dc113c81593522e47ca_icgraph" alt=""/></div>
<map name="asvm_8h_aea7fbac9a0652dc113c81593522e47ca_icgraph" id="asvm_8h_aea7fbac9a0652dc113c81593522e47ca_icgraph">
<area shape="rect" title=" " alt="" coords="489,147,556,174"/>
<area shape="rect" href="svm_8c.html#aca7bf4b32b7e7a7cfa632783dd5e6fbf" title=" " alt="" coords="267,5,425,47"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="255,71,437,98"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="251,122,441,149"/>
<area shape="rect" href="svm_2nested_8c.html#a9fea5d164a414c66daa21a6514fc36d6" title=" " alt="" coords="261,173,431,199"/>
<area shape="rect" href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa" title=" " alt="" coords="261,223,431,250"/>
<area shape="rect" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e" title=" " alt="" coords="277,274,415,301"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,249,203,275"/>
<area shape="rect" href="svm_8c.html#a005049e4b080345fc3924233b8e33bce" title=" " alt="" coords="19,198,189,225"/>
<area shape="rect" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695" title=" " alt="" coords="34,299,174,326"/>
</map>
</div>

</div>
</div>
<a id="a66eedd855edb50a1b78c2ac2c48a4d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66eedd855edb50a1b78c2ac2c48a4d5d">&#9670;&nbsp;</a></span>is_vnmi_enabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool is_vnmi_enabled </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00524">524</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = <a class="code" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8">get_vnmi_vmcb_l1</a>(svm);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">if</span> (vmcb)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">return</span> !!(vmcb-&gt;control.int_ctl &amp; V_NMI_ENABLE_MASK);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a4b60c96a4d7eed837bb38ed5e03153c8"><div class="ttname"><a href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8">get_vnmi_vmcb_l1</a></div><div class="ttdeci">static struct vmcb * get_vnmi_vmcb_l1(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00513">svm.h:513</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a66eedd855edb50a1b78c2ac2c48a4d5d_cgraph.png" border="0" usemap="#asvm_8h_a66eedd855edb50a1b78c2ac2c48a4d5d_cgraph" alt=""/></div>
<map name="asvm_8h_a66eedd855edb50a1b78c2ac2c48a4d5d_cgraph" id="asvm_8h_a66eedd855edb50a1b78c2ac2c48a4d5d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,137,32"/>
<area shape="rect" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8" title=" " alt="" coords="185,5,331,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="379,5,499,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a66eedd855edb50a1b78c2ac2c48a4d5d_icgraph.png" border="0" usemap="#asvm_8h_a66eedd855edb50a1b78c2ac2c48a4d5d_icgraph" alt=""/></div>
<map name="asvm_8h_a66eedd855edb50a1b78c2ac2c48a4d5d_icgraph" id="asvm_8h_a66eedd855edb50a1b78c2ac2c48a4d5d_icgraph">
<area shape="rect" title=" " alt="" coords="713,132,845,159"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="251,5,441,32"/>
<area shape="rect" href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3" title=" " alt="" coords="501,56,654,83"/>
<area shape="rect" href="svm_8c.html#a67bccbcbb6b439b80103663fe58cd626" title=" " alt="" coords="515,107,640,133"/>
<area shape="rect" href="svm_8c.html#a66b89ca49c9571c6ce3532b335aeed2d" title=" " alt="" coords="494,157,661,184"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="501,208,653,235"/>
<area shape="rect" href="svm_8c.html#a1b5b579e10dbea76b1e9711f1b793975" title=" " alt="" coords="489,259,665,285"/>
<area shape="rect" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e" title=" " alt="" coords="277,56,415,83"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,31,203,57"/>
<area shape="rect" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695" title=" " alt="" coords="34,81,174,108"/>
</map>
</div>

</div>
</div>
<a id="a7787ebf653e664e7dda7c3b0a8dfa84b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7787ebf653e664e7dda7c3b0a8dfa84b">&#9670;&nbsp;</a></span>is_x2apic_msrpm_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool is_x2apic_msrpm_offset </td>
          <td>(</td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>offset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00504">504</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;{</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">/* 4 msrs per u8, and 4 u8 in u32 */</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    u32 msr = offset * 16;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span> (msr &gt;= APIC_BASE_MSR) &amp;&amp;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;           (msr &lt; (APIC_BASE_MSR + 0x100));</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a7787ebf653e664e7dda7c3b0a8dfa84b_icgraph.png" border="0" usemap="#asvm_8h_a7787ebf653e664e7dda7c3b0a8dfa84b_icgraph" alt=""/></div>
<map name="asvm_8h_a7787ebf653e664e7dda7c3b0a8dfa84b_icgraph" id="asvm_8h_a7787ebf653e664e7dda7c3b0a8dfa84b_icgraph">
<area shape="rect" title=" " alt="" coords="1036,35,1216,61"/>
<area shape="rect" href="svm_2nested_8c.html#a3c235b4ddb7200e464cacf8dfb3b4f00" title=" " alt="" coords="785,35,988,61"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="577,5,728,32"/>
<area shape="rect" href="svm_2nested_8c.html#afd2919b9c5b5e158cb09deba98a74772" title=" " alt="" coords="568,57,737,98"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,5,520,32"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="add5ee1e85234f2457480494694865c21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add5ee1e85234f2457480494694865c21">&#9670;&nbsp;</a></span>nested_copy_vmcb_control_to_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nested_copy_vmcb_control_to_cache </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct vmcb_control_area *&#160;</td>
          <td class="paramname"><em>control</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l00382">382</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;{</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="svm_2nested_8c.html#a1fc7997959fb33b39415a12879645d2d">__nested_copy_vmcb_control_to_cache</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div>
<div class="ttc" id="aposted__intr_8h_html_ae3d3aff52ed2ae9f00a97cfda9ceca6d"><div class="ttname"><a href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a></div><div class="ttdeci">u64 control</div><div class="ttdef"><b>Definition:</b> <a href="posted__intr_8h_source.html#l00016">posted_intr.h:16</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a3b275e369200f402f9d5765babb77629"><div class="ttname"><a href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">svm_nested_state::ctl</a></div><div class="ttdeci">struct vmcb_ctrl_area_cached ctl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00170">svm.h:173</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a1fc7997959fb33b39415a12879645d2d"><div class="ttname"><a href="svm_2nested_8c.html#a1fc7997959fb33b39415a12879645d2d">__nested_copy_vmcb_control_to_cache</a></div><div class="ttdeci">static void __nested_copy_vmcb_control_to_cache(struct kvm_vcpu *vcpu, struct vmcb_ctrl_area_cached *to, struct vmcb_control_area *from)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00336">nested.c:336</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_add5ee1e85234f2457480494694865c21_cgraph.png" border="0" usemap="#asvm_8h_add5ee1e85234f2457480494694865c21_cgraph" alt=""/></div>
<map name="asvm_8h_add5ee1e85234f2457480494694865c21_cgraph" id="asvm_8h_add5ee1e85234f2457480494694865c21_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,204,47"/>
<area shape="rect" href="svm_2nested_8c.html#a1fc7997959fb33b39415a12879645d2d" title=" " alt="" coords="252,5,413,47"/>
<area shape="rect" href="hyperv_8h.html#a31d5079cda04b8db1683c722a4c1dc20" title=" " alt="" coords="461,13,661,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_add5ee1e85234f2457480494694865c21_icgraph.png" border="0" usemap="#asvm_8h_add5ee1e85234f2457480494694865c21_icgraph" alt=""/></div>
<map name="asvm_8h_add5ee1e85234f2457480494694865c21_icgraph" id="asvm_8h_add5ee1e85234f2457480494694865c21_icgraph">
<area shape="rect" title=" " alt="" coords="784,23,983,65"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="577,5,727,32"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="568,56,736,83"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,5,520,32"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="ae052404bed168cf69c578a697ce25526"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae052404bed168cf69c578a697ce25526">&#9670;&nbsp;</a></span>nested_copy_vmcb_save_to_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nested_copy_vmcb_save_to_cache </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct vmcb_save_area *&#160;</td>
          <td class="paramname"><em>save</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l00404">404</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;{</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="svm_2nested_8c.html#a5f775ed43f15dcd9b51601e16d13ba02">__nested_copy_vmcb_save_to_cache</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3ca397932611001996adc12f53f7247c">save</a>, save);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;}</div>
<div class="ttc" id="asvm_2nested_8c_html_a5f775ed43f15dcd9b51601e16d13ba02"><div class="ttname"><a href="svm_2nested_8c.html#a5f775ed43f15dcd9b51601e16d13ba02">__nested_copy_vmcb_save_to_cache</a></div><div class="ttdeci">static void __nested_copy_vmcb_save_to_cache(struct vmcb_save_area_cached *to, struct vmcb_save_area *from)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00388">nested.c:388</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ae052404bed168cf69c578a697ce25526_cgraph.png" border="0" usemap="#asvm_8h_ae052404bed168cf69c578a697ce25526_cgraph" alt=""/></div>
<map name="asvm_8h_ae052404bed168cf69c578a697ce25526_cgraph" id="asvm_8h_ae052404bed168cf69c578a697ce25526_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,191,47"/>
<area shape="rect" href="svm_2nested_8c.html#a5f775ed43f15dcd9b51601e16d13ba02" title=" " alt="" coords="239,5,400,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ae052404bed168cf69c578a697ce25526_icgraph.png" border="0" usemap="#asvm_8h_ae052404bed168cf69c578a697ce25526_icgraph" alt=""/></div>
<map name="asvm_8h_ae052404bed168cf69c578a697ce25526_icgraph" id="asvm_8h_ae052404bed168cf69c578a697ce25526_icgraph">
<area shape="rect" title=" " alt="" coords="767,5,952,47"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,13,719,39"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,13,520,39"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,13,323,39"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,13,128,39"/>
</map>
</div>

</div>
</div>
<a id="a13cbed806a9638fcaab4d01cb926d141"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13cbed806a9638fcaab4d01cb926d141">&#9670;&nbsp;</a></span>nested_exit_on_intr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool nested_exit_on_intr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00581">581</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;{</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>, INTERCEPT_INTR);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a5deff43556f8c807c64def073cd548e4"><div class="ttname"><a href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a></div><div class="ttdeci">static bool vmcb12_is_intercept(struct vmcb_ctrl_area_cached *control, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00397">svm.h:397</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a13cbed806a9638fcaab4d01cb926d141_cgraph.png" border="0" usemap="#asvm_8h_a13cbed806a9638fcaab4d01cb926d141_cgraph" alt=""/></div>
<map name="asvm_8h_a13cbed806a9638fcaab4d01cb926d141_cgraph" id="asvm_8h_a13cbed806a9638fcaab4d01cb926d141_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,156,32"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="204,5,361,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a13cbed806a9638fcaab4d01cb926d141_icgraph.png" border="0" usemap="#asvm_8h_a13cbed806a9638fcaab4d01cb926d141_icgraph" alt=""/></div>
<map name="asvm_8h_a13cbed806a9638fcaab4d01cb926d141_icgraph" id="asvm_8h_a13cbed806a9638fcaab4d01cb926d141_icgraph">
<area shape="rect" title=" " alt="" coords="2008,628,2159,655"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1783,283,1938,309"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1249,436,1446,463"/>
<area shape="rect" href="vmx_2nested_8c.html#a4d02669b451b76b64dc28047526be8c4" title=" " alt="" coords="1766,621,1955,662"/>
<area shape="rect" href="vmx_2nested_8c.html#a877b148ab3be256ff208a4d0c0136809" title=" " alt="" coords="1761,689,1960,716"/>
<area shape="rect" href="svm_8c.html#a005049e4b080345fc3924233b8e33bce" title=" " alt="" coords="1521,567,1691,593"/>
<area shape="rect" href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa" title=" " alt="" coords="1775,519,1946,545"/>
<area shape="rect" href="vmx_2nested_8c.html#ae8bd3aaa6d3ea61d98732dc54ced8578" title=" " alt="" coords="1507,749,1705,776"/>
<area shape="rect" href="vmx_8c.html#a8b92a5c83267fa843483b8277bc73f30" title=" " alt="" coords="1520,968,1692,995"/>
<area shape="rect" href="vmx_8c.html#a368d7a25f0cc51f62229282a5d2550d3" title=" " alt="" coords="1775,835,1946,861"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1510,85,1702,112"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1499,399,1713,441"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1504,232,1708,259"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="578,228,729,255"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1503,283,1709,309"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1515,334,1697,375"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1271,107,1424,149"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1267,5,1427,32"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1281,56,1414,83"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1045,115,1164,141"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="793,115,959,141"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1262,225,1433,266"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1013,225,1196,266"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="787,228,965,255"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="792,279,960,305"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,261,520,288"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,301,323,328"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,301,128,328"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1258,291,1437,317"/>
<area shape="rect" href="vmx_2nested_8c.html#a8d1fe51ef29b584cee280b58fe718d4b" title=" " alt="" coords="1501,618,1711,659"/>
<area shape="rect" href="vmx_2nested_8c.html#abf066f4df15192018878337db5bbe045" title=" " alt="" coords="1244,625,1451,652"/>
<area shape="rect" href="vmx_2nested_8c.html#add1e82c32385142c0fca04a1db8cbc3a" title=" " alt="" coords="1039,651,1170,677"/>
<area shape="rect" href="vmx_2nested_8c.html#acee8cb651216e97a9c12b807243ae59a" title=" " alt="" coords="1020,600,1189,627"/>
<area shape="rect" href="vmx_2nested_8c.html#a48fecee9010894e3a1513a0924e24dd6" title=" " alt="" coords="807,625,945,652"/>
<area shape="rect" href="vmx_2nested_8c.html#a23e3de8c964e87404eea818be6f70154" title=" " alt="" coords="805,676,947,703"/>
<area shape="rect" href="vmx_2nested_8c.html#a77ca924cd23ac875ea48b1f181f33000" title=" " alt="" coords="568,643,739,685"/>
<area shape="rect" href="vmx_8c.html#a7cacd86bbd7f4ae2b8c9e5e8568fa5e4" title=" " alt="" coords="382,651,509,677"/>
<area shape="rect" href="vmx_2nested_8c.html#a48fcc88ceee4f57a3dbf23fedb46a5cb" title=" " alt="" coords="1531,683,1681,725"/>
<area shape="rect" href="vmx_8c.html#a23ea2316b60c27a2c00f924b983a46e9" title=" " alt="" coords="1273,808,1421,835"/>
<area shape="rect" href="vmx_8c.html#a6ee5de3518ff2c2c20b1c1a0e17b2f1e" title=" " alt="" coords="1037,808,1172,835"/>
<area shape="rect" href="vmx_8c.html#a826652b83d0f8797a169f7839596c178" title=" " alt="" coords="1526,801,1686,842"/>
<area shape="rect" href="posted__intr_8c.html#aa59b00f36d985abaa19009096d1f66a4" title=" " alt="" coords="1538,917,1674,944"/>
<area shape="rect" href="vmx_8c.html#a65248f7343c2ee3dfdfeb6388e80ab9b" title=" " alt="" coords="1289,917,1406,944"/>
</map>
</div>

</div>
</div>
<a id="aefa7c9e670f5a86519f40b06f5277346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa7c9e670f5a86519f40b06f5277346">&#9670;&nbsp;</a></span>nested_exit_on_nmi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool nested_exit_on_nmi </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00586">586</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;{</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>, INTERCEPT_NMI);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aefa7c9e670f5a86519f40b06f5277346_cgraph.png" border="0" usemap="#asvm_8h_aefa7c9e670f5a86519f40b06f5277346_cgraph" alt=""/></div>
<map name="asvm_8h_aefa7c9e670f5a86519f40b06f5277346_cgraph" id="asvm_8h_aefa7c9e670f5a86519f40b06f5277346_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,159,32"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="207,5,364,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aefa7c9e670f5a86519f40b06f5277346_icgraph.png" border="0" usemap="#asvm_8h_aefa7c9e670f5a86519f40b06f5277346_icgraph" alt=""/></div>
<map name="asvm_8h_aefa7c9e670f5a86519f40b06f5277346_icgraph" id="asvm_8h_aefa7c9e670f5a86519f40b06f5277346_icgraph">
<area shape="rect" title=" " alt="" coords="440,119,593,145"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="6,5,203,32"/>
<area shape="rect" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695" title=" " alt="" coords="35,68,175,95"/>
<area shape="rect" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e" title=" " alt="" coords="253,43,391,69"/>
<area shape="rect" href="vmx_2nested_8c.html#ae8bd3aaa6d3ea61d98732dc54ced8578" title=" " alt="" coords="5,156,204,183"/>
<area shape="rect" href="vmx_8c.html#a4546be655e5968c462322858ecf68c49" title=" " alt="" coords="34,232,175,259"/>
<area shape="rect" href="vmx_8c.html#ae92f23c5709cc4f9fe4fe2d794deef50" title=" " alt="" coords="252,195,392,221"/>
</map>
</div>

</div>
</div>
<a id="a61ac82c942842848fab805e84fc70189"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61ac82c942842848fab805e84fc70189">&#9670;&nbsp;</a></span>nested_exit_on_smi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool nested_exit_on_smi </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00576">576</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;{</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4">vmcb12_is_intercept</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>, INTERCEPT_SMI);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a61ac82c942842848fab805e84fc70189_cgraph.png" border="0" usemap="#asvm_8h_a61ac82c942842848fab805e84fc70189_cgraph" alt=""/></div>
<map name="asvm_8h_a61ac82c942842848fab805e84fc70189_cgraph" id="asvm_8h_a61ac82c942842848fab805e84fc70189_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,157,32"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="205,5,363,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a61ac82c942842848fab805e84fc70189_icgraph.png" border="0" usemap="#asvm_8h_a61ac82c942842848fab805e84fc70189_icgraph" alt=""/></div>
<map name="asvm_8h_a61ac82c942842848fab805e84fc70189_icgraph" id="asvm_8h_a61ac82c942842848fab805e84fc70189_icgraph">
<area shape="rect" title=" " alt="" coords="251,5,403,32"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,5,203,32"/>
</map>
</div>

</div>
</div>
<a id="a96264b6618fa3987f55ba2054a1f12bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96264b6618fa3987f55ba2054a1f12bc">&#9670;&nbsp;</a></span>nested_npt_enabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool nested_npt_enabled </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00493">493</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;{</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">return</span> svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a64059f1364084ba55fe82bf69f0704dd">nested_ctl</a> &amp; SVM_NESTED_CTL_NP_ENABLE;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a64059f1364084ba55fe82bf69f0704dd"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a64059f1364084ba55fe82bf69f0704dd">vmcb_ctrl_area_cached::nested_ctl</a></div><div class="ttdeci">u64 nested_ctl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00143">svm.h:143</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a96264b6618fa3987f55ba2054a1f12bc_icgraph.png" border="0" usemap="#asvm_8h_a96264b6618fa3987f55ba2054a1f12bc_icgraph" alt=""/></div>
<map name="asvm_8h_a96264b6618fa3987f55ba2054a1f12bc_icgraph" id="asvm_8h_a96264b6618fa3987f55ba2054a1f12bc_icgraph">
<area shape="rect" title=" " alt="" coords="2699,323,2852,349"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="785,296,963,323"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="2057,163,2240,205"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="1319,245,1487,272"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="2469,374,2651,415"/>
<area shape="rect" href="svm_2nested_8c.html#afd2919b9c5b5e158cb09deba98a74772" title=" " alt="" coords="2475,439,2645,481"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,355,719,381"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,355,520,381"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,355,323,381"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,355,128,381"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="2288,935,2421,961"/>
<area shape="rect" href="svm_8c.html#a02cdc4055c8a1706c884eff72c4caaf7" title=" " alt="" coords="2083,935,2214,961"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="2061,1276,2236,1303"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="1837,1188,1975,1215"/>
<area shape="rect" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf" title=" " alt="" coords="2081,1087,2216,1113"/>
<area shape="rect" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642" title=" " alt="" coords="2059,1011,2238,1037"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="2079,549,2218,576"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="2077,753,2220,780"/>
<area shape="rect" href="svm_8c.html#a84f2d3e5d602af563ab58693bf87db77" title=" " alt="" coords="1846,935,1966,961"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1359,1021,1446,1048"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="1587,1407,1703,1433"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="1347,448,1458,475"/>
<area shape="rect" href="svm_8c.html#aeb01a3f5d5204374edbbdb185d87ffcd" title=" " alt="" coords="1819,1239,1993,1281"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1086,1021,1214,1048"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="1332,1407,1473,1433"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1029,1407,1271,1433"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1073,448,1227,475"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1040,397,1260,424"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="778,481,970,508"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="767,365,981,406"/>
<area shape="rect" href="svm_8c.html#a8e925350e4b7d486cb0b9bace97fc5f0" title=" " alt="" coords="1803,1087,2009,1113"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="1831,651,1981,693"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="1843,195,1969,221"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="1594,93,1695,120"/>
<area shape="rect" href="svm_8c.html#aff900c45df2faa151d783155ec034f86" title=" " alt="" coords="1823,397,1989,424"/>
<area shape="rect" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1" title=" " alt="" coords="1820,717,1992,758"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="1854,499,1958,525"/>
<area shape="rect" href="svm_8c.html#aa30e5cb5ad1759988fc349bd703bd4dc" title=" " alt="" coords="1809,448,2003,475"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="1569,753,1721,794"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="1535,195,1755,221"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="1337,93,1468,120"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="1337,144,1468,171"/>
<area shape="rect" href="svm_8c.html#aaa5bf4dc91985f4c533268b7e4ca811d" title=" " alt="" coords="1580,347,1709,373"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="1569,549,1721,576"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1611,448,1678,475"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="1811,783,2001,809"/>
<area shape="rect" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066" title=" " alt="" coords="1821,549,1991,576"/>
<area shape="rect" href="svm_8c.html#a27df28527cda6f7917355af86817d940" title=" " alt="" coords="1849,833,1963,860"/>
<area shape="rect" href="svm_8c.html#a67bccbcbb6b439b80103663fe58cd626" title=" " alt="" coords="1582,600,1707,627"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="1553,869,1736,896"/>
</map>
</div>

</div>
</div>
<a id="a869cefc2d0dabd5e6c07940e88a4acfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a869cefc2d0dabd5e6c07940e88a4acfe">&#9670;&nbsp;</a></span>nested_svm_check_exception()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nested_svm_check_exception </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>has_error_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>error_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8907fcb136a33618dbbc1c2b7d3872f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8907fcb136a33618dbbc1c2b7d3872f8">&#9670;&nbsp;</a></span>nested_svm_check_permissions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nested_svm_check_permissions </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l01357">1357</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;{</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordflow">if</span> (!(vcpu-&gt;arch.efer &amp; EFER_SVME) || !<a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(vcpu)) {</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <a class="code" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a>(vcpu, UD_VECTOR);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;vmcb-&gt;save.cpl) {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        kvm_inject_gp(vcpu, 0);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;}</div>
<div class="ttc" id="ax86_8c_html_ac9502ee8f018301047c80e19ab79f7e2"><div class="ttname"><a href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a></div><div class="ttdeci">void kvm_queue_exception(struct kvm_vcpu *vcpu, unsigned nr)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00731">x86.c:731</a></div></div>
<div class="ttc" id="ax86_8h_html_a716c9d1b6fc76fd454097cf39d640878"><div class="ttname"><a href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a></div><div class="ttdeci">static bool is_paging(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00198">x86.h:198</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a8907fcb136a33618dbbc1c2b7d3872f8_cgraph.png" border="0" usemap="#asvm_8h_a8907fcb136a33618dbbc1c2b7d3872f8_cgraph" alt=""/></div>
<map name="asvm_8h_a8907fcb136a33618dbbc1c2b7d3872f8_cgraph" id="asvm_8h_a8907fcb136a33618dbbc1c2b7d3872f8_cgraph">
<area shape="rect" title=" " alt="" coords="5,177,237,204"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="328,92,412,119"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="285,177,455,204"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="335,228,405,255"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="521,75,667,101"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="760,5,905,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="980,5,1173,32"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="503,195,685,221"/>
<area shape="rect" href="x86_8c.html#aceb2924baf63df8bf7e8a4515976bd27" title=" " alt="" coords="769,56,896,83"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="773,107,893,133"/>
<area shape="rect" href="x86_8c.html#a92e1a819da31f9776852acd897808e99" title=" " alt="" coords="745,158,920,199"/>
<area shape="rect" href="x86_8h.html#aa9890500a8e1721d97bbeb847c932d2b" title=" " alt="" coords="733,224,932,251"/>
<area shape="rect" href="x86_8c.html#aac24bace71b27dc8ae2ee3ecae145d0f" title=" " alt="" coords="741,275,925,301"/>
<area shape="rect" href="x86_8c.html#a28de704e0172e28f1f108b20d606458b" title=" " alt="" coords="748,326,917,367"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a8907fcb136a33618dbbc1c2b7d3872f8_icgraph.png" border="0" usemap="#asvm_8h_a8907fcb136a33618dbbc1c2b7d3872f8_icgraph" alt=""/></div>
<map name="asvm_8h_a8907fcb136a33618dbbc1c2b7d3872f8_icgraph" id="asvm_8h_a8907fcb136a33618dbbc1c2b7d3872f8_icgraph">
<area shape="rect" title=" " alt="" coords="840,81,1072,108"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="619,5,750,32"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="619,56,750,83"/>
<area shape="rect" href="svm_8c.html#a22d5ad8a3cac7e24cb8438a20eb39348" title=" " alt="" coords="577,107,792,133"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="375,157,525,184"/>
<area shape="rect" href="svm_8c.html#a21c0c414304458bb0fdecde7cc8eeb2d" title=" " alt="" coords="372,56,528,83"/>
<area shape="rect" href="svm_8c.html#a81c9359522d571596389c15258054845" title=" " alt="" coords="371,107,529,133"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,107,323,133"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,107,128,133"/>
</map>
</div>

</div>
</div>
<a id="a777240cb9ab00451d21a1b204e19c5a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a777240cb9ab00451d21a1b204e19c5a6">&#9670;&nbsp;</a></span>nested_svm_exit_handled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nested_svm_exit_handled </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l01345">1345</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;{</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordtype">int</span> vmexit;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    vmexit = <a class="code" href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba">nested_svm_intercept</a>(svm);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160; </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">if</span> (vmexit == <a class="code" href="svm_8h.html#a9c953f5ab9b400e9a1c5232515ec6293">NESTED_EXIT_DONE</a>)</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <a class="code" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05">nested_svm_vmexit</a>(svm);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="keywordflow">return</span> vmexit;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;}</div>
<div class="ttc" id="asvm_2nested_8c_html_a73d1cb9b9fcfa112138681d9080a1c05"><div class="ttname"><a href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05">nested_svm_vmexit</a></div><div class="ttdeci">int nested_svm_vmexit(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00967">nested.c:967</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_ac2a7393e1ff675481f27e30ab22ba5ba"><div class="ttname"><a href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba">nested_svm_intercept</a></div><div class="ttdeci">static int nested_svm_intercept(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01301">nested.c:1301</a></div></div>
<div class="ttc" id="asvm_8h_html_a9c953f5ab9b400e9a1c5232515ec6293"><div class="ttname"><a href="svm_8h.html#a9c953f5ab9b400e9a1c5232515ec6293">NESTED_EXIT_DONE</a></div><div class="ttdeci">#define NESTED_EXIT_DONE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00566">svm.h:566</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a777240cb9ab00451d21a1b204e19c5a6_cgraph.png" border="0" usemap="#asvm_8h_a777240cb9ab00451d21a1b204e19c5a6_cgraph" alt=""/></div>
<map name="asvm_8h_a777240cb9ab00451d21a1b204e19c5a6_cgraph" id="asvm_8h_a777240cb9ab00451d21a1b204e19c5a6_cgraph">
<area shape="rect" title=" " alt="" coords="5,553,197,580"/>
<area shape="rect" href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba" title=" " alt="" coords="245,81,412,108"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="251,999,406,1025"/>
<area shape="rect" href="svm_2nested_8c.html#a90464b57b273a88a7a1fb3c2cefb257a" title=" " alt="" coords="460,5,684,32"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="753,107,910,133"/>
<area shape="rect" href="svm_2nested_8c.html#ac11321f5c485c6fd9804b75a6b405f64" title=" " alt="" coords="473,56,671,83"/>
<area shape="rect" href="kvm__main_8c.html#ae63a6f386d39aff5ffc5645780018b7a" title=" " alt="" coords="747,56,915,83"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="758,5,905,32"/>
<area shape="rect" href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73" title=" " alt="" coords="473,695,671,721"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="772,335,891,361"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="491,411,653,437"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="491,462,653,503"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="495,527,649,569"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="511,593,633,620"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="493,644,651,671"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="487,745,657,772"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="515,1303,629,1329"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="515,796,629,823"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="517,847,627,873"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="515,897,629,924"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a30f9ca7e6fd08d1cf123f57fbfba01c7" title=" " alt="" coords="515,948,629,975"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633" title=" " alt="" coords="513,999,631,1025"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="511,1049,633,1076"/>
<area shape="rect" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a" title=" " alt="" coords="507,1100,637,1127"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="509,1151,635,1177"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="501,1201,643,1228"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="499,1252,645,1279"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="497,157,647,184"/>
<area shape="rect" href="svm_2nested_8c.html#a5b731f64682240fd51bd242f194b33f4" title=" " alt="" coords="491,1354,653,1395"/>
<area shape="rect" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f" title=" " alt="" coords="471,1419,673,1461"/>
<area shape="rect" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab" title=" " alt="" coords="491,1485,653,1512"/>
<area shape="rect" href="svm_2nested_8c.html#af381358fd9991ce7d26d81fdb9f763a9" title=" " alt="" coords="487,1537,657,1578"/>
<area shape="rect" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53" title=" " alt="" coords="479,1602,665,1643"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="772,1668,891,1695"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1006,1769,1142,1796"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="520,1769,624,1796"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="779,1820,883,1847"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="517,1871,627,1897"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="781,1921,882,1948"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="501,208,643,235"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="505,309,639,336"/>
<area shape="rect" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943" title=" " alt="" coords="479,259,665,285"/>
<area shape="rect" href="lapic_8c.html#a5468339c2df08ca538b77d4d48915c35" title=" " alt="" coords="742,745,921,772"/>
<area shape="rect" href="x86_8c.html#a8415cd1d2d30e65d505adb5ba75a0338" title=" " alt="" coords="753,593,910,620"/>
<area shape="rect" href="x86_8c.html#ade52ab1bf2b3d66def1c4851fab08c45" title=" " alt="" coords="732,644,931,671"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="772,695,891,721"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1217,327,1391,369"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="979,360,1169,387"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="740,796,923,823"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="759,1303,904,1329"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a777240cb9ab00451d21a1b204e19c5a6_icgraph.png" border="0" usemap="#asvm_8h_a777240cb9ab00451d21a1b204e19c5a6_icgraph" alt=""/></div>
<map name="asvm_8h_a777240cb9ab00451d21a1b204e19c5a6_icgraph" id="asvm_8h_a777240cb9ab00451d21a1b204e19c5a6_icgraph">
<area shape="rect" title=" " alt="" coords="595,71,787,98"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="390,5,543,47"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="387,71,547,98"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="400,122,533,149"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="220,13,339,39"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="5,13,172,39"/>
</map>
</div>

</div>
</div>
<a id="abfe06c5436ae4d724c3c4495f8af136d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfe06c5436ae4d724c3c4495f8af136d">&#9670;&nbsp;</a></span>nested_svm_exit_special()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nested_svm_exit_special </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l01496">1496</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;{</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    u32 exit_code = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordflow">switch</span> (exit_code) {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_INTR:</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_NMI:</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_NPF:</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a5d1cfc3512b22eae96df1b679e87a92e">NESTED_EXIT_HOST</a>;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_EXCP_BASE ... SVM_EXIT_EXCP_BASE + 0x1f: {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        u32 excp_bits = 1 &lt;&lt; (exit_code - SVM_EXIT_EXCP_BASE);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;control.intercepts[INTERCEPT_EXCEPTION] &amp;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;            excp_bits)</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a5d1cfc3512b22eae96df1b679e87a92e">NESTED_EXIT_HOST</a>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exit_code == SVM_EXIT_EXCP_BASE + PF_VECTOR &amp;&amp;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;             svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.apf.host_apf_flags)</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <span class="comment">/* Trap async PF even if not shadowing */</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a5d1cfc3512b22eae96df1b679e87a92e">NESTED_EXIT_HOST</a>;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="keywordflow">case</span> SVM_EXIT_VMMCALL:</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="comment">/* Hyper-V L2 TLB flush hypercall is handled by L0 */</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="hyperv_8h.html#a902f3e7ce9ea9015898912540b132bd9">guest_hv_cpuid_has_l2_tlb_flush</a>(vcpu) &amp;&amp;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            <a class="code" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643">nested_svm_l2_tlb_flush_enabled</a>(vcpu) &amp;&amp;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            <a class="code" href="hyperv_8h.html#a1d303f485b6e5e724a2fecb90fa8534b">kvm_hv_is_tlb_flush_hcall</a>(vcpu))</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a5d1cfc3512b22eae96df1b679e87a92e">NESTED_EXIT_HOST</a>;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    }</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#ac75660e3dace3bef9ab0d76dedf2034e">NESTED_EXIT_CONTINUE</a>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;}</div>
<div class="ttc" id="ahyperv_8h_html_a1d303f485b6e5e724a2fecb90fa8534b"><div class="ttname"><a href="hyperv_8h.html#a1d303f485b6e5e724a2fecb90fa8534b">kvm_hv_is_tlb_flush_hcall</a></div><div class="ttdeci">static bool kvm_hv_is_tlb_flush_hcall(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="hyperv_8h_source.html#l00308">hyperv.h:308</a></div></div>
<div class="ttc" id="ahyperv_8h_html_a902f3e7ce9ea9015898912540b132bd9"><div class="ttname"><a href="hyperv_8h.html#a902f3e7ce9ea9015898912540b132bd9">guest_hv_cpuid_has_l2_tlb_flush</a></div><div class="ttdeci">static bool guest_hv_cpuid_has_l2_tlb_flush(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="hyperv_8h_source.html#l00312">hyperv.h:312</a></div></div>
<div class="ttc" id="asvm_2hyperv_8h_html_a95be98cf04ff1e53cefb6771c7450643"><div class="ttname"><a href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643">nested_svm_l2_tlb_flush_enabled</a></div><div class="ttdeci">static bool nested_svm_l2_tlb_flush_enabled(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2hyperv_8h_source.html#l00047">hyperv.h:47</a></div></div>
<div class="ttc" id="asvm_8h_html_a5d1cfc3512b22eae96df1b679e87a92e"><div class="ttname"><a href="svm_8h.html#a5d1cfc3512b22eae96df1b679e87a92e">NESTED_EXIT_HOST</a></div><div class="ttdeci">#define NESTED_EXIT_HOST</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00565">svm.h:565</a></div></div>
<div class="ttc" id="asvm_8h_html_ac75660e3dace3bef9ab0d76dedf2034e"><div class="ttname"><a href="svm_8h.html#ac75660e3dace3bef9ab0d76dedf2034e">NESTED_EXIT_CONTINUE</a></div><div class="ttdeci">#define NESTED_EXIT_CONTINUE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00567">svm.h:567</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_abfe06c5436ae4d724c3c4495f8af136d_cgraph.png" border="0" usemap="#asvm_8h_abfe06c5436ae4d724c3c4495f8af136d_cgraph" alt=""/></div>
<map name="asvm_8h_abfe06c5436ae4d724c3c4495f8af136d_cgraph" id="asvm_8h_abfe06c5436ae4d724c3c4495f8af136d_cgraph">
<area shape="rect" title=" " alt="" coords="5,78,192,105"/>
<area shape="rect" href="hyperv_8h.html#a902f3e7ce9ea9015898912540b132bd9" title=" " alt="" coords="255,5,408,47"/>
<area shape="rect" href="hyperv_8h.html#a1d303f485b6e5e724a2fecb90fa8534b" title=" " alt="" coords="254,71,409,112"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="240,136,423,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_abfe06c5436ae4d724c3c4495f8af136d_icgraph.png" border="0" usemap="#asvm_8h_abfe06c5436ae4d724c3c4495f8af136d_icgraph" alt=""/></div>
<map name="asvm_8h_abfe06c5436ae4d724c3c4495f8af136d_icgraph" id="asvm_8h_abfe06c5436ae4d724c3c4495f8af136d_icgraph">
<area shape="rect" title=" " alt="" coords="187,5,373,32"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="5,5,139,32"/>
</map>
</div>

</div>
</div>
<a id="a7b2d87885eea1b11b1bf1045c21c5a8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b2d87885eea1b11b1bf1045c21c5a8b">&#9670;&nbsp;</a></span>nested_svm_simple_vmexit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int nested_svm_simple_vmexit </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>exit_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00602">602</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;{</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code   = exit_code;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1 = 0;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2 = 0;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a73d1cb9b9fcfa112138681d9080a1c05">nested_svm_vmexit</a>(svm);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a73d1cb9b9fcfa112138681d9080a1c05"><div class="ttname"><a href="svm_8h.html#a73d1cb9b9fcfa112138681d9080a1c05">nested_svm_vmexit</a></div><div class="ttdeci">int nested_svm_vmexit(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00967">nested.c:967</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a7b2d87885eea1b11b1bf1045c21c5a8b_cgraph.png" border="0" usemap="#asvm_8h_a7b2d87885eea1b11b1bf1045c21c5a8b_cgraph" alt=""/></div>
<map name="asvm_8h_a7b2d87885eea1b11b1bf1045c21c5a8b_cgraph" id="asvm_8h_a7b2d87885eea1b11b1bf1045c21c5a8b_cgraph">
<area shape="rect" title=" " alt="" coords="5,999,211,1025"/>
<area shape="rect" href="svm_8h.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="259,999,413,1025"/>
<area shape="rect" href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73" title=" " alt="" coords="464,107,661,133"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="752,999,871,1025"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="482,233,643,260"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="482,285,643,326"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="486,350,639,391"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="501,416,624,443"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="483,467,642,493"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="478,183,647,209"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="505,619,620,645"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="754,669,869,696"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="507,517,618,544"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="505,720,620,747"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a30f9ca7e6fd08d1cf123f57fbfba01c7" title=" " alt="" coords="505,568,620,595"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633" title=" " alt="" coords="503,771,622,797"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="502,821,623,848"/>
<area shape="rect" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a" title=" " alt="" coords="497,923,628,949"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="500,872,625,899"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="492,1491,633,1517"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="490,1075,635,1101"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="487,1125,638,1152"/>
<area shape="rect" href="svm_2nested_8c.html#a5b731f64682240fd51bd242f194b33f4" title=" " alt="" coords="481,1177,644,1218"/>
<area shape="rect" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f" title=" " alt="" coords="461,1242,664,1283"/>
<area shape="rect" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab" title=" " alt="" coords="481,1308,644,1335"/>
<area shape="rect" href="svm_2nested_8c.html#af381358fd9991ce7d26d81fdb9f763a9" title=" " alt="" coords="477,1359,648,1401"/>
<area shape="rect" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53" title=" " alt="" coords="469,1425,656,1466"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="752,1693,871,1720"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="987,1643,1123,1669"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="511,1592,615,1619"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="759,1643,863,1669"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="507,1744,618,1771"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="761,1820,862,1847"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="491,1795,634,1821"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="495,973,630,1000"/>
<area shape="rect" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943" title=" " alt="" coords="469,1896,656,1923"/>
<area shape="rect" href="lapic_8c.html#a5468339c2df08ca538b77d4d48915c35" title=" " alt="" coords="722,157,901,184"/>
<area shape="rect" href="x86_8c.html#a8415cd1d2d30e65d505adb5ba75a0338" title=" " alt="" coords="733,5,890,32"/>
<area shape="rect" href="x86_8c.html#ade52ab1bf2b3d66def1c4851fab08c45" title=" " alt="" coords="712,56,911,83"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="752,107,871,133"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1200,991,1373,1033"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="960,973,1151,1000"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="720,208,903,235"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="739,619,884,645"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="959,619,1152,645"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="724,568,899,595"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="722,745,901,772"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="744,821,879,848"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="766,872,857,899"/>
<area shape="rect" href="kvm__main_8c.html#a6f9056f6dc868b557b2a2c8e1c548762" title=" " alt="" coords="744,1491,879,1517"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a7b2d87885eea1b11b1bf1045c21c5a8b_icgraph.png" border="0" usemap="#asvm_8h_a7b2d87885eea1b11b1bf1045c21c5a8b_icgraph" alt=""/></div>
<map name="asvm_8h_a7b2d87885eea1b11b1bf1045c21c5a8b_icgraph" id="asvm_8h_a7b2d87885eea1b11b1bf1045c21c5a8b_icgraph">
<area shape="rect" title=" " alt="" coords="421,56,627,83"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="201,5,348,32"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="185,56,364,83"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="176,107,373,133"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="ae003d7b6aae84aa9b70d64f464e70dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae003d7b6aae84aa9b70d64f464e70dfc">&#9670;&nbsp;</a></span>nested_svm_update_tsc_ratio_msr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nested_svm_update_tsc_ratio_msr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l01532">1532</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;{</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.tsc_scaling_ratio =</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        <a class="code" href="x86_8c.html#a28e1ea12c3716db0da7fb26d678f4823">kvm_calc_nested_tsc_multiplier</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.l1_tsc_scaling_ratio,</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                           svm-&gt;<a class="code" href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">tsc_ratio_msr</a>);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <a class="code" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943">svm_write_tsc_multiplier</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_a48b965690a803159d4542489b0e487e8"><div class="ttname"><a href="structvcpu__svm.html#a48b965690a803159d4542489b0e487e8">vcpu_svm::tsc_ratio_msr</a></div><div class="ttdeci">u64 tsc_ratio_msr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00226">svm.h:226</a></div></div>
<div class="ttc" id="asvm_8c_html_ad9a1b45b05505f9435cc2d1dd1c37943"><div class="ttname"><a href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943">svm_write_tsc_multiplier</a></div><div class="ttdeci">void svm_write_tsc_multiplier(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01163">svm.c:1163</a></div></div>
<div class="ttc" id="ax86_8c_html_a28e1ea12c3716db0da7fb26d678f4823"><div class="ttname"><a href="x86_8c.html#a28e1ea12c3716db0da7fb26d678f4823">kvm_calc_nested_tsc_multiplier</a></div><div class="ttdeci">u64 kvm_calc_nested_tsc_multiplier(u64 l1_multiplier, u64 l2_multiplier)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l02605">x86.c:2605</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ae003d7b6aae84aa9b70d64f464e70dfc_cgraph.png" border="0" usemap="#asvm_8h_ae003d7b6aae84aa9b70d64f464e70dfc_cgraph" alt=""/></div>
<map name="asvm_8h_ae003d7b6aae84aa9b70d64f464e70dfc_cgraph" id="asvm_8h_ae003d7b6aae84aa9b70d64f464e70dfc_cgraph">
<area shape="rect" title=" " alt="" coords="5,64,184,105"/>
<area shape="rect" href="x86_8c.html#a28e1ea12c3716db0da7fb26d678f4823" title=" " alt="" coords="245,5,406,47"/>
<area shape="rect" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943" title=" " alt="" coords="232,71,419,98"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="531,122,602,149"/>
<area shape="rect" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34" title=" " alt="" coords="467,71,667,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ae003d7b6aae84aa9b70d64f464e70dfc_icgraph.png" border="0" usemap="#asvm_8h_ae003d7b6aae84aa9b70d64f464e70dfc_icgraph" alt=""/></div>
<map name="asvm_8h_ae003d7b6aae84aa9b70d64f464e70dfc_icgraph" id="asvm_8h_ae003d7b6aae84aa9b70d64f464e70dfc_icgraph">
<area shape="rect" title=" " alt="" coords="1224,53,1403,94"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,23,1176,65"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1030,89,1139,116"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,5,945,32"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,56,940,83"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,5,719,32"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,5,520,32"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="a0040cee9c1580bba0c7d61a63494c04a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0040cee9c1580bba0c7d61a63494c04a">&#9670;&nbsp;</a></span>nested_svm_virtualize_tpr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool nested_svm_virtualize_tpr </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00569">569</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;{</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp; V_INTR_MASKING_MASK);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a2c5d9afb37c1ab54586cdcf478b417c2"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">vmcb_ctrl_area_cached::int_ctl</a></div><div class="ttdeci">u32 int_ctl</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00134">svm.h:134</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a0040cee9c1580bba0c7d61a63494c04a_cgraph.png" border="0" usemap="#asvm_8h_a0040cee9c1580bba0c7d61a63494c04a_cgraph" alt=""/></div>
<map name="asvm_8h_a0040cee9c1580bba0c7d61a63494c04a_cgraph" id="asvm_8h_a0040cee9c1580bba0c7d61a63494c04a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,200,57"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="248,5,368,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="273,56,343,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a0040cee9c1580bba0c7d61a63494c04a_icgraph.png" border="0" usemap="#asvm_8h_a0040cee9c1580bba0c7d61a63494c04a_icgraph" alt=""/></div>
<map name="asvm_8h_a0040cee9c1580bba0c7d61a63494c04a_icgraph" id="asvm_8h_a0040cee9c1580bba0c7d61a63494c04a_icgraph">
<area shape="rect" title=" " alt="" coords="412,56,607,83"/>
<area shape="rect" href="svm_8c.html#aa30e5cb5ad1759988fc349bd703bd4dc" title=" " alt="" coords="169,5,364,32"/>
<area shape="rect" href="svm_8c.html#a640846de1c48f3e408644fcb85a6004b" title=" " alt="" coords="198,56,335,83"/>
<area shape="rect" href="svm_8c.html#ac7f791888ec3548c8fa076367bbc84d9" title=" " alt="" coords="198,107,335,133"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,81,121,108"/>
</map>
</div>

</div>
</div>
<a id="a73d1cb9b9fcfa112138681d9080a1c05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73d1cb9b9fcfa112138681d9080a1c05">&#9670;&nbsp;</a></span>nested_svm_vmexit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nested_svm_vmexit </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l00967">967</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;{</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb01 = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb02 = svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb12;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keyword">struct </span>kvm_host_map map;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    rc = <a class="code" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9">kvm_vcpu_map</a>(vcpu, gpa_to_gfn(svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a16894147af263784cff5f93602e97a54">vmcb12_gpa</a>), &amp;map);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">if</span> (rc) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keywordflow">if</span> (rc == -EINVAL)</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            kvm_inject_gp(vcpu, 0);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    }</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    vmcb12 = map.hva;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">/* Exit Guest-Mode */</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <a class="code" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3">leave_guest_mode</a>(vcpu);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a16894147af263784cff5f93602e97a54">vmcb12_gpa</a> = 0;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    WARN_ON_ONCE(svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">nested_run_pending</a>);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    kvm_clear_request(KVM_REQ_GET_NESTED_STATE_PAGES, vcpu);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">/* in case we halted in L2 */</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.mp_state = KVM_MP_STATE_RUNNABLE;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">/* Give the current vmcb to the guest */</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    vmcb12-&gt;save.es     = vmcb02-&gt;save.es;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    vmcb12-&gt;save.cs     = vmcb02-&gt;save.cs;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    vmcb12-&gt;save.ss     = vmcb02-&gt;save.ss;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    vmcb12-&gt;save.ds     = vmcb02-&gt;save.ds;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    vmcb12-&gt;save.gdtr   = vmcb02-&gt;save.gdtr;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    vmcb12-&gt;save.idtr   = vmcb02-&gt;save.idtr;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    vmcb12-&gt;save.efer   = svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.efer;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    vmcb12-&gt;save.cr0    = <a class="code" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff">kvm_read_cr0</a>(vcpu);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    vmcb12-&gt;save.cr3    = <a class="code" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378">kvm_read_cr3</a>(vcpu);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    vmcb12-&gt;save.cr2    = vmcb02-&gt;save.cr2;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    vmcb12-&gt;save.cr4    = svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.cr4;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    vmcb12-&gt;save.rflags = <a class="code" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c">kvm_get_rflags</a>(vcpu);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    vmcb12-&gt;save.rip    = <a class="code" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446">kvm_rip_read</a>(vcpu);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    vmcb12-&gt;save.rsp    = <a class="code" href="kvm__cache__regs_8h.html#a30f9ca7e6fd08d1cf123f57fbfba01c7">kvm_rsp_read</a>(vcpu);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    vmcb12-&gt;save.rax    = kvm_rax_read(vcpu);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    vmcb12-&gt;save.dr7    = vmcb02-&gt;save.dr7;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    vmcb12-&gt;save.dr6    = svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.dr6;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    vmcb12-&gt;save.cpl    = vmcb02-&gt;save.cpl;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    vmcb12-&gt;control.int_state         = vmcb02-&gt;control.int_state;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    vmcb12-&gt;control.exit_code         = vmcb02-&gt;control.exit_code;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    vmcb12-&gt;control.exit_code_hi      = vmcb02-&gt;control.exit_code_hi;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    vmcb12-&gt;control.exit_info_1       = vmcb02-&gt;control.exit_info_1;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    vmcb12-&gt;control.exit_info_2       = vmcb02-&gt;control.exit_info_2;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">if</span> (vmcb12-&gt;control.exit_code != SVM_EXIT_ERR)</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <a class="code" href="svm_2nested_8c.html#a5b731f64682240fd51bd242f194b33f4">nested_save_pending_event_to_vmcb12</a>(svm, vmcb12);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(vcpu, X86_FEATURE_NRIPS))</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        vmcb12-&gt;control.next_rip  = vmcb02-&gt;control.next_rip;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    vmcb12-&gt;control.int_ctl           = svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    vmcb12-&gt;control.event_inj         = svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2fba54766e16cab5897765ffdb4ea134">event_inj</a>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    vmcb12-&gt;control.event_inj_err     = svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a663499717208b2803e3a33b4d19929b7">event_inj_err</a>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#ab226ac0135835109146350d5db3d4031">kvm_pause_in_guest</a>(vcpu-&gt;kvm)) {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        vmcb01-&gt;control.pause_filter_count = vmcb02-&gt;control.pause_filter_count;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(vmcb01, <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a>);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <a class="code" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f">nested_svm_copy_common_state</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <a class="code" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a>(svm, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">     * Rules for synchronizing int_ctl bits from vmcb02 to vmcb01:</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">     * V_IRQ, V_IRQ_VECTOR, V_INTR_PRIO_MASK, V_IGN_TPR:  If L1 doesn&#39;t</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">     * intercept interrupts, then KVM will use vmcb02&#39;s V_IRQ (and related</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">     * flags) to detect interrupt windows for L1 IRQs (even if L1 uses</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">     * virtual interrupt masking).  Raise KVM_REQ_EVENT to ensure that</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">     * KVM re-requests an interrupt window if necessary, which implicitly</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">     * copies this bits from vmcb02 to vmcb01.</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">     * V_TPR: If L1 doesn&#39;t use virtual interrupt masking, then L1&#39;s vTPR</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">     * is stored in vmcb02, but its value doesn&#39;t need to be copied from/to</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">     * vmcb01 because it is copied from/to the virtual APIC&#39;s TPR register</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">     * on each VM entry/exit.</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">     * V_GIF: If nested vGIF is not used, KVM uses vmcb02&#39;s V_GIF for L1&#39;s</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">     * V_GIF.  However, GIF is architecturally clear on each VM exit, thus</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">     * there is no need to copy V_GIF from vmcb02 to vmcb01.</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141">nested_exit_on_intr</a>(svm))</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        kvm_make_request(KVM_REQ_EVENT, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">if</span> (unlikely(<a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(vcpu, X86_FEATURE_LBRV) &amp;&amp;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;             (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a7c13a2a3665942eb4cc17fc335c4185f">virt_ext</a> &amp; LBR_CTL_ENABLE_MASK))) {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <a class="code" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84">svm_copy_lbrs</a>(vmcb12, vmcb02);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <a class="code" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef">svm_update_lbrv</a>(vcpu);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (unlikely(vmcb01-&gt;control.virt_ext &amp; LBR_CTL_ENABLE_MASK)) {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <a class="code" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84">svm_copy_lbrs</a>(vmcb01, vmcb02);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <a class="code" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef">svm_update_lbrv</a>(vcpu);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a>) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">if</span> (vmcb02-&gt;control.int_ctl &amp; V_NMI_BLOCKING_MASK)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            vmcb01-&gt;control.int_ctl |= V_NMI_BLOCKING_MASK;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            vmcb01-&gt;control.int_ctl &amp;= ~V_NMI_BLOCKING_MASK;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="keywordflow">if</span> (vcpu-&gt;arch.nmi_pending) {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            vcpu-&gt;arch.nmi_pending--;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            vmcb01-&gt;control.int_ctl |= V_NMI_PENDING_MASK;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            vmcb01-&gt;control.int_ctl &amp;= ~V_NMI_PENDING_MASK;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">     * On vmexit the  GIF is set to false and</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">     * no event can be injected in L1.</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <a class="code" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a>(svm, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    vmcb01-&gt;control.exit_int_info = 0;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.tsc_offset = svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.l1_tsc_offset;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">if</span> (vmcb01-&gt;control.tsc_offset != svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.tsc_offset) {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        vmcb01-&gt;control.tsc_offset = svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.tsc_offset;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(vmcb01, <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a>);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structkvm__caps.html">kvm_caps</a>.<a class="code" href="structkvm__caps.html#abcc6bf2008df1844dba6d861c15712a7">has_tsc_control</a> &amp;&amp;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        vcpu-&gt;arch.tsc_scaling_ratio != vcpu-&gt;arch.l1_tsc_scaling_ratio) {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        vcpu-&gt;arch.tsc_scaling_ratio = vcpu-&gt;arch.l1_tsc_scaling_ratio;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <a class="code" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943">svm_write_tsc_multiplier</a>(vcpu);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#af43b324bc739858a84ac026b6c5ef15f">nested_cr3</a> = 0;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">     * Restore processor state that had been saved in vmcb01</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <a class="code" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110">kvm_set_rflags</a>(vcpu, vmcb01-&gt;save.rflags);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726">svm_set_efer</a>(vcpu, vmcb01-&gt;save.efer);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d">svm_set_cr0</a>(vcpu, vmcb01-&gt;save.cr0 | X86_CR0_PE);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <a class="code" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109">svm_set_cr4</a>(vcpu, vmcb01-&gt;save.cr4);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    kvm_rax_write(vcpu, vmcb01-&gt;save.rax);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633">kvm_rsp_write</a>(vcpu, vmcb01-&gt;save.rsp);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <a class="code" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f">kvm_rip_write</a>(vcpu, vmcb01-&gt;save.rip);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.dr7 = DR7_FIXED_1;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a">kvm_update_dr7</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    trace_kvm_nested_vmexit_inject(vmcb12-&gt;control.exit_code,</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                       vmcb12-&gt;control.exit_info_1,</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                       vmcb12-&gt;control.exit_info_2,</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                       vmcb12-&gt;control.exit_int_info,</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                       vmcb12-&gt;control.exit_int_info_err,</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                       <a class="code" href="trace_8h.html#a4d128aa094f6d97def671922abd09d29">KVM_ISA_SVM</a>);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <a class="code" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155">kvm_vcpu_unmap</a>(vcpu, &amp;map, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <a class="code" href="svm_2nested_8c.html#af381358fd9991ce7d26d81fdb9f763a9">nested_svm_transition_tlb_flush</a>(vcpu);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <a class="code" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53">nested_svm_uninit_mmu_context</a>(vcpu);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    rc = <a class="code" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab">nested_svm_load_cr3</a>(vcpu, vmcb01-&gt;save.cr3, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordflow">if</span> (rc)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">     * Drop what we picked up for L2 via svm_complete_interrupts() so it</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">     * doesn&#39;t end up in L1.</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.nmi_injected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <a class="code" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4">kvm_clear_exception_queue</a>(vcpu);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160">kvm_clear_interrupt_queue</a>(vcpu);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">     * If we are here following the completion of a VMRUN that</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">     * is being single-stepped, queue the pending #DB intercept</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">     * right now so that it an be accounted for before we execute</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">     * L1&#39;s next instruction.</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keywordflow">if</span> (unlikely(vmcb01-&gt;save.rflags &amp; X86_EFLAGS_TF))</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <a class="code" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a>(&amp;(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>), DB_VECTOR);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">     * Un-inhibit the AVIC right away, so that other vCPUs can start</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">     * to benefit from it right away.</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a">kvm_apicv_activated</a>(vcpu-&gt;kvm))</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <a class="code" href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73">__kvm_vcpu_update_apicv</a>(vcpu);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;}</div>
<div class="ttc" id="acpuid_8h_html_acf67f5848a2ddd59dc852e37bc330390"><div class="ttname"><a href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a></div><div class="ttdeci">static __always_inline bool guest_can_use(struct kvm_vcpu *vcpu, unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00278">cpuid.h:278</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_a30f9ca7e6fd08d1cf123f57fbfba01c7"><div class="ttname"><a href="kvm__cache__regs_8h.html#a30f9ca7e6fd08d1cf123f57fbfba01c7">kvm_rsp_read</a></div><div class="ttdeci">static unsigned long kvm_rsp_read(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00126">kvm_cache_regs.h:126</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_a66188c5384cbd688acd880f8de16fbff"><div class="ttname"><a href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff">kvm_read_cr0</a></div><div class="ttdeci">static ulong kvm_read_cr0(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00168">kvm_cache_regs.h:168</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_aa70071fd3a98f236b0b57a30cbec124f"><div class="ttname"><a href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f">kvm_rip_write</a></div><div class="ttdeci">static void kvm_rip_write(struct kvm_vcpu *vcpu, unsigned long val)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00121">kvm_cache_regs.h:121</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_aa80de2ba11d877ef825788b0c9768378"><div class="ttname"><a href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378">kvm_read_cr3</a></div><div class="ttdeci">static ulong kvm_read_cr3(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00190">kvm_cache_regs.h:190</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_ac3d05504b537edf79951e929f6d76633"><div class="ttname"><a href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633">kvm_rsp_write</a></div><div class="ttdeci">static void kvm_rsp_write(struct kvm_vcpu *vcpu, unsigned long val)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00131">kvm_cache_regs.h:131</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_ad97ff6b975b461b815e6749d29c65446"><div class="ttname"><a href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446">kvm_rip_read</a></div><div class="ttdeci">static unsigned long kvm_rip_read(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00116">kvm_cache_regs.h:116</a></div></div>
<div class="ttc" id="akvm__cache__regs_8h_html_aeca9aaff776c6158999d08d88e93e9a3"><div class="ttname"><a href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3">leave_guest_mode</a></div><div class="ttdeci">static void leave_guest_mode(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00214">kvm_cache_regs.h:214</a></div></div>
<div class="ttc" id="akvm__main_8c_html_a96c7b38454f962b34da813b043f4abe9"><div class="ttname"><a href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9">kvm_vcpu_map</a></div><div class="ttdeci">int kvm_vcpu_map(struct kvm_vcpu *vcpu, gfn_t gfn, struct kvm_host_map *map)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l03152">kvm_main.c:3152</a></div></div>
<div class="ttc" id="akvm__main_8c_html_af9a24e7d30a38de04326c683ebc6a155"><div class="ttname"><a href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155">kvm_vcpu_unmap</a></div><div class="ttdeci">void kvm_vcpu_unmap(struct kvm_vcpu *vcpu, struct kvm_host_map *map, bool dirty)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l03186">kvm_main.c:3186</a></div></div>
<div class="ttc" id="astructkvm__caps_html"><div class="ttname"><a href="structkvm__caps.html">kvm_caps</a></div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00012">x86.h:12</a></div></div>
<div class="ttc" id="astructkvm__caps_html_abcc6bf2008df1844dba6d861c15712a7"><div class="ttname"><a href="structkvm__caps.html#abcc6bf2008df1844dba6d861c15712a7">kvm_caps::has_tsc_control</a></div><div class="ttdeci">bool has_tsc_control</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00014">x86.h:14</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a32951ee4dfbf17d414fcdad2d336b25b"><div class="ttname"><a href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">svm_nested_state::nested_run_pending</a></div><div class="ttdeci">bool nested_run_pending</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00170">svm.h:170</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a2fba54766e16cab5897765ffdb4ea134"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a2fba54766e16cab5897765ffdb4ea134">vmcb_ctrl_area_cached::event_inj</a></div><div class="ttdeci">u32 event_inj</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00144">svm.h:144</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a663499717208b2803e3a33b4d19929b7"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a663499717208b2803e3a33b4d19929b7">vmcb_ctrl_area_cached::event_inj_err</a></div><div class="ttdeci">u32 event_inj_err</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00145">svm.h:145</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a7c13a2a3665942eb4cc17fc335c4185f"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a7c13a2a3665942eb4cc17fc335c4185f">vmcb_ctrl_area_cached::virt_ext</a></div><div class="ttdeci">u64 virt_ext</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00148">svm.h:148</a></div></div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_af43b324bc739858a84ac026b6c5ef15f"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#af43b324bc739858a84ac026b6c5ef15f">vmcb_ctrl_area_cached::nested_cr3</a></div><div class="ttdeci">u64 nested_cr3</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00147">svm.h:147</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a10ef7b4561f5f7773d13cbd00fa7db53"><div class="ttname"><a href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53">nested_svm_uninit_mmu_context</a></div><div class="ttdeci">static void nested_svm_uninit_mmu_context(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00102">nested.c:102</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a5b731f64682240fd51bd242f194b33f4"><div class="ttname"><a href="svm_2nested_8c.html#a5b731f64682240fd51bd242f194b33f4">nested_save_pending_event_to_vmcb12</a></div><div class="ttdeci">static void nested_save_pending_event_to_vmcb12(struct vcpu_svm *svm, struct vmcb *vmcb12)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00448">nested.c:448</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_af381358fd9991ce7d26d81fdb9f763a9"><div class="ttname"><a href="svm_2nested_8c.html#af381358fd9991ce7d26d81fdb9f763a9">nested_svm_transition_tlb_flush</a></div><div class="ttdeci">static void nested_svm_transition_tlb_flush(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00481">nested.c:481</a></div></div>
<div class="ttc" id="asvm_8c_html_a06d8a6a899d49f3235ec1294d1943c84"><div class="ttname"><a href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84">svm_copy_lbrs</a></div><div class="ttdeci">void svm_copy_lbrs(struct vmcb *to_vmcb, struct vmcb *from_vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00982">svm.c:982</a></div></div>
<div class="ttc" id="asvm_8c_html_a1a9474f1273be079ac4f3c1320093c3d"><div class="ttname"><a href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d">svm_set_cr0</a></div><div class="ttdeci">void svm_set_cr0(struct kvm_vcpu *vcpu, unsigned long cr0)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01852">svm.c:1852</a></div></div>
<div class="ttc" id="asvm_8c_html_a5df90c8772700a60441f2ba19472f726"><div class="ttname"><a href="svm_8c.html#a5df90c8772700a60441f2ba19472f726">svm_set_efer</a></div><div class="ttdeci">int svm_set_efer(struct kvm_vcpu *vcpu, u64 efer)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00296">svm.c:296</a></div></div>
<div class="ttc" id="asvm_8c_html_a8d0afd60cabe4ff8b40d7099f49a1bb8"><div class="ttname"><a href="svm_8c.html#a8d0afd60cabe4ff8b40d7099f49a1bb8">vnmi</a></div><div class="ttdeci">bool vnmi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00238">svm.c:238</a></div></div>
<div class="ttc" id="asvm_8c_html_ad5aa214e23ea9ec9418bebbe889d41ef"><div class="ttname"><a href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef">svm_update_lbrv</a></div><div class="ttdeci">void svm_update_lbrv(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01037">svm.c:1037</a></div></div>
<div class="ttc" id="asvm_8c_html_aec23ca96447aab4ff19f594a297bc109"><div class="ttname"><a href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109">svm_set_cr4</a></div><div class="ttdeci">void svm_set_cr4(struct kvm_vcpu *vcpu, unsigned long cr4)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01914">svm.c:1914</a></div></div>
<div class="ttc" id="asvm_8h_html_a13cbed806a9638fcaab4d01cb926d141"><div class="ttname"><a href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141">nested_exit_on_intr</a></div><div class="ttdeci">static bool nested_exit_on_intr(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00581">svm.h:581</a></div></div>
<div class="ttc" id="ax86_8c_html_a12826c3f941e4dbf381d4d085ce42110"><div class="ttname"><a href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110">kvm_set_rflags</a></div><div class="ttdeci">void kvm_set_rflags(struct kvm_vcpu *vcpu, unsigned long rflags)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13189">x86.c:13189</a></div></div>
<div class="ttc" id="ax86_8c_html_a87cedb0953e919148694dd8b06c9cb73"><div class="ttname"><a href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73">__kvm_vcpu_update_apicv</a></div><div class="ttdeci">void __kvm_vcpu_update_apicv(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l10525">x86.c:10525</a></div></div>
<div class="ttc" id="ax86_8c_html_aeca964de04721f39e3ec34f195707b5c"><div class="ttname"><a href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c">kvm_get_rflags</a></div><div class="ttdeci">unsigned long kvm_get_rflags(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13170">x86.c:13170</a></div></div>
<div class="ttc" id="ax86_8c_html_afed36c545d27cca59caddf31fdfd054a"><div class="ttname"><a href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a">kvm_update_dr7</a></div><div class="ttdeci">void kvm_update_dr7(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l01346">x86.c:1346</a></div></div>
<div class="ttc" id="ax86_8h_html_a9dbf3d5bc7a0735443e0e21e00802160"><div class="ttname"><a href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160">kvm_clear_interrupt_queue</a></div><div class="ttdeci">static void kvm_clear_interrupt_queue(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00122">x86.h:122</a></div></div>
<div class="ttc" id="ax86_8h_html_ab226ac0135835109146350d5db3d4031"><div class="ttname"><a href="x86_8h.html#ab226ac0135835109146350d5db3d4031">kvm_pause_in_guest</a></div><div class="ttdeci">static bool kvm_pause_in_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00419">x86.h:419</a></div></div>
<div class="ttc" id="ax86_8h_html_acdc826b0cd2ce8b958a826c8faa306b4"><div class="ttname"><a href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4">kvm_clear_exception_queue</a></div><div class="ttdeci">static void kvm_clear_exception_queue(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00107">x86.h:107</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a73d1cb9b9fcfa112138681d9080a1c05_cgraph.png" border="0" usemap="#asvm_8h_a73d1cb9b9fcfa112138681d9080a1c05_cgraph" alt=""/></div>
<map name="asvm_8h_a73d1cb9b9fcfa112138681d9080a1c05_cgraph" id="asvm_8h_a73d1cb9b9fcfa112138681d9080a1c05_cgraph">
<area shape="rect" title=" " alt="" coords="5,999,160,1025"/>
<area shape="rect" href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73" title=" " alt="" coords="211,107,408,133"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="499,999,617,1025"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="229,233,390,260"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="229,285,390,326"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="233,350,386,391"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="248,416,371,443"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="230,467,389,493"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="225,183,394,209"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="252,669,367,696"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="501,529,615,556"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="254,568,365,595"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="252,720,367,747"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a30f9ca7e6fd08d1cf123f57fbfba01c7" title=" " alt="" coords="252,619,367,645"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633" title=" " alt="" coords="250,771,369,797"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="249,821,370,848"/>
<area shape="rect" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a" title=" " alt="" coords="244,923,375,949"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="247,872,372,899"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="239,1491,380,1517"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="237,1075,382,1101"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="234,1125,385,1152"/>
<area shape="rect" href="svm_2nested_8c.html#a5b731f64682240fd51bd242f194b33f4" title=" " alt="" coords="228,1177,391,1218"/>
<area shape="rect" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f" title=" " alt="" coords="208,1242,411,1283"/>
<area shape="rect" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab" title=" " alt="" coords="228,1308,391,1335"/>
<area shape="rect" href="svm_2nested_8c.html#af381358fd9991ce7d26d81fdb9f763a9" title=" " alt="" coords="224,1359,395,1401"/>
<area shape="rect" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53" title=" " alt="" coords="216,1425,403,1466"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="499,1541,617,1568"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="734,1643,870,1669"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="257,1643,361,1669"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="506,1693,610,1720"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="254,1744,365,1771"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="507,1820,609,1847"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="238,1795,381,1821"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="242,973,377,1000"/>
<area shape="rect" href="svm_8c.html#ad9a1b45b05505f9435cc2d1dd1c37943" title=" " alt="" coords="216,1896,403,1923"/>
<area shape="rect" href="lapic_8c.html#a5468339c2df08ca538b77d4d48915c35" title=" " alt="" coords="469,5,647,32"/>
<area shape="rect" href="x86_8c.html#a8415cd1d2d30e65d505adb5ba75a0338" title=" " alt="" coords="479,56,637,83"/>
<area shape="rect" href="x86_8c.html#ade52ab1bf2b3d66def1c4851fab08c45" title=" " alt="" coords="459,107,657,133"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="499,157,617,184"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="947,991,1120,1033"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="707,973,897,1000"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="467,208,649,235"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="485,663,631,689"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="705,587,899,613"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="471,587,645,613"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5117377174dc7ebf722e4976c0ae736b" title=" " alt="" coords="469,745,647,772"/>
<area shape="rect" href="x86_8c.html#a02687f1819d3a24cafdda1660be6ec9b" title=" " alt="" coords="491,821,625,848"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="513,872,603,899"/>
<area shape="rect" href="kvm__main_8c.html#a6f9056f6dc868b557b2a2c8e1c548762" title=" " alt="" coords="491,1424,625,1451"/>
<area shape="rect" href="kvm__main_8c.html#ab3f118170e5a0cf30913bc0cd0a79cfd" title=" " alt="" coords="473,1475,643,1517"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a73d1cb9b9fcfa112138681d9080a1c05_icgraph.png" border="0" usemap="#asvm_8h_a73d1cb9b9fcfa112138681d9080a1c05_icgraph" alt=""/></div>
<map name="asvm_8h_a73d1cb9b9fcfa112138681d9080a1c05_icgraph" id="asvm_8h_a73d1cb9b9fcfa112138681d9080a1c05_icgraph">
<area shape="rect" title=" " alt="" coords="1732,281,1887,308"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,85,1673,112"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,303,1684,345"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,197,1679,224"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,252,719,279"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,369,1679,396"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,421,1668,462"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,107,1399,149"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,5,1403,32"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,56,1389,83"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,108,1144,135"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,100,939,127"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,311,1421,337"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,186,1408,227"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,186,1176,227"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,201,945,228"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,151,940,177"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,281,520,308"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,336,323,363"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,336,128,363"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,412,1412,439"/>
</map>
</div>

</div>
</div>
<a id="a4ec7e878f6af209e74dd84285ee0198f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ec7e878f6af209e74dd84285ee0198f">&#9670;&nbsp;</a></span>nested_svm_vmrun()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nested_svm_vmrun </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l00837">837</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;{</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb12;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keyword">struct </span>kvm_host_map map;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    u64 vmcb12_gpa;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb01 = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">if</span> (!svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#abb9c6243e2a90048413ab9d68a450e45">hsave_msr</a>) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        kvm_inject_gp(vcpu, 0);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67">is_smm</a>(vcpu)) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <a class="code" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2">kvm_queue_exception</a>(vcpu, UD_VECTOR);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">/* This fails when VP assist page is enabled but the supplied GPA is bogus */</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    ret = <a class="code" href="hyperv_8h.html#a2ff068b2830d40b54df6cf8bad14e171">kvm_hv_verify_vp_assist</a>(vcpu);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">if</span> (ret) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        kvm_inject_gp(vcpu, 0);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    vmcb12_gpa = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.rax;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    ret = <a class="code" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9">kvm_vcpu_map</a>(vcpu, gpa_to_gfn(vmcb12_gpa), &amp;map);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">if</span> (ret == -EINVAL) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        kvm_inject_gp(vcpu, 0);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a>(vcpu);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    ret = <a class="code" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a>(vcpu);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    vmcb12 = map.hva;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">if</span> (WARN_ON_ONCE(!svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a280879c3a0fa081ac14507bec27f0727">initialized</a>))</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <a class="code" href="svm_2nested_8c.html#add5ee1e85234f2457480494694865c21">nested_copy_vmcb_control_to_cache</a>(svm, &amp;vmcb12-&gt;control);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <a class="code" href="svm_2nested_8c.html#ae052404bed168cf69c578a697ce25526">nested_copy_vmcb_save_to_cache</a>(svm, &amp;vmcb12-&gt;save);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_2nested_8c.html#ae732aef70a2e3611917e028d9ec42ace">nested_vmcb_check_save</a>(vcpu) ||</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        !<a class="code" href="svm_2nested_8c.html#aeb4d38d47572db12942883495b996356">nested_vmcb_check_controls</a>(vcpu)) {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        vmcb12-&gt;control.exit_code    = SVM_EXIT_ERR;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        vmcb12-&gt;control.exit_code_hi = 0;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        vmcb12-&gt;control.exit_info_1  = 0;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        vmcb12-&gt;control.exit_info_2  = 0;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">     * Since vmcb01 is not in use, we can use it to store some of the L1</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">     * state.</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    vmcb01-&gt;save.efer   = vcpu-&gt;arch.efer;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    vmcb01-&gt;save.cr0    = <a class="code" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff">kvm_read_cr0</a>(vcpu);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    vmcb01-&gt;save.cr4    = vcpu-&gt;arch.cr4;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    vmcb01-&gt;save.rflags = <a class="code" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c">kvm_get_rflags</a>(vcpu);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    vmcb01-&gt;save.rip    = <a class="code" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446">kvm_rip_read</a>(vcpu);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        vmcb01-&gt;save.cr3 = <a class="code" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378">kvm_read_cr3</a>(vcpu);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">nested_run_pending</a> = 1;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e">enter_svm_guest_mode</a>(vcpu, vmcb12_gpa, vmcb12, <span class="keyword">true</span>))</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">goto</span> out_exit_err;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_2nested_8c.html#a3c235b4ddb7200e464cacf8dfb3b4f00">nested_svm_vmrun_msrpm</a>(svm))</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;out_exit_err:</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">nested_run_pending</a> = 0;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">nmi_l1_to_l2</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">soft_int_injected</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code    = SVM_EXIT_ERR;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_code_hi = 0;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_1  = 0;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2  = 0;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <a class="code" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05">nested_svm_vmexit</a>(svm);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;out:</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <a class="code" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155">kvm_vcpu_unmap</a>(vcpu, &amp;map, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;}</div>
<div class="ttc" id="ahyperv_8h_html_a2ff068b2830d40b54df6cf8bad14e171"><div class="ttname"><a href="hyperv_8h.html#a2ff068b2830d40b54df6cf8bad14e171">kvm_hv_verify_vp_assist</a></div><div class="ttdeci">static int kvm_hv_verify_vp_assist(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="hyperv_8h_source.html#l00316">hyperv.h:316</a></div></div>
<div class="ttc" id="asmm_8h_html_aa0d6bb14bef67edc441fccd36d205a67"><div class="ttname"><a href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67">is_smm</a></div><div class="ttdeci">static bool is_smm(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="smm_8h_source.html#l00160">smm.h:160</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_a280879c3a0fa081ac14507bec27f0727"><div class="ttname"><a href="structsvm__nested__state.html#a280879c3a0fa081ac14507bec27f0727">svm_nested_state::initialized</a></div><div class="ttdeci">bool initialized</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00181">svm.h:181</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_abb9c6243e2a90048413ab9d68a450e45"><div class="ttname"><a href="structsvm__nested__state.html#abb9c6243e2a90048413ab9d68a450e45">svm_nested_state::hsave_msr</a></div><div class="ttdeci">u64 hsave_msr</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00160">svm.h:160</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a5b467b57f59ac934189a11051dc5ac6d"><div class="ttname"><a href="structvcpu__svm.html#a5b467b57f59ac934189a11051dc5ac6d">vcpu_svm::nmi_l1_to_l2</a></div><div class="ttdeci">bool nmi_l1_to_l2</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00260">svm.h:260</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a7de61a9710589d6f3c286663fc51506e"><div class="ttname"><a href="structvcpu__svm.html#a7de61a9710589d6f3c286663fc51506e">vcpu_svm::soft_int_injected</a></div><div class="ttdeci">bool soft_int_injected</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00265">svm.h:265</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a3c235b4ddb7200e464cacf8dfb3b4f00"><div class="ttname"><a href="svm_2nested_8c.html#a3c235b4ddb7200e464cacf8dfb3b4f00">nested_svm_vmrun_msrpm</a></div><div class="ttdeci">static bool nested_svm_vmrun_msrpm(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00188">nested.c:188</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a9b21378a3de8baae9bcb689f00cad48e"><div class="ttname"><a href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e">enter_svm_guest_mode</a></div><div class="ttdeci">int enter_svm_guest_mode(struct kvm_vcpu *vcpu, u64 vmcb12_gpa, struct vmcb *vmcb12, bool from_vmrun)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00785">nested.c:785</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_add5ee1e85234f2457480494694865c21"><div class="ttname"><a href="svm_2nested_8c.html#add5ee1e85234f2457480494694865c21">nested_copy_vmcb_control_to_cache</a></div><div class="ttdeci">void nested_copy_vmcb_control_to_cache(struct vcpu_svm *svm, struct vmcb_control_area *control)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00382">nested.c:382</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_ae052404bed168cf69c578a697ce25526"><div class="ttname"><a href="svm_2nested_8c.html#ae052404bed168cf69c578a697ce25526">nested_copy_vmcb_save_to_cache</a></div><div class="ttdeci">void nested_copy_vmcb_save_to_cache(struct vcpu_svm *svm, struct vmcb_save_area *save)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00404">nested.c:404</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_ae732aef70a2e3611917e028d9ec42ace"><div class="ttname"><a href="svm_2nested_8c.html#ae732aef70a2e3611917e028d9ec42ace">nested_vmcb_check_save</a></div><div class="ttdeci">static bool nested_vmcb_check_save(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00319">nested.c:319</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_aeb4d38d47572db12942883495b996356"><div class="ttname"><a href="svm_2nested_8c.html#aeb4d38d47572db12942883495b996356">nested_vmcb_check_controls</a></div><div class="ttdeci">static bool nested_vmcb_check_controls(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00327">nested.c:327</a></div></div>
<div class="ttc" id="ax86_8c_html_aba69f77338abd9dcd861fd8921d5011a"><div class="ttname"><a href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a">kvm_skip_emulated_instruction</a></div><div class="ttdeci">int kvm_skip_emulated_instruction(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l08916">x86.c:8916</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a4ec7e878f6af209e74dd84285ee0198f_cgraph.png" border="0" usemap="#asvm_8h_a4ec7e878f6af209e74dd84285ee0198f_cgraph" alt=""/></div>
<map name="asvm_8h_a4ec7e878f6af209e74dd84285ee0198f_cgraph" id="asvm_8h_a4ec7e878f6af209e74dd84285ee0198f_cgraph">
<area shape="rect" title=" " alt="" coords="5,608,156,635"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="230,557,409,584"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="557,5,628,32"/>
<area shape="rect" href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67" title=" " alt="" coords="283,223,356,249"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="531,741,654,768"/>
<area shape="rect" href="hyperv_8h.html#a2ff068b2830d40b54df6cf8bad14e171" title=" " alt="" coords="226,324,413,351"/>
<area shape="rect" href="x86_8c.html#ac9502ee8f018301047c80e19ab79f7e2" title=" " alt="" coords="508,1481,677,1508"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a66188c5384cbd688acd880f8de16fbff" title=" " alt="" coords="535,1532,650,1559"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa80de2ba11d877ef825788b0c9768378" title=" " alt="" coords="535,1684,650,1711"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad97ff6b975b461b815e6749d29c65446" title=" " alt="" coords="537,1431,648,1457"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="204,375,435,401"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="530,1583,655,1609"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="522,1633,663,1660"/>
<area shape="rect" href="svm_2nested_8c.html#add5ee1e85234f2457480494694865c21" title=" " alt="" coords="220,426,419,467"/>
<area shape="rect" href="svm_2nested_8c.html#ae052404bed168cf69c578a697ce25526" title=" " alt="" coords="227,491,412,533"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="242,1071,397,1097"/>
<area shape="rect" href="svm_2nested_8c.html#a3c235b4ddb7200e464cacf8dfb3b4f00" title=" " alt="" coords="218,1324,421,1351"/>
<area shape="rect" href="svm_2nested_8c.html#aeb4d38d47572db12942883495b996356" title=" " alt="" coords="213,107,426,133"/>
<area shape="rect" href="svm_2nested_8c.html#ae732aef70a2e3611917e028d9ec42ace" title=" " alt="" coords="223,273,415,300"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="503,472,682,499"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="765,352,919,379"/>
<area shape="rect" href="svm_2nested_8c.html#adaebb1c261df8111105ce7566e7bb79f" title=" " alt="" coords="491,625,694,666"/>
<area shape="rect" href="svm_2hyperv_8h.html#a3983896ad03a4957172ab441f7182b9d" title=" " alt="" coords="505,341,681,382"/>
<area shape="rect" href="svm_2nested_8c.html#a2d996c5be366f0a7b21228fd18be85ab" title=" " alt="" coords="511,691,674,717"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="501,406,684,447"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="483,893,703,920"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="542,523,643,549"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="521,573,664,600"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="783,843,901,869"/>
<area shape="rect" href="x86_8h.html#ab226ac0135835109146350d5db3d4031" title=" " alt="" coords="763,567,921,593"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aa70071fd3a98f236b0b57a30cbec124f" title=" " alt="" coords="785,919,899,945"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ac3d05504b537edf79951e929f6d76633" title=" " alt="" coords="783,995,901,1021"/>
<area shape="rect" href="x86_8c.html#a12826c3f941e4dbf381d4d085ce42110" title=" " alt="" coords="781,1071,903,1097"/>
<area shape="rect" href="x86_8c.html#a9a6f9a3892e36b8251d551192dc20a6f" title=" " alt="" coords="751,1477,933,1504"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="769,1528,915,1555"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="981,1528,1175,1555"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5d9eb0563cffb1e3ed1cccebabcf2df6" title=" " alt="" coords="755,1427,929,1453"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="502,56,683,83"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="499,107,686,133"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="797,1579,887,1605"/>
<area shape="rect" href="kvm__main_8c.html#a6f9056f6dc868b557b2a2c8e1c548762" title=" " alt="" coords="775,1696,909,1723"/>
<area shape="rect" href="kvm__main_8c.html#ab3f118170e5a0cf30913bc0cd0a79cfd" title=" " alt="" coords="757,1630,927,1671"/>
<area shape="rect" href="svm_2nested_8c.html#a1fc7997959fb33b39415a12879645d2d" title=" " alt="" coords="512,158,673,199"/>
<area shape="rect" href="svm_2nested_8c.html#a5f775ed43f15dcd9b51601e16d13ba02" title=" " alt="" coords="512,223,673,265"/>
<area shape="rect" href="x86_8c.html#a87cedb0953e919148694dd8b06c9cb73" title=" " alt="" coords="494,1147,691,1173"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="512,1197,673,1224"/>
<area shape="rect" href="x86_8h.html#acdc826b0cd2ce8b958a826c8faa306b4" title=" " alt="" coords="512,1249,673,1290"/>
<area shape="rect" href="x86_8h.html#a9dbf3d5bc7a0735443e0e21e00802160" title=" " alt="" coords="516,1314,669,1355"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a30f9ca7e6fd08d1cf123f57fbfba01c7" title=" " alt="" coords="535,1380,650,1407"/>
<area shape="rect" href="x86_8c.html#afed36c545d27cca59caddf31fdfd054a" title=" " alt="" coords="527,995,658,1021"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a4ec7e878f6af209e74dd84285ee0198f_icgraph.png" border="0" usemap="#asvm_8h_a4ec7e878f6af209e74dd84285ee0198f_icgraph" alt=""/></div>
<map name="asvm_8h_a4ec7e878f6af209e74dd84285ee0198f_icgraph" id="asvm_8h_a4ec7e878f6af209e74dd84285ee0198f_icgraph">
<area shape="rect" title=" " alt="" coords="568,5,719,32"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,5,520,32"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="a232d9e4f1731f0d495e3b4f9d530d0ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a232d9e4f1731f0d495e3b4f9d530d0ee">&#9670;&nbsp;</a></span>nested_sync_control_from_vmcb02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nested_sync_control_from_vmcb02 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l00414">414</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    u32 mask;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2fba54766e16cab5897765ffdb4ea134">event_inj</a>      = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.event_inj;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a663499717208b2803e3a33b4d19929b7">event_inj_err</a>  = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.event_inj_err;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">/* Only a few fields of int_ctl are written by the processor.  */</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    mask = V_IRQ_MASK | V_TPR_MASK;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">     * Don&#39;t sync vmcb02 V_IRQ back to vmcb12 if KVM (L0) is intercepting</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">     * virtual interrupts in order to request an interrupt window, as KVM</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">     * has usurped vmcb02&#39;s int_ctl.  If an interrupt window opens before</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">     * the next VM-Exit, svm_clear_vintr() will restore vmcb12&#39;s int_ctl.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">     * If no window opens, V_IRQ will be correctly preserved in vmcb12&#39;s</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">     * int_ctl (because it was never recognized while L2 was running).</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a>(svm, INTERCEPT_VINTR) &amp;&amp;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        !test_bit(INTERCEPT_VINTR, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a1e877429e7fb02e17e8aec57274abca4">intercepts</a>))</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        mask &amp;= ~V_IRQ_MASK;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e">nested_vgif_enabled</a>(svm))</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        mask |= V_GIF_MASK;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#ab452fafde694bb5dfd7c6dfc5707ae12">nested_vnmi_enabled</a>(svm))</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        mask |= V_NMI_BLOCKING_MASK | V_NMI_PENDING_MASK;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a>        &amp;= ~mask;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a>        |= svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.int_ctl &amp; mask;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html_a1e877429e7fb02e17e8aec57274abca4"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html#a1e877429e7fb02e17e8aec57274abca4">vmcb_ctrl_area_cached::intercepts</a></div><div class="ttdeci">u32 intercepts[MAX_INTERCEPT]</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00126">svm.h:126</a></div></div>
<div class="ttc" id="asvm_8h_html_a397a88cd5af0b0bb8a9ef4a5e6bc849d"><div class="ttname"><a href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a></div><div class="ttdeci">static bool svm_is_intercept(struct vcpu_svm *svm, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00441">svm.h:441</a></div></div>
<div class="ttc" id="asvm_8h_html_ab452fafde694bb5dfd7c6dfc5707ae12"><div class="ttname"><a href="svm_8h.html#ab452fafde694bb5dfd7c6dfc5707ae12">nested_vnmi_enabled</a></div><div class="ttdeci">static bool nested_vnmi_enabled(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00498">svm.h:498</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a232d9e4f1731f0d495e3b4f9d530d0ee_cgraph.png" border="0" usemap="#asvm_8h_a232d9e4f1731f0d495e3b4f9d530d0ee_cgraph" alt=""/></div>
<map name="asvm_8h_a232d9e4f1731f0d495e3b4f9d530d0ee_cgraph" id="asvm_8h_a232d9e4f1731f0d495e3b4f9d530d0ee_cgraph">
<area shape="rect" title=" " alt="" coords="5,49,160,90"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="212,5,369,32"/>
<area shape="rect" href="svm_8h.html#ab452fafde694bb5dfd7c6dfc5707ae12" title=" " alt="" coords="208,56,373,83"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="224,107,357,133"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="433,31,551,57"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="849,23,1023,65"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="611,56,801,83"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="421,107,563,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a232d9e4f1731f0d495e3b4f9d530d0ee_icgraph.png" border="0" usemap="#asvm_8h_a232d9e4f1731f0d495e3b4f9d530d0ee_icgraph" alt=""/></div>
<map name="asvm_8h_a232d9e4f1731f0d495e3b4f9d530d0ee_icgraph" id="asvm_8h_a232d9e4f1731f0d495e3b4f9d530d0ee_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,324,47"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,13,121,39"/>
</map>
</div>

</div>
</div>
<a id="ad6d8c993934e650cf5366b9883c3628e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6d8c993934e650cf5366b9883c3628e">&#9670;&nbsp;</a></span>nested_vgif_enabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool nested_vgif_enabled </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00446">446</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;{</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_VGIF) &amp;&amp;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;           (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp; V_GIF_ENABLE_MASK);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad6d8c993934e650cf5366b9883c3628e_cgraph.png" border="0" usemap="#asvm_8h_ad6d8c993934e650cf5366b9883c3628e_cgraph" alt=""/></div>
<map name="asvm_8h_ad6d8c993934e650cf5366b9883c3628e_cgraph" id="asvm_8h_ad6d8c993934e650cf5366b9883c3628e_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,163,39"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="211,13,329,39"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="616,5,789,47"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="377,38,568,65"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad6d8c993934e650cf5366b9883c3628e_icgraph.png" border="0" usemap="#asvm_8h_ad6d8c993934e650cf5366b9883c3628e_icgraph" alt=""/></div>
<map name="asvm_8h_ad6d8c993934e650cf5366b9883c3628e_icgraph" id="asvm_8h_ad6d8c993934e650cf5366b9883c3628e_icgraph">
<area shape="rect" title=" " alt="" coords="2667,479,2824,505"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="2482,439,2601,465"/>
<area shape="rect" href="svm_2nested_8c.html#a232d9e4f1731f0d495e3b4f9d530d0ee" title=" " alt="" coords="2464,501,2619,542"/>
<area shape="rect" href="svm_8h.html#a711d42f525aa791008754514284a556c" title=" " alt="" coords="2311,352,2405,379"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="2313,428,2403,455"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="1813,661,1880,688"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="2151,301,2252,328"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="1972,327,2103,353"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,301,945,328"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1769,327,1924,353"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,21,940,48"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="1972,225,2103,252"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="1982,175,2093,201"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,377,719,404"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,403,520,429"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,428,323,455"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,428,128,455"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,225,1710,252"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,479,1721,521"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,79,1716,105"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,428,1717,455"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,159,1705,201"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,109,1437,150"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,175,1440,201"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,225,1427,252"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,116,1163,143"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,116,939,143"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,620,1459,647"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,43,1445,85"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,43,1195,85"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,428,1449,455"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,276,1213,303"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="2158,428,2245,455"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1973,428,2101,455"/>
<area shape="rect" href="svm_8c.html#aca7bf4b32b7e7a7cfa632783dd5e6fbf" title=" " alt="" coords="1535,545,1693,586"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="1523,611,1705,637"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="1519,661,1709,688"/>
<area shape="rect" href="svm_2nested_8c.html#a9fea5d164a414c66daa21a6514fc36d6" title=" " alt="" coords="1529,712,1699,739"/>
<area shape="rect" href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa" title=" " alt="" coords="1529,763,1699,789"/>
<area shape="rect" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e" title=" " alt="" coords="1545,813,1683,840"/>
<area shape="rect" href="svm_8c.html#a005049e4b080345fc3924233b8e33bce" title=" " alt="" coords="1275,763,1445,789"/>
<area shape="rect" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695" title=" " alt="" coords="1290,813,1430,840"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="2300,529,2416,556"/>
</map>
</div>

</div>
</div>
<a id="a5124cfade7c6ad2a6e136fdd0391f0a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5124cfade7c6ad2a6e136fdd0391f0a2">&#9670;&nbsp;</a></span>nested_vmcb02_compute_g_pat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nested_vmcb02_compute_g_pat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l00528">528</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;{</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">if</span> (!svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">/* FIXME: merge g_pat from vmcb01 and vmcb12.  */</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.g_pat = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.g_pat;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a5124cfade7c6ad2a6e136fdd0391f0a2_icgraph.png" border="0" usemap="#asvm_8h_a5124cfade7c6ad2a6e136fdd0391f0a2_icgraph" alt=""/></div>
<map name="asvm_8h_a5124cfade7c6ad2a6e136fdd0391f0a2_icgraph" id="asvm_8h_a5124cfade7c6ad2a6e136fdd0391f0a2_icgraph">
<area shape="rect" title=" " alt="" coords="1261,23,1451,65"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,5,1213,32"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1049,56,1158,83"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,5,945,32"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,5,719,32"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,5,520,32"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="ab452fafde694bb5dfd7c6dfc5707ae12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab452fafde694bb5dfd7c6dfc5707ae12">&#9670;&nbsp;</a></span>nested_vnmi_enabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool nested_vnmi_enabled </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00498">498</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;{</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_VNMI) &amp;&amp;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;           (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp; V_NMI_ENABLE_MASK);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ab452fafde694bb5dfd7c6dfc5707ae12_cgraph.png" border="0" usemap="#asvm_8h_ab452fafde694bb5dfd7c6dfc5707ae12_cgraph" alt=""/></div>
<map name="asvm_8h_ab452fafde694bb5dfd7c6dfc5707ae12_cgraph" id="asvm_8h_ab452fafde694bb5dfd7c6dfc5707ae12_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,171,39"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="219,13,337,39"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="624,5,797,47"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="385,38,576,65"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ab452fafde694bb5dfd7c6dfc5707ae12_icgraph.png" border="0" usemap="#asvm_8h_ab452fafde694bb5dfd7c6dfc5707ae12_icgraph" alt=""/></div>
<map name="asvm_8h_ab452fafde694bb5dfd7c6dfc5707ae12_icgraph" id="asvm_8h_ab452fafde694bb5dfd7c6dfc5707ae12_icgraph">
<area shape="rect" title=" " alt="" coords="1224,46,1389,73"/>
<area shape="rect" href="svm_2nested_8c.html#a232d9e4f1731f0d495e3b4f9d530d0ee" title=" " alt="" coords="1007,5,1162,47"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,71,1176,112"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="798,13,914,39"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,70,945,97"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,121,940,147"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,70,719,97"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,70,520,97"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,70,323,97"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,70,128,97"/>
</map>
</div>

</div>
</div>
<a id="ad0a040a48a04ab47d0af3385ad214cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0a040a48a04ab47d0af3385ad214cd4">&#9670;&nbsp;</a></span>pre_sev_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pre_sev_run </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cpu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02646">2646</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;{</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsvm__cpu__data.html">svm_cpu_data</a> *sd = per_cpu_ptr(&amp;svm_data, cpu);</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> asid = <a class="code" href="sev_8c.html#a66cc6caa9f6331de794476e911d4ce53">sev_get_asid</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.kvm);</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160; </div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <span class="comment">/* Assign the asid allocated with this SEV guest */</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a7c494fa07f9ddd95637bb1061808402e">asid</a> = asid;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160; </div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="comment">     * Flush guest TLB:</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="comment">     * 1) when different VMCB for the same ASID is to be run on the same host CPU.</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="comment">     * 2) or this VMCB was executed on different host CPU in previous VMRUNs.</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="structsvm__cpu__data.html#af89c94b4ad75ed4396bb2f85415fcf38">sev_vmcbs</a>[asid] == svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a> &amp;&amp;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.last_vmentry_cpu == cpu)</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160; </div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#af89c94b4ad75ed4396bb2f85415fcf38">sev_vmcbs</a>[asid] = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.tlb_ctl = TLB_CONTROL_FLUSH_ASID;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13ace538c75028034c3e121fd96a0bdaf64">VMCB_ASID</a>);</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a66cc6caa9f6331de794476e911d4ce53"><div class="ttname"><a href="sev_8c.html#a66cc6caa9f6331de794476e911d4ce53">sev_get_asid</a></div><div class="ttdeci">static unsigned int sev_get_asid(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00197">sev.c:197</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html"><div class="ttname"><a href="structsvm__cpu__data.html">svm_cpu_data</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00297">svm.h:297</a></div></div>
<div class="ttc" id="astructsvm__cpu__data_html_af89c94b4ad75ed4396bb2f85415fcf38"><div class="ttname"><a href="structsvm__cpu__data.html#af89c94b4ad75ed4396bb2f85415fcf38">svm_cpu_data::sev_vmcbs</a></div><div class="ttdeci">struct vmcb ** sev_vmcbs</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00309">svm.h:309</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a7c494fa07f9ddd95637bb1061808402e"><div class="ttname"><a href="structvcpu__svm.html#a7c494fa07f9ddd95637bb1061808402e">vcpu_svm::asid</a></div><div class="ttdeci">u32 asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00215">svm.h:215</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad0a040a48a04ab47d0af3385ad214cd4_cgraph.png" border="0" usemap="#asvm_8h_ad0a040a48a04ab47d0af3385ad214cd4_cgraph" alt=""/></div>
<map name="asvm_8h_ad0a040a48a04ab47d0af3385ad214cd4_cgraph" id="asvm_8h_ad0a040a48a04ab47d0af3385ad214cd4_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,107,57"/>
<area shape="rect" href="sev_8c.html#a66cc6caa9f6331de794476e911d4ce53" title=" " alt="" coords="169,5,276,32"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="155,56,291,83"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="339,5,445,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad0a040a48a04ab47d0af3385ad214cd4_icgraph.png" border="0" usemap="#asvm_8h_ad0a040a48a04ab47d0af3385ad214cd4_icgraph" alt=""/></div>
<map name="asvm_8h_ad0a040a48a04ab47d0af3385ad214cd4_icgraph" id="asvm_8h_ad0a040a48a04ab47d0af3385ad214cd4_icgraph">
<area shape="rect" title=" " alt="" coords="324,5,425,32"/>
<area shape="rect" href="svm_8c.html#a1337a20b038f182d9e04102e22c45f79" title=" " alt="" coords="169,5,276,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="adb2a01596415bf77bd9a3f22ff165a14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb2a01596415bf77bd9a3f22ff165a14">&#9670;&nbsp;</a></span>recalc_intercepts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void recalc_intercepts </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l00122">122</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">struct </span>vmcb_control_area *c, *h;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvmcb__ctrl__area__cached.html">vmcb_ctrl_area_cached</a> *g;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13aa5c3bcc8811c26fdc5e7cda9a9b213e1">VMCB_INTERCEPTS</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    c = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    h = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;control;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    g = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; MAX_INTERCEPT; i++)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        c-&gt;<a class="code" href="structvmcb__ctrl__area__cached.html#a1e877429e7fb02e17e8aec57274abca4">intercepts</a>[i] = h-&gt;intercepts[i];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    if (g-&gt;<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp; V_INTR_MASKING_MASK) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">         * If L2 is active and V_INTR_MASKING is enabled in vmcb12,</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">         * disable intercept of CR8 writes as L2&#39;s CR8 does not affect</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">         * any interrupt KVM may want to inject.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">         * Similarly, disable intercept of virtual interrupts (used to</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">         * detect interrupt windows) if the saved RFLAGS.IF is &#39;0&#39;, as</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">         * the effective RFLAGS.IF for L1 interrupts will never be set</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">         * while L2 is running (L2&#39;s RFLAGS.IF doesn&#39;t affect L1 IRQs).</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a>(c, INTERCEPT_CR8_WRITE);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">if</span> (!(svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.rflags &amp; X86_EFLAGS_IF))</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a>(c, INTERCEPT_VINTR);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">     * We want to see VMMCALLs from a nested guest only when Hyper-V L2 TLB</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">     * flush feature is enabled.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643">nested_svm_l2_tlb_flush_enabled</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a>(c, INTERCEPT_VMMCALL);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; MAX_INTERCEPT; i++)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        c-&gt;intercepts[i] |= g-&gt;<a class="code" href="structvmcb__ctrl__area__cached.html#a1e877429e7fb02e17e8aec57274abca4">intercepts</a>[i];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">/* If SMI is not intercepted, ignore guest SMI intercept as well  */</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    if (!<a class="code" href="svm_8c.html#adc8812d5d875ec9a2bf431790db71cfb">intercept_smi</a>)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a>(c, INTERCEPT_SMI);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05">nested_vmcb_needs_vls_intercept</a>(svm)) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">         * If the virtual VMLOAD/VMSAVE is not enabled for the L2,</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">         * we must intercept these instructions to correctly</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">         * emulate them in case L1 doesn&#39;t intercept them.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(c, INTERCEPT_VMLOAD);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(c, INTERCEPT_VMSAVE);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        WARN_ON(!(c-&gt;virt_ext &amp; VIRTUAL_VMLOAD_VMSAVE_ENABLE_MASK));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
<div class="ttc" id="astructvmcb__ctrl__area__cached_html"><div class="ttname"><a href="structvmcb__ctrl__area__cached.html">vmcb_ctrl_area_cached</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00125">svm.h:125</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_a225c391860ae9f13ee16f0292bef1b05"><div class="ttname"><a href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05">nested_vmcb_needs_vls_intercept</a></div><div class="ttdeci">static bool nested_vmcb_needs_vls_intercept(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l00108">nested.c:108</a></div></div>
<div class="ttc" id="asvm_8c_html_adc8812d5d875ec9a2bf431790db71cfb"><div class="ttname"><a href="svm_8c.html#adc8812d5d875ec9a2bf431790db71cfb">intercept_smi</a></div><div class="ttdeci">bool intercept_smi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00235">svm.c:235</a></div></div>
<div class="ttc" id="asvm_8h_html_afdbe781b81d2ae90e81d9bb9e9750789"><div class="ttname"><a href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a></div><div class="ttdeci">static void vmcb_set_intercept(struct vmcb_control_area *control, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00379">svm.h:379</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_adb2a01596415bf77bd9a3f22ff165a14_cgraph.png" border="0" usemap="#asvm_8h_adb2a01596415bf77bd9a3f22ff165a14_cgraph" alt=""/></div>
<map name="asvm_8h_adb2a01596415bf77bd9a3f22ff165a14_cgraph" id="asvm_8h_adb2a01596415bf77bd9a3f22ff165a14_cgraph">
<area shape="rect" title=" " alt="" coords="5,159,139,185"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="218,5,338,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="187,57,369,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="187,122,369,163"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="205,188,351,215"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="210,239,346,265"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="203,289,353,316"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="435,104,553,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="417,155,571,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="857,97,1031,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="619,129,809,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_adb2a01596415bf77bd9a3f22ff165a14_icgraph.png" border="0" usemap="#asvm_8h_adb2a01596415bf77bd9a3f22ff165a14_icgraph" alt=""/></div>
<map name="asvm_8h_adb2a01596415bf77bd9a3f22ff165a14_icgraph" id="asvm_8h_adb2a01596415bf77bd9a3f22ff165a14_icgraph">
<area shape="rect" title=" " alt="" coords="1941,575,2075,602"/>
<area shape="rect" href="svm_8c.html#a02cdc4055c8a1706c884eff72c4caaf7" title=" " alt="" coords="1739,147,1869,174"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="1717,307,1891,334"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="1494,362,1633,389"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1211,1204,1393,1245"/>
<area shape="rect" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf" title=" " alt="" coords="1737,1153,1871,1179"/>
<area shape="rect" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642" title=" " alt="" coords="1715,518,1893,545"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="1735,601,1873,627"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="1733,847,1875,874"/>
<area shape="rect" href="svm_8c.html#a84f2d3e5d602af563ab58693bf87db77" title=" " alt="" coords="1503,93,1623,119"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1007,767,1093,794"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="1244,235,1360,262"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="995,261,1105,287"/>
<area shape="rect" href="svm_8c.html#aeb01a3f5d5204374edbbdb185d87ffcd" title=" " alt="" coords="1477,245,1650,287"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="723,767,851,794"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="979,159,1121,186"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="667,109,908,135"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="710,159,865,186"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="677,341,897,367"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="415,71,607,98"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="404,123,619,164"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="409,189,613,215"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="409,239,614,266"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="204,315,355,342"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="420,5,603,47"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="203,64,356,105"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="5,315,155,342"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="422,341,601,367"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="966,362,1134,389"/>
<area shape="rect" href="svm_8c.html#a8e925350e4b7d486cb0b9bace97fc5f0" title=" " alt="" coords="1460,1203,1667,1230"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="1488,869,1639,911"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="1500,463,1627,490"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="1251,109,1353,135"/>
<area shape="rect" href="svm_8c.html#aff900c45df2faa151d783155ec034f86" title=" " alt="" coords="1480,717,1647,743"/>
<area shape="rect" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1" title=" " alt="" coords="1477,935,1649,976"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="1511,514,1615,541"/>
<area shape="rect" href="svm_8c.html#aa30e5cb5ad1759988fc349bd703bd4dc" title=" " alt="" coords="1466,767,1661,794"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="1226,920,1378,961"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="1192,362,1412,389"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="956,311,1144,338"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="985,58,1115,85"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="985,109,1115,135"/>
<area shape="rect" href="svm_8c.html#aaa5bf4dc91985f4c533268b7e4ca811d" title=" " alt="" coords="1237,717,1367,743"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="1226,767,1378,794"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1269,514,1335,541"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="1468,1001,1659,1027"/>
<area shape="rect" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066" title=" " alt="" coords="1478,818,1649,845"/>
<area shape="rect" href="svm_8c.html#a27df28527cda6f7917355af86817d940" title=" " alt="" coords="1506,1051,1621,1078"/>
<area shape="rect" href="svm_8c.html#a67bccbcbb6b439b80103663fe58cd626" title=" " alt="" coords="1239,818,1365,845"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="1211,1051,1393,1078"/>
</map>
</div>

</div>
</div>
<a id="af04356b0b53ece1f631f1cfa12521642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af04356b0b53ece1f631f1cfa12521642">&#9670;&nbsp;</a></span>set_exception_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_exception_intercept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00403">403</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    WARN_ON_ONCE(bit &gt;= 32);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, INTERCEPT_EXCEPTION_OFFSET + bit);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(svm);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_af04356b0b53ece1f631f1cfa12521642_cgraph.png" border="0" usemap="#asvm_8h_af04356b0b53ece1f631f1cfa12521642_cgraph" alt=""/></div>
<map name="asvm_8h_af04356b0b53ece1f631f1cfa12521642_cgraph" id="asvm_8h_af04356b0b53ece1f631f1cfa12521642_cgraph">
<area shape="rect" title=" " alt="" coords="5,239,184,265"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="232,188,365,215"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="429,289,580,316"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="445,5,565,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="413,57,596,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="414,122,595,163"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="431,188,578,215"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="437,239,573,265"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="661,104,780,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="644,155,797,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1084,97,1257,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="845,129,1036,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_af04356b0b53ece1f631f1cfa12521642_icgraph.png" border="0" usemap="#asvm_8h_af04356b0b53ece1f631f1cfa12521642_icgraph" alt=""/></div>
<map name="asvm_8h_af04356b0b53ece1f631f1cfa12521642_icgraph" id="asvm_8h_af04356b0b53ece1f631f1cfa12521642_icgraph">
<area shape="rect" title=" " alt="" coords="2193,56,2372,83"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="2015,5,2102,32"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2003,56,2114,83"/>
<area shape="rect" href="svm_8c.html#aeb01a3f5d5204374edbbdb185d87ffcd" title=" " alt="" coords="1972,107,2145,149"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1783,5,1911,32"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1769,236,1924,263"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,56,1213,83"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,236,1710,263"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,313,1721,354"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,185,1716,212"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,392,719,419"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,385,1717,412"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,119,1705,161"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,275,1437,317"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,224,1440,251"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,173,1427,200"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,283,1163,309"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,283,939,309"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,341,1459,368"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,107,1445,149"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,107,1195,149"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,89,945,116"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,140,940,167"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,392,520,419"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,417,323,444"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,417,128,444"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,392,1449,419"/>
</map>
</div>

</div>
</div>
<a id="ae7cebb5bd1d0e7eadb2b7df90cca0c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7cebb5bd1d0e7eadb2b7df90cca0c74">&#9670;&nbsp;</a></span>set_msr_interception()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_msr_interception </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>msrpm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>msr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>write</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00859">859</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;{</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2">set_shadow_msr_intercept</a>(vcpu, msr, read, write);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a">set_msr_interception_bitmap</a>(vcpu, msrpm, msr, read, write);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a1ffde811cc7743857dbb3175beda4aa2"><div class="ttname"><a href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2">set_shadow_msr_intercept</a></div><div class="ttdeci">static void set_shadow_msr_intercept(struct kvm_vcpu *vcpu, u32 msr, int read, int write)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00768">svm.c:768</a></div></div>
<div class="ttc" id="asvm_8c_html_a7baa0f9e5f7d38e8ed066a4b8a61c09a"><div class="ttname"><a href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a">set_msr_interception_bitmap</a></div><div class="ttdeci">static void set_msr_interception_bitmap(struct kvm_vcpu *vcpu, u32 *msrpm, u32 msr, int read, int write)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00822">svm.c:822</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ae7cebb5bd1d0e7eadb2b7df90cca0c74_cgraph.png" border="0" usemap="#asvm_8h_ae7cebb5bd1d0e7eadb2b7df90cca0c74_cgraph" alt=""/></div>
<map name="asvm_8h_ae7cebb5bd1d0e7eadb2b7df90cca0c74_cgraph" id="asvm_8h_ae7cebb5bd1d0e7eadb2b7df90cca0c74_cgraph">
<area shape="rect" title=" " alt="" coords="5,195,164,221"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="231,137,389,178"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="212,224,408,251"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="487,5,629,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="456,57,660,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="485,123,631,149"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="523,224,593,251"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="483,173,633,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="708,224,881,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ae7cebb5bd1d0e7eadb2b7df90cca0c74_icgraph.png" border="0" usemap="#asvm_8h_ae7cebb5bd1d0e7eadb2b7df90cca0c74_icgraph" alt=""/></div>
<map name="asvm_8h_ae7cebb5bd1d0e7eadb2b7df90cca0c74_icgraph" id="asvm_8h_ae7cebb5bd1d0e7eadb2b7df90cca0c74_icgraph">
<area shape="rect" title=" " alt="" coords="2655,310,2813,337"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1809,231,1896,258"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="2230,123,2381,164"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="2021,64,2173,105"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="2453,281,2591,307"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="2437,5,2607,47"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="2454,551,2590,578"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="2043,653,2152,679"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="2455,501,2589,527"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="2443,332,2601,373"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="2437,450,2607,477"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1513,235,1641,262"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="2247,281,2363,307"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="2027,282,2168,309"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1732,282,1973,309"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="2232,5,2379,47"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="2238,551,2373,578"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1775,501,1930,527"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1743,602,1963,629"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,445,1673,471"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,357,1684,399"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,618,1679,645"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,523,719,550"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,295,1679,322"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,552,1668,593"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,457,1399,499"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,406,1403,433"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,355,1389,382"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,465,1144,491"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,465,939,491"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,305,1421,331"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,603,1408,644"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,603,1176,644"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,635,945,662"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,585,940,611"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,389,520,415"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,363,323,390"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,363,128,390"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,254,1412,281"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="2229,335,2381,362"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="2221,386,2389,413"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="2037,333,2157,359"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="2022,384,2173,425"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="1781,384,1925,425"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="1781,450,1924,477"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="2225,501,2385,527"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2042,551,2153,578"/>
</map>
</div>

</div>
</div>
<a id="a87f63ae4bc207e3d5a5d80e34243cf50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87f63ae4bc207e3d5a5d80e34243cf50">&#9670;&nbsp;</a></span>sev_cpu_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sev_cpu_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structsvm__cpu__data.html">svm_cpu_data</a> *&#160;</td>
          <td class="paramname"><em>sd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02313">2313</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;{</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#a8cea9180251b2d380c09e0fd8be68b74">sev_enabled</a>)</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160; </div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    sd-&gt;<a class="code" href="structsvm__cpu__data.html#af89c94b4ad75ed4396bb2f85415fcf38">sev_vmcbs</a> = kcalloc(<a class="code" href="sev_8c.html#a30f4a3ca065f757024e9fe4d0c39e2c9">nr_asids</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *), GFP_KERNEL);</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <span class="keywordflow">if</span> (!sd-&gt;<a class="code" href="structsvm__cpu__data.html#af89c94b4ad75ed4396bb2f85415fcf38">sev_vmcbs</a>)</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a30f4a3ca065f757024e9fe4d0c39e2c9"><div class="ttname"><a href="sev_8c.html#a30f4a3ca065f757024e9fe4d0c39e2c9">nr_asids</a></div><div class="ttdeci">static unsigned int nr_asids</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00074">sev.c:74</a></div></div>
<div class="ttc" id="asev_8c_html_a8cea9180251b2d380c09e0fd8be68b74"><div class="ttname"><a href="sev_8c.html#a8cea9180251b2d380c09e0fd8be68b74">sev_enabled</a></div><div class="ttdeci">#define sev_enabled</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00063">sev.c:63</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a87f63ae4bc207e3d5a5d80e34243cf50_icgraph.png" border="0" usemap="#asvm_8h_a87f63ae4bc207e3d5a5d80e34243cf50_icgraph" alt=""/></div>
<map name="asvm_8h_a87f63ae4bc207e3d5a5d80e34243cf50_icgraph" id="asvm_8h_a87f63ae4bc207e3d5a5d80e34243cf50_icgraph">
<area shape="rect" title=" " alt="" coords="371,5,473,32"/>
<area shape="rect" href="svm_8c.html#ad791a60fcdb50ec0a9aeb753e780ddb6" title=" " alt="" coords="215,5,323,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="a14877439e9d41030cb21612eecc8f3f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14877439e9d41030cb21612eecc8f3f9">&#9670;&nbsp;</a></span>sev_es_guest()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __always_inline bool sev_es_guest </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00332">332</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;{</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor">#ifdef CONFIG_KVM_AMD_SEV</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> *sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">return</span> sev-&gt;<a class="code" href="structkvm__sev__info.html#ab1e6fb4b7c55cdd34fdd230a7847d11a">es_active</a> &amp;&amp; !WARN_ON_ONCE(!sev-&gt;<a class="code" href="structkvm__sev__info.html#a6da81c9e8736479d0edee1c4e8813365">active</a>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="ttc" id="astructkvm__sev__info_html"><div class="ttname"><a href="structkvm__sev__info.html">kvm_sev_info</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00079">svm.h:79</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a6da81c9e8736479d0edee1c4e8813365"><div class="ttname"><a href="structkvm__sev__info.html#a6da81c9e8736479d0edee1c4e8813365">kvm_sev_info::active</a></div><div class="ttdeci">bool active</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00080">svm.h:80</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_ab1e6fb4b7c55cdd34fdd230a7847d11a"><div class="ttname"><a href="structkvm__sev__info.html#ab1e6fb4b7c55cdd34fdd230a7847d11a">kvm_sev_info::es_active</a></div><div class="ttdeci">bool es_active</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00081">svm.h:81</a></div></div>
<div class="ttc" id="astructkvm__svm_html_a743b2106389f26a042ce5ac8166afd73"><div class="ttname"><a href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">kvm_svm::sev_info</a></div><div class="ttdeci">struct kvm_sev_info sev_info</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00101">svm.h:104</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a14877439e9d41030cb21612eecc8f3f9_cgraph.png" border="0" usemap="#asvm_8h_a14877439e9d41030cb21612eecc8f3f9_cgraph" alt=""/></div>
<map name="asvm_8h_a14877439e9d41030cb21612eecc8f3f9_cgraph" id="asvm_8h_a14877439e9d41030cb21612eecc8f3f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,32"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="164,5,271,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a14877439e9d41030cb21612eecc8f3f9_icgraph.png" border="0" usemap="#asvm_8h_a14877439e9d41030cb21612eecc8f3f9_icgraph" alt=""/></div>
<map name="asvm_8h_a14877439e9d41030cb21612eecc8f3f9_icgraph" id="asvm_8h_a14877439e9d41030cb21612eecc8f3f9_icgraph">
<area shape="rect" title=" " alt="" coords="852,812,963,839"/>
<area shape="rect" href="svm_8c.html#a1f6d0a95558c52f05d9b3b97b2710cfe" title=" " alt="" coords="605,46,771,87"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="338,111,481,137"/>
<area shape="rect" href="svm_8c.html#a84f2d3e5d602af563ab58693bf87db77" title=" " alt="" coords="628,264,748,291"/>
<area shape="rect" href="svm_8c.html#a73e8f5db4571aa9511e75f30e939fe89" title=" " alt="" coords="629,315,747,341"/>
<area shape="rect" href="svm_8c.html#aaa5bf4dc91985f4c533268b7e4ca811d" title=" " alt="" coords="345,365,474,392"/>
<area shape="rect" href="svm_8c.html#ad65ceb76375d4e01d2b1e11a9c227b7c" title=" " alt="" coords="615,517,761,544"/>
<area shape="rect" href="sev_8c.html#ad61e7c088903e183bb930bdce850412e" title=" " alt="" coords="317,263,502,289"/>
<area shape="rect" href="sev_8c.html#af343f7dd067883e0f81017a68e854c09" title=" " alt="" coords="630,568,746,595"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="630,163,746,189"/>
<area shape="rect" href="sev_8c.html#a58da6a47d3ee35e28a426faf878a943e" title=" " alt="" coords="593,619,783,645"/>
<area shape="rect" href="svm_8c.html#a642305873006637d55c46a0f035dff2d" title=" " alt="" coords="621,669,755,696"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="615,721,761,762"/>
<area shape="rect" href="svm_8c.html#a2ca2b108d5447ed4093cb0b07092b07d" title=" " alt="" coords="603,787,773,813"/>
<area shape="rect" href="svm_8c.html#a28ea9c19442062c9e284d39852ffab26" title=" " alt="" coords="572,837,804,864"/>
<area shape="rect" href="svm_8c.html#aff900c45df2faa151d783155ec034f86" title=" " alt="" coords="605,416,771,443"/>
<area shape="rect" href="svm_8c.html#a90bdbebaa7d7557c12b54b7f969bc777" title=" " alt="" coords="579,888,797,915"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="593,939,783,965"/>
<area shape="rect" href="svm_8c.html#a4a9065695154691afff42bc585235d64" title=" " alt="" coords="625,989,751,1016"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="621,1040,755,1067"/>
<area shape="rect" href="svm_8c.html#a40fda471b3faf8734e7467631861c082" title=" " alt="" coords="597,1091,779,1117"/>
<area shape="rect" href="svm_8c.html#a6571ab4636ff87fda563be50ab7195ef" title=" " alt="" coords="610,1142,766,1183"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="636,1208,740,1235"/>
<area shape="rect" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066" title=" " alt="" coords="603,467,773,493"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="633,1259,743,1285"/>
<area shape="rect" href="svm_8c.html#a8e925350e4b7d486cb0b9bace97fc5f0" title=" " alt="" coords="585,1309,791,1336"/>
<area shape="rect" href="svm_8c.html#aa30e5cb5ad1759988fc349bd703bd4dc" title=" " alt="" coords="591,1360,785,1387"/>
<area shape="rect" href="svm_8c.html#a2af2f754ca7838a0253d54c33aae7d1e" title=" " alt="" coords="620,1411,756,1437"/>
<area shape="rect" href="svm_8c.html#ac8932e9146797ddd1e75d6d8dd4afc23" title=" " alt="" coords="603,1462,773,1503"/>
<area shape="rect" href="svm_8c.html#a04b96ed53c5aaf42d298205d87cd7762" title=" " alt="" coords="607,1579,769,1605"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="351,1553,467,1580"/>
<area shape="rect" href="svm_8c.html#a879b6475034eccd7032ffd436966f341" title=" " alt="" coords="295,5,524,32"/>
<area shape="rect" href="svm_8c.html#ac18fc14fa96cb83668d789973478dbc0" title=" " alt="" coords="299,56,519,83"/>
<area shape="rect" href="svm_8c.html#a034d0058215cd4fddf9fbaa460d3faf6" title=" " alt="" coords="34,5,218,32"/>
<area shape="rect" href="svm_8c.html#a13190482bab2b529a02a5cf83309f510" title=" " alt="" coords="44,56,208,83"/>
<area shape="rect" href="svm_8c.html#aea4014f3f951e100eb2acc13cef94502" title=" " alt="" coords="67,107,185,133"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="62,160,190,187"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="5,237,247,264"/>
<area shape="rect" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4" title=" " alt="" coords="349,568,470,595"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="366,161,453,188"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="339,212,480,239"/>
<area shape="rect" href="sev_8c.html#a2039644d359270872404c4664a25d951" title=" " alt="" coords="334,619,485,645"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="333,721,485,762"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="333,416,485,443"/>
<area shape="rect" href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa" title=" " alt="" coords="324,989,495,1016"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="27,989,225,1016"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="376,1157,443,1184"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="332,1208,487,1235"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="299,1259,519,1285"/>
<area shape="rect" href="svm_8c.html#a67bccbcbb6b439b80103663fe58cd626" title=" " alt="" coords="347,467,472,493"/>
</map>
</div>

</div>
</div>
<a id="ad4655e18a7969aeb0228ecbbc011f546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4655e18a7969aeb0228ecbbc011f546">&#9670;&nbsp;</a></span>sev_es_prepare_switch_to_guest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sev_es_prepare_switch_to_guest </td>
          <td>(</td>
          <td class="paramtype">struct sev_es_save_area *&#160;</td>
          <td class="paramname"><em>hostsa</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l03119">3119</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;{</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;<span class="comment">     * All host state for SEV-ES guests is categorized into three swap types</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;<span class="comment">     * based on how it is handled by hardware during a world switch:</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;<span class="comment">     * A: VMRUN:   Host state saved in host save area</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;<span class="comment">     *    VMEXIT:  Host state loaded from host save area</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;<span class="comment">     * B: VMRUN:   Host state _NOT_ saved in host save area</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;<span class="comment">     *    VMEXIT:  Host state loaded from host save area</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;<span class="comment">     * C: VMRUN:   Host state _NOT_ saved in host save area</span></div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="comment">     *    VMEXIT:  Host state initialized to default(reset) values</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;<span class="comment">     * Manually save type-B state, i.e. state that is loaded by VMEXIT but</span></div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;<span class="comment">     * isn&#39;t saved by VMRUN, that isn&#39;t already saved by VMSAVE (performed</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;<span class="comment">     * by common SVM code).</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    hostsa-&gt;xcr0 = xgetbv(XCR_XFEATURE_ENABLED_MASK);</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    hostsa-&gt;pkru = read_pkru();</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    hostsa-&gt;xss = <a class="code" href="x86_8c.html#a54121b1fe66060e6490b8f1b6a15fd8a">host_xss</a>;</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160; </div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;<span class="comment">     * If DebugSwap is enabled, debug registers are loaded but NOT saved by</span></div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;<span class="comment">     * the CPU (Type-B). If DebugSwap is disabled/unsupported, the CPU both</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;<span class="comment">     * saves and loads debug registers (Type-A).</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sev_8c.html#ab97dff3e3e9b4e85cfc71316a06df95a">sev_es_debug_swap_enabled</a>) {</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;        hostsa-&gt;dr0 = native_get_debugreg(0);</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;        hostsa-&gt;dr1 = native_get_debugreg(1);</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        hostsa-&gt;dr2 = native_get_debugreg(2);</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;        hostsa-&gt;dr3 = native_get_debugreg(3);</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;        hostsa-&gt;dr0_addr_mask = amd_get_dr_addr_mask(0);</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;        hostsa-&gt;dr1_addr_mask = amd_get_dr_addr_mask(1);</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;        hostsa-&gt;dr2_addr_mask = amd_get_dr_addr_mask(2);</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;        hostsa-&gt;dr3_addr_mask = amd_get_dr_addr_mask(3);</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    }</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_ab97dff3e3e9b4e85cfc71316a06df95a"><div class="ttname"><a href="sev_8c.html#ab97dff3e3e9b4e85cfc71316a06df95a">sev_es_debug_swap_enabled</a></div><div class="ttdeci">#define sev_es_debug_swap_enabled</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00065">sev.c:65</a></div></div>
<div class="ttc" id="ax86_8c_html_a54121b1fe66060e6490b8f1b6a15fd8a"><div class="ttname"><a href="x86_8c.html#a54121b1fe66060e6490b8f1b6a15fd8a">host_xss</a></div><div class="ttdeci">u64 __read_mostly host_xss</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00238">x86.c:238</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad4655e18a7969aeb0228ecbbc011f546_icgraph.png" border="0" usemap="#asvm_8h_ad4655e18a7969aeb0228ecbbc011f546_icgraph" alt=""/></div>
<map name="asvm_8h_ad4655e18a7969aeb0228ecbbc011f546_icgraph" id="asvm_8h_ad4655e18a7969aeb0228ecbbc011f546_icgraph">
<area shape="rect" title=" " alt="" coords="209,5,383,47"/>
<area shape="rect" href="svm_8c.html#a6571ab4636ff87fda563be50ab7195ef" title=" " alt="" coords="5,5,161,47"/>
</map>
</div>

</div>
</div>
<a id="a8381dc2e2d38fd331490bbb2fd097d0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8381dc2e2d38fd331490bbb2fd097d0a">&#9670;&nbsp;</a></span>sev_es_string_io()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sev_es_string_io </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02963">2963</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;{</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    <span class="keywordtype">int</span> count;</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <span class="keywordtype">int</span> bytes;</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160; </div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2 &gt; INT_MAX)</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160; </div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    count = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.exit_info_2;</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="keywordflow">if</span> (unlikely(check_mul_overflow(count, size, &amp;bytes)))</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160; </div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    r = <a class="code" href="sev_8c.html#a0ed13e39856158b838d1f124dc65ad42">setup_vmgexit_scratch</a>(svm, in, bytes);</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    <span class="keywordflow">if</span> (r)</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;        <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160; </div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#ac4b95013b15c215fb1fcfd251d2e006d">kvm_sev_es_string_io</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, size, port, svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">ghcb_sa</a>,</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                    count, in);</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a0ed13e39856158b838d1f124dc65ad42"><div class="ttname"><a href="sev_8c.html#a0ed13e39856158b838d1f124dc65ad42">setup_vmgexit_scratch</a></div><div class="ttdeci">static int setup_vmgexit_scratch(struct vcpu_svm *svm, bool sync, u64 len)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02670">sev.c:2670</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_a33488936e12f96b72916b86d5217b91b"><div class="ttname"><a href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">vcpu_sev_es_state::ghcb_sa</a></div><div class="ttdeci">void * ghcb_sa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00203">svm.h:203</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_aaaac2e4809a87c7130fd4d8e146b8cc2"><div class="ttname"><a href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">vcpu_svm::sev_es</a></div><div class="ttdeci">struct vcpu_sev_es_state sev_es</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00279">svm.h:287</a></div></div>
<div class="ttc" id="ax86_8c_html_ac4b95013b15c215fb1fcfd251d2e006d"><div class="ttname"><a href="x86_8c.html#ac4b95013b15c215fb1fcfd251d2e006d">kvm_sev_es_string_io</a></div><div class="ttdeci">int kvm_sev_es_string_io(struct kvm_vcpu *vcpu, unsigned int size, unsigned int port, void *data, unsigned int count, int in)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13876">x86.c:13876</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a8381dc2e2d38fd331490bbb2fd097d0a_cgraph.png" border="0" usemap="#asvm_8h_a8381dc2e2d38fd331490bbb2fd097d0a_cgraph" alt=""/></div>
<map name="asvm_8h_a8381dc2e2d38fd331490bbb2fd097d0a_cgraph" id="asvm_8h_a8381dc2e2d38fd331490bbb2fd097d0a_cgraph">
<area shape="rect" title=" " alt="" coords="5,271,136,297"/>
<area shape="rect" href="x86_8c.html#ac4b95013b15c215fb1fcfd251d2e006d" title=" " alt="" coords="187,233,354,260"/>
<area shape="rect" href="sev_8c.html#a0ed13e39856158b838d1f124dc65ad42" title=" " alt="" coords="184,296,357,323"/>
<area shape="rect" href="x86_8c.html#a4bb05cc4f2b01054d01e1947197a74c9" title=" " alt="" coords="410,233,539,260"/>
<area shape="rect" href="x86_8c.html#a3e2127cd416ed691ddc9be7200f8e3e3" title=" " alt="" coords="405,56,544,83"/>
<area shape="rect" href="x86_8c.html#a684cc35eda9d78893704d166a59fa8ac" title=" " alt="" coords="879,208,1104,235"/>
<area shape="rect" href="x86_8c.html#a7174438319d810240ac051141ea5b435" title=" " alt="" coords="596,259,827,285"/>
<area shape="rect" href="x86_8c.html#a43503f268738cc53b4acd43b0f5ea8cb" title=" " alt="" coords="648,157,775,184"/>
<area shape="rect" href="x86_8c.html#a5a201bc6a602db52b7b19b9697b64c6e" title=" " alt="" coords="894,259,1089,285"/>
<area shape="rect" href="x86_8c.html#a32a23cfa29cb51dd82289fb67939180c" title=" " alt="" coords="914,151,1069,177"/>
<area shape="rect" href="kvm__main_8c.html#a32f50a4f2293b3acdeece0c22abe8ecc" title=" " alt="" coords="1180,199,1316,225"/>
<area shape="rect" href="kvm__main_8c.html#ac2e936ae65c010ffa196cedbc40350ee" title=" " alt="" coords="1178,148,1318,175"/>
<area shape="rect" href="kvm__main_8c.html#a7561a833c4222778fb37a7e0f9e97e96" title=" " alt="" coords="1394,199,1545,225"/>
<area shape="rect" href="kvm__main_8c.html#a75ccec7a81fef145fb3c3a3b5479a86f" title=" " alt="" coords="2048,196,2183,223"/>
<area shape="rect" href="kvm__main_8c.html#a94bf2e0af8d9af8807a6a92ffb01cc1c" title=" " alt="" coords="1595,197,1785,224"/>
<area shape="rect" href="kvm__main_8c.html#aa52366417ec3708a05183231a3227d9d" title=" " alt="" coords="1833,171,2000,197"/>
<area shape="rect" href="kvm__main_8c.html#a484b5f7e2c7e682cb49450f611319077" title=" " alt="" coords="1392,148,1547,175"/>
<area shape="rect" href="x86_8c.html#a4b29efacd5ee390615f3c810441c9922" title=" " alt="" coords="592,56,831,83"/>
<area shape="rect" href="x86_8c.html#a0d15cd39b8133363394c2b55a06d52b8" title=" " alt="" coords="643,5,779,32"/>
<area shape="rect" href="kvm__main_8c.html#a3cc887a9ecfdd6e9f5ab90dc2ce8de4a" title=" " alt="" coords="409,309,540,336"/>
<area shape="rect" href="kvm__main_8c.html#a2a95905782c4136bdf6d9861f937b0ef" title=" " alt="" coords="627,309,796,336"/>
<area shape="rect" href="kvm__main_8c.html#a03aae88de564edba8a3a2d10bc5e7b20" title=" " alt="" coords="654,360,769,387"/>
<area shape="rect" href="kvm__main_8c.html#acc4698e3f076cdbbd5d8ca788a94decf" title=" " alt="" coords="900,360,1083,387"/>
<area shape="rect" href="kvm__main_8c.html#a7c20e0f654f0b4472c3833f0a563e11e" title=" " alt="" coords="927,309,1055,336"/>
<area shape="rect" href="kvm__main_8c.html#adb8a0a4f675ca16ea81acd3b88089f13" title=" " alt="" coords="1152,360,1344,387"/>
<area shape="rect" href="kvm__main_8c.html#ab58025ccc253a102c64561fa61c2a514" title=" " alt="" coords="1393,372,1545,399"/>
<area shape="rect" href="kvm__main_8c.html#a77ec4b9140d69a05f3b4e7836cc03a96" title=" " alt="" coords="1609,347,1771,373"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a8381dc2e2d38fd331490bbb2fd097d0a_icgraph.png" border="0" usemap="#asvm_8h_a8381dc2e2d38fd331490bbb2fd097d0a_icgraph" alt=""/></div>
<map name="asvm_8h_a8381dc2e2d38fd331490bbb2fd097d0a_icgraph" id="asvm_8h_a8381dc2e2d38fd331490bbb2fd097d0a_icgraph">
<area shape="rect" title=" " alt="" coords="172,5,303,32"/>
<area shape="rect" href="svm_8c.html#a73e8f5db4571aa9511e75f30e939fe89" title=" " alt="" coords="5,5,124,32"/>
</map>
</div>

</div>
</div>
<a id="aba11fc99cad465d138aeb5c2cb3508e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba11fc99cad465d138aeb5c2cb3508e2">&#9670;&nbsp;</a></span>sev_es_unmap_ghcb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sev_es_unmap_ghcb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02614">2614</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;{</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <span class="keywordflow">if</span> (!svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>)</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160; </div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#acdd2e394133423adbb11b59872ab0121">ghcb_sa_free</a>) {</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="comment">         * The scratch area lives outside the GHCB, so there is a</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="comment">         * buffer that, depending on the operation performed, may</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;<span class="comment">         * need to be synced, then freed.</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#ae0158f4a111e910e8777324a10286cec">ghcb_sa_sync</a>) {</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;            <a class="code" href="kvm__main_8c.html#a1cf9d9c864cd7f9b5b32fc880c0872ab">kvm_write_guest</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.kvm,</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                    svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#aafb2527aebe81e9eefaa798f5eeca497">sw_scratch</a>,</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;                    svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">ghcb_sa</a>,</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                    svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a1288c35c0ce7f08e31b6e56639cfc17c">ghcb_sa_len</a>);</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#ae0158f4a111e910e8777324a10286cec">ghcb_sa_sync</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;        }</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160; </div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;        kvfree(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">ghcb_sa</a>);</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">ghcb_sa</a> = NULL;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#acdd2e394133423adbb11b59872ab0121">ghcb_sa_free</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    }</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160; </div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    trace_kvm_vmgexit_exit(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.vcpu_id, svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>);</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160; </div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <a class="code" href="sev_8c.html#a9a51f2493b65daa56d8c07a204acc7cc">sev_es_sync_to_ghcb</a>(svm);</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <a class="code" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155">kvm_vcpu_unmap</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#aadd3d1bc5bf29afb297714dcaf151aba">ghcb_map</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a> = NULL;</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;}</div>
<div class="ttc" id="akvm__main_8c_html_a1cf9d9c864cd7f9b5b32fc880c0872ab"><div class="ttname"><a href="kvm__main_8c.html#a1cf9d9c864cd7f9b5b32fc880c0872ab">kvm_write_guest</a></div><div class="ttdeci">int kvm_write_guest(struct kvm *kvm, gpa_t gpa, const void *data, unsigned long len)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l03449">kvm_main.c:3449</a></div></div>
<div class="ttc" id="asev_8c_html_a9a51f2493b65daa56d8c07a204acc7cc"><div class="ttname"><a href="sev_8c.html#a9a51f2493b65daa56d8c07a204acc7cc">sev_es_sync_to_ghcb</a></div><div class="ttdeci">static void sev_es_sync_to_ghcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02416">sev.c:2416</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_a1288c35c0ce7f08e31b6e56639cfc17c"><div class="ttname"><a href="structvcpu__sev__es__state.html#a1288c35c0ce7f08e31b6e56639cfc17c">vcpu_sev_es_state::ghcb_sa_len</a></div><div class="ttdeci">u32 ghcb_sa_len</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00204">svm.h:204</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_aadd3d1bc5bf29afb297714dcaf151aba"><div class="ttname"><a href="structvcpu__sev__es__state.html#aadd3d1bc5bf29afb297714dcaf151aba">vcpu_sev_es_state::ghcb_map</a></div><div class="ttdeci">struct kvm_host_map ghcb_map</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00197">svm.h:198</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_aafb2527aebe81e9eefaa798f5eeca497"><div class="ttname"><a href="structvcpu__sev__es__state.html#aafb2527aebe81e9eefaa798f5eeca497">vcpu_sev_es_state::sw_scratch</a></div><div class="ttdeci">u64 sw_scratch</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00202">svm.h:202</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_abb6b1331553e74269e36bf08c13b710c"><div class="ttname"><a href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">vcpu_sev_es_state::ghcb</a></div><div class="ttdeci">struct ghcb * ghcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00196">svm.h:196</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_acdd2e394133423adbb11b59872ab0121"><div class="ttname"><a href="structvcpu__sev__es__state.html#acdd2e394133423adbb11b59872ab0121">vcpu_sev_es_state::ghcb_sa_free</a></div><div class="ttdeci">bool ghcb_sa_free</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00206">svm.h:206</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_ae0158f4a111e910e8777324a10286cec"><div class="ttname"><a href="structvcpu__sev__es__state.html#ae0158f4a111e910e8777324a10286cec">vcpu_sev_es_state::ghcb_sa_sync</a></div><div class="ttdeci">bool ghcb_sa_sync</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00205">svm.h:205</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aba11fc99cad465d138aeb5c2cb3508e2_cgraph.png" border="0" usemap="#asvm_8h_aba11fc99cad465d138aeb5c2cb3508e2_cgraph" alt=""/></div>
<map name="asvm_8h_aba11fc99cad465d138aeb5c2cb3508e2_cgraph" id="asvm_8h_aba11fc99cad465d138aeb5c2cb3508e2_cgraph">
<area shape="rect" title=" " alt="" coords="5,267,163,293"/>
<area shape="rect" href="kvm__main_8c.html#af9a24e7d30a38de04326c683ebc6a155" title=" " alt="" coords="221,191,363,217"/>
<area shape="rect" href="kvm__main_8c.html#a1cf9d9c864cd7f9b5b32fc880c0872ab" title=" " alt="" coords="225,267,359,293"/>
<area shape="rect" href="sev_8c.html#a9a51f2493b65daa56d8c07a204acc7cc" title=" " alt="" coords="211,317,373,344"/>
<area shape="rect" href="kvm__main_8c.html#a6f9056f6dc868b557b2a2c8e1c548762" title=" " alt="" coords="441,107,575,133"/>
<area shape="rect" href="kvm__main_8c.html#ab3f118170e5a0cf30913bc0cd0a79cfd" title=" " alt="" coords="423,183,593,225"/>
<area shape="rect" href="kvm__main_8c.html#af83e69473e2fe5bf6e452f3fc1f414d2" title=" " alt="" coords="656,56,832,83"/>
<area shape="rect" href="kvm__main_8c.html#a18a05d2f708322bccd0481cee9b76bdc" title=" " alt="" coords="659,107,829,133"/>
<area shape="rect" href="kvm__main_8c.html#a99f99281cc81d5cd69f5825ccb8793b4" title=" " alt="" coords="893,56,1108,83"/>
<area shape="rect" href="kvm__main_8c.html#a6845d169e1c19786abe7719700b9f6b9" title=" " alt="" coords="1161,5,1347,32"/>
<area shape="rect" href="kvm__main_8c.html#a6c7165822622ebbd29159771905bd317" title=" " alt="" coords="1156,56,1352,83"/>
<area shape="rect" href="kvm__main_8c.html#a05228520c714138c61d76bfbc12c162c" title=" " alt="" coords="1404,19,1588,45"/>
<area shape="rect" href="kvm__main_8c.html#aefbc4e0cbda09938de01d0afb0c06d59" title=" " alt="" coords="1640,57,1827,84"/>
<area shape="rect" href="kvm__main_8c.html#acf5fa0af4d165e38ac4721f4061b6f73" title=" " alt="" coords="909,107,1092,133"/>
<area shape="rect" href="kvm__main_8c.html#adb6ddc9dc8c5e447e04b1be97543f347" title=" " alt="" coords="1419,95,1573,121"/>
<area shape="rect" href="kvm__main_8c.html#ac4b56de4919be80c9cd4289f20437c64" title=" " alt="" coords="643,165,845,192"/>
<area shape="rect" href="kvm__main_8c.html#ae4806d9a69b751639c175cb98e468f15" title=" " alt="" coords="909,224,1092,251"/>
<area shape="rect" href="dirty__ring_8c.html#ac1878b63f1f337e93cf186ebd4fffcc4" title=" " alt="" coords="1168,158,1340,199"/>
<area shape="rect" href="dirty__ring_8c.html#a81ebbf462440ed5392d6d3412a859ae7" title=" " alt="" coords="1175,224,1333,251"/>
<area shape="rect" href="kvm__main_8c.html#ac5a3afd8e2d8d1139dc7711c4b9e07e3" title=" " alt="" coords="1167,275,1341,301"/>
<area shape="rect" href="dirty__ring_8c.html#ad6e626257c739b2ac3d397119a7cf798" title=" " alt="" coords="1400,173,1592,200"/>
<area shape="rect" href="dirty__ring_8c.html#a6fe5cd75b9bac6497e1ae7340f2a5f7b" title=" " alt="" coords="1422,224,1570,251"/>
<area shape="rect" href="dirty__ring_8c.html#a22c9a239acf3463a8599a21c0a756538" title=" " alt="" coords="1407,275,1585,301"/>
<area shape="rect" href="dirty__ring_8c.html#acd0a1e586324b4c49b429c7a392db73f" title=" " alt="" coords="1654,249,1813,276"/>
<area shape="rect" href="kvm__main_8c.html#a49ed988e062d259a8706411f619bf1f7" title=" " alt="" coords="421,267,595,293"/>
<area shape="rect" href="kvm__main_8c.html#a03aae88de564edba8a3a2d10bc5e7b20" title=" " alt="" coords="451,317,565,344"/>
<area shape="rect" href="kvm__main_8c.html#a7079b0256c7572c701a6e1526f58fdac" title=" " alt="" coords="651,267,837,293"/>
<area shape="rect" href="kvm__main_8c.html#a7c20e0f654f0b4472c3833f0a563e11e" title=" " alt="" coords="680,317,808,344"/>
<area shape="rect" href="kvm__main_8c.html#a04c9651c5f9a0485fd1e7152bdb01353" title=" " alt="" coords="921,300,1080,327"/>
<area shape="rect" href="kvm__main_8c.html#ae374ebe48072080788db56075dd9a762" title=" " alt="" coords="1185,325,1323,352"/>
<area shape="rect" href="kvm__main_8c.html#ab58025ccc253a102c64561fa61c2a514" title=" " alt="" coords="1420,325,1572,352"/>
<area shape="rect" href="kvm__main_8c.html#a77ec4b9140d69a05f3b4e7836cc03a96" title=" " alt="" coords="1652,325,1815,352"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aba11fc99cad465d138aeb5c2cb3508e2_icgraph.png" border="0" usemap="#asvm_8h_aba11fc99cad465d138aeb5c2cb3508e2_icgraph" alt=""/></div>
<map name="asvm_8h_aba11fc99cad465d138aeb5c2cb3508e2_icgraph" id="asvm_8h_aba11fc99cad465d138aeb5c2cb3508e2_icgraph">
<area shape="rect" title=" " alt="" coords="209,13,367,39"/>
<area shape="rect" href="svm_8c.html#a6571ab4636ff87fda563be50ab7195ef" title=" " alt="" coords="5,5,161,47"/>
</map>
</div>

</div>
</div>
<a id="aa924db70d759d98124ad13172de1f0c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa924db70d759d98124ad13172de1f0c5">&#9670;&nbsp;</a></span>sev_es_vcpu_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sev_es_vcpu_reset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l03108">3108</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;{</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;<span class="comment">     * Set the GHCB MSR value as per the GHCB specification when emulating</span></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;<span class="comment">     * vCPU RESET for an SEV-ES guest.</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    <a class="code" href="sev_8c.html#a791cdac9e53d50f78c0943d78462f16e">set_ghcb_msr</a>(svm, GHCB_MSR_SEV_INFO(<a class="code" href="svm_8h.html#af4810b27551dd12e44459d9444873eb0">GHCB_VERSION_MAX</a>,</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;                        <a class="code" href="svm_8h.html#ab146f6f540f9544ae3b4efaceae107c8">GHCB_VERSION_MIN</a>,</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;                        <a class="code" href="sev_8c.html#acec833aa968184a19e035fd0cb10b369">sev_enc_bit</a>));</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a791cdac9e53d50f78c0943d78462f16e"><div class="ttname"><a href="sev_8c.html#a791cdac9e53d50f78c0943d78462f16e">set_ghcb_msr</a></div><div class="ttdeci">static void set_ghcb_msr(struct vcpu_svm *svm, u64 value)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02766">sev.c:2766</a></div></div>
<div class="ttc" id="asev_8c_html_acec833aa968184a19e035fd0cb10b369"><div class="ttname"><a href="sev_8c.html#acec833aa968184a19e035fd0cb10b369">sev_enc_bit</a></div><div class="ttdeci">static u8 sev_enc_bit</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00068">sev.c:68</a></div></div>
<div class="ttc" id="asvm_8h_html_ab146f6f540f9544ae3b4efaceae107c8"><div class="ttname"><a href="svm_8h.html#ab146f6f540f9544ae3b4efaceae107c8">GHCB_VERSION_MIN</a></div><div class="ttdeci">#define GHCB_VERSION_MIN</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00668">svm.h:668</a></div></div>
<div class="ttc" id="asvm_8h_html_af4810b27551dd12e44459d9444873eb0"><div class="ttname"><a href="svm_8h.html#af4810b27551dd12e44459d9444873eb0">GHCB_VERSION_MAX</a></div><div class="ttdeci">#define GHCB_VERSION_MAX</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00667">svm.h:667</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aa924db70d759d98124ad13172de1f0c5_cgraph.png" border="0" usemap="#asvm_8h_aa924db70d759d98124ad13172de1f0c5_cgraph" alt=""/></div>
<map name="asvm_8h_aa924db70d759d98124ad13172de1f0c5_cgraph" id="asvm_8h_aa924db70d759d98124ad13172de1f0c5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,32"/>
<area shape="rect" href="sev_8c.html#a791cdac9e53d50f78c0943d78462f16e" title=" " alt="" coords="199,5,311,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aa924db70d759d98124ad13172de1f0c5_icgraph.png" border="0" usemap="#asvm_8h_aa924db70d759d98124ad13172de1f0c5_icgraph" alt=""/></div>
<map name="asvm_8h_aa924db70d759d98124ad13172de1f0c5_icgraph" id="asvm_8h_aa924db70d759d98124ad13172de1f0c5_icgraph">
<area shape="rect" title=" " alt="" coords="372,5,517,32"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="181,5,324,32"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
</map>
</div>

</div>
</div>
<a id="af343f7dd067883e0f81017a68e854c09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af343f7dd067883e0f81017a68e854c09">&#9670;&nbsp;</a></span>sev_free_vcpu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sev_free_vcpu </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02373">2373</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;{</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160; </div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; </div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.guest_state_protected)</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        <a class="code" href="sev_8c.html#abf63e5ae3e1e3c9eb770e330ab3eef8c">sev_flush_encrypted_page</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a40070a764eb6f9ab2573d7961a0c6f8e">vmsa</a>);</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; </div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    __free_page(virt_to_page(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a40070a764eb6f9ab2573d7961a0c6f8e">vmsa</a>));</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#acdd2e394133423adbb11b59872ab0121">ghcb_sa_free</a>)</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        kvfree(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">ghcb_sa</a>);</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_abf63e5ae3e1e3c9eb770e330ab3eef8c"><div class="ttname"><a href="sev_8c.html#abf63e5ae3e1e3c9eb770e330ab3eef8c">sev_flush_encrypted_page</a></div><div class="ttdeci">static void sev_flush_encrypted_page(struct kvm_vcpu *vcpu, void *va)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02329">sev.c:2329</a></div></div>
<div class="ttc" id="astructvcpu__sev__es__state_html_a40070a764eb6f9ab2573d7961a0c6f8e"><div class="ttname"><a href="structvcpu__sev__es__state.html#a40070a764eb6f9ab2573d7961a0c6f8e">vcpu_sev_es_state::vmsa</a></div><div class="ttdeci">struct sev_es_save_area * vmsa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00195">svm.h:195</a></div></div>
<div class="ttc" id="asvm_8h_html_a14877439e9d41030cb21612eecc8f3f9"><div class="ttname"><a href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a></div><div class="ttdeci">static __always_inline bool sev_es_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00332">svm.h:332</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_af343f7dd067883e0f81017a68e854c09_cgraph.png" border="0" usemap="#asvm_8h_af343f7dd067883e0f81017a68e854c09_cgraph" alt=""/></div>
<map name="asvm_8h_af343f7dd067883e0f81017a68e854c09_cgraph" id="asvm_8h_af343f7dd067883e0f81017a68e854c09_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,121,83"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="412,5,523,32"/>
<area shape="rect" href="sev_8c.html#abf63e5ae3e1e3c9eb770e330ab3eef8c" title=" " alt="" coords="169,56,364,83"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="231,107,302,133"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="571,31,677,57"/>
<area shape="rect" href="sev_8c.html#a66cc6caa9f6331de794476e911d4ce53" title=" " alt="" coords="414,56,521,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_af343f7dd067883e0f81017a68e854c09_icgraph.png" border="0" usemap="#asvm_8h_af343f7dd067883e0f81017a68e854c09_icgraph" alt=""/></div>
<map name="asvm_8h_af343f7dd067883e0f81017a68e854c09_icgraph" id="asvm_8h_af343f7dd067883e0f81017a68e854c09_icgraph">
<area shape="rect" title=" " alt="" coords="175,5,291,32"/>
<area shape="rect" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4" title=" " alt="" coords="5,5,127,32"/>
</map>
</div>

</div>
</div>
<a id="a371c2a615dd0d893b557b4c0742ab5c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a371c2a615dd0d893b557b4c0742ab5c6">&#9670;&nbsp;</a></span>sev_guest()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __always_inline bool sev_guest </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00321">321</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#ifdef CONFIG_KVM_AMD_SEV</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> *sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">return</span> sev-&gt;<a class="code" href="structkvm__sev__info.html#a6da81c9e8736479d0edee1c4e8813365">active</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a371c2a615dd0d893b557b4c0742ab5c6_cgraph.png" border="0" usemap="#asvm_8h_a371c2a615dd0d893b557b4c0742ab5c6_cgraph" alt=""/></div>
<map name="asvm_8h_a371c2a615dd0d893b557b4c0742ab5c6_cgraph" id="asvm_8h_a371c2a615dd0d893b557b4c0742ab5c6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,93,32"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="141,5,248,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a371c2a615dd0d893b557b4c0742ab5c6_icgraph.png" border="0" usemap="#asvm_8h_a371c2a615dd0d893b557b4c0742ab5c6_icgraph" alt=""/></div>
<map name="asvm_8h_a371c2a615dd0d893b557b4c0742ab5c6_icgraph" id="asvm_8h_a371c2a615dd0d893b557b4c0742ab5c6_icgraph">
<area shape="rect" title=" " alt="" coords="2091,655,2179,681"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1879,5,1965,32"/>
<area shape="rect" href="svm_8c.html#a1337a20b038f182d9e04102e22c45f79" title=" " alt="" coords="1869,56,1975,83"/>
<area shape="rect" href="sev_8c.html#a5f382f275ab065f255f452612d0b8e2f" title=" " alt="" coords="1864,461,1980,488"/>
<area shape="rect" href="sev_8c.html#ab9049ca6ec68860c52858b4a7c0b6e5e" title=" " alt="" coords="1847,513,1997,554"/>
<area shape="rect" href="sev_8c.html#ad965a231dbcd0eb9eacac28848a143a8" title=" " alt="" coords="1811,883,2033,909"/>
<area shape="rect" href="sev_8c.html#a8c4977429c23ee42a01589afc4e8b6c8" title=" " alt="" coords="1855,579,1989,605"/>
<area shape="rect" href="sev_8c.html#a85fd69118319577cfdaaa5c29085ccef" title=" " alt="" coords="1853,629,1991,656"/>
<area shape="rect" href="sev_8c.html#acb362b50ed86d332270fc6e7bd0fcfe3" title=" " alt="" coords="1843,680,2001,707"/>
<area shape="rect" href="sev_8c.html#a735eb40df817d91509a036b8e5950190" title=" " alt="" coords="1851,731,1993,757"/>
<area shape="rect" href="sev_8c.html#a4aac0b82769a9e9a6a13980f61ce8ba1" title=" " alt="" coords="1856,781,1988,808"/>
<area shape="rect" href="sev_8c.html#a4a233717598b3e11fcc62bdd74fca6cd" title=" " alt="" coords="1831,832,2013,859"/>
<area shape="rect" href="sev_8c.html#ab37c3ce91ad0ad98fb7d5676a318cde4" title=" " alt="" coords="1835,934,2009,975"/>
<area shape="rect" href="sev_8c.html#a8ed6164c0df5d13f87bce2be5a83e0d8" title=" " alt="" coords="1827,999,2017,1041"/>
<area shape="rect" href="sev_8c.html#a949ea0fcee0697916e3bf6092513ae57" title=" " alt="" coords="1851,107,1993,133"/>
<area shape="rect" href="sev_8c.html#a478b7e37b46d13565bc9f75c2898a4ff" title=" " alt="" coords="1853,157,1991,184"/>
<area shape="rect" href="sev_8c.html#a8f8b1b540aaa2edff61d82b1c4ebc67b" title=" " alt="" coords="1828,208,2016,235"/>
<area shape="rect" href="sev_8c.html#a91d7ee792dae7943526eb003f3597e94" title=" " alt="" coords="1856,259,1988,285"/>
<area shape="rect" href="sev_8c.html#a3795b9995a0cdb5ea7a6867c04eccd77" title=" " alt="" coords="1859,309,1985,336"/>
<area shape="rect" href="sev_8c.html#ae249888cd72d16f8157726334216d8e8" title=" " alt="" coords="1862,360,1982,387"/>
<area shape="rect" href="sev_8c.html#a2c14d94d1f2de5f23cd146b31f742859" title=" " alt="" coords="1837,411,2007,437"/>
<area shape="rect" href="sev_8c.html#a3b1ae3550c1b7c9973532d08d167ce2c" title=" " alt="" coords="1805,1065,2039,1092"/>
<area shape="rect" href="sev_8c.html#af1eb77eac84f085b0a943b87f783e30d" title=" " alt="" coords="1857,1116,1987,1143"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1801,1167,2043,1193"/>
<area shape="rect" href="svm_8c.html#a28ea9c19442062c9e284d39852ffab26" title=" " alt="" coords="1806,1217,2038,1244"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="1867,1268,1977,1295"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="1846,1319,1998,1361"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1612,5,1740,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="1618,56,1734,83"/>
<area shape="rect" href="sev_8c.html#a2039644d359270872404c4664a25d951" title=" " alt="" coords="1601,461,1751,488"/>
<area shape="rect" href="svm_8c.html#a0e69cefce46e7b11e1e8e056ea5b6561" title=" " alt="" coords="1609,1116,1743,1143"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1599,1432,1753,1459"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="823,1217,1043,1244"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1347,1432,1539,1459"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1336,1546,1551,1587"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1341,1301,1545,1328"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="397,1503,548,1529"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1341,1612,1546,1639"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1352,1366,1535,1407"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1113,1437,1266,1478"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1109,1335,1269,1361"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1123,1385,1256,1412"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="873,1444,992,1471"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1091,1553,1288,1580"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1104,1269,1275,1310"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="841,1269,1024,1310"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="596,1276,775,1303"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="200,1553,349,1580"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="5,1629,152,1656"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1100,1604,1279,1631"/>
</map>
</div>

</div>
</div>
<a id="ad965a231dbcd0eb9eacac28848a143a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad965a231dbcd0eb9eacac28848a143a8">&#9670;&nbsp;</a></span>sev_guest_memory_reclaimed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sev_guest_memory_reclaimed </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02365">2365</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;{</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(kvm))</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    wbinvd_on_all_cpus();</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a371c2a615dd0d893b557b4c0742ab5c6"><div class="ttname"><a href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a></div><div class="ttdeci">static __always_inline bool sev_guest(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00321">svm.h:321</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad965a231dbcd0eb9eacac28848a143a8_cgraph.png" border="0" usemap="#asvm_8h_ad965a231dbcd0eb9eacac28848a143a8_cgraph" alt=""/></div>
<map name="asvm_8h_ad965a231dbcd0eb9eacac28848a143a8_cgraph" id="asvm_8h_ad965a231dbcd0eb9eacac28848a143a8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,228,32"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="276,5,364,32"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="412,5,519,32"/>
</map>
</div>

</div>
</div>
<a id="aac550422551b71c0afe8efe176e0b55d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac550422551b71c0afe8efe176e0b55d">&#9670;&nbsp;</a></span>sev_handle_vmgexit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sev_handle_vmgexit </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02857">2857</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;{</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    <span class="keyword">struct </span>vmcb_control_area *<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a> = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    u64 ghcb_gpa, exit_code;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; </div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    <span class="comment">/* Validate the GHCB */</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    ghcb_gpa = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;ghcb_gpa;</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <span class="keywordflow">if</span> (ghcb_gpa &amp; GHCB_MSR_INFO_MASK)</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737">sev_handle_vmgexit_msr_protocol</a>(svm);</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160; </div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    <span class="keywordflow">if</span> (!ghcb_gpa) {</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;        vcpu_unimpl(vcpu, <span class="stringliteral">&quot;vmgexit: GHCB gpa is not set\n&quot;</span>);</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160; </div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        <span class="comment">/* Without a GHCB, just return right back to the guest */</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    }</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160; </div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9">kvm_vcpu_map</a>(vcpu, ghcb_gpa &gt;&gt; PAGE_SHIFT, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#aadd3d1bc5bf29afb297714dcaf151aba">ghcb_map</a>)) {</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;        <span class="comment">/* Unable to map GHCB from guest */</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;        vcpu_unimpl(vcpu, <span class="stringliteral">&quot;vmgexit: error mapping GHCB [%#llx] from guest\n&quot;</span>,</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                ghcb_gpa);</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160; </div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        <span class="comment">/* Without a GHCB, just return right back to the guest */</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    }</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160; </div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a> = svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#aadd3d1bc5bf29afb297714dcaf151aba">ghcb_map</a>.hva;</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160; </div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    trace_kvm_vmgexit_enter(vcpu-&gt;vcpu_id, svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>);</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160; </div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <a class="code" href="sev_8c.html#aeb0279b2cc9c76c69ffcca8eb578b33f">sev_es_sync_from_ghcb</a>(svm);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    ret = <a class="code" href="sev_8c.html#a362b31e7b5b278709f2aaeaf5d209104">sev_es_validate_vmgexit</a>(svm);</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160; </div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    ghcb_set_sw_exit_info_1(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>, 0);</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    ghcb_set_sw_exit_info_2(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>, 0);</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160; </div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    exit_code = <a class="code" href="sev_8c.html#a587ef51a89431a23fae3d1a002ccae97">kvm_ghcb_get_sw_exit_code</a>(<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>);</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;    <span class="keywordflow">switch</span> (exit_code) {</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <span class="keywordflow">case</span> SVM_VMGEXIT_MMIO_READ:</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;        ret = <a class="code" href="sev_8c.html#a0ed13e39856158b838d1f124dc65ad42">setup_vmgexit_scratch</a>(svm, <span class="keyword">true</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_2);</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160; </div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;        ret = <a class="code" href="x86_8c.html#ab3817b5de3526c26aa3db783658bda7e">kvm_sev_es_mmio_read</a>(vcpu,</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                       <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_1,</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;                       <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_2,</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                       svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">ghcb_sa</a>);</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="keywordflow">case</span> SVM_VMGEXIT_MMIO_WRITE:</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        ret = <a class="code" href="sev_8c.html#a0ed13e39856158b838d1f124dc65ad42">setup_vmgexit_scratch</a>(svm, <span class="keyword">false</span>, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_2);</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160; </div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;        ret = <a class="code" href="x86_8c.html#a7e89688a5ce546409542dbc6539d4dbc">kvm_sev_es_mmio_write</a>(vcpu,</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                        <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_1,</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                        <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_2,</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                        svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a33488936e12f96b72916b86d5217b91b">ghcb_sa</a>);</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <span class="keywordflow">case</span> SVM_VMGEXIT_NMI_COMPLETE:</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;        ++vcpu-&gt;stat.nmi_window_exits;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">nmi_masked</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;        kvm_make_request(KVM_REQ_EVENT, vcpu);</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        ret = 1;</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    <span class="keywordflow">case</span> SVM_VMGEXIT_AP_HLT_LOOP:</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        ret = <a class="code" href="x86_8c.html#a70f5affb692f4f4b2db2c79ac78f8c24">kvm_emulate_ap_reset_hold</a>(vcpu);</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    <span class="keywordflow">case</span> SVM_VMGEXIT_AP_JUMP_TABLE: {</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> *sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(vcpu-&gt;kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160; </div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_1) {</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;            <span class="comment">/* Set AP jump table address */</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;            sev-&gt;<a class="code" href="structkvm__sev__info.html#a786e349e8aa7806f21b4893b0f30d225">ap_jump_table</a> = <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_2;</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;            <span class="comment">/* Get AP jump table address */</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;            ghcb_set_sw_exit_info_2(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>, sev-&gt;<a class="code" href="structkvm__sev__info.html#a786e349e8aa7806f21b4893b0f30d225">ap_jump_table</a>);</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;            pr_err(<span class="stringliteral">&quot;svm: vmgexit: unsupported AP jump table request - exit_info_1=%#llx\n&quot;</span>,</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                   <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_1);</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            ghcb_set_sw_exit_info_1(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>, 2);</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;            ghcb_set_sw_exit_info_2(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>, GHCB_ERR_INVALID_INPUT);</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;        }</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160; </div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;        ret = 1;</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    }</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    <span class="keywordflow">case</span> SVM_VMGEXIT_UNSUPPORTED_EVENT:</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;        vcpu_unimpl(vcpu,</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                <span class="stringliteral">&quot;vmgexit: unsupported event - exit_info_1=%#llx, exit_info_2=%#llx\n&quot;</span>,</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;                <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_1, <a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;exit_info_2);</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;        ret = -EINVAL;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        ret = <a class="code" href="svm_8c.html#a8afafecae406016532810194f187fe2c">svm_invoke_exit_handler</a>(vcpu, exit_code);</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    }</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160; </div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a362b31e7b5b278709f2aaeaf5d209104"><div class="ttname"><a href="sev_8c.html#a362b31e7b5b278709f2aaeaf5d209104">sev_es_validate_vmgexit</a></div><div class="ttdeci">static int sev_es_validate_vmgexit(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02489">sev.c:2489</a></div></div>
<div class="ttc" id="asev_8c_html_a587ef51a89431a23fae3d1a002ccae97"><div class="ttname"><a href="sev_8c.html#a587ef51a89431a23fae3d1a002ccae97">kvm_ghcb_get_sw_exit_code</a></div><div class="ttdeci">static u64 kvm_ghcb_get_sw_exit_code(struct vmcb_control_area *control)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02484">sev.c:2484</a></div></div>
<div class="ttc" id="asev_8c_html_ae483e70b55c68f5a2405263543ce3737"><div class="ttname"><a href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737">sev_handle_vmgexit_msr_protocol</a></div><div class="ttdeci">static int sev_handle_vmgexit_msr_protocol(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02771">sev.c:2771</a></div></div>
<div class="ttc" id="asev_8c_html_aeb0279b2cc9c76c69ffcca8eb578b33f"><div class="ttname"><a href="sev_8c.html#aeb0279b2cc9c76c69ffcca8eb578b33f">sev_es_sync_from_ghcb</a></div><div class="ttdeci">static void sev_es_sync_from_ghcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02435">sev.c:2435</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a786e349e8aa7806f21b4893b0f30d225"><div class="ttname"><a href="structkvm__sev__info.html#a786e349e8aa7806f21b4893b0f30d225">kvm_sev_info::ap_jump_table</a></div><div class="ttdeci">u64 ap_jump_table</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00087">svm.h:87</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a512e38d5dc99356b62e4b2cba0ab6d3d"><div class="ttname"><a href="structvcpu__svm.html#a512e38d5dc99356b62e4b2cba0ab6d3d">vcpu_svm::nmi_masked</a></div><div class="ttdeci">bool nmi_masked</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00241">svm.h:241</a></div></div>
<div class="ttc" id="asvm_8c_html_a8afafecae406016532810194f187fe2c"><div class="ttname"><a href="svm_8c.html#a8afafecae406016532810194f187fe2c">svm_invoke_exit_handler</a></div><div class="ttdeci">int svm_invoke_exit_handler(struct kvm_vcpu *vcpu, u64 exit_code)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03453">svm.c:3453</a></div></div>
<div class="ttc" id="ax86_8c_html_a70f5affb692f4f4b2db2c79ac78f8c24"><div class="ttname"><a href="x86_8c.html#a70f5affb692f4f4b2db2c79ac78f8c24">kvm_emulate_ap_reset_hold</a></div><div class="ttdeci">int kvm_emulate_ap_reset_hold(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09868">x86.c:9868</a></div></div>
<div class="ttc" id="ax86_8c_html_a7e89688a5ce546409542dbc6539d4dbc"><div class="ttname"><a href="x86_8c.html#a7e89688a5ce546409542dbc6539d4dbc">kvm_sev_es_mmio_write</a></div><div class="ttdeci">int kvm_sev_es_mmio_write(struct kvm_vcpu *vcpu, gpa_t gpa, unsigned int bytes, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13722">x86.c:13722</a></div></div>
<div class="ttc" id="ax86_8c_html_ab3817b5de3526c26aa3db783658bda7e"><div class="ttname"><a href="x86_8c.html#ab3817b5de3526c26aa3db783658bda7e">kvm_sev_es_mmio_read</a></div><div class="ttdeci">int kvm_sev_es_mmio_read(struct kvm_vcpu *vcpu, gpa_t gpa, unsigned int bytes, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l13761">x86.c:13761</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aac550422551b71c0afe8efe176e0b55d_cgraph.png" border="0" usemap="#asvm_8h_aac550422551b71c0afe8efe176e0b55d_cgraph" alt=""/></div>
<map name="asvm_8h_aac550422551b71c0afe8efe176e0b55d_cgraph" id="asvm_8h_aac550422551b71c0afe8efe176e0b55d_cgraph">
<area shape="rect" title=" " alt="" coords="5,284,163,311"/>
<area shape="rect" href="x86_8c.html#a70f5affb692f4f4b2db2c79ac78f8c24" title=" " alt="" coords="749,360,959,387"/>
<area shape="rect" href="sev_8c.html#a587ef51a89431a23fae3d1a002ccae97" title=" " alt="" coords="465,208,677,235"/>
<area shape="rect" href="x86_8c.html#ab3817b5de3526c26aa3db783658bda7e" title=" " alt="" coords="213,107,397,133"/>
<area shape="rect" href="x86_8c.html#a7e89688a5ce546409542dbc6539d4dbc" title=" " alt="" coords="211,56,399,83"/>
<area shape="rect" href="kvm__main_8c.html#a96c7b38454f962b34da813b043f4abe9" title=" " alt="" coords="242,5,367,32"/>
<area shape="rect" href="sev_8c.html#a0ed13e39856158b838d1f124dc65ad42" title=" " alt="" coords="218,157,391,184"/>
<area shape="rect" href="sev_8c.html#aeb0279b2cc9c76c69ffcca8eb578b33f" title=" " alt="" coords="215,309,395,336"/>
<area shape="rect" href="sev_8c.html#a362b31e7b5b278709f2aaeaf5d209104" title=" " alt="" coords="211,259,399,285"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="226,454,383,495"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="477,563,665,589"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1349,613,1419,640"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="251,917,358,944"/>
<area shape="rect" href="x86_8c.html#ad9a061ca4a3ded30c0c698224da4504d" title=" " alt="" coords="1305,309,1463,336"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="1012,411,1243,437"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="1558,272,1677,299"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="1293,411,1475,437"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="1291,541,1477,568"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1556,373,1679,400"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1538,425,1697,466"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1530,491,1705,517"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1532,323,1703,349"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1544,592,1691,619"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="1525,541,1709,568"/>
<area shape="rect" href="x86_8c.html#a487702645721b25af56424d26a14ffd5" title=" " alt="" coords="447,81,696,108"/>
<area shape="rect" href="kvm__main_8c.html#a055190afb6bce32ba87e7fea907ec1ec" title=" " alt="" coords="526,5,617,32"/>
<area shape="rect" href="kvm__main_8c.html#a7c20e0f654f0b4472c3833f0a563e11e" title=" " alt="" coords="1063,56,1191,83"/>
<area shape="rect" href="kvm__main_8c.html#aa77d8fc2ee9fe5965c45f1d0989eb266" title=" " alt="" coords="776,56,932,83"/>
<area shape="rect" href="kvm__main_8c.html#a3cc887a9ecfdd6e9f5ab90dc2ce8de4a" title=" " alt="" coords="506,157,637,184"/>
<area shape="rect" href="kvm__main_8c.html#a2a95905782c4136bdf6d9861f937b0ef" title=" " alt="" coords="769,107,939,133"/>
<area shape="rect" href="kvm__main_8c.html#a03aae88de564edba8a3a2d10bc5e7b20" title=" " alt="" coords="797,157,911,184"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="470,309,673,336"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="775,294,933,335"/>
<area shape="rect" href="sev_8c.html#ad8823190c27862d96468aca70aef81c2" title=" " alt="" coords="523,259,620,285"/>
<area shape="rect" href="sev_8c.html#adb7ff474b157336f8c7dd8ce919bfdd1" title=" " alt="" coords="499,411,643,437"/>
<area shape="rect" href="sev_8c.html#a791cdac9e53d50f78c0943d78462f16e" title=" " alt="" coords="515,461,627,488"/>
<area shape="rect" href="sev_8c.html#a9816022be04ccfa4aa8d91ac6b63e810" title=" " alt="" coords="500,512,643,539"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="744,765,964,792"/>
<area shape="rect" href="svm_8c.html#a21af2401d39dc5c49a388960ce1196ad" title=" " alt="" coords="789,461,919,488"/>
<area shape="rect" href="x86_8c.html#a92f17256a8d83aac265d08a1e3500340" title=" " alt="" coords="782,411,926,437"/>
<area shape="rect" href="svm_8c.html#a173c3f7c02a4287d140cc0f34564a7bd" title=" " alt="" coords="788,664,920,691"/>
<area shape="rect" href="svm_8c.html#a723646ac5d3234ba8e1845249e6a0935" title=" " alt="" coords="790,563,918,589"/>
<area shape="rect" href="svm_8c.html#ad838ad3f2e1e678e2c13720c679dc8f8" title=" " alt="" coords="771,613,937,640"/>
<area shape="rect" href="svm_8c.html#ab46a833ac93ce3fda7973768cadb1929" title=" " alt="" coords="762,512,946,539"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="1064,765,1191,792"/>
<area shape="rect" href="x86_8c.html#a8e4eadde8e72cc522781d684a646fbe6" title=" " alt="" coords="1030,360,1225,387"/>
<area shape="rect" href="x86_8c.html#a955a40f66041d085593b16a75075a1ae" title=" " alt="" coords="1049,715,1206,741"/>
<area shape="rect" href="x86_8c.html#a1550ae1115ac5be61ab770f6f3c5f513" title=" " alt="" coords="1047,664,1207,691"/>
<area shape="rect" href="mmu_8c.html#a3d0bd209d792a4316f3b40681fdc10f9" title=" " alt="" coords="1043,512,1211,539"/>
<area shape="rect" href="svm_8c.html#adc30f731ef4ff2d797ec137e5fab0f69" title=" " alt="" coords="1076,461,1179,488"/>
</map>
</div>

</div>
</div>
<a id="a9afc6299b4f92c15a93b02db0318ad79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9afc6299b4f92c15a93b02db0318ad79">&#9670;&nbsp;</a></span>sev_hardware_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __init sev_hardware_setup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02193">2193</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;{</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="preprocessor">#ifdef CONFIG_KVM_AMD_SEV</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> eax, ebx, ecx, edx, sev_asid_count, sev_es_asid_count;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="keywordtype">bool</span> sev_es_supported = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="keywordtype">bool</span> sev_supported = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160; </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#a8cea9180251b2d380c09e0fd8be68b74">sev_enabled</a> || !<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a> || !<a class="code" href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a>)</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">     * SEV must obviously be supported in hardware.  Sanity check that the</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">     * CPU supports decode assists, which is mandatory for SEV guests to</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment">     * support instruction emulation.  Ditto for flushing by ASID, as SEV</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">     * guests are bound to a single ASID, i.e. KVM can&#39;t rotate to a new</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">     * ASID to effect a TLB flush.</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_SEV) ||</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        WARN_ON_ONCE(!boot_cpu_has(X86_FEATURE_DECODEASSISTS)) ||</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        WARN_ON_ONCE(!boot_cpu_has(X86_FEATURE_FLUSHBYASID)))</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="comment">/* Retrieve SEV CPUID information */</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    cpuid(0x8000001f, &amp;eax, &amp;ebx, &amp;ecx, &amp;edx);</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <span class="comment">/* Set encryption bit location for SEV-ES guests */</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <a class="code" href="sev_8c.html#acec833aa968184a19e035fd0cb10b369">sev_enc_bit</a> = ebx &amp; 0x3f;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="comment">/* Maximum number of encrypted guests supported simultaneously */</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <a class="code" href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a> = ecx;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a>)</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160; </div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <span class="comment">/* Minimum ASID value that should be used for SEV guest */</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <a class="code" href="sev_8c.html#af71d0f36be40d235f5f9d50515e33e87">min_sev_asid</a> = edx;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <a class="code" href="sev_8c.html#a68fa42c09ca63e03fca8829ee26e18f1">sev_me_mask</a> = 1UL &lt;&lt; (ebx &amp; 0x3f);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; </div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">     * Initialize SEV ASID bitmaps. Allocate space for ASID 0 in the bitmap,</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment">     * even though it&#39;s never used, so that the bitmap is indexed by the</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="comment">     * actual ASID.</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <a class="code" href="sev_8c.html#a30f4a3ca065f757024e9fe4d0c39e2c9">nr_asids</a> = <a class="code" href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a> + 1;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <a class="code" href="sev_8c.html#ad1d0f632d1c2c4f6b85658adfb4bb1cb">sev_asid_bitmap</a> = bitmap_zalloc(<a class="code" href="sev_8c.html#a30f4a3ca065f757024e9fe4d0c39e2c9">nr_asids</a>, GFP_KERNEL);</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#ad1d0f632d1c2c4f6b85658adfb4bb1cb">sev_asid_bitmap</a>)</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; </div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <a class="code" href="sev_8c.html#afbfa33ad6adf375e1324a9d3b17e2d7d">sev_reclaim_asid_bitmap</a> = bitmap_zalloc(<a class="code" href="sev_8c.html#a30f4a3ca065f757024e9fe4d0c39e2c9">nr_asids</a>, GFP_KERNEL);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#afbfa33ad6adf375e1324a9d3b17e2d7d">sev_reclaim_asid_bitmap</a>) {</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        bitmap_free(<a class="code" href="sev_8c.html#ad1d0f632d1c2c4f6b85658adfb4bb1cb">sev_asid_bitmap</a>);</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        <a class="code" href="sev_8c.html#ad1d0f632d1c2c4f6b85658adfb4bb1cb">sev_asid_bitmap</a> = NULL;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    }</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sev_8c.html#af71d0f36be40d235f5f9d50515e33e87">min_sev_asid</a> &lt;= <a class="code" href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a>) {</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        sev_asid_count = <a class="code" href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a> - <a class="code" href="sev_8c.html#af71d0f36be40d235f5f9d50515e33e87">min_sev_asid</a> + 1;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;        WARN_ON_ONCE(misc_cg_set_capacity(<a class="code" href="sev_8c.html#acb3e1e98fc4c4948c6b74a81dced6809">MISC_CG_RES_SEV</a>, sev_asid_count));</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    }</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    sev_supported = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160; </div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="comment">/* SEV-ES support requested? */</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#a54a0753d622e67925f7803c15a588e55">sev_es_enabled</a>)</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; </div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment">     * SEV-ES requires MMIO caching as KVM doesn&#39;t have access to the guest</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="comment">     * instruction stream, i.e. can&#39;t emulate in response to a #NPF and</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment">     * instead relies on #NPF(RSVD) being reflected into the guest as #VC</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment">     * (the guest can then do a #VMGEXIT to request MMIO emulation).</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="spte_8c.html#ad1f35c581f53d7ebf9ada1be6d5531ad">enable_mmio_caching</a>)</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="comment">/* Does the CPU support SEV-ES? */</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    <span class="keywordflow">if</span> (!boot_cpu_has(X86_FEATURE_SEV_ES))</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160; </div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="comment">/* Has the system been allocated ASIDs for SEV-ES? */</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sev_8c.html#af71d0f36be40d235f5f9d50515e33e87">min_sev_asid</a> == 1)</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160; </div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    sev_es_asid_count = <a class="code" href="sev_8c.html#af71d0f36be40d235f5f9d50515e33e87">min_sev_asid</a> - 1;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    WARN_ON_ONCE(misc_cg_set_capacity(<a class="code" href="sev_8c.html#a6e8c624b8e6eb539133d62a41ac36cbb">MISC_CG_RES_SEV_ES</a>, sev_es_asid_count));</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    sev_es_supported = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;out:</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_SEV))</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        pr_info(<span class="stringliteral">&quot;SEV %s (ASIDs %u - %u)\n&quot;</span>,</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            sev_supported ? <a class="code" href="sev_8c.html#af71d0f36be40d235f5f9d50515e33e87">min_sev_asid</a> &lt;= <a class="code" href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a> ? <span class="stringliteral">&quot;enabled&quot;</span> :</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                                       <span class="stringliteral">&quot;unusable&quot;</span> :</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                                       <span class="stringliteral">&quot;disabled&quot;</span>,</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            <a class="code" href="sev_8c.html#af71d0f36be40d235f5f9d50515e33e87">min_sev_asid</a>, <a class="code" href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a>);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    <span class="keywordflow">if</span> (boot_cpu_has(X86_FEATURE_SEV_ES))</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        pr_info(<span class="stringliteral">&quot;SEV-ES %s (ASIDs %u - %u)\n&quot;</span>,</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            sev_es_supported ? <span class="stringliteral">&quot;enabled&quot;</span> : <span class="stringliteral">&quot;disabled&quot;</span>,</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            <a class="code" href="sev_8c.html#af71d0f36be40d235f5f9d50515e33e87">min_sev_asid</a> &gt; 1 ? 1 : 0, <a class="code" href="sev_8c.html#af71d0f36be40d235f5f9d50515e33e87">min_sev_asid</a> - 1);</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160; </div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <a class="code" href="sev_8c.html#a8cea9180251b2d380c09e0fd8be68b74">sev_enabled</a> = sev_supported;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    <a class="code" href="sev_8c.html#a54a0753d622e67925f7803c15a588e55">sev_es_enabled</a> = sev_es_supported;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#a54a0753d622e67925f7803c15a588e55">sev_es_enabled</a> || !cpu_feature_enabled(X86_FEATURE_DEBUG_SWAP) ||</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        !cpu_feature_enabled(X86_FEATURE_NO_NESTED_DATA_BP))</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        <a class="code" href="sev_8c.html#ab97dff3e3e9b4e85cfc71316a06df95a">sev_es_debug_swap_enabled</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a37d57b174f959f39f30e8f0796dc3afb"><div class="ttname"><a href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a></div><div class="ttdeci">unsigned int max_sev_asid</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00071">sev.c:71</a></div></div>
<div class="ttc" id="asev_8c_html_a54a0753d622e67925f7803c15a588e55"><div class="ttname"><a href="sev_8c.html#a54a0753d622e67925f7803c15a588e55">sev_es_enabled</a></div><div class="ttdeci">#define sev_es_enabled</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00064">sev.c:64</a></div></div>
<div class="ttc" id="asev_8c_html_a68fa42c09ca63e03fca8829ee26e18f1"><div class="ttname"><a href="sev_8c.html#a68fa42c09ca63e03fca8829ee26e18f1">sev_me_mask</a></div><div class="ttdeci">static unsigned long sev_me_mask</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00073">sev.c:73</a></div></div>
<div class="ttc" id="asev_8c_html_a6e8c624b8e6eb539133d62a41ac36cbb"><div class="ttname"><a href="sev_8c.html#a6e8c624b8e6eb539133d62a41ac36cbb">MISC_CG_RES_SEV_ES</a></div><div class="ttdeci">#define MISC_CG_RES_SEV_ES</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00047">sev.c:47</a></div></div>
<div class="ttc" id="asev_8c_html_acb3e1e98fc4c4948c6b74a81dced6809"><div class="ttname"><a href="sev_8c.html#acb3e1e98fc4c4948c6b74a81dced6809">MISC_CG_RES_SEV</a></div><div class="ttdeci">#define MISC_CG_RES_SEV</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00046">sev.c:46</a></div></div>
<div class="ttc" id="asev_8c_html_ad1d0f632d1c2c4f6b85658adfb4bb1cb"><div class="ttname"><a href="sev_8c.html#ad1d0f632d1c2c4f6b85658adfb4bb1cb">sev_asid_bitmap</a></div><div class="ttdeci">static unsigned long * sev_asid_bitmap</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00075">sev.c:75</a></div></div>
<div class="ttc" id="asev_8c_html_af71d0f36be40d235f5f9d50515e33e87"><div class="ttname"><a href="sev_8c.html#af71d0f36be40d235f5f9d50515e33e87">min_sev_asid</a></div><div class="ttdeci">static unsigned int min_sev_asid</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00072">sev.c:72</a></div></div>
<div class="ttc" id="asev_8c_html_afbfa33ad6adf375e1324a9d3b17e2d7d"><div class="ttname"><a href="sev_8c.html#afbfa33ad6adf375e1324a9d3b17e2d7d">sev_reclaim_asid_bitmap</a></div><div class="ttdeci">static unsigned long * sev_reclaim_asid_bitmap</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00076">sev.c:76</a></div></div>
<div class="ttc" id="aspte_8c_html_ad1f35c581f53d7ebf9ada1be6d5531ad"><div class="ttname"><a href="spte_8c.html#ad1f35c581f53d7ebf9ada1be6d5531ad">enable_mmio_caching</a></div><div class="ttdeci">bool __read_mostly enable_mmio_caching</div><div class="ttdef"><b>Definition:</b> <a href="spte_8c_source.html#l00022">spte.c:22</a></div></div>
<div class="ttc" id="asvm_8c_html_aea86d846f25c8a44402d3bc2d176130b"><div class="ttname"><a href="svm_8c.html#aea86d846f25c8a44402d3bc2d176130b">nrips</a></div><div class="ttdeci">int nrips</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00206">svm.c:206</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a9afc6299b4f92c15a93b02db0318ad79_icgraph.png" border="0" usemap="#asvm_8h_a9afc6299b4f92c15a93b02db0318ad79_icgraph" alt=""/></div>
<map name="asvm_8h_a9afc6299b4f92c15a93b02db0318ad79_icgraph" id="asvm_8h_a9afc6299b4f92c15a93b02db0318ad79_icgraph">
<area shape="rect" title=" " alt="" coords="215,5,371,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="a0bc306a80e6f2622f2c58d1271dcc05b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bc306a80e6f2622f2c58d1271dcc05b">&#9670;&nbsp;</a></span>sev_hardware_unsetup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sev_hardware_unsetup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02298">2298</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;{</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#a8cea9180251b2d380c09e0fd8be68b74">sev_enabled</a>)</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160; </div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="comment">/* No need to take sev_bitmap_lock, all VMs have been destroyed. */</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <a class="code" href="sev_8c.html#a4987bfdf20b1a61d4718ceeb2aaceff6">sev_flush_asids</a>(1, <a class="code" href="sev_8c.html#a37d57b174f959f39f30e8f0796dc3afb">max_sev_asid</a>);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    bitmap_free(<a class="code" href="sev_8c.html#ad1d0f632d1c2c4f6b85658adfb4bb1cb">sev_asid_bitmap</a>);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    bitmap_free(<a class="code" href="sev_8c.html#afbfa33ad6adf375e1324a9d3b17e2d7d">sev_reclaim_asid_bitmap</a>);</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160; </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    misc_cg_set_capacity(<a class="code" href="sev_8c.html#acb3e1e98fc4c4948c6b74a81dced6809">MISC_CG_RES_SEV</a>, 0);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    misc_cg_set_capacity(<a class="code" href="sev_8c.html#a6e8c624b8e6eb539133d62a41ac36cbb">MISC_CG_RES_SEV_ES</a>, 0);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a4987bfdf20b1a61d4718ceeb2aaceff6"><div class="ttname"><a href="sev_8c.html#a4987bfdf20b1a61d4718ceeb2aaceff6">sev_flush_asids</a></div><div class="ttdeci">static int sev_flush_asids(unsigned int min_asid, unsigned int max_asid)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00087">sev.c:87</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a0bc306a80e6f2622f2c58d1271dcc05b_cgraph.png" border="0" usemap="#asvm_8h_a0bc306a80e6f2622f2c58d1271dcc05b_cgraph" alt=""/></div>
<map name="asvm_8h_a0bc306a80e6f2622f2c58d1271dcc05b_cgraph" id="asvm_8h_a0bc306a80e6f2622f2c58d1271dcc05b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,177,32"/>
<area shape="rect" href="sev_8c.html#a4987bfdf20b1a61d4718ceeb2aaceff6" title=" " alt="" coords="225,5,349,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a0bc306a80e6f2622f2c58d1271dcc05b_icgraph.png" border="0" usemap="#asvm_8h_a0bc306a80e6f2622f2c58d1271dcc05b_icgraph" alt=""/></div>
<map name="asvm_8h_a0bc306a80e6f2622f2c58d1271dcc05b_icgraph" id="asvm_8h_a0bc306a80e6f2622f2c58d1271dcc05b_icgraph">
<area shape="rect" title=" " alt="" coords="440,5,612,32"/>
<area shape="rect" href="svm_8c.html#a96aba01528b17e2beabf86e9c19ac13a" title=" " alt="" coords="215,5,392,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="abe289006ed99e36825065ad80cf7480f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe289006ed99e36825065ad80cf7480f">&#9670;&nbsp;</a></span>sev_init_vmcb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sev_init_vmcb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l03093">3093</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;{</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.nested_ctl |= SVM_NESTED_CTL_SEV_ENABLE;</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <a class="code" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a>(svm, UD_VECTOR);</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160; </div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;<span class="comment">     * Don&#39;t intercept #GP for SEV guests, e.g. for the VMware backdoor, as</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;<span class="comment">     * KVM can&#39;t decrypt guest memory to decode the faulting instruction.</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <a class="code" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a>(svm, GP_VECTOR);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160; </div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.kvm))</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;        <a class="code" href="sev_8c.html#a61aab05258497c5477227b8171f6f658">sev_es_init_vmcb</a>(svm);</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a61aab05258497c5477227b8171f6f658"><div class="ttname"><a href="sev_8c.html#a61aab05258497c5477227b8171f6f658">sev_es_init_vmcb</a></div><div class="ttdeci">static void sev_es_init_vmcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03029">sev.c:3029</a></div></div>
<div class="ttc" id="asvm_8h_html_a0e9d1e1a7652ad926236f0f44891293c"><div class="ttname"><a href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a></div><div class="ttdeci">static void clr_exception_intercept(struct vcpu_svm *svm, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00413">svm.h:413</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_abe289006ed99e36825065ad80cf7480f_cgraph.png" border="0" usemap="#asvm_8h_abe289006ed99e36825065ad80cf7480f_cgraph" alt=""/></div>
<map name="asvm_8h_abe289006ed99e36825065ad80cf7480f_cgraph" id="asvm_8h_abe289006ed99e36825065ad80cf7480f_cgraph">
<area shape="rect" title=" " alt="" coords="5,60,121,87"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="356,60,531,87"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="183,9,294,36"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="169,161,308,188"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="610,111,743,137"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="851,5,998,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="865,107,985,133"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="833,158,1016,199"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="834,223,1015,265"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="857,56,993,83"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="849,289,1000,316"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1102,256,1221,283"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1085,205,1238,232"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1535,249,1708,290"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1296,281,1487,308"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="390,9,497,36"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="610,165,743,192"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="364,457,523,484"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="374,111,513,137"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="372,161,515,188"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="597,450,756,491"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="579,559,775,585"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="854,340,995,367"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="823,391,1027,433"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="851,457,998,484"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="889,559,960,585"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="849,508,1000,535"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="1075,559,1248,585"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_abe289006ed99e36825065ad80cf7480f_icgraph.png" border="0" usemap="#asvm_8h_abe289006ed99e36825065ad80cf7480f_icgraph" alt=""/></div>
<map name="asvm_8h_abe289006ed99e36825065ad80cf7480f_icgraph" id="asvm_8h_abe289006ed99e36825065ad80cf7480f_icgraph">
<area shape="rect" title=" " alt="" coords="484,31,600,57"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="322,5,409,32"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="295,56,436,83"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="62,5,190,32"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="5,56,247,83"/>
</map>
</div>

</div>
</div>
<a id="a2039644d359270872404c4664a25d951"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2039644d359270872404c4664a25d951">&#9670;&nbsp;</a></span>sev_mem_enc_ioctl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sev_mem_enc_ioctl </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void __user *&#160;</td>
          <td class="paramname"><em>argp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l01862">1862</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;{</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="keyword">struct </span>kvm_sev_cmd sev_cmd;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160; </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#a8cea9180251b2d380c09e0fd8be68b74">sev_enabled</a>)</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        <span class="keywordflow">return</span> -ENOTTY;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="keywordflow">if</span> (!argp)</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160; </div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keywordflow">if</span> (copy_from_user(&amp;sev_cmd, argp, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> kvm_sev_cmd)))</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        <span class="keywordflow">return</span> -EFAULT;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160; </div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    mutex_lock(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160; </div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="comment">/* Only the enc_context_owner handles some memory enc operations. */</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc">is_mirroring_enc_context</a>(kvm) &amp;&amp;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        !<a class="code" href="sev_8c.html#af6d8a53a5273e6f8c2768623e9896f57">is_cmd_allowed_from_mirror</a>(sev_cmd.id)) {</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        r = -EINVAL;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    }</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; </div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="keywordflow">switch</span> (sev_cmd.id) {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_ES_INIT:</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#a54a0753d622e67925f7803c15a588e55">sev_es_enabled</a>) {</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            r = -ENOTTY;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;            <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        }</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        fallthrough;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_INIT:</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        r = <a class="code" href="sev_8c.html#ac62526aea63f9ac646eb3c3fbe4b0681">sev_guest_init</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_LAUNCH_START:</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        r = <a class="code" href="sev_8c.html#a4aac0b82769a9e9a6a13980f61ce8ba1">sev_launch_start</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_LAUNCH_UPDATE_DATA:</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        r = <a class="code" href="sev_8c.html#a4a233717598b3e11fcc62bdd74fca6cd">sev_launch_update_data</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_LAUNCH_UPDATE_VMSA:</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        r = <a class="code" href="sev_8c.html#a58da6a47d3ee35e28a426faf878a943e">sev_launch_update_vmsa</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_LAUNCH_MEASURE:</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        r = <a class="code" href="sev_8c.html#acb362b50ed86d332270fc6e7bd0fcfe3">sev_launch_measure</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_LAUNCH_FINISH:</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        r = <a class="code" href="sev_8c.html#a85fd69118319577cfdaaa5c29085ccef">sev_launch_finish</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_GUEST_STATUS:</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        r = <a class="code" href="sev_8c.html#a8c4977429c23ee42a01589afc4e8b6c8">sev_guest_status</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_DBG_DECRYPT:</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        r = <a class="code" href="sev_8c.html#a5f382f275ab065f255f452612d0b8e2f">sev_dbg_crypt</a>(kvm, &amp;sev_cmd, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_DBG_ENCRYPT:</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        r = <a class="code" href="sev_8c.html#a5f382f275ab065f255f452612d0b8e2f">sev_dbg_crypt</a>(kvm, &amp;sev_cmd, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_LAUNCH_SECRET:</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        r = <a class="code" href="sev_8c.html#a735eb40df817d91509a036b8e5950190">sev_launch_secret</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_GET_ATTESTATION_REPORT:</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        r = <a class="code" href="sev_8c.html#ab9049ca6ec68860c52858b4a7c0b6e5e">sev_get_attestation_report</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_SEND_START:</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        r = <a class="code" href="sev_8c.html#ae249888cd72d16f8157726334216d8e8">sev_send_start</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_SEND_UPDATE_DATA:</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        r = <a class="code" href="sev_8c.html#a2c14d94d1f2de5f23cd146b31f742859">sev_send_update_data</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_SEND_FINISH:</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        r = <a class="code" href="sev_8c.html#a3795b9995a0cdb5ea7a6867c04eccd77">sev_send_finish</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_SEND_CANCEL:</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        r = <a class="code" href="sev_8c.html#a91d7ee792dae7943526eb003f3597e94">sev_send_cancel</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_RECEIVE_START:</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        r = <a class="code" href="sev_8c.html#a478b7e37b46d13565bc9f75c2898a4ff">sev_receive_start</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_RECEIVE_UPDATE_DATA:</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        r = <a class="code" href="sev_8c.html#a8f8b1b540aaa2edff61d82b1c4ebc67b">sev_receive_update_data</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keywordflow">case</span> KVM_SEV_RECEIVE_FINISH:</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        r = <a class="code" href="sev_8c.html#a949ea0fcee0697916e3bf6092513ae57">sev_receive_finish</a>(kvm, &amp;sev_cmd);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        r = -EINVAL;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    }</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="keywordflow">if</span> (copy_to_user(argp, &amp;sev_cmd, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> kvm_sev_cmd)))</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        r = -EFAULT;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160; </div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;out:</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    mutex_unlock(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a2c14d94d1f2de5f23cd146b31f742859"><div class="ttname"><a href="sev_8c.html#a2c14d94d1f2de5f23cd146b31f742859">sev_send_update_data</a></div><div class="ttdeci">static int sev_send_update_data(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01295">sev.c:1295</a></div></div>
<div class="ttc" id="asev_8c_html_a3795b9995a0cdb5ea7a6867c04eccd77"><div class="ttname"><a href="sev_8c.html#a3795b9995a0cdb5ea7a6867c04eccd77">sev_send_finish</a></div><div class="ttdeci">static int sev_send_finish(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01380">sev.c:1380</a></div></div>
<div class="ttc" id="asev_8c_html_a478b7e37b46d13565bc9f75c2898a4ff"><div class="ttname"><a href="sev_8c.html#a478b7e37b46d13565bc9f75c2898a4ff">sev_receive_start</a></div><div class="ttdeci">static int sev_receive_start(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01404">sev.c:1404</a></div></div>
<div class="ttc" id="asev_8c_html_a4a233717598b3e11fcc62bdd74fca6cd"><div class="ttname"><a href="sev_8c.html#a4a233717598b3e11fcc62bdd74fca6cd">sev_launch_update_data</a></div><div class="ttdeci">static int sev_launch_update_data(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00511">sev.c:511</a></div></div>
<div class="ttc" id="asev_8c_html_a4aac0b82769a9e9a6a13980f61ce8ba1"><div class="ttname"><a href="sev_8c.html#a4aac0b82769a9e9a6a13980f61ce8ba1">sev_launch_start</a></div><div class="ttdeci">static int sev_launch_start(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00328">sev.c:328</a></div></div>
<div class="ttc" id="asev_8c_html_a58da6a47d3ee35e28a426faf878a943e"><div class="ttname"><a href="sev_8c.html#a58da6a47d3ee35e28a426faf878a943e">sev_launch_update_vmsa</a></div><div class="ttdeci">static int sev_launch_update_vmsa(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00670">sev.c:670</a></div></div>
<div class="ttc" id="asev_8c_html_a5f382f275ab065f255f452612d0b8e2f"><div class="ttname"><a href="sev_8c.html#a5f382f275ab065f255f452612d0b8e2f">sev_dbg_crypt</a></div><div class="ttdeci">static int sev_dbg_crypt(struct kvm *kvm, struct kvm_sev_cmd *argp, bool dec)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00941">sev.c:941</a></div></div>
<div class="ttc" id="asev_8c_html_a70ad599e38cbdaca8ac3d21348d736bc"><div class="ttname"><a href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc">is_mirroring_enc_context</a></div><div class="ttdeci">static bool is_mirroring_enc_context(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00114">sev.c:114</a></div></div>
<div class="ttc" id="asev_8c_html_a735eb40df817d91509a036b8e5950190"><div class="ttname"><a href="sev_8c.html#a735eb40df817d91509a036b8e5950190">sev_launch_secret</a></div><div class="ttdeci">static int sev_launch_secret(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01025">sev.c:1025</a></div></div>
<div class="ttc" id="asev_8c_html_a85fd69118319577cfdaaa5c29085ccef"><div class="ttname"><a href="sev_8c.html#a85fd69118319577cfdaaa5c29085ccef">sev_launch_finish</a></div><div class="ttdeci">static int sev_launch_finish(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00756">sev.c:756</a></div></div>
<div class="ttc" id="asev_8c_html_a8c4977429c23ee42a01589afc4e8b6c8"><div class="ttname"><a href="sev_8c.html#a8c4977429c23ee42a01589afc4e8b6c8">sev_guest_status</a></div><div class="ttdeci">static int sev_guest_status(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00768">sev.c:768</a></div></div>
<div class="ttc" id="asev_8c_html_a8f8b1b540aaa2edff61d82b1c4ebc67b"><div class="ttname"><a href="sev_8c.html#a8f8b1b540aaa2edff61d82b1c4ebc67b">sev_receive_update_data</a></div><div class="ttdeci">static int sev_receive_update_data(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01478">sev.c:1478</a></div></div>
<div class="ttc" id="asev_8c_html_a91d7ee792dae7943526eb003f3597e94"><div class="ttname"><a href="sev_8c.html#a91d7ee792dae7943526eb003f3597e94">sev_send_cancel</a></div><div class="ttdeci">static int sev_send_cancel(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01392">sev.c:1392</a></div></div>
<div class="ttc" id="asev_8c_html_a949ea0fcee0697916e3bf6092513ae57"><div class="ttname"><a href="sev_8c.html#a949ea0fcee0697916e3bf6092513ae57">sev_receive_finish</a></div><div class="ttdeci">static int sev_receive_finish(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01555">sev.c:1555</a></div></div>
<div class="ttc" id="asev_8c_html_ab9049ca6ec68860c52858b4a7c0b6e5e"><div class="ttname"><a href="sev_8c.html#ab9049ca6ec68860c52858b4a7c0b6e5e">sev_get_attestation_report</a></div><div class="ttdeci">static int sev_get_attestation_report(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01100">sev.c:1100</a></div></div>
<div class="ttc" id="asev_8c_html_ac62526aea63f9ac646eb3c3fbe4b0681"><div class="ttname"><a href="sev_8c.html#ac62526aea63f9ac646eb3c3fbe4b0681">sev_guest_init</a></div><div class="ttdeci">static int sev_guest_init(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00253">sev.c:253</a></div></div>
<div class="ttc" id="asev_8c_html_acb362b50ed86d332270fc6e7bd0fcfe3"><div class="ttname"><a href="sev_8c.html#acb362b50ed86d332270fc6e7bd0fcfe3">sev_launch_measure</a></div><div class="ttdeci">static int sev_launch_measure(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00694">sev.c:694</a></div></div>
<div class="ttc" id="asev_8c_html_ae249888cd72d16f8157726334216d8e8"><div class="ttname"><a href="sev_8c.html#ae249888cd72d16f8157726334216d8e8">sev_send_start</a></div><div class="ttdeci">static int sev_send_start(struct kvm *kvm, struct kvm_sev_cmd *argp)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01182">sev.c:1182</a></div></div>
<div class="ttc" id="asev_8c_html_af6d8a53a5273e6f8c2768623e9896f57"><div class="ttname"><a href="sev_8c.html#af6d8a53a5273e6f8c2768623e9896f57">is_cmd_allowed_from_mirror</a></div><div class="ttdeci">static bool is_cmd_allowed_from_mirror(u32 cmd_id)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01567">sev.c:1567</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a2039644d359270872404c4664a25d951_cgraph.png" border="0" usemap="#asvm_8h_a2039644d359270872404c4664a25d951_cgraph" alt=""/></div>
<map name="asvm_8h_a2039644d359270872404c4664a25d951_cgraph" id="asvm_8h_a2039644d359270872404c4664a25d951_cgraph">
<area shape="rect" title=" " alt="" coords="5,730,156,757"/>
<area shape="rect" href="sev_8c.html#af6d8a53a5273e6f8c2768623e9896f57" title=" " alt="" coords="215,5,379,47"/>
<area shape="rect" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc" title=" " alt="" coords="204,71,391,98"/>
<area shape="rect" href="sev_8c.html#a5f382f275ab065f255f452612d0b8e2f" title=" " alt="" coords="239,578,355,605"/>
<area shape="rect" href="sev_8c.html#ab9049ca6ec68860c52858b4a7c0b6e5e" title=" " alt="" coords="933,1237,1084,1279"/>
<area shape="rect" href="sev_8c.html#ac62526aea63f9ac646eb3c3fbe4b0681" title=" " alt="" coords="239,401,355,427"/>
<area shape="rect" href="sev_8c.html#a8c4977429c23ee42a01589afc4e8b6c8" title=" " alt="" coords="941,629,1076,655"/>
<area shape="rect" href="sev_8c.html#a85fd69118319577cfdaaa5c29085ccef" title=" " alt="" coords="940,679,1077,706"/>
<area shape="rect" href="sev_8c.html#acb362b50ed86d332270fc6e7bd0fcfe3" title=" " alt="" coords="929,730,1088,757"/>
<area shape="rect" href="sev_8c.html#a735eb40df817d91509a036b8e5950190" title=" " alt="" coords="937,173,1080,199"/>
<area shape="rect" href="sev_8c.html#a4aac0b82769a9e9a6a13980f61ce8ba1" title=" " alt="" coords="697,1571,829,1598"/>
<area shape="rect" href="sev_8c.html#a4a233717598b3e11fcc62bdd74fca6cd" title=" " alt="" coords="917,223,1100,250"/>
<area shape="rect" href="sev_8c.html#a58da6a47d3ee35e28a426faf878a943e" title=" " alt="" coords="668,1993,859,2019"/>
<area shape="rect" href="sev_8c.html#a949ea0fcee0697916e3bf6092513ae57" title=" " alt="" coords="937,1034,1080,1061"/>
<area shape="rect" href="sev_8c.html#a478b7e37b46d13565bc9f75c2898a4ff" title=" " alt="" coords="695,1470,832,1497"/>
<area shape="rect" href="sev_8c.html#a8f8b1b540aaa2edff61d82b1c4ebc67b" title=" " alt="" coords="915,477,1103,503"/>
<area shape="rect" href="sev_8c.html#a91d7ee792dae7943526eb003f3597e94" title=" " alt="" coords="943,983,1075,1010"/>
<area shape="rect" href="sev_8c.html#a3795b9995a0cdb5ea7a6867c04eccd77" title=" " alt="" coords="946,1186,1071,1213"/>
<area shape="rect" href="sev_8c.html#ae249888cd72d16f8157726334216d8e8" title=" " alt="" coords="703,1673,823,1699"/>
<area shape="rect" href="sev_8c.html#a2c14d94d1f2de5f23cd146b31f742859" title=" " alt="" coords="678,882,849,909"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="1393,1059,1499,1086"/>
<area shape="rect" href="sev_8c.html#a5a3afcbd1b78369f3aab9a8dc436e3e6" title=" " alt="" coords="439,1021,620,1047"/>
<area shape="rect" href="sev_8c.html#a2591ea1f300d49d3021ea7ffd59fdc2e" title=" " alt="" coords="439,970,620,997"/>
<area shape="rect" href="sev_8c.html#a0b87120d88ceacd35fd087fe77a0b6b4" title=" " alt="" coords="1175,249,1315,275"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="1201,819,1289,846"/>
<area shape="rect" href="sev_8c.html#a1dc642421dfff17eaa7d3bb67701facc" title=" " alt="" coords="1177,382,1312,409"/>
<area shape="rect" href="sev_8c.html#aa9ba426e70b3cfcb263352b3ac89173f" title=" " alt="" coords="1169,458,1320,485"/>
<area shape="rect" href="sev_8c.html#a7048173cbf0bfebf01ff98366c7adca5" title=" " alt="" coords="690,1021,837,1047"/>
<area shape="rect" href="sev_8c.html#af61a8ee2222dd0c4855b8eb0ad795116" title=" " alt="" coords="925,1135,1092,1162"/>
<area shape="rect" href="sev_8c.html#a6be3f568017ce35e46a1a3ff7da8bf87" title=" " alt="" coords="1184,1085,1305,1111"/>
<area shape="rect" href="sev_8c.html#a992499375bab3086c14cf28bcdd02d0d" title=" " alt="" coords="1379,1841,1513,1867"/>
<area shape="rect" href="sev_8c.html#aee6abadc293da84185f2a9b6e78bfd43" title=" " alt="" coords="473,426,585,453"/>
<area shape="rect" href="sev_8c.html#a93b4450a5d34ae216bfa84756b831bba" title=" " alt="" coords="473,375,586,402"/>
<area shape="rect" href="sev_8c.html#abb38e8cb91318a62d655dc9c4eaaaafd" title=" " alt="" coords="677,426,849,453"/>
<area shape="rect" href="sev_8c.html#a6435eef5f9cd09ce26a204cdcc98aa27" title=" " alt="" coords="686,325,841,351"/>
<area shape="rect" href="sev_8c.html#ad12730c1ac9dbfbbfd52e7288925cceb" title=" " alt="" coords="673,375,854,402"/>
<area shape="rect" href="sev_8c.html#a4987bfdf20b1a61d4718ceeb2aaceff6" title=" " alt="" coords="947,325,1071,351"/>
<area shape="rect" href="sev_8c.html#ad675fe5da83544b4ef739d82ecdce4ca" title=" " alt="" coords="1159,198,1331,225"/>
<area shape="rect" href="sev_8c.html#a90871227c2ca03b13d49bffafc97bd43" title=" " alt="" coords="951,1470,1066,1497"/>
<area shape="rect" href="sev_8c.html#aa7faf38fc33d615dc428806df7b26845" title=" " alt="" coords="1171,1571,1318,1598"/>
<area shape="rect" href="sev_8c.html#a4e8d6041acaecc396b4c6eca246fcd67" title=" " alt="" coords="943,1571,1074,1598"/>
<area shape="rect" href="sev_8c.html#a66cc6caa9f6331de794476e911d4ce53" title=" " alt="" coords="1191,1470,1298,1497"/>
<area shape="rect" href="sev_8c.html#a73e538c37aa4aa7a7bd116aaa119eed7" title=" " alt="" coords="907,2043,1111,2070"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="1189,1790,1300,1817"/>
<area shape="rect" href="sev_8c.html#a15ec36f97d7d6f0ca3a4e5724269aade" title=" " alt="" coords="1171,2081,1318,2107"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1209,2030,1280,2057"/>
<area shape="rect" href="sev_8c.html#a2161a9ec46ad3a0c25b8d174bb0617c8" title=" " alt="" coords="919,1775,1098,1816"/>
<area shape="rect" href="sev_8c.html#aa680ad6932e5684b1ee1c10399098650" title=" " alt="" coords="916,1303,1101,1344"/>
</map>
</div>

</div>
</div>
<a id="ab37c3ce91ad0ad98fb7d5676a318cde4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab37c3ce91ad0ad98fb7d5676a318cde4">&#9670;&nbsp;</a></span>sev_mem_enc_register_region()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sev_mem_enc_register_region </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_enc_region *&#160;</td>
          <td class="paramname"><em>range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l01959">1959</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;{</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> *sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keyword">struct </span><a class="code" href="structenc__region.html">enc_region</a> *region;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(kvm))</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        <span class="keywordflow">return</span> -ENOTTY;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="comment">/* If kvm is mirroring encryption context it isn&#39;t responsible for it */</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc">is_mirroring_enc_context</a>(kvm))</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160; </div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keywordflow">if</span> (range-&gt;addr &gt; ULONG_MAX || range-&gt;size &gt; ULONG_MAX)</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    region = kzalloc(<span class="keyword">sizeof</span>(*region), GFP_KERNEL_ACCOUNT);</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="keywordflow">if</span> (!region)</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    mutex_lock(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    region-&gt;<a class="code" href="structenc__region.html#ab88b82b010e8d277c9fc96fd5e51b58e">pages</a> = <a class="code" href="sev_8c.html#a1dc642421dfff17eaa7d3bb67701facc">sev_pin_memory</a>(kvm, range-&gt;addr, range-&gt;size, &amp;region-&gt;<a class="code" href="structenc__region.html#a776b1b0231230cd0ef561dfea84b5dff">npages</a>, 1);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordflow">if</span> (IS_ERR(region-&gt;<a class="code" href="structenc__region.html#ab88b82b010e8d277c9fc96fd5e51b58e">pages</a>)) {</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        ret = PTR_ERR(region-&gt;<a class="code" href="structenc__region.html#ab88b82b010e8d277c9fc96fd5e51b58e">pages</a>);</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        mutex_unlock(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <span class="keywordflow">goto</span> e_free;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    }</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160; </div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment">     * The guest may change the memory encryption attribute from C=0 -&gt; C=1</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">     * or vice versa for this memory range. Lets make sure caches are</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment">     * flushed to ensure that guest data gets written into memory with</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="comment">     * correct C-bit.  Note, this must be done before dropping kvm-&gt;lock,</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment">     * as region and its array of pages can be freed by a different task</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment">     * once kvm-&gt;lock is released.</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <a class="code" href="sev_8c.html#a0b87120d88ceacd35fd087fe77a0b6b4">sev_clflush_pages</a>(region-&gt;<a class="code" href="structenc__region.html#ab88b82b010e8d277c9fc96fd5e51b58e">pages</a>, region-&gt;<a class="code" href="structenc__region.html#a776b1b0231230cd0ef561dfea84b5dff">npages</a>);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160; </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    region-&gt;<a class="code" href="structenc__region.html#ac25f41573f7c26bfa7c1fdfc7a556225">uaddr</a> = range-&gt;addr;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    region-&gt;<a class="code" href="structenc__region.html#a4071cb5b24f6ce7ba8ec11b8f00dd140">size</a> = range-&gt;size;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    list_add_tail(&amp;region-&gt;<a class="code" href="structenc__region.html#ac7e6e77258cc1f89fdfdeb95a42cef75">list</a>, &amp;sev-&gt;<a class="code" href="structkvm__sev__info.html#a7901eb8db0b44a6cff20fe30c41d6a3f">regions_list</a>);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    mutex_unlock(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160; </div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;e_free:</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    kfree(region);</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a0b87120d88ceacd35fd087fe77a0b6b4"><div class="ttname"><a href="sev_8c.html#a0b87120d88ceacd35fd087fe77a0b6b4">sev_clflush_pages</a></div><div class="ttdeci">static void sev_clflush_pages(struct page *pages[], unsigned long npages)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00473">sev.c:473</a></div></div>
<div class="ttc" id="asev_8c_html_a1dc642421dfff17eaa7d3bb67701facc"><div class="ttname"><a href="sev_8c.html#a1dc642421dfff17eaa7d3bb67701facc">sev_pin_memory</a></div><div class="ttdeci">static struct page ** sev_pin_memory(struct kvm *kvm, unsigned long uaddr, unsigned long ulen, unsigned long *n, int write)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00400">sev.c:400</a></div></div>
<div class="ttc" id="astructenc__region_html"><div class="ttname"><a href="structenc__region.html">enc_region</a></div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00078">sev.c:78</a></div></div>
<div class="ttc" id="astructenc__region_html_a4071cb5b24f6ce7ba8ec11b8f00dd140"><div class="ttname"><a href="structenc__region.html#a4071cb5b24f6ce7ba8ec11b8f00dd140">enc_region::size</a></div><div class="ttdeci">unsigned long size</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00083">sev.c:83</a></div></div>
<div class="ttc" id="astructenc__region_html_a776b1b0231230cd0ef561dfea84b5dff"><div class="ttname"><a href="structenc__region.html#a776b1b0231230cd0ef561dfea84b5dff">enc_region::npages</a></div><div class="ttdeci">unsigned long npages</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00080">sev.c:80</a></div></div>
<div class="ttc" id="astructenc__region_html_ab88b82b010e8d277c9fc96fd5e51b58e"><div class="ttname"><a href="structenc__region.html#ab88b82b010e8d277c9fc96fd5e51b58e">enc_region::pages</a></div><div class="ttdeci">struct page ** pages</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00081">sev.c:81</a></div></div>
<div class="ttc" id="astructenc__region_html_ac25f41573f7c26bfa7c1fdfc7a556225"><div class="ttname"><a href="structenc__region.html#ac25f41573f7c26bfa7c1fdfc7a556225">enc_region::uaddr</a></div><div class="ttdeci">unsigned long uaddr</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00082">sev.c:82</a></div></div>
<div class="ttc" id="astructenc__region_html_ac7e6e77258cc1f89fdfdeb95a42cef75"><div class="ttname"><a href="structenc__region.html#ac7e6e77258cc1f89fdfdeb95a42cef75">enc_region::list</a></div><div class="ttdeci">struct list_head list</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l03159">sev.c:79</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a7901eb8db0b44a6cff20fe30c41d6a3f"><div class="ttname"><a href="structkvm__sev__info.html#a7901eb8db0b44a6cff20fe30c41d6a3f">kvm_sev_info::regions_list</a></div><div class="ttdeci">struct list_head regions_list</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00085">svm.h:86</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ab37c3ce91ad0ad98fb7d5676a318cde4_cgraph.png" border="0" usemap="#asvm_8h_ab37c3ce91ad0ad98fb7d5676a318cde4_cgraph" alt=""/></div>
<map name="asvm_8h_ab37c3ce91ad0ad98fb7d5676a318cde4_cgraph" id="asvm_8h_ab37c3ce91ad0ad98fb7d5676a318cde4_cgraph">
<area shape="rect" title=" " alt="" coords="5,99,179,141"/>
<area shape="rect" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc" title=" " alt="" coords="227,5,413,32"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="461,107,568,133"/>
<area shape="rect" href="sev_8c.html#a0b87120d88ceacd35fd087fe77a0b6b4" title=" " alt="" coords="250,107,390,133"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="276,157,364,184"/>
<area shape="rect" href="sev_8c.html#a1dc642421dfff17eaa7d3bb67701facc" title=" " alt="" coords="253,208,387,235"/>
</map>
</div>

</div>
</div>
<a id="a8ed6164c0df5d13f87bce2be5a83e0d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ed6164c0df5d13f87bce2be5a83e0d8">&#9670;&nbsp;</a></span>sev_mem_enc_unregister_region()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sev_mem_enc_unregister_region </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct kvm_enc_region *&#160;</td>
          <td class="paramname"><em>range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02035">2035</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;{</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keyword">struct </span><a class="code" href="structenc__region.html">enc_region</a> *region;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="comment">/* If kvm is mirroring encryption context it isn&#39;t responsible for it */</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc">is_mirroring_enc_context</a>(kvm))</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    mutex_lock(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(kvm)) {</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        ret = -ENOTTY;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;        <span class="keywordflow">goto</span> failed;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    region = <a class="code" href="sev_8c.html#a3d4c35c45271cf8279a512a1b14c8d7f">find_enc_region</a>(kvm, range);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">if</span> (!region) {</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        ret = -EINVAL;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        <span class="keywordflow">goto</span> failed;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">     * Ensure that all guest tagged cache entries are flushed before</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">     * releasing the pages back to the system for use. CLFLUSH will</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">     * not do this, so issue a WBINVD.</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    wbinvd_on_all_cpus();</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; </div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <a class="code" href="sev_8c.html#a362d02e2a9852da2f2dae93d2dbd70f9">__unregister_enc_region_locked</a>(kvm, region);</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    mutex_unlock(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;failed:</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    mutex_unlock(&amp;kvm-&gt;lock);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a362d02e2a9852da2f2dae93d2dbd70f9"><div class="ttname"><a href="sev_8c.html#a362d02e2a9852da2f2dae93d2dbd70f9">__unregister_enc_region_locked</a></div><div class="ttdeci">static void __unregister_enc_region_locked(struct kvm *kvm, struct enc_region *region)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02027">sev.c:2027</a></div></div>
<div class="ttc" id="asev_8c_html_a3d4c35c45271cf8279a512a1b14c8d7f"><div class="ttname"><a href="sev_8c.html#a3d4c35c45271cf8279a512a1b14c8d7f">find_enc_region</a></div><div class="ttdeci">static struct enc_region * find_enc_region(struct kvm *kvm, struct kvm_enc_region *range)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02012">sev.c:2012</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a8ed6164c0df5d13f87bce2be5a83e0d8_cgraph.png" border="0" usemap="#asvm_8h_a8ed6164c0df5d13f87bce2be5a83e0d8_cgraph" alt=""/></div>
<map name="asvm_8h_a8ed6164c0df5d13f87bce2be5a83e0d8_cgraph" id="asvm_8h_a8ed6164c0df5d13f87bce2be5a83e0d8_cgraph">
<area shape="rect" title=" " alt="" coords="5,89,195,131"/>
<area shape="rect" href="sev_8c.html#a362d02e2a9852da2f2dae93d2dbd70f9" title=" " alt="" coords="243,5,423,47"/>
<area shape="rect" href="sev_8c.html#a3d4c35c45271cf8279a512a1b14c8d7f" title=" " alt="" coords="502,71,626,98"/>
<area shape="rect" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc" title=" " alt="" coords="471,122,657,149"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="289,173,377,199"/>
<area shape="rect" href="sev_8c.html#aa9ba426e70b3cfcb263352b3ac89173f" title=" " alt="" coords="489,17,639,43"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="705,97,812,123"/>
</map>
</div>

</div>
</div>
<a id="aeaff9c624af59b36fd36d1c25e279a50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaff9c624af59b36fd36d1c25e279a50">&#9670;&nbsp;</a></span>sev_set_cpu_caps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __init sev_set_cpu_caps </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02185">2185</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;{</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#a8cea9180251b2d380c09e0fd8be68b74">sev_enabled</a>)</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        <a class="code" href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198">kvm_cpu_cap_clear</a>(X86_FEATURE_SEV);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="sev_8c.html#a54a0753d622e67925f7803c15a588e55">sev_es_enabled</a>)</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;        <a class="code" href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198">kvm_cpu_cap_clear</a>(X86_FEATURE_SEV_ES);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;}</div>
<div class="ttc" id="acpuid_8h_html_abdc65f0e23a3e84daece0c718bac6198"><div class="ttname"><a href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198">kvm_cpu_cap_clear</a></div><div class="ttdeci">static __always_inline void kvm_cpu_cap_clear(unsigned int x86_feature)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8h_source.html#l00197">cpuid.h:197</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aeaff9c624af59b36fd36d1c25e279a50_cgraph.png" border="0" usemap="#asvm_8h_aeaff9c624af59b36fd36d1c25e279a50_cgraph" alt=""/></div>
<map name="asvm_8h_aeaff9c624af59b36fd36d1c25e279a50_cgraph" id="asvm_8h_aeaff9c624af59b36fd36d1c25e279a50_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,144,83"/>
<area shape="rect" href="cpuid_8h.html#abdc65f0e23a3e84daece0c718bac6198" title=" " alt="" coords="192,56,343,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="395,56,501,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="553,93,712,120"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="391,5,505,32"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="559,31,707,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aeaff9c624af59b36fd36d1c25e279a50_icgraph.png" border="0" usemap="#asvm_8h_aeaff9c624af59b36fd36d1c25e279a50_icgraph" alt=""/></div>
<map name="asvm_8h_aeaff9c624af59b36fd36d1c25e279a50_icgraph" id="asvm_8h_aeaff9c624af59b36fd36d1c25e279a50_icgraph">
<area shape="rect" title=" " alt="" coords="407,5,545,32"/>
<area shape="rect" href="svm_8c.html#ab2ed2d9e233f1c6a1a3c806826d63401" title=" " alt="" coords="215,5,359,32"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="5,5,167,32"/>
</map>
</div>

</div>
</div>
<a id="a00c492279a529b66b80ed039ae6de23b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00c492279a529b66b80ed039ae6de23b">&#9670;&nbsp;</a></span>sev_vcpu_after_set_cpuid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sev_vcpu_after_set_cpuid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l03015">3015</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;{</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    <span class="keyword">struct </span>kvm_vcpu *vcpu = &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>;</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="keyword">struct </span>kvm_cpuid_entry2 *best;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; </div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    <span class="comment">/* For sev guests, the memory encryption bit is not reserved in CR3.  */</span></div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;    best = <a class="code" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a>(vcpu, 0x8000001F);</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    <span class="keywordflow">if</span> (best)</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;        vcpu-&gt;arch.reserved_gpa_bits &amp;= ~(1UL &lt;&lt; (best-&gt;ebx &amp; 0x3f));</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160; </div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.kvm))</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        <a class="code" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343">sev_es_vcpu_after_set_cpuid</a>(svm);</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_aae0475609eefc48bb151ef5a631670c0"><div class="ttname"><a href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0">kvm_find_cpuid_entry</a></div><div class="ttdeci">struct kvm_cpuid_entry2 * kvm_find_cpuid_entry(struct kvm_vcpu *vcpu, u32 function)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l01455">cpuid.c:1455</a></div></div>
<div class="ttc" id="asev_8c_html_a8d230da93752633a5c5c7e6cf7c54343"><div class="ttname"><a href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343">sev_es_vcpu_after_set_cpuid</a></div><div class="ttdeci">static void sev_es_vcpu_after_set_cpuid(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l02984">sev.c:2984</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a00c492279a529b66b80ed039ae6de23b_cgraph.png" border="0" usemap="#asvm_8h_a00c492279a529b66b80ed039ae6de23b_cgraph" alt=""/></div>
<map name="asvm_8h_a00c492279a529b66b80ed039ae6de23b_cgraph" id="asvm_8h_a00c492279a529b66b80ed039ae6de23b_cgraph">
<area shape="rect" title=" " alt="" coords="5,126,152,168"/>
<area shape="rect" href="cpuid_8c.html#aae0475609eefc48bb151ef5a631670c0" title=" " alt="" coords="202,24,367,51"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="229,134,340,160"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="200,206,369,248"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1138,35,1275,62"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="443,134,550,160"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="437,526,556,552"/>
<area shape="rect" href="cpuid_8h.html#ad8c2a90f2f099af1d7ca23750d9d2eb9" title=" " alt="" coords="431,199,562,226"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="417,271,576,298"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="883,569,1057,610"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="627,526,817,552"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="917,199,1023,226"/>
<area shape="rect" href="cpuid_8h.html#af2af2645f203b5d9bad2088af0da5c1e" title=" " alt="" coords="629,119,815,146"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1341,174,1489,200"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1127,174,1286,200"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="886,31,1054,58"/>
<area shape="rect" href="cpuid_8h.html#a638557b30255883157acafa55a351d0d" title=" " alt="" coords="887,82,1053,124"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="899,148,1041,175"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1149,123,1264,150"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="643,369,801,410"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="624,271,820,298"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="899,452,1041,479"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="868,504,1072,545"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="897,351,1043,378"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="935,300,1005,327"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="895,402,1045,428"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="1120,326,1293,352"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a00c492279a529b66b80ed039ae6de23b_icgraph.png" border="0" usemap="#asvm_8h_a00c492279a529b66b80ed039ae6de23b_icgraph" alt=""/></div>
<map name="asvm_8h_a00c492279a529b66b80ed039ae6de23b_icgraph" id="asvm_8h_a00c492279a529b66b80ed039ae6de23b_icgraph">
<area shape="rect" title=" " alt="" coords="205,5,352,47"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="5,5,157,47"/>
</map>
</div>

</div>
</div>
<a id="a9809425cf0d198f1c65811a4716ceecf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9809425cf0d198f1c65811a4716ceecf">&#9670;&nbsp;</a></span>sev_vcpu_deliver_sipi_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sev_vcpu_deliver_sipi_vector </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l03159">3159</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;{</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160; </div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    <span class="comment">/* First SIPI: Use the values as initially set by the VMM */</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;    <span class="keywordflow">if</span> (!svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a62f326875a1cbab9d4673ab3f5a34169">received_first_sipi</a>) {</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#a62f326875a1cbab9d4673ab3f5a34169">received_first_sipi</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    }</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160; </div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;<span class="comment">     * Subsequent SIPI: Return from an AP Reset Hold VMGEXIT, where</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;<span class="comment">     * the guest will set the CS and RIP. Set SW_EXIT_INFO_2 to a</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="comment">     * non-zero value.</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    <span class="keywordflow">if</span> (!svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>)</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160; </div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    ghcb_set_sw_exit_info_2(svm-&gt;<a class="code" href="structvcpu__svm.html#aaaac2e4809a87c7130fd4d8e146b8cc2">sev_es</a>.<a class="code" href="structvcpu__sev__es__state.html#abb6b1331553e74269e36bf08c13b710c">ghcb</a>, 1);</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;}</div>
<div class="ttc" id="astructvcpu__sev__es__state_html_a62f326875a1cbab9d4673ab3f5a34169"><div class="ttname"><a href="structvcpu__sev__es__state.html#a62f326875a1cbab9d4673ab3f5a34169">vcpu_sev_es_state::received_first_sipi</a></div><div class="ttdeci">bool received_first_sipi</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00199">svm.h:199</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a9809425cf0d198f1c65811a4716ceecf_icgraph.png" border="0" usemap="#asvm_8h_a9809425cf0d198f1c65811a4716ceecf_icgraph" alt=""/></div>
<map name="asvm_8h_a9809425cf0d198f1c65811a4716ceecf_icgraph" id="asvm_8h_a9809425cf0d198f1c65811a4716ceecf_icgraph">
<area shape="rect" title=" " alt="" coords="224,5,389,47"/>
<area shape="rect" href="svm_8c.html#ac8932e9146797ddd1e75d6d8dd4afc23" title=" " alt="" coords="5,5,176,47"/>
</map>
</div>

</div>
</div>
<a id="a3b1ae3550c1b7c9973532d08d167ce2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b1ae3550c1b7c9973532d08d167ce2c">&#9670;&nbsp;</a></span>sev_vm_copy_enc_context_from()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sev_vm_copy_enc_context_from </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>source_fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02075">2075</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;{</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keyword">struct </span>fd f = fdget(source_fd);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keyword">struct </span>kvm *source_kvm;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> *source_sev, *mirror_sev;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160; </div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="keywordflow">if</span> (!f.file)</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        <span class="keywordflow">return</span> -EBADF;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="kvm__main_8c.html#ab241463960ff8a439cf1e29a235bde1b">file_is_kvm</a>(f.file)) {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        ret = -EBADF;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        <span class="keywordflow">goto</span> e_source_fput;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    }</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; </div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    source_kvm = f.file-&gt;private_data;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    ret = <a class="code" href="sev_8c.html#a6a743115f37d3169d127c828cff664bb">sev_lock_two_vms</a>(kvm, source_kvm);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        <span class="keywordflow">goto</span> e_source_fput;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160; </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="comment">     * Mirrors of mirrors should work, but let&#39;s not get silly.  Also</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="comment">     * disallow out-of-band SEV/SEV-ES init if the target is already an</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="comment">     * SEV guest, or if vCPUs have been created.  KVM relies on vCPUs being</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="comment">     * created after SEV/SEV-ES initialization, e.g. to init intercepts.</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(kvm) || !<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(source_kvm) ||</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <a class="code" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc">is_mirroring_enc_context</a>(source_kvm) || kvm-&gt;created_vcpus) {</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        ret = -EINVAL;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <span class="keywordflow">goto</span> e_unlock;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    }</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160; </div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">     * The mirror kvm holds an enc_context_owner ref so its asid can&#39;t</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">     * disappear until we&#39;re done with it</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    source_sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(source_kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <a class="code" href="kvm__main_8c.html#a84706c53314b74bf1d656df273a433cb">kvm_get_kvm</a>(source_kvm);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    mirror_sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    list_add_tail(&amp;mirror_sev-&gt;<a class="code" href="structkvm__sev__info.html#a567d59358620c89779269a808be2b8b7">mirror_entry</a>, &amp;source_sev-&gt;<a class="code" href="structkvm__sev__info.html#ae3b8494e7fae1c09a80314c72f4806b0">mirror_vms</a>);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="comment">/* Set enc_context_owner and copy its encryption context over */</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    mirror_sev-&gt;<a class="code" href="structkvm__sev__info.html#a229b95df6e061397ed598e97dffea3c3">enc_context_owner</a> = source_kvm;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    mirror_sev-&gt;<a class="code" href="structkvm__sev__info.html#a6da81c9e8736479d0edee1c4e8813365">active</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    mirror_sev-&gt;<a class="code" href="structkvm__sev__info.html#ae81641c3ab02ddd91e7a094c673e9088">asid</a> = source_sev-&gt;<a class="code" href="structkvm__sev__info.html#ae81641c3ab02ddd91e7a094c673e9088">asid</a>;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    mirror_sev-&gt;<a class="code" href="structkvm__sev__info.html#aecf16aee273c40c0f150e82111e3c30d">fd</a> = source_sev-&gt;<a class="code" href="structkvm__sev__info.html#aecf16aee273c40c0f150e82111e3c30d">fd</a>;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    mirror_sev-&gt;<a class="code" href="structkvm__sev__info.html#ab1e6fb4b7c55cdd34fdd230a7847d11a">es_active</a> = source_sev-&gt;<a class="code" href="structkvm__sev__info.html#ab1e6fb4b7c55cdd34fdd230a7847d11a">es_active</a>;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    mirror_sev-&gt;<a class="code" href="structkvm__sev__info.html#ad75defd37a304bbb1e3b0123ea417d95">handle</a> = source_sev-&gt;<a class="code" href="structkvm__sev__info.html#ad75defd37a304bbb1e3b0123ea417d95">handle</a>;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    INIT_LIST_HEAD(&amp;mirror_sev-&gt;<a class="code" href="structkvm__sev__info.html#a7901eb8db0b44a6cff20fe30c41d6a3f">regions_list</a>);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    INIT_LIST_HEAD(&amp;mirror_sev-&gt;<a class="code" href="structkvm__sev__info.html#ae3b8494e7fae1c09a80314c72f4806b0">mirror_vms</a>);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    ret = 0;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">     * Do not copy ap_jump_table. Since the mirror does not share the same</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">     * KVM contexts as the original, and they may have different</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment">     * memory-views.</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160; </div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;e_unlock:</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <a class="code" href="sev_8c.html#aa8af9b8fad5755159d0e304a41fc4650">sev_unlock_two_vms</a>(kvm, source_kvm);</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;e_source_fput:</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    fdput(f);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;}</div>
<div class="ttc" id="akvm__main_8c_html_a84706c53314b74bf1d656df273a433cb"><div class="ttname"><a href="kvm__main_8c.html#a84706c53314b74bf1d656df273a433cb">kvm_get_kvm</a></div><div class="ttdeci">void kvm_get_kvm(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l01403">kvm_main.c:1403</a></div></div>
<div class="ttc" id="akvm__main_8c_html_ab241463960ff8a439cf1e29a235bde1b"><div class="ttname"><a href="kvm__main_8c.html#ab241463960ff8a439cf1e29a235bde1b">file_is_kvm</a></div><div class="ttdeci">bool file_is_kvm(struct file *file)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l05424">kvm_main.c:5424</a></div></div>
<div class="ttc" id="asev_8c_html_a6a743115f37d3169d127c828cff664bb"><div class="ttname"><a href="sev_8c.html#a6a743115f37d3169d127c828cff664bb">sev_lock_two_vms</a></div><div class="ttdeci">static int sev_lock_two_vms(struct kvm *dst_kvm, struct kvm *src_kvm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01581">sev.c:1581</a></div></div>
<div class="ttc" id="asev_8c_html_aa8af9b8fad5755159d0e304a41fc4650"><div class="ttname"><a href="sev_8c.html#aa8af9b8fad5755159d0e304a41fc4650">sev_unlock_two_vms</a></div><div class="ttdeci">static void sev_unlock_two_vms(struct kvm *dst_kvm, struct kvm *src_kvm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01616">sev.c:1616</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a229b95df6e061397ed598e97dffea3c3"><div class="ttname"><a href="structkvm__sev__info.html#a229b95df6e061397ed598e97dffea3c3">kvm_sev_info::enc_context_owner</a></div><div class="ttdeci">struct kvm * enc_context_owner</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00088">svm.h:88</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_a567d59358620c89779269a808be2b8b7"><div class="ttname"><a href="structkvm__sev__info.html#a567d59358620c89779269a808be2b8b7">kvm_sev_info::mirror_entry</a></div><div class="ttdeci">struct list_head mirror_entry</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00088">svm.h:90</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_ad75defd37a304bbb1e3b0123ea417d95"><div class="ttname"><a href="structkvm__sev__info.html#ad75defd37a304bbb1e3b0123ea417d95">kvm_sev_info::handle</a></div><div class="ttdeci">unsigned int handle</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00083">svm.h:83</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_ae3b8494e7fae1c09a80314c72f4806b0"><div class="ttname"><a href="structkvm__sev__info.html#ae3b8494e7fae1c09a80314c72f4806b0">kvm_sev_info::mirror_vms</a></div><div class="ttdeci">struct list_head mirror_vms</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00088">svm.h:89</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_ae81641c3ab02ddd91e7a094c673e9088"><div class="ttname"><a href="structkvm__sev__info.html#ae81641c3ab02ddd91e7a094c673e9088">kvm_sev_info::asid</a></div><div class="ttdeci">unsigned int asid</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00082">svm.h:82</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_aecf16aee273c40c0f150e82111e3c30d"><div class="ttname"><a href="structkvm__sev__info.html#aecf16aee273c40c0f150e82111e3c30d">kvm_sev_info::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00084">svm.h:84</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a3b1ae3550c1b7c9973532d08d167ce2c_cgraph.png" border="0" usemap="#asvm_8h_a3b1ae3550c1b7c9973532d08d167ce2c_cgraph" alt=""/></div>
<map name="asvm_8h_a3b1ae3550c1b7c9973532d08d167ce2c_cgraph" id="asvm_8h_a3b1ae3550c1b7c9973532d08d167ce2c_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,240,184"/>
<area shape="rect" href="kvm__main_8c.html#ab241463960ff8a439cf1e29a235bde1b" title=" " alt="" coords="333,5,429,32"/>
<area shape="rect" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc" title=" " alt="" coords="288,56,475,83"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="523,208,629,235"/>
<area shape="rect" href="kvm__main_8c.html#a84706c53314b74bf1d656df273a433cb" title=" " alt="" coords="324,157,439,184"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="337,208,425,235"/>
<area shape="rect" href="sev_8c.html#a6a743115f37d3169d127c828cff664bb" title=" " alt="" coords="309,259,454,285"/>
<area shape="rect" href="sev_8c.html#aa8af9b8fad5755159d0e304a41fc4650" title=" " alt="" coords="301,309,462,336"/>
</map>
</div>

</div>
</div>
<a id="af1eb77eac84f085b0a943b87f783e30d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1eb77eac84f085b0a943b87f783e30d">&#9670;&nbsp;</a></span>sev_vm_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sev_vm_destroy </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l02140">2140</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;{</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> *sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="keyword">struct </span>list_head *head = &amp;sev-&gt;<a class="code" href="structkvm__sev__info.html#a7901eb8db0b44a6cff20fe30c41d6a3f">regions_list</a>;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="keyword">struct </span>list_head *pos, *q;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(kvm))</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160; </div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    WARN_ON(!list_empty(&amp;sev-&gt;<a class="code" href="structkvm__sev__info.html#ae3b8494e7fae1c09a80314c72f4806b0">mirror_vms</a>));</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160; </div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="comment">/* If this is a mirror_kvm release the enc_context_owner and skip sev cleanup */</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc">is_mirroring_enc_context</a>(kvm)) {</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        <span class="keyword">struct </span>kvm *owner_kvm = sev-&gt;<a class="code" href="structkvm__sev__info.html#a229b95df6e061397ed598e97dffea3c3">enc_context_owner</a>;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        mutex_lock(&amp;owner_kvm-&gt;lock);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        list_del(&amp;sev-&gt;<a class="code" href="structkvm__sev__info.html#a567d59358620c89779269a808be2b8b7">mirror_entry</a>);</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        mutex_unlock(&amp;owner_kvm-&gt;lock);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        <a class="code" href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241">kvm_put_kvm</a>(owner_kvm);</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="comment">     * Ensure that all guest tagged cache entries are flushed before</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment">     * releasing the pages back to the system for use. CLFLUSH will</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment">     * not do this, so issue a WBINVD.</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    wbinvd_on_all_cpus();</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160; </div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="comment">     * if userspace was terminated before unregistering the memory regions</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment">     * then lets unpin all the registered memory.</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="keywordflow">if</span> (!list_empty(head)) {</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;        list_for_each_safe(pos, q, head) {</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;            <a class="code" href="sev_8c.html#a362d02e2a9852da2f2dae93d2dbd70f9">__unregister_enc_region_locked</a>(kvm,</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                list_entry(pos, <span class="keyword">struct</span> <a class="code" href="structenc__region.html">enc_region</a>, list));</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;            cond_resched();</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        }</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    }</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160; </div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <a class="code" href="sev_8c.html#a4e8d6041acaecc396b4c6eca246fcd67">sev_unbind_asid</a>(kvm, sev-&gt;<a class="code" href="structkvm__sev__info.html#ad75defd37a304bbb1e3b0123ea417d95">handle</a>);</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <a class="code" href="sev_8c.html#aee6abadc293da84185f2a9b6e78bfd43">sev_asid_free</a>(sev);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;}</div>
<div class="ttc" id="akvm__main_8c_html_a013962010b954d8597e5987fd27c8241"><div class="ttname"><a href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241">kvm_put_kvm</a></div><div class="ttdeci">void kvm_put_kvm(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l01419">kvm_main.c:1419</a></div></div>
<div class="ttc" id="asev_8c_html_a4e8d6041acaecc396b4c6eca246fcd67"><div class="ttname"><a href="sev_8c.html#a4e8d6041acaecc396b4c6eca246fcd67">sev_unbind_asid</a></div><div class="ttdeci">static void sev_unbind_asid(struct kvm *kvm, unsigned int handle)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00236">sev.c:236</a></div></div>
<div class="ttc" id="asev_8c_html_aee6abadc293da84185f2a9b6e78bfd43"><div class="ttname"><a href="sev_8c.html#aee6abadc293da84185f2a9b6e78bfd43">sev_asid_free</a></div><div class="ttdeci">static void sev_asid_free(struct kvm_sev_info *sev)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00204">sev.c:204</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_af1eb77eac84f085b0a943b87f783e30d_cgraph.png" border="0" usemap="#asvm_8h_af1eb77eac84f085b0a943b87f783e30d_cgraph" alt=""/></div>
<map name="asvm_8h_af1eb77eac84f085b0a943b87f783e30d_cgraph" id="asvm_8h_af1eb77eac84f085b0a943b87f783e30d_cgraph">
<area shape="rect" title=" " alt="" coords="5,317,135,344"/>
<area shape="rect" href="sev_8c.html#a362d02e2a9852da2f2dae93d2dbd70f9" title=" " alt="" coords="183,150,363,191"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="693,157,799,184"/>
<area shape="rect" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc" title=" " alt="" coords="411,209,597,236"/>
<area shape="rect" href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241" title=" " alt="" coords="215,415,330,441"/>
<area shape="rect" href="sev_8c.html#aee6abadc293da84185f2a9b6e78bfd43" title=" " alt="" coords="217,465,329,492"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="229,267,317,293"/>
<area shape="rect" href="sev_8c.html#a4e8d6041acaecc396b4c6eca246fcd67" title=" " alt="" coords="207,516,338,543"/>
<area shape="rect" href="sev_8c.html#aa9ba426e70b3cfcb263352b3ac89173f" title=" " alt="" coords="429,157,579,184"/>
<area shape="rect" href="kvm__main_8c.html#afd922c538c448ab1248cdb9dccae9410" title=" " alt="" coords="437,461,571,488"/>
<area shape="rect" href="kvm__main_8c.html#a1c487edf6b04278a8ba6638e4f714643" title=" " alt="" coords="666,259,826,285"/>
<area shape="rect" href="x86_8c.html#ad84dda268db5d48c48f3ef2f438c62a7" title=" " alt="" coords="661,360,831,387"/>
<area shape="rect" href="kvm__main_8c.html#a3089edf2c0e5790aab7e8ed723f34b5b" title=" " alt="" coords="1400,116,1556,143"/>
<area shape="rect" href="x86_8c.html#a30933173bb4382eb522f58c7a46dfe48" title=" " alt="" coords="673,461,819,488"/>
<area shape="rect" href="kvm__main_8c.html#a82d4376e528b0e4ff28ec43f992f364a" title=" " alt="" coords="647,512,845,539"/>
<area shape="rect" href="x86_8c.html#a6f324dc73c5f97fe0b9dfa35f303d5f9" title=" " alt="" coords="659,309,833,336"/>
<area shape="rect" href="coalesced__mmio_8c.html#acbde5f51051def5601627c214de053d5" title=" " alt="" coords="645,563,847,589"/>
<area shape="rect" href="kvm__main_8c.html#abfe532698477df01f13e371d91388539" title=" " alt="" coords="664,613,828,640"/>
<area shape="rect" href="kvm__main_8c.html#a7e9f8db90d91053e866c157b6c162013" title=" " alt="" coords="652,664,840,691"/>
<area shape="rect" href="kvm__main_8c.html#a78be2b95971bc468a0a368d314280776" title=" " alt="" coords="649,715,843,741"/>
<area shape="rect" href="kvm__main_8c.html#ab6320575dc04178df16ea4d7dddff190" title=" " alt="" coords="661,765,831,792"/>
<area shape="rect" href="irqchip_8c.html#a841c49803610b79f779b380bffbe07cb" title=" " alt="" coords="665,820,827,847"/>
<area shape="rect" href="kvm__main_8c.html#ae58ffa9a2b55027be40935dd4410bd30" title=" " alt="" coords="668,871,824,897"/>
<area shape="rect" href="kvm__main_8c.html#ad245c522a96e3da12a65f213f34d2305" title=" " alt="" coords="645,208,847,235"/>
<area shape="rect" href="x86_8c.html#a0c0c5e35bc626e4140927bf15b4881f9" title=" " alt="" coords="898,360,1095,387"/>
<area shape="rect" href="kvm__main_8c.html#a0fcd9f7671bee7debec1bc05dcd9557b" title=" " alt="" coords="921,512,1073,539"/>
<area shape="rect" href="x86_8c.html#ad83ae43be57823912b41e24e4b6bbc41" title=" " alt="" coords="920,411,1073,437"/>
<area shape="rect" href="hyperv_8c.html#ac7f9f19a66e3ae5ae397e937daf75a73" title=" " alt="" coords="917,461,1076,488"/>
<area shape="rect" href="ioapic_8c.html#ae707e80b0215afe92318ac1813d15345" title=" " alt="" coords="920,56,1073,83"/>
<area shape="rect" href="mmu_8c.html#a0beae9a256ad42642a6b522a36a18a74" title=" " alt="" coords="915,208,1079,235"/>
<area shape="rect" href="page__track_8h.html#a061d2d3a74ebe3354da60bb521b8ef13" title=" " alt="" coords="903,157,1091,184"/>
<area shape="rect" href="i8259_8c.html#a48d54ace62d2b40899cadfddf0b70781" title=" " alt="" coords="930,107,1063,133"/>
<area shape="rect" href="x86_8c.html#a6710e6b26ce720cb1d40113afe17efa7" title=" " alt="" coords="903,259,1091,285"/>
<area shape="rect" href="xen_8c.html#a2de7c50ba573dd74c833c6b0bc675909" title=" " alt="" coords="914,309,1079,336"/>
<area shape="rect" href="kvm__main_8c.html#ac76f506181e49aa4800bb202e11cb2b3" title=" " alt="" coords="1148,419,1351,445"/>
<area shape="rect" href="kvm__main_8c.html#a7218df747387e4034ab8442f187306b1" title=" " alt="" coords="1177,512,1322,539"/>
<area shape="rect" href="kvm__main_8c.html#a103c02eb7ca545106f3130776c2a8897" title=" " alt="" coords="1147,65,1351,92"/>
<area shape="rect" href="kvm__main_8c.html#aa6d7dea09a0b657f29e92f424e5d0633" title=" " alt="" coords="1604,91,1791,117"/>
<area shape="rect" href="tdp__mmu_8c.html#a73432bf42fbb3d43b3e04f88cd92b592" title=" " alt="" coords="1147,200,1352,227"/>
<area shape="rect" href="mmu_8c.html#a30c216bd5aafa41e32fcffa372d89380" title=" " alt="" coords="1160,134,1339,175"/>
<area shape="rect" href="async__pf_8c.html#ad351bddfe80f107dfc95c6ab2768fe4f" title=" " alt="" coords="1172,302,1327,343"/>
<area shape="rect" href="x86_8c.html#aa7dd06e7d0835e6cbf23134ad9fb19d8" title=" " alt="" coords="1159,251,1340,277"/>
<area shape="rect" href="pfncache_8c.html#a028c789975722f39987f72cf8340f9d2" title=" " alt="" coords="1171,368,1328,395"/>
<area shape="rect" href="i8254_8c.html#a2a7ca7f5194b378ba7f0ae7a38cc26ba" title=" " alt="" coords="943,5,1051,32"/>
<area shape="rect" href="mmu_8c.html#a6a9d3382763ac1478855bd15907a98e2" title=" " alt="" coords="895,704,1099,731"/>
<area shape="rect" href="kvm__main_8c.html#a31dbd36d8363fc2e5979b3976ebc0dbb" title=" " alt="" coords="901,755,1092,797"/>
<area shape="rect" href="irqchip_8c.html#a5ae37186e6e6d1594767f83df8bab64a" title=" " alt="" coords="914,821,1079,848"/>
<area shape="rect" href="kvm__main_8c.html#ae2d9291adcda0ba0f7a20350dabdd418" title=" " alt="" coords="922,872,1071,899"/>
<area shape="rect" href="sev_8c.html#abb38e8cb91318a62d655dc9c4eaaaafd" title=" " alt="" coords="418,512,590,539"/>
<area shape="rect" href="sev_8c.html#aa7faf38fc33d615dc428806df7b26845" title=" " alt="" coords="431,563,577,589"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_af1eb77eac84f085b0a943b87f783e30d_icgraph.png" border="0" usemap="#asvm_8h_af1eb77eac84f085b0a943b87f783e30d_icgraph" alt=""/></div>
<map name="asvm_8h_af1eb77eac84f085b0a943b87f783e30d_icgraph" id="asvm_8h_af1eb77eac84f085b0a943b87f783e30d_icgraph">
<area shape="rect" title=" " alt="" coords="188,5,317,32"/>
<area shape="rect" href="svm_8c.html#a0e69cefce46e7b11e1e8e056ea5b6561" title=" " alt="" coords="5,5,140,32"/>
</map>
</div>

</div>
</div>
<a id="abe3c569b297da3b78824074b8c08f9a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe3c569b297da3b78824074b8c08f9a7">&#9670;&nbsp;</a></span>sev_vm_move_enc_context_from()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sev_vm_move_enc_context_from </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>source_fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l01791">1791</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;{</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> *dst_sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkvm__sev__info.html">kvm_sev_info</a> *src_sev, *cg_cleanup_sev;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="keyword">struct </span>fd f = fdget(source_fd);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="keyword">struct </span>kvm *source_kvm;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordtype">bool</span> charged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">if</span> (!f.file)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        <span class="keywordflow">return</span> -EBADF;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160; </div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="kvm__main_8c.html#ab241463960ff8a439cf1e29a235bde1b">file_is_kvm</a>(f.file)) {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        ret = -EBADF;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        <span class="keywordflow">goto</span> out_fput;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160; </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    source_kvm = f.file-&gt;private_data;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    ret = <a class="code" href="sev_8c.html#a6a743115f37d3169d127c828cff664bb">sev_lock_two_vms</a>(kvm, source_kvm);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <span class="keywordflow">goto</span> out_fput;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(kvm) || !<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(source_kvm)) {</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        ret = -EINVAL;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        <span class="keywordflow">goto</span> out_unlock;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    }</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160; </div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    src_sev = &amp;<a class="code" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd">to_kvm_svm</a>(source_kvm)-&gt;<a class="code" href="structkvm__svm.html#a743b2106389f26a042ce5ac8166afd73">sev_info</a>;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    dst_sev-&gt;<a class="code" href="structkvm__sev__info.html#abef33415f75cf8cc6117da1c09136c9e">misc_cg</a> = get_current_misc_cg();</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    cg_cleanup_sev = dst_sev;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="keywordflow">if</span> (dst_sev-&gt;<a class="code" href="structkvm__sev__info.html#abef33415f75cf8cc6117da1c09136c9e">misc_cg</a> != src_sev-&gt;<a class="code" href="structkvm__sev__info.html#abef33415f75cf8cc6117da1c09136c9e">misc_cg</a>) {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        ret = <a class="code" href="sev_8c.html#ad12730c1ac9dbfbbfd52e7288925cceb">sev_misc_cg_try_charge</a>(dst_sev);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            <span class="keywordflow">goto</span> out_dst_cgroup;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        charged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160; </div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    ret = <a class="code" href="sev_8c.html#a07cfb95731f60f70eb3590b407d55bb9">sev_lock_vcpus_for_migration</a>(kvm, <a class="code" href="sev_8c.html#a7f204481eb75501e919468f28db35a8ca8274b4db30bb69f812b48886b83dae01">SEV_MIGRATION_SOURCE</a>);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        <span class="keywordflow">goto</span> out_dst_cgroup;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    ret = <a class="code" href="sev_8c.html#a07cfb95731f60f70eb3590b407d55bb9">sev_lock_vcpus_for_migration</a>(source_kvm, <a class="code" href="sev_8c.html#a7f204481eb75501e919468f28db35a8ca206306bf3ec08a848a31c14d17abcc14">SEV_MIGRATION_TARGET</a>);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        <span class="keywordflow">goto</span> out_dst_vcpu;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160; </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    ret = <a class="code" href="sev_8c.html#ad61e7c088903e183bb930bdce850412e">sev_check_source_vcpus</a>(kvm, source_kvm);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        <span class="keywordflow">goto</span> out_source_vcpu;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <a class="code" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a">sev_migrate_from</a>(kvm, source_kvm);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    kvm_vm_dead(source_kvm);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    cg_cleanup_sev = src_sev;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    ret = 0;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160; </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;out_source_vcpu:</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <a class="code" href="sev_8c.html#a5aa035c843e0edc69f7a5d8c7050df3e">sev_unlock_vcpus_for_migration</a>(source_kvm);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;out_dst_vcpu:</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <a class="code" href="sev_8c.html#a5aa035c843e0edc69f7a5d8c7050df3e">sev_unlock_vcpus_for_migration</a>(kvm);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;out_dst_cgroup:</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">/* Operates on the source on success, on the destination on failure.  */</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordflow">if</span> (charged)</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        <a class="code" href="sev_8c.html#abb38e8cb91318a62d655dc9c4eaaaafd">sev_misc_cg_uncharge</a>(cg_cleanup_sev);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    put_misc_cg(cg_cleanup_sev-&gt;<a class="code" href="structkvm__sev__info.html#abef33415f75cf8cc6117da1c09136c9e">misc_cg</a>);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    cg_cleanup_sev-&gt;<a class="code" href="structkvm__sev__info.html#abef33415f75cf8cc6117da1c09136c9e">misc_cg</a> = NULL;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;out_unlock:</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <a class="code" href="sev_8c.html#aa8af9b8fad5755159d0e304a41fc4650">sev_unlock_two_vms</a>(kvm, source_kvm);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;out_fput:</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    fdput(f);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;}</div>
<div class="ttc" id="asev_8c_html_a07cfb95731f60f70eb3590b407d55bb9"><div class="ttname"><a href="sev_8c.html#a07cfb95731f60f70eb3590b407d55bb9">sev_lock_vcpus_for_migration</a></div><div class="ttdeci">static int sev_lock_vcpus_for_migration(struct kvm *kvm, enum sev_migration_role role)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01634">sev.c:1634</a></div></div>
<div class="ttc" id="asev_8c_html_a5aa035c843e0edc69f7a5d8c7050df3e"><div class="ttname"><a href="sev_8c.html#a5aa035c843e0edc69f7a5d8c7050df3e">sev_unlock_vcpus_for_migration</a></div><div class="ttdeci">static void sev_unlock_vcpus_for_migration(struct kvm *kvm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01674">sev.c:1674</a></div></div>
<div class="ttc" id="asev_8c_html_a7f204481eb75501e919468f28db35a8ca206306bf3ec08a848a31c14d17abcc14"><div class="ttname"><a href="sev_8c.html#a7f204481eb75501e919468f28db35a8ca206306bf3ec08a848a31c14d17abcc14">SEV_MIGRATION_TARGET</a></div><div class="ttdeci">@ SEV_MIGRATION_TARGET</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01630">sev.c:1630</a></div></div>
<div class="ttc" id="asev_8c_html_a7f204481eb75501e919468f28db35a8ca8274b4db30bb69f812b48886b83dae01"><div class="ttname"><a href="sev_8c.html#a7f204481eb75501e919468f28db35a8ca8274b4db30bb69f812b48886b83dae01">SEV_MIGRATION_SOURCE</a></div><div class="ttdeci">@ SEV_MIGRATION_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01629">sev.c:1629</a></div></div>
<div class="ttc" id="asev_8c_html_abb38e8cb91318a62d655dc9c4eaaaafd"><div class="ttname"><a href="sev_8c.html#abb38e8cb91318a62d655dc9c4eaaaafd">sev_misc_cg_uncharge</a></div><div class="ttdeci">static void sev_misc_cg_uncharge(struct kvm_sev_info *sev)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00139">sev.c:139</a></div></div>
<div class="ttc" id="asev_8c_html_ad12730c1ac9dbfbbfd52e7288925cceb"><div class="ttname"><a href="sev_8c.html#ad12730c1ac9dbfbbfd52e7288925cceb">sev_misc_cg_try_charge</a></div><div class="ttdeci">static int sev_misc_cg_try_charge(struct kvm_sev_info *sev)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l00133">sev.c:133</a></div></div>
<div class="ttc" id="asev_8c_html_ad28fd793149997c912b52490f6ca139a"><div class="ttname"><a href="sev_8c.html#ad28fd793149997c912b52490f6ca139a">sev_migrate_from</a></div><div class="ttdeci">static void sev_migrate_from(struct kvm *dst_kvm, struct kvm *src_kvm)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01691">sev.c:1691</a></div></div>
<div class="ttc" id="asev_8c_html_ad61e7c088903e183bb930bdce850412e"><div class="ttname"><a href="sev_8c.html#ad61e7c088903e183bb930bdce850412e">sev_check_source_vcpus</a></div><div class="ttdeci">static int sev_check_source_vcpus(struct kvm *dst, struct kvm *src)</div><div class="ttdef"><b>Definition:</b> <a href="sev_8c_source.html#l01772">sev.c:1772</a></div></div>
<div class="ttc" id="astructkvm__sev__info_html_abef33415f75cf8cc6117da1c09136c9e"><div class="ttname"><a href="structkvm__sev__info.html#abef33415f75cf8cc6117da1c09136c9e">kvm_sev_info::misc_cg</a></div><div class="ttdeci">struct misc_cg * misc_cg</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00091">svm.h:91</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_abe3c569b297da3b78824074b8c08f9a7_cgraph.png" border="0" usemap="#asvm_8h_abe3c569b297da3b78824074b8c08f9a7_cgraph" alt=""/></div>
<map name="asvm_8h_abe3c569b297da3b78824074b8c08f9a7_cgraph" id="asvm_8h_abe3c569b297da3b78824074b8c08f9a7_cgraph">
<area shape="rect" title=" " alt="" coords="5,259,247,285"/>
<area shape="rect" href="kvm__main_8c.html#ab241463960ff8a439cf1e29a235bde1b" title=" " alt="" coords="337,5,433,32"/>
<area shape="rect" href="sev_8c.html#ad61e7c088903e183bb930bdce850412e" title=" " alt="" coords="525,259,710,285"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="1015,208,1122,235"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="795,208,883,235"/>
<area shape="rect" href="sev_8c.html#a6a743115f37d3169d127c828cff664bb" title=" " alt="" coords="767,56,912,83"/>
<area shape="rect" href="sev_8c.html#a07cfb95731f60f70eb3590b407d55bb9" title=" " alt="" coords="311,361,460,402"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="315,309,456,336"/>
<area shape="rect" href="sev_8c.html#ad12730c1ac9dbfbbfd52e7288925cceb" title=" " alt="" coords="295,427,476,453"/>
<area shape="rect" href="sev_8c.html#abb38e8cb91318a62d655dc9c4eaaaafd" title=" " alt="" coords="299,477,471,504"/>
<area shape="rect" href="sev_8c.html#aa8af9b8fad5755159d0e304a41fc4650" title=" " alt="" coords="759,107,920,133"/>
<area shape="rect" href="sev_8c.html#a5aa035c843e0edc69f7a5d8c7050df3e" title=" " alt="" coords="303,529,468,570"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="784,411,895,437"/>
<area shape="rect" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc" title=" " alt="" coords="524,461,711,488"/>
<area shape="rect" href="kvm__main_8c.html#a84706c53314b74bf1d656df273a433cb" title=" " alt="" coords="560,360,675,387"/>
<area shape="rect" href="kvm__main_8c.html#a013962010b954d8597e5987fd27c8241" title=" " alt="" coords="560,791,675,817"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="559,512,675,539"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="582,411,653,437"/>
<area shape="rect" href="kvm__main_8c.html#afd922c538c448ab1248cdb9dccae9410" title=" " alt="" coords="772,1044,907,1071"/>
<area shape="rect" href="kvm__main_8c.html#a1c487edf6b04278a8ba6638e4f714643" title=" " alt="" coords="989,791,1149,817"/>
<area shape="rect" href="x86_8c.html#ad84dda268db5d48c48f3ef2f438c62a7" title=" " alt="" coords="983,841,1154,868"/>
<area shape="rect" href="x86_8c.html#a30933173bb4382eb522f58c7a46dfe48" title=" " alt="" coords="995,892,1142,919"/>
<area shape="rect" href="kvm__main_8c.html#a82d4376e528b0e4ff28ec43f992f364a" title=" " alt="" coords="969,943,1168,969"/>
<area shape="rect" href="x86_8c.html#a6f324dc73c5f97fe0b9dfa35f303d5f9" title=" " alt="" coords="981,993,1156,1020"/>
<area shape="rect" href="coalesced__mmio_8c.html#acbde5f51051def5601627c214de053d5" title=" " alt="" coords="968,1044,1169,1071"/>
<area shape="rect" href="kvm__main_8c.html#abfe532698477df01f13e371d91388539" title=" " alt="" coords="987,1095,1151,1121"/>
<area shape="rect" href="kvm__main_8c.html#a7e9f8db90d91053e866c157b6c162013" title=" " alt="" coords="975,1145,1163,1172"/>
<area shape="rect" href="kvm__main_8c.html#a78be2b95971bc468a0a368d314280776" title=" " alt="" coords="971,1196,1166,1223"/>
<area shape="rect" href="kvm__main_8c.html#ab6320575dc04178df16ea4d7dddff190" title=" " alt="" coords="984,1247,1153,1273"/>
<area shape="rect" href="irqchip_8c.html#a841c49803610b79f779b380bffbe07cb" title=" " alt="" coords="988,1297,1149,1324"/>
<area shape="rect" href="kvm__main_8c.html#ae58ffa9a2b55027be40935dd4410bd30" title=" " alt="" coords="991,1348,1147,1375"/>
<area shape="rect" href="kvm__main_8c.html#a3089edf2c0e5790aab7e8ed723f34b5b" title=" " alt="" coords="991,1399,1147,1425"/>
<area shape="rect" href="kvm__main_8c.html#ad245c522a96e3da12a65f213f34d2305" title=" " alt="" coords="968,740,1169,767"/>
<area shape="rect" href="x86_8c.html#a0c0c5e35bc626e4140927bf15b4881f9" title=" " alt="" coords="1217,892,1415,919"/>
<area shape="rect" href="kvm__main_8c.html#a0fcd9f7671bee7debec1bc05dcd9557b" title=" " alt="" coords="1240,943,1392,969"/>
<area shape="rect" href="x86_8c.html#ad83ae43be57823912b41e24e4b6bbc41" title=" " alt="" coords="1239,993,1393,1020"/>
<area shape="rect" href="hyperv_8c.html#ac7f9f19a66e3ae5ae397e937daf75a73" title=" " alt="" coords="1237,1044,1395,1071"/>
<area shape="rect" href="ioapic_8c.html#ae707e80b0215afe92318ac1813d15345" title=" " alt="" coords="1239,689,1393,716"/>
<area shape="rect" href="mmu_8c.html#a0beae9a256ad42642a6b522a36a18a74" title=" " alt="" coords="1234,740,1398,767"/>
<area shape="rect" href="page__track_8h.html#a061d2d3a74ebe3354da60bb521b8ef13" title=" " alt="" coords="1222,791,1410,817"/>
<area shape="rect" href="i8259_8c.html#a48d54ace62d2b40899cadfddf0b70781" title=" " alt="" coords="1249,841,1383,868"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="981,385,1156,412"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="770,512,909,539"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="1249,487,1383,513"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="1465,475,1611,501"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="1463,551,1613,577"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="1249,537,1383,564"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="989,537,1148,564"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="999,436,1138,463"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="997,588,1140,615"/>
</map>
</div>

</div>
</div>
<a id="aaeebe6cee9f13a0540cbd9b696648a1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeebe6cee9f13a0540cbd9b696648a1d">&#9670;&nbsp;</a></span>svm_allocate_nested()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int svm_allocate_nested </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l01177">1177</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;{</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keyword">struct </span>page *vmcb02_page;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a280879c3a0fa081ac14507bec27f0727">initialized</a>)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    vmcb02_page = alloc_page(GFP_KERNEL_ACCOUNT | __GFP_ZERO);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">if</span> (!vmcb02_page)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a> = page_address(vmcb02_page);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a91e376066b465faac6f37deac812bee5">pa</a> = __sme_set(page_to_pfn(vmcb02_page) &lt;&lt; PAGE_SHIFT);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">msrpm</a> = <a class="code" href="svm_8c.html#aaf821ba71761474726fdfb616796a0c8">svm_vcpu_alloc_msrpm</a>();</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">if</span> (!svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">msrpm</a>)</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="keywordflow">goto</span> err_free_vmcb02;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <a class="code" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21">svm_vcpu_init_msrpm</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">msrpm</a>);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a280879c3a0fa081ac14507bec27f0727">initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;err_free_vmcb02:</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    __free_page(vmcb02_page);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;}</div>
<div class="ttc" id="astructkvm__vmcb__info_html_a91e376066b465faac6f37deac812bee5"><div class="ttname"><a href="structkvm__vmcb__info.html#a91e376066b465faac6f37deac812bee5">kvm_vmcb_info::pa</a></div><div class="ttdeci">unsigned long pa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00111">svm.h:111</a></div></div>
<div class="ttc" id="astructsvm__nested__state_html_ac977ad2b258ba3df647e360fa11c7198"><div class="ttname"><a href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">svm_nested_state::msrpm</a></div><div class="ttdeci">u32 * msrpm</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00166">svm.h:166</a></div></div>
<div class="ttc" id="asvm_8c_html_aaee43a83fe8c444128a4d22b2d5d5c21"><div class="ttname"><a href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21">svm_vcpu_init_msrpm</a></div><div class="ttdeci">void svm_vcpu_init_msrpm(struct kvm_vcpu *vcpu, u32 *msrpm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00881">svm.c:881</a></div></div>
<div class="ttc" id="asvm_8c_html_aaf821ba71761474726fdfb616796a0c8"><div class="ttname"><a href="svm_8c.html#aaf821ba71761474726fdfb616796a0c8">svm_vcpu_alloc_msrpm</a></div><div class="ttdeci">u32 * svm_vcpu_alloc_msrpm(void)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00866">svm.c:866</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aaeebe6cee9f13a0540cbd9b696648a1d_cgraph.png" border="0" usemap="#asvm_8h_aaeebe6cee9f13a0540cbd9b696648a1d_cgraph" alt=""/></div>
<map name="asvm_8h_aaeebe6cee9f13a0540cbd9b696648a1d_cgraph" id="asvm_8h_aaeebe6cee9f13a0540cbd9b696648a1d_cgraph">
<area shape="rect" title=" " alt="" coords="5,169,165,196"/>
<area shape="rect" href="svm_8c.html#aaf821ba71761474726fdfb616796a0c8" title=" " alt="" coords="213,144,392,171"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="218,195,387,221"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="440,195,599,221"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="665,137,824,178"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="647,224,843,251"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="922,5,1063,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="891,57,1095,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="919,123,1066,149"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="957,224,1028,251"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="917,173,1068,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="1143,224,1316,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aaeebe6cee9f13a0540cbd9b696648a1d_icgraph.png" border="0" usemap="#asvm_8h_aaeebe6cee9f13a0540cbd9b696648a1d_icgraph" alt=""/></div>
<map name="asvm_8h_aaeebe6cee9f13a0540cbd9b696648a1d_icgraph" id="asvm_8h_aaeebe6cee9f13a0540cbd9b696648a1d_icgraph">
<area shape="rect" title=" " alt="" coords="2159,332,2319,359"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2000,332,2111,359"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,241,1919,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,357,1952,384"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,241,1673,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,170,1684,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,364,1679,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,111,1679,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,293,1668,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,297,1399,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,245,1403,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,195,1389,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,304,1144,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,144,1421,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,362,1408,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,362,1176,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,93,1412,120"/>
</map>
</div>

</div>
</div>
<a id="a4c285d86fd94954273295b317242c500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c285d86fd94954273295b317242c500">&#9670;&nbsp;</a></span>svm_clr_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_clr_intercept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00432">432</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;{</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4">vmcb_clr_intercept</a>(&amp;vmcb-&gt;control, bit);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(svm);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a4c285d86fd94954273295b317242c500_cgraph.png" border="0" usemap="#asvm_8h_a4c285d86fd94954273295b317242c500_cgraph" alt=""/></div>
<map name="asvm_8h_a4c285d86fd94954273295b317242c500_cgraph" id="asvm_8h_a4c285d86fd94954273295b317242c500_cgraph">
<area shape="rect" title=" " alt="" coords="5,239,144,265"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="192,188,325,215"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="391,289,538,316"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="405,5,525,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="373,57,556,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="374,122,555,163"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="397,188,533,215"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="389,239,540,265"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="621,104,740,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="604,155,757,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1044,97,1217,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="805,129,996,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a4c285d86fd94954273295b317242c500_icgraph.png" border="0" usemap="#asvm_8h_a4c285d86fd94954273295b317242c500_icgraph" alt=""/></div>
<map name="asvm_8h_a4c285d86fd94954273295b317242c500_icgraph" id="asvm_8h_a4c285d86fd94954273295b317242c500_icgraph">
<area shape="rect" title=" " alt="" coords="2768,290,2907,317"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="2072,54,2159,81"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="2547,152,2698,194"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="2553,228,2692,254"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="2559,358,2686,385"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="2317,409,2418,436"/>
<area shape="rect" href="svm_8c.html#aff900c45df2faa151d783155ec034f86" title=" " alt="" coords="2539,290,2706,317"/>
<area shape="rect" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1" title=" " alt="" coords="2537,87,2709,128"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="2063,561,2167,588"/>
<area shape="rect" href="svm_8c.html#aa30e5cb5ad1759988fc349bd703bd4dc" title=" " alt="" coords="2525,510,2720,537"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1789,54,1917,81"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="2291,90,2443,131"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="2309,206,2425,233"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="2045,160,2186,186"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1732,126,1973,153"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="2257,358,2477,385"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="2021,244,2209,270"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="1498,188,1655,214"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="1774,178,1931,219"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,414,1389,441"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="2050,510,2181,537"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,700,945,726"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1775,473,1930,500"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,368,940,394"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="2050,409,2181,436"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2060,460,2171,486"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,649,719,676"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,481,520,508"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,456,323,482"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,456,128,482"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,473,1673,500"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,356,1684,398"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,590,1679,617"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,305,1679,332"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,524,1668,566"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,466,1399,507"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,532,1403,558"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,473,1144,500"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,473,939,500"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,364,1421,390"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,583,1408,624"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,583,1176,624"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,313,1412,340"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1743,542,1963,569"/>
<area shape="rect" href="svm_8c.html#aaa5bf4dc91985f4c533268b7e4ca811d" title=" " alt="" coords="2303,257,2432,284"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="2291,308,2443,334"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1819,593,1886,620"/>
</map>
</div>

</div>
</div>
<a id="affe9512dad96b228e24b8cc7175db04c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affe9512dad96b228e24b8cc7175db04c">&#9670;&nbsp;</a></span>svm_complete_interrupt_delivery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_complete_interrupt_delivery </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>delivery_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trig_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03633">3633</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;{</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;<span class="comment">     * apic-&gt;apicv_active must be read after vcpu-&gt;mode.</span></div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;<span class="comment">     * Pairs with smp_store_release in vcpu_enter_guest.</span></div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    <span class="keywordtype">bool</span> in_guest_mode = (smp_load_acquire(&amp;vcpu-&gt;mode) == IN_GUEST_MODE);</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160; </div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    <span class="comment">/* Note, this is called iff the local APIC is in-kernel. */</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;    <span class="keywordflow">if</span> (!READ_ONCE(vcpu-&gt;arch.apic-&gt;apicv_active)) {</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;        <span class="comment">/* Process the interrupt via kvm_check_and_inject_events(). */</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;        kvm_make_request(KVM_REQ_EVENT, vcpu);</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;        <a class="code" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44">kvm_vcpu_kick</a>(vcpu);</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    }</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160; </div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    trace_kvm_apicv_accept_irq(vcpu-&gt;vcpu_id, delivery_mode, trig_mode, vector);</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    <span class="keywordflow">if</span> (in_guest_mode) {</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;<span class="comment">         * Signal the doorbell to tell hardware to inject the IRQ.  If</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;<span class="comment">         * the vCPU exits the guest before the doorbell chimes, hardware</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;<span class="comment">         * will automatically process AVIC interrupts at the next VMRUN.</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;        <a class="code" href="avic_8c.html#ac8c9ded2546dccf6e4b561e633d22e7e">avic_ring_doorbell</a>(vcpu);</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;<span class="comment">         * Wake the vCPU if it was blocking.  KVM will then detect the</span></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;<span class="comment">         * pending IRQ when checking if the vCPU has a wake event.</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;        <a class="code" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5">kvm_vcpu_wake_up</a>(vcpu);</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;    }</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;}</div>
<div class="ttc" id="aavic_8c_html_ac8c9ded2546dccf6e4b561e633d22e7e"><div class="ttname"><a href="avic_8c.html#ac8c9ded2546dccf6e4b561e633d22e7e">avic_ring_doorbell</a></div><div class="ttdeci">void avic_ring_doorbell(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="avic_8c_source.html#l00321">avic.c:321</a></div></div>
<div class="ttc" id="akvm__main_8c_html_ac82f28c95da4a0cc137c5a37f08d1f44"><div class="ttname"><a href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44">kvm_vcpu_kick</a></div><div class="ttdeci">void kvm_vcpu_kick(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__main_8c_source.html#l03931">kvm_main.c:3931</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_affe9512dad96b228e24b8cc7175db04c_cgraph.png" border="0" usemap="#asvm_8h_affe9512dad96b228e24b8cc7175db04c_cgraph" alt=""/></div>
<map name="asvm_8h_affe9512dad96b228e24b8cc7175db04c_cgraph" id="asvm_8h_affe9512dad96b228e24b8cc7175db04c_cgraph">
<area shape="rect" title=" " alt="" coords="5,49,187,90"/>
<area shape="rect" href="avic_8c.html#ac8c9ded2546dccf6e4b561e633d22e7e" title=" " alt="" coords="235,5,376,32"/>
<area shape="rect" href="kvm__main_8c.html#ac82f28c95da4a0cc137c5a37f08d1f44" title=" " alt="" coords="244,56,367,83"/>
<area shape="rect" href="kvm__main_8c.html#ad9f0140eebcdef9a9ebae54431d2fba5" title=" " alt="" coords="451,107,605,133"/>
<area shape="rect" href="x86_8c.html#a42500cdc8706ebf4fa3ec21645530097" title=" " alt="" coords="424,56,632,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_affe9512dad96b228e24b8cc7175db04c_icgraph.png" border="0" usemap="#asvm_8h_affe9512dad96b228e24b8cc7175db04c_icgraph" alt=""/></div>
<map name="asvm_8h_affe9512dad96b228e24b8cc7175db04c_icgraph" id="asvm_8h_affe9512dad96b228e24b8cc7175db04c_icgraph">
<area shape="rect" title=" " alt="" coords="1429,31,1611,72"/>
<area shape="rect" href="avic_8c.html#a2b9e298755a0d51bb5b2dfc9dd254c64" title=" " alt="" coords="1238,13,1359,39"/>
<area shape="rect" href="svm_8c.html#a501d86bb28fd272f1ab52b8689b5f948" title=" " alt="" coords="1216,63,1381,90"/>
<area shape="rect" href="avic_8c.html#ad9345a779111a59de8fa4110106c3adf" title=" " alt="" coords="205,13,380,39"/>
<area shape="rect" href="avic_8c.html#a4b900d047f49b6cd00266aba3f4912bf" title=" " alt="" coords="944,38,1168,65"/>
<area shape="rect" href="avic_8c.html#a4a11c0014568405b90307ef68285e4ff" title=" " alt="" coords="5,5,157,47"/>
<area shape="rect" href="avic_8c.html#a7cf9fdcdf4f5f6559c099faaab0c2d29" title=" " alt="" coords="428,38,635,65"/>
<area shape="rect" href="avic_8c.html#a1404df5f813565dd104640a6e5bfea67" title=" " alt="" coords="683,89,896,115"/>
</map>
</div>

</div>
</div>
<a id="a06d8a6a899d49f3235ec1294d1943c84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06d8a6a899d49f3235ec1294d1943c84">&#9670;&nbsp;</a></span>svm_copy_lbrs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_copy_lbrs </td>
          <td>(</td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>to_vmcb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>from_vmcb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00982">982</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;{</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    to_vmcb-&gt;save.dbgctl        = from_vmcb-&gt;save.dbgctl;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    to_vmcb-&gt;save.br_from       = from_vmcb-&gt;save.br_from;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    to_vmcb-&gt;save.br_to     = from_vmcb-&gt;save.br_to;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    to_vmcb-&gt;save.last_excp_from    = from_vmcb-&gt;save.last_excp_from;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    to_vmcb-&gt;save.last_excp_to  = from_vmcb-&gt;save.last_excp_to;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(to_vmcb, <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a7ffead4bb2fd939a3b453692fdc4664a">VMCB_LBR</a>);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a06d8a6a899d49f3235ec1294d1943c84_cgraph.png" border="0" usemap="#asvm_8h_a06d8a6a899d49f3235ec1294d1943c84_cgraph" alt=""/></div>
<map name="asvm_8h_a06d8a6a899d49f3235ec1294d1943c84_cgraph" id="asvm_8h_a06d8a6a899d49f3235ec1294d1943c84_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,124,32"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="172,5,308,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a06d8a6a899d49f3235ec1294d1943c84_icgraph.png" border="0" usemap="#asvm_8h_a06d8a6a899d49f3235ec1294d1943c84_icgraph" alt=""/></div>
<map name="asvm_8h_a06d8a6a899d49f3235ec1294d1943c84_icgraph" id="asvm_8h_a06d8a6a899d49f3235ec1294d1943c84_icgraph">
<area shape="rect" title=" " alt="" coords="2367,274,2485,301"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,327,1919,354"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,222,1952,249"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="2183,299,2319,326"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="2184,249,2317,275"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,146,1673,173"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,441,1684,483"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,273,1679,299"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,226,719,253"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,390,1679,417"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,324,1668,365"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,55,1399,96"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,121,1403,147"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,171,1389,198"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,62,1144,89"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,62,939,89"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,445,1421,471"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,273,1408,315"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,273,1176,315"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,226,945,253"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,281,940,307"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,283,520,310"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,365,323,391"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,365,128,391"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,339,1412,366"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="2000,277,2135,303"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1787,277,1897,303"/>
</map>
</div>

</div>
</div>
<a id="ae2a559173016267c3c1ef55be6571c0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2a559173016267c3c1ef55be6571c0c">&#9670;&nbsp;</a></span>svm_copy_vmloadsave_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_copy_vmloadsave_state </td>
          <td>(</td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>to_vmcb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>from_vmcb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l00951">951</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;{</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    to_vmcb-&gt;save.fs = from_vmcb-&gt;save.fs;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    to_vmcb-&gt;save.gs = from_vmcb-&gt;save.gs;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    to_vmcb-&gt;save.tr = from_vmcb-&gt;save.tr;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    to_vmcb-&gt;save.ldtr = from_vmcb-&gt;save.ldtr;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    to_vmcb-&gt;save.kernel_gs_base = from_vmcb-&gt;save.kernel_gs_base;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    to_vmcb-&gt;save.star = from_vmcb-&gt;save.star;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    to_vmcb-&gt;save.lstar = from_vmcb-&gt;save.lstar;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    to_vmcb-&gt;save.cstar = from_vmcb-&gt;save.cstar;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    to_vmcb-&gt;save.sfmask = from_vmcb-&gt;save.sfmask;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    to_vmcb-&gt;save.sysenter_cs = from_vmcb-&gt;save.sysenter_cs;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    to_vmcb-&gt;save.sysenter_esp = from_vmcb-&gt;save.sysenter_esp;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    to_vmcb-&gt;save.sysenter_eip = from_vmcb-&gt;save.sysenter_eip;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ae2a559173016267c3c1ef55be6571c0c_icgraph.png" border="0" usemap="#asvm_8h_ae2a559173016267c3c1ef55be6571c0c_icgraph" alt=""/></div>
<map name="asvm_8h_ae2a559173016267c3c1ef55be6571c0c_icgraph" id="asvm_8h_ae2a559173016267c3c1ef55be6571c0c_icgraph">
<area shape="rect" title=" " alt="" coords="840,23,1015,65"/>
<area shape="rect" href="svm_8c.html#a22d5ad8a3cac7e24cb8438a20eb39348" title=" " alt="" coords="577,31,792,57"/>
<area shape="rect" href="svm_8c.html#a21c0c414304458bb0fdecde7cc8eeb2d" title=" " alt="" coords="372,5,528,32"/>
<area shape="rect" href="svm_8c.html#a81c9359522d571596389c15258054845" title=" " alt="" coords="371,56,529,83"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,31,323,57"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,31,128,57"/>
</map>
</div>

</div>
</div>
<a id="aefe90b7232034ee5f45a41f108ffb891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefe90b7232034ee5f45a41f108ffb891">&#9670;&nbsp;</a></span>svm_copy_vmrun_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_copy_vmrun_state </td>
          <td>(</td>
          <td class="paramtype">struct vmcb_save_area *&#160;</td>
          <td class="paramname"><em>to_save</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct vmcb_save_area *&#160;</td>
          <td class="paramname"><em>from_save</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l00931">931</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;{</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    to_save-&gt;es = from_save-&gt;es;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    to_save-&gt;cs = from_save-&gt;cs;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    to_save-&gt;ss = from_save-&gt;ss;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    to_save-&gt;ds = from_save-&gt;ds;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    to_save-&gt;gdtr = from_save-&gt;gdtr;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    to_save-&gt;idtr = from_save-&gt;idtr;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    to_save-&gt;rflags = from_save-&gt;rflags | X86_EFLAGS_FIXED;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    to_save-&gt;efer = from_save-&gt;efer;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    to_save-&gt;cr0 = from_save-&gt;cr0;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    to_save-&gt;cr3 = from_save-&gt;cr3;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    to_save-&gt;cr4 = from_save-&gt;cr4;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    to_save-&gt;rax = from_save-&gt;rax;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    to_save-&gt;rsp = from_save-&gt;rsp;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    to_save-&gt;rip = from_save-&gt;rip;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    to_save-&gt;cpl = 0;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aefe90b7232034ee5f45a41f108ffb891_icgraph.png" border="0" usemap="#asvm_8h_aefe90b7232034ee5f45a41f108ffb891_icgraph" alt=""/></div>
<map name="asvm_8h_aefe90b7232034ee5f45a41f108ffb891_icgraph" id="asvm_8h_aefe90b7232034ee5f45a41f108ffb891_icgraph">
<area shape="rect" title=" " alt="" coords="221,5,399,32"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="5,5,173,32"/>
</map>
</div>

</div>
</div>
<a id="a690337312a648d2948b22540da6f031e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a690337312a648d2948b22540da6f031e">&#9670;&nbsp;</a></span>svm_free_nested()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_free_nested </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l01203">1203</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;{</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">if</span> (!svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a280879c3a0fa081ac14507bec27f0727">initialized</a>)</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">if</span> (WARN_ON_ONCE(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a> != svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>))</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <a class="code" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a>(svm, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <a class="code" href="svm_8c.html#a67937d45023d92583b0bd363c73b6c2b">svm_vcpu_free_msrpm</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">msrpm</a>);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#ac977ad2b258ba3df647e360fa11c7198">msrpm</a> = NULL;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    __free_page(virt_to_page(svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>));</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a53278329495133b9cb2bd06db36a92a0">vmcb02</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a> = NULL;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">     * When last_vmcb12_gpa matches the current vmcb12 gpa,</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">     * some vmcb12 fields are not loaded if they are marked clean</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">     * in the vmcb12, since in this case they are up to date already.</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">     * When the vmcb02 is freed, this optimization becomes invalid.</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a469889e41a4042539ad55c80ed27ec48">last_vmcb12_gpa</a> = INVALID_GPA;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a280879c3a0fa081ac14507bec27f0727">initialized</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;}</div>
<div class="ttc" id="astructsvm__nested__state_html_a469889e41a4042539ad55c80ed27ec48"><div class="ttname"><a href="structsvm__nested__state.html#a469889e41a4042539ad55c80ed27ec48">svm_nested_state::last_vmcb12_gpa</a></div><div class="ttdeci">u64 last_vmcb12_gpa</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00163">svm.h:163</a></div></div>
<div class="ttc" id="asvm_8c_html_a67937d45023d92583b0bd363c73b6c2b"><div class="ttname"><a href="svm_8c.html#a67937d45023d92583b0bd363c73b6c2b">svm_vcpu_free_msrpm</a></div><div class="ttdeci">void svm_vcpu_free_msrpm(u32 *msrpm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00915">svm.c:915</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a690337312a648d2948b22540da6f031e_cgraph.png" border="0" usemap="#asvm_8h_a690337312a648d2948b22540da6f031e_cgraph" alt=""/></div>
<map name="asvm_8h_a690337312a648d2948b22540da6f031e_cgraph" id="asvm_8h_a690337312a648d2948b22540da6f031e_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,140,57"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="204,5,347,32"/>
<area shape="rect" href="svm_8c.html#a67937d45023d92583b0bd363c73b6c2b" title=" " alt="" coords="188,56,363,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a690337312a648d2948b22540da6f031e_icgraph.png" border="0" usemap="#asvm_8h_a690337312a648d2948b22540da6f031e_icgraph" alt=""/></div>
<map name="asvm_8h_a690337312a648d2948b22540da6f031e_icgraph" id="asvm_8h_a690337312a648d2948b22540da6f031e_icgraph">
<area shape="rect" title=" " alt="" coords="2169,324,2304,351"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2005,299,2116,325"/>
<area shape="rect" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4" title=" " alt="" coords="2000,349,2121,376"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,241,1919,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,357,1952,384"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,241,1673,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,170,1684,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,364,1679,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,111,1679,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,293,1668,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,297,1399,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,245,1403,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,195,1389,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,304,1144,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,144,1421,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,362,1408,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,362,1176,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,93,1412,120"/>
</map>
</div>

</div>
</div>
<a id="a67762809a8b14687a3bffdd5a4cd03aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67762809a8b14687a3bffdd5a4cd03aa">&#9670;&nbsp;</a></span>svm_interrupt_blocked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool svm_interrupt_blocked </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03767">3767</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;{</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>;</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160; </div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a>(svm))</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160; </div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(vcpu)) {</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;        <span class="comment">/* As long as interrupts are being delivered...  */</span></div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        <span class="keywordflow">if</span> ((svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a2c5d9afb37c1ab54586cdcf478b417c2">int_ctl</a> &amp; V_INTR_MASKING_MASK)</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;            ? !(svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>-&gt;save.rflags &amp; X86_EFLAGS_IF)</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;            : !(<a class="code" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c">kvm_get_rflags</a>(vcpu) &amp; X86_EFLAGS_IF))</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160; </div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;        <span class="comment">/* ... vmexits aren&#39;t blocked by the interrupt shadow  */</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141">nested_exit_on_intr</a>(svm))</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a4a9065695154691afff42bc585235d64">svm_get_if_flag</a>(vcpu))</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;    }</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160; </div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;    <span class="keywordflow">return</span> (vmcb-&gt;control.int_state &amp; SVM_INTERRUPT_SHADOW_MASK);</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a4a9065695154691afff42bc585235d64"><div class="ttname"><a href="svm_8c.html#a4a9065695154691afff42bc585235d64">svm_get_if_flag</a></div><div class="ttdeci">static bool svm_get_if_flag(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01603">svm.c:1603</a></div></div>
<div class="ttc" id="asvm_8h_html_aea7fbac9a0652dc113c81593522e47ca"><div class="ttname"><a href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a></div><div class="ttdeci">static bool gif_set(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00483">svm.h:483</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a67762809a8b14687a3bffdd5a4cd03aa_cgraph.png" border="0" usemap="#asvm_8h_a67762809a8b14687a3bffdd5a4cd03aa_cgraph" alt=""/></div>
<map name="asvm_8h_a67762809a8b14687a3bffdd5a4cd03aa_cgraph" id="asvm_8h_a67762809a8b14687a3bffdd5a4cd03aa_cgraph">
<area shape="rect" title=" " alt="" coords="5,139,176,166"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="266,13,333,39"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="647,63,767,90"/>
<area shape="rect" href="x86_8c.html#aeca964de04721f39e3ec34f195707b5c" title=" " alt="" coords="440,165,563,191"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="224,114,375,141"/>
<area shape="rect" href="svm_8c.html#a4a9065695154691afff42bc585235d64" title=" " alt="" coords="237,215,362,242"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="466,266,537,293"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="442,13,561,39"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="628,13,785,39"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="833,13,952,39"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1239,5,1412,47"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1000,38,1191,65"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="423,114,580,141"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="446,215,557,242"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="653,215,760,242"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a67762809a8b14687a3bffdd5a4cd03aa_icgraph.png" border="0" usemap="#asvm_8h_a67762809a8b14687a3bffdd5a4cd03aa_icgraph" alt=""/></div>
<map name="asvm_8h_a67762809a8b14687a3bffdd5a4cd03aa_icgraph" id="asvm_8h_a67762809a8b14687a3bffdd5a4cd03aa_icgraph">
<area shape="rect" title=" " alt="" coords="251,31,421,57"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,5,203,32"/>
<area shape="rect" href="svm_8c.html#a005049e4b080345fc3924233b8e33bce" title=" " alt="" coords="19,56,189,83"/>
</map>
</div>

</div>
</div>
<a id="a8afafecae406016532810194f187fe2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8afafecae406016532810194f187fe2c">&#9670;&nbsp;</a></span>svm_invoke_exit_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int svm_invoke_exit_handler </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>exit_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03453">3453</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;{</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#ad838ad3f2e1e678e2c13720c679dc8f8">svm_check_exit_valid</a>(exit_code))</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#ab46a833ac93ce3fda7973768cadb1929">svm_handle_invalid_exit</a>(vcpu, exit_code);</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160; </div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;<span class="preprocessor">#ifdef CONFIG_RETPOLINE</span></div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;    <span class="keywordflow">if</span> (exit_code == SVM_EXIT_MSR)</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a173c3f7c02a4287d140cc0f34564a7bd">msr_interception</a>(vcpu);</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exit_code == SVM_EXIT_VINTR)</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404">interrupt_window_interception</a>(vcpu);</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exit_code == SVM_EXIT_INTR)</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a21af2401d39dc5c49a388960ce1196ad">intr_interception</a>(vcpu);</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exit_code == SVM_EXIT_HLT)</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="x86_8c.html#a92f17256a8d83aac265d08a1e3500340">kvm_emulate_halt</a>(vcpu);</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exit_code == SVM_EXIT_NPF)</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#a723646ac5d3234ba8e1845249e6a0935">npf_interception</a>(vcpu);</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8c.html#af73415c5c6c2827a7671c0d2cc5b1c4f">svm_exit_handlers</a>[exit_code](vcpu);</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a173c3f7c02a4287d140cc0f34564a7bd"><div class="ttname"><a href="svm_8c.html#a173c3f7c02a4287d140cc0f34564a7bd">msr_interception</a></div><div class="ttdeci">static int msr_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03169">svm.c:3169</a></div></div>
<div class="ttc" id="asvm_8c_html_a21af2401d39dc5c49a388960ce1196ad"><div class="ttname"><a href="svm_8c.html#a21af2401d39dc5c49a388960ce1196ad">intr_interception</a></div><div class="ttdeci">static int intr_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02246">svm.c:2246</a></div></div>
<div class="ttc" id="asvm_8c_html_a723646ac5d3234ba8e1845249e6a0935"><div class="ttname"><a href="svm_8c.html#a723646ac5d3234ba8e1845249e6a0935">npf_interception</a></div><div class="ttdeci">static int npf_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l02051">svm.c:2051</a></div></div>
<div class="ttc" id="asvm_8c_html_ab07aabd2b78a54e2f9a6bd72ffbfa404"><div class="ttname"><a href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404">interrupt_window_interception</a></div><div class="ttdeci">static int interrupt_window_interception(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03177">svm.c:3177</a></div></div>
<div class="ttc" id="asvm_8c_html_ab46a833ac93ce3fda7973768cadb1929"><div class="ttname"><a href="svm_8c.html#ab46a833ac93ce3fda7973768cadb1929">svm_handle_invalid_exit</a></div><div class="ttdeci">static int svm_handle_invalid_exit(struct kvm_vcpu *vcpu, u64 exit_code)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03441">svm.c:3441</a></div></div>
<div class="ttc" id="asvm_8c_html_ad838ad3f2e1e678e2c13720c679dc8f8"><div class="ttname"><a href="svm_8c.html#ad838ad3f2e1e678e2c13720c679dc8f8">svm_check_exit_valid</a></div><div class="ttdeci">static bool svm_check_exit_valid(u64 exit_code)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03435">svm.c:3435</a></div></div>
<div class="ttc" id="asvm_8c_html_af73415c5c6c2827a7671c0d2cc5b1c4f"><div class="ttname"><a href="svm_8c.html#af73415c5c6c2827a7671c0d2cc5b1c4f">svm_exit_handlers</a></div><div class="ttdeci">static int(*const svm_exit_handlers[])(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03238">svm.c:3238</a></div></div>
<div class="ttc" id="ax86_8c_html_a92f17256a8d83aac265d08a1e3500340"><div class="ttname"><a href="x86_8c.html#a92f17256a8d83aac265d08a1e3500340">kvm_emulate_halt</a></div><div class="ttdeci">int kvm_emulate_halt(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l09857">x86.c:9857</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a8afafecae406016532810194f187fe2c_cgraph.png" border="0" usemap="#asvm_8h_a8afafecae406016532810194f187fe2c_cgraph" alt=""/></div>
<map name="asvm_8h_a8afafecae406016532810194f187fe2c_cgraph" id="asvm_8h_a8afafecae406016532810194f187fe2c_cgraph">
<area shape="rect" title=" " alt="" coords="5,610,193,637"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="241,559,461,586"/>
<area shape="rect" href="svm_8c.html#a21af2401d39dc5c49a388960ce1196ad" title=" " alt="" coords="287,509,416,535"/>
<area shape="rect" href="x86_8c.html#a92f17256a8d83aac265d08a1e3500340" title=" " alt="" coords="521,939,665,966"/>
<area shape="rect" href="svm_8c.html#a173c3f7c02a4287d140cc0f34564a7bd" title=" " alt="" coords="285,378,417,405"/>
<area shape="rect" href="svm_8c.html#a723646ac5d3234ba8e1845249e6a0935" title=" " alt="" coords="287,661,415,687"/>
<area shape="rect" href="svm_8c.html#ad838ad3f2e1e678e2c13720c679dc8f8" title=" " alt="" coords="268,711,435,738"/>
<area shape="rect" href="svm_8c.html#ab46a833ac93ce3fda7973768cadb1929" title=" " alt="" coords="259,610,443,637"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="530,458,657,485"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="805,559,876,586"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1283,509,1403,535"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="771,407,910,434"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1275,446,1411,473"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="1037,407,1170,434"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="1269,370,1416,397"/>
<area shape="rect" href="x86_8c.html#a8e4eadde8e72cc522781d684a646fbe6" title=" " alt="" coords="743,1002,938,1029"/>
<area shape="rect" href="x86_8c.html#aba69f77338abd9dcd861fd8921d5011a" title=" " alt="" coords="725,939,956,966"/>
<area shape="rect" href="x86_8c.html#ad9a061ca4a3ded30c0c698224da4504d" title=" " alt="" coords="1024,1015,1183,1042"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="1283,1041,1402,1067"/>
<area shape="rect" href="pmu_8c.html#a0b4da757f734ef55ec71a70808bc50d4" title=" " alt="" coords="1013,866,1194,893"/>
<area shape="rect" href="x86_8c.html#aaad1e1c79fc8780110beaebf328ea7f9" title=" " alt="" coords="1010,939,1197,966"/>
<area shape="rect" href="pmu_8c.html#a82f21621653f5a1b16e8aeeca1571933" title=" " alt="" coords="1281,822,1404,849"/>
<area shape="rect" href="pmu_8c.html#abb936a26c4c8f2bcd5abc2aa85f8d44f" title=" " alt="" coords="1263,873,1422,915"/>
<area shape="rect" href="pmu_8c.html#a71b19ab0f332b8f09e63bad068ffc2fd" title=" " alt="" coords="1255,721,1430,747"/>
<area shape="rect" href="pmu_8c.html#ade55b96e482f31963470d3ceb4f49df0" title=" " alt="" coords="1257,771,1428,798"/>
<area shape="rect" href="x86_8c.html#a02711c553f435f66f21d0d417fa74202" title=" " alt="" coords="1269,939,1416,966"/>
<area shape="rect" href="x86_8c.html#ade9d1daa53933c6d5907c8a7b1045f01" title=" " alt="" coords="1251,990,1435,1017"/>
<area shape="rect" href="x86_8c.html#a955a40f66041d085593b16a75075a1ae" title=" " alt="" coords="515,243,672,270"/>
<area shape="rect" href="x86_8c.html#a1550ae1115ac5be61ab770f6f3c5f513" title=" " alt="" coords="513,117,673,143"/>
<area shape="rect" href="x86_8c.html#aeeb1ecca8bf1a2b4cda190c5426b80c9" title=" " alt="" coords="761,218,921,245"/>
<area shape="rect" href="x86_8c.html#a3eb5a7800dd3bcd13dbc74632fbf22a1" title=" " alt="" coords="749,269,932,295"/>
<area shape="rect" href="x86_8c.html#accdc879b22f280aa9ba41e58a6c1658e" title=" " alt="" coords="759,167,922,194"/>
<area shape="rect" href="x86_8c.html#a0f0d8061749acba7b8f4d1b9b0884079" title=" " alt="" coords="1004,122,1203,149"/>
<area shape="rect" href="x86_8c.html#a5492b645ed1b58ebf45bd68cad0b5092" title=" " alt="" coords="1025,173,1181,215"/>
<area shape="rect" href="x86_8c.html#a6b64ebea5fdc7d1f0434fb509942a56f" title=" " alt="" coords="1020,291,1187,332"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="1033,239,1174,266"/>
<area shape="rect" href="x86_8c.html#a493307a40b51eeb761e91a1910876721" title=" " alt="" coords="1036,71,1171,98"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a7284219cd6cc4787f8e1eba2d4cf2c19" title=" " alt="" coords="766,66,915,93"/>
<area shape="rect" href="x86_8c.html#a99cf4c7be0b4cac0886649c7da9daa66" title=" " alt="" coords="749,117,932,143"/>
<area shape="rect" href="x86_8c.html#a4a7acb17f522083e1a9edc95e3788295" title=" " alt="" coords="1020,5,1187,47"/>
<area shape="rect" href="mmu_8c.html#a3d0bd209d792a4316f3b40681fdc10f9" title=" " alt="" coords="509,737,677,763"/>
<area shape="rect" href="mmu_8c.html#a899cf46c0ee6df6305c7fe167421e2b7" title=" " alt="" coords="747,686,934,713"/>
<area shape="rect" href="mmu_8c.html#abaee26e516b75f579b063a76c376b045" title=" " alt="" coords="1025,799,1181,826"/>
<area shape="rect" href="mmu__internal_8h.html#ae3c71be306692107b4d90bfb8d24d7f5" title=" " alt="" coords="745,787,936,814"/>
<area shape="rect" href="mmu_8c.html#a45417375d740e0905773ac641827e0a0" title=" " alt="" coords="741,838,941,865"/>
<area shape="rect" href="x86_8c.html#a3f6bd8b3f0bc1678451fd28682e7c3b1" title=" " alt="" coords="749,889,932,915"/>
<area shape="rect" href="mmu_8c.html#aa6dadc0bd20da0d41281abe089941491" title=" " alt="" coords="1033,647,1173,674"/>
<area shape="rect" href="mmu_8c.html#a24c91b8ae0a349c76c95f6266f62d6e1" title=" " alt="" coords="1042,698,1165,725"/>
<area shape="rect" href="mmu_8c.html#a82303f01ba06fead33e8a67eac44807e" title=" " alt="" coords="1016,749,1191,775"/>
<area shape="rect" href="svm_8c.html#adc30f731ef4ff2d797ec137e5fab0f69" title=" " alt="" coords="542,610,645,637"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a8afafecae406016532810194f187fe2c_icgraph.png" border="0" usemap="#asvm_8h_a8afafecae406016532810194f187fe2c_icgraph" alt=""/></div>
<map name="asvm_8h_a8afafecae406016532810194f187fe2c_icgraph" id="asvm_8h_a8afafecae406016532810194f187fe2c_icgraph">
<area shape="rect" title=" " alt="" coords="416,35,604,61"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="5,5,163,32"/>
<area shape="rect" href="sev_8c.html#ae483e70b55c68f5a2405263543ce3737" title=" " alt="" coords="211,27,368,69"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="223,93,356,120"/>
</map>
</div>

</div>
</div>
<a id="a397a88cd5af0b0bb8a9ef4a5e6bc849d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a397a88cd5af0b0bb8a9ef4a5e6bc849d">&#9670;&nbsp;</a></span>svm_is_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool svm_is_intercept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00441">441</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;{</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79">vmcb_is_intercept</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control, bit);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a6eb37bb9efc32f45f75055de8ba4fc79"><div class="ttname"><a href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79">vmcb_is_intercept</a></div><div class="ttdeci">static bool vmcb_is_intercept(struct vmcb_control_area *control, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00391">svm.h:391</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a397a88cd5af0b0bb8a9ef4a5e6bc849d_cgraph.png" border="0" usemap="#asvm_8h_a397a88cd5af0b0bb8a9ef4a5e6bc849d_cgraph" alt=""/></div>
<map name="asvm_8h_a397a88cd5af0b0bb8a9ef4a5e6bc849d_cgraph" id="asvm_8h_a397a88cd5af0b0bb8a9ef4a5e6bc849d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,139,32"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="187,5,328,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a397a88cd5af0b0bb8a9ef4a5e6bc849d_icgraph.png" border="0" usemap="#asvm_8h_a397a88cd5af0b0bb8a9ef4a5e6bc849d_icgraph" alt=""/></div>
<map name="asvm_8h_a397a88cd5af0b0bb8a9ef4a5e6bc849d_icgraph" id="asvm_8h_a397a88cd5af0b0bb8a9ef4a5e6bc849d_icgraph">
<area shape="rect" title=" " alt="" coords="2433,122,2567,149"/>
<area shape="rect" href="svm_2nested_8c.html#a232d9e4f1731f0d495e3b4f9d530d0ee" title=" " alt="" coords="2231,5,2385,47"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,122,1389,149"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="2257,353,2359,379"/>
<area shape="rect" href="svm_8c.html#a27df28527cda6f7917355af86817d940" title=" " alt="" coords="2251,513,2365,539"/>
<area shape="rect" href="svm_8c.html#a640846de1c48f3e408644fcb85a6004b" title=" " alt="" coords="2239,71,2377,98"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="2033,42,2149,69"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="2026,403,2157,430"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,475,945,502"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,298,1919,325"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,409,940,435"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="2026,251,2157,278"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2036,353,2147,379"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,274,719,301"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,274,520,301"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,249,323,275"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,249,128,275"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,71,1673,98"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,341,1684,383"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,407,1679,434"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,290,1679,317"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,224,1668,265"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,5,1399,47"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,71,1403,98"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,13,1144,39"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,13,939,39"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,341,1421,367"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,392,1408,433"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,443,1176,484"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,290,1412,317"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,509,1952,535"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="2000,610,2183,637"/>
</map>
</div>

</div>
</div>
<a id="afea614d490148481c96faf7c1b5ecb11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afea614d490148481c96faf7c1b5ecb11">&#9670;&nbsp;</a></span>svm_leave_nested()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_leave_nested </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l01229">1229</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;{</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>)) {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a32951ee4dfbf17d414fcdad2d336b25b">nested_run_pending</a> = 0;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a16894147af263784cff5f93602e97a54">vmcb12_gpa</a> = INVALID_GPA;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <a class="code" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3">leave_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <a class="code" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53">svm_switch_vmcb</a>(svm, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <a class="code" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53">nested_svm_uninit_mmu_context</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <a class="code" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb">vmcb_mark_all_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a">kvm_apicv_activated</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            kvm_make_request(KVM_REQ_APICV_UPDATE, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    }</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    kvm_clear_request(KVM_REQ_GET_NESTED_STATE_PAGES, <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a5980ebd310893869bc4c059f110a13cb"><div class="ttname"><a href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb">vmcb_mark_all_dirty</a></div><div class="ttdeci">static void vmcb_mark_all_dirty(struct vmcb *vmcb)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00343">svm.h:343</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_afea614d490148481c96faf7c1b5ecb11_cgraph.png" border="0" usemap="#asvm_8h_afea614d490148481c96faf7c1b5ecb11_cgraph" alt=""/></div>
<map name="asvm_8h_afea614d490148481c96faf7c1b5ecb11_cgraph" id="asvm_8h_afea614d490148481c96faf7c1b5ecb11_cgraph">
<area shape="rect" title=" " alt="" coords="5,165,149,192"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="231,5,351,32"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="210,56,371,83"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="218,107,363,133"/>
<area shape="rect" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53" title=" " alt="" coords="197,158,384,199"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="219,224,362,251"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="255,275,326,301"/>
<area shape="rect" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb" title=" " alt="" coords="211,325,370,352"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_afea614d490148481c96faf7c1b5ecb11_icgraph.png" border="0" usemap="#asvm_8h_afea614d490148481c96faf7c1b5ecb11_icgraph" alt=""/></div>
<map name="asvm_8h_afea614d490148481c96faf7c1b5ecb11_icgraph" id="asvm_8h_afea614d490148481c96faf7c1b5ecb11_icgraph">
<area shape="rect" title=" " alt="" coords="2169,429,2313,456"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2005,196,2116,223"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,299,940,325"/>
<area shape="rect" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4" title=" " alt="" coords="2000,480,2121,507"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,196,1919,223"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,29,1952,56"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,225,1673,252"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,159,1684,201"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,299,1679,325"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,72,719,99"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,43,1679,69"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,94,1668,135"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,145,1399,186"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,211,1403,237"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,261,1389,288"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,152,1144,179"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,152,939,179"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,93,1421,120"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,313,1408,354"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,262,1176,303"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,72,945,99"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,43,520,69"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,17,323,44"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,17,128,44"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,43,1412,69"/>
</map>
</div>

</div>
</div>
<a id="a35438091c40e77c617ce2ec9d521cc1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35438091c40e77c617ce2ec9d521cc1f">&#9670;&nbsp;</a></span>svm_msrpm_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u32 svm_msrpm_offset </td>
          <td>(</td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>msr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00264">264</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    u32 offset;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="svm_8c.html#ac84410b6049231218187535376fcbdba">NUM_MSR_MAPS</a>; i++) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span> (msr &lt; <a class="code" href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a>[i] ||</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            msr &gt;= <a class="code" href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a>[i] + <a class="code" href="svm_8c.html#a6c585eaa599f4c72e9f1f6fcc1ea0fb8">MSRS_IN_RANGE</a>)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        offset  = (msr - <a class="code" href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a>[i]) / 4; <span class="comment">/* 4 msrs per u8 */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        offset += (i * <a class="code" href="svm_8c.html#a0c8786ad06a6d122f851eee8d43424d9">MSRS_RANGE_SIZE</a>);       <span class="comment">/* add range offset */</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">/* Now we have the u8 offset - but need the u32 offset */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">return</span> offset / 4;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">/* MSR not in any range */</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a0c8786ad06a6d122f851eee8d43424d9"><div class="ttname"><a href="svm_8c.html#a0c8786ad06a6d122f851eee8d43424d9">MSRS_RANGE_SIZE</a></div><div class="ttdeci">#define MSRS_RANGE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00261">svm.c:261</a></div></div>
<div class="ttc" id="asvm_8c_html_a6c585eaa599f4c72e9f1f6fcc1ea0fb8"><div class="ttname"><a href="svm_8c.html#a6c585eaa599f4c72e9f1f6fcc1ea0fb8">MSRS_IN_RANGE</a></div><div class="ttdeci">#define MSRS_IN_RANGE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00262">svm.c:262</a></div></div>
<div class="ttc" id="asvm_8c_html_ac84410b6049231218187535376fcbdba"><div class="ttname"><a href="svm_8c.html#ac84410b6049231218187535376fcbdba">NUM_MSR_MAPS</a></div><div class="ttdeci">#define NUM_MSR_MAPS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00260">svm.c:260</a></div></div>
<div class="ttc" id="asvm_8c_html_aee88cc07545f234f7f296637887bb17c"><div class="ttname"><a href="svm_8c.html#aee88cc07545f234f7f296637887bb17c">msrpm_ranges</a></div><div class="ttdeci">static const u32 msrpm_ranges[]</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00258">svm.c:258</a></div></div>
<div class="ttc" id="asvm_8h_html_ae9836254c789e1e9f8d62939ff44ff36"><div class="ttname"><a href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a></div><div class="ttdeci">#define MSR_INVALID</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00535">svm.h:535</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a35438091c40e77c617ce2ec9d521cc1f_icgraph.png" border="0" usemap="#asvm_8h_a35438091c40e77c617ce2ec9d521cc1f_icgraph" alt=""/></div>
<map name="asvm_8h_a35438091c40e77c617ce2ec9d521cc1f_icgraph" id="asvm_8h_a35438091c40e77c617ce2ec9d521cc1f_icgraph">
<area shape="rect" title=" " alt="" coords="2319,319,2465,346"/>
<area shape="rect" href="svm_8c.html#a0a9af31dcd464498479ea7b57cdc106f" title=" " alt="" coords="2085,239,2232,266"/>
<area shape="rect" href="svm_8c.html#a9dbf1138872247b45ebbc4880523c0dd" title=" " alt="" coords="2075,290,2243,316"/>
<area shape="rect" href="svm_2nested_8c.html#a90464b57b273a88a7a1fb3c2cefb257a" title=" " alt="" coords="2047,424,2271,451"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="2079,341,2238,382"/>
<area shape="rect" href="svm_8c.html#aa4cdf4791105d54ebcadfeafdcdf01ac" title=" " alt="" coords="1827,239,1989,266"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="1850,290,1966,316"/>
<area shape="rect" href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba" title=" " alt="" coords="1825,568,1991,595"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="643,707,835,734"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="409,644,562,685"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="405,710,565,736"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="419,760,552,787"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="220,651,339,678"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="5,651,172,678"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="1829,391,1987,418"/>
<area shape="rect" href="svm_8c.html#ab4bda9cd8e4f3408d51dff1dd4403a11" title=" " alt="" coords="1817,340,1999,367"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="972,223,1059,250"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="1393,100,1543,141"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="1184,157,1336,198"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="1615,391,1754,418"/>
<area shape="rect" href="sev_8c.html#a8d230da93752633a5c5c7e6cf7c54343" title=" " alt="" coords="1600,165,1769,206"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="1617,644,1753,671"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1205,543,1315,570"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="1618,594,1751,620"/>
<area shape="rect" href="svm_8c.html#a195738d23c6f6b6bf7269334d3a38721" title=" " alt="" coords="1605,325,1764,366"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="1600,442,1769,468"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="675,271,803,298"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="1410,391,1526,418"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="1189,391,1331,418"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="895,391,1136,418"/>
<area shape="rect" href="sev_8c.html#a00c492279a529b66b80ed039ae6de23b" title=" " alt="" coords="1395,165,1541,206"/>
<area shape="rect" href="svm_8c.html#ad5aa214e23ea9ec9418bebbe889d41ef" title=" " alt="" coords="1401,594,1535,620"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="938,566,1093,592"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="905,492,1125,519"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="632,473,847,514"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="637,590,841,616"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="637,539,842,566"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="410,396,561,423"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="648,641,831,682"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="387,503,584,530"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="400,578,571,620"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="650,371,829,398"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="1392,332,1544,359"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="1384,282,1552,308"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="1200,223,1320,250"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="1185,274,1335,316"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="943,274,1087,316"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="944,442,1087,468"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="1388,492,1548,519"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="1205,492,1315,519"/>
</map>
</div>

</div>
</div>
<a id="a37477553ea45acae098350e7d572ae2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37477553ea45acae098350e7d572ae2e">&#9670;&nbsp;</a></span>svm_nmi_blocked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool svm_nmi_blocked </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l03735">3735</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;{</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160; </div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca">gif_set</a>(svm))</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160; </div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(vcpu) &amp;&amp; <a class="code" href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346">nested_exit_on_nmi</a>(svm))</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160; </div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3">svm_get_nmi_mask</a>(vcpu))</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160; </div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    <span class="keywordflow">return</span> vmcb-&gt;control.int_state &amp; SVM_INTERRUPT_SHADOW_MASK;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_ac87074e79786dc9fe0d4f587e5baf8b3"><div class="ttname"><a href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3">svm_get_nmi_mask</a></div><div class="ttdeci">static bool svm_get_nmi_mask(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03706">svm.c:3706</a></div></div>
<div class="ttc" id="asvm_8h_html_aefa7c9e670f5a86519f40b06f5277346"><div class="ttname"><a href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346">nested_exit_on_nmi</a></div><div class="ttdeci">static bool nested_exit_on_nmi(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00586">svm.h:586</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a37477553ea45acae098350e7d572ae2e_cgraph.png" border="0" usemap="#asvm_8h_a37477553ea45acae098350e7d572ae2e_cgraph" alt=""/></div>
<map name="asvm_8h_a37477553ea45acae098350e7d572ae2e_cgraph" id="asvm_8h_a37477553ea45acae098350e7d572ae2e_cgraph">
<area shape="rect" title=" " alt="" coords="5,165,144,191"/>
<area shape="rect" href="svm_8h.html#aea7fbac9a0652dc113c81593522e47ca" title=" " alt="" coords="235,63,302,90"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="804,114,924,141"/>
<area shape="rect" href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346" title=" " alt="" coords="192,165,345,191"/>
<area shape="rect" href="svm_8c.html#ac87074e79786dc9fe0d4f587e5baf8b3" title=" " alt="" coords="192,215,345,242"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="437,266,507,293"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="413,63,531,90"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="599,13,756,39"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="805,13,923,39"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1211,5,1384,47"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="972,38,1163,65"/>
<area shape="rect" href="svm_8h.html#a5deff43556f8c807c64def073cd548e4" title=" " alt="" coords="393,165,551,191"/>
<area shape="rect" href="svm_8h.html#a66eedd855edb50a1b78c2ac2c48a4d5d" title=" " alt="" coords="406,215,538,242"/>
<area shape="rect" href="svm_8h.html#a4b60c96a4d7eed837bb38ed5e03153c8" title=" " alt="" coords="605,190,750,217"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a37477553ea45acae098350e7d572ae2e_icgraph.png" border="0" usemap="#asvm_8h_a37477553ea45acae098350e7d572ae2e_icgraph" alt=""/></div>
<map name="asvm_8h_a37477553ea45acae098350e7d572ae2e_icgraph" id="asvm_8h_a37477553ea45acae098350e7d572ae2e_icgraph">
<area shape="rect" title=" " alt="" coords="251,31,389,57"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,5,203,32"/>
<area shape="rect" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695" title=" " alt="" coords="34,56,174,83"/>
</map>
</div>

</div>
</div>
<a id="a1a9474f1273be079ac4f3c1320093c3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a9474f1273be079ac4f3c1320093c3d">&#9670;&nbsp;</a></span>svm_set_cr0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_set_cr0 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>cr0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01852">1852</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;{</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    u64 hcr0 = cr0;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordtype">bool</span> old_paging = <a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160; </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="preprocessor">#ifdef CONFIG_X86_64</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer &amp; EFER_LME) {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; (cr0 &amp; X86_CR0_PG)) {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer |= EFER_LMA;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.guest_state_protected)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.efer |= EFER_LMA | EFER_LME;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; !(cr0 &amp; X86_CR0_PG)) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer &amp;= ~EFER_LMA;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.guest_state_protected)</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.efer &amp;= ~(EFER_LMA | EFER_LME);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    }</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.cr0 = cr0;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>) {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        hcr0 |= X86_CR0_PG | X86_CR0_WP;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        <span class="keywordflow">if</span> (old_paging != <a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            <a class="code" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109">svm_set_cr4</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, <a class="code" href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba">kvm_read_cr4</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>));</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    }</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="comment">     * re-enable caching here because the QEMU bios</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment">     * does not do it - this results in some delay at</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment">     * reboot</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf">kvm_check_has_quirk</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm, KVM_X86_QUIRK_CD_NW_CLEARED))</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        hcr0 &amp;= ~(X86_CR0_CD | X86_CR0_NW);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; </div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cr0 = hcr0;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment">     * SEV-ES guests must always keep the CR intercepts cleared. CR</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">     * tracking is done using the CR write traps.</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9">sev_es_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">if</span> (hcr0 == cr0) {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="comment">/* Selective CR0 write remains on.  */</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_CR0_READ);</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_CR0_WRITE);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR0_READ);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        <a class="code" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a>(svm, INTERCEPT_CR0_WRITE);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    }</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;}</div>
<div class="ttc" id="akvm__cache__regs_8h_html_ad479d598f0b5de90bd6062237ccb9eba"><div class="ttname"><a href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba">kvm_read_cr4</a></div><div class="ttdeci">static ulong kvm_read_cr4(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="kvm__cache__regs_8h_source.html#l00197">kvm_cache_regs.h:197</a></div></div>
<div class="ttc" id="asvm_8h_html_a4c285d86fd94954273295b317242c500"><div class="ttname"><a href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a></div><div class="ttdeci">static void svm_clr_intercept(struct vcpu_svm *svm, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00432">svm.h:432</a></div></div>
<div class="ttc" id="asvm_8h_html_af6e4bba26808541629dd240a782f1d05"><div class="ttname"><a href="svm_8h.html#af6e4bba26808541629dd240a782f1d05">svm_set_intercept</a></div><div class="ttdeci">static void svm_set_intercept(struct vcpu_svm *svm, int bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00423">svm.h:423</a></div></div>
<div class="ttc" id="ax86_8h_html_adf8330176a8805826ed4711a51ce93cf"><div class="ttname"><a href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf">kvm_check_has_quirk</a></div><div class="ttdeci">static bool kvm_check_has_quirk(struct kvm *kvm, u64 quirk)</div><div class="ttdef"><b>Definition:</b> <a href="x86_8h_source.html#l00288">x86.h:288</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a1a9474f1273be079ac4f3c1320093c3d_cgraph.png" border="0" usemap="#asvm_8h_a1a9474f1273be079ac4f3c1320093c3d_cgraph" alt=""/></div>
<map name="asvm_8h_a1a9474f1273be079ac4f3c1320093c3d_cgraph" id="asvm_8h_a1a9474f1273be079ac4f3c1320093c3d_cgraph">
<area shape="rect" title=" " alt="" coords="5,523,109,549"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="407,5,491,32"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="855,107,1022,133"/>
<area shape="rect" href="kvm__cache__regs_8h.html#ad479d598f0b5de90bd6062237ccb9eba" title=" " alt="" coords="171,111,286,137"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="173,755,284,781"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="159,624,298,651"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="622,573,758,600"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="177,396,281,423"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="903,579,974,605"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="157,679,300,705"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="617,5,763,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="1119,5,1264,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1335,31,1528,57"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="1119,56,1264,83"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="396,780,503,807"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="383,679,516,705"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="617,624,763,651"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="630,741,750,768"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="599,793,781,834"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="599,675,781,717"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="615,859,765,885"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="879,648,998,675"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="862,699,1015,725"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1345,641,1518,682"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1096,673,1287,700"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="348,295,551,321"/>
<area shape="rect" href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08" title=" " alt="" coords="367,371,532,397"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="611,275,769,317"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="851,259,1026,301"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="1123,237,1260,264"/>
<area shape="rect" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4" title=" " alt="" coords="1115,325,1267,352"/>
<area shape="rect" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826" title=" " alt="" coords="875,376,1003,403"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="870,427,1007,453"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="865,157,1012,184"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="860,477,1017,504"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1607,376,1713,403"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="1354,300,1509,327"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1999,325,2147,352"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1792,325,1951,352"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1576,325,1744,352"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1589,275,1731,301"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1814,275,1929,301"/>
<area shape="rect" href="reverse__cpuid_8h.html#a5c0c9322094b13d5fff76b5ab593339a" title=" " alt="" coords="1128,376,1255,403"/>
<area shape="rect" href="svm_8c.html#aba80ec8e0369ea53585b03f6b783e16d" title=" " alt="" coords="617,341,763,368"/>
<area shape="rect" href="svm__onhyperv_8h.html#a9786e3a21f906e6463bb5045e59088ec" title=" " alt="" coords="603,393,777,434"/>
<area shape="rect" href="hyperv_8h.html#a130eef63d3c6a1d540994ebbb371be24" title=" " alt="" coords="829,528,1048,555"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a1a9474f1273be079ac4f3c1320093c3d_icgraph.png" border="0" usemap="#asvm_8h_a1a9474f1273be079ac4f3c1320093c3d_icgraph" alt=""/></div>
<map name="asvm_8h_a1a9474f1273be079ac4f3c1320093c3d_icgraph" id="asvm_8h_a1a9474f1273be079ac4f3c1320093c3d_icgraph">
<area shape="rect" title=" " alt="" coords="1972,242,2076,269"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1813,192,1880,218"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1769,242,1924,269"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,429,1213,456"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,242,1710,269"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,171,1721,212"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,365,1716,392"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,94,719,121"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,112,1717,138"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,294,1705,335"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,298,1437,339"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,246,1440,273"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,196,1427,222"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,305,1163,332"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,305,939,332"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,145,1459,172"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,363,1445,404"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,363,1195,404"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,413,945,440"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,362,940,389"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,94,520,121"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,69,323,96"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,69,128,96"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,94,1449,121"/>
</map>
</div>

</div>
</div>
<a id="aec23ca96447aab4ff19f594a297bc109"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec23ca96447aab4ff19f594a297bc109">&#9670;&nbsp;</a></span>svm_set_cr4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_set_cr4 </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>cr4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01914">1914</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;{</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> host_cr4_mce = cr4_read_shadow() &amp; X86_CR4_MCE;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> old_cr4 = vcpu-&gt;arch.cr4;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a> &amp;&amp; ((old_cr4 ^ cr4) &amp; X86_CR4_PGE))</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <a class="code" href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08">svm_flush_tlb_current</a>(vcpu);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160; </div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    vcpu-&gt;arch.cr4 = cr4;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>) {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        cr4 |= X86_CR4_PAE;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878">is_paging</a>(vcpu))</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;            cr4 &amp;= ~(X86_CR4_SMEP | X86_CR4_SMAP | X86_CR4_PKE);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    cr4 |= host_cr4_mce;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.cr4 = cr4;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;vmcb, <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordflow">if</span> ((cr4 ^ old_cr4) &amp; (X86_CR4_OSXSAVE | X86_CR4_PKE))</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <a class="code" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea">kvm_update_cpuid_runtime</a>(vcpu);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;}</div>
<div class="ttc" id="acpuid_8c_html_a537512099e11c7ab0553aeae5e38d9ea"><div class="ttname"><a href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea">kvm_update_cpuid_runtime</a></div><div class="ttdeci">void kvm_update_cpuid_runtime(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="cpuid_8c_source.html#l00309">cpuid.c:309</a></div></div>
<div class="ttc" id="asvm_8c_html_ac9fb8e1d8461d85400d73c9438073a08"><div class="ttname"><a href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08">svm_flush_tlb_current</a></div><div class="ttdeci">static void svm_flush_tlb_current(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l03911">svm.c:3911</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aec23ca96447aab4ff19f594a297bc109_cgraph.png" border="0" usemap="#asvm_8h_aec23ca96447aab4ff19f594a297bc109_cgraph" alt=""/></div>
<map name="asvm_8h_aec23ca96447aab4ff19f594a297bc109_cgraph" id="asvm_8h_aec23ca96447aab4ff19f594a297bc109_cgraph">
<area shape="rect" title=" " alt="" coords="5,495,109,521"/>
<area shape="rect" href="x86_8h.html#a716c9d1b6fc76fd454097cf39d640878" title=" " alt="" coords="217,411,301,437"/>
<area shape="rect" href="cpuid_8c.html#a537512099e11c7ab0553aeae5e38d9ea" title=" " alt="" coords="157,280,360,307"/>
<area shape="rect" href="svm_8c.html#ac9fb8e1d8461d85400d73c9438073a08" title=" " alt="" coords="176,495,341,521"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="705,561,775,588"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="191,612,327,639"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a16b29ca8796e3da212a8faf1b2dc7ff3" title=" " alt="" coords="422,393,569,420"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a5fbb40e1f7661ccfd5accdaef3d8c378" title=" " alt="" coords="901,427,1046,453"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a6b9ea8c019490183db2a81569aad2bf9" title=" " alt="" coords="1097,401,1291,428"/>
<area shape="rect" href="cpuid_8c.html#aba2a2f99dbe3b8848b6ffc19effa6294" title=" " alt="" coords="416,209,575,250"/>
<area shape="rect" href="cpuid_8c.html#a57e37154fafc08d4400cac72d0a0b91d" title=" " alt="" coords="653,209,827,250"/>
<area shape="rect" href="cpuid_8c.html#a7220f0f9a6d0047aef7619e272fa9518" title=" " alt="" coords="905,187,1042,213"/>
<area shape="rect" href="reverse__cpuid_8h.html#a9ca8b41f0d18f3dac63b62e545077db4" title=" " alt="" coords="897,136,1049,163"/>
<area shape="rect" href="reverse__cpuid_8h.html#a748960fccca789bf432536205fdf9826" title=" " alt="" coords="676,275,804,301"/>
<area shape="rect" href="x86_8h.html#adf8330176a8805826ed4711a51ce93cf" title=" " alt="" coords="657,325,823,352"/>
<area shape="rect" href="x86_8h.html#ace4ed625ac4852e54db110fde28d3231" title=" " alt="" coords="671,5,809,32"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a2b779657b20f7afa44c0172b1478ac65" title=" " alt="" coords="667,376,813,403"/>
<area shape="rect" href="cpuid_8c.html#aad06d21707fd0abb109028612ea7514c" title=" " alt="" coords="661,56,819,83"/>
<area shape="rect" href="reverse__cpuid_8h.html#aeac4cdaa1c8b53f46ea791f355b1d08c" title=" " alt="" coords="1369,212,1476,239"/>
<area shape="rect" href="reverse__cpuid_8h.html#a08df87ae84991c96655f367379fad9b1" title=" " alt="" coords="1117,136,1271,163"/>
<area shape="rect" href="reverse__cpuid_8h.html#a76ac51b62ef170b755204cb8b958e585" title=" " alt="" coords="1761,161,1909,188"/>
<area shape="rect" href="reverse__cpuid_8h.html#ae10c1644e90cb8443e5a32554acfd700" title=" " alt="" coords="1555,161,1713,188"/>
<area shape="rect" href="reverse__cpuid_8h.html#adf3299d46978c685ba9b46ebb1536680" title=" " alt="" coords="1339,161,1507,188"/>
<area shape="rect" href="reverse__cpuid_8h.html#a3f7e53c68e5610be44d760fd4854f892" title=" " alt="" coords="1351,111,1494,137"/>
<area shape="rect" href="reverse__cpuid_8h.html#a8f6dc89865c6af98e621e1ddcf401cae" title=" " alt="" coords="1577,111,1691,137"/>
<area shape="rect" href="reverse__cpuid_8h.html#a5c0c9322094b13d5fff76b5ab593339a" title=" " alt="" coords="910,237,1037,264"/>
<area shape="rect" href="kvm__cache__regs_8h.html#a24ffc81fe5ed7998e29134351275b4dd" title=" " alt="" coords="901,376,1046,403"/>
<area shape="rect" href="svm_8c.html#aba80ec8e0369ea53585b03f6b783e16d" title=" " alt="" coords="422,511,569,537"/>
<area shape="rect" href="svm__onhyperv_8h.html#a9786e3a21f906e6463bb5045e59088ec" title=" " alt="" coords="408,445,583,486"/>
<area shape="rect" href="hyperv_8h.html#a130eef63d3c6a1d540994ebbb371be24" title=" " alt="" coords="631,511,849,537"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aec23ca96447aab4ff19f594a297bc109_icgraph.png" border="0" usemap="#asvm_8h_aec23ca96447aab4ff19f594a297bc109_icgraph" alt=""/></div>
<map name="asvm_8h_aec23ca96447aab4ff19f594a297bc109_icgraph" id="asvm_8h_aec23ca96447aab4ff19f594a297bc109_icgraph">
<area shape="rect" title=" " alt="" coords="2152,234,2256,261"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1809,165,1875,191"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,285,1919,311"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,222,1952,249"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="2000,259,2104,286"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,146,1673,173"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,441,1684,483"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,273,1679,299"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,226,719,253"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,390,1679,417"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,324,1668,365"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,55,1399,96"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,121,1403,147"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,171,1389,198"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,62,1144,89"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,62,939,89"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,445,1421,471"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,273,1408,315"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,273,1176,315"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,226,945,253"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,281,940,307"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,267,520,294"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,310,323,337"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,310,128,337"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,339,1412,366"/>
</map>
</div>

</div>
</div>
<a id="a5df90c8772700a60441f2ba19472f726"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5df90c8772700a60441f2ba19472f726">&#9670;&nbsp;</a></span>svm_set_efer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int svm_set_efer </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>efer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00296">296</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    u64 old_efer = <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer = efer;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#a17a219d0651f1db709a3af0fc5527aa0">npt_enabled</a>) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">/* Shadow paging assumes NX to be available.  */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        efer |= EFER_NX;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span> (!(efer &amp; EFER_LMA))</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            efer &amp;= ~EFER_LME;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">if</span> ((old_efer &amp; EFER_SVME) != (efer &amp; EFER_SVME)) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span> (!(efer &amp; EFER_SVME)) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <a class="code" href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11">svm_leave_nested</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539">svm_set_gif</a>(svm, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="comment">/* #GP intercept is still needed for vmware backdoor */</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="x86_8c.html#a2ce1016cd5cbf9583cfe1ec0e64e9118">enable_vmware_backdoor</a>)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <a class="code" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c">clr_exception_intercept</a>(svm, GP_VECTOR);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">             * Free the nested guest state, unless we are in SMM.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">             * In this case we will return to the nested guest</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">             * as soon as we leave SMM.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67">is_smm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <a class="code" href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e">svm_free_nested</a>(svm);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordtype">int</span> ret = <a class="code" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d">svm_allocate_nested</a>(svm);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">if</span> (ret) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;arch.efer = old_efer;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">             * Never intercept #GP for SEV guests, KVM can&#39;t</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">             * decrypt guest memory to workaround the erratum.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#a275c3d046aa0623ea238016c5002acbd">svm_gp_erratum_intercept</a> &amp;&amp; !<a class="code" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6">sev_guest</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>-&gt;kvm))</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <a class="code" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a>(svm, GP_VECTOR);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;save.efer = efer | EFER_SVME;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27">vmcb_mark_dirty</a>(svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>, <a class="code" href="svm_8h.html#a39fca1837c5ce7715cbf571669660c13a4c1bf85b59430883fd2a9f4eebbac975">VMCB_CR</a>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div>
<div class="ttc" id="asvm_2nested_8c_html_a690337312a648d2948b22540da6f031e"><div class="ttname"><a href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e">svm_free_nested</a></div><div class="ttdeci">void svm_free_nested(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01203">nested.c:1203</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_aaeebe6cee9f13a0540cbd9b696648a1d"><div class="ttname"><a href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d">svm_allocate_nested</a></div><div class="ttdeci">int svm_allocate_nested(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01177">nested.c:1177</a></div></div>
<div class="ttc" id="asvm_2nested_8c_html_afea614d490148481c96faf7c1b5ecb11"><div class="ttname"><a href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11">svm_leave_nested</a></div><div class="ttdeci">void svm_leave_nested(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_2nested_8c_source.html#l01229">nested.c:1229</a></div></div>
<div class="ttc" id="asvm_8c_html_a275c3d046aa0623ea238016c5002acbd"><div class="ttname"><a href="svm_8c.html#a275c3d046aa0623ea238016c5002acbd">svm_gp_erratum_intercept</a></div><div class="ttdeci">static bool svm_gp_erratum_intercept</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00241">svm.c:241</a></div></div>
<div class="ttc" id="asvm_8h_html_af04356b0b53ece1f631f1cfa12521642"><div class="ttname"><a href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642">set_exception_intercept</a></div><div class="ttdeci">static void set_exception_intercept(struct vcpu_svm *svm, u32 bit)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00403">svm.h:403</a></div></div>
<div class="ttc" id="ax86_8c_html_a2ce1016cd5cbf9583cfe1ec0e64e9118"><div class="ttname"><a href="x86_8c.html#a2ce1016cd5cbf9583cfe1ec0e64e9118">enable_vmware_backdoor</a></div><div class="ttdeci">bool __read_mostly enable_vmware_backdoor</div><div class="ttdef"><b>Definition:</b> <a href="x86_8c_source.html#l00176">x86.c:176</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a5df90c8772700a60441f2ba19472f726_cgraph.png" border="0" usemap="#asvm_8h_a5df90c8772700a60441f2ba19472f726_cgraph" alt=""/></div>
<map name="asvm_8h_a5df90c8772700a60441f2ba19472f726_cgraph" id="asvm_8h_a5df90c8772700a60441f2ba19472f726_cgraph">
<area shape="rect" title=" " alt="" coords="5,1124,116,1151"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="633,137,807,164"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="1125,239,1261,265"/>
<area shape="rect" href="smm_8h.html#aa0d6bb14bef67edc441fccd36d205a67" title=" " alt="" coords="207,1428,281,1455"/>
<area shape="rect" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642" title=" " alt="" coords="631,87,809,113"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="200,1479,288,1505"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="164,1276,324,1303"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="1157,1268,1228,1295"/>
<area shape="rect" href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e" title=" " alt="" coords="177,1175,311,1201"/>
<area shape="rect" href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11" title=" " alt="" coords="172,1048,316,1075"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="193,555,295,581"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="889,87,1022,113"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="1119,188,1266,215"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="1133,441,1253,468"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="1101,122,1284,163"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="1102,57,1283,98"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="1117,5,1268,32"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1349,201,1468,228"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1332,64,1485,91"/>
<area shape="rect" href="svm_8h.html#ac27f6fe2ff4beeb5ad1b11681d0386fd" title=" " alt="" coords="424,1479,531,1505"/>
<area shape="rect" href="svm_8c.html#aaf821ba71761474726fdfb616796a0c8" title=" " alt="" coords="388,1327,567,1353"/>
<area shape="rect" href="svm_8c.html#aaee43a83fe8c444128a4d22b2d5d5c21" title=" " alt="" coords="393,1276,562,1303"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="641,1276,799,1303"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="876,1290,1035,1331"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="857,1239,1053,1265"/>
<area shape="rect" href="svm_8c.html#a051d09f3fa8790388364ac3f69ed3e53" title=" " alt="" coords="406,1175,549,1201"/>
<area shape="rect" href="svm_8c.html#a67937d45023d92583b0bd363c73b6c2b" title=" " alt="" coords="390,1225,565,1252"/>
<area shape="rect" href="x86_8c.html#a21212b8e1a82cdc8ac696137981d8d7a" title=" " alt="" coords="397,1023,558,1049"/>
<area shape="rect" href="kvm__cache__regs_8h.html#aeca9aaff776c6158999d08d88e93e9a3" title=" " alt="" coords="405,1124,550,1151"/>
<area shape="rect" href="svm_2nested_8c.html#a10ef7b4561f5f7773d13cbd00fa7db53" title=" " alt="" coords="384,906,571,947"/>
<area shape="rect" href="svm_8h.html#a5980ebd310893869bc4c059f110a13cb" title=" " alt="" coords="398,972,557,999"/>
<area shape="rect" href="svm_8h.html#a711d42f525aa791008754514284a556c" title=" " alt="" coords="431,455,524,481"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="432,517,523,544"/>
<area shape="rect" href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd" title=" " alt="" coords="633,847,807,889"/>
<area shape="rect" href="irq_8c.html#a82ee83566d2724a298b67f23f481976b" title=" " alt="" coords="372,593,583,620"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="414,377,541,404"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="651,289,789,316"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="411,656,544,683"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="661,441,779,468"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="1114,315,1271,341"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="1133,720,1252,747"/>
<area shape="rect" href="lapic_8c.html#aa421165466ac455ff3fff91fb9afe7bf" title=" " alt="" coords="631,745,809,772"/>
<area shape="rect" href="irq_8c.html#a0ba50d6865653a9d307102d8f0b36630" title=" " alt="" coords="642,593,798,620"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="866,695,1045,721"/>
<area shape="rect" href="lapic_8c.html#a1bb0a1640f9f291f5c3154c6a2c40986" title=" " alt="" coords="884,863,1027,889"/>
<area shape="rect" href="lapic_8c.html#ac1c99098894f4751a556057800e906e0" title=" " alt="" coords="884,797,1027,838"/>
<area shape="rect" href="lapic_8h.html#ae7e74fde3e4fb01f561634e789b5eab4" title=" " alt="" coords="885,745,1026,772"/>
<area shape="rect" href="irq_8h.html#a68413268c1f1f354270e9a0de9c2fe44" title=" " alt="" coords="905,593,1006,620"/>
<area shape="rect" href="lapic_8c.html#a1f4df169625f9c4c2cb06f7443698af4" title=" " alt="" coords="860,543,1051,569"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="649,796,791,823"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a5df90c8772700a60441f2ba19472f726_icgraph.png" border="0" usemap="#asvm_8h_a5df90c8772700a60441f2ba19472f726_icgraph" alt=""/></div>
<map name="asvm_8h_a5df90c8772700a60441f2ba19472f726_icgraph" id="asvm_8h_a5df90c8772700a60441f2ba19472f726_icgraph">
<area shape="rect" title=" " alt="" coords="2000,332,2111,359"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,241,1919,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,357,1952,384"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,241,1673,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,170,1684,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,364,1679,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,111,1679,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,293,1668,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,297,1399,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,245,1403,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,195,1389,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,304,1144,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,144,1421,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,362,1408,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,362,1176,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,93,1412,120"/>
</map>
</div>

</div>
</div>
<a id="a5c26f1ceaa6cc778d986bd33629dc539"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c26f1ceaa6cc778d986bd33629dc539">&#9670;&nbsp;</a></span>svm_set_gif()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_set_gif </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l02406">2406</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;{</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="keywordflow">if</span> (value) {</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">         * If VGIF is enabled, the STGI intercept is only added to</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">         * detect the opening of the SMI/NMI window; remove it now.</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">         * Likewise, clear the VINTR intercept, we will set it</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment">         * again while processing KVM_REQ_EVENT if needed.</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>)</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            <a class="code" href="svm_8h.html#a4c285d86fd94954273295b317242c500">svm_clr_intercept</a>(svm, INTERCEPT_STGI);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d">svm_is_intercept</a>(svm, INTERCEPT_VINTR))</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;            <a class="code" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403">svm_clear_vintr</a>(svm);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        <a class="code" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64">enable_gif</a>(svm);</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        <span class="keywordflow">if</span> (svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.smi_pending ||</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>.arch.nmi_pending ||</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;            <a class="code" href="irq_8c.html#a82ee83566d2724a298b67f23f481976b">kvm_cpu_has_injectable_intr</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) ||</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            <a class="code" href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd">kvm_apic_has_pending_init_or_sipi</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>))</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            kvm_make_request(KVM_REQ_EVENT, &amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <a class="code" href="svm_8h.html#a711d42f525aa791008754514284a556c">disable_gif</a>(svm);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; </div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">         * After a CLGI no interrupts should come.  But if vGIF is</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">         * in use, we still rely on the VINTR intercept (rather than</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">         * STGI) to detect an open interrupt window.</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a>)</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;            <a class="code" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403">svm_clear_vintr</a>(svm);</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    }</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;}</div>
<div class="ttc" id="airq_8c_html_a82ee83566d2724a298b67f23f481976b"><div class="ttname"><a href="irq_8c.html#a82ee83566d2724a298b67f23f481976b">kvm_cpu_has_injectable_intr</a></div><div class="ttdeci">int kvm_cpu_has_injectable_intr(struct kvm_vcpu *v)</div><div class="ttdef"><b>Definition:</b> <a href="irq_8c_source.html#l00082">irq.c:82</a></div></div>
<div class="ttc" id="alapic_8h_html_a106127db5f69d94e5ea9d6d2982c23fd"><div class="ttname"><a href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd">kvm_apic_has_pending_init_or_sipi</a></div><div class="ttdeci">static bool kvm_apic_has_pending_init_or_sipi(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="lapic_8h_source.html#l00231">lapic.h:231</a></div></div>
<div class="ttc" id="asvm_8c_html_ab0a8ab91829811c7705c6455fb294bbc"><div class="ttname"><a href="svm_8c.html#ab0a8ab91829811c7705c6455fb294bbc">vgif</a></div><div class="ttdeci">int vgif</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00214">svm.c:214</a></div></div>
<div class="ttc" id="asvm_8c_html_aea540cc79e685f3a2eebfa4226b63403"><div class="ttname"><a href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403">svm_clear_vintr</a></div><div class="ttdeci">static void svm_clear_vintr(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01663">svm.c:1663</a></div></div>
<div class="ttc" id="asvm_8h_html_a711d42f525aa791008754514284a556c"><div class="ttname"><a href="svm_8h.html#a711d42f525aa791008754514284a556c">disable_gif</a></div><div class="ttdeci">static void disable_gif(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00473">svm.h:473</a></div></div>
<div class="ttc" id="asvm_8h_html_ad0ea8a68927599c2120f37f4f48b0a64"><div class="ttname"><a href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64">enable_gif</a></div><div class="ttdeci">static void enable_gif(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00463">svm.h:463</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a5c26f1ceaa6cc778d986bd33629dc539_cgraph.png" border="0" usemap="#asvm_8h_a5c26f1ceaa6cc778d986bd33629dc539_cgraph" alt=""/></div>
<map name="asvm_8h_a5c26f1ceaa6cc778d986bd33629dc539_cgraph" id="asvm_8h_a5c26f1ceaa6cc778d986bd33629dc539_cgraph">
<area shape="rect" title=" " alt="" coords="5,616,107,643"/>
<area shape="rect" href="svm_8h.html#a711d42f525aa791008754514284a556c" title=" " alt="" coords="213,616,307,643"/>
<area shape="rect" href="svm_8h.html#ad0ea8a68927599c2120f37f4f48b0a64" title=" " alt="" coords="215,565,305,592"/>
<area shape="rect" href="lapic_8h.html#a106127db5f69d94e5ea9d6d2982c23fd" title=" " alt="" coords="173,111,347,153"/>
<area shape="rect" href="irq_8c.html#a82ee83566d2724a298b67f23f481976b" title=" " alt="" coords="155,355,365,381"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="197,667,323,693"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="433,717,572,744"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="193,768,327,795"/>
<area shape="rect" href="svm_8h.html#a69e061ab353251d82ff01f587be58c96" title=" " alt="" coords="443,565,562,592"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="911,565,1031,592"/>
<area shape="rect" href="svm_8h.html#ad6d8c993934e650cf5366b9883c3628e" title=" " alt="" coords="657,515,815,541"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="1131,569,1249,596"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1556,562,1729,603"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="1317,595,1508,621"/>
<area shape="rect" href="lapic_8h.html#a1d8c9378fcbf62390a89dc3b7f0bdbd4" title=" " alt="" coords="912,17,1031,44"/>
<area shape="rect" href="lapic_8c.html#aa421165466ac455ff3fff91fb9afe7bf" title=" " alt="" coords="413,355,592,381"/>
<area shape="rect" href="irq_8c.html#a0ba50d6865653a9d307102d8f0b36630" title=" " alt="" coords="425,169,581,196"/>
<area shape="rect" href="lapic_8h.html#a3af346d02eebff16886d49d3810b5358" title=" " alt="" coords="413,68,592,95"/>
<area shape="rect" href="lapic_8c.html#a1bb0a1640f9f291f5c3154c6a2c40986" title=" " alt="" coords="665,413,807,440"/>
<area shape="rect" href="lapic_8c.html#ac1c99098894f4751a556057800e906e0" title=" " alt="" coords="665,347,807,389"/>
<area shape="rect" href="lapic_8h.html#ae7e74fde3e4fb01f561634e789b5eab4" title=" " alt="" coords="665,245,807,272"/>
<area shape="rect" href="lapic_8c.html#a80d977ac48cfa76440f2961e38b23fd0" title=" " alt="" coords="1111,405,1269,432"/>
<area shape="rect" href="lapic_8h.html#a8cd1df8b4c079c23a522d09c964da0ee" title=" " alt="" coords="899,301,1044,328"/>
<area shape="rect" href="lapic_8c.html#ab2ee275fa1bc17aa0bfde435723b8f48" title=" " alt="" coords="899,456,1043,483"/>
<area shape="rect" href="lapic_8c.html#a656567b4197d9a5af833ffd04dff7a52" title=" " alt="" coords="1338,380,1487,407"/>
<area shape="rect" href="lapic_8h.html#aa28a43e0f54449e2ec4d25e1f8ecb178" title=" " alt="" coords="1111,301,1269,328"/>
<area shape="rect" href="lapic_8c.html#a5de365e734b929b65e2d75f62cea6f7e" title=" " alt="" coords="1111,456,1269,483"/>
<area shape="rect" href="lapic_8c.html#aebc526fc8720e4db45143f8e05f85c79" title=" " alt="" coords="893,355,1049,381"/>
<area shape="rect" href="lapic_8c.html#a734e8a2b56a9a0b0d9117f20f2bb0fc1" title=" " alt="" coords="1130,355,1250,381"/>
<area shape="rect" href="lapic_8h.html#a1d8660ecbda996b11b10b179013e52d4" title=" " alt="" coords="886,247,1057,273"/>
<area shape="rect" href="irq_8h.html#a68413268c1f1f354270e9a0de9c2fe44" title=" " alt="" coords="685,195,787,221"/>
<area shape="rect" href="lapic_8c.html#a1f4df169625f9c4c2cb06f7443698af4" title=" " alt="" coords="641,296,831,323"/>
<area shape="rect" href="xen_8h.html#a54d6c533ab0ee711fc2dbf6a420fc66d" title=" " alt="" coords="649,93,823,120"/>
<area shape="rect" href="irq_8c.html#ac5a27e69dfd0e834cf2a86ee875ecf72" title=" " alt="" coords="640,144,832,171"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="903,616,1039,643"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="669,717,803,744"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="898,851,1045,877"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="880,785,1063,826"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="881,667,1062,709"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="896,733,1047,760"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="1113,675,1267,701"/>
<area shape="rect" href="svm_8h.html#a6eb37bb9efc32f45f75055de8ba4fc79" title=" " alt="" coords="432,768,573,795"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a5c26f1ceaa6cc778d986bd33629dc539_icgraph.png" border="0" usemap="#asvm_8h_a5c26f1ceaa6cc778d986bd33629dc539_icgraph" alt=""/></div>
<map name="asvm_8h_a5c26f1ceaa6cc778d986bd33629dc539_icgraph" id="asvm_8h_a5c26f1ceaa6cc778d986bd33629dc539_icgraph">
<area shape="rect" title=" " alt="" coords="2179,256,2280,283"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="2000,5,2131,32"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,107,945,133"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,281,1919,308"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,597,940,624"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="2000,652,2131,679"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2010,231,2121,257"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,157,719,184"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,197,520,224"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,237,323,264"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,237,128,264"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,463,1673,489"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,274,1684,315"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,391,1679,417"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,340,1679,367"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,209,1668,250"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,535,1399,577"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,484,1403,511"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,433,1389,460"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,543,1144,569"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,543,939,569"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,215,1421,241"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,367,1408,409"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,367,1176,409"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,265,1412,292"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,169,1952,196"/>
</map>
</div>

</div>
</div>
<a id="af6e4bba26808541629dd240a782f1d05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6e4bba26808541629dd240a782f1d05">&#9670;&nbsp;</a></span>svm_set_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void svm_set_intercept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00423">423</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;{</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keyword">struct </span>vmcb *vmcb = svm-&gt;<a class="code" href="structvcpu__svm.html#af0c24755d59a0cfca7ce9ba64f682722">vmcb01</a>.<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789">vmcb_set_intercept</a>(&amp;vmcb-&gt;control, bit);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14">recalc_intercepts</a>(svm);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_af6e4bba26808541629dd240a782f1d05_cgraph.png" border="0" usemap="#asvm_8h_af6e4bba26808541629dd240a782f1d05_cgraph" alt=""/></div>
<map name="asvm_8h_af6e4bba26808541629dd240a782f1d05_cgraph" id="asvm_8h_af6e4bba26808541629dd240a782f1d05_cgraph">
<area shape="rect" title=" " alt="" coords="5,239,148,265"/>
<area shape="rect" href="svm_8h.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="196,188,329,215"/>
<area shape="rect" href="svm_8h.html#afdbe781b81d2ae90e81d9bb9e9750789" title=" " alt="" coords="393,289,544,316"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="409,5,529,32"/>
<area shape="rect" href="svm_2hyperv_8h.html#a95be98cf04ff1e53cefb6771c7450643" title=" " alt="" coords="377,57,560,98"/>
<area shape="rect" href="svm_2nested_8c.html#a225c391860ae9f13ee16f0292bef1b05" title=" " alt="" coords="378,122,559,163"/>
<area shape="rect" href="svm_8h.html#a83e4cd1b591935133506abf6724051c4" title=" " alt="" coords="395,188,542,215"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="401,239,537,265"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="625,104,744,131"/>
<area shape="rect" href="svm_8h.html#a96264b6618fa3987f55ba2054a1f12bc" title=" " alt="" coords="608,155,761,181"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="1048,97,1221,138"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="809,129,1000,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_af6e4bba26808541629dd240a782f1d05_icgraph.png" border="0" usemap="#asvm_8h_af6e4bba26808541629dd240a782f1d05_icgraph" alt=""/></div>
<map name="asvm_8h_af6e4bba26808541629dd240a782f1d05_icgraph" id="asvm_8h_af6e4bba26808541629dd240a782f1d05_icgraph">
<area shape="rect" title=" " alt="" coords="2287,293,2429,320"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1615,5,1701,32"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="2066,50,2217,91"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="2072,293,2211,320"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="2046,243,2237,269"/>
<area shape="rect" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1" title=" " alt="" coords="2055,115,2227,157"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="2089,383,2193,409"/>
<area shape="rect" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066" title=" " alt="" coords="2056,479,2227,505"/>
<area shape="rect" href="svm_8c.html#a27df28527cda6f7917355af86817d940" title=" " alt="" coords="2084,529,2199,556"/>
<area shape="rect" href="svm_8c.html#aa30e5cb5ad1759988fc349bd703bd4dc" title=" " alt="" coords="2044,580,2239,607"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="1318,5,1446,32"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="1829,57,1981,98"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="1847,232,1963,259"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="1587,56,1729,83"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="1261,56,1503,83"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1871,401,1938,428"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1827,351,1982,377"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,391,1213,417"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1562,233,1754,260"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1551,477,1765,518"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1556,309,1760,336"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,387,719,413"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1555,360,1761,387"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1567,411,1749,453"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1305,259,1459,301"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1302,157,1462,184"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1315,208,1449,235"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,267,1163,293"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,267,939,293"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1283,492,1481,519"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1297,325,1467,366"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,325,1195,366"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,387,945,413"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,332,940,359"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,389,520,416"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,416,323,443"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,416,128,443"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1293,391,1471,417"/>
<area shape="rect" href="svm_8c.html#a67bccbcbb6b439b80103663fe58cd626" title=" " alt="" coords="1842,543,1967,569"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="1829,593,1981,620"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="1813,644,1996,671"/>
</map>
</div>

</div>
</div>
<a id="addc2bf7bff76340928f122fbde134c2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc2bf7bff76340928f122fbde134c2a">&#9670;&nbsp;</a></span>svm_set_x2apic_msr_interception()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_set_x2apic_msr_interception </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>disable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00892">892</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;{</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span> (intercept == svm-&gt;<a class="code" href="structvcpu__svm.html#afbff2f35453153777bd80da134d164e0">x2avic_msrs_intercepted</a>)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="avic_8c.html#ad4c0ba70ab315cedbb11f259b1d7ae08">x2avic_enabled</a>)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">MAX_DIRECT_ACCESS_MSRS</a>; i++) {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordtype">int</span> index = <a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].<a class="code" href="structsvm__direct__access__msrs.html#a392caedc2f625128ed478904dafbe718">index</a>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="keywordflow">if</span> ((index &lt; APIC_BASE_MSR) ||</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            (index &gt; APIC_BASE_MSR + 0xff))</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(&amp;svm-&gt;<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, svm-&gt;<a class="code" href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">msrpm</a>, index,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                     !intercept, !intercept);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#afbff2f35453153777bd80da134d164e0">x2avic_msrs_intercepted</a> = intercept;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;}</div>
<div class="ttc" id="astructsvm__direct__access__msrs_html_a392caedc2f625128ed478904dafbe718"><div class="ttname"><a href="structsvm__direct__access__msrs.html#a392caedc2f625128ed478904dafbe718">svm_direct_access_msrs::index</a></div><div class="ttdeci">u32 index</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00084">svm.c:84</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_a3a2ad123b38c5ee6f81b8a6db56ac5b9"><div class="ttname"><a href="structvcpu__svm.html#a3a2ad123b38c5ee6f81b8a6db56ac5b9">vcpu_svm::msrpm</a></div><div class="ttdeci">u32 * msrpm</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00234">svm.h:234</a></div></div>
<div class="ttc" id="astructvcpu__svm_html_afbff2f35453153777bd80da134d164e0"><div class="ttname"><a href="structvcpu__svm.html#afbff2f35453153777bd80da134d164e0">vcpu_svm::x2avic_msrs_intercepted</a></div><div class="ttdeci">bool x2avic_msrs_intercepted</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00291">svm.h:291</a></div></div>
<div class="ttc" id="asvm_8c_html_ad73a1ea1e074171f7049d11e84aa1814"><div class="ttname"><a href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a></div><div class="ttdeci">static const struct svm_direct_access_msrs direct_access_msrs[MAX_DIRECT_ACCESS_MSRS]</div></div>
<div class="ttc" id="asvm_8c_html_ae7cebb5bd1d0e7eadb2b7df90cca0c74"><div class="ttname"><a href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a></div><div class="ttdeci">void set_msr_interception(struct kvm_vcpu *vcpu, u32 *msrpm, u32 msr, int read, int write)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00859">svm.c:859</a></div></div>
<div class="ttc" id="asvm_8h_html_a5da6b86ca5c95c3562c7d03dcbefe138"><div class="ttname"><a href="svm_8h.html#a5da6b86ca5c95c3562c7d03dcbefe138">MAX_DIRECT_ACCESS_MSRS</a></div><div class="ttdeci">#define MAX_DIRECT_ACCESS_MSRS</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00033">svm.h:33</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_addc2bf7bff76340928f122fbde134c2a_cgraph.png" border="0" usemap="#asvm_8h_addc2bf7bff76340928f122fbde134c2a_cgraph" alt=""/></div>
<map name="asvm_8h_addc2bf7bff76340928f122fbde134c2a_cgraph" id="asvm_8h_addc2bf7bff76340928f122fbde134c2a_cgraph">
<area shape="rect" title=" " alt="" coords="5,187,164,229"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="212,195,371,221"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="437,137,596,178"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="419,224,615,251"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="694,5,835,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="663,57,867,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="691,123,838,149"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="729,224,800,251"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="689,173,840,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="915,224,1088,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_addc2bf7bff76340928f122fbde134c2a_icgraph.png" border="0" usemap="#asvm_8h_addc2bf7bff76340928f122fbde134c2a_icgraph" alt=""/></div>
<map name="asvm_8h_addc2bf7bff76340928f122fbde134c2a_icgraph" id="asvm_8h_addc2bf7bff76340928f122fbde134c2a_icgraph">
<area shape="rect" title=" " alt="" coords="788,27,947,69"/>
<area shape="rect" href="avic_8c.html#a2af29a6a396bb757ac21f02f6aacfdfa" title=" " alt="" coords="580,9,732,36"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="572,60,740,87"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="389,5,509,32"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="373,57,524,98"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="210,5,297,32"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="5,5,133,32"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="181,57,325,98"/>
</map>
</div>

</div>
</div>
<a id="a88b3351baf8190bdefb4b8a113159deb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b3351baf8190bdefb4b8a113159deb">&#9670;&nbsp;</a></span>svm_smi_blocked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool svm_smi_blocked </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a88b3351baf8190bdefb4b8a113159deb_icgraph.png" border="0" usemap="#asvm_8h_a88b3351baf8190bdefb4b8a113159deb_icgraph" alt=""/></div>
<map name="asvm_8h_a88b3351baf8190bdefb4b8a113159deb_icgraph" id="asvm_8h_a88b3351baf8190bdefb4b8a113159deb_icgraph">
<area shape="rect" title=" " alt="" coords="251,5,389,32"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="5,5,203,32"/>
</map>
</div>

</div>
</div>
<a id="a051d09f3fa8790388364ac3f69ed3e53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a051d09f3fa8790388364ac3f69ed3e53">&#9670;&nbsp;</a></span>svm_switch_vmcb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_switch_vmcb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a> *&#160;</td>
          <td class="paramname"><em>svm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkvm__vmcb__info.html">kvm_vmcb_info</a> *&#160;</td>
          <td class="paramname"><em>target_vmcb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01407">1407</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;{</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">current_vmcb</a> = target_vmcb;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a> = target_vmcb-&gt;<a class="code" href="structkvm__vmcb__info.html#a8076921f239564576af7af19be7f6f04">ptr</a>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;}</div>
<div class="ttc" id="astructvcpu__svm_html_a255650cdd9fc03e4da05d1f0f154452a"><div class="ttname"><a href="structvcpu__svm.html#a255650cdd9fc03e4da05d1f0f154452a">vcpu_svm::current_vmcb</a></div><div class="ttdeci">struct kvm_vmcb_info * current_vmcb</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00214">svm.h:214</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a051d09f3fa8790388364ac3f69ed3e53_icgraph.png" border="0" usemap="#asvm_8h_a051d09f3fa8790388364ac3f69ed3e53_icgraph" alt=""/></div>
<map name="asvm_8h_a051d09f3fa8790388364ac3f69ed3e53_icgraph" id="asvm_8h_a051d09f3fa8790388364ac3f69ed3e53_icgraph">
<area shape="rect" title=" " alt="" coords="2361,235,2504,261"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,529,945,556"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,260,1919,287"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,43,940,69"/>
<area shape="rect" href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e" title=" " alt="" coords="2174,260,2309,287"/>
<area shape="rect" href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11" title=" " alt="" coords="2169,209,2313,236"/>
<area shape="rect" href="svm_8c.html#a2af2f754ca7838a0253d54c33aae7d1e" title=" " alt="" coords="2173,631,2309,657"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,479,719,505"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,453,520,480"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,428,323,455"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,428,128,455"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,203,1673,229"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,311,1684,353"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,260,1679,287"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,377,1679,404"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,137,1668,178"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,195,1399,237"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,144,1403,171"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,93,1389,120"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,203,1144,229"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,203,939,229"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,327,1421,353"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,261,1408,302"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,261,1176,302"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,428,1412,455"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2005,260,2116,287"/>
<area shape="rect" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4" title=" " alt="" coords="2000,209,2121,236"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,420,1952,447"/>
</map>
</div>

</div>
</div>
<a id="ad5aa214e23ea9ec9418bebbe889d41ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5aa214e23ea9ec9418bebbe889d41ef">&#9670;&nbsp;</a></span>svm_update_lbrv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_update_lbrv </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01037">1037</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;{</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keyword">struct </span><a class="code" href="structvcpu__svm.html">vcpu_svm</a> *svm = <a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordtype">bool</span> current_enable_lbrv = svm-&gt;<a class="code" href="structvcpu__svm.html#af095ed7bcc31c036e28e533582723a60">vmcb</a>-&gt;control.virt_ext &amp; LBR_CTL_ENABLE_MASK;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordtype">bool</span> enable_lbrv = (<a class="code" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a>(svm)-&gt;save.dbgctl &amp; DEBUGCTLMSR_LBR) ||</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                (<a class="code" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc">is_guest_mode</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>) &amp;&amp; <a class="code" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390">guest_can_use</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>, X86_FEATURE_LBRV) &amp;&amp;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                (svm-&gt;<a class="code" href="structvcpu__svm.html#aa2e4d643ef957cd597e82a29f0f0a2c8">nested</a>.<a class="code" href="structsvm__nested__state.html#a3b275e369200f402f9d5765babb77629">ctl</a>.<a class="code" href="structvmcb__ctrl__area__cached.html#a7c13a2a3665942eb4cc17fc335c4185f">virt_ext</a> &amp; LBR_CTL_ENABLE_MASK));</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span> (enable_lbrv == current_enable_lbrv)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">if</span> (enable_lbrv)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <a class="code" href="svm_8c.html#af2c512591b577cf59656808ac082a47a">svm_enable_lbrv</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <a class="code" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4">svm_disable_lbrv</a>(<a class="code" href="structvcpu__svm.html#af164d8d741d9ea90dae6a46974d29f9e">vcpu</a>);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a9ba5c45bbaca2c94f46c1a9ba653fcd8"><div class="ttname"><a href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8">svm_get_lbr_vmcb</a></div><div class="ttdeci">static struct vmcb * svm_get_lbr_vmcb(struct vcpu_svm *svm)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01026">svm.c:1026</a></div></div>
<div class="ttc" id="asvm_8c_html_aaa7d57cd8b29b959a08ccd6dc53196c4"><div class="ttname"><a href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4">svm_disable_lbrv</a></div><div class="ttdeci">static void svm_disable_lbrv(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l01008">svm.c:1008</a></div></div>
<div class="ttc" id="asvm_8c_html_af2c512591b577cf59656808ac082a47a"><div class="ttname"><a href="svm_8c.html#af2c512591b577cf59656808ac082a47a">svm_enable_lbrv</a></div><div class="ttdeci">static void svm_enable_lbrv(struct kvm_vcpu *vcpu)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00993">svm.c:993</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad5aa214e23ea9ec9418bebbe889d41ef_cgraph.png" border="0" usemap="#asvm_8h_ad5aa214e23ea9ec9418bebbe889d41ef_cgraph" alt=""/></div>
<map name="asvm_8h_ad5aa214e23ea9ec9418bebbe889d41ef_cgraph" id="asvm_8h_ad5aa214e23ea9ec9418bebbe889d41ef_cgraph">
<area shape="rect" title=" " alt="" coords="5,273,140,300"/>
<area shape="rect" href="cpuid_8h.html#acf67f5848a2ddd59dc852e37bc330390" title=" " alt="" coords="201,108,320,135"/>
<area shape="rect" href="kvm__cache__regs_8h.html#afbcfc413ceedb460734eb5fd7c5c4fbc" title=" " alt="" coords="417,159,537,185"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="193,248,329,275"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="931,275,1001,301"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="194,299,327,325"/>
<area shape="rect" href="svm_8c.html#a9ba5c45bbaca2c94f46c1a9ba653fcd8" title=" " alt="" coords="188,412,333,439"/>
<area shape="rect" href="cpuid_8h.html#a786eea4c1fa59be0155455a72125e0ff" title=" " alt="" coords="631,58,805,99"/>
<area shape="rect" href="cpuid_8h.html#a72da5444b01d72d935ebc411b99ba166" title=" " alt="" coords="381,108,572,135"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="397,209,556,236"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="417,311,536,337"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="639,130,797,171"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="620,209,816,236"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="895,5,1037,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="864,57,1068,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="893,123,1039,149"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="891,173,1041,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="1116,199,1289,225"/>
<area shape="rect" href="svm_8h.html#ab83edec724698a20d66a086a1900aa27" title=" " alt="" coords="650,311,786,337"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad5aa214e23ea9ec9418bebbe889d41ef_icgraph.png" border="0" usemap="#asvm_8h_ad5aa214e23ea9ec9418bebbe889d41ef_icgraph" alt=""/></div>
<map name="asvm_8h_ad5aa214e23ea9ec9418bebbe889d41ef_icgraph" id="asvm_8h_ad5aa214e23ea9ec9418bebbe889d41ef_icgraph">
<area shape="rect" title=" " alt="" coords="1972,428,2107,455"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1769,241,1924,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,428,1213,455"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1792,479,1901,505"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1518,241,1710,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1507,170,1721,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1512,364,1716,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1511,111,1717,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1523,293,1705,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1283,297,1437,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1280,245,1440,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1293,195,1427,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1044,304,1163,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1261,144,1459,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1275,362,1445,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1012,362,1195,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1271,93,1449,120"/>
</map>
</div>

</div>
</div>
<a id="aaf821ba71761474726fdfb616796a0c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf821ba71761474726fdfb616796a0c8">&#9670;&nbsp;</a></span>svm_vcpu_alloc_msrpm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u32* svm_vcpu_alloc_msrpm </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00866">866</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;{</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> order = get_order(<a class="code" href="svm_8h.html#a106125dd7b1447fe5e6cb6f08240137b">MSRPM_SIZE</a>);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keyword">struct </span>page *pages = alloc_pages(GFP_KERNEL_ACCOUNT, order);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    u32 *msrpm;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">if</span> (!pages)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    msrpm = page_address(pages);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    memset(msrpm, 0xff, PAGE_SIZE * (1 &lt;&lt; order));</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">return</span> msrpm;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a106125dd7b1447fe5e6cb6f08240137b"><div class="ttname"><a href="svm_8h.html#a106125dd7b1447fe5e6cb6f08240137b">MSRPM_SIZE</a></div><div class="ttdeci">#define MSRPM_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00031">svm.h:31</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aaf821ba71761474726fdfb616796a0c8_icgraph.png" border="0" usemap="#asvm_8h_aaf821ba71761474726fdfb616796a0c8_icgraph" alt=""/></div>
<map name="asvm_8h_aaf821ba71761474726fdfb616796a0c8_icgraph" id="asvm_8h_aaf821ba71761474726fdfb616796a0c8_icgraph">
<area shape="rect" title=" " alt="" coords="2367,357,2545,384"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="2159,332,2319,359"/>
<area shape="rect" href="svm_8c.html#a2af2f754ca7838a0253d54c33aae7d1e" title=" " alt="" coords="2171,383,2307,409"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2000,332,2111,359"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,241,1919,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,357,1952,384"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,241,1673,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,170,1684,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,364,1679,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,111,1679,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,293,1668,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,297,1399,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,245,1403,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,195,1389,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,304,1144,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,144,1421,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,362,1408,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,362,1176,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,93,1412,120"/>
</map>
</div>

</div>
</div>
<a id="a67937d45023d92583b0bd363c73b6c2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67937d45023d92583b0bd363c73b6c2b">&#9670;&nbsp;</a></span>svm_vcpu_free_msrpm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_vcpu_free_msrpm </td>
          <td>(</td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>msrpm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00915">915</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;{</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    __free_pages(virt_to_page(msrpm), get_order(<a class="code" href="svm_8h.html#a106125dd7b1447fe5e6cb6f08240137b">MSRPM_SIZE</a>));</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a67937d45023d92583b0bd363c73b6c2b_icgraph.png" border="0" usemap="#asvm_8h_a67937d45023d92583b0bd363c73b6c2b_icgraph" alt=""/></div>
<map name="asvm_8h_a67937d45023d92583b0bd363c73b6c2b_icgraph" id="asvm_8h_a67937d45023d92583b0bd363c73b6c2b_icgraph">
<area shape="rect" title=" " alt="" coords="2352,324,2527,351"/>
<area shape="rect" href="svm_2nested_8c.html#a690337312a648d2948b22540da6f031e" title=" " alt="" coords="2169,324,2304,351"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2005,299,2116,325"/>
<area shape="rect" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4" title=" " alt="" coords="2000,349,2121,376"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,241,1919,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,357,1952,384"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,241,1673,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,170,1684,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,364,1679,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,111,1679,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,293,1668,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,297,1399,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,245,1403,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,195,1389,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,304,1144,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,144,1421,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,362,1408,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,362,1176,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,93,1412,120"/>
</map>
</div>

</div>
</div>
<a id="aaee43a83fe8c444128a4d22b2d5d5c21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee43a83fe8c444128a4d22b2d5d5c21">&#9670;&nbsp;</a></span>svm_vcpu_init_msrpm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_vcpu_init_msrpm </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32 *&#160;</td>
          <td class="paramname"><em>msrpm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00881">881</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;{</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">for</span> (i = 0; <a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].<a class="code" href="structsvm__direct__access__msrs.html#a392caedc2f625128ed478904dafbe718">index</a> != <a class="code" href="svm_8h.html#ae9836254c789e1e9f8d62939ff44ff36">MSR_INVALID</a>; i++) {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].always)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <a class="code" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74">set_msr_interception</a>(vcpu, msrpm, <a class="code" href="svm_8c.html#ad73a1ea1e074171f7049d11e84aa1814">direct_access_msrs</a>[i].index, 1, 1);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aaee43a83fe8c444128a4d22b2d5d5c21_cgraph.png" border="0" usemap="#asvm_8h_aaee43a83fe8c444128a4d22b2d5d5c21_cgraph" alt=""/></div>
<map name="asvm_8h_aaee43a83fe8c444128a4d22b2d5d5c21_cgraph" id="asvm_8h_aaee43a83fe8c444128a4d22b2d5d5c21_cgraph">
<area shape="rect" title=" " alt="" coords="5,195,175,221"/>
<area shape="rect" href="svm_8c.html#ae7cebb5bd1d0e7eadb2b7df90cca0c74" title=" " alt="" coords="223,195,381,221"/>
<area shape="rect" href="svm_8c.html#a7baa0f9e5f7d38e8ed066a4b8a61c09a" title=" " alt="" coords="448,137,607,178"/>
<area shape="rect" href="svm_8c.html#a1ffde811cc7743857dbb3175beda4aa2" title=" " alt="" coords="429,224,625,251"/>
<area shape="rect" href="x86_8c.html#aea310c0e4f695bd1c6b5d96aa1dbd940" title=" " alt="" coords="705,5,846,32"/>
<area shape="rect" href="svm__onhyperv_8h.html#aa8051536beeae65d3e4645edd68850ae" title=" " alt="" coords="673,57,877,98"/>
<area shape="rect" href="svm_8c.html#a35438091c40e77c617ce2ec9d521cc1f" title=" " alt="" coords="702,123,849,149"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="740,224,811,251"/>
<area shape="rect" href="svm_8c.html#a48f427ed9696201e388996df7ceccb9e" title=" " alt="" coords="700,173,851,200"/>
<area shape="rect" href="svm_8c.html#a6a3d076f98c7c25a44d90f49f0fca2c3" title=" " alt="" coords="925,224,1099,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_aaee43a83fe8c444128a4d22b2d5d5c21_icgraph.png" border="0" usemap="#asvm_8h_aaee43a83fe8c444128a4d22b2d5d5c21_icgraph" alt=""/></div>
<map name="asvm_8h_aaee43a83fe8c444128a4d22b2d5d5c21_icgraph" id="asvm_8h_aaee43a83fe8c444128a4d22b2d5d5c21_icgraph">
<area shape="rect" title=" " alt="" coords="2384,307,2553,333"/>
<area shape="rect" href="svm_8c.html#a6bd9f9c3ade9fe75356f04bdf58433cc" title=" " alt="" coords="2185,281,2327,308"/>
<area shape="rect" href="svm_2nested_8c.html#aaeebe6cee9f13a0540cbd9b696648a1d" title=" " alt="" coords="2176,332,2336,359"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="2000,281,2128,308"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2009,332,2119,359"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,241,1919,268"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,357,1952,384"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,241,1673,268"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,170,1684,211"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,364,1679,391"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,93,719,120"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,111,1679,137"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,293,1668,334"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,297,1399,338"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,245,1403,272"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,195,1389,221"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,304,1144,331"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,304,939,331"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,144,1421,171"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,362,1408,403"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,362,1176,403"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,412,945,439"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,361,940,388"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,93,520,120"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,68,323,95"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,68,128,95"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,93,1412,120"/>
</map>
</div>

</div>
</div>
<a id="ad9a1b45b05505f9435cc2d1dd1c37943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9a1b45b05505f9435cc2d1dd1c37943">&#9670;&nbsp;</a></span>svm_write_tsc_multiplier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void svm_write_tsc_multiplier </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l01163">1163</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;{</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    preempt_disable();</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7">to_svm</a>(vcpu)-&gt;guest_state_loaded)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <a class="code" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34">__svm_write_tsc_multiplier</a>(vcpu-&gt;arch.tsc_scaling_ratio);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    preempt_enable();</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;}</div>
<div class="ttc" id="asvm_8c_html_a66671c85c774356d50d71cbd11633a34"><div class="ttname"><a href="svm_8c.html#a66671c85c774356d50d71cbd11633a34">__svm_write_tsc_multiplier</a></div><div class="ttdeci">static void __svm_write_tsc_multiplier(u64 multiplier)</div><div class="ttdef"><b>Definition:</b> <a href="svm_8c_source.html#l00563">svm.c:563</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad9a1b45b05505f9435cc2d1dd1c37943_cgraph.png" border="0" usemap="#asvm_8h_ad9a1b45b05505f9435cc2d1dd1c37943_cgraph" alt=""/></div>
<map name="asvm_8h_ad9a1b45b05505f9435cc2d1dd1c37943_cgraph" id="asvm_8h_ad9a1b45b05505f9435cc2d1dd1c37943_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,192,57"/>
<area shape="rect" href="svm_8c.html#a66671c85c774356d50d71cbd11633a34" title=" " alt="" coords="240,5,440,32"/>
<area shape="rect" href="svm_8h.html#a83e420c88631faf9613ea3caa72c63b7" title=" " alt="" coords="305,56,375,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ad9a1b45b05505f9435cc2d1dd1c37943_icgraph.png" border="0" usemap="#asvm_8h_ad9a1b45b05505f9435cc2d1dd1c37943_icgraph" alt=""/></div>
<map name="asvm_8h_ad9a1b45b05505f9435cc2d1dd1c37943_icgraph" id="asvm_8h_ad9a1b45b05505f9435cc2d1dd1c37943_icgraph">
<area shape="rect" title=" " alt="" coords="1959,124,2145,151"/>
<area shape="rect" href="svm_2nested_8c.html#ae003d7b6aae84aa9b70d64f464e70dfc" title=" " alt="" coords="1732,19,1911,61"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1744,221,1899,248"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,33,1176,74"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1522,27,1631,53"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,27,945,53"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,77,940,104"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,128,719,155"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,128,520,155"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,153,323,180"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,153,128,180"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,339,1673,365"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,273,1684,314"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,77,1679,104"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,221,1679,248"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,390,1668,431"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,331,1399,373"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,397,1403,424"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,448,1389,475"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,339,1144,365"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,339,939,365"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,280,1421,307"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,45,1408,86"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,229,1412,256"/>
</map>
</div>

</div>
</div>
<a id="ac27f6fe2ff4beeb5ad1b11681d0386fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac27f6fe2ff4beeb5ad1b11681d0386fd">&#9670;&nbsp;</a></span>to_kvm_svm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __always_inline struct <a class="el" href="structkvm__svm.html">kvm_svm</a>* to_kvm_svm </td>
          <td>(</td>
          <td class="paramtype">struct kvm *&#160;</td>
          <td class="paramname"><em>kvm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00316">316</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;{</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> container_of(kvm, <span class="keyword">struct</span> <a class="code" href="structkvm__svm.html">kvm_svm</a>, kvm);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ac27f6fe2ff4beeb5ad1b11681d0386fd_icgraph.png" border="0" usemap="#asvm_8h_ac27f6fe2ff4beeb5ad1b11681d0386fd_icgraph" alt=""/></div>
<map name="asvm_8h_ac27f6fe2ff4beeb5ad1b11681d0386fd_icgraph" id="asvm_8h_ac27f6fe2ff4beeb5ad1b11681d0386fd_icgraph">
<area shape="rect" title=" " alt="" coords="1061,1191,1168,1217"/>
<area shape="rect" href="sev_8c.html#af61a8ee2222dd0c4855b8eb0ad795116" title=" " alt="" coords="558,107,725,133"/>
<area shape="rect" href="sev_8c.html#a73e538c37aa4aa7a7bd116aaa119eed7" title=" " alt="" coords="539,56,743,83"/>
<area shape="rect" href="sev_8c.html#a2161a9ec46ad3a0c25b8d174bb0617c8" title=" " alt="" coords="552,209,731,250"/>
<area shape="rect" href="sev_8c.html#ae249888cd72d16f8157726334216d8e8" title=" " alt="" coords="295,311,415,337"/>
<area shape="rect" href="sev_8c.html#aa680ad6932e5684b1ee1c10399098650" title=" " alt="" coords="549,274,734,315"/>
<area shape="rect" href="sev_8c.html#a2c14d94d1f2de5f23cd146b31f742859" title=" " alt="" coords="270,861,441,888"/>
<area shape="rect" href="avic_8c.html#a5eaaa2d4a926c006359343ff29a9cdf7" title=" " alt="" coords="837,1774,983,1815"/>
<area shape="rect" href="avic_8c.html#a8cfb06497cbd5960a4a909c44e701f06" title=" " alt="" coords="831,1839,989,1881"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="850,1216,970,1243"/>
<area shape="rect" href="avic_8c.html#a7cf9fdcdf4f5f6559c099faaab0c2d29" title=" " alt="" coords="807,1905,1013,1932"/>
<area shape="rect" href="avic_8c.html#a3a8b145ddec7a3dc1367a4e4e0df397e" title=" " alt="" coords="835,1956,985,1983"/>
<area shape="rect" href="avic_8c.html#a3bb736e8688ecfaa3696b347764fd37d" title=" " alt="" coords="843,2057,977,2084"/>
<area shape="rect" href="avic_8c.html#a0ddedac4b0b428928fae6bc9fe902e2a" title=" " alt="" coords="589,2032,694,2059"/>
<area shape="rect" href="sev_8c.html#a3d4c35c45271cf8279a512a1b14c8d7f" title=" " alt="" coords="848,2108,972,2135"/>
<area shape="rect" href="sev_8c.html#a70ad599e38cbdaca8ac3d21348d736bc" title=" " alt="" coords="817,1469,1003,1496"/>
<area shape="rect" href="sev_8c.html#ab37c3ce91ad0ad98fb7d5676a318cde4" title=" " alt="" coords="555,1419,728,1461"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="571,1485,712,1512"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="235,1637,476,1664"/>
<area shape="rect" href="sev_8c.html#a3b1ae3550c1b7c9973532d08d167ce2c" title=" " alt="" coords="524,1587,759,1613"/>
<area shape="rect" href="sev_8c.html#af1eb77eac84f085b0a943b87f783e30d" title=" " alt="" coords="577,1536,706,1563"/>
<area shape="rect" href="svm_8h.html#a14877439e9d41030cb21612eecc8f3f9" title=" " alt="" coords="855,5,965,32"/>
<area shape="rect" href="sev_8c.html#a66cc6caa9f6331de794476e911d4ce53" title=" " alt="" coords="857,2159,963,2185"/>
<area shape="rect" href="sev_8c.html#ab9049ca6ec68860c52858b4a7c0b6e5e" title=" " alt="" coords="566,339,717,381"/>
<area shape="rect" href="svm_8h.html#a371c2a615dd0d893b557b4c0742ab5c6" title=" " alt="" coords="866,912,954,939"/>
<area shape="rect" href="sev_8c.html#a8c4977429c23ee42a01589afc4e8b6c8" title=" " alt="" coords="574,456,709,483"/>
<area shape="rect" href="sev_8c.html#a85fd69118319577cfdaaa5c29085ccef" title=" " alt="" coords="573,557,710,584"/>
<area shape="rect" href="sev_8c.html#acb362b50ed86d332270fc6e7bd0fcfe3" title=" " alt="" coords="562,608,721,635"/>
<area shape="rect" href="sev_8c.html#a735eb40df817d91509a036b8e5950190" title=" " alt="" coords="570,1013,713,1040"/>
<area shape="rect" href="sev_8c.html#a4aac0b82769a9e9a6a13980f61ce8ba1" title=" " alt="" coords="575,1267,707,1293"/>
<area shape="rect" href="sev_8c.html#a4a233717598b3e11fcc62bdd74fca6cd" title=" " alt="" coords="550,1064,733,1091"/>
<area shape="rect" href="sev_8c.html#a949ea0fcee0697916e3bf6092513ae57" title=" " alt="" coords="570,659,713,685"/>
<area shape="rect" href="sev_8c.html#a478b7e37b46d13565bc9f75c2898a4ff" title=" " alt="" coords="573,1368,710,1395"/>
<area shape="rect" href="sev_8c.html#a8f8b1b540aaa2edff61d82b1c4ebc67b" title=" " alt="" coords="547,1115,735,1141"/>
<area shape="rect" href="sev_8c.html#a91d7ee792dae7943526eb003f3597e94" title=" " alt="" coords="575,709,707,736"/>
<area shape="rect" href="sev_8c.html#a3795b9995a0cdb5ea7a6867c04eccd77" title=" " alt="" coords="579,760,704,787"/>
<area shape="rect" href="sev_8c.html#ac62526aea63f9ac646eb3c3fbe4b0681" title=" " alt="" coords="852,2209,968,2236"/>
<area shape="rect" href="sev_8c.html#aac550422551b71c0afe8efe176e0b55d" title=" " alt="" coords="831,2260,989,2287"/>
<area shape="rect" href="sev_8c.html#a6be3f568017ce35e46a1a3ff7da8bf87" title=" " alt="" coords="849,507,971,533"/>
<area shape="rect" href="sev_8c.html#a6a743115f37d3169d127c828cff664bb" title=" " alt="" coords="837,1672,983,1699"/>
<area shape="rect" href="sev_8c.html#a1dc642421dfff17eaa7d3bb67701facc" title=" " alt="" coords="843,1115,977,1141"/>
<area shape="rect" href="sev_8c.html#aa8af9b8fad5755159d0e304a41fc4650" title=" " alt="" coords="829,1621,991,1648"/>
<area shape="rect" href="sev_8c.html#aa9ba426e70b3cfcb263352b3ac89173f" title=" " alt="" coords="835,1064,985,1091"/>
<area shape="rect" href="sev_8c.html#a7048173cbf0bfebf01ff98366c7adca5" title=" " alt="" coords="282,95,429,121"/>
<area shape="rect" href="sev_8c.html#a2591ea1f300d49d3021ea7ffd59fdc2e" title=" " alt="" coords="5,120,187,147"/>
<area shape="rect" href="sev_8c.html#a58da6a47d3ee35e28a426faf878a943e" title=" " alt="" coords="260,19,451,45"/>
<area shape="rect" href="avic_8c.html#a2ed13621ec3f14afbf47f129e43b496d" title=" " alt="" coords="556,1790,727,1831"/>
<area shape="rect" href="avic_8c.html#a2650b353757b538de17a1c843f7308d2" title=" " alt="" coords="585,1856,698,1883"/>
<area shape="rect" href="avic_8c.html#aefc63eafb35c1efd94f6d53e7d0b20d5" title=" " alt="" coords="554,1907,729,1933"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="598,1165,685,1192"/>
</map>
</div>

</div>
</div>
<a id="a83e420c88631faf9613ea3caa72c63b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83e420c88631faf9613ea3caa72c63b7">&#9670;&nbsp;</a></span>to_svm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __always_inline struct <a class="el" href="structvcpu__svm.html">vcpu_svm</a>* to_svm </td>
          <td>(</td>
          <td class="paramtype">struct kvm_vcpu *&#160;</td>
          <td class="paramname"><em>vcpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00364">364</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;{</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> container_of(vcpu, <span class="keyword">struct</span> <a class="code" href="structvcpu__svm.html">vcpu_svm</a>, vcpu);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5deff43556f8c807c64def073cd548e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5deff43556f8c807c64def073cd548e4">&#9670;&nbsp;</a></span>vmcb12_is_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool vmcb12_is_intercept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvmcb__ctrl__area__cached.html">vmcb_ctrl_area_cached</a> *&#160;</td>
          <td class="paramname"><em>control</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00397">397</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;{</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    WARN_ON_ONCE(bit &gt;= 32 * MAX_INTERCEPT);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">return</span> test_bit(bit, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a5deff43556f8c807c64def073cd548e4_icgraph.png" border="0" usemap="#asvm_8h_a5deff43556f8c807c64def073cd548e4_icgraph" alt=""/></div>
<map name="asvm_8h_a5deff43556f8c807c64def073cd548e4_icgraph" id="asvm_8h_a5deff43556f8c807c64def073cd548e4_icgraph">
<area shape="rect" title=" " alt="" coords="1428,1159,1585,1185"/>
<area shape="rect" href="svm_2nested_8c.html#af3c541bc236a86c71f59264fc3c6fba4" title=" " alt="" coords="1184,42,1352,83"/>
<area shape="rect" href="avic_8c.html#ac41a57fe4f855076b5c5718def5bd6d3" title=" " alt="" coords="1184,1488,1352,1515"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="409,1371,562,1413"/>
<area shape="rect" href="svm_2nested_8c.html#aed83f33244b682acbdb9ca7b531cbfa0" title=" " alt="" coords="1193,931,1343,957"/>
<area shape="rect" href="svm_8h.html#a13cbed806a9638fcaab4d01cb926d141" title=" " alt="" coords="1193,519,1343,545"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="405,1437,565,1464"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="396,1075,575,1101"/>
<area shape="rect" href="svm_8h.html#aefa7c9e670f5a86519f40b06f5277346" title=" " alt="" coords="1191,1133,1345,1160"/>
<area shape="rect" href="svm_8h.html#a61ac82c942842848fab805e84fc70189" title=" " alt="" coords="1192,1032,1344,1059"/>
<area shape="rect" href="svm_2nested_8c.html#a90464b57b273a88a7a1fb3c2cefb257a" title=" " alt="" coords="1156,1235,1380,1261"/>
<area shape="rect" href="svm_2nested_8c.html#ac2a7393e1ff675481f27e30ab22ba5ba" title=" " alt="" coords="918,1336,1085,1363"/>
<area shape="rect" href="svm_2nested_8c.html#ac11321f5c485c6fd9804b75a6b405f64" title=" " alt="" coords="1169,1285,1367,1312"/>
<area shape="rect" href="svm_2nested_8c.html#a3c235b4ddb7200e464cacf8dfb3b4f00" title=" " alt="" coords="1167,216,1369,243"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1177,107,1359,149"/>
<area shape="rect" href="svm_2nested_8c.html#aeb4d38d47572db12942883495b996356" title=" " alt="" coords="895,5,1108,32"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="917,56,1085,83"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="664,92,815,119"/>
<area shape="rect" href="avic_8c.html#a40f16bbe281410ac02865ea25c26bf12" title=" " alt="" coords="941,1488,1061,1515"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="926,1539,1077,1581"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="696,1488,783,1515"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="667,1539,811,1581"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="220,1379,339,1405"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="5,1379,172,1405"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="387,880,584,907"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="924,661,1079,688"/>
<area shape="rect" href="vmx_2nested_8c.html#a4d02669b451b76b64dc28047526be8c4" title=" " alt="" coords="907,326,1096,367"/>
<area shape="rect" href="vmx_2nested_8c.html#a877b148ab3be256ff208a4d0c0136809" title=" " alt="" coords="902,275,1101,301"/>
<area shape="rect" href="svm_8c.html#a005049e4b080345fc3924233b8e33bce" title=" " alt="" coords="654,275,825,301"/>
<area shape="rect" href="svm_8c.html#a67762809a8b14687a3bffdd5a4cd03aa" title=" " alt="" coords="916,443,1087,469"/>
<area shape="rect" href="vmx_2nested_8c.html#ae8bd3aaa6d3ea61d98732dc54ced8578" title=" " alt="" coords="640,880,839,907"/>
<area shape="rect" href="vmx_8c.html#a8b92a5c83267fa843483b8277bc73f30" title=" " alt="" coords="653,544,825,571"/>
<area shape="rect" href="vmx_8c.html#a368d7a25f0cc51f62229282a5d2550d3" title=" " alt="" coords="916,493,1087,520"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="643,1336,835,1363"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="632,595,847,637"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="637,661,841,688"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="637,779,842,805"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="648,713,831,754"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="419,1320,552,1347"/>
<area shape="rect" href="vmx_2nested_8c.html#a8d1fe51ef29b584cee280b58fe718d4b" title=" " alt="" coords="635,209,844,250"/>
<area shape="rect" href="vmx_2nested_8c.html#a48fcc88ceee4f57a3dbf23fedb46a5cb" title=" " alt="" coords="664,143,815,185"/>
<area shape="rect" href="vmx_8c.html#a23ea2316b60c27a2c00f924b983a46e9" title=" " alt="" coords="411,333,559,360"/>
<area shape="rect" href="vmx_8c.html#a826652b83d0f8797a169f7839596c178" title=" " alt="" coords="659,326,819,367"/>
<area shape="rect" href="posted__intr_8c.html#aa59b00f36d985abaa19009096d1f66a4" title=" " alt="" coords="671,493,807,520"/>
<area shape="rect" href="svm_8c.html#a20c1180c4bb6850bae73e3cbda53c695" title=" " alt="" coords="669,1235,809,1261"/>
<area shape="rect" href="svm_8c.html#a37477553ea45acae098350e7d572ae2e" title=" " alt="" coords="932,1184,1071,1211"/>
<area shape="rect" href="vmx_8c.html#a4546be655e5968c462322858ecf68c49" title=" " alt="" coords="669,1057,810,1084"/>
<area shape="rect" href="vmx_8c.html#ae92f23c5709cc4f9fe4fe2d794deef50" title=" " alt="" coords="931,1032,1071,1059"/>
<area shape="rect" href="svm_2nested_8c.html#afd2919b9c5b5e158cb09deba98a74772" title=" " alt="" coords="917,209,1086,250"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="912,107,1091,133"/>
</map>
</div>

</div>
</div>
<a id="a83e4cd1b591935133506abf6724051c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83e4cd1b591935133506abf6724051c4">&#9670;&nbsp;</a></span>vmcb_clr_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void vmcb_clr_intercept </td>
          <td>(</td>
          <td class="paramtype">struct vmcb_control_area *&#160;</td>
          <td class="paramname"><em>control</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00385">385</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;{</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    WARN_ON_ONCE(bit &gt;= 32 * MAX_INTERCEPT);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    __clear_bit(bit, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a83e4cd1b591935133506abf6724051c4_icgraph.png" border="0" usemap="#asvm_8h_a83e4cd1b591935133506abf6724051c4_icgraph" alt=""/></div>
<map name="asvm_8h_a83e4cd1b591935133506abf6724051c4_icgraph" id="asvm_8h_a83e4cd1b591935133506abf6724051c4_icgraph">
<area shape="rect" title=" " alt="" coords="1925,503,2072,529"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="1519,165,1694,192"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="1744,503,1877,529"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="1537,812,1676,839"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="809,401,896,428"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="1297,325,1435,352"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="1047,5,1163,32"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="797,848,908,875"/>
<area shape="rect" href="svm_8c.html#aeb01a3f5d5204374edbbdb185d87ffcd" title=" " alt="" coords="1279,158,1453,199"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="526,401,654,428"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="782,5,923,32"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="469,5,711,32"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="513,1152,667,1179"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="480,899,700,925"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="218,1051,410,1077"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="207,1218,421,1259"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="212,1284,416,1311"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="211,1101,417,1128"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="7,971,157,997"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="223,1153,405,1194"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="5,1043,159,1085"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="225,949,403,976"/>
<area shape="rect" href="svm_8c.html#a02cdc4055c8a1706c884eff72c4caaf7" title=" " alt="" coords="1541,1155,1672,1181"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1013,1102,1196,1143"/>
<area shape="rect" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf" title=" " alt="" coords="1539,275,1674,301"/>
<area shape="rect" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642" title=" " alt="" coords="1517,415,1696,441"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="1535,608,1678,635"/>
<area shape="rect" href="svm_8c.html#a84f2d3e5d602af563ab58693bf87db77" title=" " alt="" coords="1306,1212,1426,1239"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="769,1051,937,1077"/>
<area shape="rect" href="svm_8c.html#a8e925350e4b7d486cb0b9bace97fc5f0" title=" " alt="" coords="1263,224,1469,251"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="1291,695,1441,737"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="1303,1161,1429,1188"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="1054,1168,1155,1195"/>
<area shape="rect" href="svm_8c.html#aff900c45df2faa151d783155ec034f86" title=" " alt="" coords="1283,964,1449,991"/>
<area shape="rect" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1" title=" " alt="" coords="1280,630,1452,671"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="1314,913,1418,940"/>
<area shape="rect" href="svm_8c.html#aa30e5cb5ad1759988fc349bd703bd4dc" title=" " alt="" coords="1269,812,1463,839"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="1029,630,1181,671"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="995,1261,1215,1288"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="759,1304,947,1331"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="787,1152,918,1179"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="787,1203,918,1229"/>
<area shape="rect" href="svm_8c.html#aaa5bf4dc91985f4c533268b7e4ca811d" title=" " alt="" coords="1040,1051,1169,1077"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="1029,848,1181,875"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1071,949,1138,976"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="1271,579,1461,605"/>
<area shape="rect" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066" title=" " alt="" coords="1281,761,1451,788"/>
<area shape="rect" href="svm_8c.html#a27df28527cda6f7917355af86817d940" title=" " alt="" coords="1309,528,1423,555"/>
<area shape="rect" href="svm_8c.html#a67bccbcbb6b439b80103663fe58cd626" title=" " alt="" coords="1042,747,1167,773"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="1013,528,1196,555"/>
</map>
</div>

</div>
</div>
<a id="af08dd89f5ee519835337165e9060f526"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af08dd89f5ee519835337165e9060f526">&#9670;&nbsp;</a></span>vmcb_is_dirty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool vmcb_is_dirty </td>
          <td>(</td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>vmcb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00359">359</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">return</span> !test_bit(bit, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;vmcb-&gt;control.clean);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_af08dd89f5ee519835337165e9060f526_icgraph.png" border="0" usemap="#asvm_8h_af08dd89f5ee519835337165e9060f526_icgraph" alt=""/></div>
<map name="asvm_8h_af08dd89f5ee519835337165e9060f526_icgraph" id="asvm_8h_af08dd89f5ee519835337165e9060f526_icgraph">
<area shape="rect" title=" " alt="" coords="1261,5,1375,32"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="993,5,1213,32"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,5,945,32"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,5,719,32"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,5,520,32"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,5,323,32"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="a6eb37bb9efc32f45f75055de8ba4fc79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eb37bb9efc32f45f75055de8ba4fc79">&#9670;&nbsp;</a></span>vmcb_is_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool vmcb_is_intercept </td>
          <td>(</td>
          <td class="paramtype">struct vmcb_control_area *&#160;</td>
          <td class="paramname"><em>control</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00391">391</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    WARN_ON_ONCE(bit &gt;= 32 * MAX_INTERCEPT);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">return</span> test_bit(bit, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a6eb37bb9efc32f45f75055de8ba4fc79_icgraph.png" border="0" usemap="#asvm_8h_a6eb37bb9efc32f45f75055de8ba4fc79_icgraph" alt=""/></div>
<map name="asvm_8h_a6eb37bb9efc32f45f75055de8ba4fc79_icgraph" id="asvm_8h_a6eb37bb9efc32f45f75055de8ba4fc79_icgraph">
<area shape="rect" title=" " alt="" coords="2615,122,2756,149"/>
<area shape="rect" href="svm_8h.html#a397a88cd5af0b0bb8a9ef4a5e6bc849d" title=" " alt="" coords="2433,122,2567,149"/>
<area shape="rect" href="svm_2nested_8c.html#a232d9e4f1731f0d495e3b4f9d530d0ee" title=" " alt="" coords="2231,5,2385,47"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,122,1389,149"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="2257,353,2359,379"/>
<area shape="rect" href="svm_8c.html#a27df28527cda6f7917355af86817d940" title=" " alt="" coords="2251,513,2365,539"/>
<area shape="rect" href="svm_8c.html#a640846de1c48f3e408644fcb85a6004b" title=" " alt="" coords="2239,71,2377,98"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="2033,42,2149,69"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="2026,403,2157,430"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,475,945,502"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,298,1919,325"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,409,940,435"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="2026,251,2157,278"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2036,353,2147,379"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,274,719,301"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,274,520,301"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,249,323,275"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,249,128,275"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,71,1673,98"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,341,1684,383"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,407,1679,434"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,290,1679,317"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,224,1668,265"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,5,1399,47"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,71,1403,98"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,13,1144,39"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,13,939,39"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,341,1421,367"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,392,1408,433"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,443,1176,484"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,290,1412,317"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,509,1952,535"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="2000,610,2183,637"/>
</map>
</div>

</div>
</div>
<a id="a64fd8d98c29189b4f4e47f96958aeeca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64fd8d98c29189b4f4e47f96958aeeca">&#9670;&nbsp;</a></span>vmcb_mark_all_clean()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void vmcb_mark_all_clean </td>
          <td>(</td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>vmcb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00348">348</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;{</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    vmcb-&gt;control.clean = <a class="code" href="svm_8h.html#a317277564d2351c6695a358504311483">VMCB_ALL_CLEAN_MASK</a></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                   &amp; ~<a class="code" href="svm_8h.html#a987416bb1857b96f97af2391d1008c5a">VMCB_ALWAYS_DIRTY_MASK</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
<div class="ttc" id="asvm_8h_html_a317277564d2351c6695a358504311483"><div class="ttname"><a href="svm_8h.html#a317277564d2351c6695a358504311483">VMCB_ALL_CLEAN_MASK</a></div><div class="ttdeci">#define VMCB_ALL_CLEAN_MASK</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00068">svm.h:68</a></div></div>
<div class="ttc" id="asvm_8h_html_a987416bb1857b96f97af2391d1008c5a"><div class="ttname"><a href="svm_8h.html#a987416bb1857b96f97af2391d1008c5a">VMCB_ALWAYS_DIRTY_MASK</a></div><div class="ttdeci">#define VMCB_ALWAYS_DIRTY_MASK</div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00077">svm.h:77</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a64fd8d98c29189b4f4e47f96958aeeca_icgraph.png" border="0" usemap="#asvm_8h_a64fd8d98c29189b4f4e47f96958aeeca_icgraph" alt=""/></div>
<map name="asvm_8h_a64fd8d98c29189b4f4e47f96958aeeca_icgraph" id="asvm_8h_a64fd8d98c29189b4f4e47f96958aeeca_icgraph">
<area shape="rect" title=" " alt="" coords="169,5,333,32"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="5,5,121,32"/>
</map>
</div>

</div>
</div>
<a id="a5980ebd310893869bc4c059f110a13cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5980ebd310893869bc4c059f110a13cb">&#9670;&nbsp;</a></span>vmcb_mark_all_dirty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void vmcb_mark_all_dirty </td>
          <td>(</td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>vmcb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00343">343</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    vmcb-&gt;control.clean = 0;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_a5980ebd310893869bc4c059f110a13cb_icgraph.png" border="0" usemap="#asvm_8h_a5980ebd310893869bc4c059f110a13cb_icgraph" alt=""/></div>
<map name="asvm_8h_a5980ebd310893869bc4c059f110a13cb_icgraph" id="asvm_8h_a5980ebd310893869bc4c059f110a13cb_icgraph">
<area shape="rect" title=" " alt="" coords="2368,288,2527,314"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="2205,237,2291,264"/>
<area shape="rect" href="svm_8c.html#a1337a20b038f182d9e04102e22c45f79" title=" " alt="" coords="2195,288,2301,314"/>
<area shape="rect" href="svm_2nested_8c.html#afea614d490148481c96faf7c1b5ecb11" title=" " alt="" coords="2176,364,2320,390"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="2000,237,2128,264"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="2006,288,2122,314"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="2009,338,2119,365"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="772,173,940,200"/>
<area shape="rect" href="svm_8c.html#a394304ab136d5db4f5dad5b7c05e06e4" title=" " alt="" coords="2003,522,2125,549"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="1765,250,1919,277"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="1732,90,1952,117"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="1481,192,1673,218"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="1469,308,1684,350"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="1475,118,1679,145"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="568,89,719,116"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="1474,374,1679,401"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="1485,243,1668,284"/>
<area shape="rect" href="svm_8c.html#a08788d6a633657aa9e7e2f3b09db9b40" title=" " alt="" coords="1246,254,1399,295"/>
<area shape="rect" href="svm_8c.html#ae135f7d753cde05e6f726fb75e971ddd" title=" " alt="" coords="1243,152,1403,178"/>
<area shape="rect" href="svm_8c.html#a3f8983432f4aae138a6f4d167c561132" title=" " alt="" coords="1256,202,1389,229"/>
<area shape="rect" href="svm_8c.html#ad1887c4bb9c78c577fb20a129d73ea41" title=" " alt="" coords="1025,261,1144,288"/>
<area shape="rect" href="svm_8c.html#af2ee2a03530f5b7a02a127d8b779d2ae" title=" " alt="" coords="773,261,939,288"/>
<area shape="rect" href="svm_2nested_8c.html#a3286f29b650004d599595557d310136e" title=" " alt="" coords="1224,320,1421,346"/>
<area shape="rect" href="svm_2nested_8c.html#a962af1ea814d32a42ada9f601918cee5" title=" " alt="" coords="1237,86,1408,127"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="993,86,1176,127"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="767,89,945,116"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="371,232,520,258"/>
<area shape="rect" href="svm_8c.html#a1eacc7b79f62ed332056217c35fe3be4" title=" " alt="" coords="176,396,323,422"/>
<area shape="rect" href="svm_8c.html#a7c2323b13a5022aa9f6a9ae5ebe4d830" title=" " alt="" coords="5,396,128,422"/>
<area shape="rect" href="svm_2nested_8c.html#a387a91a64bb25a25590ee3b019f0e0a2" title=" " alt="" coords="1233,370,1412,397"/>
</map>
</div>

</div>
</div>
<a id="ab83edec724698a20d66a086a1900aa27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab83edec724698a20d66a086a1900aa27">&#9670;&nbsp;</a></span>vmcb_mark_dirty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void vmcb_mark_dirty </td>
          <td>(</td>
          <td class="paramtype">struct vmcb *&#160;</td>
          <td class="paramname"><em>vmcb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00354">354</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    vmcb-&gt;control.clean &amp;= ~(1 &lt;&lt; bit);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_ab83edec724698a20d66a086a1900aa27_icgraph.png" border="0" usemap="#asvm_8h_ab83edec724698a20d66a086a1900aa27_icgraph" alt=""/></div>
<map name="asvm_8h_ab83edec724698a20d66a086a1900aa27_icgraph" id="asvm_8h_ab83edec724698a20d66a086a1900aa27_icgraph">
<area shape="rect" title=" " alt="" coords="1803,841,1939,867"/>
<area shape="rect" href="avic_8c.html#a51356c24441683c197e1d4c2555da06d" title=" " alt="" coords="1591,5,1742,47"/>
<area shape="rect" href="svm_8c.html#ab386821d47e9af4c7a362e43dca751fa" title=" " alt="" coords="1597,71,1736,98"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="499,502,654,529"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="467,742,687,769"/>
<area shape="rect" href="svm_8c.html#a1ec4f210ddd96122d1d787a383483514" title=" " alt="" coords="1625,274,1708,301"/>
<area shape="rect" href="svm_8c.html#a5d2703bd914c4ae4fcb1eb83c208b085" title=" " alt="" coords="1181,261,1297,287"/>
<area shape="rect" href="sev_8c.html#ad0a040a48a04ab47d0af3385ad214cd4" title=" " alt="" coords="1616,223,1717,250"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="1600,765,1733,791"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="739,603,849,630"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="1175,401,1302,427"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="1187,553,1291,579"/>
<area shape="rect" href="svm_8c.html#a27df28527cda6f7917355af86817d940" title=" " alt="" coords="1181,831,1296,858"/>
<area shape="rect" href="svm_8c.html#a642305873006637d55c46a0f035dff2d" title=" " alt="" coords="1599,815,1734,842"/>
<area shape="rect" href="svm_8c.html#aacde987fd6ae3956ec075251296c37a0" title=" " alt="" coords="1593,1085,1740,1111"/>
<area shape="rect" href="svm_8c.html#a06d8a6a899d49f3235ec1294d1943c84" title=" " alt="" coords="735,1030,853,1057"/>
<area shape="rect" href="svm__onhyperv_8c.html#a6560c8252a00f2ae87f66e6e8b3d07e5" title=" " alt="" coords="1583,968,1750,1009"/>
<area shape="rect" href="svm_8c.html#a5f28637bd5292dc7bb085750c3e31d94" title=" " alt="" coords="1588,1034,1745,1061"/>
<area shape="rect" href="svm_8c.html#aec23ca96447aab4ff19f594a297bc109" title=" " alt="" coords="1391,477,1495,503"/>
<area shape="rect" href="svm_8c.html#af4202e53ce31f4e2eb93adf37be9ec5d" title=" " alt="" coords="1391,185,1496,211"/>
<area shape="rect" href="svm_8c.html#a862a657ea41e77d18613b33cd6599b90" title=" " alt="" coords="1614,1186,1719,1213"/>
<area shape="rect" href="svm_8c.html#a90fb234370a757876039727fc833a10d" title=" " alt="" coords="1614,1237,1719,1263"/>
<area shape="rect" href="svm_8c.html#a401dcf35e3ec2d996a00c612126ae78e" title=" " alt="" coords="1616,1287,1717,1314"/>
<area shape="rect" href="svm_8c.html#aac18b9094154a2c8b8e27c3b08c9e359" title=" " alt="" coords="1612,1338,1721,1365"/>
<area shape="rect" href="svm_8c.html#a7c278e923bb07084a7b0f64312968d9e" title=" " alt="" coords="1596,1389,1737,1415"/>
<area shape="rect" href="svm_8c.html#a1b5b579e10dbea76b1e9711f1b793975" title=" " alt="" coords="1579,1439,1755,1466"/>
<area shape="rect" href="svm_8c.html#a5779d517a24ab13b687f430474e7b018" title=" " alt="" coords="1587,1490,1747,1517"/>
<area shape="rect" href="avic_8c.html#affcdeac6765016e970e33d6ecff3eebb" title=" " alt="" coords="1371,5,1515,47"/>
<area shape="rect" href="svm_8c.html#ad65ceb76375d4e01d2b1e11a9c227b7c" title=" " alt="" coords="1370,71,1517,98"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="215,443,407,470"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="204,495,419,536"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="209,561,413,587"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="209,611,414,638"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="5,567,156,594"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="220,663,403,704"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="222,735,401,762"/>
<area shape="rect" href="svm_8c.html#a1337a20b038f182d9e04102e22c45f79" title=" " alt="" coords="1390,261,1497,287"/>
<area shape="rect" href="svm_8c.html#a02cdc4055c8a1706c884eff72c4caaf7" title=" " alt="" coords="1378,730,1509,757"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="1356,679,1531,706"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="1169,730,1308,757"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="920,980,1103,1021"/>
<area shape="rect" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf" title=" " alt="" coords="1376,629,1511,655"/>
<area shape="rect" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642" title=" " alt="" coords="922,654,1101,681"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="1374,578,1513,605"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="1372,831,1515,858"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="961,502,1062,529"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="901,401,1121,427"/>
<area shape="rect" href="svm_8c.html#aa3f43ee7024c775ce671371e2bb5bf98" title=" " alt="" coords="1386,1085,1501,1111"/>
<area shape="rect" href="svm_8c.html#aaa7d57cd8b29b959a08ccd6dc53196c4" title=" " alt="" coords="509,1030,645,1057"/>
<area shape="rect" href="svm_8c.html#af2c512591b577cf59656808ac082a47a" title=" " alt="" coords="510,1081,643,1107"/>
</map>
</div>

</div>
</div>
<a id="afdbe781b81d2ae90e81d9bb9e9750789"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdbe781b81d2ae90e81d9bb9e9750789">&#9670;&nbsp;</a></span>vmcb_set_intercept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void vmcb_set_intercept </td>
          <td>(</td>
          <td class="paramtype">struct vmcb_control_area *&#160;</td>
          <td class="paramname"><em>control</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8h_source.html#l00379">379</a> of file <a class="el" href="svm_8h_source.html">svm.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;{</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    WARN_ON_ONCE(bit &gt;= 32 * MAX_INTERCEPT);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    __set_bit(bit, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)&amp;<a class="code" href="posted__intr_8h.html#ae3d3aff52ed2ae9f00a97cfda9ceca6d">control</a>-&gt;intercepts);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="svm_8h_afdbe781b81d2ae90e81d9bb9e9750789_icgraph.png" border="0" usemap="#asvm_8h_afdbe781b81d2ae90e81d9bb9e9750789_icgraph" alt=""/></div>
<map name="asvm_8h_afdbe781b81d2ae90e81d9bb9e9750789_icgraph" id="asvm_8h_afdbe781b81d2ae90e81d9bb9e9750789_icgraph">
<area shape="rect" title=" " alt="" coords="2120,529,2271,555"/>
<area shape="rect" href="svm_2nested_8c.html#adb2a01596415bf77bd9a3f22ff165a14" title=" " alt="" coords="1939,478,2072,505"/>
<area shape="rect" href="sev_8c.html#a61aab05258497c5477227b8171f6f658" title=" " alt="" coords="1491,490,1630,517"/>
<area shape="rect" href="svm_8c.html#a7f08bf5cf3614629bd95b07ea03b08cf" title=" " alt="" coords="1734,998,1869,1025"/>
<area shape="rect" href="svm_8h.html#af04356b0b53ece1f631f1cfa12521642" title=" " alt="" coords="1712,229,1891,255"/>
<area shape="rect" href="svm_8h.html#af6e4bba26808541629dd240a782f1d05" title=" " alt="" coords="1730,817,1873,843"/>
<area shape="rect" href="svm_8c.html#a02cdc4055c8a1706c884eff72c4caaf7" title=" " alt="" coords="1736,309,1867,335"/>
<area shape="rect" href="svm_8h.html#a0e9d1e1a7652ad926236f0f44891293c" title=" " alt="" coords="1714,414,1889,441"/>
<area shape="rect" href="svm_2nested_8c.html#ab7904bb74631114e0bd5102a52aab4c8" title=" " alt="" coords="1208,5,1391,47"/>
<area shape="rect" href="svm_8h.html#a4c285d86fd94954273295b317242c500" title=" " alt="" coords="1732,605,1871,631"/>
<area shape="rect" href="svm_8c.html#a84f2d3e5d602af563ab58693bf87db77" title=" " alt="" coords="1501,170,1621,197"/>
<area shape="rect" href="svm_8c.html#aa3d3185c3eece1cf1e99fd5da3ca3181" title=" " alt="" coords="1004,769,1091,795"/>
<area shape="rect" href="sev_8c.html#abe289006ed99e36825065ad80cf7480f" title=" " alt="" coords="1241,439,1357,466"/>
<area shape="rect" href="svm_8c.html#a5df90c8772700a60441f2ba19472f726" title=" " alt="" coords="992,186,1103,213"/>
<area shape="rect" href="svm_8c.html#aeb01a3f5d5204374edbbdb185d87ffcd" title=" " alt="" coords="1474,221,1647,263"/>
<area shape="rect" href="svm_8c.html#a72a80d54451776cc2794da8564a424fa" title=" " alt="" coords="721,769,849,795"/>
<area shape="rect" href="sev_8c.html#ad28fd793149997c912b52490f6ca139a" title=" " alt="" coords="977,693,1118,719"/>
<area shape="rect" href="sev_8c.html#abe3c569b297da3b78824074b8c08f9a7" title=" " alt="" coords="664,693,905,719"/>
<area shape="rect" href="svm_2nested_8c.html#a73d1cb9b9fcfa112138681d9080a1c05" title=" " alt="" coords="707,439,862,466"/>
<area shape="rect" href="svm_2nested_8c.html#ae734b89c5cf3a889380d8136e2ed749e" title=" " alt="" coords="675,225,895,251"/>
<area shape="rect" href="svm_2nested_8c.html#a777240cb9ab00451d21a1b204e19c5a6" title=" " alt="" coords="413,393,605,419"/>
<area shape="rect" href="svm_2nested_8c.html#a03b4be7ca82710ecd17bc66f2a20cad8" title=" " alt="" coords="401,444,616,485"/>
<area shape="rect" href="svm_2nested_8c.html#a574acca11f4be4ea5df18f36307f9bf6" title=" " alt="" coords="407,510,611,537"/>
<area shape="rect" href="svm_8h.html#a7b2d87885eea1b11b1bf1045c21c5a8b" title=" " alt="" coords="406,561,611,587"/>
<area shape="rect" href="svm_2nested_8c.html#a4ec7e878f6af209e74dd84285ee0198f" title=" " alt="" coords="203,250,353,277"/>
<area shape="rect" href="svm_2hyperv_8c.html#a33efa5fe6a664e9b2a70232b93485645" title=" " alt="" coords="417,327,600,368"/>
<area shape="rect" href="svm_8c.html#a5d52c93beeb85ba5a99283d4eba589e1" title=" " alt="" coords="5,250,155,277"/>
<area shape="rect" href="svm_2nested_8c.html#a9b21378a3de8baae9bcb689f00cad48e" title=" " alt="" coords="419,225,598,251"/>
<area shape="rect" href="svm_2nested_8c.html#a8bac395de612ca2b748016c6f5ea0fef" title=" " alt="" coords="963,101,1131,127"/>
<area shape="rect" href="svm_8c.html#a8e925350e4b7d486cb0b9bace97fc5f0" title=" " alt="" coords="1457,1179,1664,1206"/>
<area shape="rect" href="svm_8c.html#a2704ee64e6fe9975efa29b6759a26139" title=" " alt="" coords="1485,809,1636,851"/>
<area shape="rect" href="svm_8c.html#aea540cc79e685f3a2eebfa4226b63403" title=" " alt="" coords="1497,338,1624,365"/>
<area shape="rect" href="svm_8c.html#a5c26f1ceaa6cc778d986bd33629dc539" title=" " alt="" coords="1249,287,1350,314"/>
<area shape="rect" href="svm_8c.html#aff900c45df2faa151d783155ec034f86" title=" " alt="" coords="1477,642,1644,669"/>
<area shape="rect" href="svm_8c.html#a12d4d3a3b5ae14af748037ebf85485c1" title=" " alt="" coords="1475,744,1647,785"/>
<area shape="rect" href="svm_8c.html#a1a9474f1273be079ac4f3c1320093c3d" title=" " alt="" coords="1509,693,1613,719"/>
<area shape="rect" href="svm_8c.html#aa30e5cb5ad1759988fc349bd703bd4dc" title=" " alt="" coords="1463,875,1658,902"/>
<area shape="rect" href="svm_8c.html#a204e4c169e1e8029eff521725a526a57" title=" " alt="" coords="1223,845,1375,887"/>
<area shape="rect" href="svm_8c.html#ab07aabd2b78a54e2f9a6bd72ffbfa404" title=" " alt="" coords="1189,237,1409,263"/>
<area shape="rect" href="svm_8c.html#a8afafecae406016532810194f187fe2c" title=" " alt="" coords="953,237,1141,263"/>
<area shape="rect" href="svm_8c.html#a4a2beb03d1ef1d9e803c22570b5806d1" title=" " alt="" coords="982,389,1113,415"/>
<area shape="rect" href="svm_8c.html#a0a2c47b46c5f4c14c1ae6a64119bcb60" title=" " alt="" coords="982,338,1113,365"/>
<area shape="rect" href="svm_8c.html#aaa5bf4dc91985f4c533268b7e4ca811d" title=" " alt="" coords="1235,541,1364,567"/>
<area shape="rect" href="svm_8c.html#a68ca826a04be38c12e0f0cd877d32029" title=" " alt="" coords="1223,693,1375,719"/>
<area shape="rect" href="svm_8c.html#af4590239d3e0b5fbad189a245207dfaa" title=" " alt="" coords="1266,743,1333,770"/>
<area shape="rect" href="svm_8c.html#a57894275d4e8aa0a3d5a4ad55e2c4d6e" title=" " alt="" coords="1465,1027,1656,1054"/>
<area shape="rect" href="svm_8c.html#af4501b19af9ab262bc899adc902a5066" title=" " alt="" coords="1475,926,1646,953"/>
<area shape="rect" href="svm_8c.html#a27df28527cda6f7917355af86817d940" title=" " alt="" coords="1503,1078,1618,1105"/>
<area shape="rect" href="svm_8c.html#a67bccbcbb6b439b80103663fe58cd626" title=" " alt="" coords="1237,962,1362,989"/>
<area shape="rect" href="svm_8c.html#a1ccd7665fc572e5e6782f88c40e82e88" title=" " alt="" coords="1208,1078,1391,1105"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a036567d678fc3315196c7e4a5fa42cd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a036567d678fc3315196c7e4a5fa42cd3">&#9670;&nbsp;</a></span>__read_mostly</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">u32 msrpm_offsets [<a class="el" href="svm_8h.html#aecb0b82114f9d516a3ee502c0054e0c0">MSRPM_OFFSETS</a>] __read_mostly</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cpuid_8c_source.html#l00036">36</a> of file <a class="el" href="cpuid_8c_source.html">cpuid.c</a>.</p>

</div>
</div>
<a id="a8be79ef0522e29a602517b51ff51f509"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8be79ef0522e29a602517b51ff51f509">&#9670;&nbsp;</a></span>dump_invalid_vmcb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool dump_invalid_vmcb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00231">231</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="adc8812d5d875ec9a2bf431790db71cfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8812d5d875ec9a2bf431790db71cfb">&#9670;&nbsp;</a></span>intercept_smi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool intercept_smi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00235">235</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a37d57b174f959f39f30e8f0796dc3afb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37d57b174f959f39f30e8f0796dc3afb">&#9670;&nbsp;</a></span>max_sev_asid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int max_sev_asid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sev_8c_source.html#l00071">71</a> of file <a class="el" href="sev_8c_source.html">sev.c</a>.</p>

</div>
</div>
<a id="a17a219d0651f1db709a3af0fc5527aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17a219d0651f1db709a3af0fc5527aa0">&#9670;&nbsp;</a></span>npt_enabled</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool npt_enabled</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00198">198</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="aea86d846f25c8a44402d3bc2d176130b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea86d846f25c8a44402d3bc2d176130b">&#9670;&nbsp;</a></span>nrips</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int nrips</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00206">206</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a02e1632739fc6a1f76c81a50cc4a97ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02e1632739fc6a1f76c81a50cc4a97ac">&#9670;&nbsp;</a></span>svm_nested_ops</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct kvm_x86_nested_ops svm_nested_ops</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_2nested_8c_source.html#l01780">1780</a> of file <a class="el" href="svm_2nested_8c_source.html">nested.c</a>.</p>

</div>
</div>
<a id="ab0a8ab91829811c7705c6455fb294bbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0a8ab91829811c7705c6455fb294bbc">&#9670;&nbsp;</a></span>vgif</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int vgif</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00214">214</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="a8d0afd60cabe4ff8b40d7099f49a1bb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d0afd60cabe4ff8b40d7099f49a1bb8">&#9670;&nbsp;</a></span>vnmi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool vnmi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="svm_8c_source.html#l00238">238</a> of file <a class="el" href="svm_8c_source.html">svm.c</a>.</p>

</div>
</div>
<a id="ad4c0ba70ab315cedbb11f259b1d7ae08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4c0ba70ab315cedbb11f259b1d7ae08">&#9670;&nbsp;</a></span>x2avic_enabled</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool x2avic_enabled</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="avic_8c_source.html#l00075">75</a> of file <a class="el" href="avic_8c_source.html">avic.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
